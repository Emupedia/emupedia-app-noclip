!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=204)}([function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15));function s(e,t=""){if(!e)throw console.error((new Error).stack),new Error(`Assert fail: ${t}`)}function i(e,t){const a=t-1;return e+a&~a}function o(e,t,a="0"){for(;e.length<t;)e=`${a}${e}`;return e}function l(e,t){return o(e.toString(16),t)}t.assert=s,t.assertExists=function(e){if(null!=e)return e;throw new Error("Missing object")},t.nullify=function(e){return void 0===e?null:e},t.readString=function(e,t,a=-1,r=!0){const n=e.createTypedArray(Uint8Array,t);let s="",i=0;for(;!(a>=0&&i>=a||r&&0===n[i]);)s+=String.fromCharCode(n[i]),i++;return s},t.align=i,t.alignNonPowerOfTwo=function(e,t){return((e+t-1)/t|0)*t},t.nArray=function(e,t){const a=new Array(e);for(let r=0;r<e;r++)a[r]=t();return a},t.leftPad=o,t.hexzero=l,t.hexdump=function(e,t=0,a=256){let r="";const s=(e instanceof n.default?e:new n.default(e)).createTypedArray(Uint8Array,t);a=Math.min(a,s.byteLength);for(let e=0;e<a;e+=16){let n=Math.min(a-e,16);r+=`${l(t+e,8)}    `;for(let t=0;t<n;t++){r+=` ${l(s[e+t],2)}`}for(let e=n;e<16;e++)r+="   ";r+="  ";for(let t=0;t<n;t++){const a=s[e+t];r+=`${a>=32&&a<127?String.fromCharCode(a):"."}`}for(let e=n;e<16;e++)r+=" ";r+="\n"}console.log(r)},t.magicstr=function(e){return e&=4294967295,String.fromCharCode(e>>>24&255)+String.fromCharCode(e>>>16&255)+String.fromCharCode(e>>>8&255)+String.fromCharCode(e>>>0&255)},t.wordCountFromByteCount=function(e){return i(e,4)/4},t.concat=function(e,t){for(let a=0;a<t.length;a++)e.push(t[a])},t.flatten=function(e){const t=[];for(let a=0;a<e.length;a++)t.push.apply(t,e[a]);return t},t.fallback=function(e,t){return null!==e?e:t},t.fallbackUndefined=function(e,t){return null!=e?e:t},t.arrayRemove=function(e,t){const a=e.indexOf(t);return s(a>=0),e.splice(a,1),a},t.arrayRemoveIfExist=function(e,t){const a=e.indexOf(t);return a>=0&&e.splice(a,1),a}},function(e,t,a){"use strict";a.r(t);var r={};a.r(r),a.d(r,"EPSILON",(function(){return m})),a.d(r,"ARRAY_TYPE",(function(){return p})),a.d(r,"RANDOM",(function(){return f})),a.d(r,"setMatrixArrayType",(function(){return A})),a.d(r,"toRadian",(function(){return _})),a.d(r,"equals",(function(){return S}));var n={};a.r(n),a.d(n,"create",(function(){return b})),a.d(n,"clone",(function(){return v})),a.d(n,"copy",(function(){return w})),a.d(n,"identity",(function(){return x})),a.d(n,"fromValues",(function(){return T})),a.d(n,"set",(function(){return y})),a.d(n,"transpose",(function(){return C})),a.d(n,"invert",(function(){return M})),a.d(n,"adjoint",(function(){return U})),a.d(n,"determinant",(function(){return k})),a.d(n,"multiply",(function(){return D})),a.d(n,"rotate",(function(){return I})),a.d(n,"scale",(function(){return R})),a.d(n,"fromRotation",(function(){return B})),a.d(n,"fromScaling",(function(){return P})),a.d(n,"str",(function(){return E})),a.d(n,"frob",(function(){return F})),a.d(n,"LDU",(function(){return V})),a.d(n,"add",(function(){return O})),a.d(n,"subtract",(function(){return N})),a.d(n,"exactEquals",(function(){return L})),a.d(n,"equals",(function(){return G})),a.d(n,"multiplyScalar",(function(){return H})),a.d(n,"multiplyScalarAndAdd",(function(){return j})),a.d(n,"mul",(function(){return W})),a.d(n,"sub",(function(){return Z}));var s={};a.r(s),a.d(s,"create",(function(){return z})),a.d(s,"clone",(function(){return K})),a.d(s,"copy",(function(){return X})),a.d(s,"identity",(function(){return Y})),a.d(s,"fromValues",(function(){return $})),a.d(s,"set",(function(){return q})),a.d(s,"invert",(function(){return Q})),a.d(s,"determinant",(function(){return J})),a.d(s,"multiply",(function(){return ee})),a.d(s,"rotate",(function(){return te})),a.d(s,"scale",(function(){return ae})),a.d(s,"translate",(function(){return re})),a.d(s,"fromRotation",(function(){return ne})),a.d(s,"fromScaling",(function(){return se})),a.d(s,"fromTranslation",(function(){return ie})),a.d(s,"str",(function(){return oe})),a.d(s,"frob",(function(){return le})),a.d(s,"add",(function(){return ce})),a.d(s,"subtract",(function(){return he})),a.d(s,"multiplyScalar",(function(){return de})),a.d(s,"multiplyScalarAndAdd",(function(){return ue})),a.d(s,"exactEquals",(function(){return me})),a.d(s,"equals",(function(){return pe})),a.d(s,"mul",(function(){return fe})),a.d(s,"sub",(function(){return Ae}));var i={};a.r(i),a.d(i,"create",(function(){return ge})),a.d(i,"fromMat4",(function(){return _e})),a.d(i,"clone",(function(){return Se})),a.d(i,"copy",(function(){return be})),a.d(i,"fromValues",(function(){return ve})),a.d(i,"set",(function(){return we})),a.d(i,"identity",(function(){return xe})),a.d(i,"transpose",(function(){return Te})),a.d(i,"invert",(function(){return ye})),a.d(i,"adjoint",(function(){return Ce})),a.d(i,"determinant",(function(){return Me})),a.d(i,"multiply",(function(){return Ue})),a.d(i,"translate",(function(){return ke})),a.d(i,"rotate",(function(){return De})),a.d(i,"scale",(function(){return Ie})),a.d(i,"fromTranslation",(function(){return Re})),a.d(i,"fromRotation",(function(){return Be})),a.d(i,"fromScaling",(function(){return Pe})),a.d(i,"fromMat2d",(function(){return Ee})),a.d(i,"fromQuat",(function(){return Fe})),a.d(i,"normalFromMat4",(function(){return Ve})),a.d(i,"projection",(function(){return Oe})),a.d(i,"str",(function(){return Ne})),a.d(i,"frob",(function(){return Le})),a.d(i,"add",(function(){return Ge})),a.d(i,"subtract",(function(){return He})),a.d(i,"multiplyScalar",(function(){return je})),a.d(i,"multiplyScalarAndAdd",(function(){return We})),a.d(i,"exactEquals",(function(){return Ze})),a.d(i,"equals",(function(){return ze})),a.d(i,"mul",(function(){return Ke})),a.d(i,"sub",(function(){return Xe}));var o={};a.r(o),a.d(o,"create",(function(){return Ye})),a.d(o,"clone",(function(){return $e})),a.d(o,"copy",(function(){return qe})),a.d(o,"fromValues",(function(){return Qe})),a.d(o,"set",(function(){return Je})),a.d(o,"identity",(function(){return et})),a.d(o,"transpose",(function(){return tt})),a.d(o,"invert",(function(){return at})),a.d(o,"adjoint",(function(){return rt})),a.d(o,"determinant",(function(){return nt})),a.d(o,"multiply",(function(){return st})),a.d(o,"translate",(function(){return it})),a.d(o,"scale",(function(){return ot})),a.d(o,"rotate",(function(){return lt})),a.d(o,"rotateX",(function(){return ct})),a.d(o,"rotateY",(function(){return ht})),a.d(o,"rotateZ",(function(){return dt})),a.d(o,"fromTranslation",(function(){return ut})),a.d(o,"fromScaling",(function(){return mt})),a.d(o,"fromRotation",(function(){return pt})),a.d(o,"fromXRotation",(function(){return ft})),a.d(o,"fromYRotation",(function(){return At})),a.d(o,"fromZRotation",(function(){return gt})),a.d(o,"fromRotationTranslation",(function(){return _t})),a.d(o,"fromQuat2",(function(){return St})),a.d(o,"getTranslation",(function(){return bt})),a.d(o,"getScaling",(function(){return vt})),a.d(o,"getRotation",(function(){return wt})),a.d(o,"fromRotationTranslationScale",(function(){return xt})),a.d(o,"fromRotationTranslationScaleOrigin",(function(){return Tt})),a.d(o,"fromQuat",(function(){return yt})),a.d(o,"frustum",(function(){return Ct})),a.d(o,"perspective",(function(){return Mt})),a.d(o,"perspectiveFromFieldOfView",(function(){return Ut})),a.d(o,"ortho",(function(){return kt})),a.d(o,"lookAt",(function(){return Dt})),a.d(o,"targetTo",(function(){return It})),a.d(o,"str",(function(){return Rt})),a.d(o,"frob",(function(){return Bt})),a.d(o,"add",(function(){return Pt})),a.d(o,"subtract",(function(){return Et})),a.d(o,"multiplyScalar",(function(){return Ft})),a.d(o,"multiplyScalarAndAdd",(function(){return Vt})),a.d(o,"exactEquals",(function(){return Ot})),a.d(o,"equals",(function(){return Nt})),a.d(o,"mul",(function(){return Lt})),a.d(o,"sub",(function(){return Gt}));var l={};a.r(l),a.d(l,"create",(function(){return Ht})),a.d(l,"clone",(function(){return jt})),a.d(l,"length",(function(){return Wt})),a.d(l,"fromValues",(function(){return Zt})),a.d(l,"copy",(function(){return zt})),a.d(l,"set",(function(){return Kt})),a.d(l,"add",(function(){return Xt})),a.d(l,"subtract",(function(){return Yt})),a.d(l,"multiply",(function(){return $t})),a.d(l,"divide",(function(){return qt})),a.d(l,"ceil",(function(){return Qt})),a.d(l,"floor",(function(){return Jt})),a.d(l,"min",(function(){return ea})),a.d(l,"max",(function(){return ta})),a.d(l,"round",(function(){return aa})),a.d(l,"scale",(function(){return ra})),a.d(l,"scaleAndAdd",(function(){return na})),a.d(l,"distance",(function(){return sa})),a.d(l,"squaredDistance",(function(){return ia})),a.d(l,"squaredLength",(function(){return oa})),a.d(l,"negate",(function(){return la})),a.d(l,"inverse",(function(){return ca})),a.d(l,"normalize",(function(){return ha})),a.d(l,"dot",(function(){return da})),a.d(l,"cross",(function(){return ua})),a.d(l,"lerp",(function(){return ma})),a.d(l,"hermite",(function(){return pa})),a.d(l,"bezier",(function(){return fa})),a.d(l,"random",(function(){return Aa})),a.d(l,"transformMat4",(function(){return ga})),a.d(l,"transformMat3",(function(){return _a})),a.d(l,"transformQuat",(function(){return Sa})),a.d(l,"rotateX",(function(){return ba})),a.d(l,"rotateY",(function(){return va})),a.d(l,"rotateZ",(function(){return wa})),a.d(l,"angle",(function(){return xa})),a.d(l,"zero",(function(){return Ta})),a.d(l,"str",(function(){return ya})),a.d(l,"exactEquals",(function(){return Ca})),a.d(l,"equals",(function(){return Ma})),a.d(l,"sub",(function(){return ka})),a.d(l,"mul",(function(){return Da})),a.d(l,"div",(function(){return Ia})),a.d(l,"dist",(function(){return Ra})),a.d(l,"sqrDist",(function(){return Ba})),a.d(l,"len",(function(){return Pa})),a.d(l,"sqrLen",(function(){return Ea})),a.d(l,"forEach",(function(){return Fa}));var c={};a.r(c),a.d(c,"create",(function(){return Va})),a.d(c,"clone",(function(){return Oa})),a.d(c,"fromValues",(function(){return Na})),a.d(c,"copy",(function(){return La})),a.d(c,"set",(function(){return Ga})),a.d(c,"add",(function(){return Ha})),a.d(c,"subtract",(function(){return ja})),a.d(c,"multiply",(function(){return Wa})),a.d(c,"divide",(function(){return Za})),a.d(c,"ceil",(function(){return za})),a.d(c,"floor",(function(){return Ka})),a.d(c,"min",(function(){return Xa})),a.d(c,"max",(function(){return Ya})),a.d(c,"round",(function(){return $a})),a.d(c,"scale",(function(){return qa})),a.d(c,"scaleAndAdd",(function(){return Qa})),a.d(c,"distance",(function(){return Ja})),a.d(c,"squaredDistance",(function(){return er})),a.d(c,"length",(function(){return tr})),a.d(c,"squaredLength",(function(){return ar})),a.d(c,"negate",(function(){return rr})),a.d(c,"inverse",(function(){return nr})),a.d(c,"normalize",(function(){return sr})),a.d(c,"dot",(function(){return ir})),a.d(c,"cross",(function(){return or})),a.d(c,"lerp",(function(){return lr})),a.d(c,"random",(function(){return cr})),a.d(c,"transformMat4",(function(){return hr})),a.d(c,"transformQuat",(function(){return dr})),a.d(c,"zero",(function(){return ur})),a.d(c,"str",(function(){return mr})),a.d(c,"exactEquals",(function(){return pr})),a.d(c,"equals",(function(){return fr})),a.d(c,"sub",(function(){return Ar})),a.d(c,"mul",(function(){return gr})),a.d(c,"div",(function(){return _r})),a.d(c,"dist",(function(){return Sr})),a.d(c,"sqrDist",(function(){return br})),a.d(c,"len",(function(){return vr})),a.d(c,"sqrLen",(function(){return wr})),a.d(c,"forEach",(function(){return xr}));var h={};a.r(h),a.d(h,"create",(function(){return Tr})),a.d(h,"identity",(function(){return yr})),a.d(h,"setAxisAngle",(function(){return Cr})),a.d(h,"getAxisAngle",(function(){return Mr})),a.d(h,"getAngle",(function(){return Ur})),a.d(h,"multiply",(function(){return kr})),a.d(h,"rotateX",(function(){return Dr})),a.d(h,"rotateY",(function(){return Ir})),a.d(h,"rotateZ",(function(){return Rr})),a.d(h,"calculateW",(function(){return Br})),a.d(h,"exp",(function(){return Pr})),a.d(h,"ln",(function(){return Er})),a.d(h,"pow",(function(){return Fr})),a.d(h,"slerp",(function(){return Vr})),a.d(h,"random",(function(){return Or})),a.d(h,"invert",(function(){return Nr})),a.d(h,"conjugate",(function(){return Lr})),a.d(h,"fromMat3",(function(){return Gr})),a.d(h,"fromEuler",(function(){return Hr})),a.d(h,"str",(function(){return jr})),a.d(h,"clone",(function(){return $r})),a.d(h,"fromValues",(function(){return qr})),a.d(h,"copy",(function(){return Qr})),a.d(h,"set",(function(){return Jr})),a.d(h,"add",(function(){return en})),a.d(h,"mul",(function(){return tn})),a.d(h,"scale",(function(){return an})),a.d(h,"dot",(function(){return rn})),a.d(h,"lerp",(function(){return nn})),a.d(h,"length",(function(){return sn})),a.d(h,"len",(function(){return on})),a.d(h,"squaredLength",(function(){return ln})),a.d(h,"sqrLen",(function(){return cn})),a.d(h,"normalize",(function(){return hn})),a.d(h,"exactEquals",(function(){return dn})),a.d(h,"equals",(function(){return un})),a.d(h,"rotationTo",(function(){return mn})),a.d(h,"sqlerp",(function(){return pn})),a.d(h,"setAxes",(function(){return fn}));var d={};a.r(d),a.d(d,"create",(function(){return An})),a.d(d,"clone",(function(){return gn})),a.d(d,"fromValues",(function(){return _n})),a.d(d,"fromRotationTranslationValues",(function(){return Sn})),a.d(d,"fromRotationTranslation",(function(){return bn})),a.d(d,"fromTranslation",(function(){return vn})),a.d(d,"fromRotation",(function(){return wn})),a.d(d,"fromMat4",(function(){return xn})),a.d(d,"copy",(function(){return Tn})),a.d(d,"identity",(function(){return yn})),a.d(d,"set",(function(){return Cn})),a.d(d,"getReal",(function(){return Mn})),a.d(d,"getDual",(function(){return Un})),a.d(d,"setReal",(function(){return kn})),a.d(d,"setDual",(function(){return Dn})),a.d(d,"getTranslation",(function(){return In})),a.d(d,"translate",(function(){return Rn})),a.d(d,"rotateX",(function(){return Bn})),a.d(d,"rotateY",(function(){return Pn})),a.d(d,"rotateZ",(function(){return En})),a.d(d,"rotateByQuatAppend",(function(){return Fn})),a.d(d,"rotateByQuatPrepend",(function(){return Vn})),a.d(d,"rotateAroundAxis",(function(){return On})),a.d(d,"add",(function(){return Nn})),a.d(d,"multiply",(function(){return Ln})),a.d(d,"mul",(function(){return Gn})),a.d(d,"scale",(function(){return Hn})),a.d(d,"dot",(function(){return jn})),a.d(d,"lerp",(function(){return Wn})),a.d(d,"invert",(function(){return Zn})),a.d(d,"conjugate",(function(){return zn})),a.d(d,"length",(function(){return Kn})),a.d(d,"len",(function(){return Xn})),a.d(d,"squaredLength",(function(){return Yn})),a.d(d,"sqrLen",(function(){return $n})),a.d(d,"normalize",(function(){return qn})),a.d(d,"str",(function(){return Qn})),a.d(d,"exactEquals",(function(){return Jn})),a.d(d,"equals",(function(){return es}));var u={};a.r(u),a.d(u,"create",(function(){return ts})),a.d(u,"clone",(function(){return as})),a.d(u,"fromValues",(function(){return rs})),a.d(u,"copy",(function(){return ns})),a.d(u,"set",(function(){return ss})),a.d(u,"add",(function(){return is})),a.d(u,"subtract",(function(){return os})),a.d(u,"multiply",(function(){return ls})),a.d(u,"divide",(function(){return cs})),a.d(u,"ceil",(function(){return hs})),a.d(u,"floor",(function(){return ds})),a.d(u,"min",(function(){return us})),a.d(u,"max",(function(){return ms})),a.d(u,"round",(function(){return ps})),a.d(u,"scale",(function(){return fs})),a.d(u,"scaleAndAdd",(function(){return As})),a.d(u,"distance",(function(){return gs})),a.d(u,"squaredDistance",(function(){return _s})),a.d(u,"length",(function(){return Ss})),a.d(u,"squaredLength",(function(){return bs})),a.d(u,"negate",(function(){return vs})),a.d(u,"inverse",(function(){return ws})),a.d(u,"normalize",(function(){return xs})),a.d(u,"dot",(function(){return Ts})),a.d(u,"cross",(function(){return ys})),a.d(u,"lerp",(function(){return Cs})),a.d(u,"random",(function(){return Ms})),a.d(u,"transformMat2",(function(){return Us})),a.d(u,"transformMat2d",(function(){return ks})),a.d(u,"transformMat3",(function(){return Ds})),a.d(u,"transformMat4",(function(){return Is})),a.d(u,"rotate",(function(){return Rs})),a.d(u,"angle",(function(){return Bs})),a.d(u,"zero",(function(){return Ps})),a.d(u,"str",(function(){return Es})),a.d(u,"exactEquals",(function(){return Fs})),a.d(u,"equals",(function(){return Vs})),a.d(u,"len",(function(){return Os})),a.d(u,"sub",(function(){return Ns})),a.d(u,"mul",(function(){return Ls})),a.d(u,"div",(function(){return Gs})),a.d(u,"dist",(function(){return Hs})),a.d(u,"sqrDist",(function(){return js})),a.d(u,"sqrLen",(function(){return Ws})),a.d(u,"forEach",(function(){return Zs}));var m=1e-6,p="undefined"!=typeof Float32Array?Float32Array:Array,f=Math.random;function A(e){p=e}var g=Math.PI/180;function _(e){return e*g}function S(e,t){return Math.abs(e-t)<=m*Math.max(1,Math.abs(e),Math.abs(t))}function b(){var e=new p(4);return p!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function v(e){var t=new p(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function w(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function x(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function T(e,t,a,r){var n=new p(4);return n[0]=e,n[1]=t,n[2]=a,n[3]=r,n}function y(e,t,a,r,n){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e}function C(e,t){if(e===t){var a=t[1];e[1]=t[2],e[2]=a}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function M(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=a*s-n*r;return i?(i=1/i,e[0]=s*i,e[1]=-r*i,e[2]=-n*i,e[3]=a*i,e):null}function U(e,t){var a=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=a,e}function k(e){return e[0]*e[3]-e[2]*e[1]}function D(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=a[0],l=a[1],c=a[2],h=a[3];return e[0]=r*o+s*l,e[1]=n*o+i*l,e[2]=r*c+s*h,e[3]=n*c+i*h,e}function I(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=Math.sin(a),l=Math.cos(a);return e[0]=r*l+s*o,e[1]=n*l+i*o,e[2]=r*-o+s*l,e[3]=n*-o+i*l,e}function R(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=a[0],l=a[1];return e[0]=r*o,e[1]=n*o,e[2]=s*l,e[3]=i*l,e}function B(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=a,e[2]=-a,e[3]=r,e}function P(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function E(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function F(e){return Math.hypot(e[0],e[1],e[2],e[3])}function V(e,t,a,r){return e[2]=r[2]/r[0],a[0]=r[0],a[1]=r[1],a[3]=r[3]-e[2]*a[1],[e,t,a]}function O(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e}function N(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e}function L(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function G(e,t){var a=e[0],r=e[1],n=e[2],s=e[3],i=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(a-i)<=m*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(r-o)<=m*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-l)<=m*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-c)<=m*Math.max(1,Math.abs(s),Math.abs(c))}function H(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e}function j(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var W=D,Z=N;function z(){var e=new p(6);return p!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function K(e){var t=new p(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function X(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Y(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function $(e,t,a,r,n,s){var i=new p(6);return i[0]=e,i[1]=t,i[2]=a,i[3]=r,i[4]=n,i[5]=s,i}function q(e,t,a,r,n,s,i){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e[4]=s,e[5]=i,e}function Q(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=t[4],o=t[5],l=a*s-r*n;return l?(l=1/l,e[0]=s*l,e[1]=-r*l,e[2]=-n*l,e[3]=a*l,e[4]=(n*o-s*i)*l,e[5]=(r*i-a*o)*l,e):null}function J(e){return e[0]*e[3]-e[1]*e[2]}function ee(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=a[0],h=a[1],d=a[2],u=a[3],m=a[4],p=a[5];return e[0]=r*c+s*h,e[1]=n*c+i*h,e[2]=r*d+s*u,e[3]=n*d+i*u,e[4]=r*m+s*p+o,e[5]=n*m+i*p+l,e}function te(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=Math.sin(a),h=Math.cos(a);return e[0]=r*h+s*c,e[1]=n*h+i*c,e[2]=r*-c+s*h,e[3]=n*-c+i*h,e[4]=o,e[5]=l,e}function ae(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=a[0],h=a[1];return e[0]=r*c,e[1]=n*c,e[2]=s*h,e[3]=i*h,e[4]=o,e[5]=l,e}function re(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=a[0],h=a[1];return e[0]=r,e[1]=n,e[2]=s,e[3]=i,e[4]=r*c+s*h+o,e[5]=n*c+i*h+l,e}function ne(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=a,e[2]=-a,e[3]=r,e[4]=0,e[5]=0,e}function se(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function ie(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function oe(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function le(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function ce(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e[4]=t[4]+a[4],e[5]=t[5]+a[5],e}function he(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e[4]=t[4]-a[4],e[5]=t[5]-a[5],e}function de(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*a,e[5]=t[5]*a,e}function ue(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e[4]=t[4]+a[4]*r,e[5]=t[5]+a[5]*r,e}function me(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function pe(e,t){var a=e[0],r=e[1],n=e[2],s=e[3],i=e[4],o=e[5],l=t[0],c=t[1],h=t[2],d=t[3],u=t[4],p=t[5];return Math.abs(a-l)<=m*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(r-c)<=m*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-h)<=m*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(s-d)<=m*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(i-u)<=m*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-p)<=m*Math.max(1,Math.abs(o),Math.abs(p))}var fe=ee,Ae=he;function ge(){var e=new p(9);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function _e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Se(e){var t=new p(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function be(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function ve(e,t,a,r,n,s,i,o,l){var c=new p(9);return c[0]=e,c[1]=t,c[2]=a,c[3]=r,c[4]=n,c[5]=s,c[6]=i,c[7]=o,c[8]=l,c}function we(e,t,a,r,n,s,i,o,l,c){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e[4]=s,e[5]=i,e[6]=o,e[7]=l,e[8]=c,e}function xe(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Te(e,t){if(e===t){var a=t[1],r=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=a,e[5]=t[7],e[6]=r,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function ye(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=t[4],o=t[5],l=t[6],c=t[7],h=t[8],d=h*i-o*c,u=-h*s+o*l,m=c*s-i*l,p=a*d+r*u+n*m;return p?(p=1/p,e[0]=d*p,e[1]=(-h*r+n*c)*p,e[2]=(o*r-n*i)*p,e[3]=u*p,e[4]=(h*a-n*l)*p,e[5]=(-o*a+n*s)*p,e[6]=m*p,e[7]=(-c*a+r*l)*p,e[8]=(i*a-r*s)*p,e):null}function Ce(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=t[4],o=t[5],l=t[6],c=t[7],h=t[8];return e[0]=i*h-o*c,e[1]=n*c-r*h,e[2]=r*o-n*i,e[3]=o*l-s*h,e[4]=a*h-n*l,e[5]=n*s-a*o,e[6]=s*c-i*l,e[7]=r*l-a*c,e[8]=a*i-r*s,e}function Me(e){var t=e[0],a=e[1],r=e[2],n=e[3],s=e[4],i=e[5],o=e[6],l=e[7],c=e[8];return t*(c*s-i*l)+a*(-c*n+i*o)+r*(l*n-s*o)}function Ue(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=t[8],u=a[0],m=a[1],p=a[2],f=a[3],A=a[4],g=a[5],_=a[6],S=a[7],b=a[8];return e[0]=u*r+m*i+p*c,e[1]=u*n+m*o+p*h,e[2]=u*s+m*l+p*d,e[3]=f*r+A*i+g*c,e[4]=f*n+A*o+g*h,e[5]=f*s+A*l+g*d,e[6]=_*r+S*i+b*c,e[7]=_*n+S*o+b*h,e[8]=_*s+S*l+b*d,e}function ke(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=t[8],u=a[0],m=a[1];return e[0]=r,e[1]=n,e[2]=s,e[3]=i,e[4]=o,e[5]=l,e[6]=u*r+m*i+c,e[7]=u*n+m*o+h,e[8]=u*s+m*l+d,e}function De(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=t[8],u=Math.sin(a),m=Math.cos(a);return e[0]=m*r+u*i,e[1]=m*n+u*o,e[2]=m*s+u*l,e[3]=m*i-u*r,e[4]=m*o-u*n,e[5]=m*l-u*s,e[6]=c,e[7]=h,e[8]=d,e}function Ie(e,t,a){var r=a[0],n=a[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Re(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Be(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=a,e[2]=0,e[3]=-a,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Pe(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ee(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Fe(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=a+a,o=r+r,l=n+n,c=a*i,h=r*i,d=r*o,u=n*i,m=n*o,p=n*l,f=s*i,A=s*o,g=s*l;return e[0]=1-d-p,e[3]=h-g,e[6]=u+A,e[1]=h+g,e[4]=1-c-p,e[7]=m-f,e[2]=u-A,e[5]=m+f,e[8]=1-c-d,e}function Ve(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=t[4],o=t[5],l=t[6],c=t[7],h=t[8],d=t[9],u=t[10],m=t[11],p=t[12],f=t[13],A=t[14],g=t[15],_=a*o-r*i,S=a*l-n*i,b=a*c-s*i,v=r*l-n*o,w=r*c-s*o,x=n*c-s*l,T=h*f-d*p,y=h*A-u*p,C=h*g-m*p,M=d*A-u*f,U=d*g-m*f,k=u*g-m*A,D=_*k-S*U+b*M+v*C-w*y+x*T;return D?(D=1/D,e[0]=(o*k-l*U+c*M)*D,e[1]=(l*C-i*k-c*y)*D,e[2]=(i*U-o*C+c*T)*D,e[3]=(n*U-r*k-s*M)*D,e[4]=(a*k-n*C+s*y)*D,e[5]=(r*C-a*U-s*T)*D,e[6]=(f*x-A*w+g*v)*D,e[7]=(A*b-p*x-g*S)*D,e[8]=(p*w-f*b+g*_)*D,e):null}function Oe(e,t,a){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/a,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Ne(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Le(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Ge(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e[4]=t[4]+a[4],e[5]=t[5]+a[5],e[6]=t[6]+a[6],e[7]=t[7]+a[7],e[8]=t[8]+a[8],e}function He(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e[4]=t[4]-a[4],e[5]=t[5]-a[5],e[6]=t[6]-a[6],e[7]=t[7]-a[7],e[8]=t[8]-a[8],e}function je(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*a,e}function We(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e[4]=t[4]+a[4]*r,e[5]=t[5]+a[5]*r,e[6]=t[6]+a[6]*r,e[7]=t[7]+a[7]*r,e[8]=t[8]+a[8]*r,e}function Ze(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function ze(e,t){var a=e[0],r=e[1],n=e[2],s=e[3],i=e[4],o=e[5],l=e[6],c=e[7],h=e[8],d=t[0],u=t[1],p=t[2],f=t[3],A=t[4],g=t[5],_=t[6],S=t[7],b=t[8];return Math.abs(a-d)<=m*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(r-u)<=m*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-p)<=m*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(s-f)<=m*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(i-A)<=m*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(o-g)<=m*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(l-_)<=m*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(c-S)<=m*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(h-b)<=m*Math.max(1,Math.abs(h),Math.abs(b))}var Ke=Ue,Xe=He;function Ye(){var e=new p(16);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function $e(e){var t=new p(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function qe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qe(e,t,a,r,n,s,i,o,l,c,h,d,u,m,f,A){var g=new p(16);return g[0]=e,g[1]=t,g[2]=a,g[3]=r,g[4]=n,g[5]=s,g[6]=i,g[7]=o,g[8]=l,g[9]=c,g[10]=h,g[11]=d,g[12]=u,g[13]=m,g[14]=f,g[15]=A,g}function Je(e,t,a,r,n,s,i,o,l,c,h,d,u,m,p,f,A){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e[4]=s,e[5]=i,e[6]=o,e[7]=l,e[8]=c,e[9]=h,e[10]=d,e[11]=u,e[12]=m,e[13]=p,e[14]=f,e[15]=A,e}function et(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function tt(e,t){if(e===t){var a=t[1],r=t[2],n=t[3],s=t[6],i=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=a,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=n,e[13]=i,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function at(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=t[4],o=t[5],l=t[6],c=t[7],h=t[8],d=t[9],u=t[10],m=t[11],p=t[12],f=t[13],A=t[14],g=t[15],_=a*o-r*i,S=a*l-n*i,b=a*c-s*i,v=r*l-n*o,w=r*c-s*o,x=n*c-s*l,T=h*f-d*p,y=h*A-u*p,C=h*g-m*p,M=d*A-u*f,U=d*g-m*f,k=u*g-m*A,D=_*k-S*U+b*M+v*C-w*y+x*T;return D?(D=1/D,e[0]=(o*k-l*U+c*M)*D,e[1]=(n*U-r*k-s*M)*D,e[2]=(f*x-A*w+g*v)*D,e[3]=(u*w-d*x-m*v)*D,e[4]=(l*C-i*k-c*y)*D,e[5]=(a*k-n*C+s*y)*D,e[6]=(A*b-p*x-g*S)*D,e[7]=(h*x-u*b+m*S)*D,e[8]=(i*U-o*C+c*T)*D,e[9]=(r*C-a*U-s*T)*D,e[10]=(p*w-f*b+g*_)*D,e[11]=(d*b-h*w-m*_)*D,e[12]=(o*y-i*M-l*T)*D,e[13]=(a*M-r*y+n*T)*D,e[14]=(f*S-p*v-A*_)*D,e[15]=(h*v-d*S+u*_)*D,e):null}function rt(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=t[4],o=t[5],l=t[6],c=t[7],h=t[8],d=t[9],u=t[10],m=t[11],p=t[12],f=t[13],A=t[14],g=t[15];return e[0]=o*(u*g-m*A)-d*(l*g-c*A)+f*(l*m-c*u),e[1]=-(r*(u*g-m*A)-d*(n*g-s*A)+f*(n*m-s*u)),e[2]=r*(l*g-c*A)-o*(n*g-s*A)+f*(n*c-s*l),e[3]=-(r*(l*m-c*u)-o*(n*m-s*u)+d*(n*c-s*l)),e[4]=-(i*(u*g-m*A)-h*(l*g-c*A)+p*(l*m-c*u)),e[5]=a*(u*g-m*A)-h*(n*g-s*A)+p*(n*m-s*u),e[6]=-(a*(l*g-c*A)-i*(n*g-s*A)+p*(n*c-s*l)),e[7]=a*(l*m-c*u)-i*(n*m-s*u)+h*(n*c-s*l),e[8]=i*(d*g-m*f)-h*(o*g-c*f)+p*(o*m-c*d),e[9]=-(a*(d*g-m*f)-h*(r*g-s*f)+p*(r*m-s*d)),e[10]=a*(o*g-c*f)-i*(r*g-s*f)+p*(r*c-s*o),e[11]=-(a*(o*m-c*d)-i*(r*m-s*d)+h*(r*c-s*o)),e[12]=-(i*(d*A-u*f)-h*(o*A-l*f)+p*(o*u-l*d)),e[13]=a*(d*A-u*f)-h*(r*A-n*f)+p*(r*u-n*d),e[14]=-(a*(o*A-l*f)-i*(r*A-n*f)+p*(r*l-n*o)),e[15]=a*(o*u-l*d)-i*(r*u-n*d)+h*(r*l-n*o),e}function nt(e){var t=e[0],a=e[1],r=e[2],n=e[3],s=e[4],i=e[5],o=e[6],l=e[7],c=e[8],h=e[9],d=e[10],u=e[11],m=e[12],p=e[13],f=e[14],A=e[15];return(t*i-a*s)*(d*A-u*f)-(t*o-r*s)*(h*A-u*p)+(t*l-n*s)*(h*f-d*p)+(a*o-r*i)*(c*A-u*m)-(a*l-n*i)*(c*f-d*m)+(r*l-n*o)*(c*p-h*m)}function st(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=t[8],u=t[9],m=t[10],p=t[11],f=t[12],A=t[13],g=t[14],_=t[15],S=a[0],b=a[1],v=a[2],w=a[3];return e[0]=S*r+b*o+v*d+w*f,e[1]=S*n+b*l+v*u+w*A,e[2]=S*s+b*c+v*m+w*g,e[3]=S*i+b*h+v*p+w*_,S=a[4],b=a[5],v=a[6],w=a[7],e[4]=S*r+b*o+v*d+w*f,e[5]=S*n+b*l+v*u+w*A,e[6]=S*s+b*c+v*m+w*g,e[7]=S*i+b*h+v*p+w*_,S=a[8],b=a[9],v=a[10],w=a[11],e[8]=S*r+b*o+v*d+w*f,e[9]=S*n+b*l+v*u+w*A,e[10]=S*s+b*c+v*m+w*g,e[11]=S*i+b*h+v*p+w*_,S=a[12],b=a[13],v=a[14],w=a[15],e[12]=S*r+b*o+v*d+w*f,e[13]=S*n+b*l+v*u+w*A,e[14]=S*s+b*c+v*m+w*g,e[15]=S*i+b*h+v*p+w*_,e}function it(e,t,a){var r,n,s,i,o,l,c,h,d,u,m,p,f=a[0],A=a[1],g=a[2];return t===e?(e[12]=t[0]*f+t[4]*A+t[8]*g+t[12],e[13]=t[1]*f+t[5]*A+t[9]*g+t[13],e[14]=t[2]*f+t[6]*A+t[10]*g+t[14],e[15]=t[3]*f+t[7]*A+t[11]*g+t[15]):(r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=t[8],u=t[9],m=t[10],p=t[11],e[0]=r,e[1]=n,e[2]=s,e[3]=i,e[4]=o,e[5]=l,e[6]=c,e[7]=h,e[8]=d,e[9]=u,e[10]=m,e[11]=p,e[12]=r*f+o*A+d*g+t[12],e[13]=n*f+l*A+u*g+t[13],e[14]=s*f+c*A+m*g+t[14],e[15]=i*f+h*A+p*g+t[15]),e}function ot(e,t,a){var r=a[0],n=a[1],s=a[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function lt(e,t,a,r){var n,s,i,o,l,c,h,d,u,p,f,A,g,_,S,b,v,w,x,T,y,C,M,U,k=r[0],D=r[1],I=r[2],R=Math.hypot(k,D,I);return R<m?null:(k*=R=1/R,D*=R,I*=R,n=Math.sin(a),i=1-(s=Math.cos(a)),o=t[0],l=t[1],c=t[2],h=t[3],d=t[4],u=t[5],p=t[6],f=t[7],A=t[8],g=t[9],_=t[10],S=t[11],b=k*k*i+s,v=D*k*i+I*n,w=I*k*i-D*n,x=k*D*i-I*n,T=D*D*i+s,y=I*D*i+k*n,C=k*I*i+D*n,M=D*I*i-k*n,U=I*I*i+s,e[0]=o*b+d*v+A*w,e[1]=l*b+u*v+g*w,e[2]=c*b+p*v+_*w,e[3]=h*b+f*v+S*w,e[4]=o*x+d*T+A*y,e[5]=l*x+u*T+g*y,e[6]=c*x+p*T+_*y,e[7]=h*x+f*T+S*y,e[8]=o*C+d*M+A*U,e[9]=l*C+u*M+g*U,e[10]=c*C+p*M+_*U,e[11]=h*C+f*M+S*U,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ct(e,t,a){var r=Math.sin(a),n=Math.cos(a),s=t[4],i=t[5],o=t[6],l=t[7],c=t[8],h=t[9],d=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*n+c*r,e[5]=i*n+h*r,e[6]=o*n+d*r,e[7]=l*n+u*r,e[8]=c*n-s*r,e[9]=h*n-i*r,e[10]=d*n-o*r,e[11]=u*n-l*r,e}function ht(e,t,a){var r=Math.sin(a),n=Math.cos(a),s=t[0],i=t[1],o=t[2],l=t[3],c=t[8],h=t[9],d=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n-c*r,e[1]=i*n-h*r,e[2]=o*n-d*r,e[3]=l*n-u*r,e[8]=s*r+c*n,e[9]=i*r+h*n,e[10]=o*r+d*n,e[11]=l*r+u*n,e}function dt(e,t,a){var r=Math.sin(a),n=Math.cos(a),s=t[0],i=t[1],o=t[2],l=t[3],c=t[4],h=t[5],d=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n+c*r,e[1]=i*n+h*r,e[2]=o*n+d*r,e[3]=l*n+u*r,e[4]=c*n-s*r,e[5]=h*n-i*r,e[6]=d*n-o*r,e[7]=u*n-l*r,e}function ut(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function mt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pt(e,t,a){var r,n,s,i=a[0],o=a[1],l=a[2],c=Math.hypot(i,o,l);return c<m?null:(i*=c=1/c,o*=c,l*=c,r=Math.sin(t),s=1-(n=Math.cos(t)),e[0]=i*i*s+n,e[1]=o*i*s+l*r,e[2]=l*i*s-o*r,e[3]=0,e[4]=i*o*s-l*r,e[5]=o*o*s+n,e[6]=l*o*s+i*r,e[7]=0,e[8]=i*l*s+o*r,e[9]=o*l*s-i*r,e[10]=l*l*s+n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function ft(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=a,e[7]=0,e[8]=0,e[9]=-a,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function At(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-a,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=a,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function gt(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=a,e[2]=0,e[3]=0,e[4]=-a,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _t(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=r+r,l=n+n,c=s+s,h=r*o,d=r*l,u=r*c,m=n*l,p=n*c,f=s*c,A=i*o,g=i*l,_=i*c;return e[0]=1-(m+f),e[1]=d+_,e[2]=u-g,e[3]=0,e[4]=d-_,e[5]=1-(h+f),e[6]=p+A,e[7]=0,e[8]=u+g,e[9]=p-A,e[10]=1-(h+m),e[11]=0,e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=1,e}function St(e,t){var a=new p(3),r=-t[0],n=-t[1],s=-t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=r*r+n*n+s*s+i*i;return d>0?(a[0]=2*(o*i+h*r+l*s-c*n)/d,a[1]=2*(l*i+h*n+c*r-o*s)/d,a[2]=2*(c*i+h*s+o*n-l*r)/d):(a[0]=2*(o*i+h*r+l*s-c*n),a[1]=2*(l*i+h*n+c*r-o*s),a[2]=2*(c*i+h*s+o*n-l*r)),_t(e,t,a),e}function bt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function vt(e,t){var a=t[0],r=t[1],n=t[2],s=t[4],i=t[5],o=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(a,r,n),e[1]=Math.hypot(s,i,o),e[2]=Math.hypot(l,c,h),e}function wt(e,t){var a=new p(3);vt(a,t);var r=1/a[0],n=1/a[1],s=1/a[2],i=t[0]*r,o=t[1]*n,l=t[2]*s,c=t[4]*r,h=t[5]*n,d=t[6]*s,u=t[8]*r,m=t[9]*n,f=t[10]*s,A=i+h+f,g=0;return A>0?(g=2*Math.sqrt(A+1),e[3]=.25*g,e[0]=(d-m)/g,e[1]=(u-l)/g,e[2]=(o-c)/g):i>h&&i>f?(g=2*Math.sqrt(1+i-h-f),e[3]=(d-m)/g,e[0]=.25*g,e[1]=(o+c)/g,e[2]=(u+l)/g):h>f?(g=2*Math.sqrt(1+h-i-f),e[3]=(u-l)/g,e[0]=(o+c)/g,e[1]=.25*g,e[2]=(d+m)/g):(g=2*Math.sqrt(1+f-i-h),e[3]=(o-c)/g,e[0]=(u+l)/g,e[1]=(d+m)/g,e[2]=.25*g),e}function xt(e,t,a,r){var n=t[0],s=t[1],i=t[2],o=t[3],l=n+n,c=s+s,h=i+i,d=n*l,u=n*c,m=n*h,p=s*c,f=s*h,A=i*h,g=o*l,_=o*c,S=o*h,b=r[0],v=r[1],w=r[2];return e[0]=(1-(p+A))*b,e[1]=(u+S)*b,e[2]=(m-_)*b,e[3]=0,e[4]=(u-S)*v,e[5]=(1-(d+A))*v,e[6]=(f+g)*v,e[7]=0,e[8]=(m+_)*w,e[9]=(f-g)*w,e[10]=(1-(d+p))*w,e[11]=0,e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=1,e}function Tt(e,t,a,r,n){var s=t[0],i=t[1],o=t[2],l=t[3],c=s+s,h=i+i,d=o+o,u=s*c,m=s*h,p=s*d,f=i*h,A=i*d,g=o*d,_=l*c,S=l*h,b=l*d,v=r[0],w=r[1],x=r[2],T=n[0],y=n[1],C=n[2],M=(1-(f+g))*v,U=(m+b)*v,k=(p-S)*v,D=(m-b)*w,I=(1-(u+g))*w,R=(A+_)*w,B=(p+S)*x,P=(A-_)*x,E=(1-(u+f))*x;return e[0]=M,e[1]=U,e[2]=k,e[3]=0,e[4]=D,e[5]=I,e[6]=R,e[7]=0,e[8]=B,e[9]=P,e[10]=E,e[11]=0,e[12]=a[0]+T-(M*T+D*y+B*C),e[13]=a[1]+y-(U*T+I*y+P*C),e[14]=a[2]+C-(k*T+R*y+E*C),e[15]=1,e}function yt(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=a+a,o=r+r,l=n+n,c=a*i,h=r*i,d=r*o,u=n*i,m=n*o,p=n*l,f=s*i,A=s*o,g=s*l;return e[0]=1-d-p,e[1]=h+g,e[2]=u-A,e[3]=0,e[4]=h-g,e[5]=1-c-p,e[6]=m+f,e[7]=0,e[8]=u+A,e[9]=m-f,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ct(e,t,a,r,n,s,i){var o=1/(a-t),l=1/(n-r),c=1/(s-i);return e[0]=2*s*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(a+t)*o,e[9]=(n+r)*l,e[10]=(i+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=i*s*2*c,e[15]=0,e}function Mt(e,t,a,r,n){var s,i=1/Math.tan(t/2);return e[0]=i/a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(s=1/(r-n),e[10]=(n+r)*s,e[14]=2*n*r*s):(e[10]=-1,e[14]=-2*r),e}function Ut(e,t,a,r){var n=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),i=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(i+o),c=2/(n+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(i-o)*l*.5,e[9]=(n-s)*c*.5,e[10]=r/(a-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*a/(a-r),e[15]=0,e}function kt(e,t,a,r,n,s,i){var o=1/(t-a),l=1/(r-n),c=1/(s-i);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+a)*o,e[13]=(n+r)*l,e[14]=(i+s)*c,e[15]=1,e}function Dt(e,t,a,r){var n,s,i,o,l,c,h,d,u,p,f=t[0],A=t[1],g=t[2],_=r[0],S=r[1],b=r[2],v=a[0],w=a[1],x=a[2];return Math.abs(f-v)<m&&Math.abs(A-w)<m&&Math.abs(g-x)<m?et(e):(h=f-v,d=A-w,u=g-x,n=S*(u*=p=1/Math.hypot(h,d,u))-b*(d*=p),s=b*(h*=p)-_*u,i=_*d-S*h,(p=Math.hypot(n,s,i))?(n*=p=1/p,s*=p,i*=p):(n=0,s=0,i=0),o=d*i-u*s,l=u*n-h*i,c=h*s-d*n,(p=Math.hypot(o,l,c))?(o*=p=1/p,l*=p,c*=p):(o=0,l=0,c=0),e[0]=n,e[1]=o,e[2]=h,e[3]=0,e[4]=s,e[5]=l,e[6]=d,e[7]=0,e[8]=i,e[9]=c,e[10]=u,e[11]=0,e[12]=-(n*f+s*A+i*g),e[13]=-(o*f+l*A+c*g),e[14]=-(h*f+d*A+u*g),e[15]=1,e)}function It(e,t,a,r){var n=t[0],s=t[1],i=t[2],o=r[0],l=r[1],c=r[2],h=n-a[0],d=s-a[1],u=i-a[2],m=h*h+d*d+u*u;m>0&&(h*=m=1/Math.sqrt(m),d*=m,u*=m);var p=l*u-c*d,f=c*h-o*u,A=o*d-l*h;return(m=p*p+f*f+A*A)>0&&(p*=m=1/Math.sqrt(m),f*=m,A*=m),e[0]=p,e[1]=f,e[2]=A,e[3]=0,e[4]=d*A-u*f,e[5]=u*p-h*A,e[6]=h*f-d*p,e[7]=0,e[8]=h,e[9]=d,e[10]=u,e[11]=0,e[12]=n,e[13]=s,e[14]=i,e[15]=1,e}function Rt(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Bt(e){return Math.hypot(e[0],e[1],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Pt(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e[4]=t[4]+a[4],e[5]=t[5]+a[5],e[6]=t[6]+a[6],e[7]=t[7]+a[7],e[8]=t[8]+a[8],e[9]=t[9]+a[9],e[10]=t[10]+a[10],e[11]=t[11]+a[11],e[12]=t[12]+a[12],e[13]=t[13]+a[13],e[14]=t[14]+a[14],e[15]=t[15]+a[15],e}function Et(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e[4]=t[4]-a[4],e[5]=t[5]-a[5],e[6]=t[6]-a[6],e[7]=t[7]-a[7],e[8]=t[8]-a[8],e[9]=t[9]-a[9],e[10]=t[10]-a[10],e[11]=t[11]-a[11],e[12]=t[12]-a[12],e[13]=t[13]-a[13],e[14]=t[14]-a[14],e[15]=t[15]-a[15],e}function Ft(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12]*a,e[13]=t[13]*a,e[14]=t[14]*a,e[15]=t[15]*a,e}function Vt(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e[4]=t[4]+a[4]*r,e[5]=t[5]+a[5]*r,e[6]=t[6]+a[6]*r,e[7]=t[7]+a[7]*r,e[8]=t[8]+a[8]*r,e[9]=t[9]+a[9]*r,e[10]=t[10]+a[10]*r,e[11]=t[11]+a[11]*r,e[12]=t[12]+a[12]*r,e[13]=t[13]+a[13]*r,e[14]=t[14]+a[14]*r,e[15]=t[15]+a[15]*r,e}function Ot(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Nt(e,t){var a=e[0],r=e[1],n=e[2],s=e[3],i=e[4],o=e[5],l=e[6],c=e[7],h=e[8],d=e[9],u=e[10],p=e[11],f=e[12],A=e[13],g=e[14],_=e[15],S=t[0],b=t[1],v=t[2],w=t[3],x=t[4],T=t[5],y=t[6],C=t[7],M=t[8],U=t[9],k=t[10],D=t[11],I=t[12],R=t[13],B=t[14],P=t[15];return Math.abs(a-S)<=m*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(r-b)<=m*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-v)<=m*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(s-w)<=m*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(i-x)<=m*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-T)<=m*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(l-y)<=m*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-C)<=m*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-M)<=m*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-U)<=m*Math.max(1,Math.abs(d),Math.abs(U))&&Math.abs(u-k)<=m*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(p-D)<=m*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(f-I)<=m*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(A-R)<=m*Math.max(1,Math.abs(A),Math.abs(R))&&Math.abs(g-B)<=m*Math.max(1,Math.abs(g),Math.abs(B))&&Math.abs(_-P)<=m*Math.max(1,Math.abs(_),Math.abs(P))}var Lt=st,Gt=Et;function Ht(){var e=new p(3);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function jt(e){var t=new p(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Wt(e){var t=e[0],a=e[1],r=e[2];return Math.hypot(t,a,r)}function Zt(e,t,a){var r=new p(3);return r[0]=e,r[1]=t,r[2]=a,r}function zt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Kt(e,t,a,r){return e[0]=t,e[1]=a,e[2]=r,e}function Xt(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e}function Yt(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e}function $t(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e}function qt(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e}function Qt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Jt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function ea(e,t,a){return e[0]=Math.min(t[0],a[0]),e[1]=Math.min(t[1],a[1]),e[2]=Math.min(t[2],a[2]),e}function ta(e,t,a){return e[0]=Math.max(t[0],a[0]),e[1]=Math.max(t[1],a[1]),e[2]=Math.max(t[2],a[2]),e}function aa(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function ra(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function na(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e}function sa(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return Math.hypot(a,r,n)}function ia(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return a*a+r*r+n*n}function oa(e){var t=e[0],a=e[1],r=e[2];return t*t+a*a+r*r}function la(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function ca(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function ha(e,t){var a=t[0],r=t[1],n=t[2],s=a*a+r*r+n*n;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function da(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ua(e,t,a){var r=t[0],n=t[1],s=t[2],i=a[0],o=a[1],l=a[2];return e[0]=n*l-s*o,e[1]=s*i-r*l,e[2]=r*o-n*i,e}function ma(e,t,a,r){var n=t[0],s=t[1],i=t[2];return e[0]=n+r*(a[0]-n),e[1]=s+r*(a[1]-s),e[2]=i+r*(a[2]-i),e}function pa(e,t,a,r,n,s){var i=s*s,o=i*(2*s-3)+1,l=i*(s-2)+s,c=i*(s-1),h=i*(3-2*s);return e[0]=t[0]*o+a[0]*l+r[0]*c+n[0]*h,e[1]=t[1]*o+a[1]*l+r[1]*c+n[1]*h,e[2]=t[2]*o+a[2]*l+r[2]*c+n[2]*h,e}function fa(e,t,a,r,n,s){var i=1-s,o=i*i,l=s*s,c=o*i,h=3*s*o,d=3*l*i,u=l*s;return e[0]=t[0]*c+a[0]*h+r[0]*d+n[0]*u,e[1]=t[1]*c+a[1]*h+r[1]*d+n[1]*u,e[2]=t[2]*c+a[2]*h+r[2]*d+n[2]*u,e}function Aa(e,t){t=t||1;var a=2*f()*Math.PI,r=2*f()-1,n=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(a)*n,e[1]=Math.sin(a)*n,e[2]=r*t,e}function ga(e,t,a){var r=t[0],n=t[1],s=t[2],i=a[3]*r+a[7]*n+a[11]*s+a[15];return i=i||1,e[0]=(a[0]*r+a[4]*n+a[8]*s+a[12])/i,e[1]=(a[1]*r+a[5]*n+a[9]*s+a[13])/i,e[2]=(a[2]*r+a[6]*n+a[10]*s+a[14])/i,e}function _a(e,t,a){var r=t[0],n=t[1],s=t[2];return e[0]=r*a[0]+n*a[3]+s*a[6],e[1]=r*a[1]+n*a[4]+s*a[7],e[2]=r*a[2]+n*a[5]+s*a[8],e}function Sa(e,t,a){var r=a[0],n=a[1],s=a[2],i=a[3],o=t[0],l=t[1],c=t[2],h=n*c-s*l,d=s*o-r*c,u=r*l-n*o,m=n*u-s*d,p=s*h-r*u,f=r*d-n*h,A=2*i;return h*=A,d*=A,u*=A,m*=2,p*=2,f*=2,e[0]=o+h+m,e[1]=l+d+p,e[2]=c+u+f,e}function ba(e,t,a,r){var n=[],s=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],s[0]=n[0],s[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),s[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),e[0]=s[0]+a[0],e[1]=s[1]+a[1],e[2]=s[2]+a[2],e}function va(e,t,a,r){var n=[],s=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],s[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),s[1]=n[1],s[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),e[0]=s[0]+a[0],e[1]=s[1]+a[1],e[2]=s[2]+a[2],e}function wa(e,t,a,r){var n=[],s=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],s[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),s[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),s[2]=n[2],e[0]=s[0]+a[0],e[1]=s[1]+a[1],e[2]=s[2]+a[2],e}function xa(e,t){var a=Zt(e[0],e[1],e[2]),r=Zt(t[0],t[1],t[2]);ha(a,a),ha(r,r);var n=da(a,r);return n>1?0:n<-1?Math.PI:Math.acos(n)}function Ta(e){return e[0]=0,e[1]=0,e[2]=0,e}function ya(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ca(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Ma(e,t){var a=e[0],r=e[1],n=e[2],s=t[0],i=t[1],o=t[2];return Math.abs(a-s)<=m*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(r-i)<=m*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=m*Math.max(1,Math.abs(n),Math.abs(o))}var Ua,ka=Yt,Da=$t,Ia=qt,Ra=sa,Ba=ia,Pa=Wt,Ea=oa,Fa=(Ua=Ht(),function(e,t,a,r,n,s){var i,o;for(t||(t=3),a||(a=0),o=r?Math.min(r*t+a,e.length):e.length,i=a;i<o;i+=t)Ua[0]=e[i],Ua[1]=e[i+1],Ua[2]=e[i+2],n(Ua,Ua,s),e[i]=Ua[0],e[i+1]=Ua[1],e[i+2]=Ua[2];return e});function Va(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Oa(e){var t=new p(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Na(e,t,a,r){var n=new p(4);return n[0]=e,n[1]=t,n[2]=a,n[3]=r,n}function La(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Ga(e,t,a,r,n){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e}function Ha(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e}function ja(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e}function Wa(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e[3]=t[3]*a[3],e}function Za(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e[3]=t[3]/a[3],e}function za(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Ka(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Xa(e,t,a){return e[0]=Math.min(t[0],a[0]),e[1]=Math.min(t[1],a[1]),e[2]=Math.min(t[2],a[2]),e[3]=Math.min(t[3],a[3]),e}function Ya(e,t,a){return e[0]=Math.max(t[0],a[0]),e[1]=Math.max(t[1],a[1]),e[2]=Math.max(t[2],a[2]),e[3]=Math.max(t[3],a[3]),e}function $a(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function qa(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e}function Qa(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e}function Ja(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return Math.hypot(a,r,n,s)}function er(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return a*a+r*r+n*n+s*s}function tr(e){var t=e[0],a=e[1],r=e[2],n=e[3];return Math.hypot(t,a,r,n)}function ar(e){var t=e[0],a=e[1],r=e[2],n=e[3];return t*t+a*a+r*r+n*n}function rr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function nr(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function sr(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=a*a+r*r+n*n+s*s;return i>0&&(i=1/Math.sqrt(i)),e[0]=a*i,e[1]=r*i,e[2]=n*i,e[3]=s*i,e}function ir(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function or(e,t,a,r){var n=a[0]*r[1]-a[1]*r[0],s=a[0]*r[2]-a[2]*r[0],i=a[0]*r[3]-a[3]*r[0],o=a[1]*r[2]-a[2]*r[1],l=a[1]*r[3]-a[3]*r[1],c=a[2]*r[3]-a[3]*r[2],h=t[0],d=t[1],u=t[2],m=t[3];return e[0]=d*c-u*l+m*o,e[1]=-h*c+u*i-m*s,e[2]=h*l-d*i+m*n,e[3]=-h*o+d*s-u*n,e}function lr(e,t,a,r){var n=t[0],s=t[1],i=t[2],o=t[3];return e[0]=n+r*(a[0]-n),e[1]=s+r*(a[1]-s),e[2]=i+r*(a[2]-i),e[3]=o+r*(a[3]-o),e}function cr(e,t){var a,r,n,s,i,o;t=t||1;do{i=(a=2*f()-1)*a+(r=2*f()-1)*r}while(i>=1);do{o=(n=2*f()-1)*n+(s=2*f()-1)*s}while(o>=1);var l=Math.sqrt((1-i)/o);return e[0]=t*a,e[1]=t*r,e[2]=t*n*l,e[3]=t*s*l,e}function hr(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3];return e[0]=a[0]*r+a[4]*n+a[8]*s+a[12]*i,e[1]=a[1]*r+a[5]*n+a[9]*s+a[13]*i,e[2]=a[2]*r+a[6]*n+a[10]*s+a[14]*i,e[3]=a[3]*r+a[7]*n+a[11]*s+a[15]*i,e}function dr(e,t,a){var r=t[0],n=t[1],s=t[2],i=a[0],o=a[1],l=a[2],c=a[3],h=c*r+o*s-l*n,d=c*n+l*r-i*s,u=c*s+i*n-o*r,m=-i*r-o*n-l*s;return e[0]=h*c+m*-i+d*-l-u*-o,e[1]=d*c+m*-o+u*-i-h*-l,e[2]=u*c+m*-l+h*-o-d*-i,e[3]=t[3],e}function ur(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function mr(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function pr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function fr(e,t){var a=e[0],r=e[1],n=e[2],s=e[3],i=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(a-i)<=m*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(r-o)<=m*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-l)<=m*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-c)<=m*Math.max(1,Math.abs(s),Math.abs(c))}var Ar=ja,gr=Wa,_r=Za,Sr=Ja,br=er,vr=tr,wr=ar,xr=function(){var e=Va();return function(t,a,r,n,s,i){var o,l;for(a||(a=4),r||(r=0),l=n?Math.min(n*a+r,t.length):t.length,o=r;o<l;o+=a)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,i),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function Tr(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function yr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Cr(e,t,a){a*=.5;var r=Math.sin(a);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(a),e}function Mr(e,t){var a=2*Math.acos(t[3]),r=Math.sin(a/2);return r>m?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),a}function Ur(e,t){var a=rn(e,t);return Math.acos(2*a*a-1)}function kr(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=a[0],l=a[1],c=a[2],h=a[3];return e[0]=r*h+i*o+n*c-s*l,e[1]=n*h+i*l+s*o-r*c,e[2]=s*h+i*c+r*l-n*o,e[3]=i*h-r*o-n*l-s*c,e}function Dr(e,t,a){a*=.5;var r=t[0],n=t[1],s=t[2],i=t[3],o=Math.sin(a),l=Math.cos(a);return e[0]=r*l+i*o,e[1]=n*l+s*o,e[2]=s*l-n*o,e[3]=i*l-r*o,e}function Ir(e,t,a){a*=.5;var r=t[0],n=t[1],s=t[2],i=t[3],o=Math.sin(a),l=Math.cos(a);return e[0]=r*l-s*o,e[1]=n*l+i*o,e[2]=s*l+r*o,e[3]=i*l-n*o,e}function Rr(e,t,a){a*=.5;var r=t[0],n=t[1],s=t[2],i=t[3],o=Math.sin(a),l=Math.cos(a);return e[0]=r*l+n*o,e[1]=n*l-r*o,e[2]=s*l+i*o,e[3]=i*l-s*o,e}function Br(e,t){var a=t[0],r=t[1],n=t[2];return e[0]=a,e[1]=r,e[2]=n,e[3]=Math.sqrt(Math.abs(1-a*a-r*r-n*n)),e}function Pr(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=Math.sqrt(a*a+r*r+n*n),o=Math.exp(s),l=i>0?o*Math.sin(i)/i:0;return e[0]=a*l,e[1]=r*l,e[2]=n*l,e[3]=o*Math.cos(i),e}function Er(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=Math.sqrt(a*a+r*r+n*n),o=i>0?Math.atan2(i,s)/i:0;return e[0]=a*o,e[1]=r*o,e[2]=n*o,e[3]=.5*Math.log(a*a+r*r+n*n+s*s),e}function Fr(e,t,a){return Er(e,t),an(e,e,a),Pr(e,e),e}function Vr(e,t,a,r){var n,s,i,o,l,c=t[0],h=t[1],d=t[2],u=t[3],p=a[0],f=a[1],A=a[2],g=a[3];return(s=c*p+h*f+d*A+u*g)<0&&(s=-s,p=-p,f=-f,A=-A,g=-g),1-s>m?(n=Math.acos(s),i=Math.sin(n),o=Math.sin((1-r)*n)/i,l=Math.sin(r*n)/i):(o=1-r,l=r),e[0]=o*c+l*p,e[1]=o*h+l*f,e[2]=o*d+l*A,e[3]=o*u+l*g,e}function Or(e){var t=f(),a=f(),r=f(),n=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=n*Math.sin(2*Math.PI*a),e[1]=n*Math.cos(2*Math.PI*a),e[2]=s*Math.sin(2*Math.PI*r),e[3]=s*Math.cos(2*Math.PI*r),e}function Nr(e,t){var a=t[0],r=t[1],n=t[2],s=t[3],i=a*a+r*r+n*n+s*s,o=i?1/i:0;return e[0]=-a*o,e[1]=-r*o,e[2]=-n*o,e[3]=s*o,e}function Lr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Gr(e,t){var a,r=t[0]+t[4]+t[8];if(r>0)a=Math.sqrt(r+1),e[3]=.5*a,a=.5/a,e[0]=(t[5]-t[7])*a,e[1]=(t[6]-t[2])*a,e[2]=(t[1]-t[3])*a;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var s=(n+1)%3,i=(n+2)%3;a=Math.sqrt(t[3*n+n]-t[3*s+s]-t[3*i+i]+1),e[n]=.5*a,a=.5/a,e[3]=(t[3*s+i]-t[3*i+s])*a,e[s]=(t[3*s+n]+t[3*n+s])*a,e[i]=(t[3*i+n]+t[3*n+i])*a}return e}function Hr(e,t,a,r){var n=.5*Math.PI/180;t*=n,a*=n,r*=n;var s=Math.sin(t),i=Math.cos(t),o=Math.sin(a),l=Math.cos(a),c=Math.sin(r),h=Math.cos(r);return e[0]=s*l*h-i*o*c,e[1]=i*o*h+s*l*c,e[2]=i*l*c-s*o*h,e[3]=i*l*h+s*o*c,e}function jr(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Wr,Zr,zr,Kr,Xr,Yr,$r=Oa,qr=Na,Qr=La,Jr=Ga,en=Ha,tn=kr,an=qa,rn=ir,nn=lr,sn=tr,on=sn,ln=ar,cn=ln,hn=sr,dn=pr,un=fr,mn=(Wr=Ht(),Zr=Zt(1,0,0),zr=Zt(0,1,0),function(e,t,a){var r=da(t,a);return r<-.999999?(ua(Wr,Zr,t),Pa(Wr)<1e-6&&ua(Wr,zr,t),ha(Wr,Wr),Cr(e,Wr,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(ua(Wr,t,a),e[0]=Wr[0],e[1]=Wr[1],e[2]=Wr[2],e[3]=1+r,hn(e,e))}),pn=(Kr=Tr(),Xr=Tr(),function(e,t,a,r,n,s){return Vr(Kr,t,n,s),Vr(Xr,a,r,s),Vr(e,Kr,Xr,2*s*(1-s)),e}),fn=(Yr=ge(),function(e,t,a,r){return Yr[0]=a[0],Yr[3]=a[1],Yr[6]=a[2],Yr[1]=r[0],Yr[4]=r[1],Yr[7]=r[2],Yr[2]=-t[0],Yr[5]=-t[1],Yr[8]=-t[2],hn(e,Gr(e,Yr))});function An(){var e=new p(8);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function gn(e){var t=new p(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function _n(e,t,a,r,n,s,i,o){var l=new p(8);return l[0]=e,l[1]=t,l[2]=a,l[3]=r,l[4]=n,l[5]=s,l[6]=i,l[7]=o,l}function Sn(e,t,a,r,n,s,i){var o=new p(8);o[0]=e,o[1]=t,o[2]=a,o[3]=r;var l=.5*n,c=.5*s,h=.5*i;return o[4]=l*r+c*a-h*t,o[5]=c*r+h*e-l*a,o[6]=h*r+l*t-c*e,o[7]=-l*e-c*t-h*a,o}function bn(e,t,a){var r=.5*a[0],n=.5*a[1],s=.5*a[2],i=t[0],o=t[1],l=t[2],c=t[3];return e[0]=i,e[1]=o,e[2]=l,e[3]=c,e[4]=r*c+n*l-s*o,e[5]=n*c+s*i-r*l,e[6]=s*c+r*o-n*i,e[7]=-r*i-n*o-s*l,e}function vn(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e}function wn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function xn(e,t){var a=Tr();wt(a,t);var r=new p(3);return bt(r,t),bn(e,a,r),e}function Tn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function yn(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Cn(e,t,a,r,n,s,i,o,l){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e[4]=s,e[5]=i,e[6]=o,e[7]=l,e}var Mn=Qr;function Un(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}var kn=Qr;function Dn(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function In(e,t){var a=t[4],r=t[5],n=t[6],s=t[7],i=-t[0],o=-t[1],l=-t[2],c=t[3];return e[0]=2*(a*c+s*i+r*l-n*o),e[1]=2*(r*c+s*o+n*i-a*l),e[2]=2*(n*c+s*l+a*o-r*i),e}function Rn(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=.5*a[0],l=.5*a[1],c=.5*a[2],h=t[4],d=t[5],u=t[6],m=t[7];return e[0]=r,e[1]=n,e[2]=s,e[3]=i,e[4]=i*o+n*c-s*l+h,e[5]=i*l+s*o-r*c+d,e[6]=i*c+r*l-n*o+u,e[7]=-r*o-n*l-s*c+m,e}function Bn(e,t,a){var r=-t[0],n=-t[1],s=-t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=o*i+h*r+l*s-c*n,u=l*i+h*n+c*r-o*s,m=c*i+h*s+o*n-l*r,p=h*i-o*r-l*n-c*s;return Dr(e,t,a),r=e[0],n=e[1],s=e[2],i=e[3],e[4]=d*i+p*r+u*s-m*n,e[5]=u*i+p*n+m*r-d*s,e[6]=m*i+p*s+d*n-u*r,e[7]=p*i-d*r-u*n-m*s,e}function Pn(e,t,a){var r=-t[0],n=-t[1],s=-t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=o*i+h*r+l*s-c*n,u=l*i+h*n+c*r-o*s,m=c*i+h*s+o*n-l*r,p=h*i-o*r-l*n-c*s;return Ir(e,t,a),r=e[0],n=e[1],s=e[2],i=e[3],e[4]=d*i+p*r+u*s-m*n,e[5]=u*i+p*n+m*r-d*s,e[6]=m*i+p*s+d*n-u*r,e[7]=p*i-d*r-u*n-m*s,e}function En(e,t,a){var r=-t[0],n=-t[1],s=-t[2],i=t[3],o=t[4],l=t[5],c=t[6],h=t[7],d=o*i+h*r+l*s-c*n,u=l*i+h*n+c*r-o*s,m=c*i+h*s+o*n-l*r,p=h*i-o*r-l*n-c*s;return Rr(e,t,a),r=e[0],n=e[1],s=e[2],i=e[3],e[4]=d*i+p*r+u*s-m*n,e[5]=u*i+p*n+m*r-d*s,e[6]=m*i+p*s+d*n-u*r,e[7]=p*i-d*r-u*n-m*s,e}function Fn(e,t,a){var r=a[0],n=a[1],s=a[2],i=a[3],o=t[0],l=t[1],c=t[2],h=t[3];return e[0]=o*i+h*r+l*s-c*n,e[1]=l*i+h*n+c*r-o*s,e[2]=c*i+h*s+o*n-l*r,e[3]=h*i-o*r-l*n-c*s,o=t[4],l=t[5],c=t[6],h=t[7],e[4]=o*i+h*r+l*s-c*n,e[5]=l*i+h*n+c*r-o*s,e[6]=c*i+h*s+o*n-l*r,e[7]=h*i-o*r-l*n-c*s,e}function Vn(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=a[0],l=a[1],c=a[2],h=a[3];return e[0]=r*h+i*o+n*c-s*l,e[1]=n*h+i*l+s*o-r*c,e[2]=s*h+i*c+r*l-n*o,e[3]=i*h-r*o-n*l-s*c,o=a[4],l=a[5],c=a[6],h=a[7],e[4]=r*h+i*o+n*c-s*l,e[5]=n*h+i*l+s*o-r*c,e[6]=s*h+i*c+r*l-n*o,e[7]=i*h-r*o-n*l-s*c,e}function On(e,t,a,r){if(Math.abs(r)<m)return Tn(e,t);var n=Math.hypot(a[0],a[1],a[2]);r*=.5;var s=Math.sin(r),i=s*a[0]/n,o=s*a[1]/n,l=s*a[2]/n,c=Math.cos(r),h=t[0],d=t[1],u=t[2],p=t[3];e[0]=h*c+p*i+d*l-u*o,e[1]=d*c+p*o+u*i-h*l,e[2]=u*c+p*l+h*o-d*i,e[3]=p*c-h*i-d*o-u*l;var f=t[4],A=t[5],g=t[6],_=t[7];return e[4]=f*c+_*i+A*l-g*o,e[5]=A*c+_*o+g*i-f*l,e[6]=g*c+_*l+f*o-A*i,e[7]=_*c-f*i-A*o-g*l,e}function Nn(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e[4]=t[4]+a[4],e[5]=t[5]+a[5],e[6]=t[6]+a[6],e[7]=t[7]+a[7],e}function Ln(e,t,a){var r=t[0],n=t[1],s=t[2],i=t[3],o=a[4],l=a[5],c=a[6],h=a[7],d=t[4],u=t[5],m=t[6],p=t[7],f=a[0],A=a[1],g=a[2],_=a[3];return e[0]=r*_+i*f+n*g-s*A,e[1]=n*_+i*A+s*f-r*g,e[2]=s*_+i*g+r*A-n*f,e[3]=i*_-r*f-n*A-s*g,e[4]=r*h+i*o+n*c-s*l+d*_+p*f+u*g-m*A,e[5]=n*h+i*l+s*o-r*c+u*_+p*A+m*f-d*g,e[6]=s*h+i*c+r*l-n*o+m*_+p*g+d*A-u*f,e[7]=i*h-r*o-n*l-s*c+p*_-d*f-u*A-m*g,e}var Gn=Ln;function Hn(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e}var jn=rn;function Wn(e,t,a,r){var n=1-r;return jn(t,a)<0&&(r=-r),e[0]=t[0]*n+a[0]*r,e[1]=t[1]*n+a[1]*r,e[2]=t[2]*n+a[2]*r,e[3]=t[3]*n+a[3]*r,e[4]=t[4]*n+a[4]*r,e[5]=t[5]*n+a[5]*r,e[6]=t[6]*n+a[6]*r,e[7]=t[7]*n+a[7]*r,e}function Zn(e,t){var a=Yn(t);return e[0]=-t[0]/a,e[1]=-t[1]/a,e[2]=-t[2]/a,e[3]=t[3]/a,e[4]=-t[4]/a,e[5]=-t[5]/a,e[6]=-t[6]/a,e[7]=t[7]/a,e}function zn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}var Kn=sn,Xn=Kn,Yn=ln,$n=Yn;function qn(e,t){var a=Yn(t);if(a>0){a=Math.sqrt(a);var r=t[0]/a,n=t[1]/a,s=t[2]/a,i=t[3]/a,o=t[4],l=t[5],c=t[6],h=t[7],d=r*o+n*l+s*c+i*h;e[0]=r,e[1]=n,e[2]=s,e[3]=i,e[4]=(o-r*d)/a,e[5]=(l-n*d)/a,e[6]=(c-s*d)/a,e[7]=(h-i*d)/a}return e}function Qn(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function Jn(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function es(e,t){var a=e[0],r=e[1],n=e[2],s=e[3],i=e[4],o=e[5],l=e[6],c=e[7],h=t[0],d=t[1],u=t[2],p=t[3],f=t[4],A=t[5],g=t[6],_=t[7];return Math.abs(a-h)<=m*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(r-d)<=m*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-u)<=m*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(s-p)<=m*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(i-f)<=m*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-A)<=m*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(l-g)<=m*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-_)<=m*Math.max(1,Math.abs(c),Math.abs(_))}function ts(){var e=new p(2);return p!=Float32Array&&(e[0]=0,e[1]=0),e}function as(e){var t=new p(2);return t[0]=e[0],t[1]=e[1],t}function rs(e,t){var a=new p(2);return a[0]=e,a[1]=t,a}function ns(e,t){return e[0]=t[0],e[1]=t[1],e}function ss(e,t,a){return e[0]=t,e[1]=a,e}function is(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e}function os(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e}function ls(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e}function cs(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e}function hs(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function ds(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function us(e,t,a){return e[0]=Math.min(t[0],a[0]),e[1]=Math.min(t[1],a[1]),e}function ms(e,t,a){return e[0]=Math.max(t[0],a[0]),e[1]=Math.max(t[1],a[1]),e}function ps(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function fs(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e}function As(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e}function gs(e,t){var a=t[0]-e[0],r=t[1]-e[1];return Math.hypot(a,r)}function _s(e,t){var a=t[0]-e[0],r=t[1]-e[1];return a*a+r*r}function Ss(e){var t=e[0],a=e[1];return Math.hypot(t,a)}function bs(e){var t=e[0],a=e[1];return t*t+a*a}function vs(e,t){return e[0]=-t[0],e[1]=-t[1],e}function ws(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function xs(e,t){var a=t[0],r=t[1],n=a*a+r*r;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e}function Ts(e,t){return e[0]*t[0]+e[1]*t[1]}function ys(e,t,a){var r=t[0]*a[1]-t[1]*a[0];return e[0]=e[1]=0,e[2]=r,e}function Cs(e,t,a,r){var n=t[0],s=t[1];return e[0]=n+r*(a[0]-n),e[1]=s+r*(a[1]-s),e}function Ms(e,t){t=t||1;var a=2*f()*Math.PI;return e[0]=Math.cos(a)*t,e[1]=Math.sin(a)*t,e}function Us(e,t,a){var r=t[0],n=t[1];return e[0]=a[0]*r+a[2]*n,e[1]=a[1]*r+a[3]*n,e}function ks(e,t,a){var r=t[0],n=t[1];return e[0]=a[0]*r+a[2]*n+a[4],e[1]=a[1]*r+a[3]*n+a[5],e}function Ds(e,t,a){var r=t[0],n=t[1];return e[0]=a[0]*r+a[3]*n+a[6],e[1]=a[1]*r+a[4]*n+a[7],e}function Is(e,t,a){var r=t[0],n=t[1];return e[0]=a[0]*r+a[4]*n+a[12],e[1]=a[1]*r+a[5]*n+a[13],e}function Rs(e,t,a,r){var n=t[0]-a[0],s=t[1]-a[1],i=Math.sin(r),o=Math.cos(r);return e[0]=n*o-s*i+a[0],e[1]=n*i+s*o+a[1],e}function Bs(e,t){var a=e[0],r=e[1],n=t[0],s=t[1],i=a*a+r*r;i>0&&(i=1/Math.sqrt(i));var o=n*n+s*s;o>0&&(o=1/Math.sqrt(o));var l=(a*n+r*s)*i*o;return l>1?0:l<-1?Math.PI:Math.acos(l)}function Ps(e){return e[0]=0,e[1]=0,e}function Es(e){return"vec2("+e[0]+", "+e[1]+")"}function Fs(e,t){return e[0]===t[0]&&e[1]===t[1]}function Vs(e,t){var a=e[0],r=e[1],n=t[0],s=t[1];return Math.abs(a-n)<=m*Math.max(1,Math.abs(a),Math.abs(n))&&Math.abs(r-s)<=m*Math.max(1,Math.abs(r),Math.abs(s))}var Os=Ss,Ns=os,Ls=ls,Gs=cs,Hs=gs,js=_s,Ws=bs,Zs=function(){var e=ts();return function(t,a,r,n,s,i){var o,l;for(a||(a=2),r||(r=0),l=n?Math.min(n*a+r,t.length):t.length,o=r;o<l;o+=a)e[0]=t[o],e[1]=t[o+1],s(e,e,i),t[o]=e[0],t[o+1]=e[1];return t}}();a.d(t,"glMatrix",(function(){return r})),a.d(t,"mat2",(function(){return n})),a.d(t,"mat2d",(function(){return s})),a.d(t,"mat3",(function(){return i})),a.d(t,"mat4",(function(){return o})),a.d(t,"quat",(function(){return h})),a.d(t,"quat2",(function(){return d})),a.d(t,"vec2",(function(){return u})),a.d(t,"vec3",(function(){return l})),a.d(t,"vec4",(function(){return c}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1);t.computeModelMatrixSRT=function(e,t,a,r,n,s,i,o,l,c){const h=Math.sin(n),d=Math.cos(n),u=Math.sin(s),m=Math.cos(s),p=Math.sin(i),f=Math.cos(i);e[0]=t*(m*f),e[1]=t*(p*m),e[2]=t*-u,e[3]=0,e[4]=a*(h*f*u-d*p),e[5]=a*(h*p*u+d*f),e[6]=a*(h*m),e[7]=0,e[8]=r*(d*f*u+h*p),e[9]=r*(d*p*u-h*f),e[10]=r*(m*d),e[11]=0,e[12]=o,e[13]=l,e[14]=c,e[15]=1},t.computeModelMatrixSRT_MayaSSC=function(e,t,a,r,n,s,i,o,l,c,h,d,u){const m=Math.sin(n),p=Math.cos(n),f=Math.sin(s),A=Math.cos(s),g=Math.sin(i),_=Math.cos(i);e[0]=t*(A*_),e[1]=t*(g*A)*(h/d),e[2]=t*-f*(h/u),e[3]=0,e[4]=a*(m*_*f-p*g)*(d/h),e[5]=a*(m*g*f+p*_),e[6]=a*(m*A)*(d/u),e[7]=0,e[8]=r*(p*_*f+m*g)*(u/h),e[9]=r*(p*g*f-m*_)*(u/d),e[10]=r*(A*p),e[11]=0,e[12]=o,e[13]=l,e[14]=c,e[15]=1},t.computeModelMatrixS=function(e,t,a,r){e[0]=t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1},t.computeModelMatrixR=function(e,t,a,r){const n=Math.sin(t),s=Math.cos(t),i=Math.sin(a),o=Math.cos(a),l=Math.sin(r),c=Math.cos(r);e[0]=o*c,e[1]=l*o,e[2]=-i,e[3]=0,e[4]=n*c*i-s*l,e[5]=n*l*i+s*c,e[6]=n*o,e[7]=0,e[8]=s*c*i+n*l,e[9]=s*l*i-n*c,e[10]=o*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1},t.computeNormalMatrix=function(e,t,a){void 0===a&&(a=s(t)),e!==t&&r.mat4.copy(e,t),e[12]=0,e[13]=0,e[14]=0,a||(r.mat4.invert(e,e),r.mat4.transpose(e,e))},t.transformVec3Mat4w1=function(e,t,a){const r=a[0],n=a[1],s=a[2];e[0]=t[0]*r+t[4]*n+t[8]*s+t[12],e[1]=t[1]*r+t[5]*n+t[9]*s+t[13],e[2]=t[2]*r+t[6]*n+t[10]*s+t[14]},t.transformVec3Mat4w0=function(e,t,a){const r=a[0],n=a[1],s=a[2];e[0]=t[0]*r+t[4]*n+t[8]*s,e[1]=t[1]*r+t[5]*n+t[9]*s,e[2]=t[2]*r+t[6]*n+t[10]*s};const n=r.vec3.create();function s(e,t=n){return r.mat4.getScaling(t,e),o(t,1e-6)}function i(e,t,a){return Math.max(t,Math.min(e,a))}function o(e,t){return e[0]>-t&&e[0]<t&&e[1]>-t&&e[1]<t&&e[2]>-t&&e[2]<t}t.matrixHasUniformScale=s,t.texProjPerspMtx=function(e,t,a,r,n,s,i){const o=1/Math.tan(t/2);e[0]=o/a*r,e[4]=0,e[8]=-s,e[12]=0,e[1]=0,e[5]=o*n,e[9]=-i,e[13]=0,e[2]=0,e[6]=0,e[10]=-1,e[14]=0,e[3]=9999,e[7]=9999,e[11]=9999,e[15]=9999},t.texProjOrthoMtx=function(e,t,a,r,n,s,i,o,l){const c=1/(a-t);e[0]=2*c*s,e[4]=0,e[8]=0,e[12]=-(a+t)*c*s+o;const h=1/(n-r);e[1]=0,e[5]=2*h*i,e[9]=0,e[13]=-(n+r)*h*i+l,e[2]=0,e[6]=0,e[10]=0,e[14]=1,e[3]=9999,e[7]=9999,e[11]=9999,e[15]=9999},t.texEnvMtx=function(e,t,a,r,n){e[0]=t,e[4]=0,e[8]=0,e[12]=r,e[1]=0,e[5]=-a,e[9]=0,e[13]=n,e[2]=0,e[6]=0,e[10]=0,e[14]=1,e[3]=9999,e[7]=9999,e[11]=9999,e[15]=9999},t.computeTranslationMatrixFromSRTMatrix=function(e,t){r.mat4.identity(e),e[12]=t[12],e[13]=t[13],e[14]=t[14]},t.computeRotationMatrixFromSRTMatrix=function(e,t){const a=1/Math.hypot(t[0],t[4],t[8]),r=1/Math.hypot(t[1],t[5],t[9]),n=1/Math.hypot(t[2],t[6],t[10]);e[0]=t[0]*a,e[4]=t[4]*a,e[8]=t[8]*a,e[1]=t[1]*r,e[5]=t[5]*r,e[9]=t[9]*r,e[2]=t[2]*n,e[6]=t[6]*n,e[10]=t[10]*n,e[12]=0,e[13]=0,e[14]=0},t.computeMatrixWithoutTranslation=function(e,t){r.mat4.copy(e,t),e[12]=0,e[13]=0,e[14]=0},t.computeMatrixWithoutRotation=function(e,t,a=n){const s=t[12],i=t[13],o=t[14];r.mat4.getScaling(a,e),r.mat4.fromScaling(e,a),e[12]=s,e[13]=i,e[14]=o},t.clamp=i,t.saturate=function(e){return i(e,0,1)},t.clampRange=function(e,t){return i(e,-t,t)},t.lerp=function(e,t,a){return e+(t-e)*a},t.invlerp=function(e,t,a){return(a-e)/(t-e)},t.lerpAngle=function(e,t,a,r=6.283){const n=(t-e)%r;return e+(2*n%r-n)*a},t.angleDist=function(e,t,a=6.283){const r=(t-e)%a;return 2*r%a-r},t.computeProjectionMatrixFromFrustum=function(e,t,a,r,n,s,i){const o=1/(a-t),l=1/(n-r);if(e[0]=2*s*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(a+t)*o,e[9]=(n+r)*l,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!==1/0){const t=1/(s-i);e[10]=(i+s)*t,e[14]=i*s*2*t}else e[10]=-1,e[14]=-2*s},t.computeProjectionMatrixFromCuboid=function(e,t,a,r,n,s,i){const o=1/(a-t),l=1/(n-r),c=1/(s-i);e[0]=2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=-(a+t)*o,e[13]=-(n+r)*l,e[14]=(i+s)*c,e[15]=1},t.computeEulerAngleRotationFromSRTMatrix=function(e,t){t[2]-1<-1e-4?t[2]+1>1e-4?(e[0]=Math.atan2(t[6],t[10]),e[1]=-Math.asin(t[2]),e[2]=Math.atan2(t[1],t[0])):(e[0]=Math.atan2(t[4],t[8]),e[1]=Math.PI/2,e[2]=0):(e[0]=-Math.atan2(-t[4],-t[8]),e[1]=-Math.PI/2,e[2]=0)},t.computeUnitSphericalCoordinates=function(e,t,a){const r=Math.sin(a);e[0]=r*Math.cos(t),e[1]=Math.cos(a),e[2]=r*Math.sin(t)},t.range=function(e,t){const a=[];for(let r=e;r<e+t;r++)a.push(r);return a},t.normToLength=function(e,t){const a=r.vec3.length(e);if(a>0){const r=t/a;e[0]=e[0]*r,e[1]=e[1]*r,e[2]=e[2]*r}},t.normToLengthAndAdd=function(e,t,a){const n=r.vec3.length(t);if(n>0){const r=a/n;e[0]+=t[0]*r,e[1]+=t[1]*r,e[2]+=t[2]*r}},t.isNearZero=function(e,t){return e>-t&&e<t},t.isNearZeroVec3=o,t.quatFromEulerRadians=function(e,t,a,r){const n=Math.sin(.5*t),s=Math.cos(.5*t),i=Math.sin(.5*a),o=Math.cos(.5*a),l=Math.sin(.5*r),c=Math.cos(.5*r);e[0]=n*o*c-s*i*l,e[1]=s*i*c+n*o*l,e[2]=s*o*l-n*i*c,e[3]=s*o*c+n*i*l},t.getMatrixAxisX=function(e,t){r.vec3.set(e,t[0],t[1],t[2])},t.getMatrixAxisY=function(e,t){r.vec3.set(e,t[4],t[5],t[6])},t.getMatrixAxisZ=function(e,t){r.vec3.set(e,t[8],t[9],t[10])},t.getMatrixTranslation=function(e,t){r.vec3.set(e,t[12],t[13],t[14])},t.Vec3Zero=r.vec3.fromValues(0,0,0),t.Vec3One=r.vec3.fromValues(1,1,1),t.Vec3UnitX=r.vec3.fromValues(1,0,0),t.Vec3UnitY=r.vec3.fromValues(0,1,0),t.Vec3UnitZ=r.vec3.fromValues(0,0,1);const l=new ArrayBuffer(4),c=new Float32Array(l),h=new Uint32Array(l);t.bitsAsFloat32=function(e){return h[0]=e>>>0&4294967295,c[0]},t.reflectVec3=function(e,t,a){const n=-2*r.vec3.dot(t,a);r.vec3.scaleAndAdd(e,t,a,n)}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return l}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};function n(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}var s=function(){return(s=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function i(e){var t="function"==typeof Symbol&&e[Symbol.iterator],a=0;return t?t.call(e):{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}}}function o(e,t){var a="function"==typeof Symbol&&e[Symbol.iterator];if(!a)return e;var r,n,s=a.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)i.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return i}function l(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(2),n=a(0);function s(e,t,a,r=1){return{r:e,g:t,b:a,a:r}}function i(e,t,a,r,n=1){e.r=t,e.g=a,e.b=r,e.a=n}function o(e,t){e.r=(t>>>24&255)/255,e.g=(t>>>16&255)/255,e.b=(t>>>8&255)/255,e.a=(t>>>0&255)/255}function l(e,t,a){var n;return(a=(a+(n=6))%n)>=0&&a<1?r.lerp(e,t,a-0):a>=1&&a<3?t:a>=3&&a<4?r.lerp(t,e,a-3):e}t.colorNewFromRGBA=s,t.colorFromRGBA=i,t.colorCopy=function(e,t,a=t.a){e.r=t.r,e.g=t.g,e.b=t.b,e.a=a},t.colorNewCopy=function(e,t=e.a){return{r:e.r,g:e.g,b:e.b,a:t}},t.colorFromRGBA8=o,t.colorNewFromRGBA8=function(e){const t=s(0,0,0,0);return o(t,e),t},t.colorFromHex=function(e,t){n.assert(7===t.length||9===t.length),i(e,parseInt(t.slice(1,3),16)/255,parseInt(t.slice(3,5),16)/255,parseInt(t.slice(5,7),16)/255,9===t.length?parseInt(t.slice(7,9),16)/255:1)},t.colorLerp=function(e,t,a,n){e.r=r.lerp(t.r,a.r,n),e.g=r.lerp(t.g,a.g,n),e.b=r.lerp(t.b,a.b,n),e.a=r.lerp(t.a,a.a,n)},t.colorScaleAndAdd=function(e,t,a,r){e.r=t.r+a.r*r,e.g=t.g+a.g*r,e.b=t.b+a.b*r,e.a=t.a+a.a*r},t.colorAdd=function(e,t,a){e.r=t.r+a.r,e.g=t.g+a.g,e.b=t.b+a.b,e.a=t.a+a.a},t.colorClampLDR=function(e,t){e.r=r.saturate(t.r),e.g=r.saturate(t.g),e.b=r.saturate(t.b),e.a=r.saturate(t.a)},t.colorMult=function(e,t,a){e.g=t.g*a.g,e.r=t.r*a.r,e.b=t.b*a.b,e.a=t.a*a.a},t.colorFromARGB8=function(e,t){e.a=(t>>>24&255)/255,e.r=(t>>>16&255)/255,e.g=(t>>>8&255)/255,e.b=(t>>>0&255)/255},t.colorToRGBA8=function(e){return 255*e.r<<24|255*e.g<<16|255*e.b<<8|255*e.a<<0},t.colorToCSS=function(e){return`rgba(${255*e.r}, ${255*e.g}, ${255*e.b}, ${e.a})`},t.colorEqual=function(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a},t.colorFromHSL=function(e,t,a,r,n=1){if(0===a)i(e,r,r,r);else{const s=r*a,i=r<.5?r+s:r+a-s,o=2*r-i,c=6*t;e.r=l(o,i,c+2),e.g=l(o,i,c),e.b=l(o,i,c-2),e.a=n}},t.TransparentBlack=s(0,0,0,0),t.OpaqueBlack=s(0,0,0,1),t.White=s(1,1,1,1),t.Red=s(1,0,0,1),t.Green=s(0,1,0,1),t.Blue=s(0,0,1,1),t.Magenta=s(1,0,1,1),t.Yellow=s(1,1,0,1),t.Cyan=s(0,1,1,1),t.objIsColor=function(e){return"object"==typeof e&&null!==e&&"r"in e&&"g"in e&&"b"in e&&"a"in e}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(1),i=r(a(16)),o=r(a(35)),l=a(0),c=n(a(15)),h=a(10),d=a(17),u=a(13),m=a(6),p=a(9),f=a(7),A=a(23),g=a(4),_=a(14);var S;!function(e){e[e.MAT0=0]="MAT0",e[e.MAT1=1]="MAT1",e[e.AMB0=2]="AMB0",e[e.AMB1=3]="AMB1",e[e.K0=4]="K0",e[e.K1=5]="K1",e[e.K2=6]="K2",e[e.K3=7]="K3",e[e.CPREV=8]="CPREV",e[e.C0=9]="C0",e[e.C1=10]="C1",e[e.C2=11]="C2",e[e.COUNT=12]="COUNT"}(S=t.ColorKind||(t.ColorKind={}));class b{constructor(){this.u_Projection=s.mat4.create(),this.u_SceneTextureLODBias=0}}t.SceneParams=b;t.MaterialParams=class{constructor(){this.m_TextureMapping=l.nArray(8,()=>new h.TextureMapping),this.u_Color=l.nArray(S.COUNT,()=>g.colorNewCopy(g.TransparentBlack)),this.u_TexMtx=l.nArray(10,()=>s.mat4.create()),this.u_PostTexMtx=l.nArray(20,()=>s.mat4.create()),this.u_IndTexMtx=l.nArray(3,()=>s.mat4.create()),this.u_Lights=l.nArray(8,()=>new i.Light),this.u_FogBlock=new i.FogBlock,g.colorFromRGBA(this.u_Color[S.MAT0],1,1,1,1),g.colorFromRGBA(this.u_Color[S.MAT1],1,1,1,1)}};function v(e,a,r){let n=a;n+=u.fillMatrix4x4(e,n,r.u_Projection),n+=u.fillVec4(e,n,r.u_SceneTextureLODBias),l.assert(n===a+t.u_SceneParamsBufferSize),l.assert(e.length>=n)}function w(e,t,a){return t+=u.fillColor(e,t,a.Color),t+=u.fillVec3v(e,t,a.Position),t+=u.fillVec3v(e,t,a.Direction),t+=u.fillVec3v(e,t,a.DistAtten),t+=u.fillVec3v(e,t,a.CosAtten),20}function x(e,t,a){return t+=u.fillVec4(e,t,a.A,a.B,a.C,a.AdjCenter),t+=u.fillVec4(e,t,a.AdjTable[0],a.AdjTable[1],a.AdjTable[2],a.AdjTable[3]),t+=u.fillVec4(e,t,a.AdjTable[4],a.AdjTable[5],a.AdjTable[6],a.AdjTable[7]),t+=u.fillVec4(e,t,a.AdjTable[8],a.AdjTable[9]),t+=u.fillColor(e,t,a.Color),20}function T(e,t,a){return u.fillVec4(e,t,a.width,(a.flipY?-1:1)*a.height,0,a.lodBias)}function y(e,t,a,r){let n=a;for(let e=0;e<12;e++)n+=u.fillColor(t,n,r.u_Color[e]);for(let e=0;e<10;e++)n+=u.fillMatrix4x3(t,n,r.u_TexMtx[e]);for(let e=0;e<8;e++)n+=T(t,n,r.m_TextureMapping[e]);for(let e=0;e<3;e++)n+=u.fillMatrix4x2(t,n,r.u_IndTexMtx[e]);if(i.materialHasPostTexMtxBlock(e))for(let e=0;e<20;e++)n+=u.fillMatrix4x3(t,n,r.u_PostTexMtx[e]);if(i.materialHasLightsBlock(e))for(let e=0;e<8;e++)n+=w(t,n,r.u_Lights[e]);i.materialHasFogBlock(e)&&(n+=x(t,n,r.u_FogBlock)),l.assert(t.length>=n)}function C(e,a,r){let n=a;for(let t=0;t<10;t++)n+=u.fillMatrix4x3(e,n,r.u_PosMtx[t]);l.assert(n===a+t.u_PacketParamsBufferSize),l.assert(e.length>=n)}function M(e,t,a,r,n=!0){if(s.mat4.copy(e.u_Projection,t.projectionMatrix),n){const t=Math.log2(Math.min(a/i.EFB_WIDTH,r/i.EFB_HEIGHT));e.u_SceneTextureLODBias=t}else e.u_SceneTextureLODBias=0}t.PacketParams=class{constructor(){this.u_PosMtx=l.nArray(10,()=>s.mat4.create())}clear(){for(let e=0;e<10;e++)s.mat4.identity(this.u_PosMtx[e])}},t.ub_SceneParams=0,t.ub_MaterialParams=1,t.ub_PacketParams=2,t.u_SceneParamsBufferSize=20,t.u_MaterialParamsBufferSize=624,t.u_PacketParamsBufferSize=120,t.fillSceneParamsData=v,t.fillLightData=w,t.fillFogBlock=x,t.fillTextureMappingInfo=T,t.fillPacketParamsData=C,t.fillSceneParams=M,t.loadedDataCoalescerComboGfx=function(e,t){return new d.GfxBufferCoalescerCombo(e,t.map(e=>e.vertexBuffers.map(e=>new c.default(e))),t.map(e=>new c.default(e.indexData)))};class U{constructor(e,t=null,a=e.name){this.mipChain=e,this.extraInfo=t,this.name=a,this.surfaces=[]}activate(){l.assert(0===this.surfaces.length);const e=[];for(let t=0;t<this.mipChain.mipLevels.length;t++){const a=this.mipChain.mipLevels[t],r=document.createElement("canvas");r.width=a.width,r.height=a.height,r.title=a.name,this.surfaces.push(r),e.push(o.decodeTexture(a).then(e=>{const t=r.getContext("2d"),n=new ImageData(a.width,a.height);n.data.set(new Uint8Array(e.pixels.buffer)),t.putImageData(n,0,0)}))}return Promise.all(e)}}function k(e,t){const a=t.mipLevels[0],r=e.createTexture(m.makeTextureDescriptor2D(m.GfxFormat.U8_RGBA_NORM,a.width,a.height,t.mipLevels.length));e.setResourceName(r,t.name);const n=e.createHostAccessPass(),s=[];for(let e=0;e<t.mipLevels.length;e++){const a=e,i=t.mipLevels[e];s.push(o.decodeTexture(i).then(e=>{n.uploadTextureData(r,a,[e.pixels])}))}Promise.all(s).then(()=>{e.submitPass(n)});const i=new Map;i.set("Format",o.getFormatName(a.format,a.paletteFormat));const l=new U(t,i);return{gfxTexture:r,viewerTexture:l}}t.GXViewerTexture=U,t.loadTextureFromMipChain=k,t.translateWrapModeGfx=function(e){switch(e){case 0:return 0;case 2:return 2;case 1:return 1}},t.translateTexFilterGfx=function(e){switch(e){case 1:return[1,0];case 0:return[0,0];case 5:return[1,2];case 4:return[0,2];case 3:return[1,1];case 2:return[0,1]}};class D extends h.TextureHolder{loadTexture(e,t){if(null===t.data)return null;return k(e,o.calcMipChain(t,t.mipCount))}}function I(e){return e.lightingEnabled&&0!==e.litMask}t.GXTextureHolder=D,t.fillIndTexMtx=function(e,t){const a=t[0],r=t[1],n=t[2],i=t[3],o=t[4],l=t[5],c=t[6];s.mat4.set(e,a,o,0,0,r,l,0,0,n,c,0,0,i,0,0,0)},t.fillIndTexMtxData=function(e,t,a){const r=a[0],n=a[1],s=a[2],i=a[3],o=a[4],l=a[5],c=a[6];return e[t+0]=r,e[t+1]=n,e[t+2]=s,e[t+3]=i,e[t+4]=o,e[t+5]=l,e[t+6]=c,e[t+7]=0,8},t.autoOptimizeMaterial=function(e){void 0===e.hasPostTexMtxBlock&&(e.hasPostTexMtxBlock=function(e){for(let t=0;t<e.texGens.length;t++)if(125!==e.texGens[t].postMatrix)return!0;return!1}(e)),void 0===e.hasLightsBlock&&(e.hasLightsBlock=function(e){if(void 0!==e.lightChannels[0]){if(I(e.lightChannels[0].colorChannel))return!0;if(I(e.lightChannels[0].alphaChannel))return!0}if(void 0!==e.lightChannels[1]){if(I(e.lightChannels[1].colorChannel))return!0;if(I(e.lightChannels[1].alphaChannel))return!0}return!1}(e)),void 0===e.hasFogBlock&&(e.hasFogBlock=function(e){return 0!==e.ropInfo.fogType}(e))};function R(e,t,a,r=!0){const n=[];let s=!1;for(let e=0;e<12;e++){const t=i.getVertexInputLocation(e),o=i.getVertexInputGenDef(e),l=a.singleVertexInputLayouts.find(t=>t.attrInput===e);if(void 0!==l){const e=l.bufferOffset,a=l.bufferIndex;n.push({location:t,format:l.format,bufferIndex:a,bufferByteOffset:e})}else if(r){const e=0,r=a.vertexBufferStrides.length;n.push({location:t,format:o.format,bufferIndex:r,bufferByteOffset:e}),s=!0}}const o=[];for(let e=0;e<a.vertexBufferStrides.length;e++)o.push({byteStride:a.vertexBufferStrides[e],frequency:1});s&&o.push({byteStride:0,frequency:2});const l=a.indexFormat;return t.createInputLayout(e,{vertexAttributeDescriptors:n,vertexBufferDescriptors:o,indexBufferFormat:l})}t.GXMaterialHelperGfx=class{constructor(e,t){this.material=e,this.materialHacks={},this.gfxProgram=null,t&&Object.assign(this.materialHacks,t),this.calcMaterialParamsBufferSize(),this.createProgram(),this.megaStateFlags={},i.translateGfxMegaState(this.megaStateFlags,this.material)}calcMaterialParamsBufferSize(){this.materialParamsBufferSize=i.getMaterialParamsBlockSize(this.material)}cacheProgram(e,t){if(null===this.gfxProgram){const a=this.program.generateShaders(e);this.gfxProgram=t.createProgramSimple(e,a),this.programKey=this.gfxProgram.ResourceUniqueId}}createProgram(){this.program=new i.GX_Program(this.material,this.materialHacks),this.gfxProgram=null}setMaterialHacks(e){Object.assign(this.materialHacks,e),this.createProgram()}fillMaterialParamsDataOnInst(e,a,r){const n=e.mapUniformBufferF32(t.ub_MaterialParams);y(this.material,n,a,r)}fillMaterialParamsData(e,t,a){const r=e.getTemplateRenderInst().getUniformBuffer().mapBufferF32(t,this.materialParamsBufferSize);y(this.material,r,t,a)}allocateMaterialParams(e){return e.allocateUniformBuffer(t.ub_MaterialParams,this.materialParamsBufferSize)}allocateMaterialParamsBlock(e){return e.getTemplateRenderInst().getUniformBuffer().allocateChunk(this.materialParamsBufferSize)}setOnRenderInst(e,t,a){this.cacheProgram(e,t),a.setMegaStateFlags(this.megaStateFlags),a.setGfxProgram(this.gfxProgram),f.setSortKeyProgramKey(a.sortKey,this.programKey)}},t.setChanWriteEnabled=function(e,t,a){let r=e.megaStateFlags.attachmentsState[0].colorWriteMask;a?r|=t:r&=~t,_.setAttachmentStateSimple(e.megaStateFlags,{colorWriteMask:r})},t.createInputLayout=R;t.GXShapeHelperGfx=class{constructor(e,t,a,r,n){this.loadedVertexLayout=r,this.loadedVertexData=n,this.zeroBuffer=null;let s=!1;for(let e=0;e<12;e++){if(void 0===r.singleVertexInputLayouts.find(t=>t.attrInput===e)){s=!0;break}}const i=[];for(let e=0;e<n.vertexBuffers.length;e++)i.push({buffer:a.vertexBuffers[e].buffer,byteOffset:4*a.vertexBuffers[e].wordOffset});s&&(this.zeroBuffer=d.makeStaticDataBuffer(e,2,new Uint8Array(16).buffer),i.push({buffer:this.zeroBuffer,byteOffset:0})),this.inputLayout=R(e,t,r);const o={buffer:a.indexBuffer.buffer,byteOffset:4*a.indexBuffer.wordOffset};this.inputState=e.createInputState(this.inputLayout,i,o)}setOnRenderInst(e,a=null){e.allocateUniformBuffer(t.ub_PacketParams,t.u_PacketParamsBufferSize),e.setInputLayoutAndState(this.inputLayout,this.inputState),null!==a?e.drawIndexes(a.indexCount,a.indexOffset):e.drawIndexes(this.loadedVertexData.totalIndexCount)}fillPacketParams(e,a){let r=a.getUniformBufferOffset(t.ub_PacketParams);C(a.mapUniformBufferF32(t.ub_PacketParams),r,e)}destroy(e){e.destroyInputState(this.inputState),null!==this.zeroBuffer&&e.destroyBuffer(this.zeroBuffer)}},t.gxBindingLayouts=[{numUniformBuffers:3,numSamplers:8}];const B=new b;t.fillSceneParamsDataOnTemplate=function(e,a,r=!0,n=B){M(n,a.camera,a.backbufferWidth,a.backbufferHeight,r);let s=e.getUniformBufferOffset(t.ub_SceneParams);v(e.mapUniformBufferF32(t.ub_SceneParams),s,n)};class P extends A.GfxRenderHelper{pushTemplateRenderInst(){const e=super.pushTemplateRenderInst();return e.setBindingLayouts(t.gxBindingLayouts),e.allocateUniformBuffer(t.ub_SceneParams,t.u_SceneParamsBufferSize),e}}t.GXRenderHelperGfx=P;t.BasicGXRendererHelper=class{constructor(e){this.renderTarget=new p.BasicRenderTarget,this.clearRenderPassDescriptor=p.standardFullClearRenderPassDescriptor,this.renderHelper=new P(e)}getCache(){return this.renderHelper.renderInstManager.gfxRenderCache}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a);const r=this.renderHelper.renderInstManager;this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,this.clearRenderPassDescriptor);return r.drawOnPassRenderer(e,n),r.resetRenderInsts(),n}destroy(e){this.renderTarget.destroy(e),this.renderHelper.destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(38);t.GfxFormat=r.GfxFormat,function(e){e[e.NEVER=WebGLRenderingContext.NEVER]="NEVER",e[e.LESS=WebGLRenderingContext.LESS]="LESS",e[e.EQUAL=WebGLRenderingContext.EQUAL]="EQUAL",e[e.LEQUAL=WebGLRenderingContext.LEQUAL]="LEQUAL",e[e.GREATER=WebGLRenderingContext.GREATER]="GREATER",e[e.NEQUAL=WebGLRenderingContext.NOTEQUAL]="NEQUAL",e[e.GEQUAL=WebGLRenderingContext.GEQUAL]="GEQUAL",e[e.ALWAYS=WebGLRenderingContext.ALWAYS]="ALWAYS"}(t.GfxCompareMode||(t.GfxCompareMode={})),function(e){e[e.CCW=WebGLRenderingContext.CCW]="CCW",e[e.CW=WebGLRenderingContext.CW]="CW"}(t.GfxFrontFaceMode||(t.GfxFrontFaceMode={})),function(e){e[e.ZERO=WebGLRenderingContext.ZERO]="ZERO",e[e.ONE=WebGLRenderingContext.ONE]="ONE",e[e.SRC_COLOR=WebGLRenderingContext.SRC_COLOR]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=WebGLRenderingContext.ONE_MINUS_SRC_COLOR]="ONE_MINUS_SRC_COLOR",e[e.DST_COLOR=WebGLRenderingContext.DST_COLOR]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=WebGLRenderingContext.ONE_MINUS_DST_COLOR]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA=WebGLRenderingContext.SRC_ALPHA]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=WebGLRenderingContext.ONE_MINUS_SRC_ALPHA]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=WebGLRenderingContext.DST_ALPHA]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=WebGLRenderingContext.ONE_MINUS_DST_ALPHA]="ONE_MINUS_DST_ALPHA"}(t.GfxBlendFactor||(t.GfxBlendFactor={})),function(e){e[e.ADD=WebGLRenderingContext.FUNC_ADD]="ADD",e[e.SUBTRACT=WebGLRenderingContext.FUNC_SUBTRACT]="SUBTRACT",e[e.REVERSE_SUBTRACT=WebGLRenderingContext.FUNC_REVERSE_SUBTRACT]="REVERSE_SUBTRACT"}(t.GfxBlendMode||(t.GfxBlendMode={})),t.makeTextureDescriptor2D=function(e,t,a,r){return{dimension:0,pixelFormat:e,width:t,height:a,depth:1,numLevels:r}},function(e){e[e.KEEP=WebGLRenderingContext.KEEP]="KEEP",e[e.ZERO=WebGLRenderingContext.ZERO]="ZERO",e[e.REPLACE=WebGLRenderingContext.REPLACE]="REPLACE",e[e.INVERT=WebGLRenderingContext.INVERT]="INVERT",e[e.INCREMENT_CLAMP=WebGLRenderingContext.INCR]="INCREMENT_CLAMP",e[e.DECREMENT_CLAMP=WebGLRenderingContext.DECR]="DECREMENT_CLAMP",e[e.INCREMENT_WRAP=WebGLRenderingContext.INCR_WRAP]="INCREMENT_WRAP",e[e.DECREMENT_WRAP=WebGLRenderingContext.DECR_WRAP]="DECREMENT_WRAP"}(t.GfxStencilOp||(t.GfxStencilOp={}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(2),s=a(85),i=a(14),o=a(9),l=a(51);function c(e,t,a=65536){let r=n.clamp(e,0,a)/a;return t&&(r=1-r),65535&65535*r}function h(e,t){return(16777215&e|(255&t)<<24)>>>0}function d(e,t){return!!(e>>>31&1)?e:(4278190335&e|(65535&t)<<16)>>>0}function u(e,t){return h(d(0,t),e)}function m(e,t){return r.assert(t>=0),(4294967040&e|t>>>8&255)>>>0}function p(e){return h(0,e)}function f(e,t){return r.assert(t>=0),(4278190335&e|t<<8)>>>0}function A(){return{currentRenderPipelineDescriptor:null,currentRenderPipelineReady:!1,currentInputState:null,currentBindingDescriptor:null,currentBindings:null}}t.makeDepthKey=c,t.getSortKeyLayer=function(e){return e>>>24&255},t.setSortKeyLayer=h,t.setSortKeyProgramKey=d,t.setSortKeyBias=function(e,t){return!!(e>>>31&1)?(4294967040&e|255&t)>>>0:e},t.makeSortKeyOpaque=u,t.setSortKeyOpaqueDepth=m,t.makeSortKeyTranslucent=p,t.setSortKeyTranslucentDepth=f,t.makeSortKey=function(e,t=0){return 128&e?p(e):u(e,t)},t.setSortKeyDepthKey=function(e,t){return!!(e>>>31&1)?f(e,t):m(e,t)},t.setSortKeyDepth=function(e,t,a=65536){const r=!!(e>>>31&1),n=c(t,r,a);return r?f(e,n):m(e,n)},t.getSortKeyDepth=function(e){return!!(e>>>31&1)?e>>>8&65535:e>>>8&65532|3&e},t.gfxRendererTransientStateNew=A;const g={currentRenderPipelineDescriptor:null,currentRenderPipelineReady:!1,currentInputState:null,currentBindingDescriptor:null,currentBindings:null};class _{constructor(){this.sortKey=0,this.filterKey=0,this._renderPipeline=null,this._bindingDescriptors=r.nArray(1,()=>({bindingLayout:null,samplerBindings:[],uniformBufferBindings:[]})),this._dynamicUniformBufferByteOffsets=r.nArray(4,()=>0),this._flags=0,this._inputState=null,this._drawStart=0,this._drawCount=0,this._drawInstanceCount=0,this._renderPipelineDescriptor={bindingLayouts:[],inputLayout:null,megaStateDescriptor:i.copyMegaState(i.defaultMegaState),program:null,topology:0,sampleCount:o.DEFAULT_NUM_SAMPLES}}reset(){this.sortKey=0,this.filterKey=0,this._renderPipeline=null}setFromTemplate(e){i.setMegaStateFlags(this._renderPipelineDescriptor.megaStateDescriptor,e._renderPipelineDescriptor.megaStateDescriptor),this._renderPipelineDescriptor.program=e._renderPipelineDescriptor.program,this._renderPipelineDescriptor.inputLayout=e._renderPipelineDescriptor.inputLayout,this._renderPipelineDescriptor.topology=e._renderPipelineDescriptor.topology,this._renderPipeline=e._renderPipeline,this._inputState=e._inputState,this._uniformBuffer=e._uniformBuffer,this._drawCount=e._drawCount,this._drawStart=e._drawStart,this._drawInstanceCount=e._drawInstanceCount,this._flags=-5&this._flags|4&e._flags,this.sortKey=e.sortKey,this.filterKey=e.filterKey;const t=this._bindingDescriptors[0],a=e._bindingDescriptors[0];null!==a.bindingLayout&&this._setBindingLayout(a.bindingLayout);for(let r=0;r<Math.min(t.uniformBufferBindings.length,a.uniformBufferBindings.length);r++)t.uniformBufferBindings[r].wordCount=e._bindingDescriptors[0].uniformBufferBindings[r].wordCount;this.setSamplerBindingsFromTextureMappings(a.samplerBindings);for(let t=0;t<e._dynamicUniformBufferByteOffsets.length;t++)this._dynamicUniformBufferByteOffsets[t]=e._dynamicUniformBufferByteOffsets[t]}setGfxRenderPipeline(e){this._renderPipeline=e}setGfxProgram(e){this._renderPipelineDescriptor.program=e}setMegaStateFlags(e){return i.setMegaStateFlags(this._renderPipelineDescriptor.megaStateDescriptor,e),this._renderPipelineDescriptor.megaStateDescriptor}getMegaStateFlags(){return this._renderPipelineDescriptor.megaStateDescriptor}setInputLayoutAndState(e,t){this._inputState=t,this._renderPipelineDescriptor.inputLayout=e}_setBindingLayout(e){r.assert(e.numUniformBuffers<this._dynamicUniformBufferByteOffsets.length),this._renderPipelineDescriptor.bindingLayouts[0]=e,this._bindingDescriptors[0].bindingLayout=e;for(let t=this._bindingDescriptors[0].uniformBufferBindings.length;t<e.numUniformBuffers;t++)this._bindingDescriptors[0].uniformBufferBindings.push({buffer:null,wordCount:0,wordOffset:0});for(let t=this._bindingDescriptors[0].samplerBindings.length;t<e.numSamplers;t++)this._bindingDescriptors[0].samplerBindings.push({gfxSampler:null,gfxTexture:null})}setBindingLayouts(e){r.assert(e.length<=this._bindingDescriptors.length),r.assert(1===e.length),this._setBindingLayout(e[0])}drawIndexes(e,t=0){this._flags|=4,this._drawCount=e,this._drawStart=t,this._drawInstanceCount=1}drawIndexesInstanced(e,t,a=0){this._flags|=4,this._drawCount=e,this._drawStart=a,this._drawInstanceCount=t}drawPrimitives(e,t=0){this._drawCount=e,this._drawStart=t,this._drawInstanceCount=1}setUniformBuffer(e){this._uniformBuffer=e}allocateUniformBuffer(e,t){r.assert(this._bindingDescriptors[0].bindingLayout.numUniformBuffers<this._dynamicUniformBufferByteOffsets.length),this._dynamicUniformBufferByteOffsets[e]=this._uniformBuffer.allocateChunk(t)<<2;const a=this._bindingDescriptors[0].uniformBufferBindings[e];return a.wordOffset=0,a.wordCount=t,this._dynamicUniformBufferByteOffsets[e]>>>2}getUniformBufferOffset(e){return this._dynamicUniformBufferByteOffsets[e]>>>2}setUniformBufferOffset(e,t,a){this._dynamicUniformBufferByteOffsets[e]=t<<2;const r=this._bindingDescriptors[0].uniformBufferBindings[e];r.wordOffset=0,r.wordCount=a}mapUniformBufferF32(e){const t=this._dynamicUniformBufferByteOffsets[e]>>>2,a=this._bindingDescriptors[0].uniformBufferBindings[e].wordCount;return this._uniformBuffer.mapBufferF32(t,a)}getUniformBuffer(){return this._uniformBuffer}setSamplerBindingsFromTextureMappings(e){for(let t=0;t<this._bindingDescriptors[0].samplerBindings.length;t++){const a=this._bindingDescriptors[0].samplerBindings[t];void 0!==e[t]&&null!==e[t]?(a.gfxTexture=e[t].gfxTexture,a.gfxSampler=e[t].gfxSampler):(a.gfxTexture=null,a.gfxSampler=null)}}drawOnPassWithState(e,t,a,n){if(r.assert(!!(2&this._flags)),null!==this._renderPipeline){n.currentRenderPipelineDescriptor=null;const t=e.queryPipelineReady(this._renderPipeline);r.assert(t),a.setPipeline(this._renderPipeline)}else if(null!==n.currentRenderPipelineDescriptor&&s.gfxRenderPipelineDescriptorEquals(this._renderPipelineDescriptor,n.currentRenderPipelineDescriptor)){if(!n.currentRenderPipelineReady)return}else{n.currentRenderPipelineDescriptor=this._renderPipelineDescriptor;const r=t.createRenderPipeline(e,n.currentRenderPipelineDescriptor);if(n.currentRenderPipelineReady=e.queryPipelineReady(r),!n.currentRenderPipelineReady)return;a.setPipeline(r)}this._inputState!==n.currentInputState&&(n.currentInputState=this._inputState,a.setInputState(n.currentInputState));for(let e=0;e<this._bindingDescriptors[0].uniformBufferBindings.length;e++)this._bindingDescriptors[0].uniformBufferBindings[e].buffer=this._uniformBuffer.gfxBuffer;null!==n.currentBindingDescriptor&&s.gfxBindingsDescriptorEquals(this._bindingDescriptors[0],n.currentBindingDescriptor)||(n.currentBindingDescriptor=this._bindingDescriptors[0],n.currentBindings=t.createBindings(e,n.currentBindingDescriptor)),a.setBindings(0,r.assertExists(n.currentBindings),this._dynamicUniformBufferByteOffsets),this._drawInstanceCount>1?(r.assert(!!(4&this._flags)),a.drawIndexedInstanced(this._drawCount,this._drawCount,this._drawInstanceCount)):4&this._flags?a.drawIndexed(this._drawCount,this._drawStart):a.draw(this._drawCount,this._drawStart)}drawOnPass(e,t,a){if(r.assert(!!(2&this._flags)),null!==this._renderPipeline)a.setPipeline(this._renderPipeline);else{const r=t.createRenderPipeline(e,this._renderPipelineDescriptor);a.setPipeline(r)}a.setInputState(this._inputState);for(let e=0;e<this._bindingDescriptors[0].uniformBufferBindings.length;e++)this._bindingDescriptors[0].uniformBufferBindings[e].buffer=this._uniformBuffer.gfxBuffer;const n=t.createBindings(e,this._bindingDescriptors[0]);a.setBindings(0,n,this._dynamicUniformBufferByteOffsets),this._drawInstanceCount>1?(r.assert(!!(4&this._flags)),a.drawIndexedInstanced(this._drawCount,this._drawCount,this._drawInstanceCount)):4&this._flags?a.drawIndexed(this._drawCount,this._drawStart):a.draw(this._drawCount,this._drawStart)}}function S(e,t){return e.sortKey-t.sortKey}t.GfxRenderInst=_,t.gfxRenderInstCompareNone=null,t.gfxRenderInstCompareSortKey=S;class b{constructor(e=S,t=0){this.compareFunction=e,this.executionOrder=t,this.renderInsts=[],this.needsSort=!1}flushSort(){this.needsSort&&null!==this.compareFunction&&this.renderInsts.sort(this.compareFunction),this.needsSort=!1}insertSorted(e){if(this.flushSort(),null!==this.compareFunction){const t=function(e,t,a){let r=0,n=e.length;for(;r<n;){const s=r+(n-r>>>1);a(t,e[s])<0?n=s:r=s+1}return r}(this.renderInsts,e,this.compareFunction);this.renderInsts.splice(t,0,e)}else this.renderInsts.push(e)}insertToEnd(e){this.renderInsts.push(e),null!==this.compareFunction&&(this.needsSort=!0)}drawOnPassRenderer(e,t,a,r=null){if(0!==this.renderInsts.length)if(this.flushSort(),null===r&&(!function(e){e.currentRenderPipelineDescriptor=null,e.currentRenderPipelineReady=!1,e.currentInputState=null,e.currentBindingDescriptor=null,e.currentBindings=null}(g),r=g),0===this.executionOrder)for(let n=0;n<this.renderInsts.length;n++)this.renderInsts[n].drawOnPassWithState(e,t,a,r);else for(let n=this.renderInsts.length-1;n>=0;n--)this.renderInsts[n].drawOnPassWithState(e,t,a,r)}reset(){this.renderInsts.length=0}}t.GfxRenderInstList=b;class v{constructor(){this.pool=[],this.allocCount=0}allocRenderInstIndex(){return this.allocCount++,this.allocCount>this.pool.length&&this.pool.push(new _),this.allocCount-1}popRenderInst(){this.allocCount--}reset(){for(let e=0;e<this.pool.length;e++)this.pool[e]._flags=0;this.allocCount=0}destroy(){this.pool.length=0,this.allocCount=0}}t.GfxRenderInstManager=class{constructor(){this.gfxRenderCache=new l.GfxRenderCache,this.instPool=new v,this.templatePool=new v,this.simpleRenderInstList=new b,this.currentRenderInstList=this.simpleRenderInstList}newRenderInst(){const e=this.templatePool.allocCount-1,t=this.instPool.allocRenderInstIndex(),a=this.instPool.pool[t];return e>=0?a.setFromTemplate(this.templatePool.pool[e]):a.reset(),a._flags=2,a}submitRenderInst(e){this.currentRenderInstList.insertSorted(e)}pushRenderInst(){const e=this.newRenderInst();return this.currentRenderInstList.insertToEnd(e),e}setCurrentRenderInstList(e){r.assert(null===this.simpleRenderInstList),this.currentRenderInstList=e}returnRenderInst(e){e._flags=0}pushTemplateRenderInst(){const e=this.templatePool.allocCount-1,t=this.templatePool.allocRenderInstIndex(),a=this.templatePool.pool[t];return e>=0&&a.setFromTemplate(this.templatePool.pool[e]),a._flags=1,a}popTemplateRenderInst(){this.templatePool.popRenderInst()}getTemplateRenderInst(){const e=this.templatePool.allocCount-1;return this.templatePool.pool[e]}resetRenderInsts(){this.instPool.reset(),null!==this.simpleRenderInstList&&this.simpleRenderInstList.reset()}destroy(e){this.instPool.destroy(),this.gfxRenderCache.destroy(e)}disableSimpleMode(){this.simpleRenderInstList=null}setVisibleByFilterKeyExact(e){const t=r.assertExists(this.simpleRenderInstList);t.renderInsts.length=0;for(let a=0;a<this.instPool.allocCount;a++)2&this.instPool.pool[a]._flags&&this.instPool.pool[a].filterKey===e&&t.insertToEnd(this.instPool.pool[a])}hasAnyVisible(){return r.assertExists(this.simpleRenderInstList).renderInsts.length>0}setVisibleNone(){r.assertExists(this.simpleRenderInstList).renderInsts.length=0}drawOnPassRenderer(e,t,a=null){r.assertExists(this.simpleRenderInstList).drawOnPassRenderer(e,this.gfxRenderCache,t,a)}},t.executeOnPass=function(e,t,a,r,n=!0){e.setVisibleByFilterKeyExact(r),e.drawOnPassRenderer(t,a)},t.hasAnyVisible=function(e,t){return e.setVisibleByFilterKeyExact(t),e.hasAnyVisible()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(12),s=a(2),i=a(22),o=a(0);class l{constructor(){this.viewMatrix=r.mat4.create(),this.worldMatrix=r.mat4.create(),this.projectionMatrix=r.mat4.create(),this.clipFromWorldMatrix=r.mat4.create(),this.linearVelocity=r.vec3.create(),this.frustum=new n.Frustum,this.isOrthographic=!1,this.shearX=0,this.shearY=0,this.webXROverrideCameraProperties=!1}setWebXROverrideEnabled(e){this.webXROverrideCameraProperties=e}identity(){r.mat4.identity(this.worldMatrix),r.mat4.identity(this.viewMatrix)}worldMatrixUpdated(){this.frustum.updateWorldFrustum(this.worldMatrix),this.updateClipFromWorld()}setPerspective(e,t,a,r=1/0){this.fovY=e,this.aspect=t,this.isOrthographic=!1;const n=Math.tan(.5*e)*a,s=n*t;this.setFrustum(-s,s,-n,n,a,r)}setOrthographic(e,t,a,r){this.orthoScaleY=e,this.aspect=t,this.isOrthographic=!0;const n=e,s=e*t;this.setFrustum(-s,s,-n,n,a,r)}setClipPlanes(e,t=1/0){this.webXROverrideCameraProperties||this.isOrthographic||this.setPerspective(this.fovY,this.aspect,e,t)}setFrustum(e,t,a,r,n,o){this.frustum.setViewFrustum(e,t,a,r,n,o,this.isOrthographic),this.frustum.updateWorldFrustum(this.worldMatrix),this.isOrthographic?(s.computeProjectionMatrixFromCuboid(this.projectionMatrix,e,t,a,r,n,o),i.reverseDepthForOrthographicProjectionMatrix(this.projectionMatrix)):(s.computeProjectionMatrixFromFrustum(this.projectionMatrix,e,t,a,r,n,o),i.reverseDepthForPerspectiveProjectionMatrix(this.projectionMatrix)),this.updateClipFromWorld()}newFrame(){this.frustum.newFrame()}updateClipFromWorld(){r.mat4.mul(this.clipFromWorldMatrix,this.projectionMatrix,this.viewMatrix)}}t.Camera=l,t.computeViewMatrix=function(e,t){r.mat4.copy(e,t.viewMatrix)},t.computeViewMatrixSkybox=function(e,t){r.mat4.copy(e,t.viewMatrix),e[12]=0,e[13]=0,e[14]=0},t.computeModelMatrixYBillboard=function(e,t){r.mat4.identity(e),e[0]=t.worldMatrix[0],e[4]=t.worldMatrix[4],e[8]=t.worldMatrix[8],e[2]=t.worldMatrix[2],e[6]=t.worldMatrix[6],e[10]=t.worldMatrix[10]};const c=r.vec3.create(),h=r.vec3.create(),d=r.vec3.create(),u=r.vec3.create(),m=r.vec3.create(),p=r.vec3.create(),f=r.vec4.create(),A=r.mat4.create(),g=r.quat.create();function _(e,t,a=c){return r.vec3.transformMat4(a,t,e.viewMatrix),-a[2]}function S(e,t){e[0]=t[0]/t[3],e[1]=t[1]/t[3],e[2]=t[2]/t[3],e[3]=1}t.computeViewSpaceDepthFromWorldSpaceAABB=function(e,t,a=c){return t.centerPoint(a),_(e,a)},t.computeViewSpaceDepthFromWorldSpacePoint=_,t.computeViewSpaceDepthFromWorldSpacePointAndViewMatrix=function(e,t,a=c){return r.vec3.transformMat4(a,t,e),-a[2]},t.divideByW=S;function b(e,t,a,n,s=c,i=f){e.reset(),r.vec3.transformMat4(s,a,t.viewMatrix),s[2]=-Math.max(Math.abs(s[2]-n),t.frustum.near);const o=s[0],l=s[1],h=s[2];for(let a=-1;a<=1;a+=2)for(let s=-1;s<=1;s+=2)r.vec4.set(i,o+n*a,l+n*s,h,1),r.vec4.transformMat4(i,i,t.projectionMatrix),S(i,i),e.union(i[0],i[1])}t.ScreenSpaceProjection=class{constructor(){this.reset()}reset(){this.projectedMinX=1/0,this.projectedMinY=1/0,this.projectedMaxX=-1/0,this.projectedMaxY=-1/0}getScreenArea(){return.5*(this.projectedMaxX-this.projectedMinX)*(.5*(this.projectedMaxY-this.projectedMinY))}union(e,t){this.projectedMinX=Math.min(this.projectedMinX,e),this.projectedMinY=Math.min(this.projectedMinY,t),this.projectedMaxX=Math.max(this.projectedMaxX,e),this.projectedMaxY=Math.max(this.projectedMaxY,t)}},t.computeClipSpacePointFromWorldSpacePoint=function(e,t,a,n=f){r.vec4.set(n,a[0],a[1],a[2],1),r.vec4.transformMat4(n,n,t.clipFromWorldMatrix);const s=n[3];r.vec3.set(e,n[0]/s,n[1]/s,n[2]/s)},t.computeScreenSpaceProjectionFromWorldSpaceSphere=b,t.computeScreenSpaceProjectionFromWorldSpaceAABB=function(e,t,a,r=c,n=f){const s=a.boundingSphereRadius();return a.centerPoint(r),b(e,t,r,s,r,n)};const v=r.vec3.fromValues(0,0,0),w=r.vec3.fromValues(0,1,0);t.FPSCameraController=class{constructor(){this.forceUpdate=!1,this.useViewUp=!0,this.onkeymovespeed=()=>{},this.keyMovement=r.vec3.create(),this.mouseMovement=r.vec3.create(),this.keyMoveSpeed=60,this.keyMoveShiftMult=5,this.keyMoveVelocityMult=.2,this.keyMoveDrag=.8,this.keyAngleChangeVelFast=.1,this.keyAngleChangeVelSlow=.02,this.mouseLookSpeed=500,this.mouseLookDragFast=0,this.mouseLookDragSlow=0,this.sceneKeySpeedMult=1}cameraUpdateForced(){r.vec3.set(this.keyMovement,0,0,0)}setSceneMoveSpeedMult(e){this.sceneKeySpeedMult=e}setKeyMoveSpeed(e){this.keyMoveSpeed=e}getKeyMoveSpeed(){return this.keyMoveSpeed}update(e,t){const a=this.camera;let n=!1;e.isKeyDown("KeyB")&&(r.mat4.identity(a.worldMatrix),this.cameraUpdateForced(),n=!0),this.keyMoveSpeed=Math.max(this.keyMoveSpeed,1);const i=e.isKeyDown("ShiftLeft")||e.isKeyDown("ShiftRight");let o=1;i&&(o=this.keyMoveShiftMult);const l=this.keyMoveSpeed*o,d=l*this.keyMoveVelocityMult,u=this.keyMovement;e.isKeyDown("KeyW")||e.isKeyDown("ArrowUp")?u[2]=s.clampRange(u[2]-d,l):e.isKeyDown("KeyS")||e.isKeyDown("ArrowDown")?u[2]=s.clampRange(u[2]+d,l):(u[2]*=this.keyMoveDrag,Math.abs(u[2])<.01&&(u[2]=0)),u[2]+=-e.getPinchDeltaDist()*d,e.isKeyDown("KeyA")||e.isKeyDown("ArrowLeft")?u[0]=s.clampRange(u[0]-d,l):e.isKeyDown("KeyD")||e.isKeyDown("ArrowRight")?u[0]=s.clampRange(u[0]+d,l):(u[0]*=this.keyMoveDrag,Math.abs(u[0])<.01&&(u[0]=0)),u[0]+=-e.getTouchDeltaX()*d,e.isKeyDown("KeyQ")||e.isKeyDown("PageDown")||e.isKeyDown("ControlLeft")&&e.isKeyDown("Space")?u[1]=s.clampRange(u[1]-d,l):e.isKeyDown("KeyE")||e.isKeyDown("PageUp")||e.isKeyDown("Space")?u[1]=s.clampRange(u[1]+d,l):(u[1]*=this.keyMoveDrag,Math.abs(u[1])<.01&&(u[1]=0)),u[1]+=e.getTouchDeltaY()*d;const m=h;if(this.useViewUp?s.getMatrixAxisY(m,a.viewMatrix):r.vec3.set(m,0,1,0),r.vec3.exactEquals(u,v))r.vec3.copy(a.linearVelocity,s.Vec3Zero);else{const e=c;r.vec3.set(e,u[0],0,u[2]),r.vec3.scaleAndAdd(e,e,m,u[1]),r.vec3.scale(e,e,this.sceneKeySpeedMult),r.vec3.copy(a.linearVelocity,e),r.mat4.translate(a.worldMatrix,a.worldMatrix,e),n=!0}const p=e.invertX?-1:1,f=e.invertY?-1:1,A=e.getMouseDeltaX()*(-1/this.mouseLookSpeed)*p,g=e.getMouseDeltaY()*(-1/this.mouseLookSpeed)*f,_=this.mouseMovement;_[0]+=A,_[1]+=g;const S=i?this.keyAngleChangeVelFast:this.keyAngleChangeVelSlow;if(e.isKeyDown("KeyJ")?_[0]+=S*p:e.isKeyDown("KeyL")&&(_[0]-=S*p),e.isKeyDown("KeyI")?_[1]+=S*f:e.isKeyDown("KeyK")&&(_[1]-=S*f),e.isKeyDown("KeyU")?_[2]-=S:e.isKeyDown("KeyO")&&(_[2]+=S),!r.vec3.exactEquals(this.mouseMovement,v)){r.mat4.rotate(a.worldMatrix,a.worldMatrix,this.mouseMovement[0],m),r.mat4.rotate(a.worldMatrix,a.worldMatrix,this.mouseMovement[1],[1,0,0]),r.mat4.rotate(a.worldMatrix,a.worldMatrix,this.mouseMovement[2],[0,0,1]),n=!0;const t=e.isDragging()?this.mouseLookDragFast:this.mouseLookDragSlow;r.vec3.scale(this.mouseMovement,this.mouseMovement,t),Math.abs(this.mouseMovement[0])<1e-4&&(this.mouseMovement[0]=0),Math.abs(this.mouseMovement[1])<1e-4&&(this.mouseMovement[1]=0)}return n=n||this.forceUpdate,n&&(this.camera.isOrthographic=!1,r.mat4.invert(this.camera.viewMatrix,this.camera.worldMatrix),this.camera.worldMatrixUpdated(),this.forceUpdate=!1),n}};t.XRCameraController=class{constructor(){this.cameras=[],this.offset=r.vec3.create(),this.worldScale=70}update(e){let t=!1;if(!e.xrSession)return!1;const a=e.xrSession.inputSources,n=this.worldScale,s=r.vec3.create();if(a.length>0)for(let e=0;e<a.length;e++){const t=a[e].gamepad;t&&t.axes.length>=3&&t.buttons.length>=1&&(s[0]=t.axes[2]*n,s[1]=(t.buttons[0].value-t.buttons[1].value)*n,s[2]=t.axes[3]*n)}if(!r.vec3.exactEquals(s,v)){const a=e.xrViewSpace.getOffsetReferenceSpace(new XRRigidTransform(new DOMPointReadOnly(s[0],0,s[2],1),{x:0,y:0,z:1,w:1})),r=e.currentFrame.getPose(a,e.xrLocalSpace);r&&(this.offset[0]+=r.transform.position.x,this.offset[1]+=s[1],this.offset[2]+=r.transform.position.z),t=!0}if(e.views.length!==this.cameras.length){for(let t=this.cameras.length;t<e.views.length;t++)this.cameras.push(new l);this.cameras.length=e.views.length}o.assert(this.cameras.length===e.views.length);for(let a=0;a<this.cameras.length;a++){const n=this.cameras[a],s=e.views[a],o=A;o.set(s.transform.matrix);const l=d;r.mat4.getTranslation(l,o);const c=u;r.mat4.getTranslation(c,o);const h=m,f=g;r.mat4.getScaling(h,o),r.mat4.getRotation(f,o);const _=p;_.set(this.offset),r.vec3.sub(_,_,c),r.vec3.scaleAndAdd(l,_,l,this.worldScale),r.mat4.fromRotationTranslationScale(o,f,l,h),n.isOrthographic=!1,n.worldMatrix.set(o),r.mat4.invert(n.viewMatrix,n.worldMatrix),n.worldMatrixUpdated();const S=s.projectionMatrix;n.projectionMatrix.set(S);const b=2*Math.atan(1/S[5]),v=S[5]/S[0],w=S[8],x=S[9];n.fovY=b,n.aspect=v,n.shearX=w,n.shearY=x,n.setWebXROverrideEnabled(!1),n.setClipPlanes(5),n.setWebXROverrideEnabled(!0),n.projectionMatrix.set(S),i.reverseDepthForPerspectiveProjectionMatrix(n.projectionMatrix),n.worldMatrixUpdated(),t=!0}return t}};function x(e,t){return Math.floor(e/t)*t+t}t.OrbitCameraController=class{constructor(){this.forceUpdate=!1,this.onkeymovespeed=()=>{},this.x=-Math.PI/2,this.y=2,this.z=-150,this.orbitSpeed=-.05,this.xVel=0,this.yVel=0,this.zVel=0,this.translation=r.vec3.create(),this.txVel=0,this.tyVel=0,this.shouldOrbit=!0}cameraUpdateForced(){}deserialize(e){}setSceneMoveSpeedMult(e){}setKeyMoveSpeed(e){}getKeyMoveSpeed(){return null}update(e,t){e.isKeyDownEventTriggered("KeyR")&&(this.shouldOrbit=!this.shouldOrbit),e.isKeyDownEventTriggered("Numpad5")&&(this.shouldOrbit=!1,this.xVel=this.yVel=0),e.isKeyDownEventTriggered("KeyB")&&(this.shouldOrbit=!1,this.xVel=this.yVel=0,this.txVel=this.tyVel=0,this.xVel=this.yVel=this.zVel=0,r.vec3.set(this.translation,0,0,0));const a=this.shouldOrbit,n=e.invertX?-1:1,i=e.invertY?-1:1;1===e.button?(this.txVel+=e.dx*(-10-Math.min(this.z,.01))/-5e3,this.tyVel+=e.dy*(-10-Math.min(this.z,.01))/5e3):e.isDragging()?(this.xVel+=e.dx/-200*n,this.yVel+=e.dy/-200*i):a&&Math.abs(this.xVel)<Math.abs(this.orbitSpeed)&&(this.xVel+=1*this.orbitSpeed/50),this.zVel+=e.dz;let o=0,l=0;e.isKeyDown("KeyA")&&(o+=.02),e.isKeyDown("KeyD")&&(o-=.02),e.isKeyDown("KeyW")&&(l+=.02),e.isKeyDown("KeyS")&&(l-=.02);const h=e.isKeyDown("ShiftLeft")||e.isKeyDown("ShiftRight");if(h?(this.xVel+=-o,this.yVel+=-l):(this.txVel+=o,this.tyVel+=-l),this.xVel=s.clampRange(this.xVel,2),this.yVel=s.clampRange(this.yVel,2),this.forceUpdate||0!==this.xVel||0!==this.yVel||0!==this.zVel||0!==this.txVel||0!==this.tyVel){const t=e.isDragging()||h?.92:.96;this.x+=-this.xVel/10,this.xVel*=t,this.y+=-this.yVel/10,this.yVel*=t,this.txVel*=t,this.tyVel*=t,this.z+=4*Math.max(Math.log(Math.abs(this.zVel)),0)*Math.sign(this.zVel),0===e.dz&&(this.zVel*=.85),this.z>-10&&(this.z=-10,this.zVel=0),r.vec3.set(c,this.camera.worldMatrix[0],this.camera.worldMatrix[1],this.camera.worldMatrix[2]),r.vec3.scaleAndAdd(this.translation,this.translation,c,this.txVel),r.vec3.set(c,this.camera.worldMatrix[4],this.camera.worldMatrix[5],this.camera.worldMatrix[6]),r.vec3.scaleAndAdd(this.translation,this.translation,c,this.tyVel);const a=c;s.computeUnitSphericalCoordinates(a,this.x,this.y),r.vec3.scale(a,a,this.z),r.vec3.add(a,a,this.translation),this.camera.isOrthographic=!1,r.mat4.lookAt(this.camera.viewMatrix,a,this.translation,w),r.mat4.invert(this.camera.worldMatrix,this.camera.viewMatrix),this.camera.worldMatrixUpdated(),this.forceUpdate=!1}return!1}};function T(e,t,a){return e.setFloat32(t+0,a[0],!0),e.setFloat32(t+4,a[4],!0),e.setFloat32(t+8,a[8],!0),e.setFloat32(t+12,a[12],!0),e.setFloat32(t+16,a[1],!0),e.setFloat32(t+20,a[5],!0),e.setFloat32(t+24,a[9],!0),e.setFloat32(t+28,a[13],!0),e.setFloat32(t+32,a[2],!0),e.setFloat32(t+36,a[6],!0),e.setFloat32(t+40,a[10],!0),e.setFloat32(t+44,a[14],!0),48}t.OrthoCameraController=class{constructor(){this.forceUpdate=!1,this.onkeymovespeed=()=>{},this.x=-Math.PI/2,this.y=2,this.z=200,this.orbitSpeed=-.05,this.zVel=0,this.xTarget=this.x,this.yTarget=this.y,this.translation=r.vec3.create(),this.txVel=0,this.tyVel=0,this.shouldOrbit=!1,this.farPlane=1e5,this.nearPlane=-this.farPlane}setSceneMoveSpeedMult(e){}cameraUpdateForced(){}deserialize(e){}setKeyMoveSpeed(e){}getKeyMoveSpeed(){return null}update(e,t){e.isKeyDownEventTriggered("KeyR")&&(this.shouldOrbit=!this.shouldOrbit),e.isKeyDownEventTriggered("Numpad5")&&(this.shouldOrbit=!1),e.isKeyDownEventTriggered("Numpad8")&&(this.xTarget=.5*-Math.PI,this.yTarget=Math.PI-.001),e.isKeyDownEventTriggered("Numpad4")&&(this.xTarget=0,this.yTarget=.5*Math.PI),e.isKeyDownEventTriggered("Numpad6")&&(this.xTarget=Math.PI,this.yTarget=.5*Math.PI),e.isKeyDownEventTriggered("Numpad2")&&(this.xTarget=.5*-Math.PI,this.yTarget=.5*Math.PI),e.isKeyDownEventTriggered("KeyB")&&(this.txVel=this.tyVel=0,r.vec3.set(this.translation,0,0,0));const a=this.shouldOrbit,n=e.invertX?-1:1,i=e.invertY?-1:1;1===e.button?(this.txVel+=e.dx*(-10-Math.min(this.z,.01))/-5e3,this.tyVel+=e.dy*(-10-Math.min(this.z,.01))/5e3):e.isDragging()?(this.xTarget+=e.dx/200*n,this.yTarget+=e.dy/200*i):a&&(this.xTarget+=1*this.orbitSpeed/25);let o=0!==e.dz;this.zVel+=-1*e.dz;const l=e.isKeyDown("ShiftLeft")||e.isKeyDown("ShiftRight");l?(e.isKeyDownEventTriggered("KeyA")&&(this.xTarget=x(this.xTarget,+Math.PI/4)),e.isKeyDownEventTriggered("KeyD")&&(this.xTarget=x(this.xTarget,-Math.PI/4)),e.isKeyDownEventTriggered("KeyW")&&(this.yTarget=x(this.yTarget,+Math.PI/8),this.yTarget===Math.PI&&(this.yTarget-=.001)),e.isKeyDownEventTriggered("KeyS")&&(this.yTarget=x(this.yTarget-.001,-Math.PI/8),this.yTarget===Math.PI&&(this.yTarget+=.001))):(e.isKeyDown("KeyA")&&(this.txVel+=.02),e.isKeyDown("KeyD")&&(this.txVel-=.02),e.isKeyDown("KeyW")&&(this.tyVel-=.02),e.isKeyDown("KeyS")&&(this.tyVel+=.02)),this.xTarget=this.xTarget%6.283,this.yTarget=this.yTarget%6.283,e.isKeyDown("KeyQ")&&(this.zVel+=1,o=!0),e.isKeyDown("KeyE")&&(this.zVel-=1,o=!0);const h=this.forceUpdate||this.xTarget!==this.x||this.yTarget!==this.y||0!==this.zVel||0!==this.txVel||0!==this.tyVel;if(h){this.x=s.lerpAngle(this.x,this.xTarget,.1),this.y=s.lerpAngle(this.y,this.yTarget,.1);const t=e.isDragging()||l?.92:.96;this.txVel*=t,this.tyVel*=t,this.z+=4*Math.max(Math.log(Math.abs(this.zVel)),0)*Math.sign(this.zVel),o||(this.zVel*=.85),this.z<1&&(this.z=1,this.zVel=0),r.vec3.set(c,this.camera.worldMatrix[0],this.camera.worldMatrix[1],this.camera.worldMatrix[2]),r.vec3.scaleAndAdd(this.translation,this.translation,c,this.txVel*-this.z),r.vec3.set(c,this.camera.worldMatrix[4],this.camera.worldMatrix[5],this.camera.worldMatrix[6]),r.vec3.scaleAndAdd(this.translation,this.translation,c,this.tyVel*-this.z),this.forceUpdate=!1}const d=c;return s.computeUnitSphericalCoordinates(d,this.x,this.y),r.vec3.scale(d,d,-this.farPlane/2),r.vec3.add(d,d,this.translation),r.mat4.lookAt(this.camera.viewMatrix,d,this.translation,w),r.mat4.invert(this.camera.worldMatrix,this.camera.viewMatrix),this.camera.setOrthographic(10*this.z,this.camera.aspect,this.nearPlane,this.farPlane),this.camera.worldMatrixUpdated(),h}},t.serializeMat4=T,t.serializeCamera=function(e,t,a){return T(e,t,a.worldMatrix)},t.deserializeCamera=function(e,t,a){const n=e.worldMatrix;return n[0]=t.getFloat32(a+0,!0),n[4]=t.getFloat32(a+4,!0),n[8]=t.getFloat32(a+8,!0),n[12]=t.getFloat32(a+12,!0),n[1]=t.getFloat32(a+16,!0),n[5]=t.getFloat32(a+20,!0),n[9]=t.getFloat32(a+24,!0),n[13]=t.getFloat32(a+28,!0),n[2]=t.getFloat32(a+32,!0),n[6]=t.getFloat32(a+36,!0),n[10]=t.getFloat32(a+40,!0),n[14]=t.getFloat32(a+44,!0),n[3]=0,n[7]=0,n[11]=0,n[15]=1,r.mat4.invert(e.viewMatrix,e.worldMatrix),e.worldMatrixUpdated(),48},t.texProjCameraSceneTex=function(e,t,a,r){let n=.5,i=-.5*r,o=.5,l=.5;n*=a.w,i*=a.h,o=o*a.w+a.x,l=l*a.h+a.y,function(e,t,a,r,n,i){t.isOrthographic?s.texProjOrthoMtx(e,t.frustum.left,t.frustum.right,t.frustum.bottom,t.frustum.top,a,r,n,i):s.texProjPerspMtx(e,t.fovY,t.aspect,a,r,n,i)}(e,t,n,i,o,l),e[8]+=t.shearX*n,e[9]+=t.shearY*Math.abs(i)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(4),s=a(22);t.DEFAULT_NUM_SAMPLES=4;t.ColorTexture=class{constructor(e=r.GfxFormat.U8_RGBA_NORM){this.format=e,this.gfxTexture=null,this.width=0,this.height=0}setParameters(e,t,a){return(this.width!==t||this.height!==a)&&(this.destroy(e),this.width=t,this.height=a,this.gfxTexture=e.createTexture(r.makeTextureDescriptor2D(this.format,t,a,1)),!0)}destroy(e){null!==this.gfxTexture&&(e.destroyTexture(this.gfxTexture),this.gfxTexture=null)}};class i{constructor(e=r.GfxFormat.U8_RGBA_NORM){this.format=e,this.gfxAttachment=null,this.width=0,this.height=0,this.numSamples=0}setParameters(e,a,r,n=t.DEFAULT_NUM_SAMPLES){return(this.width!==a||this.height!==r||this.numSamples!==n)&&(this.destroy(e),this.width=a,this.height=r,this.numSamples=n,this.gfxAttachment=e.createAttachment(this),!0)}destroy(e){null!==this.gfxAttachment&&(e.destroyAttachment(this.gfxAttachment),this.gfxAttachment=null)}}t.ColorAttachment=i;class o{constructor(){this.gfxAttachment=null,this.width=0,this.height=0,this.format=r.GfxFormat.D32F_S8,this.numSamples=0}setParameters(e,a,r,n=t.DEFAULT_NUM_SAMPLES){return(this.width!==a||this.height!==r||this.numSamples!==n)&&(this.destroy(e),this.width=a,this.height=r,this.numSamples=n,this.gfxAttachment=e.createAttachment(this),!0)}destroy(e){null!==this.gfxAttachment&&(e.destroyAttachment(this.gfxAttachment),this.gfxAttachment=null)}}function l(e,t){e.colorClearColor=t.colorClearColor,e.colorLoadDisposition=t.colorLoadDisposition,e.depthClearValue=t.depthClearValue,e.depthLoadDisposition=t.depthLoadDisposition,e.stencilClearValue=t.stencilClearValue,e.stencilLoadDisposition=t.stencilLoadDisposition}function c(){return d(!1,n.TransparentBlack)}function h(e,t,a){const r=a.width*t.x,n=a.width*t.w,s=a.height*t.y,i=a.height*t.h;e.setViewport(r,s,n,i)}t.DepthStencilAttachment=o,t.copyRenderPassDescriptor=l,t.makeEmptyRenderPassDescriptor=c,t.setViewportOnRenderPass=h,t.setScissorOnRenderPass=function(e,t,a){const r=a.width*t.x,n=a.width*t.w,s=a.height*t.y,i=a.height*t.h;e.setScissor(r,s,n,i)},t.IdentityViewportCoords={x:0,y:0,w:1,h:1};t.BasicRenderTarget=class{constructor(){this.colorAttachment=new i,this.depthStencilAttachment=new o,this.renderPassDescriptor=c()}setParameters(e,a,r,n=t.DEFAULT_NUM_SAMPLES){this.colorAttachment.setParameters(e,a,r,n),this.depthStencilAttachment.setParameters(e,a,r,n)}createRenderPass(e,t,a,r=null){l(this.renderPassDescriptor,a),this.renderPassDescriptor.colorAttachment=this.colorAttachment.gfxAttachment,this.renderPassDescriptor.colorResolveTo=r,this.renderPassDescriptor.depthStencilAttachment=this.depthStencilAttachment.gfxAttachment;const n=e.createRenderPass(this.renderPassDescriptor);return h(n,t,this.colorAttachment),n}destroy(e){this.colorAttachment.destroy(e),this.depthStencilAttachment.destroy(e)}};function d(e,t){return{colorAttachment:null,colorResolveTo:null,depthStencilAttachment:null,colorClearColor:t,depthStencilResolveTo:null,colorLoadDisposition:e?0:1,depthClearValue:s.reverseDepthForClearValue(1),depthLoadDisposition:0,stencilClearValue:0,stencilLoadDisposition:0}}t.PostFXRenderTarget=class{constructor(){this.colorAttachment=new i,this.renderPassDescriptor=c()}setParameters(e,a,r,n=t.DEFAULT_NUM_SAMPLES){this.colorAttachment.setParameters(e,a,r,n)}createRenderPass(e,t,a,r=null){l(this.renderPassDescriptor,a),this.renderPassDescriptor.colorAttachment=this.colorAttachment.gfxAttachment,this.renderPassDescriptor.colorResolveTo=r,this.renderPassDescriptor.depthStencilAttachment=null;const n=e.createRenderPass(this.renderPassDescriptor);return h(n,t,this.colorAttachment),n}destroy(e){this.colorAttachment.destroy(e)}},t.makeClearRenderPassDescriptor=d,t.standardFullClearRenderPassDescriptor=d(!0,n.colorNewFromRGBA(.88,.88,.88,1)),t.transparentBlackFullClearRenderPassDescriptor=d(!0,n.TransparentBlack),t.depthClearRenderPassDescriptor=d(!1,n.TransparentBlack),t.noClearRenderPassDescriptor={colorAttachment:null,colorResolveTo:null,depthStencilAttachment:null,depthStencilResolveTo:null,colorClearColor:n.TransparentBlack,colorLoadDisposition:1,depthClearValue:s.reverseDepthForClearValue(1),depthLoadDisposition:1,stencilClearValue:0,stencilLoadDisposition:1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TextureMapping=class{constructor(){this.gfxTexture=null,this.gfxSampler=null,this.width=0,this.height=0,this.lodBias=0,this.flipY=!1}reset(){this.gfxTexture=null,this.gfxSampler=null,this.width=0,this.height=0,this.lodBias=0,this.flipY=!1}fillFromTextureOverride(e){return this.gfxTexture=e.gfxTexture,e.gfxSampler&&(this.gfxSampler=e.gfxSampler),this.width=e.width,this.height=e.height,this.flipY=e.flipY,!0}copy(e){this.gfxTexture=e.gfxTexture,this.gfxSampler=e.gfxSampler,this.width=e.width,this.height=e.height,this.lodBias=e.lodBias,this.flipY=e.flipY}};class r{constructor(){this.viewerTextures=[],this.gfxTextures=[],this.textureEntries=[],this.textureOverrides=new Map,this.onnewtextures=null}destroy(e){this.gfxTextures.forEach(t=>e.destroyTexture(t)),this.viewerTextures.length=0,this.gfxTextures.length=0,this.textureEntries.length=0,this.textureOverrides.clear()}searchTextureEntryIndex(e){for(let t=0;t<this.textureEntries.length;t++)if(this.textureEntries[t].name===e)return t;return-1}findTextureEntryIndex(e){return this.searchTextureEntryIndex(e)}hasTexture(e){return this.findTextureEntryIndex(e)>=0}fillTextureMappingFromEntry(e,t){e.gfxTexture=this.gfxTextures[t];const a=this.textureEntries[t];e.width=a.width,e.height=a.height,e.flipY=!1}fillTextureMapping(e,t){const a=this.textureOverrides.get(t);if(a)return e.fillFromTextureOverride(a),!0;const r=this.findTextureEntryIndex(t);return r>=0&&(this.fillTextureMappingFromEntry(e,r),!0)}findTexture(e){const t=this.findTextureEntryIndex(e);return t>=0?this.textureEntries[t]:null}setTextureOverride(e,t,a=!0){if(a&&!this.hasTexture(e))throw new Error(`Trying to override non-existent texture ${e}`);this.textureOverrides.set(e,t)}addTextures(e,t,a=!1){for(let r=0;r<t.length;r++){const n=t[r];if(null===n)continue;let s=this.textureEntries.findIndex(e=>e.name===n.name);if(s>=0&&!a)continue;s<0&&(s=this.textureEntries.length);const i=this.loadTexture(e,n);if(null===i)continue;const{gfxTexture:o,viewerTexture:l}=i;this.textureEntries[s]=n,this.gfxTextures[s]=o,this.viewerTextures[s]=l}null!==this.onnewtextures&&this.onnewtextures()}}t.TextureHolder=r;t.FakeTextureHolder=class extends r{constructor(e){super(),this.viewerTextures=e}loadTexture(e,t){throw new Error}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(73)),i=a(0),o=a(8),l=a(4),c=a(42),h=a(74),d=a(83),u=a(2);a(128);const m=n(a(129));function p(e){return document.createRange().createContextualFragment(e)}function f(e,t){e.style.fontFamily="fontello",e.textContent=t}t.HIGHLIGHT_COLOR="rgb(210, 30, 30)",t.COOL_BLUE_COLOR="rgb(20, 105, 215)",t.PANEL_BG_COLOR="#411",t.createDOMFromString=p;function A(e,t){for(let a=0;a<t.length;a++)t[a].parentNode!==e&&e.appendChild(t[a]);for(let a=0;a<e.childElementCount;){const r=e.children.item(a);t.includes(r)?a++:e.removeChild(r)}i.assert(e.childElementCount===t.length);for(let a=0;a<t.length-1;a++)e.children.item(a)!==t[a]&&e.insertBefore(t[a],e.children.item(a))}function g(e,t,a="block"){e.style.display=t?a:"none"}function _(e,a,r=""){a?(e.style.backgroundColor=t.HIGHLIGHT_COLOR,e.style.color="black"):(e.style.backgroundColor=t.PANEL_BG_COLOR,e.style.color=r)}t.LAYER_ICON='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" height="20" fill="white"><g transform="translate(0,-1036.3622)"><path d="m 8,1039.2486 -0.21875,0.125 -4.90625,2.4375 5.125,2.5625 5.125,-2.5625 L 8,1039.2486 z m -3,4.5625 -2.125,0.9688 5.125,2.5625 5.125,-2.5625 -2.09375,-0.9688 -3.03125,1.5 -1,-0.5 -0.90625,-0.4375 L 5,1043.8111 z m 0,3 -2.125,0.9688 5.125,2.5625 5.125,-2.5625 -2.09375,-0.9688 -3.03125,1.5 -1,-0.5 -0.90625,-0.4375 L 5,1046.8111 z"/></g></svg>',t.TIME_OF_DAY_ICON='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" height="20" fill="white"><path d="M50,93.4C74,93.4,93.4,74,93.4,50C93.4,26,74,6.6,50,6.6C26,6.6,6.6,26,6.6,50C6.6,74,26,93.4,50,93.4z M37.6,22.8  c-0.6,2.4-0.9,5-0.9,7.6c0,18.2,14.7,32.9,32.9,32.9c2.6,0,5.1-0.3,7.6-0.9c-4.7,10.3-15.1,17.4-27.1,17.4  c-16.5,0-29.9-13.4-29.9-29.9C20.3,37.9,27.4,27.5,37.6,22.8z"/></svg>',t.RENDER_HACKS_ICON='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 110 105" height="20" fill="white"><path d="M95,5v60H65c0-16.6-13.4-30-30-30V5H95z"/><path d="M65,65c0,16.6-13.4,30-30,30C18.4,95,5,81.6,5,65c0-16.6,13.4-30,30-30v30H65z"/></svg>',t.SAND_CLOCK_ICON='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" height="20" fill="white"><g><path d="M79.3,83.3h-6.2H24.9h-6.2c-1.7,0-3,1.3-3,3s1.3,3,3,3h60.6c1.7,0,3-1.3,3-3S81,83.3,79.3,83.3z"/><path d="M18.7,14.7h6.2h48.2h6.2c1.7,0,3-1.3,3-3s-1.3-3-3-3H18.7c-1.7,0-3,1.3-3,3S17,14.7,18.7,14.7z"/><path d="M73.1,66c0-0.9-0.4-1.8-1.1-2.4L52.8,48.5L72,33.4c0.7-0.6,1.1-1.4,1.1-2.4V20.7H24.9V31c0,0.9,0.4,1.8,1.1,2.4l19.1,15.1   L26,63.6c-0.7,0.6-1.1,1.4-1.1,2.4v11.3h48.2V66z"/></g></svg>',t.VR_ICON='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" height="20" fill="white"><g><path d="M29,8H3A1,1,0,0,0,2,9V23a1,1,0,0,0,1,1H13a1,1,0,0,0,1-.83l.66-4A1.36,1.36,0,0,1,16,18a1.38,1.38,0,0,1,1.36,1.26L18,23.17A1,1,0,0,0,19,24H29a1,1,0,0,0,1-1V9A1,1,0,0,0,29,8ZM8.5,19A3.5,3.5,0,1,1,12,15.5,3.5,3.5,0,0,1,8.5,19Zm15,0A3.5,3.5,0,1,1,27,15.5,3.5,3.5,0,0,1,23.5,19Z"/></g></svg>',t.setChildren=A;class S{constructor(){this.textarea=document.createElement("input"),this.textarea.style.color="white",this.textarea.style.backgroundColor="transparent",this.textarea.style.font="16px monospace",this.textarea.style.border="none",this.textarea.style.width="100%",this.textarea.style.caretColor="white",this.elem=this.textarea}selectAll(){this.textarea.setSelectionRange(0,this.textarea.value.length),this.textarea.scrollLeft=0}getValue(){return this.textarea.value}setValue(e){this.textarea.value=e}setPlaceholder(e){this.textarea.placeholder=e}}t.TextField=S;class b{constructor(){this.ontext=null,this.toplevel=document.createElement("div"),this.toplevel.style.position="relative",this.textfield=new S;const e=this.textfield.textarea;e.style.boxSizing="border-box",e.style.padding="12px",e.style.paddingLeft="32px",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="10px 14px",e.style.lineHeight="20px",e.onkeydown=e=>{"Escape"===e.code&&this.textfield.getValue().length>0&&(e.stopPropagation(),this.clear())},e.oninput=()=>{this.textChanged()},this.toplevel.appendChild(this.textfield.elem),this.clearButton=document.createElement("div"),this.clearButton.textContent="",this.clearButton.style.color="white",this.clearButton.style.position="absolute",this.clearButton.style.width="24px",this.clearButton.style.height="24px",this.clearButton.style.right="4px",this.clearButton.style.top="12px",this.clearButton.style.bottom="12px",this.clearButton.style.lineHeight="20px",this.clearButton.style.cursor="pointer",this.clearButton.onclick=()=>{this.clear()},this.syncClearButtonVisible(),this.toplevel.appendChild(this.clearButton),this.elem=this.toplevel}syncClearButtonVisible(){this.clearButton.style.display=this.textfield.getValue().length>0?"":"none"}textChanged(){null!==this.ontext&&this.ontext(this.textfield.getValue()),this.syncClearButtonVisible()}clear(){this.textfield.setValue(""),this.textChanged()}setIcon(e){this.textfield.textarea.style.backgroundImage=`url(data:image/svg+xml,${encodeURI(e)})`}setPlaceholder(e){this.textfield.setPlaceholder(e)}}t.TextEntry=b;class v{constructor(){this.flairs=[],this.internalFlairs=[],this.isDragging=!1,this.toplevel=document.createElement("div"),this.scrollContainer=document.createElement("div"),this.setHeight("200px"),this.setTextSelectable(!1),this.scrollContainer.style.overflow="auto",this.toplevel.appendChild(this.scrollContainer),this.elem=this.toplevel}setTextSelectable(e){this.scrollContainer.style.userSelect=e?"":"none"}setHeight(e){this.scrollContainer.style.height=e}getOuterForIndex(e){return this.scrollContainer.children.item(e)}focusItem(e){const t=this.getOuterForIndex(e);return!!this.itemIsVisible(t)&&(!!t.querySelector(".selector")&&(t.focus(),!0))}setItems(e){this.scrollContainer.style.display=e.length>0?"":"none",this.scrollContainer.innerHTML="";let t=!1;for(let a=0;a<e.length;a++){const r=e[a],n=document.createElement("div");if(n.tabIndex=-1,n.style.display="grid",n.style.gridAutoFlow="column",n.style.outline="none",0===r.type){n.style.cursor="pointer",n.style.paddingLeft=t?"24px":"";const e=document.createElement("div");e.classList.add("selector"),e.style.display="list-item",e.style.lineHeight="24px",e.style.textShadow="0 0 8px black",n.appendChild(e);const s=document.createElement("span");if(s.classList.add("text"),void 0!==r.html)s.innerHTML=r.html;else{if(void 0===r.name)throw"whoops";s.textContent=r.name}e.appendChild(s);const i=a;n.onfocus=()=>{this.itemFocused(i,!this.isDragging)},n.onmousedown=()=>{document.activeElement===n?n.onfocus(null):n.focus(),this.isDragging=!0},n.onmouseup=()=>{this.isDragging=!1},n.onmouseover=e=>{this.isDragging&&n.focus()}}else if(1===r.type){const e=document.createElement("span");e.classList.add("header"),e.style.fontWeight="bold",e.style.lineHeight="36px",e.style.textShadow="0 0 8px black",e.style.paddingLeft="8px",e.style.verticalAlign="baseline",e.innerHTML=r.html,n.appendChild(e),t=!0}const s=document.createElement("span");s.classList.add("extra"),s.style.justifySelf="end",n.appendChild(s),void 0!==r.visible&&this._setItemVisible(n,r.visible),this.scrollContainer.appendChild(n)}this.computeHeaderVisibility()}setStrings(e){this.setItems(e.map(e=>({type:0,name:e})))}itemIsHeader(e){return!!e.querySelector("span.header")}itemIsVisible(e){return"none"!==e.style.display}computeHeaderVisibility(){const e=this.getNumItems();for(let t=0;t<e;){const a=this.getOuterForIndex(t);if(this.itemIsHeader(a)){let r=t+1,n=!1;for(;r<e;r++){const e=this.getOuterForIndex(r);if(this.itemIsHeader(e))break;if(this.itemIsVisible(e)){n=!0;break}}this._setItemVisible(a,n),t=r}else t++}}_setItemVisible(e,t){e.style.display=t?"grid":"none"}setItemVisible(e,t){const a=this.scrollContainer.children.item(e);this._setItemVisible(a,t)}getNumItems(){return this.scrollContainer.childElementCount}setFlairs(e){this.flairs=e,this.syncInternalFlairs()}setInternalFlairs(e){this.internalFlairs=e,this.syncFlairDisplay()}syncFlairDisplay(){const e=this.internalFlairs;for(let t=0;t<this.getNumItems();t++){const a=this.getOuterForIndex(t),r=a.firstElementChild;if(!r.classList.contains("selector"))continue;const n=e.find(e=>e.index===t),s=void 0!==n&&void 0!==n.background?n.background:"";a.style.background=s;const o=i.assertExists(a.querySelector("span.text")),l=void 0!==n&&void 0!==n.color?n.color:"";o.style.color=l;const c=void 0!==n&&void 0!==n.fontWeight?n.fontWeight:"";o.style.fontWeight=c,void 0!==n&&void 0!==n.bulletColor?(r.style.listStyleType="disc",r.style.listStylePosition="inside",r.style.paddingLeft="4px",r.style.color=n.bulletColor):(r.style.listStyleType="none",r.style.color="");const h=void 0!==n&&n.extraHTML?n.extraHTML:"";i.assertExists(a.querySelector("span.extra")).innerHTML=h}}}function w(e,t){const a=e.findIndex(e=>e.index===t);if(a>=0)return e[a]=Object.assign({},e[a]),e[a];{const a={index:t};return e.push(a),a}}t.ScrollSelect=v,t.ensureFlairIndex=w;class x extends v{constructor(){super(),this.highlightedIndex=-1,this.setHighlightFlair=!0,this.toplevel.onkeydown=e=>{let t=!1;"ArrowUp"===e.code?t=this.navigate(-1):"ArrowDown"===e.code&&(t=this.navigate(1)),t&&(e.stopPropagation(),e.preventDefault())}}navigate(e){const t=this.getNumItems();let a=this.highlightedIndex;for(a<0||a>=t||!this.itemIsVisible(this.getOuterForIndex(a))?e>0?a=0:e<0&&(a=t-1):a+=e;!(a<0||a>=t||this.focusItem(a));)a+=e;return!0}setItems(e){this.highlightedIndex=-1,super.setItems(e)}itemFocused(e,t){this.selectItem(e)}selectItem(e){this.setHighlighted(e),this.onselectionchange(e)}setHighlighted(e){this.highlightedIndex!==e&&(this.highlightedIndex=e,this.syncInternalFlairs())}syncInternalFlairs(){const e=[...this.flairs];if(this.setHighlightFlair&&this.highlightedIndex>=0){const a=w(e,this.highlightedIndex);a.background=t.HIGHLIGHT_COLOR,a.fontWeight="bold"}this.setInternalFlairs(e)}}t.SingleSelect=x;class T extends v{constructor(){super(),this.itemIsOn=[];const e=p('\n<div style="display: grid; grid-template-columns: 1fr 1fr; grid-gap: 4px;">\n<style>\n.AllButton, .NoneButton {\n    text-align: center;\n    line-height: 32px;\n    cursor: pointer;\n    background: #666;\n    font-weight: bold;\n    user-select: none;\n}\n</style>\n<div class="AllButton">All</div><div class="NoneButton">None</div>\n</div>\n');this.toplevel.insertBefore(e,this.toplevel.firstChild),this.toplevel.querySelector(".AllButton").onclick=()=>{for(let e=0;e<this.getNumItems();e++)this.setItemIsOn(e,!0);this.syncInternalFlairs()},this.toplevel.querySelector(".NoneButton").onclick=()=>{for(let e=0;e<this.getNumItems();e++)this.setItemIsOn(e,!1);this.syncInternalFlairs()}}setItemIsOn(e,t){this.itemIsOn[e]=t,this.onitemchanged(e,this.itemIsOn[e])}itemFocused(e,t){t&&(this.itemShouldBeOn=!this.itemIsOn[e]),this.setItemIsOn(e,this.itemShouldBeOn),this.syncInternalFlairs()}syncInternalFlairs(){const e=[...this.flairs];for(let a=0;a<this.getNumItems();a++){const r=w(e,a);r.bulletColor=this.itemIsOn[a]?t.HIGHLIGHT_COLOR:"#aaa",r.color=this.itemIsOn[a]?"white":"#aaa"}this.setInternalFlairs(e)}setItemsSelected(e){this.itemIsOn=e,this.syncInternalFlairs()}setItemSelected(e,t){this.itemIsOn[e]=t,this.syncInternalFlairs()}}t.MultiSelect=T;class y{constructor(e="",t=!1){this.checked=!1,this.onchanged=null,this.toplevel=document.createElement("div"),this.toplevel.style.display="grid",this.toplevel.style.gridTemplateColumns="1fr 24px",this.toplevel.style.alignItems="center",this.toplevel.style.cursor="pointer",this.toplevel.onclick=this._toggle.bind(this),this.label=document.createElement("div"),this.label.style.userSelect="none",this.toplevel.appendChild(this.label),this.emblem=document.createElement("div"),this.emblem.style.width="10px",this.emblem.style.height="10px",this.emblem.style.justifySelf="center",this.emblem.style.margin="4px",this.emblem.style.borderRadius="4px",this.emblem.style.border="2px solid white",this.toplevel.appendChild(this.emblem),this.setLabel(e),this.setChecked(t),this.elem=this.toplevel}setChecked(e){this.checked=e,this.checked?(this.emblem.style.backgroundColor=t.HIGHLIGHT_COLOR,this.emblem.style.borderColor="white",this.label.style.fontWeight="bold",this.label.style.color="white"):(this.emblem.style.backgroundColor="transparent",this.emblem.style.borderColor="#aaa",this.label.style.fontWeight="",this.label.style.color="#aaa")}_toggle(){this.setChecked(!this.checked),null!==this.onchanged&&this.onchanged()}setLabel(e){this.label.textContent=e}}t.Checkbox=y;class C{constructor(){this.expanded=null,this.manuallyExpanded=!1,this.autoClosed=!1,this.customHeaderBackgroundColor="",this.ignoreAutoCloseTimeout=0,this.toplevel=document.createElement("div"),this.toplevel.style.color="white",this.toplevel.style.font="16px monospace",this.toplevel.style.overflow="hidden",this.toplevel.style.display="grid",this.toplevel.style.gridAutoFlow="column",this.toplevel.style.gridGap="20px",this.toplevel.style.transition=".25s ease-out",this.toplevel.style.alignItems="start",this.toplevel.style.outline="none",this.toplevel.onkeydown=this.onKeyDown.bind(this),this.toplevel.onmouseover=this.syncSize.bind(this),this.toplevel.onmouseout=this.syncSize.bind(this),this.toplevel.tabIndex=-1,this.mainPanel=document.createElement("div"),this.mainPanel.style.overflow="hidden",this.mainPanel.style.transition=".25s ease-out",this.mainPanel.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.toplevel.appendChild(this.mainPanel),this.extraRack=document.createElement("div"),this.extraRack.style.gridAutoFlow="column",this.extraRack.style.gridGap="20px",this.extraRack.style.transition=".15s ease-out .10s",this.toplevel.appendChild(this.extraRack),this.headerContainer=document.createElement("div"),this.mainPanel.appendChild(this.headerContainer),this.header=document.createElement("h1"),this.header.style.lineHeight="28px",this.header.style.width="440px",this.header.style.margin="0",this.header.style.fontSize="100%",this.header.style.textAlign="center",this.header.style.cursor="pointer",this.header.style.userSelect="none",this.header.style.display="grid",this.header.style.gridTemplateColumns="28px 1fr",this.header.style.alignItems="center",this.header.style.justifyItems="center",this.header.style.gridAutoFlow="column",this.header.onclick=()=>{this.ignoreAutoCloseTimeout>0?this.ignoreAutoCloseTimeout=0:this.toggleExpanded()},this.headerContainer.appendChild(this.header),this.contents=document.createElement("div"),this.contents.style.width="440px",this.mainPanel.appendChild(this.contents),this.elem=this.toplevel}onKeyDown(e){"Escape"===e.code&&this.expanded&&(e.preventDefault(),e.stopPropagation(),this.setExpanded(!1))}syncSize(){const e=this.expanded||this.mainPanel.matches(":hover");if(this.mainPanel.style.width=e?"440px":"28px",this.expanded){const e=Math.max(this.header.offsetHeight+this.contents.offsetHeight,this.extraRack.offsetHeight);this.toplevel.style.height=`${e}px`,this.extraRack.style.opacity="1",this.extraRack.style.width="auto"}else this.toplevel.style.transition=".25s ease-out",this.toplevel.style.height="28px",this.extraRack.style.opacity="0",this.extraRack.style.width="0"}setVisible(e){this.toplevel.style.display=e?"grid":"none"}setTitle(e,t){this.svgIcon=p(e).querySelector("svg"),this.svgIcon.style.gridColumn="1",this.header.textContent=t,this.header.appendChild(this.svgIcon),this.toplevel.dataset.title=t,this.setExpanded(!1)}syncHeaderStyle(){this.customHeaderBackgroundColor?(this.svgIcon.style.fill="",this.header.style.backgroundColor=this.customHeaderBackgroundColor,this.header.style.color="white"):(this.svgIcon.style.fill=this.expanded?"black":"",_(this.header,!!this.expanded,t.HIGHLIGHT_COLOR))}syncExpanded(){const e=this.manuallyExpanded&&!this.autoClosed;return this.expanded!==e&&(this.expanded=e,this.syncHeaderStyle(),this.syncSize(),this.expanded||document.body.focus(),!0)}setExpanded(e){this.manuallyExpanded=e,this.syncExpanded(),this.expanded&&this.elem.focus()}toggleExpanded(){this.setExpanded(!this.expanded)}setAutoClosed(e){if(this.autoClosed===e)return;this.autoClosed=e,this.syncExpanded()&&this.expanded&&(this.ignoreAutoCloseTimeout=window.setTimeout(()=>{this.ignoreAutoCloseTimeout=0},1e3))}}t.Panel=C;class M{constructor(){this.customHeaderBackgroundColor="",this.toplevel=document.createElement("div"),this.toplevel.style.color="white",this.toplevel.style.font="16px monospace",this.toplevel.style.overflow="hidden",this.toplevel.style.display="grid",this.toplevel.style.gridAutoFlow="column",this.toplevel.style.gridGap="20px",this.toplevel.style.alignItems="start",this.toplevel.style.outline="none",this.toplevel.style.minWidth="300px",this.toplevel.style.position="absolute",this.toplevel.style.left="82px",this.toplevel.style.top="32px",this.toplevel.style.pointerEvents="auto",this.toplevel.tabIndex=-1,this.mainPanel=document.createElement("div"),this.mainPanel.style.overflow="hidden",this.mainPanel.style.transition=".25s ease-out",this.mainPanel.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.toplevel.appendChild(this.mainPanel),this.headerContainer=document.createElement("div"),this.mainPanel.appendChild(this.headerContainer),this.header=document.createElement("h1"),this.header.style.lineHeight="28px",this.header.style.margin="0",this.header.style.fontSize="100%",this.header.style.textAlign="center",this.header.style.cursor="pointer",this.header.style.userSelect="none",this.header.style.display="grid",this.header.style.gridTemplateColumns="28px 1fr",this.header.style.alignItems="center",this.header.style.justifyItems="center",this.header.style.gridAutoFlow="column",this.header.addEventListener("mousedown",e=>{d.GlobalGrabManager.takeGrab(this,e,{takePointerLock:!1,useGrabbingCursor:!0,releaseOnMouseUp:!0})}),this.headerContainer.appendChild(this.header),this.contents=document.createElement("div"),this.contents.style.maxHeight="50vh",this.contents.style.overflow="auto",this.mainPanel.appendChild(this.contents),this.setWidth(400),this.elem=this.toplevel,this.elem.onmouseover=()=>{this.elem.style.opacity="1"},this.elem.onmouseout=()=>{this.elem.style.opacity="0.2"},this.elem.style.opacity="0.2"}setWidth(e){this.header.style.width=`${e}px`,this.contents.style.width=`${e}px`}destroy(){this.toplevel.parentElement.removeChild(this.toplevel)}onMotion(e,t){this.toplevel.style.left=parseFloat(this.toplevel.style.left)+e+"px",this.toplevel.style.top=parseFloat(this.toplevel.style.top)+t+"px"}onGrabReleased(){}setVisible(e){this.toplevel.style.display=e?"grid":"none"}setTitle(e,t){this.svgIcon=p(e).querySelector("svg"),this.svgIcon.style.gridColumn="1",this.header.textContent=t,this.header.appendChild(this.svgIcon),this.toplevel.dataset.title=t,this.syncHeaderStyle()}syncHeaderStyle(){this.customHeaderBackgroundColor?(this.svgIcon.style.fill="",this.header.style.backgroundColor=this.customHeaderBackgroundColor,this.header.style.color="white"):(this.svgIcon.style.fill="black",_(this.header,!0,t.HIGHLIGHT_COLOR))}}function U(e,t){return 0===e.length||e.every(e=>e.test(t))}t.FloatingPanel=M;class k extends C{constructor(e){super(),this.viewer=e,this.sceneGroups=[],this.sceneDescs=[],this.currentSearchTokens=[],this.setTitle('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 2 92 92" height="20" fill="white"><path d="M84.3765045,45.2316481 L77.2336539,75.2316205 L77.2336539,75.2316205 C77.1263996,75.6820886 76.7239081,76 76.2608477,76 L17.8061496,76 C17.2538649,76 16.8061496,75.5522847 16.8061496,75 C16.8061496,74.9118841 16.817796,74.8241548 16.8407862,74.739091 L24.7487983,45.4794461 C24.9845522,44.607157 25.7758952,44.0012839 26.6794815,44.0012642 L83.4036764,44.0000276 L83.4036764,44.0000276 C83.9559612,44.0000156 84.4036862,44.4477211 84.4036982,45.0000058 C84.4036999,45.0780163 84.3945733,45.155759 84.3765045,45.2316481 L84.3765045,45.2316481 Z M15,24 L26.8277004,24 L26.8277004,24 C27.0616369,24 27.2881698,24.0820162 27.4678848,24.2317787 L31.799078,27.8411064 L31.799078,27.8411064 C32.697653,28.5899189 33.8303175,29 35,29 L75,29 C75.5522847,29 76,29.4477153 76,30 L76,38 L76,38 C76,38.5522847 75.5522847,39 75,39 L25.3280454,39 L25.3280454,39 C23.0690391,39 21.0906235,40.5146929 20.5012284,42.6954549 L14.7844016,63.8477139 L14.7844016,63.8477139 C14.7267632,64.0609761 14.5071549,64.1871341 14.2938927,64.1294957 C14.1194254,64.0823423 13.9982484,63.9240598 13.9982563,63.7433327 L13.9999561,25 L14,25 C14.0000242,24.4477324 14.4477324,24.0000439 15,24.0000439 L15,24 Z"/></svg>',"Games"),this.searchEntry=new b,this.searchEntry.elem.style.background="rgba(0, 0, 0, 1.0)",this.searchEntry.setIcon('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 26.25" height="20" fill="white"><path d="M8.6953,14.3916 C5.5543,14.3916 3.0003,11.8356 3.0003,8.6956 C3.0003,5.5546 5.5543,2.9996 8.6953,2.9996 C11.8363,2.9996 14.3913,5.5546 14.3913,8.6956 C14.3913,11.8356 11.8363,14.3916 8.6953,14.3916 L8.6953,14.3916 Z M15.8423,13.7216 L15.6073,13.9566 C16.7213,12.4956 17.3913,10.6756 17.3913,8.6956 C17.3913,3.8936 13.4983,-0.0004 8.6953,-0.0004 C3.8933,-0.0004 0.0003,3.8936 0.0003,8.6956 C0.0003,13.4976 3.8933,17.3916 8.6953,17.3916 C10.6753,17.3916 12.4953,16.7216 13.9573,15.6076 L13.7213,15.8426 L18.3343,20.4546 L20.4553,18.3336 L15.8423,13.7216 Z"/></svg>'),this.searchEntry.setPlaceholder("Search..."),this.searchEntry.ontext=e=>{this._setSearchString(e)},this.contents.appendChild(this.searchEntry.elem),this.sceneGroupList=new x,this.sceneGroupList.setHeight("400px"),this.contents.appendChild(this.sceneGroupList.elem),this.sceneDescList=new x,this.sceneDescList.setHighlightFlair=!1,this.sceneDescList.elem.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.sceneDescList.elem.style.width="500px",this.sceneDescList.setHeight("472px"),this.extraRack.appendChild(this.sceneDescList.elem),this.sceneGroupList.onselectionchange=e=>{this.selectSceneGroup(e)},this.sceneDescList.onselectionchange=e=>{this.selectSceneDesc(e)}}onKeyDown(e){if("ArrowUp"===e.code||"ArrowDown"===e.code)this.sceneGroupList.elem.onkeydown(e);else{const t=this.searchEntry.textfield.textarea;t.focus(),t.onkeydown(e)}e.defaultPrevented||super.onKeyDown(e)}expandAndFocus(){this.setExpanded(!0),this.setAutoClosed(!1),this.elem.focus()}_setSearchString(e){this.currentSearchTokens=e.split(/\s+/).filter(e=>e.length).map(e=>new RegExp(`(\\b${function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(e)})`,"i")),this.syncVisibility()}syncVisibility(){const e=this.currentSearchTokens;let t=!1;function a(a){return"string"==typeof a?(t=U(e,a),!1):!!t||U(e,a.name)}let r=!1,n=!1;for(let s=0;s<this.sceneGroups.length;s++){const i=this.sceneGroups[s];if("string"==typeof i)r=U(e,i);else{let o=!1,l=!1;l=i.sceneDescs.length<=0||!!i.hidden,l||(!o==r&&(o=!0),!o&&U(e,i.name)&&(o=!0),i===this.selectedSceneGroup&&(n=o),o||(t=!1,o=i.sceneDescs.some(e=>a(e)))),this.sceneGroupList.setItemVisible(s,o)}}t=!1;for(let e=0;e<this.sceneDescs.length;e++){let t;!t&&n&&(t=!0),t||(t=a(this.sceneDescs[e])),this.sceneDescList.setItemVisible(e,t)}this.sceneGroupList.computeHeaderVisibility(),this.sceneDescList.computeHeaderVisibility()}setCurrentDesc(e,t){this.selectedSceneGroup=e,this.currentSceneGroup=e,this.currentSceneDesc=t;const a=this.sceneGroups.indexOf(this.currentSceneGroup);this.sceneGroupList.setHighlighted(a),this.syncSceneDescs()}setSceneGroups(e){this.sceneGroups=e,this.sceneGroupList.setItems(e.map(e=>"string"==typeof e?{type:1,html:e}:{type:0,name:e.name})),this.syncSceneDescs()}setProgress(e){this.loadProgress=e,this.syncFlairs(),this.syncHeaderStyle()}selectSceneDesc(e){this.onscenedescselected(this.selectedSceneGroup,this.sceneDescs[e])}getLoadingGradient(e){const a=`${Math.round(100*this.loadProgress)}%`;return`linear-gradient(to right, ${t.HIGHLIGHT_COLOR} ${a}, ${e} ${a})`}syncHeaderStyle(){super.syncHeaderStyle(),_(this.header,!!this.expanded),this.header.style.backgroundColor="transparent",this.expanded?this.headerContainer.style.background=t.HIGHLIGHT_COLOR:this.headerContainer.style.background=this.getLoadingGradient(t.PANEL_BG_COLOR)}syncFlairs(){const e=[],t=this.sceneGroups.indexOf(this.currentSceneGroup);if(t>=0){w(e,t).background="#666"}this.sceneGroupList.setFlairs(e);const a=[],r=this.sceneDescs.indexOf(this.currentSceneDesc);if(r>=0){const e=w(a,r);e.background=this.getLoadingGradient("transparent"),e.fontWeight="bold";const t=`${Math.round(100*this.loadProgress)}%`;e.extraHTML=this.loadProgress<1?`<span style="font-weight: bold; color: #aaa">${t}</span>`:""}this.sceneDescList.setFlairs(a)}selectSceneGroup(e){const t=this.sceneGroups[e];this.selectedSceneGroup=t,this.syncSceneDescs()}syncSceneDescs(){this.selectedSceneGroup?this.setSceneDescs(this.selectedSceneGroup.sceneDescs):this.setSceneDescs([])}setSceneDescs(e){this.sceneDescs=e,this.sceneDescList.setItems(e.map(e=>"string"==typeof e?{type:1,html:e}:{type:0,name:e.name})),this.syncFlairs(),this.syncVisibility()}}const D='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGElEQVQYlWNgYGCQwoKxgqGgcJA5h3yFAAs8BRWVSwooAAAAAElFTkSuQmCC")';class I extends C{constructor(){super(),this.textureList=[],this.setTitle('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" height="20" fill="white"><path d="M143.5,143.5v300h300v-300H143.5z M274.8,237.2c10.3,0,18.7,8.4,18.7,18.9c0,10.3-8.4,18.7-18.7,18.7   c-10.3,0-18.7-8.4-18.7-18.7C256,245.6,264.4,237.2,274.8,237.2z M406,406H181v-56.2l56.2-56.1l37.5,37.3l75-74.8l56.2,56.1V406z"/><polygon points="387.2,68.6 68.5,68.6 68.5,368.5 106,368.5 106,106 387.2,106"/></svg>',"Textures"),this.scrollList=new x,this.scrollList.elem.style.height="200px",this.scrollList.elem.style.overflow="auto",this.scrollList.onselectionchange=e=>{this.selectTexture(e)},this.contents.appendChild(this.scrollList.elem),this.surfaceView=document.createElement("div"),this.surfaceView.style.width="100%",this.surfaceView.style.height="200px",this.surfaceView.onmouseover=()=>{this.surfaceView.style.backgroundColor="white",this.surfaceView.style.backgroundImage=D},this.surfaceView.onmouseout=()=>{this.surfaceView.style.backgroundColor="black",this.surfaceView.style.backgroundImage=""},this.surfaceView.onmouseout(null),this.contents.appendChild(this.surfaceView),this.properties=document.createElement("div"),this.contents.appendChild(this.properties),this.fullSurfaceView=document.createElement("div"),this.fullSurfaceView.style.backgroundColor="rgba(0, 0, 0, 0.2)",this.fullSurfaceView.style.padding="20px",this.extraRack.appendChild(this.fullSurfaceView)}async getViewerTextureList(){const e=[];for(let t=0;t<this.textureList.length;t++)e.push(this.maybeActivateTexture(this.textureList[t]));return await Promise.all(e),this.textureList}showInSurfaceView(e){this.surfaceView.innerHTML="",e.style.width="100%",e.style.height="100%",e.style.objectFit="scale-down",this.surfaceView.appendChild(e)}showInFullSurfaceView(e){this.fullSurfaceView.innerHTML="";for(let r=0;r<e.length;r++){const n=document.createElement("canvas");t=n,a=e[r],t.width=a.width,t.height=a.height,t.title=a.title,t.getContext("2d").drawImage(a,0,0),n.style.display="block",n.style.backgroundColor="white",n.style.backgroundImage=D,this.fullSurfaceView.appendChild(n)}var t,a}async maybeActivateTexture(e){0===e.surfaces.length&&void 0!==e.activate&&await e.activate()}selectTexture(e){const t=this.textureList[e];if(0===t.surfaces.length&&void 0!==t.activate)return void t.activate().then(()=>{this.selectTexture(e)});this.scrollList.setHighlighted(e);const a=new Map;a.set("Name",t.name),a.set("Mipmaps",""+t.surfaces.length),a.set("Width",""+t.surfaces[0].width),a.set("Height",""+t.surfaces[0].height),t.extraInfo&&t.extraInfo.forEach((e,t)=>a.set(t,e)),this.properties.innerHTML='<div style="display: grid; grid-template-columns: 1fr 1fr"></div>';const r=this.properties.firstElementChild;a.forEach((e,t)=>{const a=document.createElement("span");a.textContent=t,r.appendChild(a);const n=document.createElement("span");n.style.textAlign="right",n.textContent=e,r.appendChild(n)}),t.surfaces.length>0&&this.showInSurfaceView(t.surfaces[0]),this.showInFullSurfaceView(t.surfaces)}setThingList(e){this.setTextureList(e.map(e=>e.viewerTexture))}setTextureList(e){if(e=e.filter(e=>e.surfaces.length>0||void 0!==e.activate),this.setVisible(e.length>0),0===e.length)return;const t=e.map(e=>e.name);this.scrollList.setStrings(t),this.textureList=e}setTextureHolder(e){this.setTextureList(e.viewerTextures),e.onnewtextures=()=>{this.setTextureList(e.viewerTextures)}}}t.TextureViewer=I;class R{constructor(){this.onvalue=null,this.toplevel=document.createElement("div"),this.toplevel.innerHTML=`\n<style>\n.Slider {\n    -webkit-appearance: none;\n    width: 100%;\n    margin: 0;\n}\n.Slider::-moz-range-thumb {\n    width: 16px;\n    height: 24px;\n    cursor: pointer;\n    background: ${t.HIGHLIGHT_COLOR};\n    border-radius: 0;\n    border: none;\n}\n.Slider::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 16px;\n    height: 24px;\n    cursor: pointer;\n    background: ${t.HIGHLIGHT_COLOR};\n    border-radius: 0;\n    border: none;\n}\n.Slider::-moz-range-track {\n    cursor: pointer;\n    background: #444;\n}\n.Slider::-webkit-slider-runnable-track {\n    cursor: pointer;\n    background: #444;\n}\n.Slider::-moz-range-progress, .Slider::-webkit-slider-thumb {\n    cursor: pointer;\n    background: #aaa;\n}\n</style>\n<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center">\n<div style="font-weight: bold; user-select: none" class="Label"></div>\n<input class="Slider" type="range">\n</div>\n`,this.sliderInput=this.toplevel.querySelector(".Slider"),this.sliderInput.oninput=this.onInput.bind(this),this.elem=this.toplevel}onInput(){null!==this.onvalue&&this.onvalue(this.getValue())}setRange(e,t,a=(t-e)/100){this.sliderInput.min=""+e,this.sliderInput.max=""+t,this.sliderInput.step=""+a}setLabel(e){this.toplevel.querySelector(".Label").textContent=e}getValue(){return+this.sliderInput.value}setValue(e){this.sliderInput.value=""+e}getT(){return(+this.sliderInput.value-+this.sliderInput.min)/(+this.sliderInput.max-+this.sliderInput.min)}setT(e){const t=e*(+this.sliderInput.max-+this.sliderInput.min)+ +this.sliderInput.min;this.setValue(t)}}t.Slider=R;class B extends C{constructor(e,t){super(),this.ui=e,this.viewer=t,this.setTitle('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" height="20" fill="white"><polygon points="48.2573,19.8589 33.8981,15.0724 5,67.8384 48.2573,90.3684" /><polygon points="51.5652,19.8738 51.5652,90.3734 95,67.8392 65.9366,15.2701" /><polygon points="61.3189,13.2756 49.9911,9.6265 38.5411,13.1331 49.9213,16.9268" /></svg>',"Viewer Settings"),this.contents.innerHTML='\n<style>\n.SettingsHeader, .SettingsButton {\n    font-weight: bold;\n}\n.SettingsButton {\n    background: #444;\n    text-align: center;\n    line-height: 24px;\n    cursor: pointer;\n}\n</style>\n\n<div style="display: grid; grid-template-columns: 3fr 1fr 1fr 1fr; align-items: center;">\n<div class="SettingsHeader">Camera Controller</div>\n<div class="SettingsButton CameraControllerWASD">WASD</div><div class="SettingsButton CameraControllerOrbit">Orbit</div><div class="SettingsButton CameraControllerOrtho">Ortho</div>\n</div>\n\n<div class="SliderContainer">\n</div>\n',this.contents.style.lineHeight="36px";const a=this.contents.querySelector(".SliderContainer");this.fovSlider=new R,this.fovSlider.setLabel("Field of View"),this.fovSlider.setRange(1,100),this.fovSlider.setValue(25),this.fovSlider.onvalue=this.onFovSliderChange.bind(this),a.appendChild(this.fovSlider.elem),this.camSpeedSlider=new R,this.camSpeedSlider.setLabel("Camera Speed"),this.camSpeedSlider.setRange(0,200),this.camSpeedSlider.onvalue=this.updateCameraSpeedFromSlider.bind(this),a.appendChild(this.camSpeedSlider.elem),this.viewer.addKeyMoveSpeedListener(this.onKeyMoveSpeedChanged.bind(this)),this.viewer.inputManager.addScrollListener(this.onScrollWheel.bind(this)),this.cameraControllerWASD=this.contents.querySelector(".CameraControllerWASD"),this.cameraControllerWASD.onclick=()=>{this.setCameraControllerClass(o.FPSCameraController)},this.cameraControllerOrbit=this.contents.querySelector(".CameraControllerOrbit"),this.cameraControllerOrbit.onclick=()=>{this.setCameraControllerClass(o.OrbitCameraController)},this.cameraControllerOrtho=this.contents.querySelector(".CameraControllerOrtho"),this.cameraControllerOrtho.onclick=()=>{this.setCameraControllerClass(o.OrthoCameraController)},this.invertYCheckbox=new y("Invert Y Axis?"),this.invertYCheckbox.onchanged=()=>{h.GlobalSaveManager.saveSetting("InvertY",this.invertYCheckbox.checked)},this.contents.appendChild(this.invertYCheckbox.elem),h.GlobalSaveManager.addSettingListener("InvertY",this.invertYChanged.bind(this)),this.invertXCheckbox=new y("Invert X Axis?"),this.invertXCheckbox.onchanged=()=>{h.GlobalSaveManager.saveSetting("InvertX",this.invertXCheckbox.checked)},this.contents.appendChild(this.invertXCheckbox.elem),h.GlobalSaveManager.addSettingListener("InvertX",this.invertXChanged.bind(this))}onFovSliderChange(e){const t=this.fovSlider.getT();this.viewer.fovY=t*(.995*Math.PI)}onKeyMoveSpeedChanged(){const e=this.viewer.cameraController.getKeyMoveSpeed();null!==e?(g(this.camSpeedSlider.elem,!0),this.camSpeedSlider.setValue(e),this.ui.cameraSpeedIndicator.setCameraSpeed(e)):g(this.camSpeedSlider.elem,!1)}setInitialKeyMoveSpeed(e){this.camSpeedSlider.setValue(e)}setCameraControllerClass(e){this.viewer.setCameraController(new e),this.cameraControllerSelected(e),this.updateCameraSpeedFromSlider()}onScrollWheel(){const e=u.clamp(this.camSpeedSlider.getValue()+4*Math.sign(this.viewer.inputManager.dz),0,200);this.ui.setMouseActive(),this.viewer.setKeyMoveSpeed(e)}updateCameraSpeedFromSlider(){this.viewer.setKeyMoveSpeed(this.camSpeedSlider.getValue())}cameraControllerSelected(e){_(this.cameraControllerWASD,e===o.FPSCameraController),_(this.cameraControllerOrbit,e===o.OrbitCameraController),_(this.cameraControllerOrtho,e===o.OrthoCameraController),g(this.fovSlider.elem,e===o.FPSCameraController)}invertYChanged(e,t){const a=e.loadSetting(t,!1);this.invertYCheckbox.setChecked(a)}invertXChanged(e,t){const a=e.loadSetting(t,!1);this.invertXCheckbox.setChecked(a)}}class P extends C{constructor(e,a){super(),this.ui=e,this.viewer=a,this.onWebXRStateRequested=e=>{},this.setTitle(t.VR_ICON,"VR Settings"),this.contents.style.lineHeight="36px",this.contents.innerHTML+='\n        <div id="About">\n        <p>To enable VR in Chrome, make sure you go to <font color="aqua">chrome://flags/</font> and change the following settings:</p>\n        <ul>\n            <li> WebXR Device API - <font color="green"><strong>Enabled</strong></font></li>\n            <li>OpenXR support - <font color="green"><strong>Enabled</strong></font></li>\n            <li>OpenVR hardware support - <font color="green"><strong>Enabled</strong></font></li>\n            <li>Oculus hardware support - <font color="green"><strong>Enabled</strong></font></li>\n            <li>XR device sandboxing - <font color="red"><strong>Disabled</strong></font></li>\n        </ul>\n        <p>Click on the <strong>Enable VR</strong> checkbox to go in VR mode.</p>\n        <p>Press the <strong>Trigger</strong> to go up, and use the <strong>Grab Button</strong> to go down.\n        You can move horizontally by using the <strong>Joystick</strong>.\n        </div>\n        ',this.enableXRCheckBox=new y("Enable VR"),this.contents.appendChild(this.enableXRCheckBox.elem),this.enableXRCheckBox.onchanged=this.enableXRChecked.bind(this);const r=()=>{return`VR World Scale: ${e=this.viewer.xrCameraController.worldScale,e.toPrecision(5).toString()}`;var e};this.scaleSlider=new R,this.scaleSlider.setLabel(r()),this.scaleSlider.setRange(10,1e4),this.scaleSlider.setValue(this.viewer.xrCameraController.worldScale),this.scaleSlider.onvalue=()=>{this.viewer.xrCameraController.worldScale=this.scaleSlider.getValue(),this.scaleSlider.setValue(this.viewer.xrCameraController.worldScale),this.scaleSlider.setLabel(r())},this.contents.appendChild(this.scaleSlider.elem)}async enableXRChecked(e,t){const a=this.enableXRCheckBox.checked;this.enableXRCheckBox.setChecked(a),this.onWebXRStateRequested(a)}}class E{constructor(e=0,t=160){this.minY=e,this.maxY=t,this.textYOffset=0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}beginDraw(e,t){s.resizeCanvas(this.canvas,e,t,window.devicePixelRatio),this.ctx.clearRect(0,0,e,t),this.textYOffset=24}drawPoints(e,t){const a=this.canvas.width,r=this.canvas.height,n=this.ctx,s=a/(e.length-1),i=r/(this.maxY-this.minY-1);n.lineWidth=2,n.strokeStyle=l.colorToCSS(t),n.fillStyle=l.colorToCSS({r:t.r,g:t.g,b:t.b,a:t.a-.8}),n.beginPath(),n.lineTo(a+20,r+20);for(let t=0;t<e.length;t++)n.lineTo(a-t*s,r-(e[t]-this.minY)*i);n.lineTo(-20,r+20),n.closePath(),n.fill(),n.stroke()}drawText(e){const t=this.ctx;t.fillStyle="white",t.font="12pt monospace",t.fillText(e,16,this.textYOffset),this.textYOffset+=16}}class F extends C{constructor(e){super(),this.viewer=e,this.history=[],this.fpsGraph=new E,this.fpsPoints=[],this.fpsColor={r:.4,g:.9,b:.6,a:1},this.setTitle('<svg xmlns="http://www.w3.org/2000/svg" viewBox="5 0 55 60" height="16" fill="white"><g><polygon points="6.9,11.5 6.9,56 55.4,56 55.4,53 9.9,53 9.9,11.5"/><path d="M52.7,15.8c-2.7,0-4.9,2.2-4.9,4.9c0,1,0.3,1.8,0.8,2.6l-5,6.8c-0.4-0.1-0.9-0.2-1.3-0.2c-1.5,0-2.9,0.7-3.8,1.8l-5.6-2.8   c0-0.2,0.1-0.5,0.1-0.8c0-2.7-2.2-4.9-4.9-4.9s-4.9,2.2-4.9,4.9c0,1.1,0.3,2,0.9,2.8l-3.9,5.1c-0.5-0.2-1.1-0.3-1.7-0.3   c-2.7,0-4.9,2.2-4.9,4.9s2.2,4.9,4.9,4.9s4.9-2.2,4.9-4.9c0-1-0.3-2-0.8-2.7l4-5.2c0.5,0.2,1.1,0.3,1.6,0.3c1.4,0,2.6-0.6,3.5-1.5   l5.8,2.9c0,0.1,0,0.2,0,0.3c0,2.7,2.2,4.9,4.9,4.9c2.7,0,4.9-2.2,4.9-4.9c0-1.2-0.4-2.2-1.1-3.1l4.8-6.5c0.6,0.2,1.2,0.4,1.9,0.4   c2.7,0,4.9-2.2,4.9-4.9S55.4,15.8,52.7,15.8z"/></g></svg>',"Statistics"),this.contents.appendChild(this.fpsGraph.canvas)}addRenderStatistics(e){if(!this.expanded)return;for(this.history.unshift(Object.assign({},e));this.history.length>100;)this.history.pop();this.fpsPoints.length=100;for(let e=0;e<this.fpsPoints.length;e++)this.fpsPoints[e]=void 0!==this.history[e]?this.history[e].fps:0;this.fpsGraph.beginDraw(this.elem.offsetWidth,200),this.fpsGraph.drawPoints(this.fpsPoints,this.fpsColor),this.fpsGraph.drawText(`FPS: ${0|e.fps}`),e.drawCallCount&&this.fpsGraph.drawText(`Draw Calls: ${e.drawCallCount}`),e.triangleCount&&this.fpsGraph.drawText(`Drawn Triangles: ${e.triangleCount}`),e.textureBindCount&&this.fpsGraph.drawText(`Texture Binds: ${e.textureBindCount}`),e.bufferUploadCount&&this.fpsGraph.drawText(`Buffer Uploads: ${e.bufferUploadCount}`);const t=this.viewer.camera.worldMatrix[12].toFixed(2),a=this.viewer.camera.worldMatrix[13].toFixed(2),r=this.viewer.camera.worldMatrix[14].toFixed(2);this.fpsGraph.drawText(`Camera Position: ${t} ${a} ${r}`)}}class V extends C{constructor(){super(),this.onfaq=null,this.setTitle('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" height="16" fill="white"><path d="M50,1.1C23,1.1,1.1,23,1.1,50S23,98.9,50,98.9C77,98.9,98.9,77,98.9,50S77,1.1,50,1.1z M55.3,77.7c0,1.7-1.4,3.1-3.1,3.1  h-7.9c-1.7,0-3.1-1.4-3.1-3.1v-5.1c0-1.7,1.4-3.1,3.1-3.1h7.9c1.7,0,3.1,1.4,3.1,3.1V77.7z M67.8,47.3c-2.1,2.9-4.7,5.2-7.9,6.9  c-1.8,1.2-3,2.4-3.6,3.8c-0.4,0.9-0.7,2.1-0.9,3.5c-0.1,1.1-1.1,1.9-2.2,1.9h-9.7c-1.3,0-2.3-1.1-2.2-2.3c0.2-2.7,0.9-4.8,2-6.4  c1.4-1.9,3.9-4.2,7.5-6.7c1.9-1.2,3.3-2.6,4.4-4.3c1.1-1.7,1.6-3.7,1.6-6c0-2.3-0.6-4.2-1.9-5.6c-1.3-1.4-3-2.1-5.3-2.1  c-1.9,0-3.4,0.6-4.7,1.7c-0.8,0.7-1.3,1.6-1.6,2.8c-0.4,1.4-1.7,2.3-3.2,2.3l-9-0.2c-1.1,0-2-1-1.9-2.1c0.3-4.8,2.2-8.4,5.5-11  c3.8-2.9,8.7-4.4,14.9-4.4c6.6,0,11.8,1.7,15.6,5c3.8,3.3,5.7,7.8,5.7,13.5C70.9,41.2,69.8,44.4,67.8,47.3z"/></svg>',"About"),this.contents.innerHTML=`\n<div id="About">\n<style>\n#About {\n    padding: 12px;\n    line-height: 1.2;\n}\n#About a {\n    color: white;\n}\n#About li span {\n    color: #aaa;\n}\n#About h1 {\n    margin: 0px;\n    font-size: 2em;\n}\n#About h2 {\n    font-size: 12.8pt;\n}\n#About h1 span, #About h1 img {\n    vertical-align: middle;\n    line-height: 64px;\n}\n#About .BuildVersion a {\n    color: #666;\n    font-size: smaller;\n}\n</style>\n\n<h1> <img src="${m.default}"> <span> noclip.website </span> </h1>\n<h2> A digital museum of video game levels </h2>\n\n<a href="#" class="FAQLink"> What is this? / FAQ </a>\n\n<p> <strong>CLICK AND DRAG</strong> to look around and use <strong>WASD</strong> to move the camera </p>\n<p> Hold <strong>SHIFT</strong> to go faster, and use <strong>MOUSE WHEEL</strong> to fine tune the speed\n<strong>Z</strong> toggles the UI. </p>\n\n<p><a href="https://discord.gg/bkJmKKv"><strong>JOIN THE DISCORD</strong> by clicking here</a></p>\n\n<p><strong>CODE PRIMARILY WRITTEN</strong> by <a href="https://twitter.com/JasperRLZ">Jasper</a></p>\n\n<p><strong>OPEN SOURCE</strong> at <a href="${c.GITHUB_URL}">GitHub</a></p>\n\n<p class="BuildVersion"><a href="${c.GITHUB_REVISION_URL}">build ${c.GIT_SHORT_REVISION}</a></p>\n</div>\n`,this.contents.querySelector(".FAQLink").onclick=()=>{null!==this.onfaq&&this.onfaq()}}}class O{constructor(){this.toplevel=document.createElement("div"),this.toplevel.classList.add("FAQPanel"),this.toplevel.style.position="absolute",this.toplevel.style.left="0",this.toplevel.style.top="0",this.toplevel.style.right="0",this.toplevel.style.bottom="0",this.toplevel.style.background="rgba(0, 0, 0, 0.8)",this.toplevel.onclick=()=>{this.elem.style.display="none"};const e=p("\n<style>\n.FAQPanel a:link, .FAQPanel a:visited { color: #ddd; }\n.FAQPanel a:hover { color: #fff; }\n</style>\n");this.toplevel.appendChild(e),this.panel=document.createElement("div"),this.panel.style.boxSizing="border-box",this.panel.style.width="50vw",this.panel.style.margin="5vh auto",this.panel.style.height="90vh",this.panel.style.backgroundColor="black",this.panel.style.padding="2em",this.panel.style.font="11pt monospace",this.panel.style.overflow="auto",this.panel.style.color="#ddd",this.panel.style.textAlign="justify",this.panel.onclick=e=>{e.stopPropagation()};const t=document.createElement("div");this.panel.appendChild(t);const a='\n## What is noclip.website?\n\n<p>noclip.website is a celebration of video game level design and art. It\'s a chance to\nexplore and deepen your appreciation for some of your favorite games.</p>\n\n## Why did you make this?\n\n<p>I\'ve always had an appreciation for the incredible worlds that game developers make.\nSometimes staring closely at levels might help you understand the challenges the designers\nwere facing, and what problems and techniques they used to solve them. You can learn a lot\nabout a game by looking in the places they <em>don\'t</em> show in the game itself. It\'s\nalso a ton of fun to test your memory, seeing if you can remember how a level is laid\nout, or where two rooms might connect to each other.</p>\n\n## It doesn\'t work!\n\n<p>Oops, sorry about that. Please let me know through either the <a href="https://discord.gg/bkJmKKv">official noclip.website Discord</a>\nor <a href="https://twitter.com/JasperRLZ/">Twitter</a>. Try to let me know what\nOS/browser/GPU you were using, and what game you tried to view, and I\'ll investigate.</p>\n\n## Can I request a game?\n\n<p>Maybe. Check around to see if anybody has looked at the game files before. If there\'s\nexisting community documentation, that helps a lot. And if you\'re around to help answer\nquestions or provide map names, I\'m even more inclined.</p>\n\n<p>Even having documentation, games can take months of my time to add. So I have to be\nvery careful with which games I choose to spend my time with.</p>\n\n<p>If you have some programming skills and want to try to add a game yourself, I fully\nwelcome that. Join the Discord and I will be happy to help you get set up with a\ndevelopment environment and walk you through the code.</p>\n\n## Why do some levels look broken?\n\n<p>In order to put a game on the website, I first need to take apart the game, extract\nthe data, and then figure out how to put it back together. Some of these games, especially\nthe newer ones, are really complex with their levels and their models, and that often means\nit takes more work to make it look correct. The line between "game engine" and "game data"\nis only getting blurrier and blurrier.</p>\n\n<p>My dream is that the site contains fully accurate versions of each game, and I try\nto get closer to that goal when I can, but the effort and time involved to make an accurate\nrecreation can sometimes be far too much, or would push me more into recreating large\nparts of the original game\'s engine, which I\'m less interested in doing myself.</p>\n\n## How do I export models from the site?\n\n<p>You can\'t. From the technical side, there is no one consistent file format that has\nall of the features that an accurate model would require. From a personal perspective,\nI\'m not ready to take on the support burden of writing an export tool.</p>\n\n<p>That said, if you would like to use my work as a base to build your own tools, the website\nis open-source and source code can be found at <a href="https://github.com/magcius/noclip.website">GitHub</a>.</p>\n\n<p>If you are looking for art for your own projects, there are some fantastic artists\nout there in the community that are always looking for work. Hire them instead of\nusing art assets from other games.</p>\n\n## This is cool! Any way I can help you out!\n\n<p>Absolutely. Join <a href="https://discord.gg/bkJmKKv">the official Discord</a> and ask around if you would like to help out.\nThe easiest things to help out with are providing savestates and naming maps, and can\nbe done even if you do not know how to code. There\'s also some work that would be\nappreciated to help me improve accuracy, like running games in certain modes to help\nme compare the two.</p>\n\n<p>If you have a more tech-y background, there\'s always coding work to be done. All\nthe source code to the site is available at <a href="https://github.com/magcius/noclip.website">GitHub</a>,\nwhether you want to browse around, use it for your own purposes, or help contribute.</p>\n\n## Why does Skyward Sword have a level called Despacito? Is that its official name?\n\n<p>Nah. The internal names of a lot of the Zelda games is often just a letter-number code,\nsomething like \'F203_05\'. Most of the maps have no real in-game name as far as I can\ntell, so I often spend a lot of time hunting down longplays on YouTube or playing the\ngame myself to try and come up with a name for it. I had done this for most of\nSkyward Sword, but got a bit stumped on some of the maps, and put "Despacito" as an\ninside joke.</p>\n\n<p>If you come up with a better name for these maps, feel free to tell me, either on\nthe <a href="https://discord.gg/bkJmKKv">official noclip.website Discord</a> or through\n<a href="https://twitter.com/JasperRLZ/">Twitter</a>.</p>\n\n## Are you afraid of being taken down?\n\n<p>Less than you might think. Companies take down fan projects when they\'re competing\nwith their in-house projects. I don\'t see noclip.website as competing with any game\nout there &mdash; it\'s more of a museum, not a game. The worlds on display are incredible\nand I hope they encourage you to go out and buy a copy of the game itself.</p>\n\n<p>That said, I have enormous respect for the developers and dev teams and if I received\na take-down request, I would honor it. It is their work on display, after all.</p>\n\n<p>Developers are only able to make these fantastic worlds if we collectively support\nthem. noclip would not exist without their hard work and dedication. To ensure that they\nremain healthy, please try to buy games instead of pirating them. I also put in extra effort\nto ensure that all assets available on this site cannot be used to pirate the game itself.</p>\n\n## Do you accept donations?\n\n<p>No. Use the money to buy some games instead.</p>\n\n## Any affiliation to noclip, the documentary people?\n\n<p>I chatted with them once, but the name is a coincidence. The name comes from an old Quake\ncommand that would let you fly through the levels here, just like in the game.</p>\n\n## Have you seen the YouTube show Boundary Break?\n\n<p>Of course! I love that show. I\'m ecstatic to see that exploring video game levels from\ndifferent angles has captured the imaginations of such a wide audience. And I hope that this\nsite encourages that same curiosity that\'s visible all throughout Boundary Break, trekking\nthrough these levels on your own adventures!</p>\n\n## Who made this site?\n\n<p>In my opinion? The artists and game developers. They made everything you actually see here\non display.</p>\n\n<p>But in terms of, you know, developing the site itself, that would be me, <a href="https://twitter.com/JasperRLZ/">Jasper</a>,\nbut I could not have done it alone. I\'ve been assisted by so many others throughout:\n<a href="https://twitter.com/beholdnec">N.E.C.</a>,\n<a href="https://twitter.com/JuPaHe64">JuPaHe64</a>,\n<a href="https://twitter.com/Jawchewa">Jawchewa</a>,\n<a href="https://twitter.com/Starschulz">Starschulz</a>,\n<a href="https://twitter.com/kittensandals">SpaceCats</a>,\n<a href="https://twitter.com/arukidev">Aruki</a>,\n<a href="https://twitter.com/TanukiMatthew">TanukiMatthew</a>,\n<a href="https://twitter.com/QuadeZaban">Quade Zaban</a>,\n<a href="https://twitter.com/Murugalstudio">Murugo</a>,\n<a href="https://twitter.com/ambienttiger">pat</a>,\n<a href="https://github.com/agentcatcat/">catcat</a>,\n<a href="https://twitter.com/PistonMiner">PistonMiner</a>,\n<a href="https://twitter.com/LordNed">LordNed</a>,\n<a href="https://twitter.com/SageOfMirrors">SageOfMirrors</a>,\n<a href="https://github.com/blank63">blank63</a>,\n<a href="https://twitter.com/StapleButter">StapleButter</a>,\n<a href="https://twitter.com/xdanieldzd">xdanieldzd</a>,\n<a href="https://github.com/vlad001">vlad001</a>,\n<a href="https://twitter.com/Jewelots_">Jewel</a>,\n<a href="https://twitter.com/instant_grat">Instant Grat</a>,\nalong with countless others from the modding communities, game reverse\nengineering and research communities, and emulation communities.</p>\n\n<p>All icons you see are from <a href="https://thenounproject.com/">The Noun Project</a>,\nused under Creative Commons CC-BY:</p>\n<ul>\n<li> Truncated Pyramid <span>by</span> Bohdan Burmich\n<li> Images <span>by</span> Creative Stall\n<li> Help <span>by</span> Gregor Cresnar\n<li> Open <span>by</span> Landan Lloyd\n<li> Nightshift <span>by</span> mikicon\n<li> Layer <span>by</span> Chameleon Design\n<li> Sand Clock <span>by</span> James\n<li> Line Chart <span>by</span> Shastry\n<li> Search <span>by</span> Alain W.\n<li> Save <span>by</span> Prime Icons\n<li> Overlap <span>by</span> Zach Bogart\n<li> VR <span>by</span> Fauzan Adaiima\n</ul>\n'.split("##").slice(1).map(e=>{const t=e.indexOf("\n");return{question:e.slice(0,t).trim(),answer:e.slice(t).trim()}});for(let e=0;e<a.length;e++){const r=document.createElement("div"),n=a[e].question,s=document.createElement("p");s.style.color="#ccc",s.style.fontWeight="bold",s.style.marginTop="0",s.style.fontSize="12pt",s.textContent=n,r.appendChild(s);const i=document.createElement("p");i.style.marginBottom="1.6em",i.innerHTML=a[e].answer,r.appendChild(i),t.appendChild(r)}this.toplevel.appendChild(this.panel),this.elem=this.toplevel}}t.LayerPanel=class extends C{constructor(e=null){super(),this.layers=[],this.onlayertoggled=null,this.customHeaderBackgroundColor=t.COOL_BLUE_COLOR,this.setTitle(t.LAYER_ICON,"Layers"),this.multiSelect=new T,this.multiSelect.onitemchanged=this._onItemChanged.bind(this),this.contents.appendChild(this.multiSelect.elem),null!==e&&this.setLayers(e)}_onItemChanged(e,t){this.layers[e].setVisible(t),null!==this.onlayertoggled&&this.onlayertoggled()}syncLayerVisibility(){const e=this.layers.map(e=>e.visible);this.multiSelect.setItemsSelected(e)}setLayers(e){this.layers=e;const t=e.map(e=>e.name);this.multiSelect.setStrings(t),this.syncLayerVisibility(),this.setVisible(e.length>1)}};class N{constructor(){this.currentAnimation=null,this.elem=document.createElement("div"),this.elem.style.opacity="0",this.elem.style.textShadow="0 0 8px black",this.elem.style.padding="0 8px",this.elem.style.font="bold 16px monospace",this.elem.style.color="white",this.elem.style.pointerEvents="none",this.elem.style.lineHeight="32px"}setArea(){}isAnyPanelExpanded(){return!1}setCameraSpeed(e,a=!0){const r=Math.max(e,1);this.elem.textContent=`Camera Speed: ${r.toFixed(0)}`;const n=`${r/200*100}%`;this.elem.style.backgroundImage=`linear-gradient(to right, ${t.HIGHLIGHT_COLOR} ${n}, rgba(0, 0, 0, 0.75) ${n})`,a&&(null!==this.currentAnimation&&this.currentAnimation.cancel(),this.currentAnimation=this.elem.animate([{opacity:1,offset:0},{opacity:1,offset:.5},{opacity:0,offset:1}],2e3))}}function L(e,t){0===t?(e.style.transform="",e.style.marginLeft="",e.style.right=""):1===t?(e.style.transform="translate(-50%, 0)",e.style.marginLeft="16px",e.style.right=""):2===t&&(e.style.transform="",e.style.marginLeft="",e.style.right="0")}class G{constructor(){this.widgets=[],this.elem=document.createElement("div"),this.elem.id="BottomBar",this.elem.style.position="absolute",this.elem.style.bottom="32px",this.elem.style.left="32px",this.elem.style.right="32px",this.elem.style.display="grid",this.elem.style.gridTemplateColumns="1fr 1fr 1fr",this.elem.style.gridGap="8px",this.elem.style.transition=".1s ease-out",this.elem.style.pointerEvents="none";const e=this.newArea();e.style.justifySelf="start",this.elem.appendChild(e);const t=this.newArea();t.style.justifySelf="center",this.elem.appendChild(t);const a=this.newArea();a.style.justifySelf="end",this.elem.appendChild(a)}newArea(){const e=document.createElement("div");return e.style.display="grid",e.style.gridAutoFlow="column",e.style.gridGap="8px",e}addWidgets(e,t){t.setArea(e),this.widgets.push(t),this.elem.children.item(e).appendChild(t.elem)}isAnyPanelExpanded(){for(let e=0;e<this.widgets.length;e++)if(this.widgets[e].isAnyPanelExpanded())return!0;return!1}setVisible(e){this.elem.style.opacity=e?"1":"0"}}class H{constructor(){this.isOpen=!1,this.isHover=!1,this.elem=document.createElement("div"),this.elem.style.position="relative",this.elem.style.transition=".1s ease-out",this.elem.style.width="32px",this.elem.style.height="32px",this.elem.style.pointerEvents="auto",this.elem.onclick=this.onClick.bind(this),this.elem.onmouseover=()=>{this.isHover=!0,this.syncStyle()},this.elem.onmouseout=()=>{this.isHover=!1,this.syncStyle()},this.icon=document.createElement("div"),this.icon.style.width="32px",this.icon.style.height="32px",this.icon.style.cursor="pointer",this.icon.style.font="16px monospace",this.icon.style.color="white",this.icon.style.lineHeight="32px",this.icon.style.textAlign="center",this.icon.style.textShadow="0px 0px 6px rgba(0, 0, 0, 0.5)",this.icon.style.transition="0.1s ease-out",this.icon.style.userSelect="none",this.elem.appendChild(this.icon),this.tooltipElem=document.createElement("div"),this.tooltipElem.style.position="absolute",this.tooltipElem.style.top="0",this.tooltipElem.style.marginTop="-32px",this.tooltipElem.style.padding="0 8px",this.tooltipElem.style.background="rgba(0, 0, 0, 0.75)",this.tooltipElem.style.font="bold 16px monospace",this.tooltipElem.style.lineHeight="32px",this.tooltipElem.style.color="white",this.tooltipElem.style.textShadow="0 0 8px black",this.tooltipElem.style.transition="0.1s ease-out",this.tooltipElem.style.pointerEvents="none",this.tooltipElem.style.userSelect="none",this.tooltipElem.style.opacity="0",this.elem.appendChild(this.tooltipElem)}setShow(e){this.elem.style.display=e?"block":"none"}setArea(e){L(this.tooltipElem,e)}isAnyPanelExpanded(){return this.isOpen}setIsOpen(e){this.isOpen=e,this.syncStyle()}syncStyle(){this.isOpen?(this.icon.style.background="rgba(0, 0, 0, 0.75)",this.icon.style.color=t.HIGHLIGHT_COLOR,this.tooltipElem.style.opacity="0"):this.isHover?(this.icon.style.background="rgba(0, 0, 0, 0.75)",this.icon.style.color="white",this.tooltipElem.style.opacity="1"):(this.icon.style.background="rgba(0, 0, 0, 0.0)",this.icon.style.color="white",this.tooltipElem.style.opacity="0")}}class j extends H{constructor(){super(),this.panel=document.createElement("div"),this.panel.style.position="absolute",this.panel.style.top="0",this.panel.style.marginTop="-32px",this.panel.style.lineHeight="32px",this.panel.style.background="rgba(0, 0, 0, 0.75)",this.panel.style.transition="0.1s ease-out",this.elem.appendChild(this.panel),this.syncStyle()}setArea(e){super.setArea(e),L(this.panel,e)}onClick(e){this.isOpen||(this.setIsOpen(!0),d.GlobalGrabManager.takeGrab(this,e,{takePointerLock:!1,useGrabbingCursor:!1,releaseOnMouseUp:!1,grabElement:this.panel}))}onMotion(){}onGrabReleased(){this.setIsOpen(!1)}syncStyle(){super.syncStyle(),this.isOpen?(this.panel.style.opacity="1",this.panel.style.pointerEvents=""):(this.panel.style.opacity="0",this.panel.style.pointerEvents="none")}}class W extends j{constructor(){super(),this.tooltipElem.textContent="Share",f(this.icon,""),this.panel.style.display="grid",this.panel.style.width="400px",this.panel.style.gridAutoFlow="column",this.currentShareURLEntry=new S,this.currentShareURLEntry.textarea.readOnly=!0,this.currentShareURLEntry.textarea.onfocus=()=>{this.currentShareURLEntry.selectAll()},this.currentShareURLEntry.elem.style.width="auto",this.currentShareURLEntry.elem.style.lineHeight="32px",this.currentShareURLEntry.elem.style.padding="0 16px",this.panel.appendChild(this.currentShareURLEntry.elem),this.copyButton=document.createElement("div"),this.copyButton.style.font="16px monospace",this.copyButton.style.textShadow="0px 0px 6px rgba(0, 0, 0, 0.5)",this.copyButton.style.color="white",this.copyButton.style.lineHeight="32px",this.copyButton.style.textAlign="center",this.copyButton.style.userSelect="none",this.copyButton.onclick=()=>{"copy"===this.copyButtonState&&(window.navigator.clipboard.writeText(this.currentShareURLEntry.getValue()),this.currentShareURLEntry.selectAll(),this.setCopyButtonState("copied"))},this.setCopyButtonState("copy"),this.panel.appendChild(this.copyButton)}setCopyButtonState(e){this.copyButtonState!==e&&(this.copyButtonState=e,"copy"===e?(this.copyButton.style.backgroundColor=t.HIGHLIGHT_COLOR,this.copyButton.style.cursor="pointer",this.copyButton.textContent="COPY"):(this.copyButton.style.backgroundColor="#666",this.copyButton.style.cursor="",this.copyButton.textContent="COPIED"))}setShareURL(e){this.setCopyButtonState("copy"),this.currentShareURLEntry.setValue(e)}}class Z extends H{constructor(){super(),void 0===document.body.requestFullscreen&&this.setShow(!1),document.addEventListener("fullscreenchange",this.syncStyle.bind(this)),this.syncStyle()}isFS(){return document.fullscreenElement===document.body}syncStyle(){super.syncStyle(),f(this.icon,this.isFS()?"":""),this.tooltipElem.textContent=this.isFS()?"Unfullscreen":"Fullscreen"}onClick(){this.isFS()?document.exitFullscreen():document.body.requestFullscreen()}}class z extends H{constructor(){super(...arguments),this.onplaypause=null}syncStyle(){super.syncStyle(),f(this.icon,this.isPlaying?"":""),this.tooltipElem.textContent=this.isPlaying?"Pause":"Play"}setIsPlaying(e){this.isPlaying=e,this.syncStyle()}onClick(){null!==this.onplaypause&&this.onplaypause(!this.isPlaying)}}class K{constructor(){this.elem=document.createElement("div"),this.elem.style.position="absolute",this.elem.style.right="0",this.elem.style.bottom="0",this.elem.style.backgroundColor="rgba(0, 0, 0, 0.3)",this.elem.style.borderTopLeftRadius="8px",this.elem.style.font="32px Norwester",this.elem.style.color="white",this.elem.style.padding="4px 8px 4px 12px",this.elem.style.pointerEvents="none",this.elem.style.textShadow="0px 0px 10px rgba(0, 0, 0, 0.8)",this.elem.style.visibility="hidden",this.elem.style.userSelect="none",this.elem.textContent="noclip.website"}v(){this.elem.style.visibility="",window.main.ui.toggleUI(!1)}}function X(e,t){const a=Reflect.getMetadata("df:visibility",e,t);return!1!==a&&(!0===a||(!!Reflect.hasMetadata("df:range",e,t)||!!Reflect.hasMetadata("df:sigfigs",e,t)))}t.UI=class{constructor(e){this.viewer=e,this.floatingPanels=[],this.recordingBranding=new K,this.cameraSpeedIndicator=new N,this.bottomBar=new G,this.playPauseButton=new z,this.shareButton=new W,this.fullscreenButton=new Z,this.isDragging=!1,this.lastMouseActiveTime=-1,this.isPlaying=!0,this.debugFloater=null,this.toplevel=document.createElement("div"),this.sceneUIContainer=document.createElement("div"),this.sceneUIContainer.style.pointerEvents="none",this.toplevel.appendChild(this.sceneUIContainer),this.panelToplevel=document.createElement("div"),this.panelToplevel.id="Panel",this.panelToplevel.style.position="absolute",this.panelToplevel.style.left="0",this.panelToplevel.style.top="0",this.panelToplevel.style.bottom="0",this.panelToplevel.style.padding="2em",this.panelToplevel.style.transition=".2s background-color",this.panelToplevel.onmouseover=()=>{this.panelToplevel.style.backgroundColor="rgba(0, 0, 0, 0.2)",this.panelToplevel.style.overflow="auto",this.setPanelsAutoClosed(!1)},this.panelToplevel.onmouseout=()=>{this.panelToplevel.style.backgroundColor="rgba(0, 0, 0, 0)",this.panelToplevel.style.overflow="hidden"},this.panelContainer=document.createElement("div"),this.panelContainer.style.display="grid",this.panelContainer.style.gridTemplateColumns="1fr",this.panelContainer.style.gridGap="20px",this.panelToplevel.appendChild(this.panelContainer),this.toplevel.appendChild(this.panelToplevel),this.dragHighlight=document.createElement("div"),this.toplevel.appendChild(this.dragHighlight),this.dragHighlight.style.position="absolute",this.dragHighlight.style.left="0",this.dragHighlight.style.right="0",this.dragHighlight.style.top="0",this.dragHighlight.style.bottom="0",this.dragHighlight.style.backgroundColor="rgba(255, 255, 255, 0.5)",this.dragHighlight.style.boxShadow="0 0 40px 5px white inset",this.dragHighlight.style.display="none",this.dragHighlight.style.pointerEvents="none",this.floatingPanelContainer=document.createElement("div"),this.toplevel.appendChild(this.floatingPanelContainer),this.toplevel.appendChild(this.recordingBranding.elem),this.toplevel.appendChild(this.bottomBar.elem),this.bottomBar.addWidgets(0,this.cameraSpeedIndicator),this.bottomBar.addWidgets(1,this.playPauseButton),this.bottomBar.addWidgets(2,this.shareButton),this.bottomBar.addWidgets(2,this.fullscreenButton),this.sceneSelect=new k(e),this.textureViewer=new I,this.viewerSettings=new B(this,e),this.xrSettings=new P(this,e),this.statisticsPanel=new F(e),this.about=new V,this.faqPanel=new O,this.faqPanel.elem.style.display="none",this.toplevel.appendChild(this.faqPanel.elem),this.playPauseButton.onplaypause=e=>{this.togglePlayPause(e)},this.playPauseButton.setIsPlaying(this.isPlaying),this.about.onfaq=()=>{this.faqPanel.elem.style.display="block"},window.onmousemove=()=>{this.setMouseActive()},this.setMouseActive(),this.setScenePanels(null),this.elem=this.toplevel}togglePlayPause(e=!this.isPlaying){this.isPlaying=e,this.playPauseButton.setIsPlaying(this.isPlaying)}toggleWebXRCheckbox(e=!this.xrSettings.enableXRCheckBox.checked){this.xrSettings.enableXRCheckBox.setChecked(e)}setMouseActive(){this.lastMouseActiveTime=window.performance.now()}update(){this.syncBottomRightBarVisibility()}setSaveState(e){const t=function(e){const t=window.location;return`${t.origin}${t.pathname}#${a=e,a.replace(/[{}()^]/g,e=>`%${e.charCodeAt(0).toString(16)}`)}`;var a}(e);this.shareButton.setShareURL(t)}sceneChanged(){const e=this.viewer.cameraController.constructor;this.viewerSettings.cameraControllerSelected(e);const t=this.viewer.cameraController.getKeyMoveSpeed();if(null!==t&&this.viewerSettings.setInitialKeyMoveSpeed(t),null!==this.viewer.scene){const e=this.viewer.scene;void 0!==e.textureHolder?this.textureViewer.setTextureHolder(e.textureHolder):this.textureViewer.setTextureList([])}}setPanels(e){this.panels=e,A(this.panelContainer,e.map(e=>e.elem))}destroyScene(){this.setScenePanels([]),A(this.sceneUIContainer,[]);for(let e=0;e<this.floatingPanels.length;e++)this.floatingPanels[e].destroy();this.floatingPanels=[]}setScenePanels(e){null!==e?this.setPanels([this.sceneSelect,...e,this.textureViewer,this.viewerSettings,this.xrSettings,this.statisticsPanel,this.about]):this.setPanels([this.sceneSelect,this.about])}setPanelsAutoClosed(e){for(let t=0;t<this.panels.length;t++)this.panels[t].setAutoClosed(e)}shouldPanelsAutoClose(){return!this.statisticsPanel.manuallyExpanded}shouldBottomRightBarBeVisible(){if(this.bottomBar.isAnyPanelExpanded())return!0;if(this.isDragging)return!0;return!(window.performance.now()>this.lastMouseActiveTime+1e3)}syncBottomRightBarVisibility(){this.bottomBar.setVisible(this.shouldBottomRightBarBeVisible())}setIsDragging(e){this.isDragging=e,this.elem.style.pointerEvents=e?"none":"",e&&this.shouldPanelsAutoClose()&&this.setPanelsAutoClosed(!0),this.syncBottomRightBarVisibility()}makeFloatingPanel(e="Floating Panel",a=t.RENDER_HACKS_ICON){const r=new M;return r.setWidth(600),r.setTitle(a,e),this.floatingPanelContainer.appendChild(r.elem),this.floatingPanels.push(r),r}getDebugFloater(){return null===this.debugFloater&&(this.debugFloater=this.makeFloatingPanel("Debug")),this.debugFloater}bindSlider(e,t,a,r,n){let s=e[a];i.assert("number"==typeof s);let o=0,l=1,c=.01,h=Reflect.getMetadata("df:range",e,a);void 0===h&&null!==n&&(h=n.range),void 0!==h&&(o=h.min,l=h.max,c=h.step);const d=Math.max(0,-Math.log10(c)),u=new R;function m(){s=e[a],u.setLabel(`${r} = ${s.toFixed(d)}`);const t=Math.min(s,o),n=Math.max(s,l);void 0===h&&(o=t,l=n),u.setRange(t,n,c),u.setValue(s)}u.onvalue=t=>{e[a]=t,m()},m(),setInterval(()=>{e[a]!==s&&m()},100),t.contents.appendChild(u.elem)}bindSlidersRecurse(e,t,a,r=null){const n=l.objIsColor(e)||e instanceof Array||e instanceof Float32Array,s=Object.keys(e);for(let i=0;i<s.length;i++){const o=s[i];if(!n&&!X(e,o))continue;const l=e[o];"number"==typeof l&&this.bindSlider(e,t,o,`${a}.${o}`,r),this.bindSlidersRecurse(l,t,`${a}.${o}`,{range:Reflect.getMetadata("df:range",e,o)})}}bindSliders(e,t=null){for(null===t&&(t=this.getDebugFloater());t.contents.firstChild;)t.contents.removeChild(t.contents.firstChild);this.bindSlidersRecurse(e,t,"")}toggleUI(e){void 0===e&&(e="none"===this.panelToplevel.style.display),this.panelToplevel.style.display=e?"":"none",this.bottomBar.elem.style.display=e?"grid":"none"}},t.dfShow=function(){return Reflect.metadata("df:visibility",!0)},t.dfHide=function(){return Reflect.metadata("df:visibility",!1)},t.dfRange=function(e=0,t=1,a=(t-e)/100){return Reflect.metadata("df:range",{min:e,max:t,step:a})},t.dfSigFigs=function(e=2){return Reflect.metadata("df:sigfigs",e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(0);class s{distance(e,t,a){const r=e*this.x+t*this.y+a*this.z;return this.d+r}getNormal(e){r.vec3.set(e,this.x,this.y,this.z)}set(e,t,a){const n=s.scratchVec3;r.vec3.sub(n[0],t,e),r.vec3.sub(n[1],a,e),r.vec3.cross(n[0],n[0],n[1]),r.vec3.normalize(n[0],n[0]),this.x=n[0][0],this.y=n[0][1],this.z=n[0][2],this.d=-r.vec3.dot(n[0],e)}}t.Plane=s,s.scratchVec3=n.nArray(2,()=>r.vec3.create());const i=r.vec3.create(),o=r.vec3.create(),l=r.vec3.create(),c=r.vec3.create();class h{constructor(e=0,t=0,a=0,r=0,n=0,s=0){this.minX=e,this.minY=t,this.minZ=a,this.maxX=r,this.maxY=n,this.maxZ=s}transform(e,t){const a=i,n=o;r.vec3.set(a,e.minX,e.minY,e.minZ),r.vec3.set(n,e.maxX,e.maxY,e.maxZ);const s=l,h=c;r.vec3.set(s,t[12],t[13],t[14]),r.vec3.set(h,t[12],t[13],t[14]);for(let e=0;e<3;e++)for(let r=0;r<3;r++){const i=t[4*r+e]*a[r],o=t[4*r+e]*n[r];i<o?(s[e]+=i,h[e]+=o):(s[e]+=o,h[e]+=i)}this.minX=s[0],this.minY=s[1],this.minZ=s[2],this.maxX=h[0],this.maxY=h[1],this.maxZ=h[2]}set(e,t,a,r,n,s){this.minX=e,this.minY=t,this.minX=a,this.maxX=r,this.maxY=n,this.maxX=s}setInf(){this.set(1/0,1/0,1/0,-1/0,-1/0,-1/0)}setFromPoints(e){this.minX=this.minY=this.minZ=1/0,this.maxX=this.maxY=this.maxZ=-1/0;for(let t=0;t<e.length;t++){const a=e[t];this.minX=Math.min(this.minX,a[0]),this.minY=Math.min(this.minY,a[1]),this.minZ=Math.min(this.minZ,a[2]),this.maxX=Math.max(this.maxX,a[0]),this.maxY=Math.max(this.maxY,a[1]),this.maxZ=Math.max(this.maxZ,a[2])}}union(e,t){this.minX=Math.min(e.minX,t.minX),this.minY=Math.min(e.minY,t.minY),this.minZ=Math.min(e.minZ,t.minZ),this.maxX=Math.max(e.maxX,t.maxX),this.maxY=Math.max(e.maxY,t.maxY),this.maxZ=Math.max(e.maxZ,t.maxZ)}unionPoint(e){this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.minZ=Math.min(this.minZ,e[2]),this.maxX=Math.max(this.maxX,e[0]),this.maxY=Math.max(this.maxY,e[1]),this.maxZ=Math.max(this.maxZ,e[2])}static intersect(e,t){return!(e.minX>t.maxX||t.minX>e.maxX||e.minY>t.maxY||t.minY>e.maxY||e.minZ>t.maxZ||t.minZ>e.maxZ)}containsPoint(e){const t=e[0],a=e[1],r=e[2];return!(t<this.minX||t>this.maxX||a<this.minY||a>this.maxY||r<this.minZ||r>this.maxZ)}containsSphere(e,t){const a=e[0],r=e[1],n=e[2];return!(a<this.minX-t||a>this.maxX+t||r<this.minY-t||r>this.maxY+t||n<this.minZ-t||n>this.maxZ+t)}centerPoint(e){e[0]=(this.minX+this.maxX)/2,e[1]=(this.minY+this.maxY)/2,e[2]=(this.minZ+this.maxZ)/2}extents(e){e[0]=(this.maxX-this.minX)/2,e[1]=(this.maxY-this.minY)/2,e[2]=(this.maxZ-this.minZ)/2}boundingSphereRadius(){const e=this.maxX-this.minX,t=this.maxY-this.minY,a=this.maxZ-this.minZ;return Math.hypot(e,t,a)/2}isEmpty(){return this.extents(i),0===i[0]&&0===i[1]&&0===i[2]}}t.AABB=h;class d{constructor(){this.scale=1e-5,this.canvas=document.createElement("canvas"),this.canvas.width=1080,this.canvas.height=768,document.body.appendChild(this.canvas),this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.opacity="0.5",this.canvas.style.pointerEvents="none",this.ctx=this.canvas.getContext("2d")}newFrame(){this.ctx.fillStyle="white",this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore()}dsx(e){return(e*this.scale+.5)*this.canvas.width}dsy(e){return(e*this.scale+.5)*this.canvas.height}daabb(e){const t=this.dsx(e.minX),a=this.dsy(e.minZ),r=this.dsx(e.maxX),n=this.dsy(e.maxZ);this.ctx.strokeRect(t,a,r-t,n-a)}dsph(e,t){const a=this.dsx(e[0]),r=this.dsy(e[2]);this.ctx.beginPath(),this.ctx.ellipse(a,r,t*this.scale*this.canvas.width,t*this.scale*this.canvas.height,0,0,2*Math.PI),this.ctx.closePath(),this.ctx.stroke()}}var u;!function(e){e[e.FULLY_INSIDE=0]="FULLY_INSIDE",e[e.FULLY_OUTSIDE=1]="FULLY_OUTSIDE",e[e.PARTIAL_INTERSECT=2]="PARTIAL_INTERSECT"}(u=t.IntersectionState||(t.IntersectionState={}));class m{constructor(){this.aabb=new h,this.planes=n.nArray(6,()=>new s),this.visualizer=null}makeVisualizer(){return null===this.visualizer&&(this.visualizer=new d),this.visualizer}setViewFrustum(e,t,a,r,n,s,i){this.left=e,this.right=t,this.bottom=a,this.top=r,this.near=-n,this.far=-s,this.isOrthographic=i}updateWorldFrustum(e){const t=m.scratchPlaneVec3,a=this.isOrthographic?1:this.far/this.near;r.vec3.set(t[0],this.left,this.top,this.near),r.vec3.set(t[1],this.right,this.top,this.near),r.vec3.set(t[2],this.right,this.bottom,this.near),r.vec3.set(t[3],this.left,this.bottom,this.near),r.vec3.set(t[4],a*this.left,a*this.top,this.far),r.vec3.set(t[5],a*this.right,a*this.top,this.far),r.vec3.set(t[6],a*this.right,a*this.bottom,this.far),r.vec3.set(t[7],a*this.left,a*this.bottom,this.far),r.vec3.set(t[8],0,0,0);for(let a=0;a<9;a++)r.vec3.transformMat4(t[a],t[a],e);if(this.aabb.setFromPoints(t),this.planes[0].set(t[8],t[0],t[3]),this.planes[1].set(t[8],t[2],t[1]),this.planes[2].set(t[0],t[2],t[1]),this.planes[3].set(t[4],t[6],t[7]),this.planes[4].set(t[8],t[1],t[0]),this.planes[5].set(t[8],t[3],t[2]),this.visualizer){const n=this.visualizer.ctx;n.strokeStyle="red",this.visualizer.daabb(this.aabb),r.vec3.set(t[0],this.left,0,this.near),r.vec3.set(t[1],this.right,0,this.near),r.vec3.set(t[2],a*this.right,0,this.far),r.vec3.set(t[3],a*this.left,0,this.far),n.strokeStyle="green",n.beginPath();for(let a=0;a<4;a++){const s=t[a];r.vec3.transformMat4(s,s,e);const i=this.visualizer.dsx(s[0]),o=this.visualizer.dsy(s[2]);n.lineTo(i,o)}n.closePath(),n.stroke()}}_intersect(e){if(!h.intersect(this.aabb,e))return u.FULLY_OUTSIDE;let t=u.FULLY_INSIDE;for(let a=0;a<6;a++){const r=this.planes[a],n=r.x>=0?e.minX:e.maxX,s=r.y>=0?e.minY:e.maxY,i=r.z>=0?e.minZ:e.maxZ;if(r.distance(n,s,i)>0)return u.FULLY_OUTSIDE;const o=r.x>=0?e.maxX:e.minX,l=r.y>=0?e.maxY:e.minY,c=r.z>=0?e.maxZ:e.minZ;r.distance(o,l,c)>0&&(t=u.PARTIAL_INTERSECT)}return t}intersect(e){const t=this._intersect(e);if(this.visualizer){this.visualizer.ctx.strokeStyle=t===u.FULLY_INSIDE?"black":t===u.FULLY_OUTSIDE?"red":"cyan",this.visualizer.daabb(e)}return t}contains(e){return this.intersect(e)!==u.FULLY_OUTSIDE}_intersectSphere(e,t){if(!this.aabb.containsSphere(e,t))return u.FULLY_OUTSIDE;let a=u.FULLY_INSIDE;for(let r=0;r<6;r++){const n=this.planes[r].distance(e[0],e[1],e[2]);if(n>t)return u.FULLY_OUTSIDE;n>-t&&(a=u.PARTIAL_INTERSECT)}return a}intersectSphere(e,t){const a=this._intersectSphere(e,t);if(this.visualizer){this.visualizer.ctx.strokeStyle=a===u.FULLY_INSIDE?"black":a===u.FULLY_OUTSIDE?"red":"cyan",this.visualizer.dsph(e,t)}return a}containsSphere(e,t){return this.intersectSphere(e,t)!==u.FULLY_OUTSIDE}containsPoint(e){if(!this.aabb.containsPoint(e))return!1;for(let t=0;t<6;t++)if(this.planes[t].distance(e[0],e[1],e[2])>0)return!1;return!0}newFrame(){this.visualizer&&this.visualizer.newFrame()}}t.Frustum=m,m.scratchPlaneVec3=n.nArray(9,()=>r.vec3.create()),t.squaredDistanceFromPointToAABB=function(e,t){function a(e){return e*e}const r=e[0],n=e[1],s=e[2];let i=0;return r<t.minX?i+=a(t.minX-r):r>t.maxX&&(i+=a(r-t.maxX)),n<t.minY?i+=a(t.minY-n):n>t.maxY&&(i+=a(n-t.maxY)),s<t.minZ?i+=a(t.minZ-s):s>t.maxZ&&(i+=a(s-t.maxZ)),i}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillVec3v=function(e,t,a,r=0){return e[t+0]=a[0],e[t+1]=a[1],e[t+2]=a[2],e[t+3]=r,4},t.fillVec4=function(e,t,a,r=0,n=0,s=0){return e[t+0]=a,e[t+1]=r,e[t+2]=n,e[t+3]=s,4},t.fillVec4v=function(e,t,a){return e[t+0]=a[0],e[t+1]=a[1],e[t+2]=a[2],e[t+3]=a[3],4},t.fillColor=function(e,t,a){return e[t+0]=a.r,e[t+1]=a.g,e[t+2]=a.b,e[t+3]=a.a,4},t.fillMatrix4x4=function(e,t,a){return e[t+0]=a[0],e[t+1]=a[4],e[t+2]=a[8],e[t+3]=a[12],e[t+4]=a[1],e[t+5]=a[5],e[t+6]=a[9],e[t+7]=a[13],e[t+8]=a[2],e[t+9]=a[6],e[t+10]=a[10],e[t+11]=a[14],e[t+12]=a[3],e[t+13]=a[7],e[t+14]=a[11],e[t+15]=a[15],16},t.fillMatrix4x3=function(e,t,a){return e[t+0]=a[0],e[t+1]=a[4],e[t+2]=a[8],e[t+3]=a[12],e[t+4]=a[1],e[t+5]=a[5],e[t+6]=a[9],e[t+7]=a[13],e[t+8]=a[2],e[t+9]=a[6],e[t+10]=a[10],e[t+11]=a[14],12},t.fillMatrix3x2=function(e,t,a){const r=a[0],n=a[1],s=a[2],i=a[3],o=a[4],l=a[5];return e[t+0]=r,e[t+1]=s,e[t+2]=o,e[t+3]=0,e[t+4]=n,e[t+5]=i,e[t+6]=l,e[t+7]=0,8},t.fillMatrix4x2=function(e,t,a){return e[t+0]=a[0],e[t+1]=a[4],e[t+2]=a[8],e[t+3]=a[12],e[t+4]=a[1],e[t+5]=a[5],e[t+6]=a[9],e[t+7]=a[13],8}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(4),s=a(22),i=a(0);function o(e,t){e.blendDstFactor=t.blendDstFactor,e.blendSrcFactor=t.blendSrcFactor,e.blendMode=t.blendMode}function l(e,t){return void 0===e&&(e={rgbBlendState:{},alphaBlendState:{},colorWriteMask:0}),o(e.rgbBlendState,t.rgbBlendState),o(e.alphaBlendState,t.alphaBlendState),e.colorWriteMask=t.colorWriteMask,e}function c(e,t){e.length!==t.length&&(e.length=t.length);for(let a=0;a<t.length;a++)e[a]=l(e[a],t[a])}function h(e,t){void 0!==t.attachmentsState&&c(e.attachmentsState,t.attachmentsState),void 0!==t.blendConstant&&n.colorCopy(e.blendConstant,t.blendConstant),e.depthCompare=i.fallbackUndefined(t.depthCompare,e.depthCompare),e.depthWrite=i.fallbackUndefined(t.depthWrite,e.depthWrite),e.stencilCompare=i.fallbackUndefined(t.stencilCompare,e.stencilCompare),e.stencilWrite=i.fallbackUndefined(t.stencilWrite,e.stencilWrite),e.stencilPassOp=i.fallbackUndefined(t.stencilPassOp,e.stencilPassOp),e.cullMode=i.fallbackUndefined(t.cullMode,e.cullMode),e.frontFace=i.fallbackUndefined(t.frontFace,e.frontFace),e.polygonOffset=i.fallbackUndefined(t.polygonOffset,e.polygonOffset)}function d(e){const t=Object.assign({},e);return t.attachmentsState=[],c(t.attachmentsState,e.attachmentsState),t.blendConstant=n.colorNewCopy(t.blendConstant),t}function u(e=null,a=t.defaultMegaState){const r=d(a);return null!==e&&h(r,e),r}function m(e,t){void 0!==t.colorWriteMask&&(e.colorWriteMask=t.colorWriteMask),void 0!==t.blendMode&&(e.rgbBlendState.blendMode=t.blendMode,e.alphaBlendState.blendMode=t.blendMode),void 0!==t.blendSrcFactor&&(e.rgbBlendState.blendSrcFactor=t.blendSrcFactor,e.alphaBlendState.blendSrcFactor=t.blendSrcFactor),void 0!==t.blendDstFactor&&(e.rgbBlendState.blendDstFactor=t.blendDstFactor,e.alphaBlendState.blendDstFactor=t.blendDstFactor)}t.setMegaStateFlags=h,t.copyMegaState=d,t.makeMegaState=u,t.copyAttachmentStateFromSimple=m,t.setAttachmentStateSimple=function(e,a){return void 0===e.attachmentsState&&(e.attachmentsState=[],c(e.attachmentsState,t.defaultMegaState.attachmentsState)),m(e.attachmentsState[0],a),e};const p={blendMode:r.GfxBlendMode.ADD,blendSrcFactor:r.GfxBlendFactor.ONE,blendDstFactor:r.GfxBlendFactor.ZERO};t.defaultMegaState={attachmentsState:[{colorWriteMask:15,rgbBlendState:p,alphaBlendState:p}],blendConstant:n.colorNewCopy(n.TransparentBlack),depthWrite:!0,depthCompare:s.reverseDepthForCompareMode(r.GfxCompareMode.LEQUAL),stencilCompare:r.GfxCompareMode.NEVER,stencilWrite:!1,stencilPassOp:r.GfxStencilOp.KEEP,cullMode:0,frontFace:r.GfxFrontFaceMode.CCW,polygonOffset:!1},t.fullscreenMegaState=u({depthCompare:r.GfxCompareMode.ALWAYS,depthWrite:!1},t.defaultMegaState)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(56);t.ArrayBuffer_slice=ArrayBuffer.prototype.slice,ArrayBuffer.prototype.slice=(e,t)=>{throw new Error("Do not use ArrayBuffer.prototype.slice")};class s{constructor(e,t=0,a=e.byteLength){this.arrayBuffer=e,this.byteOffset=t,this.byteLength=a,r.assert(t>=0&&a>=0&&t+a<=this.arrayBuffer.byteLength)}slice(e,t=0){const a=this.byteOffset+e,n=this.byteOffset+(0!==t?t:this.byteLength),i=n-a;return r.assert(i>=0&&i<=this.byteLength),new s(this.arrayBuffer,a,n-a)}subarray(e,t){const a=this.byteOffset+e;return void 0===t&&(t=this.byteLength-e),r.assert(t>=0&&t<=this.byteLength),new s(this.arrayBuffer,a,t)}copyToBuffer(e=0,a=0){const r=this.byteOffset+e,n=0!==a?r+a:this.byteOffset+this.byteLength;return t.ArrayBuffer_slice.call(this.arrayBuffer,r,n)}createDataView(e=0,t){return 0===e&&void 0===t?new DataView(this.arrayBuffer,this.byteOffset,this.byteLength):this.subarray(e,t).createDataView()}bswap16(){r.assert(this.byteLength%2==0);const e=this.createTypedArray(Uint8Array),t=new Uint8Array(this.byteLength);for(let a=0;a<e.byteLength;a+=2)t[a+0]=e[a+1],t[a+1]=e[a+0];return new s(t.buffer)}bswap32(){r.assert(this.byteLength%4==0);const e=this.createTypedArray(Uint8Array),t=new Uint8Array(e.byteLength);for(let a=0;a<e.byteLength;a+=4)t[a+0]=e[a+3],t[a+1]=e[a+2],t[a+2]=e[a+1],t[a+3]=e[a+0];return new s(t.buffer)}bswap(e){if(2===e)return this.bswap16();if(4===e)return this.bswap32();throw new Error("Invalid componentSize")}convertFromEndianness(e,t){return 1!==t&&e!==n.getSystemEndianness()?this.bswap(t):this}createTypedArray(e,t=0,a,s=0){const i=this.byteOffset+t;let o;void 0!==a?o=e.BYTES_PER_ELEMENT*a:(o=this.byteLength-t,a=o/e.BYTES_PER_ELEMENT,r.assert((0|a)===a));const l=e.BYTES_PER_ELEMENT;if(l>1&&s!==n.getSystemEndianness()){const a=l;return this.subarray(t,o).bswap(a).createTypedArray(e)}return 0==(i&l-1)?new e(this.arrayBuffer,i,a):new e(this.copyToBuffer(t,o),0)}}t.default=s},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(59)),s=a(4),i=a(38),o=a(6),l=a(1),c=a(0),h=a(22),d=a(14),u=a(50);t.EFB_WIDTH=640,t.EFB_HEIGHT=528;t.Light=class{constructor(){this.Position=l.vec3.create(),this.Direction=l.vec3.create(),this.DistAtten=l.vec3.create(),this.CosAtten=l.vec3.create(),this.Color=s.colorNewCopy(s.TransparentBlack),this.reset()}reset(){l.vec3.set(this.Position,0,0,0),l.vec3.set(this.Direction,0,0,-1),l.vec3.set(this.DistAtten,1,0,0),l.vec3.set(this.CosAtten,1,0,0),s.colorFromRGBA(this.Color,0,0,0,1)}copy(e){l.vec3.copy(this.Position,e.Position),l.vec3.copy(this.Direction,e.Direction),l.vec3.copy(this.DistAtten,e.DistAtten),l.vec3.copy(this.CosAtten,e.CosAtten),s.colorCopy(this.Color,e.Color)}};t.FogBlock=class{constructor(){this.Color=s.colorNewCopy(s.TransparentBlack),this.A=0,this.B=0,this.C=0,this.AdjTable=new Uint16Array(10),this.AdjCenter=0}reset(){s.colorFromRGBA(this.Color,0,0,0,0),this.A=0,this.B=0,this.C=0,this.AdjTable.fill(0),this.AdjCenter=0}copy(e){s.colorCopy(this.Color,e.Color),this.A=e.A,this.B=e.B,this.C=e.C,this.AdjTable.set(e.AdjTable),this.AdjCenter=e.AdjCenter}};const m=[{attrInput:2,name:"Position",format:i.GfxFormat.F32_RGBA},{attrInput:0,name:"TexMtx0123Idx",format:i.GfxFormat.F32_RGBA},{attrInput:1,name:"TexMtx4567Idx",format:i.GfxFormat.F32_RGBA},{attrInput:3,name:"Normal",format:i.GfxFormat.F32_RGB},{attrInput:4,name:"Binormal",format:i.GfxFormat.F32_RGB},{attrInput:5,name:"Tangent",format:i.GfxFormat.F32_RGB},{attrInput:6,name:"Color0",format:i.GfxFormat.F32_RGBA},{attrInput:7,name:"Color1",format:i.GfxFormat.F32_RGBA},{attrInput:8,name:"Tex01",format:i.GfxFormat.F32_RGBA},{attrInput:9,name:"Tex23",format:i.GfxFormat.F32_RGBA},{attrInput:10,name:"Tex45",format:i.GfxFormat.F32_RGBA},{attrInput:11,name:"Tex67",format:i.GfxFormat.F32_RGBA}];function p(e){return void 0===e.hasPostTexMtxBlock||e.hasPostTexMtxBlock}function f(e){return void 0===e.hasLightsBlock||e.hasLightsBlock}function A(e){return void 0!==e.hasFogBlock&&e.hasFogBlock}t.getVertexInputLocation=function(e){return m.findIndex(t=>t.attrInput===e)},t.getVertexInputGenDef=function(e){return m.find(t=>t.attrInput===e)},t.materialHasPostTexMtxBlock=p,t.materialHasLightsBlock=f,t.materialHasFogBlock=A,t.getMaterialParamsBlockSize=function(e){let t=224;return p(e)&&(t+=240),f(e)&&(t+=160),A(e)&&(t+=20),t};class g{constructor(e,t=null){this.material=e,this.hacks=t,this.name=e.name}generateFloat(e){let t=e.toString();return t.includes(".")||(t+=".0"),t}generateMaterialSource(e,t){if(null!==this.hacks&&this.hacks.disableVertexColors&&1===e.matColorSource)return"vec4(1.0, 1.0, 1.0, 1.0)";switch(e.matColorSource){case 1:return`a_Color${t}`;case 0:return`u_ColorMatReg[${t}]`}}generateAmbientSource(e,t){if(null!==this.hacks&&this.hacks.disableVertexColors&&1===e.ambColorSource)return"vec4(1.0, 1.0, 1.0, 1.0)";switch(e.ambColorSource){case 1:return`a_Color${t}`;case 0:return`u_ColorAmbReg[${t}]`}}generateLightDiffFn(e,t){const a="dot(t_Normal, t_LightDeltaDir)";switch(e.diffuseFunction){case 0:return"1.0";case 1:return`${a}`;case 2:return`max(${a}, 0.0)`}}generateLightAttnFn(e,t){if(2===e.attenuationFunction)return"\n    t_Attenuation = 1.0;";if(1===e.attenuationFunction){return`\n    t_Attenuation = ${`max(0.0, ApplyAttenuation(${t}.CosAtten.xyz, ${`max(0.0, dot(t_LightDeltaDir, ${t}.Direction.xyz))`}))`} / ${`dot(${t}.DistAtten.xyz, vec3(1.0, t_LightDeltaDist, t_LightDeltaDist2))`};`}if(0===e.attenuationFunction){return`\n    t_Attenuation = ${`(dot(t_Normal, t_LightDeltaDir) >= 0.0) ? max(0.0, dot(t_Normal, ${t}.Direction.xyz)) : 0.0`};\n    t_Attenuation = ${`ApplyAttenuation(${t}.CosAtten.xyz, t_Attenuation)`} / ${`ApplyAttenuation(${t}.DistAtten.xyz, t_Attenuation)`};`}throw"whoops"}generateColorChannel(e,t,a){const r=this.generateMaterialSource(e,a),n=this.generateAmbientSource(e,a);let s=e.lightingEnabled;if(null!==this.hacks&&this.hacks.disableLighting&&(s=!1),s&&null!==this.hacks&&this.hacks.lightingFudge){const e=`a_Color${a}`,s=`u_ColorAmbReg[${a}]`,i=`u_ColorMatReg[${a}]`;return`${t} = vec4(${this.hacks.lightingFudge({vtx:e,amb:s,mat:i,ambSource:n,matSource:r})}); // Fudge!`}let i="";if(s){i=`\n    t_LightAccum = ${n};`,0!==e.litMask&&c.assert(f(this.material));for(let t=0;t<8;t++){if(!(e.litMask&1<<t))continue;const a=`u_LightParams[${t}]`;i+=`\n    t_LightDelta = ${a}.Position.xyz - v_Position.xyz;\n    t_LightDeltaDist2 = dot(t_LightDelta, t_LightDelta);\n    t_LightDeltaDist = sqrt(t_LightDeltaDist2);\n    t_LightDeltaDir = t_LightDelta / t_LightDeltaDist;\n${this.generateLightAttnFn(e,a)}\n    t_LightAccum += ${this.generateLightDiffFn(e,a)} * t_Attenuation * ${a}.Color;\n`}}else i+="\n    t_LightAccum = vec4(1.0);";return`${i}\n    ${t} = ${r} * clamp(t_LightAccum, 0.0, 1.0);`.trim()}generateLightChannel(e,t,a){return r=e.colorChannel,n=e.alphaChannel,r.lightingEnabled===n.lightingEnabled&&r.litMask===n.litMask&&r.ambColorSource===n.ambColorSource&&r.matColorSource===n.matColorSource&&r.attenuationFunction===n.attenuationFunction&&r.diffuseFunction===n.diffuseFunction?`\n    ${this.generateColorChannel(e.colorChannel,t,a)}`:`\n    ${this.generateColorChannel(e.colorChannel,"t_ColorChanTemp",a)}\n    ${t}.rgb = t_ColorChanTemp.rgb;\n\n    ${this.generateColorChannel(e.alphaChannel,"t_ColorChanTemp",a)}\n    ${t}.a = t_ColorChanTemp.a;`;var r,n}generateLightChannels(){return this.material.lightChannels.map((e,t)=>this.generateLightChannel(e,`v_Color${t}`,t)).join("\n")}generateMulPntMatrixStatic(e,t){if(60===e)return`${t}.xyz`;if(e>=30){return`Mul(u_TexMtx[${(e-30)/3}], ${t})`}if(e>=0){return`Mul(u_PosMtx[${(e-0)/3}], ${t})`}throw"whoops"}generateMulPntMatrixDynamic(e,t){return`Mul(GetPosTexMatrix(${e}), ${t})`}generateTexMtxIdxAttr(e){if(0===e)return"(a_TexMtx0123Idx.x * 256.0)";if(1===e)return"(a_TexMtx0123Idx.y * 256.0)";if(2===e)return"(a_TexMtx0123Idx.z * 256.0)";if(3===e)return"(a_TexMtx0123Idx.w * 256.0)";if(4===e)return"(a_TexMtx4567Idx.x * 256.0)";if(5===e)return"(a_TexMtx4567Idx.y * 256.0)";if(6===e)return"(a_TexMtx4567Idx.z * 256.0)";if(7===e)return"(a_TexMtx4567Idx.w * 256.0)";throw"whoops"}generateTexGenSource(e){switch(e){case 0:return"vec4(a_Position.xyz, 1.0)";case 1:return"vec4(a_Normal.xyz, 1.0)";case 2:return"vec4(a_Binormal.xyz, 1.0)";case 3:return"vec4(a_Tangent.xyz, 1.0)";case 19:return"v_Color0";case 20:return"v_Color1";case 4:return"vec4(a_Tex01.xy, 1.0, 1.0)";case 5:return"vec4(a_Tex01.zw, 1.0, 1.0)";case 6:return"vec4(a_Tex23.xy, 1.0, 1.0)";case 7:return"vec4(a_Tex23.zw, 1.0, 1.0)";case 8:return"vec4(a_Tex45.xy, 1.0, 1.0)";case 9:return"vec4(a_Tex45.zw, 1.0, 1.0)";case 10:return"vec4(a_Tex67.xy, 1.0, 1.0)";case 11:return"vec4(a_Tex67.zw, 1.0, 1.0)";case 12:return"vec4(v_TexCoord0, 1.0)";case 13:return"vec4(v_TexCoord1, 1.0)";case 14:return"vec4(v_TexCoord2, 1.0)";case 15:return"vec4(v_TexCoord3, 1.0)";case 16:return"vec4(v_TexCoord4, 1.0)";case 17:return"vec4(v_TexCoord5, 1.0)";case 18:return"vec4(v_TexCoord6, 1.0)";default:throw new Error("whoops")}}generatePostTexGenMatrixMult(e,t){if(125===e.postMatrix)return`${t}.xyz`;if(e.postMatrix>=64){return`Mul(u_PostTexMtx[${(e.postMatrix-64)/3}], ${t})`}throw"whoops"}generateTexGenMatrixMult(e,t){let a=!1;if(void 0!==this.material.useTexMtxIdx&&this.material.useTexMtxIdx[e]&&(a=!0),a){const a=this.generateTexMtxIdxAttr(e);return this.generateMulPntMatrixDynamic(a,t)}return this.generateMulPntMatrixStatic(this.material.texGens[e].matrix,t)}generateTexGenType(e){const t=this.material.texGens[e],a=this.generateTexGenSource(t.source);if(10===t.type)return`vec3(${a}.xy, 1.0)`;if(1===t.type)return`vec3(${this.generateTexGenMatrixMult(e,a)}.xy, 1.0)`;if(0===t.type)return`${this.generateTexGenMatrixMult(e,a)}`;throw new Error("whoops")}generateTexGenNrm(e){const t=this.material.texGens[e],a=this.generateTexGenType(e);return t.normalize?`normalize(${a})`:a}generateTexGenPost(e){const t=this.material.texGens[e],a=this.generateTexGenNrm(e);return 125===t.postMatrix?a:this.generatePostTexGenMatrixMult(t,`vec4(${a}, 1.0)`)}generateTexGen(e){const t=this.material.texGens[e];return`\n    // TexGen ${e} Type: ${t.type} Source: ${t.source} Matrix: ${t.matrix}\n    v_TexCoord${e} = ${this.generateTexGenPost(e)};`}generateTexGens(){return this.material.texGens.map((e,t)=>this.generateTexGen(t)).join("")}generateTexCoordGetters(){return this.material.texGens.map((e,t)=>{if(1===e.type||10===e.type)return`vec2 ReadTexCoord${t}() { return v_TexCoord${t}.xy; }\n`;if(0===e.type)return`vec2 ReadTexCoord${t}() { return v_TexCoord${t}.xy / v_TexCoord${t}.z; }\n`;throw"whoops"}).join("")}generateIndTexStageScaleN(e){switch(e){case 0:return"1.0";case 1:return"1.0/2.0";case 2:return"1.0/4.0";case 3:return"1.0/8.0";case 4:return"1.0/16.0";case 5:return"1.0/32.0";case 6:return"1.0/64.0";case 7:return"1.0/128.0";case 8:return"1.0/256.0";default:throw"whoops"}}generateIndTexStageScale(e){const t=`ReadTexCoord${e.texCoordId}()`;return 0===e.scaleS&&0===e.scaleT?t:`${t} * vec2(${this.generateIndTexStageScaleN(e.scaleS)}, ${this.generateIndTexStageScaleN(e.scaleT)})`}generateTextureSample(e,t){return`texture(u_Texture[${e}], ${t}, TextureLODBias(${e}))`}generateIndTexStage(e){const t=this.material.indTexStages[e];return`\n    // Indirect ${e}\n    vec3 t_IndTexCoord${e} = 255.0 * ${this.generateTextureSample(t.texture,this.generateIndTexStageScale(t))}.abg;`}generateIndTexStages(){return this.material.indTexStages.map((e,t)=>e.texCoordId>=this.material.texGens.length?"":this.generateIndTexStage(t)).join("")}generateKonstColorSel(e){switch(e){case 0:return"vec3(8.0/8.0)";case 1:return"vec3(7.0/8.0)";case 2:return"vec3(6.0/8.0)";case 3:return"vec3(5.0/8.0)";case 4:return"vec3(4.0/8.0)";case 5:return"vec3(3.0/8.0)";case 6:return"vec3(2.0/8.0)";case 7:return"vec3(1.0/8.0)";case 12:return"s_kColor0.rgb";case 16:return"s_kColor0.rrr";case 20:return"s_kColor0.ggg";case 24:return"s_kColor0.bbb";case 28:return"s_kColor0.aaa";case 13:return"s_kColor1.rgb";case 17:return"s_kColor1.rrr";case 21:return"s_kColor1.ggg";case 25:return"s_kColor1.bbb";case 29:return"s_kColor1.aaa";case 14:return"s_kColor2.rgb";case 18:return"s_kColor2.rrr";case 22:return"s_kColor2.ggg";case 26:return"s_kColor2.bbb";case 30:return"s_kColor2.aaa";case 15:return"s_kColor3.rgb";case 19:return"s_kColor3.rrr";case 23:return"s_kColor3.ggg";case 27:return"s_kColor3.bbb";case 31:return"s_kColor3.aaa"}}generateKonstAlphaSel(e){switch(e){case 0:return"(8.0/8.0)";case 1:return"(7.0/8.0)";case 2:return"(6.0/8.0)";case 3:return"(5.0/8.0)";case 4:return"(4.0/8.0)";case 5:return"(3.0/8.0)";case 6:return"(2.0/8.0)";case 7:return"(1.0/8.0)";case 16:return"s_kColor0.r";case 20:return"s_kColor0.g";case 24:return"s_kColor0.b";case 28:return"s_kColor0.a";case 17:return"s_kColor1.r";case 21:return"s_kColor1.g";case 25:return"s_kColor1.b";case 29:return"s_kColor1.a";case 18:return"s_kColor2.r";case 22:return"s_kColor2.g";case 26:return"s_kColor2.b";case 30:return"s_kColor2.a";case 19:return"s_kColor3.r";case 23:return"s_kColor3.g";case 27:return"s_kColor3.b";case 31:return"s_kColor3.a"}}generateRas(e){switch(e.channelId){case 0:return"v_Color0";case 1:return"v_Color1";case 7:return"vec4(0, 0, 0, 0)";default:throw new Error(`whoops ${e.channelId}`)}}generateTexAccess(e){return 255===e.texMap?"vec4(1.0, 1.0, 1.0, 1.0)":null!==this.hacks&&this.hacks.disableTextures?"vec4(1.0, 1.0, 1.0, 1.0)":this.generateTextureSample(e.texMap,"t_TexCoord")}generateComponentSwizzle(e,t){return e&&(t=e[t]),["r","g","b","a"][t]}generateColorSwizzle(e,t){const a=this.generateComponentSwizzle(e,0),r=this.generateComponentSwizzle(e,1),n=this.generateComponentSwizzle(e,2),s=this.generateComponentSwizzle(e,3);switch(t){case 8:case 10:return`${a}${r}${n}`;case 9:case 11:return`${s}${s}${s}`;default:throw"whoops"}}generateColorIn(e,t){switch(t){case 0:return"t_ColorPrev.rgb";case 1:return"t_ColorPrev.aaa";case 2:return"t_Color0.rgb";case 3:return"t_Color0.aaa";case 4:return"t_Color1.rgb";case 5:return"t_Color1.aaa";case 6:return"t_Color2.rgb";case 7:return"t_Color2.aaa";case 8:case 9:return`${this.generateTexAccess(e)}.${this.generateColorSwizzle(e.texSwapTable,t)}`;case 10:case 11:return`TevSaturate(${this.generateRas(e)}.${this.generateColorSwizzle(e.rasSwapTable,t)})`;case 12:return"vec3(1)";case 13:return"vec3(1.0/2.0)";case 14:return`${this.generateKonstColorSel(e.konstColorSel)}`;case 15:return"vec3(0)"}}generateAlphaIn(e,t){switch(t){case 0:return"t_ColorPrev.a";case 1:return"t_Color0.a";case 2:return"t_Color1.a";case 3:return"t_Color2.a";case 4:return`${this.generateTexAccess(e)}.${this.generateComponentSwizzle(e.texSwapTable,3)}`;case 5:return`TevSaturate(${this.generateRas(e)}.${this.generateComponentSwizzle(e.rasSwapTable,3)})`;case 6:return`${this.generateKonstAlphaSel(e.konstAlphaSel)}`;case 7:return"0.0";default:throw"whoops"}}generateTevInputs(e){return`\n    t_TevA = TevOverflow(vec4(${this.generateColorIn(e,e.colorInA)}, ${this.generateAlphaIn(e,e.alphaInA)}));\n    t_TevB = TevOverflow(vec4(${this.generateColorIn(e,e.colorInB)}, ${this.generateAlphaIn(e,e.alphaInB)}));\n    t_TevC = TevOverflow(vec4(${this.generateColorIn(e,e.colorInC)}, ${this.generateAlphaIn(e,e.alphaInC)}));\n    t_TevD = vec4(${this.generateColorIn(e,e.colorInD)}, ${this.generateAlphaIn(e,e.alphaInD)});\n`.trim()}generateTevRegister(e){switch(e){case 0:return"t_ColorPrev";case 1:return"t_Color0";case 2:return"t_Color1";case 3:return"t_Color2"}}generateTevOpBiasScaleClamp(e,t,a){let r=e;return 1===t?r=`TevBias(${r}, 0.5)`:2===t&&(r=`TevBias(${r}, -0.5)`),1===a?r=`(${r}) * 2.0`:2===a?r=`(${r}) * 4.0`:3===a&&(r=`(${r}) * 0.5`),r}generateTevOp(e,t,a,r,n,s,i,o){switch(e){case 0:case 1:const l=`${1===e?"-":""}mix(${r}, ${n}, ${s}) + ${i}`;return this.generateTevOpBiasScaleClamp(l,t,a);case 8:return`((t_TevA.r >  t_TevB.r) ? ${s} : ${o}) + ${i}`;case 9:return`((t_TevA.r == t_TevB.r) ? ${s} : ${o}) + ${i}`;case 10:return`((TevPack16(t_TevA.rg) >  TevPack16(t_TevB.rg)) ? ${s} : ${o}) + ${i}`;case 11:return`((TevPack16(t_TevA.rg) == TevPack16(t_TevB.rg)) ? ${s} : ${o}) + ${i}`;case 12:return`((TevPack24(t_TevA.rgb) >  TevPack24(t_TevB.rgb)) ? ${s} : ${o}) + ${i}`;case 13:return`((TevPack24(t_TevA.rgb) == TevPack24(t_TevB.rgb)) ? ${s} : ${o}) + ${i}`;case 14:return`(TevPerCompGT(${r}, ${n}) * ${s}) + ${i}`;case 15:return`(TevPerCompEQ(${r}, ${n}) * ${s}) + ${i}`;default:throw new Error("whoops")}}generateTevOpValue(e,t,a,r,n,s,i,o,l){const c=this.generateTevOp(e,t,a,n,s,i,o,l);return r?`TevSaturate(${c})`:c}generateColorOp(e){const t=this.generateTevOpValue(e.colorOp,e.colorBias,e.colorScale,e.colorClamp,"t_TevA.rgb","t_TevB.rgb","t_TevC.rgb","t_TevD.rgb","vec3(0)");return`${this.generateTevRegister(e.colorRegId)}.rgb = ${t};`}generateAlphaOp(e){const t=this.generateTevOpValue(e.alphaOp,e.alphaBias,e.alphaScale,e.alphaClamp,"t_TevA.a","t_TevB.a","t_TevC.a","t_TevD.a","0.0");return`${this.generateTevRegister(e.alphaRegId)}.a = ${t};`}generateTevTexCoordWrapN(e,t){switch(t){case 0:return e;case 6:return"0.0";case 1:return`mod(${e}, 256.0)`;case 2:return`mod(${e}, 128.0)`;case 3:return`mod(${e}, 64.0)`;case 4:return`mod(${e}, 32.0)`;case 5:return`mod(${e}, 16.0)`}}generateTevTexCoordWrap(e){const t=this.material.texGens.length-1;let a=e.texCoordId;if(a>=t&&(a=t),a<0)return"vec2(0.0, 0.0)";const r=`ReadTexCoord${a}()`;return 0===e.indTexWrapS&&0===e.indTexWrapT?r:`vec2(${this.generateTevTexCoordWrapN(`${r}.x`,e.indTexWrapS)}, ${this.generateTevTexCoordWrapN(`${r}.y`,e.indTexWrapT)})`}generateTevTexCoordIndTexCoordBias(e){const t=0===e.indTexFormat?"-128.0":"1.0";switch(e.indTexBiasSel){case 0:return"";case 1:return` + vec3(${t}, 0.0, 0.0)`;case 3:return` + vec3(${t}, ${t}, 0.0)`;case 5:return` + vec3(${t}, 0.0, ${t})`;case 2:return` + vec3(0.0, ${t}, 0.0)`;case 6:return` + vec3(0.0, ${t}, ${t})`;case 4:return` + vec3(0.0, 0.0, ${t})`;case 7:return` + vec3(${t})`}}generateTevTexCoordIndTexCoord(e){const t=`(t_IndTexCoord${e.indTexStage})`;switch(e.indTexFormat){case 0:return t;default:case 1:throw new Error("whoops")}}generateTevTexCoordIndirectMtx(e){const t=`(${this.generateTevTexCoordIndTexCoord(e)}${this.generateTevTexCoordIndTexCoordBias(e)})`;switch(e.indTexMatrix){case 1:return`Mul(u_IndTexMtx[0], vec4(${t}, 0.0))`;case 2:return`Mul(u_IndTexMtx[1], vec4(${t}, 0.0))`;case 3:return`Mul(u_IndTexMtx[2], vec4(${t}, 0.0))`;default:return console.warn(`Unimplemented indTexMatrix mode: ${e.indTexMatrix}`),`${t}.xy`}}generateTevTexCoordIndirectTranslation(e){return`(${this.generateTevTexCoordIndirectMtx(e)} * TextureInvScale(${e.texMap}))`}generateTevTexCoordIndirect(e){const t=this.generateTevTexCoordWrap(e);return 0!==e.indTexMatrix&&e.indTexStage<this.material.indTexStages.length?`${t} + ${this.generateTevTexCoordIndirectTranslation(e)}`:t}generateTevTexCoord(e){if(255===e.texCoordId)return"";const t=this.generateTevTexCoordIndirect(e);return e.indTexAddPrev?`t_TexCoord += ${t};`:`t_TexCoord = ${t};`}generateTevStage(e){const t=this.material.tevStages[e];return`\n    // TEV Stage ${e}\n    ${this.generateTevTexCoord(t)}\n    // Color Combine\n    // colorIn: ${t.colorInA} ${t.colorInB} ${t.colorInC} ${t.colorInD}  colorOp: ${t.colorOp} colorBias: ${t.colorBias} colorScale: ${t.colorScale} colorClamp: ${t.colorClamp} colorRegId: ${t.colorRegId}\n    // alphaIn: ${t.alphaInA} ${t.alphaInB} ${t.alphaInC} ${t.alphaInD}  alphaOp: ${t.alphaOp} alphaBias: ${t.alphaBias} alphaScale: ${t.alphaScale} alphaClamp: ${t.alphaClamp} alphaRegId: ${t.alphaRegId}\n    // texCoordId: ${t.texCoordId} texMap: ${t.texMap} channelId: ${t.channelId}\n    ${this.generateTevInputs(t)}\n    ${this.generateColorOp(t)}\n    ${this.generateAlphaOp(t)}`}generateTevStages(){return this.material.tevStages.map((e,t)=>this.generateTevStage(t)).join("\n")}generateTevStagesLastMinuteFixup(){const e=this.material.tevStages,t=e[e.length-1],a=this.generateTevRegister(t.colorRegId),r=this.generateTevRegister(t.alphaRegId);return a===r?`\n    vec4 t_TevOutput = ${a};`:`\n    vec4 t_TevOutput = vec4(${a}.rgb, ${r}.a);`}generateAlphaTestCompare(e,t){const a=this.generateFloat(t);switch(e){case 0:return"false";case 1:return`t_PixelOut.a <  ${a}`;case 2:return`t_PixelOut.a == ${a}`;case 3:return`t_PixelOut.a <= ${a}`;case 4:return`t_PixelOut.a >  ${a}`;case 5:return`t_PixelOut.a != ${a}`;case 6:return`t_PixelOut.a >= ${a}`;case 7:return"true"}}generateAlphaTestOp(e){switch(e){case 0:return"t_AlphaTestA && t_AlphaTestB";case 1:return"t_AlphaTestA || t_AlphaTestB";case 2:return"t_AlphaTestA != t_AlphaTestB";case 3:return"t_AlphaTestA == t_AlphaTestB"}}generateAlphaTest(){const e=this.material.alphaTest;return`\n    // Alpha Test: Op ${e.op}\n    // Compare A: ${e.compareA} Reference A: ${this.generateFloat(e.referenceA)}\n    // Compare B: ${e.compareB} Reference B: ${this.generateFloat(e.referenceB)}\n    bool t_AlphaTestA = ${this.generateAlphaTestCompare(e.compareA,e.referenceA)};\n    bool t_AlphaTestB = ${this.generateAlphaTestCompare(e.compareB,e.referenceB)};\n    if (!(${this.generateAlphaTestOp(e.op)}))\n        discard;`}generateFogZCoord(){return h.IS_DEPTH_REVERSED?"(1.0 - gl_FragCoord.z)":"gl_FragCoord.z"}generateFogBase(){const e=!!(this.material.ropInfo.fogType>>>3),t="u_FogBlock.Param.x",a=this.generateFogZCoord();return e?`${t} * ${a}`:`${t} / (u_FogBlock.Param.y - ${a})`}generateFogAdj(e){return this.material.ropInfo.fogAdjEnabled,""}generateFogFunc(e){this.material.ropInfo.fogType;return""}generateFog(){if(0===this.material.ropInfo.fogType)return"";return`\n    float t_FogBase = ${this.generateFogBase()};\n${this.generateFogAdj("t_FogBase")}\n    float t_Fog = TevSaturate(t_FogBase - u_FogBlock.Param.z);\n${this.generateFogFunc("t_Fog")}\n    t_PixelOut.rgb = mix(t_PixelOut.rgb, u_FogBlock.Color.rgb, t_Fog);\n`}generateAttributeStorageType(e){switch(e){case i.GfxFormat.F32_R:return"float";case i.GfxFormat.F32_RG:return"vec2";case i.GfxFormat.F32_RGB:return"vec3";case i.GfxFormat.F32_RGBA:return"vec4";default:throw"whoops"}}generateVertAttributeDefs(){return m.map((e,t)=>`layout(location = ${t}) in ${this.generateAttributeStorageType(e.format)} a_${e.name};`).join("\n")}generateMulPos(){const e="vec4(a_Position.xyz, 1.0)";return void 0===this.material.usePnMtxIdx||this.material.usePnMtxIdx?this.generateMulPntMatrixDynamic("a_Position.w",e):this.generateMulPntMatrixStatic(0,e)}generateMulNrm(){const e="vec4(a_Normal.xyz, 0.0)";return void 0===this.material.usePnMtxIdx||this.material.usePnMtxIdx?this.generateMulPntMatrixDynamic("a_Position.w",e):this.generateMulPntMatrixStatic(0,e)}generateShaders(e){const t=`\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n    vec4 u_Misc0;\n};\n\n#define u_SceneTextureLODBias u_Misc0[0]\n\nstruct Light {\n    vec4 Color;\n    vec4 Position;\n    vec4 Direction;\n    vec4 DistAtten;\n    vec4 CosAtten;\n};\n\nstruct FogBlock {\n    // A, B, C, Center\n    vec4 Param;\n    // 10 items\n    vec4 AdjTable[3];\n    // Fog color is RGB\n    vec4 Color;\n};\n\n// Expected to change with each material.\nlayout(row_major, std140) uniform ub_MaterialParams {\n    vec4 u_ColorMatReg[2];\n    vec4 u_ColorAmbReg[2];\n    vec4 u_KonstColor[4];\n    vec4 u_Color[4];\n    Mat4x3 u_TexMtx[10];\n    // SizeX, SizeY, 0, Bias\n    vec4 u_TextureParams[8];\n    Mat4x2 u_IndTexMtx[3];\n\n    // Optional parameters.\n${p(a=this.material)?"\n    Mat4x3 u_PostTexMtx[20];\n":""}\n${f(a)?"\n    Light u_LightParams[8];\n":""}\n${A(a)?"\n    FogBlock u_FogBlock;\n":""}\n};\n\n// Expected to change with each shape packet.\nlayout(row_major, std140) uniform ub_PacketParams {\n    Mat4x3 u_PosMtx[10];\n};\n\nuniform sampler2D u_Texture[8];\n`;var a;const r=`\n// ${this.material.name}\nprecision mediump float;\n${t}\n\nvarying vec3 v_Position;\nvarying vec4 v_Color0;\nvarying vec4 v_Color1;\nvarying vec3 v_TexCoord0;\nvarying vec3 v_TexCoord1;\nvarying vec3 v_TexCoord2;\nvarying vec3 v_TexCoord3;\nvarying vec3 v_TexCoord4;\nvarying vec3 v_TexCoord5;\nvarying vec3 v_TexCoord6;\nvarying vec3 v_TexCoord7;\n`,n=`\n${r}\n${this.generateVertAttributeDefs()}\n\nMat4x3 GetPosTexMatrix(float t_MtxIdxFloat) {\n    uint t_MtxIdx = uint(t_MtxIdxFloat / 3.0);\n    if (t_MtxIdx == 20u)\n        return _Mat4x3(1.0);\n    else if (t_MtxIdx >= 10u)\n        return u_TexMtx[(t_MtxIdx - 10u)];\n    else\n        return u_PosMtx[t_MtxIdx];\n}\n\nfloat ApplyAttenuation(vec3 t_Coeff, float t_Value) {\n    return dot(t_Coeff, vec3(1.0, t_Value, t_Value*t_Value));\n}\n\nvoid main() {\n    vec3 t_Position = ${this.generateMulPos()};\n    v_Position = t_Position;\n    vec3 t_Normal = ${this.generateMulNrm()};\n\n    vec4 t_LightAccum;\n    vec3 t_LightDelta, t_LightDeltaDir;\n    float t_LightDeltaDist2, t_LightDeltaDist, t_Attenuation;\n    vec4 t_ColorChanTemp;\n${this.generateLightChannels()}\n${this.generateTexGens()}\n    gl_Position = Mul(u_Projection, vec4(t_Position, 1.0));\n}\n`,s=`\n${r}\n${this.generateTexCoordGetters()}\n\nfloat TextureLODBias(int index) { return u_SceneTextureLODBias + u_TextureParams[index].w; }\nvec2 TextureInvScale(int index) { return 1.0 / u_TextureParams[index].xy; }\nvec2 TextureScale(int index) { return u_TextureParams[index].xy; }\n\nvec3 TevBias(vec3 a, float b) { return a + vec3(b); }\nfloat TevBias(float a, float b) { return a + b; }\nvec3 TevSaturate(vec3 a) { return clamp(a, vec3(0), vec3(1)); }\nfloat TevSaturate(float a) { return clamp(a, 0.0, 1.0); }\nfloat TevOverflow(float a) { return float(int(a * 255.0) & 255) / 255.0; }\nvec4 TevOverflow(vec4 a) { return vec4(TevOverflow(a.r), TevOverflow(a.g), TevOverflow(a.b), TevOverflow(a.a)); }\nfloat TevPack16(vec2 a) { return dot(a, vec2(1.0, 256.0)); }\nfloat TevPack24(vec3 a) { return dot(a, vec3(1.0, 256.0, 256.0 * 256.0)); }\nfloat TevPerCompGT(float a, float b) { return float(a >  b); }\nfloat TevPerCompEQ(float a, float b) { return float(a == b); }\nvec3 TevPerCompGT(vec3 a, vec3 b) { return vec3(greaterThan(a, b)); }\nvec3 TevPerCompEQ(vec3 a, vec3 b) { return vec3(greaterThan(a, b)); }\n\nvoid main() {\n    vec4 s_kColor0   = u_KonstColor[0];\n    vec4 s_kColor1   = u_KonstColor[1];\n    vec4 s_kColor2   = u_KonstColor[2];\n    vec4 s_kColor3   = u_KonstColor[3];\n\n    vec4 t_ColorPrev = u_Color[0];\n    vec4 t_Color0    = u_Color[1];\n    vec4 t_Color1    = u_Color[2];\n    vec4 t_Color2    = u_Color[3];\n\n${this.generateIndTexStages()}\n\n    vec2 t_TexCoord = vec2(0.0, 0.0);\n    vec4 t_TevA, t_TevB, t_TevC, t_TevD;\n${this.generateTevStages()}\n\n${this.generateTevStagesLastMinuteFixup()}\n    vec4 t_PixelOut = TevOverflow(t_TevOutput);\n${this.generateAlphaTest()}\n${this.generateFog()}\n    gl_FragColor = t_PixelOut;\n}`;return u.preprocessProgramObj_GLSL(e,{vert:n,frag:s})}}function _(e){switch(e){case 3:return 3;case 1:return 1;case 2:return 2;case 0:return 0}}function S(e){switch(e){case 0:return o.GfxBlendFactor.ZERO;case 1:return o.GfxBlendFactor.ONE;case 4:return o.GfxBlendFactor.SRC_ALPHA;case 5:return o.GfxBlendFactor.ONE_MINUS_SRC_ALPHA;case 6:return o.GfxBlendFactor.DST_ALPHA;case 7:return o.GfxBlendFactor.ONE_MINUS_DST_ALPHA;default:throw new Error("whoops")}}function b(e,t){const a=[];for(let r=0;r<t;r++){const t=e.xfg(n.XFRegister.XF_TEX0_ID+r),s=t>>>1&1,i=t>>>4&2,o=t>>>7&15,l=t>>>12&7,c=t>>>15&7;let h,d;if(0===i){h=0===s?1:0,d=[0,1,19,2,3,4,5,6,7,8,9,10,11][o]}else if(1===i)h=2+c,d=12+l;else if(2===i)h=10,d=19;else{if(2!==i)throw"whoops";h=10,d=20}const u=60,m=e.xfg(n.XFRegister.XF_DUALTEX0_ID+r),p=64+(m>>>0&255),f=!!(m>>>8&1);a.push({type:h,source:d,matrix:u,normalize:f,postMatrix:p})}return a}function v(e,t,a){if(3!==e)return a?1:0;switch(t){case 0:return a?9:8;case 1:return a?11:10;case 2:return a?13:12;case 3:return a?15:14;default:throw"whoops 2"}}function w(e,t){const a=[],r=[];for(let a=0;a<8;a++){const s=e.bp[n.BPRegister.RAS1_TREF_0_ID+a],i=s>>>0&7,o=s>>>3&7,l=!!(s>>>6&1),c=s>>>7&7,h=s>>>12&7,d=s>>>15&7,u=!!(s>>>18&1),m=s>>>19&7;if(2*a+0>=t)break;const p={texMapId:l?i:255,texCoordId:o,channelId:c};if(r.push(p),2*a+1>=t)break;const f={texMapId:u?h:255,texCoordId:d,channelId:m};r.push(f)}c.assert(r.length===t);for(let t=0;t<r.length;t++){const s=e.bp[n.BPRegister.TEV_COLOR_ENV_0_ID+2*t],i=s>>>0&15,o=s>>>4&15,l=s>>>8&15,c=s>>>12&15,h=s>>>16&3,d=!!(s>>>19&1),u=s>>>20&3,m=s>>>22&3,p=v(h,u,!!(s>>>18&1)),f=e.bp[n.BPRegister.TEV_ALPHA_ENV_0_ID+2*t],A=f>>>0&3,g=f>>>2&3,_=f>>>4&7,S=f>>>7&7,b=f>>>10&7,w=f>>>13&7,x=f>>>16&3,T=!!(f>>>19&1),y=f>>>20&3,C=f>>>22&3,M=v(x,y,!!(f>>>18&1)),U=e.bp[n.BPRegister.TEV_KSEL_0_ID+(t>>>1)],k=31&(1&t?U>>>14:U>>>4),D=31&(1&t?U>>>19:U>>>9),I=e.bp[n.BPRegister.IND_CMD0_ID+t],R=I>>>0&3,B=I>>>2&3,P=I>>>4&7,E=I>>>9&15,F=I>>>13&7,V=I>>>16&7,O=!!(I>>>19&1),N=!!(I>>>20&1),L=e.bp[n.BPRegister.TEV_KSEL_0_ID+2*A],G=e.bp[n.BPRegister.TEV_KSEL_0_ID+2*A+1],H=[L>>>0&3,L>>>2&3,G>>>0&3,G>>>2&3],j=e.bp[n.BPRegister.TEV_KSEL_0_ID+2*g],W=e.bp[n.BPRegister.TEV_KSEL_0_ID+2*g+1],Z=[j>>>0&3,j>>>2&3,W>>>0&3,W>>>2&3],z={colorInA:c,colorInB:l,colorInC:o,colorInD:i,colorOp:p,colorBias:h,colorClamp:d,colorScale:u,colorRegId:m,alphaInA:w,alphaInB:b,alphaInC:S,alphaInD:_,alphaOp:M,alphaBias:x,alphaClamp:T,alphaScale:y,alphaRegId:C,texCoordId:r[t].texCoordId,texMap:r[t].texMapId,channelId:r[t].channelId,konstColorSel:k,konstAlphaSel:D,rasSwapTable:H,texSwapTable:Z,indTexStage:R,indTexFormat:B,indTexBiasSel:P,indTexMatrix:E,indTexWrapS:F,indTexWrapT:V,indTexAddPrev:N,indTexUseOrigLOD:O};a.push(z)}return a}function x(e,t){const a=[],r=e.bp[n.BPRegister.RAS1_IREF_ID];for(let s=0;s<t;s++){const t=e.bp[n.BPRegister.RAS1_SS0_ID+(s>>>2)],i=t>>>8*(1&s)+0&15,o=t>>>8*(1&s)+4&15,l=r>>>6*s&7,c=r>>>6*s&7;a.push({scaleS:i,scaleT:o,texCoordId:c,texture:l})}return a}function T(e){const t=e.bp[n.BPRegister.PE_CMODE0_ID],a=t>>>0&1?t>>>11&1?3:1:t>>>1&1?2:0,r=t>>>5&7,s=t>>>8&7,i=t>>>12&15,o=e.bp[n.BPRegister.PE_ZMODE_ID];return{fogType:0,fogAdjEnabled:!1,blendMode:a,blendDstFactor:r,blendSrcFactor:s,blendLogicOp:i,depthFunc:o>>>1&7,depthTest:!!(o>>>0&1),depthWrite:!!(o>>>4&1)}}function y(e){const t=e.bp[n.BPRegister.TEV_ALPHAFUNC_ID];return{referenceA:(t>>>0&255)/255,referenceB:(t>>>8&255)/255,compareA:t>>>16&7,compareB:t>>>19&7,op:t>>>22&7}}function C(e){return{lightingEnabled:!!(e>>>1&1),matColorSource:e>>>0&1,ambColorSource:e>>>6&1,litMask:(e>>>11&15)<<4|e>>>2&15,diffuseFunction:e>>>7&3,attenuationFunction:!!(e>>>9&1)?!!(e>>>10&1)?1:0:2}}function M(e){const t=[],a=e.xfg(n.XFRegister.XF_NUMCOLORS_ID);for(let r=0;r<a;r++){const a=e.xfg(n.XFRegister.XF_COLOR0CNTRL_ID+r),s=e.xfg(n.XFRegister.XF_ALPHA0CNTRL_ID+r),i=C(a),o=C(s);t.push({colorChannel:i,alphaChannel:o});const l=i.lightingEnabled&&0===i.matColorSource||0===i.ambColorSource,c=i.lightingEnabled&&0===i.matColorSource||0===i.ambColorSource;(l||c)&&console.warn(`CommandList ${name} uses register color values, but these are not yet supported`)}return t}t.GX_Program=g,g.ub_SceneParams=0,g.ub_MaterialParams=1,g.ub_PacketParams=2,t.translateCullMode=_,t.translateGfxMegaState=function(e,t){e.cullMode=_(t.cullMode),e.depthWrite=t.ropInfo.depthWrite,e.depthCompare=t.ropInfo.depthTest?h.reverseDepthForCompareMode(function(e){switch(e){case 0:return o.GfxCompareMode.NEVER;case 1:return o.GfxCompareMode.LESS;case 2:return o.GfxCompareMode.EQUAL;case 3:return o.GfxCompareMode.LEQUAL;case 4:return o.GfxCompareMode.GREATER;case 5:return o.GfxCompareMode.NEQUAL;case 6:return o.GfxCompareMode.GEQUAL;case 7:return o.GfxCompareMode.ALWAYS}}(t.ropInfo.depthFunc)):o.GfxCompareMode.ALWAYS,e.frontFace=o.GfxFrontFaceMode.CW;const a={};0===t.ropInfo.blendMode?(a.blendMode=o.GfxBlendMode.ADD,a.blendSrcFactor=o.GfxBlendFactor.ONE,a.blendDstFactor=o.GfxBlendFactor.ZERO):1===t.ropInfo.blendMode?(a.blendMode=o.GfxBlendMode.ADD,a.blendSrcFactor=function(e){switch(e){case 2:return o.GfxBlendFactor.DST_COLOR;case 3:return o.GfxBlendFactor.ONE_MINUS_DST_COLOR;default:return S(e)}}(t.ropInfo.blendSrcFactor),a.blendDstFactor=function(e){switch(e){case 2:return o.GfxBlendFactor.SRC_COLOR;case 3:return o.GfxBlendFactor.ONE_MINUS_SRC_COLOR;default:return S(e)}}(t.ropInfo.blendDstFactor)):3===t.ropInfo.blendMode?(a.blendMode=o.GfxBlendMode.REVERSE_SUBTRACT,a.blendSrcFactor=o.GfxBlendFactor.ONE,a.blendDstFactor=o.GfxBlendFactor.ONE):2===t.ropInfo.blendMode&&(a.blendMode=o.GfxBlendMode.ADD,a.blendSrcFactor=o.GfxBlendFactor.ONE,a.blendDstFactor=o.GfxBlendFactor.ZERO,console.warn("Unimplemented LOGIC blend mode")),d.setAttachmentStateSimple(e,a)},t.parseTexGens=b,t.parseTevStages=w,t.parseIndirectStages=x,t.parseRopInfo=T,t.parseAlphaTest=y,t.parseColorChannelControlRegister=C,t.parseLightChannels=M,t.parseMaterial=function(e,t){const a=e.bp[n.BPRegister.GEN_MODE_ID],r=1+(a>>>10&15),s=a>>>16&7,i=[0,2,1,3][a>>>14&3],o=b(e,a>>>0&15),l=w(e,r),c=x(e,s),h=T(e),d=y(e);return{name:t,lightChannels:M(e),cullMode:i,tevStages:l,texGens:o,indTexStages:c,alphaTest:d,ropInfo:h}},t.getRasColorChannelID=function(e){switch(e){case 0:case 2:case 4:return 0;case 1:case 3:case 5:return 1;case 7:return 5;case 8:return 6;case 6:case 255:return 7;default:throw"whoops"}};const U=l.vec4.create();function k(e,t,a,r,n,s=U){l.vec4.set(s,a,r,n,1),l.vec4.transformMat4(s,s,t),l.vec3.set(e.Position,s[0],s[1],s[2])}function D(e,t,a,r,n,s=U){return k(e,t.viewMatrix,a,r,n,s)}function I(e,t,a,r,n,s=U){l.vec4.set(s,a,r,n,0),l.vec4.transformMat4(s,s,t),l.vec4.normalize(s,s),l.vec3.set(e.Direction,s[0],s[1],s[2])}function R(e,t,a,r,n,s=U){return I(e,t.viewMatrix,a,r,n,s)}t.lightSetWorldPositionViewMatrix=k,t.lightSetWorldPosition=D,t.lightSetWorldDirectionNormalMatrix=I,t.lightSetWorldDirection=R,t.lightSetFromWorldLight=function(e,t,a){D(e,a,t.Position[0],t.Position[1],t.Position[2]),R(e,a,t.Direction[0],t.Direction[1],t.Direction[2]),l.vec3.copy(e.DistAtten,t.DistAtten),l.vec3.copy(e.CosAtten,t.CosAtten),s.colorCopy(e.Color,t.Color)},t.lightSetSpot=function(e,t,a){(t<=0||t>=90)&&(a=0);const r=Math.cos(.01745*t);if(1===a)l.vec3.set(e.CosAtten,-1e3*r,1e3,0);else if(2===a)l.vec3.set(e.CosAtten,-r/(1-r),1/(1-r),0);else if(3===a)l.vec3.set(e.CosAtten,0,-r/(1-r),1/(1-r));else if(4===a){const t=(1-r)*(1-r);l.vec3.set(e.CosAtten,r*(r-2)/t,2/t,-1/t)}else if(5===a){const t=(1-r)*(1-r);l.vec3.set(e.CosAtten,-4*r/t,4*(1+r)/t,-4/t)}else if(6===a){const t=(1-r)*(1-r);l.vec3.set(e.CosAtten,1-2*r*r/t,4*r/t,-2/t)}else 0===a&&l.vec3.set(e.CosAtten,1,0,0)},t.lightSetDistAttn=function(e,t,a,r){(t<0||a<=0||a>=1)&&(r=0),1===r?l.vec3.set(e.DistAtten,1,(1-a)/(a*t),0):2===r?l.vec3.set(e.DistAtten,1,.5*(1-a)/(a*t),.5*(1-a)/(a*t*t)):3===r?l.vec3.set(e.DistAtten,1,0,(1-a)/(a*t*t)):0===r&&l.vec3.set(e.DistAtten,1,0,0)},t.fogBlockSet=function(e,t,a,r,n,s){const i=!!(t>>>3);c.assert(Number.isFinite(s)),i?e.A:(e.A=s*n/((s-n)*(r-a)),e.B=s/(s-n),e.C=a/(r-a))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);function n(e,t,a){let n=0;for(let e=0;e<a.length;e++)n+=a[e].byteLength,n=r.align(n,4);const s=n/4,i=e.createBuffer(s,t,1),o=e.createHostAccessPass(),l=[];let c=0;for(let e=0;e<a.length;e++){const t=a[e],n=r.align(t.byteLength,4)/4;l.push({buffer:i,wordOffset:c,wordCount:n}),o.uploadBufferData(i,c,t.createTypedArray(Uint8Array)),c+=n}return e.submitPass(o),l}t.coalesceBuffer=n;t.GfxBufferCoalescer=class{constructor(e,t,a){if(this.vertexBuffer=null,this.indexBuffer=null,r.assert(t.length===a.length),0===t.length)return;const s=n(e,2,t),i=n(e,1,a),o=[];for(let e=0;e<s.length;e++){const t=s[e],a=i[e];o.push({vertexBuffer:t,indexBuffer:a})}this.coalescedBuffers=o,this.vertexBuffer=this.coalescedBuffers[0].vertexBuffer.buffer,this.indexBuffer=this.coalescedBuffers[0].indexBuffer.buffer}destroy(e){null!==this.vertexBuffer&&e.destroyBuffer(this.vertexBuffer),null!==this.indexBuffer&&e.destroyBuffer(this.indexBuffer)}};t.GfxBufferCoalescerCombo=class{constructor(e,t,a){if(this.vertexBuffer=null,this.indexBuffer=null,r.assert(t.length===a.length),0===t.length)return;const s=[];for(let e=0;e<t.length;e++)for(let a=0;a<t[e].length;a++)s.push(t[e][a]);const i=n(e,2,s),o=n(e,1,a),l=[];let c=0;for(let e=0;e<t.length;e++){const a=[];for(let r=0;r<t[e].length;r++)a.push(i[c++]);const r=o[e];l.push({vertexBuffers:a,indexBuffer:r})}this.coalescedBuffers=l,this.vertexBuffer=this.coalescedBuffers[0].vertexBuffers[0].buffer,this.indexBuffer=this.coalescedBuffers[0].indexBuffer.buffer}destroy(e){null!==this.vertexBuffer&&e.destroyBuffer(this.vertexBuffer),null!==this.indexBuffer&&e.destroyBuffer(this.indexBuffer)}},t.makeStaticDataBuffer=function(e,t,a){const n=e.createBuffer(r.align(a.byteLength,4)/4,t,1),s=e.createHostAccessPass();return s.uploadBufferData(n,0,new Uint8Array(a)),e.submitPass(s),n},t.makeStaticDataBufferFromSlice=function(e,t,a){const n=e.createBuffer(r.align(a.byteLength,4)/4,t,1),s=e.createHostAccessPass();return s.uploadBufferData(n,0,a.createTypedArray(Uint8Array)),e.submitPass(s),n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){return e*(t/1e3)}t.default=class{constructor(e=30){this.fps=e,this.timeInFrames=0,this.phaseFrames=0}getTimeInFrames(){return this.timeInFrames+this.phaseFrames}getTimeInSeconds(){return this.getTimeInFrames()/this.fps}setTimeInMilliseconds(e){this.setTimeInFrames(r(e,this.fps))}setTimeInFrames(e){this.timeInFrames=e}setTimeFromViewerInput(e){this.setTimeInMilliseconds(e.time)}quantizeTimeToFPS(){this.timeInFrames=0|this.timeInFrames}setPhaseInMilliseconds(e){this.phaseFrames=r(e,this.fps)}setPhaseToCurrent(){this.phaseFrames=-this.timeInFrames}},t.getTimeInFrames=r},function(e,t,a){"use strict";(function(e,r){a.d(t,"d",(function(){return s})),a.d(t,"j",(function(){return i})),a.d(t,"g",(function(){return l})),a.d(t,"n",(function(){return c})),a.d(t,"l",(function(){return h})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return p})),a.d(t,"h",(function(){return f})),a.d(t,"i",(function(){return A})),a.d(t,"m",(function(){return _})),a.d(t,"k",(function(){return S})),a.d(t,"f",(function(){return b}));var n=a(24);a(70);function s(e,t){return e.require(t)}function i(){return"[object process]"===Object.prototype.toString.call(void 0!==e?e:0)}var o={};function l(){return i()?r:"undefined"!=typeof window?window:"undefined"!=typeof self?self:o}function c(){var e=l(),t=e.crypto||e.msCrypto;if(void 0!==t&&t.getRandomValues){var a=new Uint16Array(8);t.getRandomValues(a),a[3]=4095&a[3]|16384,a[4]=16383&a[4]|32768;var r=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return r(a[0])+r(a[1])+r(a[2])+r(a[3])+r(a[4])+r(a[5])+r(a[6])+r(a[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function h(e){if(!e)return{};var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var a=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],relative:t[5]+a+r}}function d(e){if(e.message)return e.message;if(e.exception&&e.exception.values&&e.exception.values[0]){var t=e.exception.values[0];return t.type&&t.value?t.type+": "+t.value:t.type||t.value||e.event_id||"<unknown>"}return e.event_id||"<unknown>"}function u(e){var t=l();if(!("console"in t))return e();var a=t.console,r={};["debug","info","warn","error","log","assert"].forEach((function(e){e in t.console&&a[e].__sentry_original__&&(r[e]=a[e],a[e]=a[e].__sentry_original__)}));var n=e();return Object.keys(r).forEach((function(e){a[e]=r[e]})),n}function m(e,t,a){e.exception=e.exception||{},e.exception.values=e.exception.values||[],e.exception.values[0]=e.exception.values[0]||{},e.exception.values[0].value=e.exception.values[0].value||t||"",e.exception.values[0].type=e.exception.values[0].type||a||"Error"}function p(e,t){void 0===t&&(t={});try{e.exception.values[0].mechanism=e.exception.values[0].mechanism||{},Object.keys(t).forEach((function(a){e.exception.values[0].mechanism[a]=t[a]}))}catch(e){}}function f(){try{return document.location.href}catch(e){return""}}function A(e){try{for(var t=e,a=[],r=0,n=0,s=" > ".length,i=void 0;t&&r++<5&&!("html"===(i=g(t))||r>1&&n+a.length*s+i.length>=80);)a.push(i),n+=i.length,t=t.parentNode;return a.reverse().join(" > ")}catch(e){return"<unknown>"}}function g(e){var t,a,r,s,i,o=e,l=[];if(!o||!o.tagName)return"";if(l.push(o.tagName.toLowerCase()),o.id&&l.push("#"+o.id),(t=o.className)&&Object(n.k)(t))for(a=t.split(/\s+/),i=0;i<a.length;i++)l.push("."+a[i]);var c=["type","name","title","alt"];for(i=0;i<c.length;i++)r=c[i],(s=o.getAttribute(r))&&l.push("["+r+'="'+s+'"]');return l.join("")}function _(){return(new Date).getTime()/1e3}function S(e,t){if(!t)return 6e4;var a=parseInt(""+t,10);if(!isNaN(a))return 1e3*a;var r=Date.parse(""+t);return isNaN(r)?6e4:r-e}function b(e){try{return e&&"function"==typeof e&&e.name||"<anonymous>"}catch(e){return"<anonymous>"}}}).call(this,a(75),a(57))},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(136)),s=a(0),i=a(50);t.deviceProgramEqual=function(e,t){return e.both===t.both&&(e.vert===t.vert&&(e.frag===t.frag&&!!function(e,t){if(e.size!==t.size)return!1;for(const[a,r]of e.entries())if(t.get(a)!==r)return!1;return!0}(e.defines,t.defines)))};t.DeviceProgram=class{constructor(){this.name="(unnamed)",this.preprocessedVert="",this.preprocessedFrag="",this.both="",this.vert="",this.frag="",this.defines=new Map}ensurePreprocessed(e){""===this.preprocessedVert&&(this.preprocessedVert=i.preprocessShader_GLSL(e,"vert",this.both+this.vert,this.defines),this.preprocessedFrag=i.preprocessShader_GLSL(e,"frag",this.both+this.frag,this.defines))}_editShader(e){const t=s.assertExists(window.open("about:blank",void 0,"location=off, resizable, alwaysRaised, left=20, top=20, width=1200, height=900")),a=()=>{const a=new n.default(t.document),r=t.document,s="vert"===e?`${this.name} - Vertex Shader`:`${this.name} - Fragment Shader`;r.title=s,r.body.style.margin="0";const i=this[e];a.setValue(i),a.setFontSize("16px");let o=0;const l=()=>{o=0,this[e]=a.getValue(),this.preprocessedVert=""};a.onvaluechanged=function(){o>0&&clearTimeout(o),o=window.setTimeout(l,500)},(t.onresize=()=>{a.setSize(r.body.offsetWidth,window.innerHeight)})(),t.editor=a,t.document.body.appendChild(a.elem)};"complete"===t.document.readyState?a():t.onload=a}editb(){this._editShader("both")}editv(){this._editShader("vert")}editf(){this._editShader("frag")}}},,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6);function n(e,a=t.IS_DEPTH_REVERSED){if(!a)return e;switch(e){case r.GfxCompareMode.LESS:return r.GfxCompareMode.GREATER;case r.GfxCompareMode.LEQUAL:return r.GfxCompareMode.GEQUAL;case r.GfxCompareMode.GEQUAL:return r.GfxCompareMode.LEQUAL;case r.GfxCompareMode.GREATER:return r.GfxCompareMode.LESS;default:return e}}t.IS_DEPTH_REVERSED=!0,t.reverseDepthForPerspectiveProjectionMatrix=function(e,a=t.IS_DEPTH_REVERSED){a&&(e[10]=-e[10],e[14]=-e[14])},t.reverseDepthForOrthographicProjectionMatrix=function(e,a=t.IS_DEPTH_REVERSED){a&&(e[10]=-e[10],e[14]=1-e[14])},t.reverseDepthForCompareMode=n,t.reverseDepthForClearValue=function(e,a=t.IS_DEPTH_REVERSED){return a?1-e:e},t.reverseDepthForDepthOffset=function(e,a=t.IS_DEPTH_REVERSED){return a?-e:e},t.compareDepthValues=function(e,a,s,i=t.IS_DEPTH_REVERSED){if((s=n(s,i))===r.GfxCompareMode.LESS)return e<a;if(s===r.GfxCompareMode.LEQUAL)return e<=a;if(s===r.GfxCompareMode.GREATER)return e>a;if(s===r.GfxCompareMode.GEQUAL)return e>=a;throw"whoops"}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(33),n=a(7);t.GfxRenderHelper=class{constructor(e){this.renderInstManager=new n.GfxRenderInstManager,this.uniformBuffer=new r.GfxRenderDynamicUniformBuffer(e)}pushTemplateRenderInst(){const e=this.renderInstManager.pushTemplateRenderInst();return e.setUniformBuffer(this.uniformBuffer),e}prepareToRender(e,t){this.uniformBuffer.prepareToRender(e,t)}destroy(e){this.uniformBuffer.destroy(e),this.renderInstManager.destroy(e)}getCache(){return this.renderInstManager.gfxRenderCache}}},function(e,t,a){"use strict";function r(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return f(e,Error)}}function n(e){return"[object ErrorEvent]"===Object.prototype.toString.call(e)}function s(e){return"[object DOMError]"===Object.prototype.toString.call(e)}function i(e){return"[object DOMException]"===Object.prototype.toString.call(e)}function o(e){return"[object String]"===Object.prototype.toString.call(e)}function l(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function h(e){return"undefined"!=typeof Event&&f(e,Event)}function d(e){return"undefined"!=typeof Element&&f(e,Element)}function u(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function m(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function p(e){return c(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function f(e,t){try{return e instanceof t}catch(e){return!1}}a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return i})),a.d(t,"k",(function(){return o})),a.d(t,"i",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"f",(function(){return h})),a.d(t,"c",(function(){return d})),a.d(t,"j",(function(){return u})),a.d(t,"m",(function(){return m})),a.d(t,"l",(function(){return p})),a.d(t,"g",(function(){return f}))},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(1),i=a(26),o=a(26),l=r(a(16)),c=a(5),h=a(5),d=a(8),u=a(10),m=n(a(18)),p=a(0),f=a(12),A=a(7),g=a(4),_=a(2),S=a(35),b=a(36);class v{constructor(){this.jointToParentMatrixArray=[],this.jointToWorldMatrixArray=[],this.drawViewMatrixArray=[],this.drawViewMatrixVisibility=[]}}t.ShapeInstanceState=v;class w{constructor(e,t,a,r){this.shape=a,this.shapeHelpers=[],this.sortKeyBias=0;for(let a=0;a<this.shape.mtxGroups.length;a++){const n=this.shape.mtxGroups[a],s=new h.GXShapeHelperGfx(e,t,r.shift(),this.shape.loadedVertexLayout,n.loadedVertexData);this.shapeHelpers.push(s)}}destroy(e){for(let t=0;t<this.shapeHelpers.length;t++)this.shapeHelpers[t].destroy(e)}}class x{constructor(e){this.material=e,this.fillMaterialParamsCallback=null}}t.MaterialData=x;class T{constructor(e=0,t=0){this.jointIndex=e,this.parentJointIndex=t}}function y(e,t){const a=Math.hypot(t[0],t[1],t[2]),r=Math.hypot(t[4],t[5],t[6]),n=Math.hypot(t[8],t[9],t[10]);e[0]=a,e[4]=0,e[8]=0,e[12]=t[12],e[1]=0,e[5]=r,e[9]=0,e[13]=t[13],e[2]=0,e[6]=0,e[10]=n,e[14]=t[14],e[3]=9999,e[7]=9999,e[11]=9999,e[15]=9999}t.J3DCalcBBoardMtx=y;const C=s.vec3.create();function M(e,t,a=C){const r=Math.hypot(t[0],t[1],t[2]),n=Math.hypot(t[8],t[9],t[10]);s.vec3.set(a,0,-t[6],t[5]),s.vec3.normalize(a,a),e[0]=r,e[4]=t[4],e[8]=0,e[12]=t[12],e[1]=0,e[5]=t[5],e[9]=a[1]*n,e[13]=t[13],e[2]=0,e[6]=t[6],e[10]=a[2]*n,e[14]=t[14],t[3]=9999,t[7]=9999,t[11]=9999,t[15]=9999}t.J3DCalcYBBoardMtx=M;const U=s.mat4.create(),k=new c.PacketParams;class D{constructor(e,t){this.shapeData=e,this.materialInstance=t,this.visible=!0}prepareToRender(e,t,a,r,n,i,o,l){if(!this.visible)return;const c=this.materialInstance;if(!c.visible)return;const h=this.shapeData.shape,d=c.materialData.material.index,u=i.materialJointIndices[d],m=l.jointToWorldMatrixArray[u];k.clear();const p=t.pushTemplateRenderInst();p.sortKey=c.sortKey,p.sortKey=A.setSortKeyDepth(p.sortKey,a),p.sortKey=A.setSortKeyBias(p.sortKey,this.shapeData.sortKeyBias),c.setOnRenderInst(e,t.gfxRenderCache,p);const f=3===h.displayFlags;f||c.fillMaterialParams(p,o,l.worldToViewMatrix,m,r,n,k);for(let e=0;e<h.mtxGroups.length;e++){const a=h.mtxGroups[e];let i=!1;for(let e=0;e<a.useMtxTable.length;e++){const t=a.useMtxTable[e];if(65535===t)continue;const r=l.drawViewMatrixArray[t],n=k.u_PosMtx[e];1===h.displayFlags?y(n,r):2===h.displayFlags?M(n,r):s.mat4.copy(n,r),l.drawViewMatrixVisibility[t]&&(i=!0)}if(!i)continue;const d=t.newRenderInst();this.shapeData.shapeHelpers[e].setOnRenderInst(d),this.shapeData.shapeHelpers[e].fillPacketParams(k,d),f&&c.fillMaterialParams(d,o,l.worldToViewMatrix,m,r,n,k),t.submitRenderInst(d)}t.popTemplateRenderInst()}}t.ShapeInstance=D;class I{constructor(){this.lights=p.nArray(8,()=>new l.Light)}}function R(e,t,a){const r=a[0],n=a[1],s=a[2],i=a[3],o=a[4],l=a[5],c=a[6],h=a[7],d=a[8],u=a[9],m=a[10],p=a[11],f=a[12],A=a[13],g=a[14],_=a[15],S=t[0],b=t[4],v=t[8],w=t[12];e[0]=S*r+b*n+v*s+w*i,e[4]=S*o+b*l+v*c+w*h,e[8]=S*d+b*u+v*m+w*p,e[12]=S*f+b*A+v*g+w*_;const x=t[1],T=t[5],y=t[9],C=t[13];e[1]=x*r+T*n+y*s+C*i,e[5]=x*o+T*l+y*c+C*h,e[9]=x*d+T*u+y*m+C*p,e[13]=x*f+T*A+y*g+C*_;const M=t[2],U=t[6],k=t[10],D=t[14];e[2]=M*r+U*n+k*s+D*i,e[6]=M*o+U*l+k*c+D*h,e[10]=M*d+U*u+k*m+D*p,e[14]=M*f+U*A+k*g+D*_}function B(e,t,a){const r=a[0],n=a[1],s=a[2],i=a[4],o=a[5],l=a[6],c=a[8],h=a[9],d=a[10],u=a[12],m=a[13],p=a[14],f=t[0],A=t[4],g=t[8],_=t[12];e[0]=f*r+A*n+g*s,e[4]=f*i+A*o+g*l,e[8]=f*c+A*h+g*d,e[12]=f*u+A*m+g*p+_;const S=t[1],b=t[5],v=t[9],w=t[13];e[1]=S*r+b*n+v*s,e[5]=S*i+b*o+v*l,e[9]=S*c+b*h+v*d,e[13]=S*u+b*m+v*p+w;const x=t[2],T=t[6],y=t[10],C=t[14];e[2]=x*r+T*n+y*s,e[6]=x*i+T*o+y*l,e[10]=x*c+T*h+y*d,e[14]=x*u+T*m+y*p+C}function P(e,t){s.mat4.copy(e,t),e[8]=e[12],e[9]=e[13],e[10]=1,e[12]=0,e[13]=0,e[14]=0}function E(e,t){s.mat4.copy(e,t)}t.MaterialInstanceState=I;const F=s.mat4.create();function V(e,t){t&&(_.texEnvMtx(F,1,1,0,1),s.mat4.mul(e,F,e))}function O(e,t){_.texEnvMtx(e,.5,.5*t,.5,.5),e[10]=1,e[14]=0}function N(e,t){_.texEnvMtx(e,.5,.5*t,.5,.5);const a=e[12];e[12]=e[8],e[8]=a;const r=e[13];e[13]=e[9],e[9]=r;const n=e[14];e[14]=e[10],e[10]=n}t.buildEnvMtx=N;const L=new c.MaterialParams,G=s.mat4.create(),H=s.mat4.create(),j=s.mat4.create(),W=s.mat4.create();class Z{constructor(e,t){this.colorCalc=[],this.texMtxCalc=[],this.texNoCalc=[],this.effectMtxCallback=null,this.visible=!0,this.sortKey=0,this.colorOverrides=p.nArray(c.ColorKind.COUNT,()=>null),this.fogBlock=new l.FogBlock,this.setMaterialData(e,t)}setMaterialData(e,t){this.materialData=e;const a=this.materialData.material;this.materialHelper=new h.GXMaterialHelperGfx(a.gxMaterial,t),this.name=a.name;let r=a.gxMaterial.ropInfo.depthTest?a.translucent?128:32:0;this.setSortKeyLayer(r)}setMaterialHacks(e){this.materialHelper.setMaterialHacks(e)}setColorOverride(e,t){this.colorOverrides[e]=t}setColorWriteEnabled(e){c.setChanWriteEnabled(this.materialHelper,7,e)}setAlphaWriteEnabled(e){c.setChanWriteEnabled(this.materialHelper,8,e)}setSortKeyLayer(e){this.materialData.material.translucent&&(e|=128),this.sortKey=A.setSortKeyLayer(this.sortKey,e)}bindTRK1(e,t){for(let a=0;a<c.ColorKind.COUNT;a++)if(null!==t){const r=o.bindTRK1Animator(e,t,this.name,a);null!==r&&(this.colorCalc[a]=r)}else this.colorCalc[a]=null}bindTTK1(e,t){for(let a=0;a<8;a++){const r=null!==t?o.bindTTK1Animator(e,t,this.name,a):null;this.texMtxCalc[a]=r}}bindTPT1(e,t){for(let a=0;a<8;a++){const r=null!==t?i.bindTPT1Animator(e,t,this.name,a):null;this.texNoCalc[a]=r}}clampTo8Bit(e){e.r=Math.max(e.r,0),e.g=Math.max(e.g,0),e.b=Math.max(e.b,0),e.a=Math.max(e.a,0)}setOnRenderInst(e,t,a){this.materialHelper.setOnRenderInst(e,t,a)}calcColor(e,t,a,r){this.colorCalc[t]?this.colorCalc[t].calcColor(e):null!==this.colorOverrides[t]?g.colorCopy(e,this.colorOverrides[t]):g.colorCopy(e,a),r&&this.clampTo8Bit(e)}calcTexMtxInput(e,t,a,r){switch(63&t.info){case 1:case 6:case 7:_.computeNormalMatrix(e,a,!0);break;case 2:case 8:s.mat4.copy(e,r);break;case 3:case 9:s.mat4.copy(e,a);break;case 5:case 10:case 11:_.computeNormalMatrix(e,r,!0);break;default:s.mat4.identity(e)}}calcPostTexMtxInput(e,t,a){switch(63&t.info){case 1:case 6:case 7:s.mat4.identity(e);break;case 2:case 8:s.mat4.invert(e,a);break;case 3:case 9:s.mat4.identity(e);break;case 5:case 10:case 11:s.mat4.invert(e,a),_.computeNormalMatrix(e,e,!0);break;default:s.mat4.identity(e)}}calcTexSRT(e,t){const a=this.materialData.material.texMatrices[t],r=this.texMtxCalc[t];r?r.calcTexMtx(e):s.mat4.copy(e,a.matrix)}calcTexMtx(e,t,a,r,n,i,o){const l=63&t.info,c=o?-1:1;let h=t.effectMatrix;(11===l||10===l)&&null!==this.effectMtxCallback&&(this.effectMtxCallback(W,t),h=W);const u=G,m=H;switch(l){case 1:E(u,a),B(e,u,e);break;case 2:case 3:case 5:E(m,a),V(e,o),R(u,m,t.effectMatrix),B(e,u,e);break;case 4:E(m,a),V(e,o),R(e,m,t.effectMatrix);break;case 6:E(u,a),O(m,c),B(u,u,m),B(e,u,e);break;case 7:P(u,a),N(m,c),B(u,u,m),B(e,u,e);break;case 8:case 9:case 11:P(m,a),9===l?(d.texProjCameraSceneTex(u,n,i,c),R(u,m,u)):8===l?(N(u,c),B(m,m,u),s.mat4.invert(u,r),s.mat4.mul(u,t.effectMatrix,u),R(u,m,u)):(N(u,c),B(m,m,u),R(u,m,h)),B(e,u,e);break;case 10:E(m,a),O(u,c),B(m,m,u),R(u,m,h),B(e,u,e);break;case 0:E(e,a),V(e,o);break;default:throw"whoops"}}fillOnMaterialParams(e,t,a,r,n,i,o=a.viewMatrix){const l=this.materialData.material;this.calcColor(e.u_Color[c.ColorKind.MAT0],c.ColorKind.MAT0,l.colorMatRegs[0],!1),this.calcColor(e.u_Color[c.ColorKind.MAT1],c.ColorKind.MAT1,l.colorMatRegs[1],!1),this.calcColor(e.u_Color[c.ColorKind.AMB0],c.ColorKind.AMB0,l.colorAmbRegs[0],!1),this.calcColor(e.u_Color[c.ColorKind.AMB1],c.ColorKind.AMB1,l.colorAmbRegs[1],!1),this.calcColor(e.u_Color[c.ColorKind.K0],c.ColorKind.K0,l.colorConstants[0],!0),this.calcColor(e.u_Color[c.ColorKind.K1],c.ColorKind.K1,l.colorConstants[1],!0),this.calcColor(e.u_Color[c.ColorKind.K2],c.ColorKind.K2,l.colorConstants[2],!0),this.calcColor(e.u_Color[c.ColorKind.K3],c.ColorKind.K3,l.colorConstants[3],!0),this.calcColor(e.u_Color[c.ColorKind.CPREV],c.ColorKind.CPREV,l.colorRegisters[3],!1),this.calcColor(e.u_Color[c.ColorKind.C0],c.ColorKind.C0,l.colorRegisters[0],!1),this.calcColor(e.u_Color[c.ColorKind.C1],c.ColorKind.C1,l.colorRegisters[1],!1),this.calcColor(e.u_Color[c.ColorKind.C2],c.ColorKind.C2,l.colorRegisters[2],!1);for(let a=0;a<l.textureIndexes.length;a++){const r=e.m_TextureMapping[a];let n;r.reset();const s=this.texNoCalc[a];n=s?s.calcTextureIndex():l.textureIndexes[a],n>=0&&r.copy(t.textureMappings[n])}s.mat4.mul(U,o,r);for(let t=0;t<l.texMatrices.length;t++){const s=l.texMatrices[t];if(null===s)continue;const i=e.u_TexMtx[t],o=e.m_TextureMapping[t].flipY;this.calcTexMtxInput(i,s,U,r);const c=j;this.calcTexSRT(c,t),this.calcTexMtx(i,s,c,r,a,n,o)}for(let t=0;t<l.indTexMatrices.length;t++){const a=l.indTexMatrices[t];null!==a&&c.fillIndTexMtx(e.u_IndTexMtx[t],a)}for(let a=0;a<t.lights.length;a++)e.u_Lights[a].copy(t.lights[a]);e.u_FogBlock.copy(this.fogBlock),null!==this.materialData.fillMaterialParamsCallback&&this.materialData.fillMaterialParamsCallback(e,this,o,r,a,n,i)}fillMaterialParams(e,t,a,r,n,s,i){this.fillOnMaterialParams(L,t,n,r,s,i,a);const o=e.allocateUniformBuffer(c.ub_MaterialParams,this.materialHelper.materialParamsBufferSize);this.materialHelper.fillMaterialParamsDataOnInst(e,o,L),e.setSamplerBindingsFromTextureMappings(L.m_TextureMapping)}}t.MaterialInstance=Z;class z{constructor(e,t,a){this.tex1=a,this.realized=!0,this.gfxSamplers=[],this.gfxTextures=[],this.viewerTextures=[];for(let a=0;a<this.tex1.samplers.length;a++){const r=this.tex1.samplers[a];this.gfxSamplers.push(b.translateSampler(e,t,r))}for(let t=0;t<this.tex1.textureDatas.length;t++){const a=this.tex1.textureDatas[t];if(null===a.data)this.gfxTextures.push(null),this.viewerTextures.push(null);else{const t=S.calcMipChain(a,a.mipCount),{viewerTexture:r,gfxTexture:n}=c.loadTextureFromMipChain(e,t);this.gfxTextures.push(n),this.viewerTextures.push(r)}}}fillTextureMappingFromIndex(e,t){const a=this.tex1.samplers[t];if(null===this.gfxTextures[a.textureDataIndex])return!1;const r=this.tex1.textureDatas[a.textureDataIndex];return e.gfxTexture=this.gfxTextures[a.textureDataIndex],e.gfxSampler=this.gfxSamplers[a.index],e.lodBias=a.lodBias,e.width=r.width,e.height=r.height,!0}destroy(e){if(this.realized){for(let t=0;t<this.gfxTextures.length;t++)null!==this.gfxTextures[t]&&e.destroyTexture(this.gfxTextures[t]);this.realized=!1}}}t.TEX1Data=z;class K{constructor(e,t,a){this.materialData=null,this.tex1Data=null;const r=a.mat3,n=a.tex1;if(null!==r){this.materialData=[];for(let e=0;e<r.materialEntries.length;e++)this.materialData.push(new x(r.materialEntries[e]))}null!==n&&(this.tex1Data=new z(e,t,n))}createDefaultTextureMappings(){const e=p.assertExists(this.tex1Data),t=p.nArray(e.tex1.samplers.length,()=>new u.TextureMapping);for(let a=0;a<e.tex1.samplers.length;a++)e.fillTextureMappingFromIndex(t[a],a);return t}destroy(e){null!==this.tex1Data&&this.tex1Data.destroy(e)}}t.BMDModelMaterialData=K;function X(e,t){const a=t.scaleX,r=t.scaleY,n=t.scaleZ,s=t.rotationX,i=t.rotationY,o=t.rotationZ,l=t.translationX,c=t.translationY,h=t.translationZ;_.computeModelMatrixSRT(e,a,r,n,s,i,o,l,c,h)}t.J3DModelData=class{constructor(e,t,a){this.bmd=a,this.realized=!1,this.shapeData=[],this.jointData=[],this.materialJointIndices=[],this.hasBillboard=!1,this.bbox=new f.AABB;const r=[];for(let e=0;e<a.shp1.shapes.length;e++)for(let t=0;t<a.shp1.shapes[e].mtxGroups.length;t++)r.push(a.shp1.shapes[e].mtxGroups[t].loadedVertexData);this.bufferCoalescer=c.loadedDataCoalescerComboGfx(e,r);for(let r=0;r<a.shp1.shapes.length;r++){const n=a.shp1.shapes[r];this.bbox.union(this.bbox,n.bbox),1!==n.displayFlags&&2!==n.displayFlags||(this.hasBillboard=!0),this.shapeData.push(new w(e,t,n,this.bufferCoalescer.coalescedBuffers))}this.modelMaterialData=new K(e,t,a),this.loadHierarchy(a.inf1),this.realized=!0}loadHierarchy(e){let t=0;const a=e.hierarchyData.createDataView();let r=0,n=new T(-1),s=[n];for(;;){const e=a.getUint16(t+0),o=a.getUint16(t+2);if(e===i.HierarchyNodeType.End)break;if(e===i.HierarchyNodeType.Open)s.unshift(n);else if(e===i.HierarchyNodeType.Close)s.shift();else if(e===i.HierarchyNodeType.Joint){const e=o,t=s[0].jointIndex;p.assert(e>t);const a=new T(e,t);this.jointData.push(a),n=a}else if(e===i.HierarchyNodeType.Material)p.assert(void 0===this.materialJointIndices[o]),this.materialJointIndices[o]=s[0].jointIndex;else if(e===i.HierarchyNodeType.Shape){const e=this.shapeData[o];this.modelMaterialData.materialData[e.shape.materialIndex].material.translucent&&(e.sortKeyBias=--r)}t+=4}p.assert(1===s.length),p.assert(0===this.jointData[0].jointIndex&&-1===this.jointData[0].parentJointIndex)}destroy(e){if(this.realized){this.bufferCoalescer.destroy(e);for(let t=0;t<this.shapeData.length;t++)this.shapeData[t].destroy(e);this.modelMaterialData.tex1Data.destroy(e),this.realized=!1}}};class Y{constructor(e,t){this.animationController=e,this.ank1=t}calcJointMatrix(e,t,a){const r=this.animationController.getTimeInFrames(),n=i.getAnimFrame(this.ank1,r),s=this.ank1.jointAnimationEntries[t];if(void 0!==s){const t=i.sampleAnimationData(s.scaleX,n),a=i.sampleAnimationData(s.scaleY,n),r=i.sampleAnimationData(s.scaleZ,n),o=i.sampleAnimationData(s.rotationX,n)*Math.PI,l=i.sampleAnimationData(s.rotationY,n)*Math.PI,c=i.sampleAnimationData(s.rotationZ,n)*Math.PI,h=i.sampleAnimationData(s.translationX,n),d=i.sampleAnimationData(s.translationY,n),u=i.sampleAnimationData(s.translationZ,n);_.computeModelMatrixSRT(e,t,a,r,o,l,c,h,d,u)}else X(e,a)}}t.JointMatrixCalcANK1=Y;class ${calcJointMatrix(e,t,a){X(e,a)}}t.JointMatrixCalcNoAnm=$;const q=new f.AABB,Q=s.mat4.create();class J{constructor(e,t){this.modelData=e,this.name="",this.visible=!0,this.modelMatrix=s.mat4.create(),this.baseScale=s.vec3.fromValues(1,1,1),this.jointMatrixCalcCallback=null,this.materialInstanceState=new I,this.shapeInstances=[],this.materialInstances=[],this.shapeInstanceState=new v,p.assert(this.modelData.realized),this.modelMaterialData=this.modelData.modelMaterialData,this.materialInstances=this.modelMaterialData.materialData.map(e=>new Z(e,t)),this.tex1Data=this.modelMaterialData.tex1Data,this.shapeInstances=this.modelData.shapeData.map(e=>new D(e,this.materialInstances[e.shape.materialIndex])),this.materialInstanceState.textureMappings=this.modelMaterialData.createDefaultTextureMappings();const a=this.modelData.bmd,r=a.jnt1.joints.length;this.shapeInstanceState.jointToParentMatrixArray=p.nArray(r,()=>s.mat4.create()),this.shapeInstanceState.jointToWorldMatrixArray=p.nArray(r,()=>s.mat4.create()),this.jointVisibility=p.nArray(r,()=>!0),this.jointMatrixCalc=new $,this.calcJointAnim();const n=a.drw1.matrixDefinitions.length-a.evp1.envelopes.length;this.shapeInstanceState.drawViewMatrixArray=p.nArray(n,()=>s.mat4.create()),this.shapeInstanceState.drawViewMatrixVisibility=p.nArray(n,()=>!0),this.shapeInstanceState.worldToViewMatrix=Q}destroy(e){this.modelData.destroy(e),this.tex1Data.destroy(e)}setVisible(e){this.visible=e}setModelMaterialData(e){if(this.modelMaterialData=e,null!==e.materialData){p.assert(e.materialData.length>=this.materialInstances.length);for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setMaterialData(e.materialData[t])}null!==e.tex1Data&&(this.materialInstanceState.textureMappings=this.modelMaterialData.createDefaultTextureMappings())}setMaterialHacks(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setMaterialHacks(e)}setSortKeyLayer(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setSortKeyLayer(e)}setVertexColorsEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setMaterialHacks({disableVertexColors:!e})}setTexturesEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setMaterialHacks({disableTextures:!e})}setLightingEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setMaterialHacks({disableLighting:!e})}getTextureMappingReference(e){const t=this.tex1Data.tex1.samplers;for(let a=0;a<t.length;a++)if(t[a].name===e)return this.materialInstanceState.textureMappings[a];return null}fillDefaultTextureMapping(e,t){const a=this.tex1Data.tex1.samplers.findIndex(e=>e.name===t);if(a<0)throw new Error(`Cannot find texture by name ${t}`);this.tex1Data.fillTextureMappingFromIndex(e,a)}setMaterialVisible(e,t){p.assertExists(this.materialInstances.find(t=>t.name===e)).visible=t}setMaterialColorWriteEnabled(e,t){p.assertExists(this.materialInstances.find(t=>t.name===e)).setColorWriteEnabled(t)}setColorOverride(e,t){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].setColorOverride(e,t)}setShapeVisible(e,t){this.shapeInstances[e].visible=t}getGXLightReference(e){return this.materialInstanceState.lights[e]}getJointToParentMatrixReference(e){const t=this.modelData.bmd.jnt1.joints;for(let a=0;a<t.length;a++)if(t[a].name===e)return this.shapeInstanceState.jointToParentMatrixArray[a];throw"could not find joint"}getJointToWorldMatrixReference(e){const t=this.modelData.bmd.jnt1.joints;for(let a=0;a<t.length;a++)if(t[a].name===e)return this.shapeInstanceState.jointToWorldMatrixArray[a];throw"could not find joint"}isAnyShapeVisible(){for(let e=0;e<this.shapeInstanceState.drawViewMatrixVisibility.length;e++)if(this.shapeInstanceState.drawViewMatrixVisibility[e])return!0;return!1}calcAnim(e){this.calcJointAnim(),this.calcJointToWorld()}calcView(e){const t=this.modelData.hasBillboard;d.computeViewMatrix(this.shapeInstanceState.worldToViewMatrix,e);const a=this.modelData.bmd.jnt1;for(let r=0;r<this.modelData.bmd.jnt1.joints.length;r++){const n=this.shapeInstanceState.jointToWorldMatrixArray[r];t||a.joints[r].bbox.isEmpty()?this.jointVisibility[r]=!0:(q.transform(a.joints[r].bbox,n),this.jointVisibility[r]=e.frustum.contains(q))}this.calcDrawMatrixArray(this.shapeInstanceState.worldToViewMatrix)}computeDepth(e){const t=this.modelData.bmd.jnt1.joints[0];return q.transform(t.bbox,this.modelMatrix),Math.max(d.computeViewSpaceDepthFromWorldSpaceAABB(e,q),0)}draw(e,t,a,r,n){if(!this.isAnyShapeVisible())return;const s=n?this.computeDepth(a):-1;for(let i=0;i<this.shapeInstances.length;i++){if(!this.shapeInstances[i].visible)continue;const o=this.shapeInstances[i].shapeData.shape.materialIndex;this.materialInstances[o].materialData.material.translucent===n&&this.shapeInstances[i].prepareToRender(e,t,s,a,r,this.modelData,this.materialInstanceState,this.shapeInstanceState)}}drawOpa(e,t,a,r){this.draw(e,t,a,r,!1)}drawXlu(e,t,a,r){this.draw(e,t,a,r,!0)}calcJointAnim(){for(let e=0;e<this.modelData.jointData.length;e++){const t=this.modelData.jointData[e].jointIndex,a=this.modelData.bmd.jnt1.joints[t];this.jointMatrixCalc.calcJointMatrix(this.shapeInstanceState.jointToParentMatrixArray[t],t,a),null!==this.jointMatrixCalcCallback&&this.jointMatrixCalcCallback(this.shapeInstanceState.jointToParentMatrixArray[t],t,a)}}calcJointToWorld(){for(let e=0;e<this.modelData.jointData.length;e++){const t=this.modelData.jointData[e],a=t.jointIndex,r=this.shapeInstanceState.jointToParentMatrixArray[a],n=this.shapeInstanceState.jointToWorldMatrixArray[a];if(t.parentJointIndex<0)s.mat4.identity(G),G[0]*=this.baseScale[0],G[5]*=this.baseScale[1],G[10]*=this.baseScale[2],s.mat4.mul(G,this.modelMatrix,G),s.mat4.mul(n,G,r);else{const e=this.shapeInstanceState.jointToWorldMatrixArray[t.parentJointIndex];s.mat4.mul(n,e,r)}}}calcDrawMatrixArray(e){const t=this.modelData.bmd.drw1,a=this.modelData.bmd.evp1;for(let r=0;r<this.shapeInstanceState.drawViewMatrixArray.length;r++){const n=t.matrixDefinitions[r],o=this.shapeInstanceState.drawViewMatrixArray[r];if(n.kind===i.DRW1MatrixKind.Joint){const t=this.jointVisibility[n.jointIndex];this.shapeInstanceState.drawViewMatrixVisibility[r]=t,s.mat4.mul(o,e,this.shapeInstanceState.jointToWorldMatrixArray[n.jointIndex])}else if(n.kind===i.DRW1MatrixKind.Envelope){o.fill(0);const t=a.envelopes[n.envelopeIndex];let i=!1;for(let e=0;e<t.weightedBones.length;e++){const a=t.weightedBones[e];if(this.jointVisibility[a.jointIndex]){i=!0;break}}this.shapeInstanceState.drawViewMatrixVisibility[r]=i;for(let e=0;e<t.weightedBones.length;e++){const r=t.weightedBones[e],n=a.inverseBinds[r.jointIndex];s.mat4.mul(G,this.shapeInstanceState.jointToWorldMatrixArray[r.jointIndex],n),s.mat4.multiplyScalarAndAdd(o,o,G,r.weight)}s.mat4.mul(o,e,o)}}}}t.J3DModelInstance=J;t.J3DModelInstanceSimple=class extends J{constructor(){super(...arguments),this.animationController=new m.default,this.vaf1Animator=null,this.passMask=1,this.ownedModelMaterialData=null,this.isSkybox=!1}setModelMaterialDataOwned(e){this.setModelMaterialData(e),p.assert(null===this.ownedModelMaterialData),this.ownedModelMaterialData=e}calcAnim(e){if(this.isSkybox&&(this.modelMatrix[12]=e.worldMatrix[12],this.modelMatrix[13]=e.worldMatrix[13],this.modelMatrix[14]=e.worldMatrix[14]),super.calcAnim(e),null!==this.vaf1Animator)for(let e=0;e<this.shapeInstances.length;e++)this.shapeInstances[e].visible=this.vaf1Animator.calcVisibility(e)}bindTTK1(e,t=this.animationController){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].bindTTK1(t,e)}bindTRK1(e,t=this.animationController){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].bindTRK1(t,e)}bindTPT1(e,t=this.animationController){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].bindTPT1(t,e)}bindANK1(e,t=this.animationController){this.jointMatrixCalc=null!==e?new Y(t,e):new $}bindVAF1(e,t=this.animationController){null!==e&&p.assert(e.visibilityAnimationTracks.length===this.shapeInstances.length),this.vaf1Animator=null!==e?i.bindVAF1Animator(t,e):null}prepareToRender(e,t,a){if(!this.visible)return;if(this.animationController.setTimeInMilliseconds(a.time),this.calcAnim(a.camera),this.calcView(a.camera),!this.isAnyShapeVisible())return;const r=this.computeDepth(a.camera);t.pushTemplateRenderInst().filterKey=this.passMask;for(let n=0;n<this.shapeInstances.length;n++)this.shapeInstances[n].prepareToRender(e,t,r,a.camera,a.viewport,this.modelData,this.materialInstanceState,this.shapeInstanceState);t.popTemplateRenderInst()}destroy(e){super.destroy(e),null!==this.ownedModelMaterialData&&this.ownedModelMaterialData.destroy(e)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(1),i=a(0),o=a(31),l=r(a(16)),c=a(5),h=a(12),d=a(30),u=a(2),m=n(a(60)),p=a(5),f=a(4),A=a(36),g=a(89);function _(e,t){const a=e.createDataView(t),r=a.getUint16(0);let n=4;const s=[];for(let o=0;o<r;o++){const r=a.getUint16(n+2),o=i.readString(e,t+r,255);s.push(o),n+=4}return s}class S{constructor(e){this.buffer=e,this.offs=32,this.view=this.buffer.createDataView(),this.magic=i.readString(this.buffer,0,8),this.size=this.view.getUint32(8),this.numChunks=this.view.getUint32(12),this.offs=32}maybeNextChunk(e,t=0){const a=this.offs;if(i.readString(this.buffer,a+0,4)===e){const e=this.view.getUint32(a+4)+t;return this.offs+=e,this.buffer.subarray(a,e)}return null}nextChunk(e,t=0){const a=this.offs,r=i.readString(this.buffer,a+0,4),n=this.view.getUint32(a+4)+t;return i.assert(r===e),this.offs+=n,this.buffer.subarray(a,n)}}var b,v;function w(e,t,a,r,n,i,o,l,c){const h=r*Math.PI,d=Math.sin(h),u=Math.cos(h);s.mat4.identity(e),e[0]=t*u,e[4]=t*-d,e[12]=n+o+t*(d*l-u*o),e[1]=a*d,e[5]=a*u,e[13]=i+l+-a*(-d*o+u*l)}function x(e,t,a,r,n,i){const o=r*Math.PI,l=Math.sin(o),c=Math.cos(o);s.mat4.identity(e),e[0]=t*c,e[1]=a*-l,e[12]=t*(-.5*c-(.5*l-.5)-n),e[4]=t*l,e[5]=a*c,e[13]=a*(-.5*c+(.5*l-.5)+i)+1}function T(e,t){return f.colorNewFromRGBA8(e.getUint32(t+0))}function y(e,t){const a=e.getInt16(t+0)/255,r=e.getInt16(t+2)/255,n=e.getInt16(t+4)/255,s=e.getInt16(t+6)/255;return f.colorNewFromRGBA(a,r,n,s)}function C(e){const t=e.createDataView(),a=t.getUint16(8),r=t.getUint32(16),n=[];for(let e=0;e<a;e++)n[e]=t.getUint16(r+2*e);const o=t.getUint32(20),c=_(e,o),h=t.getUint32(24),d=t.getUint32(28),u=t.getUint32(32),m=t.getUint32(36),A=t.getUint32(40),g=t.getUint32(44),S=t.getUint32(56),b=t.getUint32(60),v=t.getUint32(72),C=t.getUint32(64),M=t.getUint32(68),U=t.getUint32(76),k=t.getUint32(80),D=t.getUint32(84),I=t.getUint32(92),R=t.getUint32(96),B=t.getUint32(100),P=t.getUint32(104),E=t.getUint32(108),F=t.getUint32(112),V=t.getUint32(116),O=[],N=t.getUint32(12);for(let r=0;r<a;r++){const a=r,s=c[r],_=N+332*n[r],w=t.getUint8(_+0),x=t.getUint8(_+1),H=t.getUint8(_+2),j=(t.getUint8(_+3),t.getUint8(_+4),t.getUint8(_+6)),W=[];for(let e=0;e<2;e++){const a=t.getUint16(_+8+2*e),r=T(t,u+4*a);W[e]=r}const Z=[];for(let e=0;e<2;e++){const a=t.getUint16(_+20+2*e),r=T(t,g+4*a);Z[e]=r}const z=t.getUint8(m+H),K=[];for(let e=0;e<z;e++){const a=t.getInt16(_+12+2*(2*e+0)),r=L(A,a),n=t.getInt16(_+12+2*(2*e+1)),s=L(A,n);K.push({colorChannel:r,alphaChannel:s})}const X=[];for(let e=0;e<8;e++){const a=t.getInt16(_+40+2*e);if(a<0)continue;const r=t.getUint8(S+4*a+0),n=t.getUint8(S+4*a+1),s=t.getUint8(S+4*a+2);i.assert(255===t.getUint8(S+4*a+3));let o=125;const l=t.getInt16(_+56+2*e);b>0&&l>=0&&(o=t.getUint8(b+4*a+2),i.assert(255===t.getUint8(b+4*l+3)));const c=30+3*e;i.assert(60===s||s===c);const h={type:r,source:n,matrix:c,normalize:!1,postMatrix:o};X[e]=h}const Y=[];for(let e=0;e<10;e++){const a=t.getInt16(_+72+2*e);Y[e]=C>0&&a>=0?G(C,a):null}i.assert(null===Y[8]),i.assert(null===Y[9]);const $=[];for(let e=0;e<20;e++){const a=t.getInt16(_+92+2*e);$[e]=M>0&&a>=0?G(M,a):null}const q=[];for(let e=0;e<4;e++){const a=t.getUint16(_+148+2*e),r=T(t,D+4*a);q.push(r)}const Q=[];for(let e=0;e<4;e++){const a=t.getUint16(_+220+2*e),r=y(t,k+8*a);Q.push(r)}let J=_+132;const ee=[];for(let e=0;e<8;e++){const e=t.getInt16(J);if(e>=0){const a=t.getUint16(v+2*e);ee.push(a)}else ee.push(-1);J+=2}const te=[],ae=[],re=h+312*r,ne=h!==o;if(ne){const e=t.getUint8(re+0);i.assert(e<=4);for(let a=0;a<e;a++){const e=re+4+4*a,r=t.getUint8(e+0),n=t.getUint8(e+1),s=re+4+16+84+4*a,i=t.getUint8(s+0),o=t.getUint8(s+1);te.push({texCoordId:r,texture:n,scaleS:i,scaleT:o})}for(let e=0;e<3;e++){const a=re+4+16+28*e,r=t.getFloat32(a+0),n=t.getFloat32(a+4),s=t.getFloat32(a+8),i=t.getFloat32(a+12),o=t.getFloat32(a+16),l=t.getFloat32(a+20),c=Math.pow(2,t.getInt8(a+24)),h=new Float32Array([r*c,n*c,s*c,c,i*c,o*c,l*c,0]);ae.push(h)}}const se=[];for(let e=0;e<16;e++){const a=t.getInt16(_+228+2*e);if(a<0)continue;const r=I+20*a,n=t.getUint8(r+1),s=t.getUint8(r+2),o=t.getUint8(r+3),c=t.getUint8(r+4),h=t.getUint8(r+5),d=t.getUint8(r+6),u=t.getUint8(r+7),m=!!t.getUint8(r+8),p=t.getUint8(r+9),f=t.getUint8(r+10),A=t.getUint8(r+11),g=t.getUint8(r+12),S=t.getUint8(r+13),b=t.getUint8(r+14),v=t.getUint8(r+15),w=t.getUint8(r+16),x=!!t.getUint8(r+17),T=t.getUint8(r+18),y=U+4*t.getUint16(_+188+2*e),C=t.getUint8(y+0),M=t.getUint8(y+1),k=l.getRasColorChannelID(t.getUint8(y+2));i.assert(255===t.getUint8(y+3));const D=t.getUint8(_+156+e),P=t.getUint8(_+172+e),E=t.getUint16(_+260+2*e),F=t.getUint8(R+4*E+0),V=t.getUint8(R+4*E+1),O=t.getUint16(_+292+2*F),N=t.getUint16(_+292+2*V),L=[t.getUint8(B+4*O+0),t.getUint8(B+4*O+1),t.getUint8(B+4*O+2),t.getUint8(B+4*O+3)],G=[t.getUint8(B+4*N+0),t.getUint8(B+4*N+1),t.getUint8(B+4*N+2),t.getUint8(B+4*N+3)],H=re+4+16+84+16+12*e;let j=0,W=0,Z=0,z=0,K=0,X=0,Y=!1,$=!1;ne&&(j=t.getUint8(H+0),W=t.getUint8(H+1),Z=t.getUint8(H+2),z=t.getUint8(H+3),i.assert(z<=11),K=t.getUint8(H+4),X=t.getUint8(H+5),Y=!!t.getUint8(H+6),$=!!t.getUint8(H+7));const q={colorInA:n,colorInB:s,colorInC:o,colorInD:c,colorOp:h,colorBias:d,colorScale:u,colorClamp:m,colorRegId:p,alphaInA:f,alphaInB:A,alphaInC:g,alphaInD:S,alphaOp:b,alphaBias:v,alphaScale:w,alphaClamp:x,alphaRegId:T,texCoordId:C,texMap:M,channelId:k,konstColorSel:D,konstAlphaSel:P,rasSwapTable:L,texSwapTable:G,indTexStage:j,indTexFormat:W,indTexBiasSel:Z,indTexMatrix:z,indTexWrapS:K,indTexWrapT:X,indTexAddPrev:Y,indTexUseOrigLOD:$};se.push(q)}const ie=t.getUint16(_+326),oe=t.getUint16(_+328),le=E+8*ie,ce={compareA:t.getUint8(le+0),referenceA:t.getUint8(le+1)/255,op:t.getUint8(le+2),compareB:t.getUint8(le+3),referenceB:t.getUint8(le+4)/255},he=F+4*oe,de=t.getUint8(he+0),ue=t.getUint8(he+1),me=t.getUint8(he+2),pe=t.getUint8(he+3),fe=t.getUint32(d+4*x),Ae=V+4*j,ge=!!t.getUint8(Ae+0),_e=t.getUint8(Ae+1),Se=!!t.getUint8(Ae+2),be=P+44*t.getUint16(_+324),ve=t.getUint8(be+0),we=!!t.getUint8(be+1),xe=t.getUint16(be+2),Te=t.getFloat32(be+4),ye=t.getFloat32(be+8),Ce=t.getFloat32(be+12),Me=t.getFloat32(be+16),Ue=T(t,be+20),ke=e.createTypedArray(Uint16Array,be+24,10,1),De=new l.FogBlock;l.fogBlockSet(De,ve,Te,ye,Ce,Me),f.colorCopy(De.Color,Ue),De.AdjTable.set(ke),De.AdjCenter=xe;const Ie=!(3&w),Re={name:s,cullMode:fe,lightChannels:K,texGens:X,tevStages:se,indTexStages:te,alphaTest:ce,ropInfo:{fogType:ve,fogAdjEnabled:we,blendMode:de,blendSrcFactor:ue,blendDstFactor:me,blendLogicOp:pe,depthTest:ge,depthFunc:_e,depthWrite:Se}};p.autoOptimizeMaterial(Re),O.push({index:a,name:s,materialMode:w,translucent:Ie,textureIndexes:ee,texMatrices:Y,gxMaterial:Re,indTexMatrices:ae,colorMatRegs:W,colorAmbRegs:Z,colorRegisters:Q,colorConstants:q,fogBlock:De})}function L(e,a){const r=A+8*a,n=!!t.getUint8(r+0);i.assert(t.getUint8(r+0)<2);const s=t.getUint8(r+1),o=t.getUint8(r+2),l=t.getUint8(r+3),c=t.getUint8(r+4),h=0===c?2:1===c?0:2===c?2:3===c?1:-1;return i.assert(-1!==h),{lightingEnabled:n,matColorSource:s,ambColorSource:t.getUint8(r+5),litMask:o,diffuseFunction:l,attenuationFunction:h}}function G(e,a){const r=e+100*a,n=t.getUint8(r+0),o=t.getUint8(r+1),l=63&o;2!==l&&3!==l&&4!==l&&5!==l||console.log("Unusual matrix map mode:",l),i.assert(65535===t.getUint16(r+2));const c=t.getFloat32(r+4),h=t.getFloat32(r+8),d=(t.getFloat32(r+12),t.getFloat32(r+16)),u=t.getFloat32(r+20),m=t.getInt16(r+24)/32767;i.assert(65535===t.getUint16(r+26));const p=t.getFloat32(r+28),f=t.getFloat32(r+32),A=t.getFloat32(r+36),g=t.getFloat32(r+40),_=t.getFloat32(r+44),S=t.getFloat32(r+48),b=t.getFloat32(r+52),v=t.getFloat32(r+56),T=t.getFloat32(r+60),y=t.getFloat32(r+64),C=t.getFloat32(r+68),M=t.getFloat32(r+72),U=t.getFloat32(r+76),k=t.getFloat32(r+80),D=t.getFloat32(r+84),I=t.getFloat32(r+88),R=t.getFloat32(r+92),B=t.getFloat32(r+96),P=s.mat4.fromValues(A,b,C,D,g,v,M,I,_,T,U,R,S,y,k,B),E=s.mat4.create();return!!(o>>>7)?x(E,d,u,m,p,f):w(E,d,u,m,p,f,c,h),{info:o,projection:n,effectMatrix:P,matrix:E}}return{materialEntries:O}}function M(e){const t=e.createDataView(),a=t.getUint16(8),r=t.getUint32(12),n=_(e,t.getUint32(16)),s=[],i=[];for(let t=0;t<a;t++){const a=r+32*t,o=n[t],l=A.readBTI_Texture(e.slice(a),o);let c=-1;const h=l.data;if(h&&(c=i.findIndex(e=>e.data&&e.data.byteOffset===h.byteOffset)),c<0){const e={name:l.name,width:l.width,height:l.height,format:l.format,mipCount:l.mipCount,data:l.data,paletteFormat:l.paletteFormat,paletteData:l.paletteData};i.push(e),c=i.length-1}const d={index:t,name:l.name,wrapS:l.wrapS,wrapT:l.wrapT,minFilter:l.minFilter,magFilter:l.magFilter,minLOD:l.minLOD,maxLOD:l.maxLOD,lodBias:l.lodBias,textureDataIndex:c};s.push(d)}return{textureDatas:i,samplers:s}}t.JSystemFileReaderHelper=S,function(e){e[e.End=0]="End",e[e.Open=1]="Open",e[e.Close=2]="Close",e[e.Joint=16]="Joint",e[e.Material=17]="Material",e[e.Shape=18]="Shape"}(b=t.HierarchyNodeType||(t.HierarchyNodeType={})),function(e){e[e.Joint=0]="Joint",e[e.Envelope=1]="Envelope"}(v=t.DRW1MatrixKind||(t.DRW1MatrixKind={})),t.calcTexMtx_Basic=w,t.calcTexMtx_Maya=x;class U{static parseReader(e){const t=new U;t.inf1=function(e){const t=e.createDataView(),a=t.getUint32(8),r=(t.getUint32(12),t.getUint32(16),t.getUint32(20));return{hierarchyData:e.slice(r),loadFlags:a}}(e.nextChunk("INF1")),t.vtx1=function(e){const t=e.createDataView(),a=[9,10,25,11,12,13,14,15,16,17,18,19,20];let r=t.getUint32(8);const n=new Map;for(;;){const i=t.getUint32(r+0);if(255===i)break;const o=t.getUint32(r+4),l=t.getUint32(r+8),c=t.getUint8(r+12);r+=16;const h=a.indexOf(i);if(h<0)continue;const d=12+4*h,u=12+4*a.length,m=t.getUint32(d),p=m,f=s(d,u)-m,A={vtxAttrib:i,compType:l,compCnt:o,compShift:c,dataOffs:p,dataSize:f,buffer:e.subarray(p,f)};n.set(i,A)}function s(a,r){let n=a+4;for(;n<r;){const e=t.getUint32(n);if(0!==e)return e;n+=4}return e.byteLength}return{vertexArrays:n}}(e.nextChunk("VTX1")),t.evp1=function(e){const t=e.createDataView(),a=t.getUint16(8),r=t.getUint32(12),n=t.getUint32(16),i=t.getUint32(20),o=t.getUint32(24);let l=0,c=-1;const h=[];for(let e=0;e<a;e++){const a=t.getUint8(r+e),s=[];for(let e=0;e<a;e++){const e=t.getUint16(n+2*l),a=t.getFloat32(i+4*l);s.push({jointIndex:e,weight:a}),c=Math.max(c,e),l++}h.push({weightedBones:s})}const d=[];for(let e=0;e<c+1;e++){const a=o+48*e,r=t.getFloat32(a+0),n=t.getFloat32(a+4),i=t.getFloat32(a+8),l=t.getFloat32(a+12),c=t.getFloat32(a+16),h=t.getFloat32(a+20),u=t.getFloat32(a+24),m=t.getFloat32(a+28),p=t.getFloat32(a+32),f=t.getFloat32(a+36),A=t.getFloat32(a+40),g=t.getFloat32(a+44);d.push(s.mat4.fromValues(r,c,p,0,n,h,f,0,i,u,A,0,l,m,g,1))}return{envelopes:h,inverseBinds:d}}(e.nextChunk("EVP1")),t.drw1=function(e){const t=e.createDataView(),a=t.getUint16(8),r=t.getUint32(12),n=t.getUint32(16),s=[];for(let e=0;e<a;e++){const a=t.getUint8(r+e),i=t.getUint16(n+2*e);a===v.Joint?s.push({kind:a,jointIndex:i}):a===v.Envelope&&s.push({kind:a,envelopeIndex:i})}return{matrixDefinitions:s}}(e.nextChunk("DRW1")),t.jnt1=function(e){const t=e.createDataView(),a=t.getUint16(8);i.assert(65535===t.getUint16(10));const r=t.getUint32(12),n=t.getUint32(16),s=[];for(let e=0;e<a;e++)s[e]=t.getUint16(n+2*e);const o=_(e,t.getUint32(20)),l=[];for(let e=0;e<a;e++){const a=o[e],n=r+64*s[e],i=(t.getUint16(n+0),t.getUint8(n+2),t.getFloat32(n+4)),c=t.getFloat32(n+8),d=t.getFloat32(n+12),u=t.getInt16(n+16)/32767*Math.PI,m=t.getInt16(n+18)/32767*Math.PI,p=t.getInt16(n+20)/32767*Math.PI,f=t.getFloat32(n+24),A=t.getFloat32(n+28),g=t.getFloat32(n+32),_=t.getFloat32(n+36),S=t.getFloat32(n+40),b=t.getFloat32(n+44),v=t.getFloat32(n+48),w=t.getFloat32(n+52),x=t.getFloat32(n+56),T=t.getFloat32(n+60),y=new h.AABB(S,b,v,w,x,T);l.push({name:a,scaleX:i,scaleY:c,scaleZ:d,rotationX:u,rotationY:m,rotationZ:p,translationX:f,translationY:A,translationZ:g,boundingSphereRadius:_,bbox:y})}return{joints:l}}(e.nextChunk("JNT1")),t.shp1=function(e,t){const a=e.createDataView(),r=a.getUint16(8),n=a.getUint32(12),s=a.getUint32(16),l=a.getUint32(20),c=a.getUint32(24),d=a.getUint32(28),u=a.getUint32(32),m=a.getUint32(36),p=a.getUint32(40);for(let e=0;e<r;e++){const t=a.getUint16(s+2*e);i.assert(t===e)}0!==l&&console.log("Found a SHP1 that has a name table!");const f=[],A=[];for(const[e,a]of t.vtx1.vertexArrays.entries())f[e]={compCnt:a.compCnt,compType:a.compType,compShift:a.compShift},A[e]={buffer:a.buffer,offs:0,stride:o.getAttributeByteSize(f,e)};const g=[];let _=n;for(let t=0;t<r;t++){const t=a.getUint8(_+0);i.assert(255==a.getUint8(_+1));const r=a.getUint16(_+2),n=a.getUint16(_+4),s=a.getUint16(_+6),l=a.getUint16(_+8),S=[];let b=c+n;for(;;){const e=a.getUint32(b+0);if(255===e)break;const t=a.getUint32(b+4);S[e]={type:t},b+=8}const v=o.compileLoadedVertexLayout([f],S),w=o.compileVtxLoader(f,S);let x=p+8*l;const T=[];let y=0;for(let n=0;n<r;n++){const r=a.getUint32(x+0),o=u+a.getUint32(x+4),l=m+8*(s+n),c=a.getUint16(l+0),h=a.getUint16(l+2),p=d+2*a.getUint32(l+4),f=h,g=e.createTypedArray(Uint16Array,p,f,1);0===t&&(i.assert(1===h),i.assert(c===g[0]));const _=o,S=e.subarray(_,r),b=w.runVertices(A,S),v=y,C=b.totalIndexCount;y+=C,T.push({useMtxTable:g,indexOffset:v,indexCount:C,loadedVertexData:b}),x+=8}const C=a.getFloat32(_+12),M=a.getFloat32(_+16),U=a.getFloat32(_+20),k=a.getFloat32(_+24),D=a.getFloat32(_+28),I=a.getFloat32(_+32),R=a.getFloat32(_+36),B=new h.AABB(M,U,k,D,I,R),P=-1;g.push({displayFlags:t,loadedVertexLayout:v,mtxGroups:T,bbox:B,boundingSphereRadius:C,materialIndex:P}),_+=40}return{vat:f,shapes:g}}(e.nextChunk("SHP1"),t),t.mat3=C(e.nextChunk("MAT3"));e.maybeNextChunk("MDL3");return t.tex1=M(e.nextChunk("TEX1")),function(e){const t=e.inf1.hierarchyData.createDataView();let a=0,r=-1;for(;;){const n=t.getUint16(a+0),s=t.getUint16(a+2);if(n===b.End)break;if(n===b.Material)r=s;else if(n===b.Shape){const t=e.shp1.shapes[s];i.assert(-1!==r),i.assert(-1===t.materialIndex),t.materialIndex=r}a+=4}for(let t=0;t<e.shp1.shapes.length;t++)i.assert(-1!==e.shp1.shapes[t].materialIndex)}(t),t}static parse(e){const t=new S(e);return i.assert("J3D2bmd3"===t.magic||"J3D2bdl4"===t.magic),this.parseReader(t)}}t.BMD=U;class k{static parse(e){const t=new k,a=new S(e);i.assert("J3D2bmt3"===a.magic);const r=a.maybeNextChunk("MAT3");t.mat3=null!==r?C(r):null;const n=a.maybeNextChunk("TEX1");return t.tex1=null!==n?M(n):null,t}}function D(e,t,a=e.loopMode){const r=e.duration;return function(e,t){switch(t){case 0:return Math.min(e,1);case 1:return Math.min(e,1)%1;case 2:return e%1;case 3:return 1-Math.abs(Math.min(e,2)-1);case 4:return 1-Math.abs(e%2-1)}}(t/r,a)*r}function I(e,t){const a=e.frames,r=function(e,t){for(let a=0;a<e.length;a++)if(t<e[a].time)return a;return-1}(a,t);if(0===r)return a[0].value;if(r<0)return a[a.length-1].value;const n=a[r-1],s=a[r];return s.time-n.time==1?n.value:function(e,t,a){const r=t.time-e.time,n=e.value,s=t.value,i=e.tangentOut*r,o=t.tangentIn*r;return d.getPointHermite(n,s,i,o,a)}(n,s,(t-n.time)/(s.time-n.time))}function R(e,t,a,r,n){if(1===a){return{frames:[{time:0,value:e[r]*t,tangentIn:0,tangentOut:0}]}}{const s=[];if(0===n)for(let n=r;n<r+3*a;n+=3){const a=e[n+0],r=e[n+1]*t,i=e[n+2]*t,o=i;s.push({time:a,value:r,tangentIn:i,tangentOut:o})}else if(1===n)for(let n=r;n<r+4*a;n+=4){const a=e[n+0],r=e[n+1]*t,i=e[n+2]*t,o=e[n+3]*t;s.push({time:a,value:r,tangentIn:i,tangentOut:o})}return{frames:s}}}t.BMT=k,t.getAnimFrame=D,t.sampleAnimationData=I;class B{constructor(e,t,a){this.animationController=e,this.ttk1=t,this.animationEntry=a}calcTexMtx(e){const t=this.animationController.getTimeInFrames(),a=D(this.ttk1,t),r=I(this.animationEntry.scaleS,a),n=I(this.animationEntry.scaleT,a),s=I(this.animationEntry.rotationQ,a),i=I(this.animationEntry.translationS,a),o=I(this.animationEntry.translationT,a);if(this.ttk1.isMaya)x(e,r,n,s,i,o);else{const t=this.animationEntry.centerS,a=this.animationEntry.centerT;this.animationEntry.centerQ;w(e,r,n,s,i,o,t,a)}}}t.TTK1Animator=B,t.bindTTK1Animator=function(e,t,a,r){const n=t.uvAnimationEntries.find(e=>e.materialName===a&&e.texGenIndex===r);return void 0===n?null:new B(e,t,n)};t.BTK=class{static parse(e){const t=new S(e);return i.assert("J3D1btk1"===t.magic),function(e){const t=e.createDataView(),a=t.getUint8(8),r=t.getUint8(9),n=t.getUint16(10),s=t.getUint16(12)/3,i=t.getUint16(14),o=t.getUint16(16),l=t.getUint16(18),c=t.getUint32(20),h=(t.getUint32(24),t.getUint32(28)),d=t.getUint32(32),u=t.getUint32(36),m=t.getUint32(40),p=t.getUint32(44),f=t.getUint32(48),A=1===t.getUint32(92),g=Math.pow(2,r)/32767,S=e.createTypedArray(Float32Array,m,i,1),b=e.createTypedArray(Int16Array,p,o,1),v=e.createTypedArray(Float32Array,f,l,1),w=_(e,h);let x=c;function T(e,a){const r=t.getUint16(x+0),n=t.getUint16(x+2),s=t.getUint16(x+4);return x+=6,R(e,a,r,n,s)}const y=[];for(let e=0;e<s;e++){const a=w[e],r=t.getUint8(d+e),n=t.getFloat32(u+12*e+0),s=t.getFloat32(u+12*e+4),i=t.getFloat32(u+12*e+8),o=T(S,1),l=T(b,g),c=T(v,1),h=T(S,1),m=T(b,g),p=T(v,1),f=T(S,1),A=T(b,g),_=T(v,1);y.push({materialName:a,texGenIndex:r,centerS:n,centerT:s,centerQ:i,scaleS:o,rotationS:l,translationS:c,scaleT:h,rotationT:m,translationT:p,scaleQ:f,rotationQ:A,translationQ:_})}return{duration:n,loopMode:a,isMaya:A,uvAnimationEntries:y}}(t.nextChunk("TTK1",-4))}};class P{constructor(e,t,a){this.animationController=e,this.trk1=t,this.animationEntry=a}calcColor(e){const t=this.animationController.getTimeInFrames(),a=D(this.trk1,t);e.r=I(this.animationEntry.r,a),e.g=I(this.animationEntry.g,a),e.b=I(this.animationEntry.b,a),e.a=I(this.animationEntry.a,a)}}t.TRK1Animator=P,t.bindTRK1Animator=function(e,t,a,r){const n=t.animationEntries.find(e=>e.materialName===a&&e.colorKind===r);return void 0===n?null:new P(e,t,n)};t.BRK=class{static parse(e){const t=new S(e);return i.assert("J3D1brk1"===t.magic),function(e){const t=e.createDataView(),a=t.getUint8(8),r=t.getUint16(10),n=t.getUint16(12),s=t.getUint16(14),i=t.getUint16(16),o=t.getUint16(18),l=t.getUint16(20),h=t.getUint16(22),d=t.getUint16(24),u=t.getUint16(26),m=t.getUint16(28),p=t.getUint16(30),f=t.getUint32(32),A=t.getUint32(36),g=(t.getUint32(40),t.getUint32(44),t.getUint32(48)),S=t.getUint32(52),b=t.getUint32(56),v=t.getUint32(60),w=t.getUint32(64),x=t.getUint32(68),T=t.getUint32(72),y=t.getUint32(76),C=t.getUint32(80),M=t.getUint32(84),U=_(e,g),k=_(e,S);let D;function I(e){const a=t.getUint16(D+0),r=t.getUint16(D+2),n=t.getUint16(D+4);return D+=6,R(e,1/255,a,r,n)}const B=[],P=e.createTypedArray(Int16Array,b,i,1),E=e.createTypedArray(Int16Array,v,o,1),F=e.createTypedArray(Int16Array,w,l,1),V=e.createTypedArray(Int16Array,x,h,1);D=f;for(let e=0;e<n;e++){const a=U[e],r=I(P),n=I(E),s=I(F),i=I(V),o=t.getUint8(D),l=c.ColorKind.C0+o;D+=4,B.push({materialName:a,colorKind:l,r:r,g:n,b:s,a:i})}const O=e.createTypedArray(Int16Array,T,d,1),N=e.createTypedArray(Int16Array,y,u,1),L=e.createTypedArray(Int16Array,C,m,1),G=e.createTypedArray(Int16Array,M,p,1);D=A;for(let e=0;e<s;e++){const a=k[e],r=I(O),n=I(N),s=I(L),i=I(G),o=t.getUint8(D),l=c.ColorKind.K0+o;D+=4,B.push({materialName:a,colorKind:l,r:r,g:n,b:s,a:i})}return{duration:r,loopMode:a,animationEntries:B}}(t.nextChunk("TRK1"))}};t.BPK=class{static parse(e){const t=new S(e);return i.assert("J3D1bpk1"===t.magic),function(e){const t=e.createDataView(),a=t.getUint8(8),r=t.getUint16(12),n=t.getUint16(14),s=t.getUint16(16),i=t.getUint16(18),o=t.getUint16(20),l=t.getUint16(22),h=t.getUint32(24),d=(t.getUint32(28),t.getUint32(32)),u=t.getUint32(36),m=t.getUint32(40),p=t.getUint32(44),f=t.getUint32(48),A=_(e,d);let g;function S(e){const a=t.getUint16(g+0),r=t.getUint16(g+2),n=t.getUint16(g+4);return g+=6,R(e,1/255,a,r,n)}const b=[],v=e.createTypedArray(Int16Array,u,s,1),w=e.createTypedArray(Int16Array,m,i,1),x=e.createTypedArray(Int16Array,p,o,1),T=e.createTypedArray(Int16Array,f,l,1);g=h;for(let e=0;e<n;e++){const t=A[e],a=S(v),r=S(w),n=S(x),s=S(T),i=c.ColorKind.MAT0;b.push({materialName:t,colorKind:i,r:a,g:r,b:n,a:s})}return{duration:r,loopMode:a,animationEntries:b}}(t.nextChunk("PAK1"))}},t.calcJointMatrix=function(e,t,a,r){let n,s,i,o,l,c,h,d,m,p=null;if(null!==r&&(p=r.ank1.jointAnimationEntries[t]||null),null!==p){const e=r.animationController.getTimeInFrames(),t=D(r.ank1,e);n=I(p.scaleX,t),s=I(p.scaleY,t),i=I(p.scaleZ,t),o=I(p.rotationX,t)*Math.PI,l=I(p.rotationY,t)*Math.PI,c=I(p.rotationZ,t)*Math.PI,h=I(p.translationX,t),d=I(p.translationY,t),m=I(p.translationZ,t)}else{const e=a.jnt1.joints[t];n=e.scaleX,s=e.scaleY,i=e.scaleZ,o=e.rotationX,l=e.rotationY,c=e.rotationZ,h=e.translationX,d=e.translationY,m=e.translationZ}u.computeModelMatrixSRT(e,n,s,i,o,l,c,h,d,m)};class E{constructor(e,t){this.animationController=e,this.ank1=t}}t.ANK1Animator=E,t.bindANK1Animator=function(e,t){return new E(e,t)};t.BCK=class{static parse(e){const t=new S(e);return i.assert("J3D1bck1"===t.magic),function(e){const t=e.createDataView(),a=t.getUint8(8),r=t.getUint8(9),n=t.getUint16(10),s=t.getUint16(12),i=t.getUint16(14),o=t.getUint16(16),l=t.getUint16(18),c=t.getUint32(20),h=t.getUint32(24),d=t.getUint32(28),u=t.getUint32(32),m=Math.pow(2,r)/32767,p=e.createTypedArray(Float32Array,h,i,1),f=e.createTypedArray(Int16Array,d,o,1),A=e.createTypedArray(Float32Array,u,l,1);let g=c;function _(e,a){const r=t.getUint16(g+0),n=t.getUint16(g+2),s=t.getUint16(g+4);return g+=6,R(e,a,r,n,s)}const S=[];for(let e=0;e<s;e++){const e=_(p,1),t=_(f,m),a=_(A,1),r=_(p,1),n=_(f,m),s=_(A,1),i=_(p,1),o=_(f,m),l=_(A,1);S.push({scaleX:e,rotationX:t,translationX:a,scaleY:r,rotationY:n,translationY:s,scaleZ:i,rotationZ:o,translationZ:l})}return{loopMode:a,duration:n,jointAnimationEntries:S}}(t.nextChunk("ANK1"))}};class F{constructor(e,t,a){this.animationController=e,this.tpt1=t,this.animationEntry=a}calcTextureIndex(){const e=this.animationController.getTimeInFrames(),t=D(this.tpt1,e);return this.animationEntry.textureIndices[0|t]}}t.TPT1Animator=F,t.bindTPT1Animator=function(e,t,a,r){const n=t.animationEntries.find(e=>e.materialName===a&&e.texMapIndex===r);return void 0===n?null:new F(e,t,n)};t.BTP=class{static parse(e){const t=new S(e);return i.assert("J3D1btp1"===t.magic),function(e){const t=e.createDataView(),a=t.getUint8(8),r=t.getUint16(10),n=t.getUint16(12),s=(t.getUint16(14),t.getUint32(16)),i=t.getUint32(20),o=(t.getUint32(24),_(e,t.getUint32(28)));let l;const c=[];l=s;for(let e=0;e<n;e++){const a=o[e],r=t.getUint16(l+0),n=t.getUint16(l+2),s=t.getUint8(l+4),h=[];for(let e=0;e<r;e++){const a=t.getUint16(i+2*(n+e));h.push(a)}c.push({materialName:a,texMapIndex:s,textureIndices:h}),l+=8}return{duration:r,loopMode:a,animationEntries:c}}(t.nextChunk("TPT1"))}};class V{constructor(e,t){this.animationController=e,this.vaf1=t}calcVisibility(e){const t=this.animationController.getTimeInFrames(),a=D(this.vaf1,t);return g.VAF1_getVisibility(this.vaf1,e,a)}}t.VAF1Animator=V,t.bindVAF1Animator=function(e,t){return new V(e,t)};t.BVA=class{static parse(e){const t=new S(e);return i.assert("J3D1bva1"===t.magic),function(e){const t=e.createDataView(),a=t.getUint8(8),r=t.getUint16(10),n=t.getUint16(12),s=(t.getUint16(14),t.getUint32(16)),o=t.getUint32(20);let l=s;const c=[];for(let e=0;e<n;e++){const e=t.getUint16(l+0),a=t.getUint16(l+2);i.assert(e>0);const r=new m.default(e);for(let n=0;n<e;n++){const e=!!t.getUint8(o+a+n);r.setBit(n,e)}c.push({shapeVisibility:r}),l+=4}return{loopMode:a,duration:r,visibilityAnimationTracks:c}}(t.nextChunk("VAF1"))}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=a(87),i=r(a(15)),o=r(a(88)),l=s.yaz0_asInstance();function c(e,t){const a=t.createDataView();n.assert("Yaz0"===n.readString(t,0,4));const r=a.getUint32(4,!1),s=t.byteLength,l=n.align(r,16),c=l+n.align(s,16),h=new o.default(e.memory).resize(c);h.set(t.createTypedArray(Uint8Array,16),l),e.decompress(0,l,r);const d=new i.default(h.buffer).copyToBuffer(0,r);return new i.default(d)}t.decompressSync=c,t.decompress=async function(e){return c(await l,e)},t.decompressor=function(){return l}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(108)),s=a(0);t.getJMapInfoArg0=function(e){return e.getValueNumberNoInit("Obj_arg0")},t.getJMapInfoArg1=function(e){return e.getValueNumberNoInit("Obj_arg1")},t.getJMapInfoArg2=function(e){return e.getValueNumberNoInit("Obj_arg2")},t.getJMapInfoArg3=function(e){return e.getValueNumberNoInit("Obj_arg3")},t.getJMapInfoArg4=function(e){return e.getValueNumberNoInit("Obj_arg4")},t.getJMapInfoArg5=function(e){return e.getValueNumberNoInit("Obj_arg5")},t.getJMapInfoArg6=function(e){return e.getValueNumberNoInit("Obj_arg6")},t.getJMapInfoArg7=function(e){return e.getValueNumberNoInit("Obj_arg7")},t.getJMapInfoBool=function(e){return-1!==e},t.getJMapInfoTransLocal=function(e,t){e[0]=s.fallback(t.getValueNumber("pos_x"),0),e[1]=s.fallback(t.getValueNumber("pos_y"),0),e[2]=s.fallback(t.getValueNumber("pos_z"),0)},t.getJMapInfoRotateLocal=function(e,t){e[0]=.01745*s.fallback(t.getValueNumber("dir_x"),0),e[1]=.01745*s.fallback(t.getValueNumber("dir_y"),0),e[2]=.01745*s.fallback(t.getValueNumber("dir_z"),0)},t.getJMapInfoScale=function(e,t){e[0]=s.fallback(t.getValueNumber("scale_x"),1),e[1]=s.fallback(t.getValueNumber("scale_y"),1),e[2]=s.fallback(t.getValueNumber("scale_z"),1)},t.getJMapInfoGroupId=function(e){const t=e.getValueNumber("GroupId");return null!==t?t:e.getValueNumber("ClippingGroupId")};class i{constructor(e,t){this.bcsv=e,this.record=t}getNumRecords(){return this.bcsv.records.length}setRecord(e){this.record=this.bcsv.records[e]}findRecord(e){for(let t=0;t<this.bcsv.records.length;t++)if(this.setRecord(t),e(this,t))return!0;return!1}mapRecords(e){const t=[];for(let a=0;a<this.bcsv.records.length;a++)this.setRecord(a),t.push(e(this,a));return t}getValueString(e){return n.getField(this.bcsv,this.record,e)}getValueNumber(e){return n.getField(this.bcsv,this.record,e)}getValueNumberNoInit(e){const t=n.getField(this.bcsv,this.record,e);return-1===t?null:t}}t.JMapInfoIter=i,t.createCsvParser=function(e){const t=n.parse(e);return new i(t,t.records[0])}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(59)),i=a(0),o=r(a(16)),l=a(31),c=a(16),h=a(31),d=a(1),u=a(12),m=a(37),p=a(38),f=a(30),A=a(4),g=a(2),_=n(a(60)),S=a(5);function b(e,t,a,r,n,s,i){switch(t){case-1:return function(e,t,a,r,n,s){const i=.01745*r,o=Math.sin(i),l=Math.cos(i);d.mat4.identity(e),e[0]=t*l,e[4]=a*-o,e[12]=n,e[1]=t*o,e[5]=a*l,e[13]=s}(e,a,r,n,s,i);case 0:return function(e,t,a,r,n,s){const i=.01745*r,o=Math.sin(i),l=Math.cos(i);d.mat4.identity(e);const c=.5*o-.5,h=-.5*l;e[0]=t*l,e[4]=t*o,e[12]=t*(h-c-n),e[1]=a*-o,e[5]=a*l,e[13]=a*(h+c+s)+1}(e,a,r,n,s,i);case 1:return function(e,t,a,r,n,s){const i=.01745*r,o=Math.sin(i),l=Math.cos(i);d.mat4.identity(e),e[0]=t*l,e[4]=t*-o,e[12]=t*o-t*l*n-t*o*s,e[1]=a*o,e[5]=a*l,e[13]=a*-l-a*o*n+a*l*s+1}(e,a,r,n,s,i);case 2:return function(e,t,a,r,n,s){const i=.01745*r,o=Math.sin(i),l=Math.cos(i);d.mat4.identity(e),e[0]=t*l,e[4]=t*o,e[12]=t*(-l*(n+.5)+o*(s-.5))+.5,e[1]=a*-o,e[5]=a*l,e[13]=a*(o*(n+.5)+l*(s-.5))+.5}(e,a,r,n,s,i);default:throw"whoops"}}function v(e,t){if(0===t)return[];const a=e.createDataView(),r=(a.getUint32(t+0),a.getUint32(t+4)),n=[];let s=t+8;s+=16;for(let o=0;o<r;o++){const r=i.readString(e,t+a.getUint32(s+8)),o=t+a.getUint32(s+12);n.push({name:r,offs:o}),s+=16}return n}function w(e){const t=e.createDataView();i.assert("PLT0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([1,3].includes(a));const r=t.getUint32(16),n=t.getUint32(20),s=i.readString(e,n),o=t.getUint32(24),l=t.getUint16(28);return{name:s,format:o,data:e.subarray(r,2*l)}}function x(e){const t=e.createDataView();i.assert("TEX0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([1,3].includes(a));const r=t.getUint32(16),n=t.getUint32(20),s=i.readString(e,n);t.getUint32(24);return{name:s,width:t.getUint16(28),height:t.getUint16(30),format:t.getUint32(32),mipCount:t.getUint32(36),minLOD:1*t.getFloat32(40)/8,maxLOD:1*t.getFloat32(44)/8,data:e.subarray(r),paletteFormat:null,paletteData:null}}function T(e,t,a,r,n,s){const i=c.parseTexGens(e,r),o=c.parseTevStages(e,n),l=c.parseIndirectStages(e,s),h=c.parseRopInfo(e),d={name:a,lightChannels:[],cullMode:0,tevStages:o,texGens:i,indTexStages:l,alphaTest:c.parseAlphaTest(e),ropInfo:h};return S.autoOptimizeMaterial(d),d}function y(e,t){const a=e.createDataView(),r=(a.getUint32(0),a.getUint32(8)),n=i.readString(e,r),o=a.getUint32(12),h=!!(2147483648&a.getUint32(16)),u=a.getUint8(20),m=a.getUint8(21),p=a.getUint8(22),f=a.getUint8(23),g=a.getUint32(24),_=(a.getUint8(28),a.getInt8(29)),S=a.getInt8(30),v=(a.getUint8(32),a.getUint8(33),a.getUint8(34),a.getUint8(35),a.getUint8(36),a.getUint8(37),a.getUint8(38),a.getUint8(39),a.getUint32(40));i.assert(p<=16);const w=a.getUint32(44),x=a.getUint32(48);let y=52;t>=10&&(y+=4),y+=4;const C=new l.DisplayListRegisters,M=a.getUint32(y);l.displayListRegistersRun(C,e.subarray(M,384)),function(e,t,a){const r=e.createDataView(),n=r.getUint32(0);i.assert(512===n),r.getUint32(8);const s=r.getUint8(12);i.assert(s===a),l.displayListRegistersRun(t,e.subarray(32,480))}(e.subarray(v),C,p);const U=T(C,0,n,u,p,f);U.cullMode=g;const k=[];for(let e=0;e<3;e++){const t=10,a=17,r=3*e,n=C.bp[s.BPRegister.IND_MTXA0_ID+r],i=C.bp[s.BPRegister.IND_MTXB0_ID+r],o=C.bp[s.BPRegister.IND_MTXC0_ID+r],l=(o>>>22&3)<<4|(i>>>22&3)<<2|n>>>22&3,c=Math.pow(2,l-a-t),h=new Float32Array([((n>>>0&2047)<<21>>21)*c,((i>>>0&2047)<<21>>21)*c,((o>>>0&2047)<<21>>21)*c,c,((n>>>11&2047)<<21>>21)*c,((i>>>11&2047)<<21>>21)*c,((o>>>11&2047)<<21>>21)*c,0]);k.push(h)}const D=[],I=[];for(let e=0;e<8;e++){const t=C.kc[2*e+0],a=C.kc[2*e+1],r=(t>>>0&2047)/255,n=(t>>>12&2047)/255,s=(a>>>0&2047)/255,i=(a>>>12&2047)/255,o=A.colorNewFromRGBA(r,i,s,n);e<4?D[e]=o:I[e-4]=o}const R=[],B=[];let P=y+948;for(let e=0;e<2;e++){a.getUint32(P+0);const t=a.getUint8(P+4)/255,r=a.getUint8(P+5)/255,n=a.getUint8(P+6)/255,s=a.getUint8(P+7)/255,i=a.getUint8(P+8)/255,o=a.getUint8(P+9)/255,l=a.getUint8(P+10)/255,h=a.getUint8(P+11)/255,d=a.getUint32(P+12),u=a.getUint32(P+16),p=c.parseColorChannelControlRegister(d),f=c.parseColorChannelControlRegister(u);R.push(A.colorNewFromRGBA(t,r,n,s)),B.push(A.colorNewFromRGBA(i,o,l,h)),e<m&&U.lightChannels.push({colorChannel:p,alphaChannel:f}),P+=20}const E=[];for(let t=0;t<w;t++){const r=x+52*t,n=a.getUint32(r+0),s=a.getUint32(r+4),o=a.getUint32(r+16),l=(a.getUint32(r+20),a.getUint32(r+24)),c=a.getUint32(r+28),h=a.getUint32(r+32),d=a.getUint32(r+36),u=a.getFloat32(r+40),m=(a.getUint32(r+44),a.getUint8(r+48),a.getUint8(r+49),i.readString(e,r+n)),p=0!==s?i.readString(e,r+s):null;E[o]={name:m,namePalette:p,lodBias:u,wrapS:l,wrapT:c,minFilter:h,magFilter:d}}a.getUint32(y+364);const F=a.getUint32(y+368);let V=y+372,O=y+532;const N=[];for(let e=0;e<8;e++){const t=a.getFloat32(V+0),r=a.getFloat32(V+4),n=a.getFloat32(V+8),s=a.getFloat32(V+12),i=a.getFloat32(V+16),o=a.getInt8(O+0),l=a.getInt8(O+1),c=a.getInt8(O+2),h=(a.getInt8(O+3),a.getFloat32(O+4)),u=a.getFloat32(O+8),m=a.getFloat32(O+12),p=a.getFloat32(O+16),f=a.getFloat32(O+20),A=a.getFloat32(O+24),g=a.getFloat32(O+28),_=a.getFloat32(O+32),S=a.getFloat32(O+36),v=a.getFloat32(O+40),w=a.getFloat32(O+44),x=a.getFloat32(O+48),T=d.mat4.fromValues(h,f,S,0,u,A,v,0,m,g,w,0,p,_,x,1);switch(c){case 0:break;case 2:U.texGens[e].matrix=0;break;case 1:case 3:U.texGens[e].matrix=30+3*e}const y=d.mat4.create();b(y,F,t,r,n,s,i);const C={refCamera:o,refLight:l,mapMode:c,srtMtx:y,effectMtx:T};N.push(C),V+=20,O+=52}return{index:o,name:n,translucent:h,lightSetIdx:_,fogIdx:S,gxMaterial:U,samplers:E,texSrts:N,indTexMatrices:k,colorMatRegs:R,colorAmbRegs:B,colorRegisters:D,colorConstants:I}}function C(e,t){const a=e.createDataView(),r=a.getUint32(8),n=a.getUint32(12),s=i.readString(e,n),o=a.getUint32(16),l=a.getUint32(20),c=a.getUint32(24);let d=a.getUint8(28),u=a.getUint8(29);const m=a.getUint16(30);11===t&&(u=d,d=0);const f=p.getFormatCompFlagsComponentCount(h.getAttributeFormatCompFlagsRaw(t,l))*h.getAttributeComponentByteSizeRaw(c)*m+4;return{name:s,id:o,compCnt:l,compType:c,compShift:d,stride:u,count:m,buffer:e.subarray(r,f),offs:0}}function M(e,t,a){const r=[];for(let n=0;n<a.length;n++){const s=a[n],o=C(e.subarray(s.offs),t);i.assert(o.name===s.name),i.assert(o.id===n),r.push(o)}return r}function U(e,t){const a=e.createDataView(),r=a.getInt32(8),n=a.getUint32(24),o=(a.getUint32(28),24+a.getUint32(32)),c=a.getUint32(36),d=(a.getUint32(40),36+a.getUint32(44)),u=(a.getUint32(48),a.getUint32(52),a.getUint32(56)),m=i.readString(e,u),p=(a.getUint32(60),a.getUint32(64)),f=(a.getUint32(68),a.getInt16(72));i.assert(f>=0);const A=a.getInt16(74),g=a.getInt16(76),_=a.getInt16(78),S=a.getInt16(80),b=a.getInt16(82),v=a.getInt16(84),w=a.getInt16(86),x=a.getInt16(88),T=a.getInt16(90),y=a.getInt16(92),C=a.getInt16(94),M=(a.getInt16(96),a.getInt16(98),a.getUint32(100),new l.DisplayListRegisters);l.displayListRegistersRun(M,e.subarray(o,n));const U=M.cp[s.CPRegister.VCD_LO_ID],k=M.cp[s.CPRegister.VCD_HI_ID],D=[];D[0]={type:U>>>0&1},D[1]={type:U>>>1&1},D[2]={type:U>>>2&1},D[3]={type:U>>>3&1},D[4]={type:U>>>4&1},D[5]={type:U>>>5&1},D[6]={type:U>>>6&1},D[7]={type:U>>>7&1},D[8]={type:U>>>8&1},D[9]={type:U>>>9&3},D[10]={type:U>>>11&3},D[11]={type:U>>>13&3},D[12]={type:U>>>15&3},D[13]={type:k>>>0&3},D[14]={type:k>>>2&3},D[15]={type:k>>>4&3},D[16]={type:k>>>6&3},D[17]={type:k>>>8&3},D[18]={type:k>>>10&3},D[19]={type:k>>>12&3},D[20]={type:k>>>14&3};for(let e=0;e<=20;e++){D[e].type}const I=M.cp[s.CPRegister.VAT_A_ID+0],R=M.cp[s.CPRegister.VAT_B_ID+0],B=M.cp[s.CPRegister.VAT_C_ID+0];function P(e,t,a){return{compCnt:e,compType:t,compShift:a}}const E=[];E[9]=P(I>>>0&1,I>>>1&7,I>>>4&31);const F=!!(I>>>31)?2:I>>>9&1;E[10]=P(F,I>>>10&7,0),E[11]=P(I>>>13&1,I>>>14&7,0),E[12]=P(I>>>17&1,I>>>18&7,0),E[13]=P(I>>>21&1,I>>>22&7,I>>>25&31),E[14]=P(R>>>0&1,R>>>1&7,R>>>4&31),E[15]=P(R>>>9&1,R>>>10&7,R>>>13&31),E[16]=P(R>>>18&1,R>>>19&7,R>>>22&31),E[17]=P(R>>>27&1,R>>>28&7,B>>>0&31),E[18]=P(B>>>5&1,B>>>6&7,B>>>9&31),E[19]=P(B>>>14&1,B>>>15&7,B>>>18&31),E[20]=P(B>>>23&1,B>>>24&7,B>>>27&31);const V=[];i.assert(f>=0),f>=0&&(V[9]=t.pos[f]),A>=0&&(V[10]=t.nrm[A]),g>=0&&(V[11]=t.clr[g]),_>=0&&(V[12]=t.clr[_]),S>=0&&(V[13]=t.txc[S]),b>=0&&(V[14]=t.txc[b]),v>=0&&(V[15]=t.txc[v]),w>=0&&(V[16]=t.txc[w]),x>=0&&(V[17]=t.txc[x]),T>=0&&(V[18]=t.txc[T]),y>=0&&(V[19]=t.txc[y]),C>=0&&(V[20]=t.txc[C]);const O=h.compileVtxLoader(E,D),N=O.loadedVertexLayout,L=O.runVertices(V,e.subarray(d,c));return L.totalVertexCount!==p&&console.warn("Vertex count mismatch",L.totalVertexCount,p),{name:m,mtxIdx:r,loadedVertexLayout:N,loadedVertexData:L}}function k(e,t,a){const r=e.createDataView(),n=r.getUint32(8),s=i.readString(e,n),o=r.getUint32(12),l=r.getUint32(16),c=r.getUint32(20),h=r.getUint32(24),m=r.getUint32(28),p=r.getFloat32(32),f=r.getFloat32(36),A=r.getFloat32(40),_=.01745*r.getFloat32(44),S=.01745*r.getFloat32(48),b=.01745*r.getFloat32(52),w=r.getFloat32(56),x=r.getFloat32(60),T=r.getFloat32(64),y=d.mat4.create();g.computeModelMatrixSRT(y,p,f,A,_,S,b,w,x,T);const C=r.getFloat32(68),M=r.getFloat32(72),U=r.getFloat32(76),k=r.getFloat32(80),D=r.getFloat32(84),I=r.getFloat32(88);let R=null;k-C>0&&(R=new u.AABB(C,M,U,k,D,I));const B=r.getInt32(92),P=(r.getInt32(96),r.getInt32(100),r.getInt32(104),function(e,t){if(0===t)return null;const a=e.createDataView(),r=(a.getUint32(t+0),v(e,t+4)),n=[];for(let t=0;t<r.length;t++){const s=r[t].offs,o=(a.getUint32(s+0),a.getUint32(s+4)),l=a.getUint32(s+8),c=a.getUint32(s+12),h=a.getUint32(s+16),d=i.readString(e,s+h);i.assert(d===r[t].name);const u=a.getUint32(20);if(0===c){const e=[];for(let t=0;t<l;t++)e.push(a.getInt32(s+o+4*t));n.push({userDataType:c,name:d,id:u,value:e})}else if(1===c){const e=[];for(let t=0;t<l;t++)e.push(a.getFloat32(s+o+4*t));n.push({userDataType:c,name:d,id:u,value:e})}else if(2===c){const t=[];for(let a=0;a<l;a++)t.push(i.readString(e,s+o+4*a));n.push({userDataType:c,name:d,id:u,value:t})}}return{entries:n}}(e,r.getInt32(108)));let E=-1;0!==B&&(i.assert(o>0),E=(t+B-a)/208);const F=r.getFloat32(112),V=r.getFloat32(116),O=r.getFloat32(120),N=r.getFloat32(124),L=r.getFloat32(128),G=r.getFloat32(132),H=r.getFloat32(136),j=r.getFloat32(140),W=r.getFloat32(144),Z=r.getFloat32(148),z=r.getFloat32(152),K=r.getFloat32(156),X=d.mat4.fromValues(F,L,W,0,V,G,Z,0,O,H,z,0,N,j,K,1),Y=r.getFloat32(160),$=r.getFloat32(164),q=r.getFloat32(168),Q=r.getFloat32(172),J=r.getFloat32(176),ee=r.getFloat32(180),te=r.getFloat32(184),ae=r.getFloat32(188),re=r.getFloat32(192),ne=r.getFloat32(196),se=r.getFloat32(200),ie=r.getFloat32(204);return{name:s,id:o,userData:P,mtxId:l,flags:c,billboardMode:h,billboardRefNodeId:m,modelMatrix:y,bbox:R,visible:!!(256&c),parentNodeId:E,forwardBindPose:X,inverseBindPose:d.mat4.fromValues(Y,J,re,0,$,ee,ne,0,q,te,se,0,Q,ae,ie,1)}}function D(e){const t=e.createDataView(),a=[];let r=0;for(;;){const e=t.getUint8(r);if(1===e)break;if(4!==e)throw"whoops";{const e=t.getUint16(r+1),n=t.getUint16(r+3),s=t.getUint16(r+5);r+=8,a.push({matId:e,shpId:n,nodeId:s})}}return a}function I(e){const t=e.createDataView();i.assert("MDL0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([8,9,10,11].includes(a));let r=16;function n(){const a=v(e,t.getUint32(r));return r+=4,a}const s=n(),o=n(),l=n(),c=n(),h=n(),d=n();if(a>=10){n(),n()}const m=n(),p=(n(),n());r+=4,r+=4,a>=11&&(r+=4);const f=t.getUint32(r+0),A=i.readString(e,f),g=r+4,_=(t.getUint32(g+8),t.getUint32(g+12),t.getUint32(g+16),t.getUint32(g+20),t.getUint32(g+28)),S=!!t.getUint8(g+32),b=!!t.getUint8(g+32),w=!!t.getUint8(g+34),x=g+t.getUint32(g+36),T=t.getUint32(x+0),C=e.createTypedArray(Int32Array,x+4,T,1);let I=null;if(w){const e=t.getFloat32(g+40),a=t.getFloat32(g+44),r=t.getFloat32(g+48),n=t.getFloat32(g+52),s=t.getFloat32(g+56),i=t.getFloat32(g+60);I=new u.AABB(e,a,r,n,s,i)}const R=[];for(const t of m){const r=y(e.subarray(t.offs),a);i.assert(r.name===t.name),R.push(r)}const B=function(e,t,a,r,n){return{pos:M(e,9,t),nrm:M(e,10,a),clr:M(e,11,r),txc:M(e,13,n)}}(e,l,c,h,d),P=[];for(let t=0;t<p.length;t++){const a=p[t],r=U(e.subarray(a.offs),B);i.assert(r.name===a.name),P.push(r)}const E=[];for(const t of o){const a=k(e.subarray(t.offs),t.offs,o[0].offs);i.assert(a.name===t.name),E.push(a)}return{name:A,bbox:I,materials:R,shapes:P,nodes:E,sceneGraph:function(e,t){const a=i.assertExists(t.find(e=>"NodeTree"===e.name)),r=function(e){const t=e.createDataView(),a=[];let r=0;for(;;){const e=t.getUint8(r);if(1===e)break;if(2===e){const n=t.getUint16(r+1),s=t.getUint16(r+3);r+=5,a.push({op:e,nodeId:n,parentMtxId:s})}else{if(6!==e)throw"whoops";{const n=t.getUint16(r+1),s=t.getUint16(r+3);r+=5,a.push({op:e,toMtxId:n,fromMtxId:s})}}}return a}(e.subarray(a.offs));let n=[];const s=t.find(e=>"NodeMix"===e.name);if(s){n=function(e){const t=e.createDataView(),a=[];let r=0;for(;;){const e=t.getUint8(r);if(1===e)break;if(3===e){const n=t.getUint16(r+1),s=t.getUint8(r+3);r+=4;const i=[],o=[];for(let e=0;e<s;e++)i.push(t.getUint16(r+0)),o.push(t.getFloat32(r+2)),r+=6;a.push({op:e,dstMtxId:n,blendMtxIds:i,weights:o})}else{if(5!==e)throw"whoops";{const n=t.getUint16(r+1),s=t.getUint16(r+3);r+=5,a.push({op:e,mtxId:n,nodeId:s})}}}return a}(e.subarray(s.offs))}let o=[];const l=t.find(e=>"DrawOpa"===e.name);if(l){o=D(e.subarray(l.offs))}let c=[];const h=t.find(e=>"DrawXlu"===e.name);if(h){c=D(e.subarray(h.offs))}return{nodeTreeOps:r,nodeMixOps:n,drawOpaOps:o,drawXluOps:c}}(e,s),numWorldMtx:T,numViewMtx:_,needNrmMtxArray:S,needTexMtxArray:b,mtxIdToNodeId:C}}function R(e,t){const a=e.duration;if(0===e.loopMode)return t>a&&(t=a),t;if(1===e.loopMode){for(;t>a;)t-=a;return t}throw"whoops"}function B(e,t){const a=e.frames;if(1===a.length)return a[0].value;let r=0;for(;r<a.length&&!(t<a[r].frame);r++);if(0===r)return a[0].value;if(r===a.length)return a[a.length-1].value;return function(e,t,a){const r=t.frame-e.frame,n=(a-e.frame)/r,s=e.value,i=t.value,o=e.tangent*r,l=t.tangent*r;return f.getPointHermite(s,i,o,l,n)}(a[r-1],a[r],t)}function P(e,t){if(0===e.type)return function(e,t){const a=e.frames,r=a.length;if(1===r)return a[0];if(0===t)return a[0];if(t>r-1)return a[r-1];const n=0|t;return function(e,t,a,r=180){const n=(t-e)%r;return e+(2*n%r-n)*a}(a[n],a[n+1],t-n)}(e,t);if(1===e.type)return B(e,t);throw"whoops"}function E(e,t){const a=e.length;if(1===a)return e[0];if(0===t)return e[0];if(t>a-1)return e[a-1];const r=0|t;return function(e,t,a){const r=e>>>24&255,n=e>>>16&255,s=e>>>8&255,i=e>>>0&255,o=t>>>24&255,l=t>>>16&255,c=t>>>8&255,h=t>>>0&255;return g.lerp(r,o,a)<<24|g.lerp(n,l,a)<<16|g.lerp(s,c,a)<<8|g.lerp(i,h,a)}(e[r],e[r+1],t-r)}function F(e,t){return 1===e.numBits?e.getBit(0):e.getBit(0|t)}function V(e){return{type:0,frames:Float32Array.of(e)}}function O(e){const t=e.createDataView(),a=t.getUint16(0);t.getFloat32(4);let r=8;const n=[];for(let e=0;e<a;e++){const e={frame:t.getFloat32(r+0),value:t.getFloat32(r+4),tangent:t.getFloat32(r+8)};n.push(e),r+=12}return{type:1,frames:n}}function N(e,t){const a=e.createDataView();if(t){return V(a.getFloat32(0))}{const t=a.getUint32(0);return O(e.slice(t))}}function L(e,t,a,r){if(a){const e=new _.default(1);return e.setBit(0,r),e}{const a=new _.default(t),r=e.createDataView();let n=8;for(let e=0;e<t;e+=32){const t=r.getUint32(n);a.setWord(e>>>5,t),n+=4}return a}}function G(e,t,a){const r=e.createDataView();if(a){const e=r.getUint32(0);return Uint32Array.of(e)}{const a=r.getUint32(0);return e.createTypedArray(Uint32Array,a,t+1,1)}}function H(e){const t=e.createDataView().getUint32(0);let a=null,r=null,n=null,s=null,i=null,o=4;function l(t){const a=N(e.slice(o),t);return o+=4,a}return 2&t||(a=l(!!(32&t))),r=16&t?a:l(!!(64&t)),4&t||(n=l(!!(128&t))),8&t||(s=l(!!(256&t)),i=l(!!(512&t))),{scaleS:a,scaleT:r,rotation:n,translationS:s,translationT:i}}function j(e){const t=e.createDataView(),a=t.getUint32(0),r=i.readString(e,a),n=t.getUint32(4),s=t.getUint32(8)<<8|n;let o=12;const l=[];for(let a=0;a<z.COUNT;a++){if(!(s&1<<a))continue;const r=t.getUint32(o);o+=4,l[a]=H(e.slice(r))}return{materialName:r,texAnimations:l}}function W(e){const t=e.createDataView();i.assert("SRT0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([4,5].includes(a));const r=v(e,t.getUint32(16));let n=20;a>=5&&(n+=4);const s=t.getUint32(n+0),o=i.readString(e,s),l=t.getUint16(n+8),c=t.getUint16(n+10),h=t.getUint32(n+12),d=t.getUint32(n+16),u=[];for(const t of r){const a=j(e.slice(t.offs));u.push(a)}return i.assert(u.length===c),{name:o,loopMode:d,duration:l,texMtxMode:h,matAnimations:u}}t.parseMaterialEntry=T;class Z{constructor(e,t,a){this.animationController=e,this.srt0=t,this.texData=a}_calcTexMtx(e,t){const a=this.texData,r=this.animationController.getTimeInFrames(),n=R(this.srt0,r);b(e,t,a.scaleS?P(a.scaleS,n):1,a.scaleT?P(a.scaleT,n):1,a.rotation?P(a.rotation,n):0,a.translationS?P(a.translationS,n):0,a.translationT?P(a.translationT,n):0)}calcIndTexMtx(e){this._calcTexMtx(e,-1)}calcTexMtx(e){this._calcTexMtx(e,this.srt0.texMtxMode)}}var z,K;function X(e){const t=e.createDataView(),a=t.getUint32(0),r=i.readString(e,a),n=t.getUint32(4);let s=8;function o(a){let r;if(a){r=[{frame:0,texIndex:t.getUint16(s+0),palIndex:t.getUint16(s+2)}]}else{const a=t.getUint32(s);r=function(e){const t=e.createDataView(),a=t.getUint16(0);t.getFloat32(4);let r=8;const n=[];for(let e=0;e<a;e++){const e={frame:t.getFloat32(r+0),texIndex:t.getUint16(r+4),palIndex:t.getUint16(r+6)};n.push(e),r+=8}return n}(e.slice(a))}return s+=4,r}const l=[];for(let e=0;e<8;e++){const t=n>>>4*e&15;if(!(1&t))continue;const a=!!(4&t),r=!!(8&t),s=!!(2&t);i.assert(a&&!r);const c=o(s);l[e]={animationTrack:c,texIndexValid:a,palIndexValid:r}}return{materialName:r,texAnimations:l}}function Y(e){const t=e.createDataView();i.assert("PAT0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([3,4].includes(a));const r=v(e,t.getUint32(16)),n=t.getUint32(20);t.getUint32(24);let s=36;a>=4&&(s+=4);const o=t.getUint32(s+0),l=i.readString(e,o),c=t.getUint16(s+8),h=t.getUint16(s+10),d=t.getUint16(s+12),u=t.getUint16(s+14),m=t.getUint32(s+16);i.assert(0===u);const p=[];for(const t of r){const a=X(e.slice(t.offs));p.push(a)}i.assert(p.length===h);const f=[];let A=n;for(let a=0;a<d;a++){const a=t.getUint32(A),r=i.readString(e,n+a);f.push(r),A+=4}return{name:l,loopMode:m,duration:c,matAnimations:p,texNames:f}}t.SRT0TexMtxAnimator=Z,function(e){e[e.TEX0=0]="TEX0",e[e.TEX1=1]="TEX1",e[e.TEX2=2]="TEX2",e[e.TEX3=3]="TEX3",e[e.TEX4=4]="TEX4",e[e.TEX5=5]="TEX5",e[e.TEX6=6]="TEX6",e[e.TEX7=7]="TEX7",e[e.IND0=8]="IND0",e[e.IND1=9]="IND1",e[e.IND2=10]="IND2",e[e.COUNT=11]="COUNT"}(z=t.TexMtxIndex||(t.TexMtxIndex={})),t.bindSRT0Animator=function(e,t,a,r){const n=function(e,t,a){const r=e.matAnimations.find(e=>e.materialName===t);if(void 0===r)return null;const n=r.texAnimations[a];return void 0===n?null:n}(t,a,r);return null===n?null:new Z(e,t,n)};class ${constructor(e,t,a){this.animationController=e,this.pat0=t,this.texData=a}fillTextureMapping(e,t){const a=this.texData,r=this.animationController.getTimeInFrames(),n=R(this.pat0,r),s=function(e,t){if(1===e.length)return e[0];let a=e.length;for(;a-- >0&&!(t>=e[a].frame););return e[a]}(a.animationTrack,n);if(a.texIndexValid){const a=this.pat0.texNames[s.texIndex];t.fillTextureMapping(e,a)}}}function q(e,t){const a=e.createDataView(),r=a.getUint32(0),n=i.readString(e,r),s=a.getUint32(4);let o=8;function l(r){const n=a.getUint32(o+0),s=G(e.slice(o+4),t,r);return o+=8,{mask:n,frames:s}}const c=[];for(let e=0;e<K.COUNT;e++){const t=s>>>2*e&3;if(!(1&t))continue;const a=!!(2&t);c[e]=l(a)}return{materialName:n,clrAnimations:c}}function Q(e){const t=e.createDataView();i.assert("CLR0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([3,4].includes(a));const r=v(e,t.getUint32(16));let n=20;a>=4&&(n+=4);const s=t.getUint32(n+0),o=i.readString(e,s),l=t.getUint16(n+8),c=t.getUint16(n+10),h=t.getUint32(n+12),d=[];for(const t of r){const a=q(e.slice(t.offs),l);d.push(a)}return i.assert(d.length===c),{name:o,loopMode:h,duration:l,matAnimations:d}}t.PAT0TexAnimator=$,t.bindPAT0Animator=function(e,t,a,r){const n=function(e,t,a){const r=e.matAnimations.find(e=>e.materialName===t);if(void 0===r)return null;const n=r.texAnimations[a];return void 0===n?null:n}(t,a,r);return null===n?null:new $(e,t,n)},function(e){e[e.MAT0=0]="MAT0",e[e.MAT1=1]="MAT1",e[e.AMB0=2]="AMB0",e[e.AMB1=3]="AMB1",e[e.C0=4]="C0",e[e.C1=5]="C1",e[e.C2=6]="C2",e[e.K0=7]="K0",e[e.K1=8]="K1",e[e.K2=9]="K2",e[e.K3=10]="K3",e[e.COUNT=11]="COUNT"}(K=t.AnimatableColor||(t.AnimatableColor={}));class J{constructor(e,t,a){this.animationController=e,this.clr0=t,this.clrData=a}calcColor(e,t){const a=this.clrData,r=this.animationController.getTimeInFrames(),n=R(this.clr0,r),s=E(a.frames,n),i=A.colorToRGBA8(t)&a.mask|s;A.colorFromRGBA8(e,i)}}function ee(e,t){let a;!function(e){e[e.CONSTANT=0]="CONSTANT",e[e._32=1]="_32",e[e._48=2]="_48",e[e._96=3]="_96",e[e.FRM_8=4]="FRM_8",e[e.FRM_16=5]="FRM_16",e[e.FRM_32=6]="FRM_32"}(a||(a={}));const r=e.createDataView(),n=r.getUint32(0),s=i.readString(e,n),o=r.getUint32(4);let l=8;function c(n,s){let i;if(s||n===a.CONSTANT){i=V(r.getFloat32(l))}else if(n===a._32){const t=r.getUint32(l);i=function(e){const t=e.createDataView(),a=t.getUint16(0),r=(t.getFloat32(4),t.getFloat32(8)),n=t.getFloat32(12);let s=16;const i=[];for(let e=0;e<a;e++){const e={frame:t.getUint8(s+0),value:(t.getUint16(s+1)>>>4)*r+n,tangent:(t.getInt16(s+2)<<20>>20)/32};i.push(e),s+=4}return{type:1,frames:i}}(e.slice(t))}else if(n===a._96){const t=r.getUint32(l);i=O(e.slice(t))}else if(n===a._48){const t=r.getUint32(l);i=function(e){const t=e.createDataView(),a=t.getUint16(0),r=(t.getFloat32(4),t.getFloat32(8)),n=t.getFloat32(12);let s=16;const i=[];for(let e=0;e<a;e++){const e={frame:t.getInt16(s+0)/32,value:t.getUint16(s+2)*r+n,tangent:t.getInt16(s+4)/256};i.push(e),s+=6}return{type:1,frames:i}}(e.slice(t))}else if(n===a.FRM_8){const a=r.getUint32(l);i=function(e,t){const a=new Float32Array(t+1),r=e.createDataView(),n=r.getFloat32(0),s=r.getFloat32(4);let i=8;for(let e=0;e<t+1;e++)a[e]=r.getUint8(i+0)*n+s,i+=1;return{type:0,frames:a}}(e.slice(a),t)}else if(n===a.FRM_16){const a=r.getUint32(l);i=function(e,t){const a=new Float32Array(t+1),r=e.createDataView(),n=r.getFloat32(0),s=r.getFloat32(4);let i=8;for(let e=0;e<t+1;e++)a[e]=r.getUint16(i+0)*n+s,i+=2;return{type:0,frames:a}}(e.slice(a),t)}else{if(n!==a.FRM_32)throw new Error(`Unsupported animation track format ${n}`);{const a=r.getUint32(l);i=function(e,t){return{type:0,frames:e.createTypedArray(Float32Array,0,t+1,1)}}(e.slice(a),t)}}return l+=4,i}const h=o>>>25&3,d=o>>>27&7,u=o>>>30&3;let m=null,p=null,f=null;138&o||(m=c(h,!!(8192&o))),16&o?(p=m,f=m):(p=c(h,!!(16384&o)),f=c(h,!!(32768&o)));let A=null,g=null,_=null;294&o||(A=c(d,!!(65536&o)),g=c(d,!!(131072&o)),_=c(d,!!(262144&o)));let S=null,b=null,v=null;return 582&o||(S=c(u,!!(524288&o)),b=c(u,!!(1048576&o)),v=c(u,!!(2097152&o))),{nodeName:s,scaleX:m,scaleY:p,scaleZ:f,rotationX:A,rotationY:g,rotationZ:_,translationX:S,translationY:b,translationZ:v}}function te(e){const t=e.createDataView();i.assert("CHR0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([3,4,5].includes(a));const r=v(e,t.getUint32(16));let n=20;a>=5&&(n+=4);const s=t.getUint32(n+0),o=i.readString(e,s),l=t.getUint16(n+8),c=t.getUint16(n+10),h=t.getUint32(n+12),d=(t.getUint32(n+16),[]);for(const t of r){const a=ee(e.slice(t.offs),l);d.push(a)}return i.assert(d.length===c),{name:o,loopMode:h,duration:l,nodeAnimations:d}}t.CLR0ColorAnimator=J,t.bindCLR0Animator=function(e,t,a,r){const n=function(e,t,a){const r=e.matAnimations.find(e=>e.materialName===t);if(void 0===r)return null;const n=r.clrAnimations[a];return void 0===n?null:n}(t,a,r);return null===n?null:new J(e,t,n)};class ae{constructor(e,t,a){this.animationController=e,this.chr0=t,this.nodeData=a,this.disabled=[],this.vizNodeId=void 0}viz(e){this.vizNodeId=e,this.vizGraph=new m.Graph(m.cv())}updviz(e,t){const a=this.chr0.duration,r=this.vizGraph.ctx,n=a/10|0,s=e-n/2;r.fillStyle="white",r.fillRect(0,0,r.canvas.width,r.canvas.height),t.rotationX&&this.vizGraph.graphF("red",e=>{const a=R(this.chr0,e+s);return P(t.rotationX,a)},n),t.rotationY&&this.vizGraph.graphF("green",e=>{const a=R(this.chr0,e+s);return P(t.rotationY,a)},n),t.rotationZ&&this.vizGraph.graphF("blue",e=>{const a=R(this.chr0,e+s);return P(t.rotationZ,a)},n);const i=.5*r.canvas.width;r.beginPath(),r.strokeStyle="black",r.lineTo(i,0),r.lineTo(i,r.canvas.height),r.stroke()}calcModelMtx(e,t){const a=this.nodeData[t];if(!a)return!1;if(this.disabled[t])return!1;const r=this.animationController.getTimeInFrames(),n=R(this.chr0,r);this.vizNodeId===t&&this.updviz(n,a);const s=a.scaleX?P(a.scaleX,n):1,i=a.scaleY?P(a.scaleY,n):1,o=a.scaleZ?P(a.scaleZ,n):1,l=a.rotationX?.01745*P(a.rotationX,n):0,c=a.rotationY?.01745*P(a.rotationY,n):0,h=a.rotationZ?.01745*P(a.rotationZ,n):0,d=a.translationX?P(a.translationX,n):0,u=a.translationY?P(a.translationY,n):0,m=a.translationZ?P(a.translationZ,n):0;return g.computeModelMatrixSRT(e,s,i,o,l,c,h,d,u,m),!0}}function re(e,t){const a=e.createDataView(),r=a.getUint32(0),n=i.readString(e,r),s=a.getUint32(4);return{nodeName:n,nodeVisibility:L(e,t,!!(2&s),!!(1&s))}}function ne(e){const t=e.createDataView();i.assert("VIS0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([3,4].includes(a));const r=v(e,t.getUint32(16));let n=20;a>=4&&(n+=4);const s=t.getUint32(n+0),o=i.readString(e,s),l=t.getUint16(n+8),c=t.getUint16(n+10),h=t.getUint32(n+12),d=[];for(const t of r){const a=re(e.slice(t.offs),l);d.push(a)}return i.assert(d.length===c),{name:o,loopMode:h,duration:l,nodeAnimations:d}}t.CHR0NodesAnimator=ae,t.bindCHR0Animator=function(e,t,a){const r=[];for(const e of t.nodeAnimations){const t=a.find(t=>t.name===e.nodeName);t&&(r[t.id]=e)}return 0===r.length?null:new ae(e,t,r)};class se{constructor(e,t,a){this.animationController=e,this.vis0=t,this.nodeData=a}calcVisibility(e){const t=this.nodeData[e];if(!t)return null;const a=this.animationController.getTimeInFrames(),r=R(this.vis0,a);return F(t.nodeVisibility,r)}}function ie(e,t){const a=e.createDataView(),r=(a.getUint32(0),a.getUint32(8)),n=i.readString(e,r),s=(a.getUint32(12),a.getUint32(16)),o=a.getUint32(20),l=i.readString(e,o),c=a.getUint8(26),h=[],d=[];let u=28;for(let t=0;t<c;t++){const t=a.getUint32(u+0);d.push(i.readString(e,28+t)),u+=4,h.push(-1)}return{name:n,refNumber:s,ambLightName:l,ambLightId:-1,lightNames:d,lightIds:h}}function oe(e,t,a){const r=e.createDataView(),n=(r.getUint32(0),r.getUint32(8)),s=i.readString(e,n),o=(r.getUint32(12),r.getUint32(16)),l=r.getUint32(20),c=!!(-2147483648&l);return{name:s,refNumber:o,hasColor:!!(1&l),hasAlpha:!!(2&l),color:G(e.slice(24),a,c)}}function le(e,t,a){const r=e.createDataView(),n=(r.getUint32(0),r.getUint32(8)),s=i.readString(e,n),o=(r.getUint32(12),r.getUint32(16)),l=r.getUint32(20),c=r.getUint32(28);return{name:s,refNumber:o,specLightObjIdx:l,lightType:3&c,hasColor:!!(16&c),hasAlpha:!!(32&c),hasSpecular:!!(8&c),enable:L(e.slice(32),a,!!(8388608&c),!!(4&c)),posX:N(e.slice(36),!!(524288&c)),posY:N(e.slice(40),!!(1048576&c)),posZ:N(e.slice(44),!!(2097152&c)),color:G(e.slice(48),a,!!(4194304&c)),aimX:N(e.slice(52),!!(16777216&c)),aimY:N(e.slice(56),!!(33554432&c)),aimZ:N(e.slice(60),!!(67108864&c)),distFunc:r.getUint32(64),refDistance:N(e.slice(68),!!(268435456&c)),refBrightness:N(e.slice(72),!!(536870912&c)),spotFunc:r.getUint32(76),cutoff:N(e.slice(80),!!(134217728&c)),specColor:G(e.slice(84),a,!!(1073741824&c)),shininess:N(e.slice(88),!!(-2147483648&c))}}function ce(e,t,a){const r=e.createDataView(),n=(r.getUint32(0),r.getUint32(8)),s=i.readString(e,n),o=(r.getUint32(12),r.getUint32(16)),l=r.getUint32(20);return{name:s,refNumber:o,fogType:r.getUint32(24),startZ:N(e.slice(28),!!(536870912&l)),endZ:N(e.slice(32),!!(1073741824&l)),color:G(e.slice(36),a,!!(-2147483648&l))}}function he(e,t,a){const r=e.createDataView(),n=(r.getUint32(0),r.getUint32(8)),s=i.readString(e,n),o=(r.getUint32(12),r.getUint32(16)),l=r.getUint32(20),c=r.getUint32(24);return{name:s,refNumber:o,projType:l,cameraType:c>>>0&1,posX:N(e.slice(32),!!(131072&c)),posY:N(e.slice(36),!!(262144&c)),posZ:N(e.slice(40),!!(524288&c)),aspect:N(e.slice(44),!!(1048576&c)),near:N(e.slice(48),!!(2097152&c)),far:N(e.slice(52),!!(4194304&c)),rotX:N(e.slice(56),!!(536870912&c)),rotY:N(e.slice(60),!!(1073741824&c)),rotZ:N(e.slice(64),!!(-2147483648&c)),aimX:N(e.slice(68),!!(33554432&c)),aimY:N(e.slice(72),!!(67108864&c)),aimZ:N(e.slice(76),!!(134217728&c)),twist:N(e.slice(80),!!(268435456&c)),perspFovy:N(e.slice(84),!!(8388608&c)),orthoHeight:N(e.slice(88),!!(16777216&c))}}function de(e){const t=e.createDataView();i.assert("SCN0"===i.readString(e,0,4));const a=t.getUint32(8);i.assert([4,5].includes(a));const r=v(e,t.getUint32(16));let n=40;a>=5&&(n+=4);const s=t.getUint32(n+0),o=i.readString(e,s),l=r.find(e=>"LightSet(NW4R)"===e.name),c=r.find(e=>"AmbLights(NW4R)"===e.name),h=r.find(e=>"Lights(NW4R)"===e.name),d=r.find(e=>"Fogs(NW4R)"===e.name),u=r.find(e=>"Cameras(NW4R)"===e.name),m=t.getUint16(n+8),p=(t.getUint16(n+10),t.getUint32(n+12)),f=[];if(void 0!==l){const t=v(e,l.offs);for(let a=0;a<t.length;a++){const r=t[a],n=ie(e.subarray(r.offs));i.assert(n.name===r.name),f.push(n)}}const A=[];if(void 0!==c){const t=v(e,c.offs);for(let a=0;a<t.length;a++){const r=t[a],n=oe(e.subarray(r.offs),0,m);i.assert(n.name===r.name),A.push(n)}}const g=[];if(void 0!==h){const t=v(e,h.offs);for(let a=0;a<t.length;a++){const r=t[a],n=le(e.subarray(r.offs),0,m);i.assert(n.name===r.name),g.push(n)}}const _=[];if(void 0!==d){const t=v(e,d.offs);for(let a=0;a<t.length;a++){const r=t[a],n=ce(e.subarray(r.offs),0,m);i.assert(n.name===r.name),_.push(n)}}const S=[];if(void 0!==u){const t=v(e,u.offs);for(let a=0;a<t.length;a++){const r=t[a],n=he(e.subarray(r.offs));i.assert(n.name===r.name),S.push(n)}}for(let e=0;e<f.length;e++){const t=f[e];for(let e=0;e<t.lightNames.length;e++)""!==t.lightNames[e]&&(t.lightIds[e]=g.findIndex(a=>a.name===t.lightNames[e]));""!==t.ambLightName&&(t.ambLightId=A.findIndex(e=>e.name===t.ambLightName))}return{name:o,duration:m,loopMode:p,lightSets:f,ambLights:A,lights:g,fogs:_,cameras:S}}t.VIS0NodesAnimator=se,t.bindVIS0Animator=function(e,t,a){const r=[];for(const e of t.nodeAnimations){const t=a.find(t=>t.name===e.nodeName);t&&(r[t.id]=e)}return 0===r.length?null:new se(e,t,r)},t.parse=function(e){const t=e.createDataView();let a;switch(i.assert("bres"===i.readString(e,0,4)),t.getUint16(4,!1)){case 65279:a=!1;break;case 65534:a=!0;break;default:throw new Error("Invalid BOM")}i.assert(!a),t.getUint32(8);const r=t.getUint16(12);t.getUint16(14),i.assert("root"===i.readString(e,r+0,4));const n=v(e,r+8),s=[],o=n.find(e=>"Palettes(NW4R)"===e.name);if(o){const t=v(e,o.offs);for(const a of t){const t=w(e.subarray(a.offs));i.assert(t.name===a.name),s.push(t)}}const l=[],c=n.find(e=>"Textures(NW4R)"===e.name);if(c){const t=v(e,c.offs);for(const a of t){const t=x(e.subarray(a.offs));if(i.assert(t.name===a.name),l.push(t),8===t.format||9===t.format||10===t.format){const e=i.assertExists(s.find(e=>e.name===t.name));t.paletteFormat=e.format,t.paletteData=e.data}}}const h=[],d=n.find(e=>"3DModels(NW4R)"===e.name);if(d){const t=v(e,d.offs);for(let a=0;a<t.length;a++){const r=t[a],n=I(e.subarray(r.offs));i.assert(n.name===r.name),h.push(n)}}const u=[],m=n.find(e=>"AnmTexSrt(NW4R)"===e.name);if(m){const t=v(e,m.offs);for(let a=0;a<t.length;a++){const r=t[a],n=W(e.subarray(r.offs));i.assert(n.name===r.name),u.push(n)}}const p=[],f=n.find(e=>"AnmTexPat(NW4R)"===e.name);if(f){const t=v(e,f.offs);for(let a=0;a<t.length;a++){const r=t[a];let n;try{n=Y(e.subarray(r.offs))}catch(e){continue}i.assert(n.name===r.name),p.push(n)}}const A=[],g=n.find(e=>"AnmClr(NW4R)"===e.name);if(g){const t=v(e,g.offs);for(let a=0;a<t.length;a++){const r=t[a],n=Q(e.subarray(r.offs));i.assert(n.name===r.name),A.push(n)}}const _=[],S=n.find(e=>"AnmChr(NW4R)"===e.name);if(S){const t=v(e,S.offs);for(let a=0;a<t.length;a++){const r=t[a],n=te(e.subarray(r.offs));i.assert(n.name===r.name),_.push(n)}}const b=[],T=n.find(e=>"AnmVis(NW4R)"===e.name);if(T){const t=v(e,T.offs);for(let a=0;a<t.length;a++){const r=t[a],n=ne(e.subarray(r.offs));i.assert(n.name===r.name),b.push(n)}}const y=[],C=n.find(e=>"AnmScn(NW4R)"===e.name);if(C){const t=v(e,C.offs);for(let a=0;a<t.length;a++){const r=t[a],n=de(e.subarray(r.offs));i.assert(n.name===r.name),y.push(n)}}return{plt0:s,tex0:l,mdl0:h,srt0:u,pat0:p,clr0:A,chr0:_,vis0:b,scn0:y}};class ue{constructor(){this.flags=0,this.light=new o.Light,this.space=0}isEnabled(){return!!(1&this.flags)}enable(){this.flags|=1}disable(){this.flags&=1}enableColor(){this.flags|=2}disableColor(){this.flags&=2}enableAlpha(){this.flags|=4}disableAlpha(){this.flags&=4}initLightColor(e){A.colorCopy(this.light.Color,e)}initLightSpot(e,t){o.lightSetSpot(this.light,e,t)}initLightAttnA(e,t,a){d.vec3.set(this.light.CosAtten,e,t,a)}initLightDistAttn(e,t,a){o.lightSetDistAttn(this.light,e,t,a)}initLightAttnK(e,t,a){d.vec3.set(this.light.DistAtten,e,t,a)}}t.LightObj=ue;class me{constructor(){this.lightObjIndexes=i.nArray(8,()=>-1),this.ambLightObjIndex=-1}calcLights(e,t,a){for(let r=0;r<this.lightObjIndexes.length;r++){const n=this.lightObjIndexes[r];if(n<0)continue;const s=t.lightObj[n];1&s.flags&&(e[r].copy(s.light),0===s.space?(o.lightSetWorldPositionViewMatrix(e[r],a,s.light.Position[0],s.light.Position[1],s.light.Position[2]),o.lightSetWorldDirectionNormalMatrix(e[r],a,s.light.Direction[0],s.light.Direction[1],s.light.Direction[2])):s.space)}}calcAmbColorCopy(e,t){this.ambLightObjIndex<0||A.colorCopy(e,t.ambLightObj[this.ambLightObjIndex])}calcLightSetLitMask(e,t){i.assert(e.length>=1);let a=0,r=0,n=0,s=0;for(let e=0;e<this.lightObjIndexes.length;e++){const i=this.lightObjIndexes[e];if(i<0)continue;const o=t.lightObj[i],l=1<<e;1&o.flags&&(8&o.flags?(2&o.flags&&(n|=l),4&o.flags&&(s|=l)):(2&o.flags&&(a|=l),4&o.flags&&(r|=l)))}const o=i.assertExists(e[0]);let l=!1;o.colorChannel.lightingEnabled||0===a||(o.colorChannel.lightingEnabled=!0,l=!0),o.alphaChannel.lightingEnabled||0===r||(o.alphaChannel.lightingEnabled=!0,l=!0),o.colorChannel.lightingEnabled&&o.colorChannel.litMask!==a&&(o.colorChannel.litMask=a,l=!0),o.alphaChannel.lightingEnabled&&o.alphaChannel.litMask!==r&&(o.alphaChannel.litMask=r,l=!0);const c=e[1];return c&&(c.colorChannel.lightingEnabled&&c.colorChannel.litMask!==n&&(c.colorChannel.litMask=n,l=!0),c.alphaChannel.lightingEnabled&&c.alphaChannel.litMask!==s&&(c.alphaChannel.litMask=r,l=!0)),l}}t.LightSet=me;t.LightSetting=class{constructor(e=128,t=128){this.ambLightObj=i.nArray(e,()=>A.colorNewCopy(A.White)),this.lightObj=i.nArray(e,()=>new ue),this.lightSet=i.nArray(t,()=>new me)}};t.SCN0Animator=class{constructor(e,t){this.animationController=e,this.scn0=t,this.scratchPos=d.vec3.create(),this.scratchAim=d.vec3.create()}calcCameraPositionAim(e,t){const a=R(this.scn0,this.animationController.getTimeInFrames()),r=this.scn0.cameras[t],n=P(r.posX,a),s=P(r.posY,a),o=P(r.posZ,a);if(d.vec3.set(this.scratchPos,n,s,o),1===r.cameraType){const t=P(r.aimX,a),n=P(r.aimY,a),s=P(r.aimZ,a);d.vec3.set(this.scratchAim,t,n,s),d.mat4.lookAt(e.viewMatrix,this.scratchPos,this.scratchAim,g.Vec3UnitY),d.mat4.invert(e.worldMatrix,e.viewMatrix)}else i.assert(!1);e.worldMatrixUpdated()}calcCameraProjection(e,t){const a=R(this.scn0,this.animationController.getTimeInFrames()),r=this.scn0.cameras[t];if(0===r.projType){const t=.01745*P(r.perspFovy,a),n=P(r.aspect,a),s=P(r.near,a),i=P(r.far,a);e.setPerspective(t,n,s,i)}}calcCameraClipPlanes(e,t){const a=R(this.scn0,this.animationController.getTimeInFrames()),r=this.scn0.cameras[t],n=P(r.near,a),s=P(r.far,a);e.setClipPlanes(n,s)}calcLightSetting(e){const t=R(this.scn0,this.animationController.getTimeInFrames());for(let t=0;t<this.scn0.lightSets.length;t++){const a=this.scn0.lightSets[t],r=e.lightSet[a.refNumber];for(let e=0;e<a.lightIds.length;e++)-1!==a.lightIds[e]?r.lightObjIndexes[e]=this.scn0.lights[a.lightIds[e]].refNumber:r.lightObjIndexes[e]=-1;-1!==a.ambLightId?r.ambLightObjIndex=this.scn0.ambLights[a.ambLightId].refNumber:r.ambLightObjIndex=-1}for(let a=0;a<this.scn0.lights.length;a++){const r=this.scn0.lights[a],n=i.assertExists(e.lightObj[r.refNumber]);if(F(r.enable,t)){n.flags=1,r.hasColor&&(n.flags|=2),r.hasAlpha&&(n.flags|=4),A.colorFromRGBA8(n.light.Color,E(r.color,t));const e=P(r.posX,t),a=P(r.posY,t),s=P(r.posZ,t);if(1===r.lightType){const i=P(r.aimX,t),o=P(r.aimY,t),l=P(r.aimZ,t);d.vec3.set(n.light.Position,-1e10*(i-e),-1e10*(o-a),-1e10*(l-s)),d.vec3.set(n.light.Direction,0,0,0),d.vec3.set(n.light.DistAtten,1,0,0),d.vec3.set(n.light.CosAtten,1,0,0)}else if(0===r.lightType){d.vec3.set(n.light.Position,e,a,s),o.lightSetSpot(n.light,0,0);const i=P(r.refDistance,t),l=P(r.refBrightness,t);o.lightSetDistAttn(n.light,i,l,r.distFunc),d.vec3.set(n.light.Direction,0,0,0)}else if(2===r.lightType){d.vec3.set(n.light.Position,e,a,s);const i=P(r.cutoff,t);o.lightSetSpot(n.light,i,r.spotFunc);const l=P(r.refDistance,t),c=P(r.refBrightness,t);o.lightSetDistAttn(n.light,l,c,r.distFunc);const h=P(r.aimX,t),u=P(r.aimY,t),m=P(r.aimZ,t);d.vec3.set(n.light.Direction,h-e,u-a,m-s),d.vec3.normalize(n.light.Direction,n.light.Direction)}}else n.flags&=-2}for(let a=0;a<this.scn0.ambLights.length;a++){const r=this.scn0.ambLights[a],n=i.assertExists(e.ambLightObj[r.refNumber]);let s=E(r.color,t);r.hasColor||(s&=255),r.hasAlpha||(s&=4294967040),A.colorFromRGBA8(n,s)}}}},function(e,t,a){"use strict";function r(e,t,a,r,n){return((e*n+t)*n+a)*n+r}function n(e,t,a,r,n){return(3*e*n+2*t)*n+a}Object.defineProperty(t,"__esModule",{value:!0}),t.getPointCubic=r,t.getPointHermite=function(e,t,a,n,s){return r(2*e+-2*t+1*a+1*n,-3*e+3*t+-2*a+-1*n,0*e+0*t+1*a+0*n,1*e+0*t+0*a+0*n,s)},t.getPointBezier=function(e,t,a,n,s){return r(-1*e+3*t+-3*a+1*n,3*e+-6*t+3*a+0*n,-3*e+3*t+0*a+0*n,1*e+0*t+0*a+0*n,s)},t.getPointBasis=function(e,t,a,n,s){return r(-1*e+3*t+-3*a+1*n,3*e+-6*t+3*a+0*n,-3*e+0*t+3*a+0*n,1*e+4*t+1*a+0*n,s)/6},t.getDerivativeCubic=n,t.getDerivativeHermite=function(e,t,a,r,s){return n(2*e+-2*t+1*a+1*r,-3*e+3*t+-2*a+-1*r,0*e+0*t+1*a+0*r,0,s)},t.getDerivativeBezier=function(e,t,a,r,s){return n(-1*e+3*t+-3*a+1*r,3*e+-6*t+3*a+0*r,-3*e+3*t+0*a+0*r,0,s)},t.getDerivativeBasis=function(e,t,a,r,s){return n(-1*e+3*t+-3*a+1*r,3*e+-6*t+3*a+0*r,-3*e+0*t+3*a+0*r,0,s)/6}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=r(a(59)),i=a(56),o=a(38),l=a(86);function c(e){if(9===e)return 2;if(10===e)return 3;if(11===e)return 6;if(12===e)return 7;throw"whoops"}function h(e){switch(e){case 0:case 1:case 5:return 1;case 2:case 3:return 2;case 4:return 4}}function d(e){return 0===e||u(e)}function u(e){switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return!0;default:return!1}}function m(e){switch(e){case 11:case 12:return!0;default:return!1}}function p(e){switch(e){case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:return!0;default:return!1}}function f(e,t){return d(e)?1:h(t.compType)}function A(e,t){if(d(e))return 1;if(m(e))switch(t.compType){case 0:return 2;case 1:return 3;case 2:return 4;case 3:return 2;case 4:return 3;case 5:return 4}return f(e,t)*S(e,t)}function g(e,t){switch(e){case 9:if(0===t)return 2;if(1===t)return 3;case 10:if(0===t)return 3;if(1===t)return 9;if(2===t)return 3;case 11:case 12:if(0===t)return 3;if(1===t)return 4;case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:if(0===t)return 1;if(1===t)return 2;case 255:default:throw new Error("whoops")}}function _(e,t){return d(e)?1:g(e,t.compCnt)}function S(e,t){return o.getFormatCompFlagsComponentCount(_(e,t))}function b(e,t){return d(e)?0:t.compType}function v(e,t){return 10===e&&2===t.compCnt?3:1}function w(e,t){let a=0;const r=function(e){return d(e)?o.GfxFormat.U8_R_NORM:11===e||12===e?o.GfxFormat.U8_R_NORM:o.GfxFormat.F32_R}(t);if(9===t)a=4;else if(m(t))a=4;else if(u(t))a=4;else if(p(t))n.assert(r===o.GfxFormat.F32_R),a=4;else for(let r=0;r<e.length;r++){const n=e[r];void 0!==n&&(a=Math.max(a,_(t,n.vatFormat[t])))}return o.makeFormat(o.getFormatTypeFlags(r),a,o.getFormatFlags(r))}function x(e,t){e=C(e,D),t=C(t,R);const a=e.map(e=>function(e,t){if(void 0===e)return;let a=0;for(let r=0;r<t.length;r++){const s=t[r],i=e[r];if(!s||0===s.type)continue;const o=v(r,i);d(r)&&n.assert(1===s.type),1===s.type?a+=A(r,i):2===s.type?a+=1*o:3===s.type&&(a+=2*o)}return{srcVertexSize:a,vatFormat:e,vcd:t}}(e,t));function r(e,t){const a=i.find(t=>t.attrInput===e);if(void 0!==a)return a;{const a=o.getFormatCompByteSize(t),r=o.getFormatComponentCount(t);s=n.align(s,a);const l=s;s+=a*r;const c={attrInput:e,bufferIndex:0,bufferOffset:l,format:t};return i.push(c),c}}let s=0;const i=[],l=[],h=[];for(let e=0;e<t.length;e++){const s=t[e];if(!s||0===s.type)continue;if(!(void 0===s.enableOutput||s.enableOutput))continue;const i=w(a,e);let m,f,A=0;if(u(e)){m=r(e<5?0:1,i),A=e-1&3,f=m.format}else if(0===e){m=r(2,w(a,9)),A=3,f=m.format}else if(25===e)m=r(3,i),r(4,i),r(5,i),f=m.format;else if(p(e)){const t=e-13;m=r(8+(t>>>1),i),A=2*(1&t),n.assert(m.format===o.GfxFormat.F32_RGBA),f=o.GfxFormat.F32_RG}else{m=r(c(e),i),f=m.format}d(e)&&(f=o.setFormatFlags(f,0));const g=o.getFormatCompByteSize(m.format)*A;l[e]=m.bufferOffset+g,h[e]=f}s=n.align(s,4);const m=[s];return{indexFormat:o.GfxFormat.U16_R,vertexBufferStrides:m,singleVertexInputLayouts:i,vertexAttributeOffsets:l,vertexAttributeFormats:h,vatLayouts:a,vat:e,vcd:t}}function T(e,t){function a(e){return`vtxArrayViews[${e}]`}function r(t,r){const s=t.vatFormat[r],l=t.vcd[r];if(!l||0===l.type)return"";const c=void 0===l.enableOutput||l.enableOutput,h=e.vertexAttributeFormats[r],u=e.vertexAttributeOffsets[r];let p=-1;function g(e){const t=1<<function(e,t){if(d(e))return 0;if(10===e){if(0===t.compType||1===t.compType)return 6;if(2===t.compType||3===t.compType)return 14;throw"whoops"}return function(e,t){switch(e){case 4:case 5:return 0;case 0:case 2:case 1:case 3:return t}}(t.compType,t.compShift)}(r,s);return 1===t?e:`(${e} / ${t})`}function _(e,t){switch(b(r,s)){case 4:return`${e}.getFloat32(${t})`;case 0:return g(`${e}.getUint8(${t})`);case 2:return g(`${e}.getUint16(${t})`);case 1:return g(`${e}.getInt8(${t})`);case 3:return g(`${e}.getInt16(${t})`);default:throw"whoops"}}function v(e,t){const a=o.getFormatTypeFlags(h),r=1&o.getFormatFlags(h);if(8===a)return function(e,t){return`dstVertexDataView.setFloat32(${`dstVertexDataOffs + ${e}`}, ${t}, ${0===i.getSystemEndianness()})`}(e,t);if(1===a&&r)return function(e,t){return`dstVertexDataView.setUint8(${`dstVertexDataOffs + ${e}`}, ${t} * 0xFF)`}(e,t);if(1===a)return function(e,t){return`dstVertexDataView.setUint8(${`dstVertexDataOffs + ${e}`}, ${t})`}(e,t);throw"whoops"}function w(e,t,a){let i="";return c&&(m(r)?i+=function(e,t){const a=o.getFormatComponentCount(h),i=u;n.assert(4===a);const l=`_T${r}`,c=b(r,s);if(0===c)return`\n    var ${l} = ${e}.getUint16(${t});\n    ${v(i+0,`(((${l} >>> 11) & 0x1F) / 0x1F)`)};\n    ${v(i+1,`(((${l} >>>  5) & 0x3F) / 0x3F)`)};\n    ${v(i+2,`(((${l} >>>  0) & 0x1F) / 0x1F)`)};\n    ${v(i+3,"1.0")};\n`;if(1===c||2===c)return`\n    ${v(i+0,`${e}.getUint8(${t} + 0) / 0xFF`)};\n    ${v(i+1,`${e}.getUint8(${t} + 1) / 0xFF`)};\n    ${v(i+2,`${e}.getUint8(${t} + 2) / 0xFF`)};\n    ${v(i+3,"1.0")};\n`;if(3===c)return`\n    var ${l} = ${e}.getUint16(${t});\n    ${v(i+0,`(((${l} >>> 12) & 0x0F) / 0x0F)`)};\n    ${v(i+1,`(((${l} >>>  8) & 0x0F) / 0x0F)`)};\n    ${v(i+2,`(((${l} >>>  4) & 0x0F) / 0x0F)`)};\n    ${v(i+3,`(((${l} >>>  0) & 0x0F) / 0x0F)`)};\n`;if(4===c)return`\n    var ${l} = (${e}.getUint8(${t} + 0) << 16) | (${e}.getUint8(${t} + 1) << 8) | (${e}.getUint8(${t} + 2));\n    ${v(i+0,`(((${l} >>> 18) & 0x3F) / 0x3F)`)};\n    ${v(i+1,`(((${l} >>> 12) & 0x3F) / 0x3F)`)};\n    ${v(i+2,`(((${l} >>>  6) & 0x3F) / 0x3F)`)};\n    ${v(i+3,`(((${l} >>>  0) & 0x3F) / 0x3F)`)};\n`;if(5===c)return`\n    ${v(i+0,`${e}.getUint8(${t} + 0) / 0xFF`)};\n    ${v(i+1,`${e}.getUint8(${t} + 1) / 0xFF`)};\n    ${v(i+2,`${e}.getUint8(${t} + 2) / 0xFF`)};\n    ${v(i+3,`${e}.getUint8(${t} + 3) / 0xFF`)};\n`;throw"whoops"}(e,t):i+=function(e,t){let a="";const n=f(r,s),i=S(r,s),l=o.getFormatCompByteSize(h);o.getFormatComponentCount(h);for(let r=0;r<i;r++){a+=`\n    ${v(u+r*l,_(e,`${t} + ${r*n}`))};`}return a}(e,t)),i+=`\n    drawCallIdx += ${a};\n`,i}function x(e,t,a,n=""){const s=`arrayOffset${r}${n}`;return c?`const ${s} = ${`(${t}) * ${`vtxArrayStrides[${r}]`}`};${w(e,s,a)}`:w("","",a)}function T(e,t,a){return 10===r&&2===s.compCnt?`\n    // NRM\n    ${x(e,`${t} + 0`,a,"_N")}\n    // BINRM\n    ${x(e,`${t} + 3`,a,"_B")}\n    // TANGENT\n    ${x(e,`${t} + 6`,a,"_T")}`:`\n    // ${function(e){switch(e){case 0:return"PNMTXIDX";case 1:return"TEX0MTXIDX";case 2:return"TEX1MTXIDX";case 3:return"TEX2MTXIDX";case 4:return"TEX3MTXIDX";case 5:return"TEX4MTXIDX";case 6:return"TEX5MTXIDX";case 7:return"TEX6MTXIDX";case 8:return"TEX7MTXIDX";case 9:return"POS";case 10:return"NRM";case 11:return"CLR0";case 12:return"CLR1";case 13:return"TEX0";case 14:return"TEX1";case 15:return"TEX2";case 16:return"TEX3";case 17:return"TEX4";case 18:return"TEX5";case 19:return"TEX6";case 20:return"TEX7";default:throw new Error("whoops")}}(r)}\n    ${x(e,t,a)}`}switch(1===l.type&&(p=A(r,s)),l.type){case 1:return w("dlView","drawCallIdx",p);case 2:return T(a(r),"dlView.getUint8(drawCallIdx)",1);case 3:return T(a(r),"dlView.getUint16(drawCallIdx)",2);default:throw"whoops"}}const s=`\n"use strict";\n\nreturn function(dstVertexDataView, dstVertexDataOffs, dlView, drawCallIdx, vtxArrayViews, vtxArrayStrides) {\n${function(e){let t="";for(let a=0;a<=20;a++)t+=r(e,a);return t}(t)}\n\n    return drawCallIdx;\n};\n`;return new Function(s)()}t.getAttributeComponentByteSizeRaw=h,t.getAttributeByteSize=function(e,t){return A(t,e[t])},t.getAttributeFormatCompFlagsRaw=g,t.compileLoadedVertexLayout=x;class y{constructor(e){this.loadedVertexLayout=e,this.vtxLoaders=[];for(let t=0;t<e.vatLayouts.length;t++){const a=e.vatLayouts[t];void 0!==a&&(this.vtxLoaders[t]=T(e,a))}}runVertices(e,t,a){const r=void 0!==a&&void 0!==a.firstVertexId?a.firstVertexId:0,s=[],i=[];for(let t=0;t<20;t++)void 0!==e[t]&&(s[t]=e[t].buffer.createDataView(e[t].offs),i[t]=e[t].stride);function o(e){return{indexOffset:e,indexCount:0,posNrmMatrixTable:Array(10).fill(65535),texMatrixTable:Array(10).fill(65535)}}const l=t.createDataView(),c=[],h=[];let d=0,u=0,m=0,p=null,f=null;for(;!(m>=t.byteLength);){const e=l.getUint8(m);if(0===e)break;switch(e){case 32:{p=null,null===f&&(f=o(u));const e=12,t=0,a=f.posNrmMatrixTable,r=l.getUint16(m+1),n=l.getUint16(m+3),s=((4095&n)-t)/e|0;if(1+(n>>>12)!==e)throw Error();a[s]=r,m+=5;continue}case 48:{p=null,null===f&&(f=o(u));const e=12,t=120,a=f.texMatrixTable,r=l.getUint16(m+1),n=l.getUint16(m+3),s=((4095&n)-t)/e|0;if(1+(n>>>12)!==e)throw Error();a[s]=r,m+=5;continue}case 40:case 56:m+=5;continue}const a=248&e,r=7&e,s=l.getUint16(m+1);m+=3;const i=m;d+=s,null===p&&(null!==f?(p=f,f=null):p=o(u),h.push(p));let A=0;switch(a){case 144:A=s;break;case 160:case 152:A=3*(s-2);break;case 128:case 136:A=6*s/4*3;break;default:throw new Error(`Invalid data at ${n.hexzero(t.byteOffset,8)} / ${n.hexzero(m-3,4)} cmd ${n.hexzero(e,2)}`)}c.push({primType:a,vertexFormat:r,srcOffs:i,vertexCount:s}),p.indexCount+=A,u+=A;const g=this.loadedVertexLayout.vatLayouts[r];if(void 0===g)throw new Error("No VAT for VTXFMT"+r);m+=g.srcVertexSize*s}let A=0;const g=new Uint16Array(u);let _=r;const S=this.loadedVertexLayout.vertexBufferStrides[0]*d,b=new ArrayBuffer(S),v=new DataView(b);let w=0;for(let e=0;e<c.length;e++){const t=c[e];switch(t.primType){case 144:for(let e=0;e<t.vertexCount;e++)g[A++]=_++;break;case 152:for(let e=0;e<3;e++)g[A++]=_++;for(let e=3;e<t.vertexCount;e++)g[A++]=_-(1&e?1:2),g[A++]=_-(1&e?2:1),g[A++]=_++;break;case 160:const e=_;for(let e=0;e<3;e++)g[A++]=_++;for(let a=3;a<t.vertexCount;a++)g[A++]=e,g[A++]=_-1,g[A++]=_++;break;case 128:case 136:for(let e=0;e<t.vertexCount;e+=4)g[A++]=_+0,g[A++]=_+1,g[A++]=_+2,g[A++]=_+0,g[A++]=_+2,g[A++]=_+3,_+=4}let a=t.srcOffs;for(let e=0;e<t.vertexCount;e++)a=this.vtxLoaders[t.vertexFormat](v,w,l,a,s,i),w+=this.loadedVertexLayout.vertexBufferStrides[0]}return{indexData:g.buffer,vertexBuffers:[b],totalVertexCount:d,totalIndexCount:u,vertexId:_,packets:h}}}function C(e,t){const a=Array(e.length);for(let r=0;r<e.length;r++)a[r]=t(e[r]);return a}function M(e,t,a){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!a(e[r],t[r]))return!1;return!0}function U(e){return void 0===e?void 0:{compCnt:e.compCnt,compShift:e.compShift,compType:e.compType}}function k(e,t){return void 0===e||void 0===t?e===t:e.compCnt===t.compCnt&&e.compShift===t.compShift&&e.compType===t.compType}function D(e){return C(e,U)}function I(e,t){return M(e,t,k)}function R(e){return void 0===e?void 0:{enableOutput:e.enableOutput,type:e.type}}function B(e,t){return void 0===e||void 0===t?e===t:e.enableOutput===t.enableOutput&&e.type===t.type}const P=new l.HashMap((function(e,t){return!!M(e.vat,t.vat,I)&&!!M(e.vcd,t.vcd,B)}),l.nullHashFunc);function E(e){let t=P.get(e);if(null===t){const a=x(e.vat,e.vcd);t=new y(a),P.add(a,t)}return t}t.compileVtxLoaderMultiVat=function(e,t){return E({vat:e,vcd:t})},t.compileVtxLoader=function(e,t){return E({vat:[e],vcd:t})};function F(e,t){return e<<24|16777215&t}t.DisplayListRegisters=class{constructor(){this.bp=new Uint32Array(256),this.cp=new Uint32Array(256),this.xf=new Uint32Array(4096),this.kc=new Uint32Array(16),this.bp[s.BPRegister.SS_MASK]=16777215}bps(e){const t=e>>>24,a=this.bp[s.BPRegister.SS_MASK],r=this.bp[t]&~a|e&a;if(t!==s.BPRegister.SS_MASK&&(this.bp[s.BPRegister.SS_MASK]=16777215),this.bp[t]=r,t>=s.BPRegister.TEV_REGISTERL_0_ID&&t<=s.BPRegister.TEV_REGISTERL_0_ID+8){const e=t-s.BPRegister.TEV_REGISTERL_0_ID,a=r>>>23&1;this.kc[4*a*2+e]=r}}xfs(e,t,a){n.assert(e>=4096),e-=4096,this.xf[16*e+t]=a}xfg(e,t=0){return n.assert(e>=4096),e-=4096,this.xf[16*e+t]}},t.displayListToString=function(e){const t=e.createDataView();let a="",r=16777215;function i(e){return`0x${e.toString(16)}`}const o=[s.XFRegister,s.BPRegister,s.CPRegister],l=["XF","BP","CP"];function c(e,t,a){const r=l[e],n=o[e][t],s=i(t);return`Set ${r} ${n||s} to ${i(a)}\n`}for(let i=0;i<e.byteLength;){const o=t.getUint8(i++);switch(o){case 0:continue;case 97:{const e=t.getUint32(i);i+=4;const n=e>>>24,o=e&r;r=n!==s.BPRegister.SS_MASK?16777215:o,a+=c(1,n,o);break}case 8:{const e=t.getUint8(i);i++;const r=t.getUint32(i);i+=4,a+=c(2,e,r);break}case 16:{const e=t.getUint16(i)+1;i+=2,n.assert(e<=16);const r=t.getUint16(i);i+=2;for(let n=0;n<e;n++)a+=c(0,r+n,t.getUint32(i)),i+=4;break}default:throw console.error(`Unknown command ${o} at ${i} (buffer: 0x${e.byteOffset.toString(16)})`),"whoops 1"}}return a},t.displayListRegistersRun=function(e,t){const a=t.createDataView();for(let r=0;r<t.byteLength;){const s=a.getUint8(r++);switch(s){case 0:continue;case 97:{const t=a.getUint32(r);r+=4,e.bps(t);break}case 8:{const t=a.getUint8(r);r++;const n=a.getUint32(r);r+=4,e.cp[t]=n;break}case 16:{const t=a.getUint16(r)+1;r+=2,n.assert(t<=16);const s=a.getUint16(r);r+=2;for(let n=0;n<t;n++)e.xfs(s,n,a.getUint32(r)),r+=4;for(let a=t;a<16;a++)e.xfs(s,a,0);break}default:throw console.error(`Unknown command ${s} at ${r} (buffer: 0x${t.byteOffset.toString(16)})`),"whoops 1"}}},t.displayListRegistersInitGX=function(e){for(let t=0;t<8;t+=2)e.bps(F(s.BPRegister.TEV_KSEL_0_ID+t+0,4)),e.bps(F(s.BPRegister.TEV_KSEL_0_ID+t+1,14))},t.coalesceLoadedDatas=function(e,t){let a=0,r=0,s=0,i=0;const o=[];for(let e=0;e<t.length;e++){const l=t[e];n.assert(1===l.vertexBuffers.length);for(let e=0;e<l.packets.length;e++){const t=l.packets[e],r=a+t.indexOffset,n=t.indexCount,s=t.posNrmMatrixTable,i=t.texMatrixTable;o.push({indexOffset:r,indexCount:n,posNrmMatrixTable:s,texMatrixTable:i})}a+=l.totalIndexCount,r+=l.totalVertexCount,s+=l.indexData.byteLength,i+=l.vertexBuffers[0].byteLength}const l=new Uint8Array(s),c=new Uint8Array(i);let h=0,d=0;for(let e=0;e<t.length;e++){const a=t[e];l.set(new Uint8Array(a.indexData),h),c.set(new Uint8Array(a.vertexBuffers[0]),d),h+=a.indexData.byteLength,d+=a.vertexBuffers[0].byteLength}return{indexData:l.buffer,vertexBuffers:[c.buffer],totalIndexCount:a,totalVertexCount:r,vertexId:0,packets:o}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);function n(e,t,a,n){r.assert(t+o(a,n.length)<=e.length);let s=t;if(3===a)for(let t=0;t<n.length;t+=4)e[s++]=n[t+0],e[s++]=n[t+1],e[s++]=n[t+2],e[s++]=n[t+0],e[s++]=n[t+2],e[s++]=n[t+3];else if(1===a)for(let t=0;t<n.length-2;t++)t%2==0?(e[s++]=n[t+0],e[s++]=n[t+1],e[s++]=n[t+2]):(e[s++]=n[t+1],e[s++]=n[t+0],e[s++]=n[t+2]);else if(2===a)for(let t=0;t<n.length-2;t++)e[s++]=n[0],e[s++]=n[t+1],e[s++]=n[t+2];else if(4===a)for(let t=0;t<n.length-2;t+=2)e[s++]=n[t+0],e[s++]=n[t+1],e[s++]=n[t+2],e[s++]=n[t+2],e[s++]=n[t+1],e[s++]=n[t+3];else 0===a&&e.set(n,t)}function s(e,t){if(0===e)return t;const a=o(e,t.length),r=new Uint16Array(a);return n(r,0,e,t),r}function i(e,t){switch(e){case 0:return t/3;case 1:case 2:return t-2;case 3:return t/4*2;case 4:return 2*(t-2)}}function o(e,t){return 3*i(e,t)}t.convertToTriangles=n,t.convertToTrianglesRange=function(e,t,a,n,s){r.assert(t+o(a,s)<=e.length);let i=t;if(3===a)for(let t=0;t<s;t+=4)e[i++]=n+t+0,e[i++]=n+t+1,e[i++]=n+t+2,e[i++]=n+t+2,e[i++]=n+t+3,e[i++]=n+t+0;else if(1===a)for(let t=0;t<s-2;t++)t%2==0?(e[i++]=n+t+0,e[i++]=n+t+1,e[i++]=n+t+2):(e[i++]=n+t+1,e[i++]=n+t+0,e[i++]=n+t+2);else if(2===a)for(let t=0;t<s-2;t++)e[i++]=n+0,e[i++]=n+t+1,e[i++]=n+t+2;else if(4===a)for(let t=0;t<s-2;t+=2)e[i++]=n+t+0,e[i++]=n+t+1,e[i++]=n+t+2,e[i++]=n+t+2,e[i++]=n+t+1,e[i++]=n+t+3;else if(0===a)for(let t=0;t<s;t++)e[i++]=n+t},t.convertToTriangleIndexBuffer=s,t.makeTriangleIndexBuffer=function(e,t,a){return s(e,function(e,t){const a=new Uint16Array(t);for(let r=0;r<t;r++)a[r]=e+r;return a}(t,a))},t.getTriangleCountForTopologyIndexCount=i,t.getTriangleIndexCountForTopologyIndexCount=o,t.filterDegenerateTriangleIndexBuffer=function(e){r.assert(e.length%3==0);const t=new Uint16Array(e.length);let a=0;for(let r=0;r<e.length;r+=3){const n=e[r+0],s=e[r+1],i=e[r+2];n===s||s===i||i===n||(t[a++]=n,t[a++]=s,t[a++]=i)}return t.slice(0,a)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.GfxRenderDynamicUniformBuffer=class{constructor(e){this.currentBufferWordSize=-1,this.currentWordOffset=0,this.gfxBuffer=null,this.shadowBufferF32=null,this.shadowBufferU8=null;const t=e.queryLimits();this.uniformBufferWordAlignment=t.uniformBufferWordAlignment,this.uniformBufferMaxPageWordSize=t.uniformBufferMaxPageWordSize}findPageIndex(e){return e/this.uniformBufferMaxPageWordSize|0}allocateChunk(e){e=r.alignNonPowerOfTwo(e,this.uniformBufferWordAlignment),r.assert(e<this.uniformBufferMaxPageWordSize);let t=this.currentWordOffset;return this.findPageIndex(t)!==this.findPageIndex(t+e-1)&&(t=r.alignNonPowerOfTwo(t,this.uniformBufferMaxPageWordSize)),this.currentWordOffset=t+e,t}ensureShadowBuffer(e,t){if(null===this.shadowBufferU8||null===this.shadowBufferF32){const e=r.alignNonPowerOfTwo(this.currentWordOffset,this.uniformBufferMaxPageWordSize);this.shadowBufferU8=new Uint8Array(4*e),this.shadowBufferF32=new Float32Array(this.shadowBufferU8.buffer)}else if(e+t>=this.shadowBufferF32.length){r.assert(e<this.currentWordOffset&&e+t<=this.currentWordOffset);const a=r.alignNonPowerOfTwo(Math.max(this.currentWordOffset,2*this.shadowBufferF32.length),this.uniformBufferMaxPageWordSize),n=new Uint8Array(4*a);n.set(this.shadowBufferU8,0),this.shadowBufferU8=n,this.shadowBufferF32=new Float32Array(this.shadowBufferU8.buffer)}}mapBufferF32(e,t){return this.ensureShadowBuffer(e,t),r.assertExists(this.shadowBufferF32)}prepareToRender(e,t){if(null===this.shadowBufferF32)return;const a=r.assertExists(this.shadowBufferF32);a.length!==this.currentBufferWordSize&&(this.currentBufferWordSize=a.length,null!==this.gfxBuffer&&e.destroyBuffer(this.gfxBuffer),this.gfxBuffer=e.createBuffer(this.currentBufferWordSize,3,2));const n=r.alignNonPowerOfTwo(this.currentWordOffset,this.uniformBufferMaxPageWordSize),s=r.assertExists(this.gfxBuffer);t.uploadBufferData(s,0,this.shadowBufferU8,0,n),this.currentWordOffset=0}destroy(e){null!==this.gfxBuffer&&e.destroyBuffer(this.gfxBuffer),this.shadowBufferF32=null,this.shadowBufferU8=null}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(5);function n(e){return{lightingEnabled:e.lightingEnabled,matColorSource:e.matColorSource,ambColorSource:e.ambColorSource,litMask:e.litMask,diffuseFunction:e.diffuseFunction,attenuationFunction:e.attenuationFunction}}function s(e){return{alphaChannel:n(e.alphaChannel),colorChannel:n(e.colorChannel)}}function i(e){return{type:e.type,source:e.source,matrix:e.matrix,normalize:e.normalize,postMatrix:e.postMatrix}}function o(e){return{colorInA:e.colorInA,colorInB:e.colorInB,colorInC:e.colorInC,colorInD:e.colorInD,colorOp:e.colorOp,colorBias:e.colorBias,colorScale:e.colorScale,colorClamp:e.colorClamp,colorRegId:e.colorRegId,alphaInA:e.alphaInA,alphaInB:e.alphaInB,alphaInC:e.alphaInC,alphaInD:e.alphaInD,alphaOp:e.alphaOp,alphaBias:e.alphaBias,alphaScale:e.alphaScale,alphaClamp:e.alphaClamp,alphaRegId:e.alphaRegId,texCoordId:e.texCoordId,texMap:e.texMap,channelId:e.channelId,konstColorSel:e.konstColorSel,konstAlphaSel:e.konstAlphaSel,indTexStage:e.indTexStage,indTexFormat:e.indTexFormat,indTexBiasSel:e.indTexBiasSel,indTexMatrix:e.indTexMatrix,indTexWrapS:e.indTexWrapS,indTexWrapT:e.indTexWrapT,indTexAddPrev:e.indTexAddPrev,indTexUseOrigLOD:e.indTexUseOrigLOD}}function l(e){return{texture:e.texture,texCoordId:e.texCoordId,scaleS:e.scaleS,scaleT:e.scaleT}}t.GXMaterialBuilder=class{constructor(e=null){this.name=e,this.cullMode=0,this.lightChannels=[],this.texGens=[],this.tevStages=[],this.indTexStages=[],this.alphaTest={},this.setAlphaCompare(7,0,0,7,0),this.ropInfo={},this.setFog(0,!1),this.setBlendMode(0,4,5,0),this.setZMode(!0,3,!0)}setCullMode(e){this.cullMode=e}ensureTexCoordGen(e){return void 0===this.texGens[e]&&(this.texGens[e]={}),this.texGens[e]}setTexCoordGen(e,t,a,r,n=!1,s=125){const i=this.ensureTexCoordGen(e);i.type=t,i.source=a,i.matrix=r,i.normalize=n,i.postMatrix=s}ensureLightChannel(e){return void 0===this.lightChannels[e]&&(this.lightChannels[e]={colorChannel:{},alphaChannel:{}},this.setChanCtrlInternal(this.lightChannels[e].colorChannel,!1,0,0,0,0,2),this.setChanCtrlInternal(this.lightChannels[e].alphaChannel,!1,0,0,0,0,2)),this.lightChannels[e]}setChanCtrlInternal(e,t,a,r,n,s,i){e.lightingEnabled=t,e.ambColorSource=a,e.matColorSource=r,e.litMask=n,e.diffuseFunction=s,e.attenuationFunction=i}setChanCtrl(e,t,a,r,n,s,i){const o=this.ensureLightChannel(1&e),l=1+(e>>>1);1&l&&this.setChanCtrlInternal(o.colorChannel,t,a,r,n,s,i),2&l&&this.setChanCtrlInternal(o.alphaChannel,t,a,r,n,s,i)}ensureTevStage(e){return void 0===this.tevStages[e]&&(this.tevStages[e]={},e<=7?this.setTevOrder(e,0+e,0+e,0):this.setTevOrder(e,255,255,0),this.setTevColorOp(e,0,0,0,!0,0),this.setTevAlphaOp(e,0,0,0,!0,0),this.setTevColorIn(e,15,15,15,8),this.setTevAlphaIn(e,7,7,7,4),this.setTevKColorSel(e,6),this.setTevKAlphaSel(e,0),this.setTevDirect(e)),this.tevStages[e]}setTevOrder(e,t,a,r){const n=this.ensureTevStage(e);n.texCoordId=t,n.texMap=a,n.channelId=r}setTevColorOp(e,t,a,r,n,s){const i=this.ensureTevStage(e);i.colorOp=t,i.colorBias=a,i.colorScale=r,i.colorClamp=n,i.colorRegId=s}setTevAlphaOp(e,t,a,r,n,s){const i=this.ensureTevStage(e);i.alphaOp=t,i.alphaBias=a,i.alphaScale=r,i.alphaClamp=n,i.alphaRegId=s}setTevColorIn(e,t,a,r,n){const s=this.ensureTevStage(e);s.colorInA=t,s.colorInB=a,s.colorInC=r,s.colorInD=n}setTevAlphaIn(e,t,a,r,n){const s=this.ensureTevStage(e);s.alphaInA=t,s.alphaInB=a,s.alphaInC=r,s.alphaInD=n}setTevKColorSel(e,t){this.ensureTevStage(e).konstColorSel=t}setTevKAlphaSel(e,t){this.ensureTevStage(e).konstAlphaSel=t}setTevSwapMode(e,t,a){const r=this.ensureTevStage(e);r.rasSwapTable=t,r.texSwapTable=a}setTevIndirect(e,t,a,r,n,s,i,o,l,c){const h=this.ensureTevStage(e);h.indTexStage=t,h.indTexFormat=a,h.indTexBiasSel=r,h.indTexMatrix=n,h.indTexWrapS=s,h.indTexWrapT=i,h.indTexAddPrev=o,h.indTexUseOrigLOD=l}setTevIndWarp(e,t,a,r,n){const s=a?3:0,i=r?6:0;this.setTevIndirect(e,t,0,s,n,i,i,!1,!1,0)}setTevDirect(e){this.setTevIndirect(e,0,0,0,0,0,0,!1,!1,0)}ensureIndTexStage(e){return void 0===this.indTexStages[e]&&(this.indTexStages[e]={},this.setIndTexScale(e,0,0)),this.indTexStages[e]}setIndTexOrder(e,t,a){const r=this.ensureIndTexStage(e);r.texCoordId=t,r.texture=a}setIndTexScale(e,t,a){const r=this.ensureIndTexStage(e);r.scaleS=t,r.scaleT=a}setAlphaCompare(e,t,a,r,n){this.alphaTest.compareA=e,this.alphaTest.referenceA=t/255,this.alphaTest.op=a,this.alphaTest.compareB=r,this.alphaTest.referenceB=n/255}setFog(e,t){this.ropInfo.fogType=e,this.ropInfo.fogAdjEnabled=t}setBlendMode(e,t,a,r=0){this.ropInfo.blendMode=e,this.ropInfo.blendSrcFactor=t,this.ropInfo.blendDstFactor=a,this.ropInfo.blendLogicOp=r}setZMode(e,t,a){this.ropInfo.depthTest=e,this.ropInfo.depthFunc=t,this.ropInfo.depthWrite=a}setUsePnMtxIdx(e){this.usePnMtxIdx=e}finish(e=null){null===e&&(e=this.name),null===e&&(e="");const t={name:e,cullMode:this.cullMode,lightChannels:this.lightChannels.map(s),texGens:this.texGens.map(i),tevStages:this.tevStages.map(o),indTexStages:this.indTexStages.map(l),alphaTest:(n=this.alphaTest,{compareA:n.compareA,referenceA:n.referenceA,op:n.op,compareB:n.compareB,referenceB:n.referenceB}),ropInfo:(a=this.ropInfo,{fogType:a.fogType,fogAdjEnabled:a.fogAdjEnabled,blendMode:a.blendMode,blendSrcFactor:a.blendSrcFactor,blendDstFactor:a.blendDstFactor,blendLogicOp:a.blendLogicOp,depthTest:a.depthTest,depthFunc:a.depthFunc,depthWrite:a.depthWrite}),usePnMtxIdx:this.usePnMtxIdx};var a,n;return r.autoOptimizeMaterial(t),t}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15)),s=a(0),i=a(87),o=r(a(88));function l(e,t,a){const r=s.align(t,8)*s.align(a,8);switch(e){case 0:return r/2;case 1:case 2:return r;case 3:return 2*r;case 8:return r/2;case 9:return r;case 10:case 4:case 5:return 2*r;case 6:return 4*r;case 14:return r/2;default:throw new Error("whoops")}}t.calcPaletteSize=function(e,t){let a=0;switch(e){case 8:a=16;break;case 9:a=256;break;case 10:a=16384;break;default:throw new Error("whoops")}return 2*a},t.calcTextureSize=l,t.calcMipChain=function(e,t){const a=[],r=e.name;let n=0,s=0;const i=e.format;let o=e.width,c=e.height;for(;s<t;){const t=null!==e.data?e.data.subarray(n):null,r=e.paletteFormat,h=e.paletteData;a.push({name:`${e.name} mip level ${s}`,format:i,width:o,height:c,data:t,paletteFormat:r,paletteData:h,mipCount:1}),s++;const d=l(i,o,c);n+=Math.max(d,32),o/=2,c/=2;const u=2;if(o<=u||c<=u)break}return{name:r,mipLevels:a,fullTextureSize:n}};const c=i.gx_texture_asInstance();function h(e,t,a,r=0){const i=t.width*t.height*4,l=t.data.byteLength,c=s.align(0+r,16),h=s.align(c+i,16),d=s.align(h+l,16),u=new o.default(e.memory).resize(d);u.set(t.data.createTypedArray(Uint8Array),h),a(0,c,h,t.width,t.height);const m=new n.default(u.buffer).copyToBuffer(c,i);return{pixels:new Uint8Array(m)}}function d(e){const t=new Uint8Array(e.width*e.height*4);return t.fill(255),{pixels:t}}function u(e){return e<<4|e}function m(e){return e<<3|e>>>2}function p(e,t){switch(e){case 0:return function(e){const t=e.byteLength>>>1,a=new Uint8Array(4*t),r=e.createDataView();for(let e=0;e<t;e++){const t=r.getUint8(2*e+0),n=r.getUint8(2*e+1);a[4*e+0]=n,a[4*e+1]=n,a[4*e+2]=n,a[4*e+3]=t}return a}(t);case 1:return function(e){const t=e.byteLength>>>1,a=new Uint8Array(4*t),r=e.createDataView();for(let e=0;e<t;e++){const t=r.getUint16(2*e+0);a[4*e+0]=m(t>>11&31),a[4*e+1]=(n=t>>5&63)<<2|n>>>4,a[4*e+2]=m(31&t),a[4*e+3]=255}var n;return a}(t);case 2:return function(e){const t=e.byteLength>>>1,a=new Uint8Array(4*t),r=e.createDataView();for(let e=0;e<t;e++){const t=r.getUint16(2*e+0);32768&t?(a[4*e+0]=m(t>>10&31),a[4*e+1]=m(t>>5&31),a[4*e+2]=m(31&t),a[4*e+3]=255):(a[4*e+0]=u(t>>8&15),a[4*e+1]=u(t>>4&15),a[4*e+2]=u(15&t),a[4*e+3]=(n=t>>12)<<5|n<<2|n>>>1)}var n;return a}(t)}}function f(e,t,a,r){const n=new Uint8Array(e.width*e.height*4);for(let s=0;s<e.height;s+=a)for(let i=0;i<e.width;i+=t)for(let o=0;o<a;o++)for(let a=0;a<t;a++){r(n,4*(e.width*(s+o)+i+a))}return{pixels:n}}function A(e){switch(s.assertExists(e)){case 0:return"IA8";case 1:return"RGB565";case 2:return"RGB5A3";default:return"invalid"}}t.getFormatName=function(e,t){switch(e){case 0:return"I4";case 1:return"I8";case 2:return"IA4";case 3:return"IA8";case 4:return"RGB565";case 5:return"RGB5A3";case 6:return"RGBA8";case 14:return"CMPR";case 8:return`C4 (${A(t)})`;case 9:return`C8 (${A(t)})`;case 10:return`C14X2 (${A(t)})`;default:return"invalid"}},t.decodeTexture=function(e){return null===e.data?Promise.resolve(d(e)):c.then(t=>{switch(e.format){case 0:return h(t,e,t.decode_I4);case 1:return h(t,e,t.decode_I8);case 2:return h(t,e,t.decode_IA4);case 3:return h(t,e,t.decode_IA8);case 4:return h(t,e,t.decode_RGB565);case 5:return h(t,e,t.decode_RGB5A3);case 6:return h(t,e,t.decode_RGBA8);case 14:return h(t,e,t.decode_CMPR,16);case 8:return function(e){if(!e.paletteData||!e.paletteFormat)return d(e);const t=e.data.createDataView(),a=p(e.paletteFormat,e.paletteData);let r=0;return f(e,8,8,(e,n)=>{const s=t.getUint8(r>>1)>>>(1&r?0:4)&15;e[n+0]=a[4*s+0],e[n+1]=a[4*s+1],e[n+2]=a[4*s+2],e[n+3]=a[4*s+3],r++})}(e);case 9:return function(e){if(!e.paletteData||!e.paletteFormat)return d(e);const t=e.data.createDataView(),a=p(e.paletteFormat,e.paletteData);let r=0;return f(e,8,4,(e,n)=>{const s=t.getUint8(r);e[n+0]=a[4*s+0],e[n+1]=a[4*s+1],e[n+2]=a[4*s+2],e[n+3]=a[4*s+3],r++})}(e);case 10:return function(e){if(!e.paletteData||!e.paletteFormat)return d(e);const t=e.data.createDataView(),a=p(e.paletteFormat,e.paletteData);let r=0;return f(e,4,4,(e,n)=>{const s=16383&t.getUint16(r);e[n+0]=a[4*s+0],e[n+1]=a[4*s+1],e[n+2]=a[4*s+2],e[n+3]=a[4*s+3],r+=2})}(e);default:return console.error(`Unsupported texture format ${e.format} on texture ${e.name}`),d(e)}})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(5),s=a(35);function i(e,t){const a=e.createDataView(),n=a.getUint8(0),s=a.getUint16(2),i=a.getUint16(4),o=a.getUint8(6),l=a.getUint8(7),c=a.getUint8(9),h=a.getUint16(10),d=a.getUint32(12),u=a.getUint8(20),m=a.getUint8(21),p=1*a.getInt8(22)/8,f=1*a.getInt8(23)/8,A=a.getUint8(24),g=1*a.getInt16(26)/100,_=a.getUint32(28);r.assert(0===p);let S=null;0!==_&&(S=e.slice(_));let b=null;return 0!==d&&(b=e.subarray(d,2*h)),{name:t,format:n,width:s,height:i,wrapS:o,wrapT:l,minFilter:u,magFilter:m,minLOD:p,maxLOD:f,mipCount:A,lodBias:g,data:S,paletteFormat:c,paletteData:b}}t.readBTI_Texture=i;class o{static parse(e,t){const a=new o;return a.texture=i(e,t),a}}function l(e,t,a){const[r,s]=n.translateTexFilterGfx(a.minFilter),[i]=n.translateTexFilterGfx(a.magFilter);return t.createSampler(e,{wrapS:n.translateWrapModeGfx(a.wrapS),wrapT:n.translateWrapModeGfx(a.wrapT),minFilter:r,mipFilter:s,magFilter:i,minLOD:a.minLOD,maxLOD:a.maxLOD})}t.BTI=o,t.translateSampler=l;t.BTIData=class{constructor(e,t,a){this.btiTexture=a,this.gfxSampler=l(e,t,a);const r=s.calcMipChain(this.btiTexture,this.btiTexture.mipCount),{viewerTexture:i,gfxTexture:o}=n.loadTextureFromMipChain(e,r);this.gfxTexture=o,this.viewerTexture=i}fillTextureMapping(e){return e.gfxTexture=this.gfxTexture,e.gfxSampler=this.gfxSampler,e.lodBias=this.btiTexture.lodBias,e.width=this.btiTexture.width,e.height=this.btiTexture.height,!0}destroy(e){e.destroyTexture(this.gfxTexture)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(4),n=a(8),s=a(1),i=a(0),o=a(11),l=a(2);function c(e,t,a,r){for(let n=0;n<t;n+=a)r(n,e(n))}t.stepF=c;t.Graph=class{constructor(e){this.minv=void 0,this.maxv=void 0,this.mx=0,this.my=0,this.ctx=e,this.ctx.canvas.onmousemove=e=>{this.mx=e.offsetX,this.my=e.offsetY}}clear(){const e=this.ctx;e.fillStyle="white",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.strokeStyle="#aaaaaa",e.lineWidth=1,e.beginPath(),e.moveTo(0,this.my+.5),e.lineTo(e.canvas.width,this.my+.5),e.stroke()}hline(e,t){const a=this.ctx,r=(1-(t-this.minv)/(this.maxv-this.minv))*a.canvas.height;a.strokeStyle=e,a.lineWidth=2,a.beginPath(),a.moveTo(0,r),a.lineTo(a.canvas.width,r),a.stroke()}dot(e,t,a,r=5){i.assert(t>=0&&t<=1);const n=this.ctx;n.fillStyle=e,n.beginPath();const s=(a-this.minv)/(this.maxv-this.minv),o=t*n.canvas.width,l=(1-s)*n.canvas.height;n.arc(o,l,r,0,2*Math.PI),n.closePath(),n.fill()}marker(e,t){i.assert(t>=0&&t<=1);const a=this.ctx;a.strokeStyle=e,a.lineWidth=1,a.beginPath();const r=t*a.canvas.width;a.moveTo(r,0),a.lineTo(r,a.canvas.height),a.stroke()}graphF(e,t,a,r=1){c(t,a,r,(e,t)=>{void 0===this.minv&&(this.minv=t),void 0===this.maxv&&(this.maxv=t),this.minv=Math.min(this.minv,t),this.maxv=Math.max(this.maxv,t)});const n=this.ctx;n.strokeStyle=e,n.lineWidth=2,n.beginPath(),c(t,a,r,(e,t)=>{const r=e/a,s=(t-this.minv)/(this.maxv-this.minv),i=r*n.canvas.width,o=(1-s)*n.canvas.height;n.lineTo(i,o)}),n.stroke()}},t.cv=function(){const e=document.createElement("canvas");e.width=800,e.height=400;const t=i.assertExists(e.getContext("2d"));return t.fillStyle="white",t.fillRect(0,0,e.width,e.height),e.style.position="absolute",e.style.top="0",e.style.left="0",[].forEach.call(document.querySelectorAll("canvas.cv"),e=>document.body.removeChild(e)),e.classList.add("cv"),document.body.appendChild(e),t};let h=null;function d(){null!==h&&(h.canvas.style.width=`${window.innerWidth}px`,h.canvas.style.height=`${window.innerHeight}px`,h.canvas.width=window.innerWidth*window.devicePixelRatio,h.canvas.height=window.innerHeight*window.devicePixelRatio)}t.getDebugOverlayCanvas2D=function(){if(null===h){const e=document.createElement("canvas"),t=i.assertExists(e.getContext("2d"));e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.pointerEvents="none",document.body.appendChild(e),h=t,d()}return h},t.prepareFrameDebugOverlayCanvas2D=d;const u=i.nArray(8,()=>s.vec4.create());function m(e,t,a){for(let e=0;e<a;e++)s.vec4.transformMat4(u[e],u[e],t.clipFromWorldMatrix),n.divideByW(u[e],u[e])}function p(e){return e[0]<-1||e[0]>1||e[1]<-1||e[1]>1||e[2]<-1||e[2]>1}function f(e,t,a){if(p(t)||p(a))return;const r=e.canvas.width,n=e.canvas.height;e.moveTo((t[0]+1)*r/2,(1-t[1])*n/2),e.lineTo((a[0]+1)*r/2,(1-a[1])*n/2)}t.drawWorldSpaceLine=function(e,t,a,n,i=r.Magenta,o=2){s.vec4.set(u[0],a[0],a[1],a[2],1),s.vec4.set(u[1],n[0],n[1],n[2],1),m(0,t,2),e.beginPath(),f(e,u[0],u[1]),e.closePath(),e.lineWidth=o,e.strokeStyle=r.colorToCSS(i),e.stroke()};const A=s.vec3.create(),g=s.vec3.create();function _(e,t,a,n,i,o=r.Magenta,l=2){s.vec4.set(u[0],a[0],a[1],a[2],1),s.vec4.set(u[1],a[0]+n[0]*i,a[1]+n[1]*i,a[2]+n[2]*i,1),m(0,t,2),e.beginPath(),f(e,u[0],u[1]),e.closePath(),e.lineWidth=l,e.strokeStyle=r.colorToCSS(o),e.stroke()}function S(e,t,a,n=r.Magenta,s=4){const i=s>>>1;e.fillStyle=r.colorToCSS(n),e.fillRect(t-i,e.canvas.height-(a-i),s,s)}function b(e,t,a){let r=0,n=e.length;const s=()=>{let e=r+(n-r)/2|0;const a=Math.ceil(Math.log2(n-r));console.log(`Set bounds are ${r} to ${n}. Test set bounds are now ${e} to ${n}. ${a} step(s) left`);for(let a=0;a<n;a++){t(a,a>=e&&a<n)}};return s(),e=>{if(i.assert(n>r),n-r<=2)return a(e?r+1:r);e?r=r+(n-r)/2|0:n=1+(r+(n-r)/2|0),s()}}function v(e,t=0){e.visible=t%2==1,t<7&&setTimeout(()=>{v(e,t+1)},200)}function w(e,t,a){const r=window.main.ui.makeFloatingPanel("SliderSelect"),n=new o.Slider;n.elem.querySelector("input").classList.remove("Slider"),r.contents.append(n.elem);const s=document.createElement("div");s.textContent="Select",s.style.background="#333",s.style.cursor="pointer",s.style.padding="1em",r.contents.append(s),n.setRange(0,e.length,1),n.onvalue=a=>{n.setLabel(""+a);for(let r=0;r<e.length;r++)t(r,r<=a)},n.setValue(e.length),n.setLabel(""+e.length),s.onclick=()=>{const e=n.getValue();r.destroy(),a(e)}}t.drawWorldSpaceBasis=function(e,t,a,n=100,s=2){l.getMatrixTranslation(A,a),l.getMatrixAxisX(g,a),_(e,t,A,g,n,r.Red,s),l.getMatrixAxisY(g,a),_(e,t,A,g,n,r.Green,s),l.getMatrixAxisZ(g,a),_(e,t,A,g,n,r.Blue,s)},t.drawWorldSpaceVector=_,t.drawWorldSpaceAABB=function(e,t,a,n=r.Magenta){s.vec4.set(u[0],a.minX,a.minY,a.minZ,1),s.vec4.set(u[1],a.maxX,a.minY,a.minZ,1),s.vec4.set(u[2],a.minX,a.maxY,a.minZ,1),s.vec4.set(u[3],a.maxX,a.maxY,a.minZ,1),s.vec4.set(u[4],a.minX,a.minY,a.maxZ,1),s.vec4.set(u[5],a.maxX,a.minY,a.maxZ,1),s.vec4.set(u[6],a.minX,a.maxY,a.maxZ,1),s.vec4.set(u[7],a.maxX,a.maxY,a.maxZ,1),m(0,t,8),e.beginPath(),f(e,u[0],u[1]),f(e,u[1],u[3]),f(e,u[3],u[2]),f(e,u[2],u[0]),f(e,u[4],u[5]),f(e,u[5],u[7]),f(e,u[7],u[6]),f(e,u[6],u[4]),f(e,u[0],u[4]),f(e,u[1],u[5]),f(e,u[2],u[6]),f(e,u[3],u[7]),e.closePath(),e.lineWidth=2,e.strokeStyle=r.colorToCSS(n),e.stroke()},t.drawViewportSpacePoint=S,t.drawWorldSpacePoint=function(e,t,a,n=r.Magenta,i=4){const o=e.canvas.width,l=e.canvas.height;s.vec4.set(u[0],a[0],a[1],a[2],1),m(0,t,1),p(u[0])||S(e,(u[0][0]+1)*o/2,(u[0][1]+1)*l/2,n,i)},t.drawWorldSpaceText=function(e,t,a,n,i=0,o=r.Magenta,l={}){var c,h,d;const f=e.canvas.width,A=e.canvas.height;if(s.vec4.set(u[0],a[0],a[1],a[2],1),m(0,t,1),p(u[0]))return;const g=(u[0][0]+1)*f/2,_=(1-u[0][1])*A/2;if(e.fillStyle=r.colorToCSS(o),e.textBaseline="bottom",e.textAlign="start",e.font=null!=(c=l.font)?c:"14pt monospace",l.outline){const t=e.lineWidth;e.lineWidth=l.outline,e.strokeText(n,g,_+i),e.lineWidth=t}e.shadowColor=null!=(h=l.shadowColor)?h:"black",e.shadowBlur=null!=(d=l.shadowBlur)?d:0,e.fillText(n,g,_+i),e.shadowColor="black",e.shadowBlur=0},t.drawScreenSpaceProjection=function(e,t,a=r.Magenta){const n=e.canvas.width,s=e.canvas.height,i=(t.projectedMinX+1)*n/2,o=(t.projectedMaxX+1)*n/2,l=(1-t.projectedMinY)*s/2,c=(1-t.projectedMaxY)*s/2;e.beginPath(),e.rect(i,l,o-i,c-l),e.closePath(),e.lineWidth=2,e.strokeStyle=r.colorToCSS(a),e.stroke()},t.interactiveBisect=b,t.interactiveVisTestBisect=function(e){const t=e.filter(e=>e.visible),a=b(t,(e,a)=>{t[e].visible=a},a=>{t.forEach(e=>e.visible=!0);const r=t[a];console.log(`Found item @ ${e.indexOf(r)}:`,r),v(r),delete window.visible,delete window.invisible});window.visible=()=>{a(!0)},window.invisible=()=>{a(!1)}},t.interactiveSliderSelect=w,t.interactiveVizSliderSelect=function(e,t=null){const a=e.filter(e=>e.visible);w(a,(e,t)=>{a[e].visible=t},r=>{a.forEach(e=>e.visible=!0);const n=a[r],s=e.indexOf(n);v(n),console.log(`Found item @ ${e.indexOf(n)}:`,n),null!==t&&t(s)})}},function(e,t,a){"use strict";function r(e){return e}function n(e,t,a){return e<<16|t<<8|a}function s(e){return e>>>8&255}function i(e){return e>>>16&255}function o(e){switch(e){case 8:case 3:case 6:return 4;case 2:case 5:case 7:return 2;case 1:case 4:return 1;default:throw"whoops"}}Object.defineProperty(t,"__esModule",{value:!0}),t.getFormatCompFlagsComponentCount=r,t.makeFormat=n,function(e){e[e.F16_RG=n(7,2,0)]="F16_RG",e[e.F16_RGBA=n(7,4,0)]="F16_RGBA",e[e.F32_R=n(8,1,0)]="F32_R",e[e.F32_RG=n(8,2,0)]="F32_RG",e[e.F32_RGB=n(8,3,0)]="F32_RGB",e[e.F32_RGBA=n(8,4,0)]="F32_RGBA",e[e.U8_R=n(1,1,0)]="U8_R",e[e.U8_R_NORM=n(1,1,1)]="U8_R_NORM",e[e.U8_RG=n(1,2,0)]="U8_RG",e[e.U8_RG_NORM=n(1,2,1)]="U8_RG_NORM",e[e.U8_RGB=n(1,3,0)]="U8_RGB",e[e.U8_RGB_NORM=n(1,3,1)]="U8_RGB_NORM",e[e.U8_RGB_SRGB=n(1,3,2)]="U8_RGB_SRGB",e[e.U8_RGBA=n(1,4,0)]="U8_RGBA",e[e.U8_RGBA_NORM=n(1,4,1)]="U8_RGBA_NORM",e[e.U8_RGBA_SRGB=n(1,4,2)]="U8_RGBA_SRGB",e[e.U16_R=n(2,1,0)]="U16_R",e[e.U16_R_NORM=n(2,1,1)]="U16_R_NORM",e[e.U16_RG_NORM=n(2,2,1)]="U16_RG_NORM",e[e.U16_RGBA_NORM=n(2,4,1)]="U16_RGBA_NORM",e[e.U16_RGB=n(2,3,0)]="U16_RGB",e[e.U32_R=n(3,1,0)]="U32_R",e[e.U32_RG=n(3,2,0)]="U32_RG",e[e.S8_R=n(4,1,0)]="S8_R",e[e.S8_R_NORM=n(4,1,1)]="S8_R_NORM",e[e.S8_RG_NORM=n(4,1,1)]="S8_RG_NORM",e[e.S8_RGB_NORM=n(4,3,1)]="S8_RGB_NORM",e[e.S8_RGBA_NORM=n(4,4,1)]="S8_RGBA_NORM",e[e.S16_R=n(5,1,0)]="S16_R",e[e.S16_RG=n(5,2,0)]="S16_RG",e[e.S16_RG_NORM=n(5,2,1)]="S16_RG_NORM",e[e.S16_RGB_NORM=n(5,3,1)]="S16_RGB_NORM",e[e.S16_RGBA=n(5,4,0)]="S16_RGBA",e[e.S16_RGBA_NORM=n(5,4,1)]="S16_RGBA_NORM",e[e.S32_R=n(6,1,0)]="S32_R",e[e.BC1=n(65,4,0)]="BC1",e[e.BC1_SRGB=n(65,4,2)]="BC1_SRGB",e[e.BC2=n(66,4,0)]="BC2",e[e.BC2_SRGB=n(66,4,2)]="BC2_SRGB",e[e.BC3=n(67,4,0)]="BC3",e[e.BC3_SRGB=n(67,4,2)]="BC3_SRGB",e[e.D24=n(129,1,4)]="D24",e[e.D24_S8=n(131,2,12)]="D24_S8",e[e.D32F=n(130,1,4)]="D32F",e[e.D32F_S8=n(132,2,12)]="D32F_S8"}(t.GfxFormat||(t.GfxFormat={})),t.getFormatCompFlags=s,t.getFormatTypeFlags=i,t.getFormatFlags=function(e){return 255&e},t.getFormatTypeFlagsByteSize=o,t.getFormatCompByteSize=function(e){return o(i(e))},t.getFormatComponentCount=function(e){return s(e)},t.getFormatByteSize=function(e){return o(i(e))*s(e)},t.setFormatFlags=function(e,t){return 4294967040&e|t},t.setFormatComponentCount=function(e,t){return 4294902015&e|t<<8}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=r(a(138)),i=r(a(27));function o(e,t){return e.files.find(e=>e.name.toLowerCase()===t.toLowerCase())||null}t.findFileInDir=o,t.findFileDataInDir=function(e,t){const a=o(e,t);return a?a.buffer:null};class l{findDirParts(e){let t=this.root;for(let a=0;a<e.length;a++){const r=e[a];if(t=t.subdirs.find(e=>e.name.toLowerCase()===r),void 0===t)return null}return t}findDir(e){return this.findDirParts(e.toLowerCase().split("/"))}findFile(e){const t=(e=e.toLowerCase()).split("/"),a=t.pop(),r=this.findDirParts(t);return null===r?null:o(r,a)}findFileData(e){const t=this.findFile(e);return null===t?null:t.buffer}}t.JKRArchive=l,t.parse=function(e,t=null){const a=e.createDataView();n.assert("RARC"===n.readString(e,0,4)),a.getUint32(4);const r=a.getUint32(12)+32,o=a.getUint32(32),c=a.getUint32(36)+32,h=(a.getUint32(40),a.getUint32(44)+32),d=a.getUint32(52)+32;let u=c;const m=[],p=[];for(let l=0;l<o;l++){const o=n.readString(e,u+0,4,!1),l=a.getUint32(u+4),c=n.readString(e,d+l,-1,!0),f=(a.getUint16(u+8),a.getUint16(u+10)),A=[],g=[];let _=h+20*a.getUint32(u+12);for(let o=0;o<f;o++){const o=(_-h)/20,l=a.getUint16(_+0),c=(a.getUint16(_+2),a.getUint32(_+4));let u=c>>>24&255;const m=16777215&c,f=n.readString(e,d+m,-1,!0),S=a.getUint32(_+8),b=a.getUint32(_+12);if(_+=20,"."!==f&&".."!==f)if(!!(2&u)){const e=S;g.push(e)}else{const a=r+S,n=e.slice(a,a+b);let c,h=0;if(4&u&&(h=128&u?2:1),0!==h&&null!==t)if(2===h)c=i.decompressSync(t,n),h=0;else{if(1!==h)throw"whoops";c=s.decompress(n),h=0}else c=n;c.name=f;const d={index:o,id:l,name:f,flags:u,compressionType:h,buffer:c};A.push(d),p.push(d)}}m.push({name:c,type:o,files:A,subdirIndexes:g}),u+=16}const f=[],A=function e(t){if(void 0!==f[t])return f[t];const a=m[t],r={name:a.name,type:a.type,files:a.files,subdirs:a.subdirIndexes.map(t=>e(t))};return f[t]=r,r}(0);n.assert("ROOT"===A.type);const g=new l;return g.files=p,g.root=A,g}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(221);function n(e){return 8192|e}t.createFilterKeyForDrawBufferType=function(e,t){return 0===e?512|t:256|t},t.createFilterKeyForDrawType=n;class s{constructor(e,t){this.name=t,this.nameObjExecuteInfoIndex=-1,e.nameObjHolder.add(this)}initAfterPlacement(e){}movement(e,t){}calcAnim(e,t){}calcViewAndEntry(e,t){}draw(e,t,a){}scenarioChanged(e){}destroy(e){}static requestArchives(e,t){}}t.NameObj=s;class i{setConnectInfo(e,t,a,r,n,s){this.nameObj=t,this.movementType=a,this.calcAnimType=r,this.drawBufferType=n,this.drawType=s,-1!==n&&(this.drawBufferIndex=e.drawBufferHolder.registerDrawBuffer(t,n))}}t.NameObjGroup=class extends s{constructor(e,t,a){super(e,t),this.maxCount=a,this.objArray=[]}registerObj(e){this.objArray.push(e)}};t.NameObjHolder=class{constructor(){this.nameObjs=[]}add(e){this.nameObjs.push(e)}initAfterPlacement(e){for(let t=0;t<this.nameObjs.length;t++)this.nameObjs[t].initAfterPlacement(e)}scenarioChanged(e){for(let t=0;t<this.nameObjs.length;t++)this.nameObjs[t].scenarioChanged(e)}destroy(e){for(let t=0;t<this.nameObjs.length;t++)this.nameObjs[t].destroy(e)}};t.SceneNameObjListExecutor=class{constructor(){this.nameObjExecuteInfos=[],this.drawBufferHolder=new r.DrawBufferHolder(r.drawBufferInitialTable)}registerActor(e,t,a,r,n){const s=new i;s.setConnectInfo(this,e,t,a,r,n),e.nameObjExecuteInfoIndex=this.nameObjExecuteInfos.length,this.nameObjExecuteInfos.push(s)}findLightInfo(e){const t=this.nameObjExecuteInfos[e.nameObjExecuteInfoIndex];return this.drawBufferHolder.findLightInfo(t.nameObj,t.drawBufferType,t.drawBufferIndex)}findLightType(e){const t=this.nameObjExecuteInfos[e.nameObjExecuteInfoIndex];return this.drawBufferHolder.findLightType(t.drawBufferType)}executeMovement(e,t){for(let a=0;a<this.nameObjExecuteInfos.length;a++)-1!==this.nameObjExecuteInfos[a].movementType&&this.nameObjExecuteInfos[a].nameObj.movement(e,t)}executeCalcAnim(e,t){for(let a=0;a<this.nameObjExecuteInfos.length;a++)-1!==this.nameObjExecuteInfos[a].calcAnimType&&this.nameObjExecuteInfos[a].nameObj.calcAnim(e,t)}executeDrawAll(e,t,a){for(let r=0;r<this.nameObjExecuteInfos.length;r++){const s=this.nameObjExecuteInfos[r],i=s.nameObj;if(-1!==this.nameObjExecuteInfos[r].drawBufferType&&i.calcViewAndEntry(e,a),-1!==this.nameObjExecuteInfos[r].drawType){t.pushTemplateRenderInst().filterKey=n(s.drawType),i.draw(e,t,a),t.popTemplateRenderInst()}}}drawAllBuffers(e,t,a,r){this.drawBufferHolder.drawAllBuffers(e,t,a,r)}drawBufferHasVisible(e){return this.drawBufferHolder.drawBufferHasVisible(e)}setIndirectTextureOverride(e){for(let t=0;t<this.nameObjExecuteInfos.length;t++)if(-1!==this.nameObjExecuteInfos[t].drawBufferType){this.nameObjExecuteInfos[t].nameObj.setIndirectTextureOverride(e)}}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(29)),s=a(1),i=a(5),o=a(5),l=a(8),c=a(12),h=a(7),d=a(0),u=a(37),m=a(4),p=a(2);class f extends i.GXTextureHolder{addRRESTextures(e,t){this.addTextures(e,t.tex0)}}t.RRESTextureHolder=f;class A{constructor(){this.jointToWorldMatrixVisibility=[],this.jointToWorldMatrixArray=[],this.jointToWorldMatrixAttribs=[],this.drawViewMatrixArray=[],this.lightSetting=null}}t.MDL0Model=class{constructor(e,t,a,r){this.mdl0=a,this.materialHacks=r,this.shapeData=[],this.materialData=[],this.bufferCoalescer=i.loadedDataCoalescerComboGfx(e,this.mdl0.shapes.map(e=>e.loadedVertexData));for(let a=0;a<this.mdl0.shapes.length;a++){const r=this.mdl0.shapes[a];this.shapeData[a]=new o.GXShapeHelperGfx(e,t,this.bufferCoalescer.coalescedBuffers[a],r.loadedVertexLayout,r.loadedVertexData)}for(let t=0;t<this.mdl0.materials.length;t++){const a=this.mdl0.materials[t];this.materialData[t]=new N(e,a,this.materialHacks)}}destroy(e){for(let t=0;t<this.shapeData.length;t++)this.shapeData[t].destroy(e);for(let t=0;t<this.materialData.length;t++)this.materialData[t].destroy(e);this.bufferCoalescer.destroy(e)}};const g=new c.AABB,_=new i.PacketParams;class S{constructor(e,t,a,r){this.shape=e,this.shapeData=t,this.sortVizNode=a,this.materialInstance=r,this.sortKeyBias=0}prepareToRender(e,t,a,r,n,i,o,l){const d=this.materialInstance;if(!d.visible)return;const u=a.pushTemplateRenderInst();u.sortKey=d.sortKey,u.sortKey=h.setSortKeyDepth(u.sortKey,r),u.sortKey=h.setSortKeyBias(u.sortKey,this.sortKeyBias),d.setOnRenderInst(e,a.gfxRenderCache,u);const m=this.shape.mtxIdx<0;m||d.fillMaterialParams(u,t,o,this.shape.mtxIdx,null,n,i),_.clear();for(let e=0;e<this.shape.loadedVertexData.packets.length;e++){const r=this.shape.loadedVertexData.packets[e];let l=!1;if(m)for(let e=0;e<r.posNrmMatrixTable.length;e++){const t=r.posNrmMatrixTable[e];65535!==t&&(s.mat4.copy(_.u_PosMtx[e],o.drawViewMatrixArray[t]),o.jointToWorldMatrixVisibility[e]!==c.IntersectionState.FULLY_OUTSIDE&&(l=!0))}else l=!0,s.mat4.copy(_.u_PosMtx[0],o.drawViewMatrixArray[this.shape.mtxIdx]);if(!l)continue;const h=a.newRenderInst();this.shapeData.setOnRenderInst(h,r),this.shapeData.fillPacketParams(_,h),m&&d.fillMaterialParams(h,t,o,this.shape.mtxIdx,r,n,i),a.submitRenderInst(h)}a.popTemplateRenderInst()}}function b(e){return Object.assign({},e)}function v(e){return{colorChannel:b(e.colorChannel),alphaChannel:b(e.alphaChannel)}}const w=new i.MaterialParams;class x{constructor(e,t){this.modelInstance=e,this.materialData=t,this.srt0Animators=[],this.pat0Animators=[],this.clr0Animators=[],this.sortKey=0,this.visible=!0;const a=Object.assign({},t.material.gxMaterial);a.lightChannels=function(e,t){const a=Array(e.length);for(let r=0;r<e.length;r++)a[r]=t(e[r]);return a}(a.lightChannels,v),a.useTexMtxIdx=d.nArray(8,()=>!1),this.materialHelper=new o.GXMaterialHelperGfx(a,t.materialHacks);const r=this.materialData.material.translucent?128:32;this.setSortKeyLayer(r)}setSkinningEnabled(e){for(let t=0;t<this.materialData.material.texSrts.length;t++){const a=this.materialData.material.texSrts[t].mapMode;1!==a&&4!==a&&3!==a||(this.materialHelper.material.useTexMtxIdx[t]=e)}this.materialHelper.createProgram()}setSortKeyLayer(e){this.materialData.material.translucent&&(e|=128),this.sortKey=h.makeSortKey(e)}setMaterialHacks(e){this.materialHelper.setMaterialHacks(e)}bindSRT0(e,t){if(null!==t){const a=this.materialData.material;for(let r=0;r<n.TexMtxIndex.COUNT;r++){const s=n.bindSRT0Animator(d.assertExists(e),t,a.name,r);s&&(this.srt0Animators[r]=s)}}else for(let e=0;e<n.TexMtxIndex.COUNT;e++)this.srt0Animators[e]=null}bindPAT0(e,t){if(null!==t){const a=this.materialData.material;for(let r=0;r<8;r++){const s=n.bindPAT0Animator(d.assertExists(e),t,a.name,r);s&&(this.pat0Animators[r]=s)}}else for(let e=0;e<8;e++)this.pat0Animators[e]=null}bindCLR0(e,t){if(null!==t){const a=this.materialData.material;for(let r=0;r<n.AnimatableColor.COUNT;r++){const s=n.bindCLR0Animator(d.assertExists(e),t,a.name,r);s&&(this.clr0Animators[r]=s)}}else for(let e=0;e<n.AnimatableColor.COUNT;e++)this.clr0Animators[e]=null}calcIndTexMatrix(e,t){const a=this.materialData.material,r=n.TexMtxIndex.IND0+t;let i,o,l,c,h,d,u;if(this.srt0Animators[r])this.srt0Animators[r].calcIndTexMtx(e),i=e[0],l=e[4],h=e[12],u=1,o=e[1],c=e[5],d=e[13];else{const e=a.indTexMatrices[t];i=e[0],l=e[1],h=e[2],u=e[3],o=e[4],c=e[5],d=e[6]}s.mat4.set(e,i,o,0,0,l,c,0,0,h,d,0,0,u,0,0,0)}calcTexAnimMatrix(e,t){const a=this.materialData.material,r=n.TexMtxIndex.TEX0+t;this.srt0Animators[r]?this.srt0Animators[r].calcTexMtx(e):s.mat4.copy(e,a.texSrts[r].srtMtx)}calcTexMatrix(e,t,a,r){const n=this.materialData.material.texSrts[t],i=e.m_TextureMapping[t].flipY?-1:1,o=e.u_PostTexMtx[t];0!==n.mapMode?(2===n.mapMode?(l.texProjCameraSceneTex(o,a,r,i),s.mat4.mul(o,n.effectMtx,o),31!==n.refCamera&&1!==n.refCamera||(o[0]=0,o[5]=0)):1===n.mapMode?(p.texEnvMtx(o,.5,.5*i,.5,.5),s.mat4.mul(o,n.effectMtx,o)):s.mat4.identity(o),this.calcTexAnimMatrix(O,t),function(e){const t=e[12];e[12]=e[8],e[8]=t;const a=e[13];e[13]=e[9],e[9]=a}(O),s.mat4.mul(o,O,o)):this.calcTexAnimMatrix(o,t)}calcColor(e,t,a,r){const n=e.u_Color[t];let s;s=this.modelInstance&&this.modelInstance.colorOverrides[t]?this.modelInstance.colorOverrides[t]:a,this.clr0Animators[r]?this.clr0Animators[r].calcColor(n,s):m.colorCopy(n,s)}fillMaterialParamsData(e,t,a,r,s=null,l,c){const h=this.materialData.material;for(let a=0;a<8;a++){const r=e.m_TextureMapping[a];r.reset();const n=h.samplers[a];n&&(this.fillTextureMapping(r,t,a),r.lodBias=n.lodBias)}for(let t=0;t<10;t++){let n;if(null!==s){if(n=s.texMatrixTable[t],65535===n)continue}else n=r;p.computeNormalMatrix(e.u_TexMtx[t],a.drawViewMatrixArray[n])}for(let t=0;t<8;t++)this.calcTexMatrix(e,t,l,c);for(let t=0;t<3;t++)this.calcIndTexMatrix(e.u_IndTexMtx[t],t);this.calcColor(e,i.ColorKind.MAT0,h.colorMatRegs[0],n.AnimatableColor.MAT0),this.calcColor(e,i.ColorKind.MAT1,h.colorMatRegs[1],n.AnimatableColor.MAT1),this.calcColor(e,i.ColorKind.AMB0,h.colorAmbRegs[0],n.AnimatableColor.AMB0),this.calcColor(e,i.ColorKind.AMB1,h.colorAmbRegs[1],n.AnimatableColor.AMB1),this.calcColor(e,i.ColorKind.K0,h.colorConstants[0],n.AnimatableColor.K0),this.calcColor(e,i.ColorKind.K1,h.colorConstants[1],n.AnimatableColor.K1),this.calcColor(e,i.ColorKind.K2,h.colorConstants[2],n.AnimatableColor.K2),this.calcColor(e,i.ColorKind.K3,h.colorConstants[3],n.AnimatableColor.K3),this.calcColor(e,i.ColorKind.CPREV,h.colorRegisters[0],-1),this.calcColor(e,i.ColorKind.C0,h.colorRegisters[1],n.AnimatableColor.C0),this.calcColor(e,i.ColorKind.C1,h.colorRegisters[2],n.AnimatableColor.C1),this.calcColor(e,i.ColorKind.C2,h.colorRegisters[3],n.AnimatableColor.C2);const d=a.lightSetting;if(null!==d){const t=d.lightSet[this.materialData.material.lightSetIdx];void 0!==t&&(t.calcLights(e.u_Lights,d,l.viewMatrix),t.calcAmbColorCopy(e.u_Color[i.ColorKind.AMB0],d),t.calcLightSetLitMask(this.materialHelper.material.lightChannels,d)&&(this.materialHelper.material.hasLightsBlock=void 0,o.autoOptimizeMaterial(this.materialHelper.material),this.materialHelper.calcMaterialParamsBufferSize(),this.materialHelper.createProgram()))}}fillTextureMapping(e,t,a){const r=this.materialData.material;if(e.reset(),this.pat0Animators[a])this.pat0Animators[a].fillTextureMapping(e,t);else{const n=r.samplers[a].name;t.fillTextureMapping(e,n)}e.gfxSampler=this.materialData.gfxSamplers[a]}setOnRenderInst(e,t,a){this.materialHelper.setOnRenderInst(e,t,a)}fillMaterialParams(e,t,a,r,n,s,o){this.fillMaterialParamsData(w,t,a,r,n,s,o);const l=e.allocateUniformBuffer(i.ub_MaterialParams,this.materialHelper.materialParamsBufferSize);this.materialHelper.fillMaterialParamsDataOnInst(e,l,w),e.setSamplerBindingsFromTextureMappings(w.m_TextureMapping)}destroy(e){}}function T(e,t){return Math.hypot(e[t+0],e[t+1],e[t+2])}function y(e,t,a,r,n,s,i,o,l,c,h,d,u){e[0]=t*n,e[1]=t*s,e[2]=t*i,e[3]=0,e[4]=a*o,e[5]=a*l,e[6]=a*c,e[7]=0,e[8]=r*h,e[9]=r*d,e[10]=r*u,e[11]=0}const C=d.nArray(3,()=>s.vec3.create());function M(e,t,a,r=C[0]){s.vec3.set(r,e[4],e[5],0),s.vec3.normalize(r,r);const n=r[0],i=r[1];y(e,T(t,0),T(t,4),T(t,8),i,n,0,-n,i,0,0,0,1)}function U(e,t,a,r=C[0],n=C[1],i=C[2]){s.vec3.set(n,e[4],e[5],e[6]),s.vec3.set(i,-e[12],-e[13],-e[14]),s.vec3.normalize(i,i),s.vec3.cross(r,n,i),s.vec3.normalize(r,r),s.vec3.cross(n,i,r),y(e,T(t,0),T(t,4),T(t,8),r[0],r[1],r[2],n[0],n[1],n[2],i[0],i[1],i[2])}const k=s.mat4.create();function D(e,t,a,r=k){null!==t?(s.mat4.invert(r,t),s.mat4.mul(r,t,a),s.vec3.set(e,r[4],r[5],r[6])):s.vec3.set(e,a[4],a[5],a[6])}function I(e,t,a,r=C[0]){D(r,a,t),r[2]=0,s.vec3.normalize(r,r);const n=r[0],i=r[1];y(e,T(t,0),T(t,4),T(t,8),i,n,0,-n,i,0,0,0,1)}function R(e,t,a,r=C[0],n=C[1],i=C[2]){D(n,a,t),s.vec3.set(i,-e[12],-e[13],-e[14]),s.vec3.normalize(n,n),s.vec3.cross(r,n,i),s.vec3.normalize(r,r),s.vec3.cross(i,r,n),y(e,T(t,0),T(t,4),T(t,8),r[0],r[1],r[2],n[0],n[1],n[2],i[0],i[1],i[2])}function B(e,t,a,r=C[0],n=C[1],i=C[2]){s.vec3.set(n,e[4],e[5],e[6]),s.vec3.set(r,n[1],-n[0],0),s.vec3.normalize(n,n),s.vec3.normalize(r,r),s.vec3.cross(i,r,n),y(e,T(t,0),T(t,4),T(t,8),r[0],r[1],r[2],n[0],n[1],n[2],i[0],i[1],i[2])}function P(e,t,a,r=C[0],n=C[1],i=C[2]){s.vec3.set(n,e[4],e[5],e[6]),s.vec3.set(i,-e[12],-e[13],-e[14]),s.vec3.normalize(i,i),s.vec3.cross(r,n,i),s.vec3.normalize(r,r),s.vec3.cross(n,i,r),y(e,T(t,0),T(t,4),T(t,8),r[0],r[1],r[2],n[0],n[1],n[2],i[0],i[1],i[2])}const E=d.nArray(1,()=>s.mat4.create()),F=s.vec3.create(),V=s.vec3.create();t.MDL0ModelInstance=class{constructor(e,t,a=""){for(this.textureHolder=e,this.mdl0Model=t,this.namePrefix=a,this.shapeInstances=[],this.materialInstances=[],this.chr0NodeAnimator=null,this.vis0NodeAnimator=null,this.instanceStateData=new A,this.debugBones=!1,this.colorOverrides=[],this.modelMatrix=s.mat4.create(),this.visible=!0,this.isSkybox=!1,this.passMask=1,this.name=`${a}/${t.mdl0.name}`,this.instanceStateData.jointToWorldMatrixArray=d.nArray(t.mdl0.numWorldMtx,()=>s.mat4.create()),this.instanceStateData.drawViewMatrixArray=d.nArray(t.mdl0.numViewMtx,()=>s.mat4.create());E.length<this.instanceStateData.jointToWorldMatrixArray.length;)E.push(s.mat4.create());for(let e=0;e<this.mdl0Model.materialData.length;e++)this.materialInstances[e]=new x(this,this.mdl0Model.materialData[e]);this.execDrawOpList(this.mdl0Model.mdl0.sceneGraph.drawOpaOps,!1),this.execDrawOpList(this.mdl0Model.mdl0.sceneGraph.drawXluOps,!0)}setSortKeyLayer(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setSortKeyLayer(e)}setVertexColorsEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setMaterialHacks({disableVertexColors:!e})}setTexturesEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setMaterialHacks({disableTextures:!e})}bindCHR0(e,t){this.chr0NodeAnimator=n.bindCHR0Animator(e,t,this.mdl0Model.mdl0.nodes)}bindVIS0(e,t){this.vis0NodeAnimator=n.bindVIS0Animator(e,t,this.mdl0Model.mdl0.nodes)}bindSRT0(e,t){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].bindSRT0(e,t)}bindPAT0(e,t){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].bindPAT0(e,t)}bindCLR0(e,t){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].bindCLR0(e,t)}bindLightSetting(e){this.instanceStateData.lightSetting=e}bindRRESAnimations(e,t,a=this.mdl0Model.mdl0.name){for(let r=0;r<t.chr0.length;r++)t.chr0[r].name!==a&&null!==a||this.bindCHR0(e,t.chr0[r]);for(let r=0;r<t.srt0.length;r++)t.srt0[r].name!==a&&null!==a||this.bindSRT0(e,t.srt0[r]);for(let r=0;r<t.clr0.length;r++)t.clr0[r].name!==a&&null!==a||this.bindCLR0(e,t.clr0[r]);for(let r=0;r<t.pat0.length;r++)t.pat0[r].name!==a&&null!==a||this.bindPAT0(e,t.pat0[r]);for(let r=0;r<t.vis0.length;r++)t.vis0[r].name!==a&&null!==a||this.bindVIS0(e,t.vis0[r])}setColorOverride(e,t){this.colorOverrides[e]=t}setVisible(e){this.visible=e}isAnyShapeVisible(){for(let e=0;e<this.instanceStateData.jointToWorldMatrixVisibility.length;e++)if(this.instanceStateData.jointToWorldMatrixVisibility[e]!==c.IntersectionState.FULLY_OUTSIDE)return!0;return!1}calcView(e){const t=O;this.isSkybox?l.computeViewMatrixSkybox(t,e):l.computeViewMatrix(t,e);const a=this.mdl0Model.mdl0.numViewMtx;for(let e=0;e<a;e++){const a=this.instanceStateData.jointToWorldMatrixArray[e],r=this.instanceStateData.drawViewMatrixArray[e];s.mat4.mul(r,t,a);const n=this.mdl0Model.mdl0.mtxIdToNodeId[e],i=n>=0?this.mdl0Model.mdl0.nodes[n]:null;if(null!==i){const t=this.instanceStateData.jointToWorldMatrixAttribs[e];i.flags;if(0!==t){const e=i.parentNodeId,n=e>=0?this.instanceStateData.jointToWorldMatrixArray[e]:null;1===t?M(r,a):2===t?U(r,a):3===t?I(r,a,n):4===t?R(r,a,n):5===t?B(r,a):6===t&&P(r,a)}}}}prepareToRender(e,t,a){let r=this.visible?c.IntersectionState.PARTIAL_INTERSECT:c.IntersectionState.FULLY_OUTSIDE;const n=this.mdl0Model.mdl0,s=a.camera;r!==c.IntersectionState.FULLY_OUTSIDE&&(this.isSkybox?r=c.IntersectionState.FULLY_INSIDE:null!==n.bbox&&(g.transform(n.bbox,this.modelMatrix),a.camera.frustum.contains(g)||(r=c.IntersectionState.FULLY_OUTSIDE))),r!==c.IntersectionState.FULLY_OUTSIDE&&(this.execNodeTreeOpList(n.sceneGraph.nodeTreeOps,a.camera,r),this.execNodeMixOpList(n.sceneGraph.nodeMixOps),this.isAnyShapeVisible()||(r=c.IntersectionState.FULLY_OUTSIDE));let i=-1;if(r!==c.IntersectionState.FULLY_OUTSIDE){const e=n.nodes[0];null!=e.bbox?(g.transform(e.bbox,this.modelMatrix),i=Math.max(l.computeViewSpaceDepthFromWorldSpaceAABB(a.camera,g),0)):i=Math.max(i,0)}if(i<0)return;this.calcView(s),t.pushTemplateRenderInst().filterKey=this.passMask;for(let r=0;r<this.shapeInstances.length;r++){const n=this.shapeInstances[r];(null!==this.vis0NodeAnimator?this.vis0NodeAnimator.calcVisibility(n.sortVizNode.id):n.sortVizNode.visible)&&n.prepareToRender(e,this.textureHolder,t,i,s,a.viewport,this.instanceStateData,this.isSkybox)}t.popTemplateRenderInst()}destroy(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].destroy(e)}execDrawOpList(e,t){const a=this.mdl0Model.mdl0;for(let r=0;r<e.length;r++){const n=e[r],s=this.materialInstances[n.matId],i=a.nodes[n.nodeId],o=this.mdl0Model.mdl0.shapes[n.shpId],l=this.mdl0Model.shapeData[n.shpId],c=new S(o,l,i,s);t&&(c.sortKeyBias=r);const h=o.mtxIdx<0;s.setSkinningEnabled(h),this.shapeInstances.push(c)}}execNodeTreeOpList(e,t,a){const r=this.mdl0Model.mdl0;s.mat4.copy(this.instanceStateData.jointToWorldMatrixArray[0],this.modelMatrix),this.instanceStateData.jointToWorldMatrixVisibility[0]=a;for(let n=0;n<e.length;n++){const i=e[n];if(2===i.op){const e=r.nodes[i.nodeId],n=i.parentMtxId,o=e.mtxId;let l;if(l=null!==this.chr0NodeAnimator&&this.chr0NodeAnimator.calcModelMtx(O,i.nodeId)?O:e.modelMatrix,s.mat4.mul(this.instanceStateData.jointToWorldMatrixArray[o],this.instanceStateData.jointToWorldMatrixArray[n],l),a!==c.IntersectionState.FULLY_OUTSIDE?a===c.IntersectionState.FULLY_INSIDE||null===e.bbox?this.instanceStateData.jointToWorldMatrixVisibility[o]=c.IntersectionState.FULLY_INSIDE:(g.transform(e.bbox,this.instanceStateData.jointToWorldMatrixArray[o]),this.instanceStateData.jointToWorldMatrixVisibility[o]=t.frustum.intersect(g)):this.instanceStateData.jointToWorldMatrixVisibility[o]=c.IntersectionState.FULLY_OUTSIDE,this.instanceStateData.jointToWorldMatrixAttribs[o]=e.billboardMode,this.debugBones){const e=u.getDebugOverlayCanvas2D();s.vec3.set(F,0,0,0),s.vec3.transformMat4(F,F,this.instanceStateData.jointToWorldMatrixArray[n]),s.vec3.set(V,0,0,0),s.vec3.transformMat4(V,V,this.instanceStateData.jointToWorldMatrixArray[o]),u.drawWorldSpaceLine(e,t,F,V)}}else if(6===i.op){const e=i.fromMtxId,t=i.toMtxId;s.mat4.copy(this.instanceStateData.jointToWorldMatrixArray[t],this.instanceStateData.jointToWorldMatrixArray[e]),this.instanceStateData.jointToWorldMatrixVisibility[t]=this.instanceStateData.jointToWorldMatrixVisibility[e],this.instanceStateData.jointToWorldMatrixAttribs[t]=this.instanceStateData.jointToWorldMatrixAttribs[e]}}}execNodeMixOpList(e){for(let t=0;t<e.length;t++){const a=e[t];if(3===a.op){const e=this.instanceStateData.jointToWorldMatrixArray[a.dstMtxId];e.fill(0);for(let t=0;t<a.blendMtxIds.length;t++)s.mat4.multiplyScalarAndAdd(e,e,E[a.blendMtxIds[t]],a.weights[t])}else if(5===a.op){const e=this.mdl0Model.mdl0.nodes[a.nodeId];s.mat4.mul(E[a.mtxId],this.instanceStateData.jointToWorldMatrixArray[a.mtxId],e.inverseBindPose)}}}};const O=s.mat4.create();class N{constructor(e,t,a){this.material=t,this.materialHacks=a,this.gfxSamplers=[];for(let t=0;t<8;t++){const a=this.material.samplers[t];if(!a)continue;const[r,n]=i.translateTexFilterGfx(a.minFilter),[s]=i.translateTexFilterGfx(a.magFilter),o=e.createSampler({wrapS:i.translateWrapModeGfx(a.wrapS),wrapT:i.translateWrapModeGfx(a.wrapT),minFilter:r,mipFilter:n,magFilter:s,minLOD:0,maxLOD:100});this.gfxSamplers[t]=o}}destroy(e){this.gfxSamplers.forEach(t=>e.destroySampler(t))}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GIT_REVISION="90b1ee8fe642339044fa417fc2a177fdb56f5248",t.GIT_SHORT_REVISION=t.GIT_REVISION.slice(0,8),t.GITHUB_URL="https://github.com/magcius/noclip.website",t.GITHUB_REVISION_URL=`${t.GITHUB_URL}/commit/${t.GIT_REVISION}`,t.IS_DEVELOPMENT=!1},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(53),n=a(28),s=a(0),i=a(36),o=a(143),l=a(1),c=a(2),h=a(8),d=a(110),u=a(79),m=l.vec3.create(),p=l.vec3.create(),f=l.vec3.create(),A=l.vec3.create(),g=l.mat4.create(),_=l.quat.create();function S(e){return null!==s.assertExists(e.modelInstance).getTextureMappingReference("IndDummy")}function b(e,t){return null!==o.getRes(e.modelManager.resourceHolder.motionTable,t)}function v(e,t){return null!==o.getRes(e.modelManager.resourceHolder.btkTable,t)}function w(e,t){return null!==o.getRes(e.modelManager.resourceHolder.brkTable,t)}function x(e,t){return null!==o.getRes(e.modelManager.resourceHolder.btpTable,t)}function T(e,t){return null!==o.getRes(e.modelManager.resourceHolder.bpkTable,t)}function y(e,t){return null!==o.getRes(e.modelManager.resourceHolder.bvaTable,t)}function C(e,t){const a=e.resourceHolder.getRes(e.resourceHolder.motionTable,t);return null!==a&&(e.modelManager.startBck(t),null!==e.effectKeeper&&e.effectKeeper.changeBck()),null!==a}function M(e,t){const a=e.resourceHolder.getRes(e.resourceHolder.btkTable,t);return null!==a&&e.modelManager.startBtk(t),null!==a}function U(e,t){const a=e.resourceHolder.getRes(e.resourceHolder.brkTable,t);return null!==a&&e.modelManager.startBrk(t),null!==a}function k(e,t){const a=e.resourceHolder.getRes(e.resourceHolder.bpkTable,t);return null!==a&&e.modelManager.startBpk(t),null!==a}function D(e,t){const a=e.resourceHolder.getRes(e.resourceHolder.btpTable,t);return null!==a&&e.modelManager.startBtp(t),null!==a}function I(e,t){const a=e.resourceHolder.getRes(e.resourceHolder.bvaTable,t);return null!==a&&e.modelManager.startBva(t),null!==a}function R(e,t){return e.isRun(t)&&0!==e.frameCtrl.speedInFrames}function B(e,t){return R(e.modelManager.xanimePlayer,t)}function P(e,t){return null!==e.actorAnimKeeper?e.actorAnimKeeper.isPlaying(e,t):B(e,t)}function E(e,t){null!==e.actorAnimKeeper&&e.actorAnimKeeper.start(e,t)||F(e,t)}function F(e,t){let a=!1;return a=C(e,t)||a,a=M(e,t)||a,a=U(e,t)||a,a=k(e,t)||a,a=D(e,t)||a,a=I(e,t)||a,a}function V(e,t){return Math.random()*(t-e)+e}function O(e,t,a,r){return t.actor.receiveMessage(e,a,t,r)}function N(e){const t=e.collisionParts;null!==t.hostMtx?t.resetAllMtxFromHost():(!function(e,t){l.mat4.copy(e,s.assertExists(t.getBaseMtx()));const a=t.scale[0];l.mat4.multiplyScalar(e,e,a)}(g,e),t.resetAllMtx(g))}function L(e){return e.railRider.getTotalLength()}function G(e,t){e.railRider.setSpeed(t),e.railRider.move()}function H(e,t){l.vec3.copy(e,t.railRider.currentPos)}function j(e,t){e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1}function W(e,t,a,r,n=null,s=null){!function(e,t,a,r,n,s=null,i=null){null===i&&(i=t),e.planetGravityManager.calcTotalGravityVector(n,s,a,r,i)}(e,t,a,1,r,n,s)}function Z(e,t,a,r){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=0,e[4]=a[0],e[5]=a[1],e[6]=a[2],e[7]=0,e[8]=r[0],e[9]=r[1],e[10]=r[2],e[11]=0}function z(e,t,a,r){const n=f,s=p,i=A;l.vec3.normalize(n,t),l.vec3.cross(i,t,a),l.vec3.normalize(i,i),l.vec3.cross(s,i,n),Z(e,i,n,s),j(e,r)}function K(e,t,a,r=1,n=m){l.vec3.cross(n,t,a);const s=l.vec3.length(n);if(s>1e-6){const i=l.vec3.dot(t,a),o=Math.atan2(s,i);l.quat.setAxisAngle(e,n,o*r)}else l.quat.identity(e)}function X(e,t){const a=t[0],r=t[1],n=t[2],s=t[3];e[0]=2*a*r-2*s*n,e[1]=1-2*a*a-2*n*n,e[2]=2*r*n+2*s*a}function Y(e,t){const a=t[0],r=t[1],n=t[2],s=t[3];e[0]=2*a*n+2*s*r,e[1]=2*r*n-2*a*s,e[2]=1-2*a*a-2*r*r}function $(e,t,a){return!(Math.abs(e[1]*t[2]-e[2]*t[1])>a)&&(!(Math.abs(e[2]*t[0]-e[0]*t[2])>a)&&!(Math.abs(e[0]*t[1]-e[1]*t[0])>a))}function q(e,t,a){e[0]=t[0]+V(-a,a),e[1]=t[1]+V(-a,a),e[2]=t[2]+V(-a,a)}function Q(e,t,a){c.isNearZero(l.vec3.length(t),.001)?l.vec3.copy(e,t):(q(e,t,a),c.normToLength(e,a))}t.connectToScene=function(e,t,a,r,n,s){e.sceneNameObjListExecutor.registerActor(t,a,r,n,s)},t.connectToSceneMapObjMovement=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,-1,-1,-1)},t.connectToSceneNpc=function(e,t){e.sceneNameObjListExecutor.registerActor(t,40,6,16,-1)},t.connectToSceneIndirectNpc=function(e,t){e.sceneNameObjListExecutor.registerActor(t,40,6,27,-1)},t.connectToSceneItem=function(e,t){e.sceneNameObjListExecutor.registerActor(t,44,16,13,-1)},t.connectToSceneItemStrongLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,44,16,15,-1)},t.connectToSceneCollisionMapObjStrongLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,30,2,10,-1)},t.connectToSceneCollisionMapObjWeakLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,30,2,9,-1)},t.connectToSceneCollisionMapObj=function(e,t){e.sceneNameObjListExecutor.registerActor(t,30,2,8,-1)},t.connectToSceneMapObjNoCalcAnim=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,-1,8,-1)},t.connectToSceneMapObj=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,5,8,-1)},t.connectToSceneMapObjDecoration=function(e,t){e.sceneNameObjListExecutor.registerActor(t,35,11,8,-1)},t.connectToSceneMapObjStrongLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,5,10,-1)},t.connectToSceneIndirectMapObjStrongLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,5,26,-1)},t.connectToSceneNoSilhouettedMapObj=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,5,11,-1)},t.connectToSceneNoSilhouettedMapObjStrongLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,5,12,-1)},t.connectToSceneNoSilhouettedMapObjWeakLightNoMovement=function(e,t){e.sceneNameObjListExecutor.registerActor(t,-1,5,14,-1)},t.connectToSceneSky=function(e,t){e.sceneNameObjListExecutor.registerActor(t,36,5,1,-1)},t.connectToSceneAir=function(e,t){e.sceneNameObjListExecutor.registerActor(t,36,5,2,-1)},t.connectToSceneCrystal=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,5,32,-1)},t.connectToSceneBloom=function(e,t){e.sceneNameObjListExecutor.registerActor(t,34,5,30,-1)},t.connectToScenePlanet=function(e,t){S(t)?e.sceneNameObjListExecutor.registerActor(t,29,1,29,-1):e.sceneNameObjListExecutor.registerActor(t,29,1,4,-1)},t.connectToSceneEnvironment=function(e,t){e.sceneNameObjListExecutor.registerActor(t,33,4,6,-1)},t.connectToSceneEnvironmentStrongLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,33,4,7,-1)},t.connectToSceneEnemyMovement=function(e,t){e.sceneNameObjListExecutor.registerActor(t,42,-1,-1,-1)},t.connectToSceneCollisionEnemyStrongLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,31,3,10,-1)},t.connectToSceneCollisionEnemyNoShadowedMapObjStrongLight=function(e,t){e.sceneNameObjListExecutor.registerActor(t,31,3,12,-1)},t.connectToSceneScreenEffectMovement=function(e,t){e.sceneNameObjListExecutor.registerActor(t,3,-1,-1,-1)},t.isBckStopped=function(e){return e.modelManager.isBckStopped()},t.getBckFrameMax=function(e){return e.modelManager.getBckCtrl().endFrame},t.setLoopMode=function(e,t){e.modelManager.getBckCtrl().loopMode=t},t.initDefaultPos=function(e,t,a){null!==a&&(r.getJMapInfoTrans(t.translation,e,a),r.getJMapInfoRotate(t.rotation,e,a),n.getJMapInfoScale(t.scale,a))},t.isExistIndirectTexture=S,t.loadBTIData=function(e,t,a){const r=e.modelCache.device,n=e.modelCache.cache,s=t.findFileData(a);return new i.BTIData(r,n,i.BTI.parse(s,a).texture)},t.isBckExist=b,t.isBtkExist=v,t.isBrkExist=w,t.isBtpExist=x,t.isBpkExist=T,t.isBvaExist=y,t.tryStartBck=function(e,t){return!B(e,t)&&(e.modelManager.startBck(t),null!==e.effectKeeper&&e.effectKeeper.changeBck(),!0)},t.startBck=function(e,t){e.modelManager.startBck(t),null!==e.effectKeeper&&e.effectKeeper.changeBck()},t.startBckWithInterpole=function(e,t,a){e.modelManager.startBckWithInterpole(t,a),null!==e.effectKeeper&&e.effectKeeper.changeBck()},t.startBckNoInterpole=function(e,t){e.modelManager.startBckWithInterpole(t,0),null!==e.effectKeeper&&e.effectKeeper.changeBck()},t.startBtk=function(e,t){e.modelManager.startBtk(t)},t.startBrk=function(e,t){e.modelManager.startBrk(t)},t.startBtp=function(e,t){e.modelManager.startBtp(t)},t.startBpk=function(e,t){e.modelManager.startBpk(t)},t.startBva=function(e,t){e.modelManager.startBva(t)},t.startBckIfExist=C,t.startBtkIfExist=M,t.startBrkIfExist=U,t.startBpkIfExist=k,t.startBtpIfExist=D,t.startBvaIfExist=I,t.setBckFrameAndStop=function(e,t){const a=e.modelManager.getBckCtrl();a.currentTimeInFrames=t,a.speedInFrames=0},t.setBckFrame=function(e,t){e.modelManager.getBckCtrl().currentTimeInFrames=t},t.setBckFrameAtRandom=function(e){const t=e.modelManager.getBckCtrl();t.currentTimeInFrames=V(0,t.endFrame)},t.setBckRate=function(e,t){e.modelManager.getBckCtrl().speedInFrames=t},t.setBtkFrameAndStop=function(e,t){const a=e.modelManager.getBtkCtrl();a.currentTimeInFrames=t,a.speedInFrames=0},t.setBrkFrameAndStop=function(e,t){const a=e.modelManager.getBrkCtrl();a.currentTimeInFrames=t,a.speedInFrames=0},t.setBtpFrameAndStop=function(e,t){const a=e.modelManager.getBtpCtrl();a.currentTimeInFrames=t,a.speedInFrames=0},t.setBpkFrameAndStop=function(e,t){const a=e.modelManager.getBpkCtrl();a.currentTimeInFrames=t,a.speedInFrames=0},t.setBvaFrameAndStop=function(e,t){const a=e.modelManager.getBvaCtrl();a.currentTimeInFrames=t,a.speedInFrames=0},t.setBvaRate=function(e,t){e.modelManager.getBvaCtrl().speedInFrames=t},t.isBckPlayingXanimePlayer=R,t.isBckOneTimeAndStopped=function(e){return e.modelManager.isBckStopped()},t.isBckPlaying=B,t.isBtkPlaying=function(e,t){return e.modelManager.isBtkPlaying(t)},t.isBrkPlaying=function(e,t){return e.modelManager.isBrkPlaying(t)},t.isBtpPlaying=function(e,t){return e.modelManager.isBtpPlaying(t)},t.isBpkPlaying=function(e,t){return e.modelManager.isBpkPlaying(t)},t.isBvaPlaying=function(e,t){return e.modelManager.isBvaPlaying(t)},t.isAnyAnimStopped=function(e,t){return!(!b(e,t)||!e.modelManager.isBckStopped())&&(!(!v(e,t)||!e.modelManager.isBtkStopped())&&(!(!T(e,t)||!e.modelManager.isBpkStopped())&&(!(!x(e,t)||!e.modelManager.isBtpStopped())&&(!(!w(e,t)||!e.modelManager.isBrkStopped())&&!(!y(e,t)||!e.modelManager.isBvaStopped())))))},t.isActionStart=P,t.tryStartAction=function(e,t){return!P(e,t)&&(E(e,t),!0)},t.startAction=E,t.tryStartAllAnim=F,t.getRandomFloat=V,t.getRandomInt=function(e,t){return 0|V(e,t)},t.addBodyMessageSensorMapObj=function(e,t){t.hitSensorKeeper.add(e,"body",70,0,0,t,c.Vec3Zero)},t.addHitSensorMapObj=function(e,t,a,r,n,s){t.hitSensorKeeper.add(e,a,5,r,n,t,s)},t.addHitSensorNpc=function(e,t,a,r,n,s){t.hitSensorKeeper.add(e,a,5,r,n,t,s)},t.receiveMessage=O,t.sendArbitraryMsg=function(e,t,a,r){return O(e,a,t,r)},t.resetAllCollisionMtx=N,t.validateCollisionPartsForActor=function(e,t){const a=s.assertExists(t.collisionParts);d.validateCollisionParts(e,a),N(t)},t.invalidateCollisionPartsForActor=function(e,t){const a=s.assertExists(t.collisionParts);d.invalidateCollisionParts(e,a)},t.initCollisionParts=function(e,t,a,r,n){t.initActorCollisionParts(e,a,r,null,n,2)},t.getRailTotalLength=L,t.getRailDirection=function(e,t){l.vec3.copy(e,t.railRider.currentDir)},t.getRailCoordSpeed=function(e){return e.railRider.speed},t.calcRailPosAtCoord=function(e,t,a){t.railRider.calcPosAtCoord(e,a)},t.calcRailDirectionAtCoord=function(e,t,a){t.railRider.calcDirectionAtCoord(e,a)},t.calcRailStartPointPos=function(e,t){t.railRider.copyPointPos(e,0)},t.calcRailEndPointPos=function(e,t){t.railRider.copyPointPos(e,t.railRider.getPointNum()-1)},t.isRailGoingToEnd=function(e){return 0===e.railRider.direction},t.isRailReachedGoal=function(e){return e.railRider.isReachedGoal()},t.reverseRailDirection=function(e){e.railRider.reverse()},t.isLoopRail=function(e){return e.railRider.isLoop()},t.moveCoordToRailPoint=function(e,t){const a=e.railRider.getPointCoord(t);e.railRider.setCoord(a)},t.moveCoordToStartPos=function(e){e.railRider.setCoord(0)},t.moveCoordToEndPos=function(e){e.railRider.setCoord(L(e))},t.setRailCoordSpeed=function(e,t){e.railRider.setSpeed(Math.abs(t))},t.adjustmentRailCoordSpeed=function(e,t,a){const r=e.railRider.speed;Math.abs(r-t)>=a&&(t=t>r?r+a:t===r?r:r-a),e.railRider.setSpeed(t)},t.moveCoordToNearestPos=function(e){e.railRider.moveToNearestPos(e.translation)},t.moveCoordAndTransToNearestRailPos=function(e){e.railRider.moveToNearestPos(e.translation),l.vec3.copy(e.translation,e.railRider.currentPos)},t.moveCoordAndTransToNearestRailPoint=function(e){e.railRider.moveToNearestPoint(e.translation),l.vec3.copy(e.translation,e.railRider.currentPos)},t.moveCoordAndTransToRailStartPoint=function(e){e.railRider.setCoord(0),l.vec3.copy(e.translation,e.railRider.currentPos)},t.moveCoord=G,t.moveCoordAndFollowTrans=function(e,t){G(e,t),l.vec3.copy(e.translation,e.railRider.currentPos)},t.moveTransToCurrentRailPos=function(e){l.vec3.copy(e.translation,e.railRider.currentPos)},t.getCurrentRailPointNo=function(e){return e.railRider.currentPointId},t.getCurrentRailPointArg0=function(e){return e.railRider.getCurrentPointArg("point_arg0")},t.getCurrentRailPointArg1=function(e){return e.railRider.getCurrentPointArg("point_arg1")},t.getCurrentRailPointArg5=function(e){return e.railRider.getCurrentPointArg("point_arg5")},t.getCurrentRailPointArg7=function(e){return e.railRider.getCurrentPointArg("point_arg7")},t.getNextRailPointNo=function(e){return e.railRider.getNextPointNo()},t.getRailPartLength=function(e,t){return e.railRider.getPartLength(t)},t.getRailCoord=function(e){return e.railRider.coord},t.getRailPos=H,t.setRailCoord=function(e,t){e.railRider.setCoord(t)},t.setRailDirectionToEnd=function(e){1===e.railRider.direction&&e.railRider.reverse()},t.moveRailRider=function(e){e.railRider.move()},t.isExistRail=function(e){return null!==e.railRider},t.getRailPointPosStart=function(e){return e.railRider.startPos},t.getRailPointPosEnd=function(e){return e.railRider.endPos},t.getRailPointNum=function(e){return e.railRider.getPointNum()},t.calcRailPointPos=function(e,t,a){t.railRider.copyPointPos(e,a)},t.moveTransToOtherActorRailPos=function(e,t){H(e.translation,t)},t.calcDistanceToCurrentAndNextRailPoint=function(e,t){const a=t.railRider,r=a.coord,n=a.getCurrentPointCoord();c.isNearZero(n,.001)?1===a.direction?e[0]=a.getTotalLength()-r:e[0]=r:e[0]=Math.abs(r-n);const s=a.getNextPointCoord();c.isNearZero(s,.001)?1===a.direction?e[1]=r:e[1]=a.getTotalLength()-r:e[1]=Math.abs(s-r)},t.calcMtxAxis=function(e,t,a,r){null!==e&&l.vec3.set(e,r[0],r[1],r[2]),null!==t&&l.vec3.set(t,r[4],r[5],r[6]),null!==a&&l.vec3.set(a,r[8],r[9],r[10])},t.calcDistanceVertical=function(e,t){l.vec3.subtract(m,e.translation,t);const a=l.vec3.dot(e.gravityVector,m);return l.vec3.scale(m,e.gravityVector,a),l.vec3.length(m)},t.isValidDraw=function(e){return e.visibleAlive&&e.visibleScenario},t.loadTexProjectionMtx=function(e,t,a){h.texProjCameraSceneTex(e,t,a,-1),l.mat4.mul(e,e,t.viewMatrix)},t.setTextureMatrixST=function(e,t,a){l.mat4.identity(e),e[0]=t,e[5]=t,e[10]=t,null!==a&&(e[12]=a[0],e[13]=a[1])},t.setTrans=j,t.calcGravityVector=W,t.calcGravity=function(e,t){W(e,t,t.translation,m),c.isNearZeroVec3(m,.001)||l.vec3.copy(t.gravityVector,m)},t.makeMtxTRFromQuatVec=function(e,t,a){l.mat4.fromQuat(e,t),e[12]=a[0],e[13]=a[1],e[14]=a[2]},t.setMtxAxisXYZ=Z,t.makeMtxFrontUpPos=function(e,t,a,r){const n=p,s=f,i=A;l.vec3.normalize(n,t),l.vec3.cross(i,a,n),l.vec3.normalize(i,i),l.vec3.cross(s,n,i),Z(e,i,s,n),j(e,r)},t.makeMtxUpFrontPos=z,t.makeQuatUpFront=function(e,t,a){z(g,t,a,c.Vec3Zero),l.mat4.getRotation(e,g),l.quat.normalize(e,e)},t.quatSetRotate=K,t.quatGetAxisX=function(e,t){const a=t[0],r=t[1],n=t[2],s=t[3];e[0]=1-2*r*r-2*n*n,e[1]=2*a*r+2*s*n,e[2]=2*a*n-2*s*r},t.quatGetAxisY=X,t.quatGetAxisZ=Y,t.isSameDirection=$,t.addRandomVector=q,t.turnRandomVector=Q,t.blendQuatUpFront=function(e,t,a,r,n,s){const i=p,o=f,c=m;X(i,t),l.vec3.dot(i,a)<0&&$(i,a,.01)&&Q(i,i,.001),K(_,i,a,n,c),l.quat.mul(e,_,t),X(i,e),l.vec3.scaleAndAdd(i,r,i,-l.vec3.dot(i,r)),l.vec3.normalize(i,i),Y(o,e),l.vec3.dot(o,i)<0&&$(o,i,.01)&&Q(o,o,.001),K(_,o,i,s,c),l.quat.mul(e,_,e),l.quat.normalize(e,e)},t.calcPerpendicFootToLine=function(e,t,a,r,n=m){l.vec3.sub(n,r,a);const s=l.vec3.dot(n,t)-l.vec3.dot(n,a);l.vec3.scaleAndAdd(e,a,n,s/l.vec3.squaredLength(n))},t.calcPerpendicFootToLineInside=function(e,t,a,r,n=m){l.vec3.sub(n,r,a);const s=l.vec3.dot(n,t)-l.vec3.dot(n,a);l.vec3.scaleAndAdd(e,a,n,c.saturate(s/l.vec3.squaredLength(n)))},t.vecKillElement=function(e,t,a){const r=l.vec3.dot(t,a);return e[0]=t[0]-a[0]*r,e[1]=t[1]-a[1]*r,e[2]=t[2]-a[2]*r,r},t.makeMtxUpNoSupportPos=function(e,t,a){z(e,t,2===function(e){const t=Math.abs(e[0]),a=Math.abs(e[1]),r=Math.abs(e[2]);return t>r&&a>r?0:a>r?1:2}(t)?c.Vec3UnitY:c.Vec3UnitZ,a)},t.preScaleMtx=function(e,t){const a=t[0],r=t[1],n=t[2];e[0]*=a,e[1]*=a,e[2]*=a,e[4]*=r,e[5]*=r,e[6]*=r,e[8]*=n,e[9]*=n,e[10]*=n},t.isExistCollisionResource=function(e,t){return null!==e.resourceHolder.arc.findFileData(`${t}.kcl`)},t.useStageSwitchSleep=function(e,t,a){u.addSleepControlForLiveActor(e,t,a)},t.useStageSwitchWriteA=function(e,t,a){return null!==a&&(!!u.isExistStageSwitchA(a)&&(null===t.stageSwitchCtrl&&t.initStageSwitch(e,a),!0))},t.useStageSwitchWriteB=function(e,t,a){return null!==a&&(!!u.isExistStageSwitchB(a)&&(null===t.stageSwitchCtrl&&t.initStageSwitch(e,a),!0))},t.useStageSwitchWriteDead=function(e,t,a){return null!==a&&(!!u.isExistStageSwitchDead(a)&&(null===t.stageSwitchCtrl&&t.initStageSwitch(e,a),!0))},t.useStageSwitchReadAppear=function(e,t,a){return null!==a&&(!!u.isExistStageSwitchAppear(a)&&(null===t.stageSwitchCtrl&&t.initStageSwitch(e,a),!0))},t.syncStageSwitchAppear=function(e,t){const a=new u.SwitchFunctorEventListener(e=>t.makeActorAppeared(e),e=>t.makeActorDead(e));u.getSwitchWatcherHolder(e).joinSwitchEventListenerAppear(t.stageSwitchCtrl,a)},t.listenStageSwitchOnOffA=function(e,t,a,r){const n=new u.SwitchFunctorEventListener(a,r);u.getSwitchWatcherHolder(e).joinSwitchEventListenerA(t.stageSwitchCtrl,n)},t.listenStageSwitchOnOffAppear=function(e,t,a,r){const n=new u.SwitchFunctorEventListener(a,r);u.getSwitchWatcherHolder(e).joinSwitchEventListenerAppear(t.stageSwitchCtrl,n)},t.isValidSwitchDead=function(e){return null!==e.stageSwitchCtrl&&e.stageSwitchCtrl.isValidSwitchDead()}},function(e,t,a){"use strict";var r;function n(e){return e<<3|e>>>2}function s(e,t){return(e<<1)+e+((t<<2)+t)>>>3}function i(e,t,a){e[t+0]=n(31&a),e[t+1]=n(a>>>5&31),e[t+2]=n(a>>>10&31)}function o(e,t){return e&&t?2:e?1:0}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Tex_None=0]="Tex_None",e[e.Tex_A3I5=1]="Tex_A3I5",e[e.Tex_Palette4=2]="Tex_Palette4",e[e.Tex_Palette16=3]="Tex_Palette16",e[e.Tex_Palette256=4]="Tex_Palette256",e[e.Tex_CMPR_4x4=5]="Tex_CMPR_4x4",e[e.Tex_A5I3=6]="Tex_A5I3",e[e.Tex_Direct=7]="Tex_Direct"}(r=t.Format||(t.Format={})),t.bgr5=i,t.readTexture=function(e){switch(e.format){case r.Tex_A3I5:return function(e,t,a,r){const n=new Uint8Array(e*t*4),s=a.createDataView(),o=r.createDataView();let l=0;for(let a=0;a<t;a++)for(let t=0;t<e;t++){const r=s.getUint8(l++),h=(31&r)<<1,d=r>>>5,u=4*(a*e+t);i(n,u,o.getUint16(h,!0)),n[u+3]=(c=d)<<5|c<<2|c>>>1}var c;return n}(e.width,e.height,e.texData,e.palData);case r.Tex_Palette4:return function(e,t,a,r,n){const s=new Uint8Array(e*t*4),o=a.createDataView(),l=r.createDataView();let c=0;for(let a=0;a<t;a++)for(let t=0;t<e;t+=8){let r=o.getUint16(c,!0);c+=2;for(let o=0;o<8;o++){const c=3&r,h=4*(a*e+t+o);i(s,h,l.getUint16(2*c,!0)),s[h+3]=0===c&&n?0:255,r>>=2}}return s}(e.width,e.height,e.texData,e.palData,e.color0);case r.Tex_Palette16:return function(e,t,a,r,n){const s=new Uint8Array(e*t*4),o=a.createDataView(),l=r.createDataView();let c=0;for(let a=0;a<t;a++)for(let t=0;t<e;t+=4){let r=o.getUint16(c,!0);c+=2;for(let o=0;o<4;o++){const c=15&r,h=4*(a*e+t+o);i(s,h,l.getUint16(2*c,!0)),s[h+3]=0===c&&n?0:255,r>>=4}}return s}(e.width,e.height,e.texData,e.palData,e.color0);case r.Tex_Palette256:return function(e,t,a,r,n){const s=new Uint8Array(e*t*4),o=a.createDataView(),l=r.createDataView();let c=0;for(let a=0;a<t;a++)for(let t=0;t<e;t++){const r=o.getUint8(c++),h=4*(a*e+t);i(s,h,l.getUint16(2*r,!0)),s[h+3]=0===r&&n?0:255}return s}(e.width,e.height,e.texData,e.palData,e.color0);case r.Tex_CMPR_4x4:return function(e,t,a,r,n){function o(e){return e<u.byteLength?u.getUint16(e,!0):0}function l(e){const t=e>>14,a=(16383&e)<<2,r=new Uint8Array(16);if(i(r,0,o(a+0)),r[3]=255,i(r,4,o(a+2)),r[7]=255,0===t){i(r,8,o(a+4)),r[11]=255}else if(1===t)r[8]=r[0]+r[4]>>>1,r[9]=r[1]+r[5]>>>1,r[10]=r[2]+r[6]>>>1,r[11]=255;else if(2===t){i(r,8,o(a+4)),r[11]=255,i(r,12,o(a+6)),r[15]=255}else r[8]=s(r[4],r[0]),r[9]=s(r[5],r[1]),r[10]=s(r[6],r[2]),r[11]=255,r[12]=s(r[0],r[4]),r[13]=s(r[1],r[5]),r[14]=s(r[2],r[6]),r[15]=255;return r}const c=new Uint8Array(e*t*4),h=a.createDataView(),d=r.createDataView(),u=n.createDataView();let m=0;for(let a=0;a<t;a+=4)for(let t=0;t<e;t+=4){let r=h.getUint32(4*m,!0);const n=l(d.getUint16(2*m,!0));for(let s=0;s<4;s++)for(let i=0;i<4;i++){const o=3&r,l=4*((a+s)*e+t+i);c[l+0]=n[4*o+0],c[l+1]=n[4*o+1],c[l+2]=n[4*o+2],c[l+3]=n[4*o+3],r>>=2}m++}return c}(e.width,e.height,e.texData,e.palIdxData,e.palData);case r.Tex_A5I3:return function(e,t,a,r){const s=new Uint8Array(e*t*4),o=a.createDataView(),l=r.createDataView();let c=0;for(let a=0;a<t;a++)for(let t=0;t<e;t++){const r=o.getUint8(c++),h=(7&r)<<1,d=r>>>3,u=4*(a*e+t);i(s,u,l.getUint16(h,!0)),s[u+3]=n(d)}return s}(e.width,e.height,e.texData,e.palData);case r.Tex_Direct:return function(e,t,a){const r=new Uint8Array(e*t*4),n=a.createDataView();let s=0;for(let a=0;a<t;a++)for(let t=0;t<e;t++){const o=4*(a*e+t);i(r,o,n.getUint16(s,!0)),r[o+3]=255,s+=2}return r}(e.width,e.height,e.texData);default:const t=e.format;throw new Error(`Unsupported texture type! ${t}`)}},t.parseTexImageParam=function(e){return{format:e>>26&7,width:8<<(e>>20&7),height:8<<(e>>23&7),color0:!!(e>>29&1)}},t.getFormatName=function(e){switch(e){case r.Tex_None:return"Tex_None";case r.Tex_A3I5:return"Tex_A3I5";case r.Tex_Palette4:return"Tex_Palette4";case r.Tex_Palette16:return"Tex_Palette16";case r.Tex_Palette256:return"Tex_Palette256";case r.Tex_CMPR_4x4:return"Tex_CMPR_4x4";case r.Tex_A5I3:return"Tex_A5I3";case r.Tex_Direct:return"Tex_Direct";default:throw new Error}},t.parseTexImageParamWrapModeS=function(e){return o(!!(e>>16&1),!!(e>>18&1))},t.parseTexImageParamWrapModeT=function(e){return o(!!(e>>17&1),!!(e>>19&1))},t.textureFormatIsTranslucent=function(e){return e===r.Tex_A3I5||e===r.Tex_A5I3}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(1),s=a(54),i=a(6),o=a(14),l=a(4),c=a(22);class h{constructor(){this.textures=[],this.materials=[],this.bones=[],this.sepds=[],this.meshs=[]}}var d;function u(e,t,a,r,s,i){const o=r*Math.PI,l=Math.sin(o),c=Math.cos(o);n.mat4.identity(e),e[0]=t*c,e[1]=a*-l,e[4]=t*l,e[5]=a*c,e[12]=t*(-.5*c-(.5*l-.5)-s),e[13]=a*(-.5*c+(.5*l-.5)+i)+1}function m(e){switch(e){case 0:return 3;case 1:return 2;case 2:return 1;case 3:return 0;default:throw"whoops"}}function p(e,t,a=""){const n=e.createDataView();r.assert("tex "===r.readString(e,0,4));const i=n.getUint32(8,!0);let o=12;const l=[];for(let c=0;c<i;c++){const i=n.getUint32(o+0,!0),h=n.getUint16(o+4,!0),d=(n.getUint16(o+6,!0),n.getUint16(o+8,!0)),u=n.getUint16(o+10,!0),m=n.getUint32(o+12,!0);let p=n.getUint32(o+16,!0);const f=p+i,A=`${a}/${c}/${r.readString(e,o+20,16)}`;o+=36;const g=[],_=s.getTextureFormatFromGLFormat(m);if(null!==t){let e=d,a=u;for(let r=0;r<h;r++){const r=s.decodeTexture(_,e,a,t.slice(p,f));g.push({name:A,width:e,height:a,pixels:r}),p+=s.computeTextureByteSize(_,e,a),e/=2,a/=2}}l.push({name:A,format:_,width:d,height:u,levels:g})}return l}t.CMB=h,function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(d=t.TextureFilter||(t.TextureFilter={})),function(e){e[e.CLAMP=10496]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(t.TextureWrapMode||(t.TextureWrapMode={})),t.calcTexMtx=u,t.parseTexChunk=p;class f{}t.Mesh=f,function(e){e[e.Byte=5120]="Byte",e[e.UByte=5121]="UByte",e[e.Short=5122]="Short",e[e.UShort=5123]="UShort",e[e.Int=5124]="Int",e[e.UInt=5125]="UInt",e[e.Float=5126]="Float"}(t.DataType||(t.DataType={}));class A{}function g(e,t){const a=t.createDataView();r.assert("prms"===r.readString(t,0,4));const n=a.getUint32(8,!0);r.assert(1===n);const s=a.getUint16(12,!0),i=a.getUint16(14,!0);r.assert(i<16);const o=new Uint16Array(i);let l=a.getUint32(16,!0);for(let e=0;e<i;e++)o[e]=a.getUint16(l,!0),l+=2;const c=a.getUint32(20,!0);return{prm:function(e,t){const a=t.createDataView();r.assert("prm "===r.readString(t,0,4));const n=new A;return n.indexType=a.getUint32(16,!0),n.count=a.getUint16(20,!0),n.offset=2*a.getUint16(22,!0),n}(0,t.slice(c)),skinningMode:s,boneTable:o}}t.Prm=A;class _{constructor(){this.prms=[],this.tangent=null}}function S(e,t){const a=t.createDataView();r.assert("sepd"===r.readString(t,0,4));const s=a.getUint16(8,!0),i=new _;let o=2===e.version?60:36;function l(){const e=a.getUint32(o+0,!0),t=a.getFloat32(o+4,!0),r=a.getUint16(o+8,!0),s=a.getUint16(o+10,!0),i=a.getFloat32(o+12,!0),l=a.getFloat32(o+16,!0),c=a.getFloat32(o+20,!0),h=a.getFloat32(o+24,!0),d=n.vec4.fromValues(i,l,c,h);return o+=28,{start:e,scale:t,dataType:r,mode:s,constant:d}}i.position=l(),i.normal=l(),1!==e.version&&2!==e.version||(i.tangent=l()),i.color=l(),i.texCoord0=l(),i.texCoord1=l(),i.texCoord2=l(),i.boneIndices=l(),i.boneWeights=l(),i.boneDimension=a.getUint16(o+0,!0),o+=4;for(let e=0;e<s;e++){const n=a.getUint16(o+0,!0);i.prms.push(g(0,t.slice(n))),o+=2,r.assert(i.prms[e].skinningMode===i.prms[0].skinningMode)}return i}function b(e,t){const a=t.createDataView();r.assert("sklm"===r.readString(t,0,4));const n=a.getUint32(8,!0);!function(e,t){const a=t.createDataView();r.assert("mshs"===r.readString(t,0,4));const n=a.getUint32(8,!0);let s=16;for(let t=0;t<n;t++){const t=new f;t.sepdIdx=a.getUint16(s+0,!0),t.matsIdx=a.getUint8(s+2),e.meshs.push(t),0===e.version?s+=4:1===e.version?s+=12:2===e.version&&(s+=88)}}(e,t.slice(n));const s=a.getUint32(12,!0);!function(e,t){const a=t.createDataView();r.assert("shp "===r.readString(t,0,4));const n=a.getUint32(8,!0);let s=16;for(let r=0;r<n;r++){const r=a.getUint16(s,!0),n=S(e,t.slice(r));e.sepds.push(n),s+=2}}(e,t.slice(s))}t.Sepd=_,t.parse=function(e){const t=e.createDataView(),a=new h;r.assert("cmb "===r.readString(e,0,4)),t.getUint32(4,!0),a.name=r.readString(e,16,16);const s=t.getUint32(8,!0);if(15===s)a.version=2;else if(10===s)a.version=1;else{if(6!==s)throw"whoops";a.version=0}let f=36;const A=t.getUint32(f,!0);f+=4,function(e,t){const a=t.createDataView();r.assert("skl "===r.readString(t,0,4));const n=a.getUint32(8,!0),s=[];let i=16;for(let t=0;t<n;t++){const t={boneId:4095&a.getInt16(i+0,!0),parentBoneId:a.getInt16(i+2,!0),scaleX:a.getFloat32(i+4,!0),scaleY:a.getFloat32(i+8,!0),scaleZ:a.getFloat32(i+12,!0),rotationX:a.getFloat32(i+16,!0),rotationY:a.getFloat32(i+20,!0),rotationZ:a.getFloat32(i+24,!0),translationX:a.getFloat32(i+28,!0),translationY:a.getFloat32(i+32,!0),translationZ:a.getFloat32(i+36,!0)};s.push(t),i+=40,1!==e.version&&2!==e.version||(i+=4)}e.bones=s}(a,e.slice(A)),1!==a.version&&2!==a.version||(f+=4);const g=t.getUint32(f,!0);f+=4,function(e,t){const a=t.createDataView();r.assert("mats"===r.readString(t,0,4));const s=a.getUint32(8,!0);let h=348;1!==e.version&&2!==e.version||(h+=16);let p=12;const f=p+s*h;for(let t=0;t<s;t++){const s=a.getUint8(p+4);r.assert(s>=0&&s<=3);const h=m(s),A=a.getUint8(p+5),g=a.getInt8(p+7),_=A?g/65536:0;let S=p+16;const b=[];for(let e=0;e<3;e++){const t=a.getInt16(S+0,!0);let r=a.getUint16(S+4,!0);r===d.LINEAR_MIPMAP_NEAREST&&(r=d.LINEAR_MIPMAP_LINEAR);const n=a.getUint16(S+6,!0),s=a.getUint16(S+8,!0),i=a.getUint16(S+10,!0);a.getFloat32(S+16,!0),a.getFloat32(S+20,!0),a.getUint8(S+20),a.getUint8(S+21),a.getUint8(S+22),a.getUint8(S+23);b.push({index:e,textureIdx:t,minFilter:r,magFilter:n,wrapS:s,wrapT:i}),S+=24}let v=p+88;const w=[];for(let e=0;e<3;e++){const e=a.getUint8(v+0),t=a.getUint8(v+1),r=a.getUint8(v+2),s=a.getUint8(v+3),i=a.getFloat32(v+4,!0),o=a.getFloat32(v+8,!0),l=a.getFloat32(v+12,!0),c=a.getFloat32(v+16,!0),h=a.getFloat32(v+20,!0),d=n.mat4.create();u(d,i,o,h,l,c),w.push({sourceCoordinate:s,mappingMethod:r,referenceCamera:t,matrixMode:e,textureMatrix:d}),v+=24}a.getUint32(p+176,!0);const x=[];x[0]=l.colorNewFromRGBA8(a.getUint32(p+180,!1)),x[1]=l.colorNewFromRGBA8(a.getUint32(p+184,!1)),x[2]=l.colorNewFromRGBA8(a.getUint32(p+188,!1)),x[3]=l.colorNewFromRGBA8(a.getUint32(p+192,!1)),x[4]=l.colorNewFromRGBA8(a.getUint32(p+196,!1)),x[5]=l.colorNewFromRGBA8(a.getUint32(p+200,!1));const T=a.getFloat32(p+204,!0),y=a.getFloat32(p+208,!0),C=a.getFloat32(p+212,!0),M=a.getFloat32(p+216,!0),U=(a.getUint16(p+220,!0),a.getUint16(p+222,!0),a.getUint8(p+240),a.getUint16(p+242,!0),a.getUint32(p+244,!0),a.getUint8(p+248),a.getUint16(p+250,!0),a.getUint32(p+252,!0),a.getUint8(p+256),a.getUint16(p+258,!0),a.getUint32(p+260,!0),a.getUint8(p+264),a.getUint16(p+266,!0),a.getUint32(p+268,!0),a.getUint8(p+272),a.getUint16(p+274,!0),a.getUint32(p+276,!0),a.getUint8(p+280),a.getUint16(p+282,!0),a.getUint32(p+284,!0),a.getUint32(p+288,!0)),k=[];let D=p+292;for(let e=0;e<U;e++){const e=f+40*a.getUint16(D+0,!0),t=a.getUint16(e+0,!0),n=a.getUint16(e+2,!0),s=a.getUint16(e+4,!0),i=a.getUint16(e+6,!0),o=a.getUint16(e+8,!0),l=a.getUint16(e+10,!0),c=a.getUint16(e+12,!0),h=a.getUint16(e+14,!0),d=a.getUint16(e+16,!0),u=a.getUint16(e+18,!0),m=a.getUint16(e+20,!0),p=a.getUint16(e+22,!0),A=a.getUint16(e+24,!0),g=a.getUint16(e+26,!0),_=a.getUint16(e+28,!0),S=a.getUint16(e+30,!0),b=a.getUint16(e+32,!0),v=a.getUint16(e+34,!0),w=a.getUint32(e+36,!0);r.assert(w<6),k.push({combineRGB:t,combineAlpha:n,scaleRGB:s,scaleAlpha:i,bufferInputRGB:o,bufferInputAlpha:l,source0RGB:c,source1RGB:h,source2RGB:d,op0RGB:u,op1RGB:m,op2RGB:p,source0Alpha:A,source1Alpha:g,source2Alpha:_,op0Alpha:S,op1Alpha:b,op2Alpha:v,constantIndex:w}),D+=2}const I=!!a.getUint8(p+304),R=a.getUint8(p+305)/255,B=I?a.getUint16(p+306,!0):i.GfxCompareMode.ALWAYS,P=!!a.getUint8(p+308),E=!!a.getUint8(p+309),F=P?a.getUint16(p+310,!0):i.GfxCompareMode.ALWAYS,V=!!a.getUint8(p+312);r.assert(0==a.getUint8(p+313)),r.assert(0==a.getUint16(p+314,!0));const O=V?a.getUint16(p+316,!0):i.GfxBlendFactor.ONE,N=V?a.getUint16(p+318,!0):i.GfxBlendFactor.ZERO,L={blendMode:V?a.getUint16(p+320,!0):i.GfxBlendMode.ADD,blendDstFactor:N,blendSrcFactor:O},G=V?a.getUint16(p+324,!0):i.GfxBlendFactor.ONE,H=V?a.getUint16(p+326,!0):i.GfxBlendFactor.ZERO,j={blendMode:V?a.getUint16(p+328,!0):i.GfxBlendMode.ADD,blendDstFactor:H,blendSrcFactor:G},W=a.getFloat32(p+332,!0),Z=a.getFloat32(p+336,!0),z=a.getFloat32(p+340,!0),K=a.getFloat32(p+344,!0),X=l.colorNewFromRGBA(W,Z,z,K),Y=V,$=o.makeMegaState({attachmentsState:[{colorWriteMask:15,rgbBlendState:L,alphaBlendState:j}],blendConstant:X,depthCompare:c.reverseDepthForCompareMode(F),depthWrite:E,cullMode:h}),q={textureCombiners:k,combinerBufferColor:l.colorNewFromRGBA(T,y,C,M)};e.materials.push({index:t,textureBindings:b,textureCoordinators:w,constantColors:x,textureEnvironment:q,alphaTestFunction:B,alphaTestReference:R,renderFlags:$,isTransparent:Y,polygonOffset:_}),p+=348,1!==e.version&&2!==e.version||(p+=16)}}(a,e.slice(g));const _=t.getUint32(f+20,!0),S=t.getUint32(f,!0);f+=4,function(e,t,a){e.textures=p(t,a,e.name)}(a,e.slice(S),0!==_?e.slice(_):null);const v=t.getUint32(f,!0);f+=4,b(a,e.slice(v)),f+=4;const w=t.getUint32(f,!0);f+=4,function(e,t){const a=t.createDataView();r.assert("vatr"===r.readString(t,0,4));const n=a.getUint32(4,!0);let s=12;function i(e=0){const t=a.getUint32(s+0,!0),r=a.getUint32(s+4,!0);return s+=8,0===t?-1:r-e}const o=i(),l=t.slice(o,n),c=i(o);1!==e.version&&2!==e.version||i(o);const h=i(o),d=i(o);i(o),i(o);const u=i(o),m=i(o);e.vatrChunk={dataBuffer:l,positionByteOffset:0,normalByteOffset:c,colorByteOffset:h,texCoord0ByteOffset:d,texCoord1ByteOffset:-1,texCoord2ByteOffset:-1,boneIndicesByteOffset:u,boneWeightsByteOffset:m}}(a,e.slice(w));const x=t.getUint32(f,!0),T=t.getUint32(32,!0);return a.indexBuffer=e.slice(x,x+2*T),a}},function(e,t,a){"use strict";(function(e){a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return f}));var r=a(24),n=a(203),s=a(19),i=a(70);function o(e,t,a){if(t in e){var r=e[t],n=a(r);if("function"==typeof n)try{n.prototype=n.prototype||{},Object.defineProperties(n,{__sentry_original__:{enumerable:!1,value:r}})}catch(e){}e[t]=n}}function l(e){return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}function c(e){if(Object(r.d)(e)){var t=e,a={message:t.message,name:t.name,stack:t.stack};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(a[n]=t[n]);return a}if(Object(r.f)(e)){var i=e,o={};o.type=i.type;try{o.target=Object(r.c)(i.target)?Object(s.i)(i.target):Object.prototype.toString.call(i.target)}catch(e){o.target="<unknown>"}try{o.currentTarget=Object(r.c)(i.currentTarget)?Object(s.i)(i.currentTarget):Object.prototype.toString.call(i.currentTarget)}catch(e){o.currentTarget="<unknown>"}for(var n in"undefined"!=typeof CustomEvent&&Object(r.g)(e,CustomEvent)&&(o.detail=i.detail),i)Object.prototype.hasOwnProperty.call(i,n)&&(o[n]=i);return o}return e}function h(e){return function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(e))}function d(e,t,a){void 0===t&&(t=3),void 0===a&&(a=102400);var r=p(e,t);return h(r)>a?d(e,t-1,a):r}function u(t,a){return"domain"===a&&t&&"object"==typeof t&&t._events?"[Domain]":"domainEmitter"===a?"[DomainEmitter]":void 0!==e&&t===e?"[Global]":"undefined"!=typeof window&&t===window?"[Window]":"undefined"!=typeof document&&t===document?"[Document]":Object(r.l)(t)?"[SyntheticEvent]":"number"==typeof t&&t!=t?"[NaN]":void 0===t?"[undefined]":"function"==typeof t?"[Function: "+Object(s.f)(t)+"]":t}function m(e,t,a,s){if(void 0===a&&(a=1/0),void 0===s&&(s=new n.a),0===a)return function(e){var t=Object.prototype.toString.call(e);if("string"==typeof e)return e;if("[object Object]"===t)return"[Object]";if("[object Array]"===t)return"[Array]";var a=u(e);return Object(r.i)(a)?a:t}(t);if(null!=t&&"function"==typeof t.toJSON)return t.toJSON();var i=u(t,e);if(Object(r.i)(i))return i;var o=c(t),l=Array.isArray(t)?[]:{};if(s.memoize(t))return"[Circular ~]";for(var h in o)Object.prototype.hasOwnProperty.call(o,h)&&(l[h]=m(h,o[h],a-1,s));return s.unmemoize(t),l}function p(e,t){try{return JSON.parse(JSON.stringify(e,(function(e,a){return m(e,a,t)})))}catch(e){return"**non-serializable**"}}function f(e,t){void 0===t&&(t=40);var a=Object.keys(c(e));if(a.sort(),!a.length)return"[object has no keys]";if(a[0].length>=t)return Object(i.d)(a[0],t);for(var r=a.length;r>0;r--){var n=a.slice(0,r).join(", ");if(!(n.length>t))return r===a.length?n:Object(i.d)(n,t)}return""}}).call(this,a(57))},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15));function s(e){let t=e.getUint32(0,!0)>>>8;const a=new Uint8Array(t);let r=4,s=0;for(;;){const i=e.getUint8(r++);let o=8;for(;o--;){if(i&1<<o){const n=e.getUint16(r,!1);r+=2;let i=3+(n>>12),o=s-(1+(4095&n));for(t-=i;i--;)a[s++]=a[o++]}else t--,a[s++]=e.getUint8(r++);if(t<=0)return new n.default(a.buffer)}}}function i(e){let t=e.getUint32(0,!0)>>>8;const a=new Uint8Array(t);let r=4,s=0;for(;;){const i=e.getUint8(r++);let o=8;for(;o--;){if(i&1<<o){const n=e.getUint8(r)>>>4;let i=-1,o=-1;if(n>1){const t=e.getUint16(r,!1);o=n+1,i=1+(4095&t),r+=2}else if(0===n){const t=e.getUint16(r,!1)<<8|e.getUint8(r+2);o=17+(t>>>12),i=1+(4095&t),r+=3}else if(1===n){const t=e.getUint32(r,!1);o=273+(t>>>12&65535),i=1+(4095&t),r+=4}let l=s-i;for(t-=o;o--;)a[s++]=a[l++]}else t--,a[s++]=e.getUint8(r++);if(t<=0)return new n.default(a.buffer)}}}var o;t.decompressLZ_Normal=s,t.decompressLZ_Extended=i,function(e){e[e.LZ=16]="LZ"}(o||(o={})),t.decompress=function(e){const t=e.createDataView(),a=t.getUint8(0);if((240&a)===o.LZ){return!!(15&a)?i(t):s(t)}throw new Error("Unsupported CX compression type")},t.maybeDecompress=function(e){const t=e.createDataView(),a=t.getUint8(0);if((240&a)===o.LZ){return!!(15&a)?i(t):s(t)}return e}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(13),s=a(76);function i(e){return e.a<<12|e.b<<8|e.c<<4|e.d}function o(e){return 2==e.a||9==e.a||2==e.b||9==e.b||2==e.c||9==e.c||2==e.d||9==e.d}function l(e){return 2==e.a||2==e.b||2==e.c||2==e.d}t.decodeCombineParams=function(e,t){const a=e>>>20&7,n=e>>>15&15,s=e>>>12&7,i=e>>>9&7,o=e>>>5&7,l=e>>>0&15,c=t>>>28&7,h=t>>>24&7,d=t>>>21&7,u=t>>>18&7,m=t>>>15&7,p=t>>>12&7,f=t>>>9&7,A=t>>>6&7,g=t>>>3&7,_=t>>>0&7;return r.assert(6!=c&&6!=n&&6!=h&&6!=l),{c0:{a:a,b:c,c:n,d:m},a0:{a:s,b:p,c:i,d:f},c1:{a:o,b:h,c:l,d:A},a1:{a:d,b:g,c:u,d:_}}},t.fillCombineParams=function(e,t,a){const r=i(a.c0),s=i(a.c1),o=i(a.a0),l=i(a.a1);return n.fillVec4(e,t,r,o,s,l)},t.combineParamsUsesT1=function(e){return o(e.c0)||o(e.c1)||l(e.a0)||l(e.a1)};class c{constructor(e,t,a,n,s,i){this.dramAddr=t,this.dramPalAddr=a,this.width=n,this.height=s,this.pixels=i,this.format="rgba8",this.tile=new h,this.tile.copy(e),this.name=r.hexzero(this.dramAddr,8)}}t.Texture=c;class h{constructor(){this.fmt=0,this.siz=0,this.line=0,this.tmem=0,this.palette=0,this.cmt=0,this.maskt=0,this.shiftt=0,this.cms=0,this.masks=0,this.shifts=0,this.uls=0,this.ult=0,this.lrs=0,this.lrt=0}set(e,t,a,r,n,s,i,o,l,c,h){this.fmt=e,this.siz=t,this.line=a,this.tmem=r,this.palette=n,this.cmt=s,this.maskt=i,this.shiftt=o,this.cms=l,this.masks=c,this.shifts=h}setSize(e,t,a,r){this.uls=e,this.ult=t,this.lrs=a,this.lrt=r}copy(e){this.set(e.fmt,e.siz,e.line,e.tmem,e.palette,e.cmt,e.maskt,e.shiftt,e.cms,e.masks,e.shifts),this.setSize(e.uls,e.ult,e.lrs,e.lrt)}}t.TileState=h;const d=new Uint8Array(1024);function u(e){const t=1+(e.lrs-e.uls>>>2);return 0!==e.masks?Math.min(1<<e.masks,t):t}function m(e){const t=1+(e.lrt-e.ult>>>2);return 0!==e.maskt?Math.min(1<<e.maskt,t):t}function p(e,t,a,r){const n=e[t>>>24].createDataView();2===r.fmt&&function(e,t,a,r){const n=t[a>>>24].createDataView(),i=16777215&a;s.parseTLUT(e,n,i,r,2)}(d,e,a,r.siz);const i=u(r),o=m(r),l=new Uint8Array(i*o*4),h=16777215&t;switch(r.fmt<<4|r.siz){case 32:s.decodeTex_CI4(l,n,h,i,o,d,r.line);break;case 33:s.decodeTex_CI8(l,n,h,i,o,d,r.line);break;case 48:s.decodeTex_IA4(l,n,h,i,o,r.line);break;case 49:s.decodeTex_IA8(l,n,h,i,o,r.line);break;case 50:s.decodeTex_IA16(l,n,h,i,o,r.line);break;case 64:s.decodeTex_I4(l,n,h,i,o,r.line);break;case 65:s.decodeTex_I8(l,n,h,i,o,r.line);break;case 2:s.decodeTex_RGBA16(l,n,h,i,o,r.line);break;case 3:s.decodeTex_RGBA32(l,n,h,i,o);break;default:throw new Error(`Unknown image format ${r.fmt} / ${r.siz}`)}return new c(r,t,a,i,o,l)}t.getTileWidth=u,t.getTileHeight=m,t.getMaskedCMS=function(e){const t=1+(e.lrs-e.uls>>>2);return 0!==e.masks&&1<<e.masks<t?1&e.cms:e.cms},t.getMaskedCMT=function(e){const t=1+(e.lrt-e.ult>>>2);return 0!==e.maskt&&1<<e.maskt<t?1&e.cmt:e.cmt},t.translateTileTexture=p;t.TextureCache=class{constructor(){this.textures=[]}translateTileTexture(e,t,a,r){const n=this.textures.findIndex(e=>{return e.dramAddr===t&&(2!==r.fmt||e.dramPalAddr===a)&&(n=e.tile,s=r,n.uls===s.uls&&n.ult===s.ult&&n.lrs===s.lrs&&n.lrt===s.lrt);var n,s});if(n>=0)return n;{const n=p(e,t,a,r),s=this.textures.length;return this.textures.push(n),s}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);function n(e,t){if("*"===t&&1===e.childNodes.length)return e.childNodes[0];if("."===t)return e;for(let a=0;a<e.childNodes.length;a++){const r=e.childNodes[a];if(r.name===t)return r;if("directory"===r.kind&&"."===r.name){const e=n(r,t);if(null!==e)return e}}return null}function s(e,t){for(let a=0;a<t.length;a++){const r=n(e,t[a]);if(null===r)return null;if("file"===r.kind)return a===t.length-1?r:null;e=r}return e}class i{findDir(e){const t=s(this.root,e.split("/"));return null!==t&&"directory"===t.kind?t:null}findFile(e){const t=s(this.root,e.split("/"));return null!==t&&"file"===t.kind?t:null}findFileData(e){const t=this.findFile(e);return null!==t?t.buffer:null}}t.U8Archive=i,t.parse=function(e){const t=e.createDataView();r.assert("U8-"===r.readString(e,0,4));const a=t.getUint32(4,!1);let n;t.getUint32(8,!1),t.getUint32(12,!1),function(e){e[e.File=0]="File",e[e.Directory=1]="Directory"}(n||(n={}));const s=t.getUint8(a+0);r.assert(s===n.Directory);const o=t.getUint32(a+8,!1),l=a+12*o,c=function s(i,o){const c=a+12*i,h=t.getUint8(c+0),d=16777215&t.getUint32(c+0),u=r.readString(e,l+d);if(h===n.Directory){const e=t.getUint32(c+4,!1);r.assert(e===o);const a=t.getUint32(c+8,!1),n=[],l=[],h=[];for(let e=i+1;e<a;){const t=s(e,i);n.push(t),"directory"===t.kind?(h.push(t),e=t.nextNodeIndex):(l.push(t),e++)}return{kind:"directory",name:u,childNodes:n,subdirs:h,files:l,nextNodeIndex:a}}if(h===n.File){const a=t.getUint32(c+4,!1),r=t.getUint32(c+8,!1);return{kind:"file",name:u,buffer:e.subarray(a,r)}}throw"whoops"}(0,0);r.assert("directory"===c.kind);const h=new i;return h.root=c,h}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);function n(e,t,a,n=null){const s=a.split("\n").map(e=>e.replace(/[/][/].*$/,"")).filter(e=>!(!e||/^\s+$/.test(e)));let i="";null!==n&&(i=[...n.entries()].map(([e,t])=>`#define ${e} ${t}`).join("\n"));const o=s.find(e=>e.startsWith("precision"))||"precision mediump float;";let l,c=s.filter(e=>!e.startsWith("precision")).join("\n"),h="";if(e.explicitBindingLocations){let a=0,n=0,s=0;c=c.replace(/layout\((.*)\)\s+uniform/g,(e,t)=>`layout(${t}, set = ${a}, binding = ${n++}) uniform`),r.assert(e.separateSamplerTextures),c=c.replace(/uniform sampler2D (.*);/g,(e,r)=>"frag"===t?`\nlayout(set = ${a}, binding = ${n++}) uniform texture2D T_${r};\nlayout(set = ${a}, binding = ${n++}) uniform sampler S_${r};\n`:""),c=c.replace(/^varying/gm,(e,t)=>`layout(location = ${s++}) varying`),h="layout(location = 0) "}c=e.separateSamplerTextures?c.replace(/SAMPLER_2D\((.*?)\)/g,(e,t)=>`sampler2D(T_${t}, S_${t})`):c.replace(/SAMPLER_2D\((.*?)\)/g,(e,t)=>t),l=e.bugQuirks.rowMajorMatricesBroken?"\nstruct Mat4x4 { vec4 _m[4]; };\nstruct Mat4x3 { vec4 _m[3]; };\nstruct Mat4x2 { vec4 _m[2]; };\nvec4 Mul(Mat4x4 m, vec4 v) { return vec4(dot(m._m[0], v), dot(m._m[1], v), dot(m._m[2], v), dot(m._m[3], v)); }\nvec3 Mul(Mat4x3 m, vec4 v) { return vec3(dot(m._m[0], v), dot(m._m[1], v), dot(m._m[2], v)); }\nvec2 Mul(Mat4x2 m, vec4 v) { return vec2(dot(m._m[0], v), dot(m._m[1], v)); }\nvec4 Mul(vec3 v, Mat4x3 m) { return vec4(\ndot(vec3(m._m[0].x, m._m[1].x, m._m[2].x), v),\ndot(vec3(m._m[0].y, m._m[1].y, m._m[2].y), v),\ndot(vec3(m._m[0].z, m._m[1].z, m._m[2].z), v),\ndot(vec3(m._m[0].w, m._m[1].w, m._m[2].w), v)\n); }\nvoid Fma(Mat4x3 d, Mat4x3 m, float s) { d._m[0] += m._m[0] * s; d._m[1] += m._m[1] * s; d._m[2] += m._m[2] * s; }\nMat4x4 _Mat4x4(Mat4x3 m) { Mat4x4 o; o._m[0] = m._m[0]; o._m[1] = m._m[1]; o._m[2] = m._m[2]; o._m[3] = vec4(0, 0, 0, 1); return o; }\nMat4x4 _Mat4x4(Mat4x2 m) { Mat4x4 o; o._m[0] = m._m[0]; o._m[1] = m._m[1]; o._m[2] = vec4(0, 0, 1, 0); o._m[3] = vec4(0, 0, 0, 1); return o; }\nMat4x4 _Mat4x4(float n) { Mat4x4 o; o._m[0].x = n; o._m[1].y = n; o._m[2].z = n; o._m[3].w = n; return o; }\nMat4x3 _Mat4x3(Mat4x4 m) { Mat4x3 o; o._m[0] = m._m[0]; o._m[1] = m._m[1]; o._m[2] = m._m[2]; return o; }\nMat4x3 _Mat4x3(float n) { Mat4x3 o; o._m[0].x = n; o._m[1].y = n; o._m[2].z = n; return o; }\n":"\n#define Mat4x4 mat4x4\n#define Mat4x3 mat4x3\n#define Mat4x2 mat4x2\n#define _Mat4x4 mat4x4\n#define _Mat4x3 mat4x3\n#define Mul(A, B) (A * B)\n#define Fma(D, M, S) (D += (M) * (S))\n";const d=c.includes("gl_FragColor");return`\n${e.glslVersion}\n${o}\n#define ${t.toUpperCase()}\n#define attribute in\n#define varying ${"vert"===t?"out":"in"}\n#define main${"vert"===t?"VS":"PS"} main\n${d?`\n#define gl_FragColor o_color\n${"frag"===t?`${h}out vec4 o_color;`:""}\n`:""}\n${l}\n${i}\n${c}\n`.trim()}function s(e,t,a,r=null){return{vert:t,frag:a,preprocessedVert:n(e,"vert",t,r),preprocessedFrag:n(e,"frag",a,r)}}t.preprocessShader_GLSL=n,t.preprocessProgram_GLSL=s,t.preprocessProgramObj_GLSL=function(e,t){const a=void 0!==t.defines?t.defines:null,r=void 0!==t.both?t.both+t.vert:t.vert,n=void 0!==t.both?t.both+t.frag:t.frag;return s(e.queryVendorInfo(),r,n,a)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(86),n=a(85);function s(e,t){return e.preprocessedVert===t.preprocessedVert&&e.preprocessedFrag===t.preprocessedFrag}function i(e){let t=0;return t=r.hashCodeNumberUpdate(t,e.program.ResourceUniqueId),t}function o(e){let t=0;for(let a=0;a<e.samplerBindings.length;a++){const n=e.samplerBindings[a];null!==n&&null!==n.gfxTexture&&(t=r.hashCodeNumberUpdate(t,n.gfxTexture.ResourceUniqueId))}return r.hashCodeNumberFinish(t)}t.GfxRenderCache=class{constructor(){this.gfxBindingsCache=new r.HashMap(n.gfxBindingsDescriptorEquals,o,64,4),this.gfxRenderPipelinesCache=new r.HashMap(n.gfxRenderPipelineDescriptorEquals,i,16,4),this.gfxInputLayoutsCache=new r.HashMap(n.gfxInputLayoutDescriptorEquals,r.nullHashFunc),this.gfxProgramCache=new r.HashMap(s,r.nullHashFunc),this.gfxSamplerCache=new r.HashMap(n.gfxSamplerDescriptorEquals,r.nullHashFunc)}createBindings(e,t){let a=this.gfxBindingsCache.get(t);if(null===a){const r=n.gfxBindingsDescriptorCopy(t);a=e.createBindings(r),this.gfxBindingsCache.add(r,a)}return a}createRenderPipeline(e,t){let a=this.gfxRenderPipelinesCache.get(t);if(null===a){const r=n.gfxRenderPipelineDescriptorCopy(t);a=e.createRenderPipeline(r),this.gfxRenderPipelinesCache.add(r,a)}return a}createInputLayout(e,t){let a=this.gfxInputLayoutsCache.get(t);return null===a&&(a=e.createInputLayout(t),this.gfxInputLayoutsCache.add(t,a)),a}createProgramSimple(e,t){let a=this.gfxProgramCache.get(t);return null===a&&(a=e.createProgramSimple(t),this.gfxProgramCache.add(t,a)),a}createProgram(e,t){t.ensurePreprocessed(e.queryVendorInfo());let a=this.gfxProgramCache.get(t);return null===a&&(a=e.createProgram(t),this.gfxProgramCache.add(t,a)),a}createSampler(e,t){let a=this.gfxSamplerCache.get(t);return null===a&&(a=e.createSampler(t),this.gfxSamplerCache.add(t,a)),a}numBindings(){return this.gfxBindingsCache.size()}destroy(e){for(const[t,a]of this.gfxBindingsCache.entries())e.destroyBindings(a);for(const[t,a]of this.gfxRenderPipelinesCache.entries())e.destroyRenderPipeline(a);for(const[t,a]of this.gfxInputLayoutsCache.entries())e.destroyInputLayout(a);for(const[t,a]of this.gfxProgramCache.entries())e.destroyProgram(a);for(const[t,a]of this.gfxSamplerCache.entries())e.destroySampler(a);this.gfxBindingsCache.clear(),this.gfxRenderPipelinesCache.clear(),this.gfxInputLayoutsCache.clear(),this.gfxProgramCache.clear(),this.gfxSamplerCache.clear()}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=a(0),i=a(2),o=a(8),l=r(a(11)),c=a(6),h=a(7),d=a(51),u=a(9),m=r(a(27)),p=r(a(39)),f=a(5),A=a(5),g=a(26),_=a(25),S=a(28),b=a(220),v=a(142),w=a(40),x=a(163),T=a(93),y=a(224),C=a(53),M=a(226),U=a(143),k=a(165),D=a(144),I=a(166),R=a(110),B=a(79);t.FPS=60;const P=t.FPS/1e3;function E(e){return e.deltaTime*P}function F(e){return i.clamp(E(e),0,1.5)}function V(e){return null!==e.priorDrawAirHolder&&e.priorDrawAirHolder.isExistValidDrawAir()}t.getDeltaTimeFramesRaw=E,t.getDeltaTimeFrames=F,t.getTimeFrames=function(e){return e.time*P};class O{constructor(e,t,a,r){this.renderHelper=t,this.spawner=a,this.sceneObjHolder=r,this.bloomParameters=new b.BloomPostFXParameters,this.mainRenderTarget=new u.BasicRenderTarget,this.sceneTexture=new u.ColorTexture,this.currentScenarioIndex=-1,this.scenarioNoToIndex=[],this.isInteractive=!0,this.bloomRenderer=new b.BloomPostFXRenderer(e,this.renderHelper.renderInstManager.gfxRenderCache,this.mainRenderTarget),this.applyCurrentScenario()}applyCurrentScenario(){const e=this.sceneObjHolder.scenarioData.scenarioDataIter;(this.currentScenarioIndex<0||this.currentScenarioIndex>=e.getNumRecords())&&(this.currentScenarioIndex=0),e.setRecord(this.currentScenarioIndex);for(let t=0;t<this.spawner.zones.length;t++){const a=this.spawner.zones[t];void 0!==a&&(a.layerMask=s.assertExists(e.getValueNumber(a.name)))}this.spawner.zones[0].computeZoneVisibility(),this.sceneObjHolder.nameObjHolder.scenarioChanged(this.sceneObjHolder)}setCurrentScenario(e){if(this.currentScenarioIndex===e)return;this.currentScenarioIndex=e,this.applyCurrentScenario();const t=this.scenarioNoToIndex.indexOf(e)-1;this.scenarioSelect.setHighlighted(t),this.onstatechanged()}createPanels(){const e=new l.Panel;e.customHeaderBackgroundColor=l.COOL_BLUE_COLOR,e.setTitle(l.TIME_OF_DAY_ICON,"Scenario");const t=this.sceneObjHolder.sceneDesc.galaxyName,a=this.sceneObjHolder.scenarioData.scenarioDataIter;a.mapRecords((e,t)=>{this.scenarioNoToIndex[s.assertExists(e.getValueNumber("ScenarioNo"))]=t});const r=[];for(let e=1;e<this.scenarioNoToIndex.length;e++){const n=this.scenarioNoToIndex[e];a.setRecord(n);let i=null;null===i&&null!==this.sceneObjHolder.messageDataHolder&&(i=this.sceneObjHolder.messageDataHolder.getStringById(`ScenarioName_${t}${e}`)),null!==i&&""!==i||(i=s.assertExists(a.getValueString("ScenarioName"))),r.push(i)}return this.scenarioSelect=new l.SingleSelect,this.scenarioSelect.setStrings(r),this.scenarioSelect.onselectionchange=e=>{const t=this.scenarioNoToIndex[e+1];this.setCurrentScenario(t)},this.scenarioSelect.selectItem(0),e.contents.appendChild(this.scenarioSelect.elem),[e]}findBloomArea(){return null}prepareBloomParameters(e){const t=this.findBloomArea();null!==t?(e.intensity1=t.objArg2/256,e.intensity2=t.objArg3/256,e.bloomIntensity=t.objArg0/256):"PeachCastleGardenGalaxy"===this.spawner.zones[0].name?(e.intensity1=.15625,e.intensity2=60/256,e.bloomIntensity=110/256):(e.intensity1=25/256,e.intensity2=25/256,e.bloomIntensity=50/256)}drawAllEffects(e){if(null===this.sceneObjHolder.effectSystem)return;const t=this.sceneObjHolder.effectSystem;for(let a=71;a<=77;a++){this.renderHelper.renderInstManager.pushTemplateRenderInst().filterKey=w.createFilterKeyForDrawType(a);let r=null;72===a&&(r=H,o.texProjCameraSceneTex(r,e.camera,e.viewport,1)),t.setDrawInfo(e.camera.viewMatrix,e.camera.projectionMatrix,r),t.draw(this.sceneObjHolder.modelCache.device,this.renderHelper.renderInstManager,a),this.renderHelper.renderInstManager.popTemplateRenderInst()}}drawOpa(e,t){h.executeOnPass(this.renderHelper.renderInstManager,this.sceneObjHolder.modelCache.device,e,w.createFilterKeyForDrawBufferType(0,t))}drawXlu(e,t){h.executeOnPass(this.renderHelper.renderInstManager,this.sceneObjHolder.modelCache.device,e,w.createFilterKeyForDrawBufferType(1,t))}execute(e,t){h.executeOnPass(this.renderHelper.renderInstManager,this.sceneObjHolder.modelCache.device,e,w.createFilterKeyForDrawType(t))}isNormalBloomOn(){return!!this.sceneObjHolder.sceneNameObjListExecutor.drawBufferHasVisible(30)}render(e,t){const a=this.sceneObjHolder.sceneNameObjListExecutor,r=t.camera;r.setClipPlanes(100,8e5),a.executeMovement(this.sceneObjHolder,t),a.executeCalcAnim(this.sceneObjHolder,t),this.mainRenderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.sceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.sceneObjHolder.captureSceneDirector.opaqueSceneTexture=this.sceneTexture.gfxTexture;const n=this.renderHelper.pushTemplateRenderInst();f.fillSceneParamsDataOnTemplate(n,t);const s=this.sceneObjHolder.effectSystem;if(null!==s){const e=F(t);s.calc(e);const a=s.particleResourceHolder.getTextureMappingReference("IndDummy");null!==a&&this.sceneObjHolder.captureSceneDirector.fillTextureMappingOpaqueSceneTexture(a)}a.setIndirectTextureOverride(this.sceneTexture.gfxTexture),a.executeDrawAll(this.sceneObjHolder,this.renderHelper.renderInstManager,t),a.drawAllBuffers(this.sceneObjHolder.modelCache.device,this.renderHelper.renderInstManager,r,t.viewport),this.drawAllEffects(t);let i=-1;this.isNormalBloomOn()&&(this.prepareBloomParameters(this.bloomParameters),i=this.bloomRenderer.allocateParameterBuffer(this.renderHelper.renderInstManager,this.bloomParameters));const o=e.createHostAccessPass();let l;if(this.renderHelper.prepareToRender(e,o),e.submitPass(o),l=this.mainRenderTarget.createRenderPass(e,t.viewport,u.standardFullClearRenderPassDescriptor),V(this.sceneObjHolder)&&(this.drawOpa(l,1),this.drawOpa(l,2),this.drawOpa(l,3),this.drawXlu(l,1),this.drawXlu(l,2),this.drawXlu(l,3)),e.submitPass(l),l=this.mainRenderTarget.createRenderPass(e,t.viewport,u.depthClearRenderPassDescriptor,this.sceneTexture.gfxTexture),this.drawOpa(l,32),this.drawXlu(l,32),this.drawOpa(l,4),this.drawOpa(l,5),this.drawOpa(l,6),this.drawOpa(l,8),this.drawOpa(l,10),this.drawOpa(l,9),this.drawOpa(l,31),this.drawOpa(l,11),this.drawOpa(l,12),this.drawOpa(l,13),this.drawOpa(l,14),this.drawOpa(l,15),this.drawOpa(l,16),this.drawOpa(l,17),this.drawOpa(l,18),this.drawOpa(l,19),this.drawOpa(l,21),V(this.sceneObjHolder)||(this.drawOpa(l,1),this.drawOpa(l,2),this.drawOpa(l,3),this.drawXlu(l,1),this.drawXlu(l,2),this.drawXlu(l,3)),this.execute(l,10),this.execute(l,0),this.execute(l,6),this.execute(l,24),this.execute(l,27),this.execute(l,29),this.drawOpa(l,24),this.drawXlu(l,4),this.drawXlu(l,5),this.drawXlu(l,6),this.drawXlu(l,7),this.drawXlu(l,8),this.drawXlu(l,9),this.drawXlu(l,31),this.drawXlu(l,10),this.drawXlu(l,11),this.drawXlu(l,12),this.drawXlu(l,13),this.drawXlu(l,14),this.drawXlu(l,15),this.drawXlu(l,16),this.drawXlu(l,17),this.drawXlu(l,18),this.drawXlu(l,19),this.drawXlu(l,21),this.drawXlu(l,24),this.execute(l,71),this.execute(l,76),e.submitPass(l),l=this.mainRenderTarget.createRenderPass(e,t.viewport,u.noClearRenderPassDescriptor),this.drawOpa(l,29),this.drawOpa(l,25),this.drawOpa(l,26),this.drawOpa(l,27),this.drawOpa(l,28),this.drawOpa(l,34),this.drawOpa(l,23),this.drawOpa(l,22),this.drawXlu(l,29),this.drawXlu(l,25),this.drawXlu(l,26),this.drawXlu(l,27),this.drawXlu(l,28),this.drawXlu(l,34),this.drawXlu(l,23),this.drawXlu(l,22),this.execute(l,14),this.execute(l,8),this.execute(l,7),this.execute(l,72),this.execute(l,73),this.isNormalBloomOn()&&this.bloomRenderer.pipelinesReady(e)){e.submitPass(l);const a=this.bloomRenderer.renderBeginObjects(e,t);this.drawOpa(a,30),this.drawXlu(a,30),this.execute(a,76),l=this.bloomRenderer.renderEndObjects(e,a,this.renderHelper.renderInstManager,this.mainRenderTarget,t,n,i)}return this.execute(l,77),this.execute(l,512),this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.renderInstManager.resetRenderInsts(),l}serializeSaveState(e,t){return new DataView(e).setUint8(t++,this.currentScenarioIndex),t}deserializeSaveState(e,t,a){const r=new DataView(e);return t<a&&this.setCurrentScenario(r.getUint8(t++)),t}destroy(e){this.mainRenderTarget.destroy(e),this.sceneTexture.destroy(e),this.bloomRenderer.destroy(e)}}function N(e){if(-1===e)return"common";return s.assert(e>=0),`layer${String.fromCharCode("a".charCodeAt(0)+e)}`}function L(e,t,a,r){const n=t.totalVertexCount,s=new Uint8Array(n*a);e.vertexBufferStrides[1]=a,t.vertexBuffers[1]=s;const i=new DataView(t.vertexBuffers[0]),o=e.vertexBufferStrides[0];let l=e.vertexAttributeOffsets[0];for(let e=0;e<n;e++){const t=i.getFloat32(l,!0);for(let n=0;n<a;n++)r[n]>=0&&(s[e*a+n]=t+r[n]);l+=o}}function G(e){return 2===e||3===e||8===e||9===e}t.SMGRenderer=O;const H=n.mat4.create();function j(e,t,a,r,n,s,o){const l=t.materialData.material;let c=!1;for(let i=0;i<l.texMatrices.length;i++){const o=l.texMatrices[i];if(null===o)continue;const h=63&o.info;(1===h||6===h||7===h)&&(c=!0);const d=e.u_PostTexMtx[i],u=e.m_TextureMapping[i].flipY;t.calcPostTexMtxInput(d,o,a);const m=H;t.calcTexSRT(m,i),t.calcTexMtx(d,o,m,r,n,s,u)}if(c)for(let t=0;t<10;t++){const a=e.u_TexMtx[t];i.computeNormalMatrix(a,o.u_PosMtx[t],!0)}}class W{constructor(e,t,a){this.arc=a,this.modelTable=new Map,this.motionTable=new Map,this.btkTable=new Map,this.bpkTable=new Map,this.btpTable=new Map,this.brkTable=new Map,this.bvaTable=new Map,this.banmtTable=new Map,this.initEachResTable(this.modelTable,[".bdl",".bmd"],(a,r)=>{const n=g.BMD.parse(r.buffer);!function(e){for(let a=0;a<e.shp1.shapes.length;a++){const r=e.shp1.shapes[a];if(3!==r.displayFlags)continue;const n=e.mat3.materialEntries[r.materialIndex];n.gxMaterial.useTexMtxIdx=s.nArray(8,()=>!1);let i=0,o=s.nArray(8,()=>-1),l=!1;for(let e=0;e<n.gxMaterial.texGens.length;e++){const a=n.gxMaterial.texGens[e];if(null===a)continue;if(60===a.matrix)continue;const r=(a.matrix-30)/3,c=63&s.assertExists(n.texMatrices[r]).info,h=1===(t=c)||6===t||7===t,d=G(c);(h||d)&&(n.gxMaterial.useTexMtxIdx[e]=!0,a.postMatrix=64+3*e,h?o[e]=30:d&&(o[e]=0),i=Math.max(i,e+1),l=l||h,n.gxMaterial.hasPostTexMtxBlock=!0)}if(l)for(let e=0;e<n.gxMaterial.texGens.length;e++)n.gxMaterial.texGens[e].matrix=60;if(i>0){i=s.align(i,4);for(let e=0;e<r.mtxGroups.length;e++){const t=r.mtxGroups[e];L(r.loadedVertexLayout,t.loadedVertexData,i,o)}(o[0]>=0||o[1]>=0||o[2]>=0||o[3]>=0)&&r.loadedVertexLayout.singleVertexInputLayouts.push({attrInput:0,format:c.GfxFormat.U8_RGBA_NORM,bufferIndex:1,bufferOffset:0}),(o[4]>=0||o[5]>=0||o[6]>=0||o[7]>=0)&&r.loadedVertexLayout.singleVertexInputLayouts.push({attrInput:1,format:c.GfxFormat.U8_RGBA_NORM,bufferIndex:1,bufferOffset:4})}}var t}(n);const i=new _.J3DModelData(e,t,n);return function(e){for(let t=0;t<e.shapeData.length;t++)e.shapeData[t].sortKeyBias=0;const t=e.modelMaterialData.materialData;for(let e=0;e<t.length;e++){const a=t[e],r=a.material.gxMaterial;void 0!==r.useTexMtxIdx&&r.useTexMtxIdx.some(e=>e)&&(a.fillMaterialParamsCallback=j)}}(i),i}),this.initEachResTable(this.motionTable,[".bck",".bca"],(e,t)=>g.BCK.parse(t.buffer)),this.initEachResTable(this.btkTable,[".btk"],(e,t)=>g.BTK.parse(t.buffer)),this.initEachResTable(this.bpkTable,[".bpk"],(e,t)=>g.BPK.parse(t.buffer)),this.initEachResTable(this.btpTable,[".btp"],(e,t)=>g.BTP.parse(t.buffer)),this.initEachResTable(this.brkTable,[".brk"],(e,t)=>g.BRK.parse(t.buffer)),this.initEachResTable(this.bvaTable,[".bva"],(e,t)=>g.BVA.parse(t.buffer)),this.initEachResTable(this.banmtTable,[".banmt"],(e,t)=>U.BckCtrl.parse(t.buffer))}getModel(e){return s.assertExists(this.modelTable.get(e.toLowerCase()))}getRes(e,t){return s.nullify(e.get(t.toLowerCase()))}initEachResTable(e,t,a){for(let r=0;r<this.arc.files.length;r++){const n=this.arc.files[r];for(let r=0;r<t.length;r++){const s=t[r];if(n.name.endsWith(s)){const t=n.name.slice(0,-s.length).toLowerCase();e.set(t,a(s,n))}}}}destroy(e){for(const[,t]of this.modelTable)t.destroy(e)}}t.ResourceHolder=W;class Z{constructor(e,t,a){this.device=e,this.pathBase=t,this.dataFetcher=a,this.archivePromiseCache=new Map,this.archiveCache=new Map,this.archiveResourceHolder=new Map,this.cache=new d.GfxRenderCache}waitForLoad(){const e=[...this.archivePromiseCache.values()];return Promise.all(e)}async requestArchiveDataInternal(e,t){const a=await this.dataFetcher.fetchData(`${this.pathBase}/${e}`,1,t);if(0===a.byteLength)return console.warn(`Could not fetch archive ${e}`),null;const r=await m.decompress(a),n=p.parse(r);return this.archiveCache.set(e,n),n}async requestArchiveData(e){if(this.archivePromiseCache.has(e))return this.archivePromiseCache.get(e);const t=this.requestArchiveDataInternal(e,()=>{this.archivePromiseCache.delete(e)});return this.archivePromiseCache.set(e,t),t}isArchiveExist(e){return this.archiveCache.has(e)&&null!==this.archiveCache.get(e)}getArchive(e){return s.assertExists(this.archiveCache.get(e))}requestObjectData(e){return this.requestArchiveData(`ObjectData/${e}.arc`)}isObjectDataExist(e){return this.isArchiveExist(`ObjectData/${e}.arc`)}getResourceHolder(e){if(this.archiveResourceHolder.has(e))return this.archiveResourceHolder.get(e);const t=this.getObjectData(e),a=new W(this.device,this.cache,t);return this.archiveResourceHolder.set(e,a),a}getObjectData(e){return s.assertExists(this.getArchive(`ObjectData/${e}.arc`))}destroy(e){this.cache.destroy(e);for(const t of this.archiveResourceHolder.values())t.destroy(e)}}t.ModelCache=Z;class z{constructor(e){this.scenarioArc=e;const t=S.createCsvParser(e.findFileData("ZoneList.bcsv"));this.zoneNames=t.mapRecords(e=>s.assertExists(e.getValueString("ZoneName"))),this.scenarioDataIter=S.createCsvParser(e.findFileData("ScenarioData.bcsv"))}getMasterZoneFilename(){return this.zoneNames[0]}}class K{fillTextureMappingOpaqueSceneTexture(e){C.setTextureMappingIndirect(e,this.opaqueSceneTexture)}}class X extends w.NameObj{constructor(e){super(e,"AreaObjContainer"),this.managers=[],this.managers.push(new v.LightAreaHolder(e)),this.managers.push(new k.WaterAreaMgr(e))}getManager(e){for(let t=0;t<this.managers.length;t++)if(this.managers[t].name===e)return this.managers[t];throw"whoops"}getAreaObj(e,t){return this.getManager(e).find_in(t)}}class Y{constructor(){this.effectSystem=null,this.messageDataHolder=null,this.sensorHitChecker=null,this.collisionDirector=null,this.stageSwitchContainer=null,this.switchWatcherHolder=null,this.sleepControllerHolder=null,this.areaObjContainer=null,this.planetGravityManager=null,this.coinRotater=null,this.airBubbleHolder=null,this.swingRopeGroup=null,this.trapezeRopeDrawInit=null,this.waterAreaHolder=null,this.waterPlantDrawInit=null,this.electricRailHolder=null,this.priorDrawAirHolder=null,this.captureSceneDirector=new K,this.sceneNameObjListExecutor=new w.SceneNameObjListExecutor,this.nameObjHolder=new w.NameObjHolder}create(e){null===this.getObj(e)&&this.newEachObj(e)}getObj(e){return 0===e?this.sensorHitChecker:1===e?this.collisionDirector:10===e?this.stageSwitchContainer:11===e?this.switchWatcherHolder:12===e?this.sleepControllerHolder:13===e?this.areaObjContainer:50===e?this.planetGravityManager:56===e?this.coinRotater:57===e?this.airBubbleHolder:71===e?this.swingRopeGroup:74===e?this.trapezeRopeDrawInit:98===e?this.waterAreaHolder:99===e?this.waterPlantDrawInit:89===e?this.electricRailHolder:117===e?this.priorDrawAirHolder:null}newEachObj(e){0===e?this.sensorHitChecker=new D.SensorHitChecker(this):1===e?this.collisionDirector=new R.CollisionDirector(this):10===e?this.stageSwitchContainer=new B.StageSwitchContainer(this):11===e?this.switchWatcherHolder=new B.SwitchWatcherHolder(this):12===e?this.sleepControllerHolder=new B.SleepControllerHolder(this):13===e?this.areaObjContainer=new X(this):50===e?this.planetGravityManager=new I.PlanetGravityManager(this):56===e?this.coinRotater=new T.CoinRotater(this):57===e?this.airBubbleHolder=new T.AirBubbleHolder(this):71===e?this.swingRopeGroup=new T.SwingRopeGroup(this):74===e?this.trapezeRopeDrawInit=new T.TrapezeRopeDrawInit(this):98===e?this.waterAreaHolder=new k.WaterAreaHolder(this):99===e?this.waterPlantDrawInit=new T.WaterPlantDrawInit(this):89===e?this.electricRailHolder=new T.ElectricRailHolder(this):117===e&&(this.priorDrawAirHolder=new T.PriorDrawAirHolder(this))}destroy(e){this.nameObjHolder.destroy(e),null!==this.effectSystem&&this.effectSystem.destroy(e)}}function $(e){return s.assertExists(e.getValueString("name"))}function q(e,t){return!(e>=0)||!!(t&1<<e)}t.SceneObjHolder=Y,t.createSceneObj=function(e,t){e.create(t)},t.getObjectName=$;class Q{constructor(e){this.stageDataHolder=e,this.layerMask=4294967295,this.visible=!0,this.layerVisible=!0,this.subzones=[],this.name=e.zoneName}computeZoneVisibility(){for(let e=0;e<this.subzones.length;e++)this.subzones[e].layerVisible=this.layerVisible&&q(this.subzones[e].stageDataHolder.layerId,this.layerMask)}}class J{constructor(e){if(this.sceneObjHolder=e,this.zones=[],this.legacySpawner=new M.NoclipLegacyActorSpawner(this.sceneObjHolder),"SuperMarioGalaxy"===this.sceneObjHolder.sceneDesc.pathBase)this.gameBit=1;else{if("SuperMarioGalaxy2"!==this.sceneObjHolder.sceneDesc.pathBase)throw"whoops";this.gameBit=2}}getActorTableEntry(e){const t=y.getNameObjFactoryTableEntry(e,this.gameBit);if(null!==t)return t;const a=this.sceneObjHolder.planetMapCreator.getActorTableEntry(e,this.gameBit);return null!==a?a:null}placeZones(e){const t=new Q(e);this.zones.push(t);for(let a=0;a<e.localStageDataHolders.length;a++){const r=this.placeZones(e.localStageDataHolders[a]);t.subzones.push(r)}return t}placeStageData(e,t){e.iterPlacement((t,a)=>{const r=this.getActorTableEntry($(t)),n={zoneId:e.zoneId,layerId:a};if(null!==r){if(null===r.factoryFunc)return;r.factoryFunc(n,this.sceneObjHolder,t)}else{const a=e.legacyCreateObjinfo(t),r=function(e){const t=new S.JMapInfoIter(e.bcsv,e.record);return t.originalStageDataHolder=e.originalStageDataHolder,t}(t);this.legacySpawner.spawnObjectLegacy(n,r,a)}},t);for(let a=0;a<e.localStageDataHolders.length;a++)this.placeStageData(e.localStageDataHolders[a],t)}place(){const e=this.sceneObjHolder.stageDataHolder;this.placeZones(e),this.placeStageData(e,!0),this.placeStageData(e,!1),this.sceneObjHolder.nameObjHolder.initAfterPlacement(this.sceneObjHolder),this.legacySpawner.place()}requestArchivesForObj(e){const t=$(e);if(this.sceneObjHolder.planetMapCreator.isRegisteredObj(t))return void this.sceneObjHolder.planetMapCreator.requestArchive(this.sceneObjHolder,t);const a=this.getActorTableEntry(t);null!==a&&null!==a.requestArchivesFunc&&a.requestArchivesFunc(this.sceneObjHolder,e)}requestArchivesForStageDataHolder(e){e.iterPlacement((e,t)=>{this.requestArchivesForObj(e)});for(let t=0;t<e.localStageDataHolders.length;t++)this.requestArchivesForStageDataHolder(e.localStageDataHolders[t])}requestArchives(){this.requestArchivesForStageDataHolder(this.sceneObjHolder.stageDataHolder),this.legacySpawner.requestArchives(this.sceneObjHolder)}checkAliveScenario(e){if(e.zoneId<0)return s.assert(e.layerId<0),!0;for(let t=0;t<this.zones.length;t++){const a=this.zones[t];if(a.stageDataHolder.zoneId===e.zoneId&&(a.visible&&a.layerVisible&&q(e.layerId,a.layerMask)))return!0}return!1}}class ee{constructor(e,t,a,r,s,i=-1){this.zoneName=r,this.zoneId=s,this.layerId=i,this.localStageDataHolders=[],this.placementMtx=n.mat4.create(),this.zoneArchive=e.getZoneMapArchive(t,r),this.createLocalStageDataHolders(e,t,a)}createCsvParser(e){const t=S.createCsvParser(e);return t.originalStageDataHolder=this,t}getCommonPathPointInfo(e){const t=this.createCsvParser(this.zoneArchive.findFileData("jmp/path/CommonPathInfo"));for(let a=0;a<t.getNumRecords()&&(t.setRecord(a),t.getValueNumber("l_id")!==e);a++);const a=t.getValueNumber("no");return[t,this.createCsvParser(this.zoneArchive.findFileData(`jmp/path/CommonPathPointInfo.${a}`))]}legacyCreateObjinfo(e){const t=s.fallback(e.getValueNumberNoInit("l_id"),-1),a=s.fallback(e.getValueString("name"),"Unknown"),r=s.fallback(e.getValueNumberNoInit("Obj_arg0"),-1),o=s.fallback(e.getValueNumberNoInit("Obj_arg1"),-1),l=s.fallback(e.getValueNumberNoInit("Obj_arg2"),-1),c=s.fallback(e.getValueNumberNoInit("Obj_arg3"),-1),h=n.mat4.create(),d=n.vec3.create(),u=n.vec3.create(),m=n.vec3.create();return S.getJMapInfoScale(m,e),S.getJMapInfoRotateLocal(u,e),S.getJMapInfoTransLocal(d,e),i.computeModelMatrixSRT(h,m[0],m[1],m[2],u[0],u[1],u[2],d[0],d[1],d[2]),{objId:t,objName:a,objArg0:r,objArg1:o,objArg2:l,objArg3:c,modelMatrix:h}}iterLayer(e,t,a){const r=this.createCsvParser(a);for(let a=0;a<r.getNumRecords();a++)r.setRecord(a),t(r,e)}isPrioPlacementObjInfo(e){return"areaobjinfo"===e||"planetobjinfo"===e||"demoobjinfo"===e||"cameracubeinfo"===e}iterPlacementDir(e,t,a,r){for(let n=0;n<r.files.length;n++){const s=r.files[n],i=s.name.toLowerCase();"stageobjinfo"!==i&&(null!==e&&this.isPrioPlacementObjInfo(i)!==e||this.iterLayer(t,a,s.buffer))}}iterPlacement(e,t=null){for(let a=-1;a<=15;a++){const r=N(a),n=this.zoneArchive.findDir(`jmp/Placement/${r}`);null!==n&&this.iterPlacementDir(t,a,e,n);const s=this.zoneArchive.findDir(`jmp/MapParts/${r}`);null!==s&&this.iterPlacementDir(t,a,e,s)}}createLocalStageDataHolders(e,t,a){for(let r=-1;r<=15;r++){const n=N(r),i=this.zoneArchive.findFileData(`jmp/Placement/${n}/StageObjInfo`);if(null===i)continue;const o=S.createCsvParser(i);for(let n=0;n<o.getNumRecords();n++){o.setRecord(n);const i=$(o),l=a.zoneNames.indexOf(i);s.assert(l>=0);const c=new ee(e,t,a,i,l,r);c.calcPlacementMtx(o),this.localStageDataHolders.push(c)}}}calcPlacementMtx(e){const t=s.fallback(e.getValueNumber("pos_x"),0),a=s.fallback(e.getValueNumber("pos_y"),0),r=s.fallback(e.getValueNumber("pos_z"),0),n=.01745*s.fallback(e.getValueNumber("dir_x"),0),o=.01745*s.fallback(e.getValueNumber("dir_y"),0),l=.01745*s.fallback(e.getValueNumber("dir_z"),0);i.computeModelMatrixSRT(this.placementMtx,1,1,1,n,o,l,t,a,r)}findPlacedStageDataHolder(e){return e.originalStageDataHolder}}class te{constructor(e){this.mesgData=e;const t=new g.JSystemFileReaderHelper(this.mesgData);s.assert("MESGbmg1"===t.magic),this.inf1=t.nextChunk("INF1"),this.dat1=t.nextChunk("DAT1");const a=this.inf1.createDataView();this.numStrings=a.getUint16(8),this.inf1ItemSize=a.getUint16(10)}getStringByIndex(e){const t=8+this.inf1.createDataView().getUint32(16+e*this.inf1ItemSize+0),a=this.dat1.createDataView();let r=t,n="";for(;;){const e=a.getUint16(r+0);if(0===e)break;if(26===e){const e=a.getUint8(r+2),t=a.getUint8(r+3);5===t?n+="Mario":console.warn(`Unknown escape kind ${t}`),r+=e}else n+=String.fromCharCode(e),r+=2}return n}}class ae{constructor(e){const t=S.createCsvParser(e.findFileData("MessageId.tbl"));this.messageIds=t.mapRecords(e=>s.assertExists(e.getValueString("MessageId"))),this.mesg=new te(e.findFileData("Message.bmg"))}getStringById(e){const t=this.messageIds.indexOf(e);return t<0?null:this.mesg.getStringByIndex(t)}}t.SMGSceneDescBase=class{constructor(e,t,a=t){this.name=e,this.galaxyName=t,this.id=a}placeExtra(e){}patchRenderer(e){}async createScene(e,t){const a=await t.dataShare.ensureObject(`${this.pathBase}/ModelCache`,async()=>new Z(e,this.pathBase,t.dataFetcher)),r=new A.GXRenderHelperGfx(e);t.destroyablePool.push(r);const n=this.galaxyName,s=`StageData/${n}/${n}Scenario.arc`;this.requestGlobalArchives(a),a.requestArchiveData(s),a.requestArchiveData("ParticleData/Effect.arc"),a.requestArchiveData("UsEnglish/MessageData/Message.arc"),a.requestObjectData("PlanetMapDataTable"),a.requestObjectData("NPCData");const i=new Y;i.sceneDesc=this,i.modelCache=a,t.destroyablePool.push(i),await a.waitForLoad();const o=new z(a.getArchive(s));for(let e=0;e<o.zoneNames.length;e++){const t=o.zoneNames[e];this.requestZoneArchives(a,t)}i.scenarioData=o,await a.waitForLoad(),i.planetMapCreator=new y.PlanetMapCreator(a.getObjectData("PlanetMapDataTable")),i.npcDirector=new T.NPCDirector(a.getObjectData("NPCData"));const l=new v.LightDataHolder(this.getLightData(a));i.lightDirector=new v.LightDirector(i,l),i.stageDataHolder=new ee(this,a,i.scenarioData,i.scenarioData.getMasterZoneFilename(),0),a.isArchiveExist("ParticleData/Effect.arc")&&(i.effectSystem=new x.EffectSystem(e,a.getArchive("ParticleData/Effect.arc"))),a.isArchiveExist("UsEnglish/MessageData/Message.arc")&&(i.messageDataHolder=new ae(a.getArchive("UsEnglish/MessageData/Message.arc")));const c=new J(i);i.spawner=c,c.requestArchives(),await a.waitForLoad(),this.placeExtra(i),c.place(),B.initSyncSleepController(i);const h=new O(e,r,c,i);return this.patchRenderer(h),h}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(40),n=a(163),s=a(109),i=a(142),o=a(1),l=a(52),c=a(16),h=a(28),d=a(2),u=a(25),m=a(0),p=a(164),f=a(143),A=a(43),g=a(144),_=a(110),S=a(79);function b(e,t){e.gfxTexture=t,e.width=c.EFB_WIDTH,e.height=c.EFB_HEIGHT,e.flipY=!0}t.setTextureMappingIndirect=b;class v{constructor(e,t){this.Name=m.assertExists(e.getValueString(`${t}Name`)),this.StartFrame=m.fallback(e.getValueNumber(`${t}StartFrame`),-1),this.IsKeepAnim=h.getJMapInfoBool(m.fallback(e.getValueNumber(`${t}IsKeepAnim`),-1))}}function w(e,t){return t.Name?t.Name:e.ActorAnimName}class x{constructor(e){this.ActorAnimName=m.assertExists(e.getValueString("ActorAnimName")).toLowerCase(),this.Bck=new v(e,"Bck"),this.Btk=new v(e,"Btk"),this.Brk=new v(e,"Brk"),this.Bpk=new v(e,"Bpk"),this.Btp=new v(e,"Btp"),this.Bva=new v(e,"Bva")}}class T{constructor(e){this.keeperInfo=[];for(let t=0;t<e.getNumRecords();t++)e.setRecord(t),this.keeperInfo.push(new x(e))}static tryCreate(e){let t=e.resourceHolder.arc.findFileData("ActorAnimCtrl.bcsv");if(null===t&&(t=e.resourceHolder.arc.findFileData("ActorInfo/ActorAnimCtrl.bcsv")),null===t)return null;const a=h.createCsvParser(t);return new T(a)}findAnimInfo(e){e=e.toLowerCase();const t=this.keeperInfo.find(t=>t.ActorAnimName===e);return void 0===t?null:t}start(e,t){const a=this.findAnimInfo(t);if(null===a)return!1;const r=w(a,a.Bck);!A.isBckExist(e,r)||a.Bck.IsKeepAnim&&A.isBckPlaying(e,r)||A.startBck(e,r);const n=w(a,a.Btk);!A.isBtkExist(e,n)||a.Btk.IsKeepAnim&&A.isBtkPlaying(e,n)||A.startBtk(e,n);const s=w(a,a.Brk);!A.isBrkExist(e,s)||a.Brk.IsKeepAnim&&A.isBrkPlaying(e,s)||A.startBrk(e,s);const i=w(a,a.Bpk);!A.isBpkExist(e,i)||a.Bpk.IsKeepAnim&&A.isBpkPlaying(e,i)||A.startBpk(e,i);const o=w(a,a.Btp);!A.isBtpExist(e,o)||a.Btp.IsKeepAnim&&A.isBtpPlaying(e,o)||A.startBtp(e,o);const l=w(a,a.Bva);return!A.isBvaExist(e,l)||a.Bva.IsKeepAnim&&A.isBvaPlaying(e,l)||A.startBva(e,l),!0}isPlaying(e,t){const a=this.findAnimInfo(t);if(null!==a){const t=w(a,a.Bck);return A.isBckPlaying(e,t)}return A.isBckPlaying(e,t)}}class y{constructor(e,t){this.xanimePlayer=null,this.btkPlayer=null,this.brkPlayer=null,this.btpPlayer=null,this.bpkPlayer=null,this.bvaPlayer=null,this.bckCtrl=null,this.resourceHolder=e.modelCache.getResourceHolder(t);const a=this.resourceHolder.getModel(t);this.modelInstance=new u.J3DModelInstance(a),this.modelInstance.name=t,this.resourceHolder.motionTable.size>0&&(this.xanimePlayer=new f.XanimePlayer(this.resourceHolder.motionTable,this.modelInstance)),this.resourceHolder.btkTable.size>0&&(this.btkPlayer=new f.BtkPlayer(this.resourceHolder.btkTable,this.modelInstance)),this.resourceHolder.brkTable.size>0&&(this.brkPlayer=new f.BrkPlayer(this.resourceHolder.brkTable,this.modelInstance)),this.resourceHolder.btpTable.size>0&&(this.btpPlayer=new f.BtpPlayer(this.resourceHolder.btpTable,this.modelInstance)),this.resourceHolder.bpkTable.size>0&&(this.bpkPlayer=new f.BrkPlayer(this.resourceHolder.bpkTable,this.modelInstance)),this.resourceHolder.bvaTable.size>0&&(this.bvaPlayer=new f.BvaPlayer(this.resourceHolder.bvaTable,this.modelInstance)),this.resourceHolder.motionTable.size>0&&(this.bckCtrl=this.resourceHolder.getRes(this.resourceHolder.banmtTable,t),null===this.bckCtrl&&(this.bckCtrl=new f.BckCtrl))}calcAnim(e){null!==this.xanimePlayer&&this.xanimePlayer.calcAnm(),null!==this.bvaPlayer&&this.bvaPlayer.calc(),this.modelInstance.calcAnim(e.camera)}update(e){null!==this.xanimePlayer&&this.xanimePlayer.update(e),null!==this.btkPlayer&&this.btkPlayer.update(e),null!==this.brkPlayer&&this.brkPlayer.update(e),null!==this.btpPlayer&&this.btpPlayer.update(e),null!==this.bpkPlayer&&this.bpkPlayer.update(e),null!==this.bvaPlayer&&this.bvaPlayer.update(e)}getBckCtrl(){return this.xanimePlayer.frameCtrl}startBck(e){this.xanimePlayer.changeAnimationBck(e),this.xanimePlayer.changeInterpoleFrame(0),this.bckCtrl.changeBckSetting(e,this.xanimePlayer)}startBckWithInterpole(e,t){this.xanimePlayer.changeAnimationBck(e),this.xanimePlayer.changeInterpoleFrame(0),this.xanimePlayer.changeInterpoleFrame(t)}isBckStopped(){return!!(1&this.xanimePlayer.frameCtrl.updateFlags)}getBtkCtrl(){return this.btkPlayer.frameCtrl}startBtk(e){this.btkPlayer.start(e)}isBtkPlaying(e){return this.btkPlayer.isPlaying(e)}isBtkStopped(){return this.btkPlayer.isStop()}getBrkCtrl(){return this.brkPlayer.frameCtrl}startBrk(e){this.brkPlayer.start(e)}isBrkPlaying(e){return this.brkPlayer.isPlaying(e)}isBrkStopped(){return this.brkPlayer.isStop()}getBtpCtrl(){return this.btpPlayer.frameCtrl}startBtp(e){this.btpPlayer.start(e)}isBtpPlaying(e){return this.btpPlayer.isPlaying(e)}isBtpStopped(){return this.btpPlayer.isStop()}getBpkCtrl(){return this.bpkPlayer.frameCtrl}startBpk(e){this.bpkPlayer.start(e)}isBpkPlaying(e){return this.bpkPlayer.isPlaying(e)}isBpkStopped(){return this.bpkPlayer.isStop()}getBvaCtrl(){return this.bvaPlayer.frameCtrl}startBva(e){this.bvaPlayer.start(e)}isBvaPlaying(e){return this.bvaPlayer.isPlaying(e)}isBvaStopped(){return this.bvaPlayer.isStop()}}t.ModelManager=y,t.getJMapInfoTrans=function(e,t,a){h.getJMapInfoTransLocal(e,a);const r=m.assertExists(t.stageDataHolder.findPlacedStageDataHolder(a));o.vec3.transformMat4(e,e,r.placementMtx)};const C=o.mat4.create();function M(e,t){d.computeModelMatrixSRT(e,1,1,1,t.rotation[0],t.rotation[1],t.rotation[2],t.translation[0],t.translation[1],t.translation[2])}function U(e,t){null!==t.hitSensorKeeper&&t.hitSensorKeeper.clear(),t.calcGravityFlag&&A.calcGravity(e,t),null!==t.collisionParts&&A.resetAllCollisionMtx(t)}t.getJMapInfoRotate=function(e,t,a,r=C){h.getJMapInfoRotateLocal(e,a),d.computeModelMatrixSRT(r,1,1,1,e[0],e[1],e[2],0,0,0);const n=m.assertExists(t.stageDataHolder.findPlacedStageDataHolder(a));o.mat4.mul(r,n.placementMtx,r),d.computeEulerAngleRotationFromSRTMatrix(e,r)},t.makeMtxTRFromActor=M,t.makeMtxTRSFromActor=function(e,t){d.computeModelMatrixSRT(e,t.scale[0],t.scale[1],t.scale[2],t.rotation[0],t.rotation[1],t.rotation[2],t.translation[0],t.translation[1],t.translation[2])},t.resetPosition=U,t.dynamicSpawnZoneAndLayer={zoneId:-1,layerId:-1};const k=o.vec3.create();class D extends r.NameObj{constructor(e,t,a){super(t,a),this.zoneAndLayer=e,this.name=a,this.visibleScenario=!0,this.visibleAlive=!0,this.visibleModel=!0,this.calcGravityFlag=!1,this.calcBinderFlag=!1,this.boundingSphereRadius=null,this.actorAnimKeeper=null,this.actorLightCtrl=null,this.effectKeeper=null,this.spine=null,this.railRider=null,this.modelManager=null,this.hitSensorKeeper=null,this.collisionParts=null,this.binder=null,this.stageSwitchCtrl=null,this.translation=o.vec3.create(),this.rotation=o.vec3.create(),this.scale=o.vec3.fromValues(1,1,1),this.velocity=o.vec3.create(),this.gravityVector=o.vec3.fromValues(0,-1,0)}get resourceHolder(){return this.modelManager.resourceHolder}get modelInstance(){return null!==this.modelManager?this.modelManager.modelInstance:null}attackSensor(e,t,a){}getSensor(e){return null!==this.hitSensorKeeper?this.hitSensorKeeper.getSensor(e):null}receiveMessage(e,t,a,r){return!1}makeActorAppeared(e){null!==this.hitSensorKeeper&&this.hitSensorKeeper.validateBySystem(),this.visibleAlive=!0,null!==this.collisionParts&&A.validateCollisionPartsForActor(e,this),U(e,this),null!==this.actorLightCtrl&&this.actorLightCtrl.reset(e),null!==this.hitSensorKeeper&&this.hitSensorKeeper.update()}makeActorDead(e){o.vec3.set(this.velocity,0,0,0),null!==this.hitSensorKeeper&&(this.hitSensorKeeper.clear(),this.hitSensorKeeper.invalidateBySystem()),null!==this.binder&&this.binder.clear(),null!==this.effectKeeper&&this.effectKeeper.clear(),null!==this.collisionParts&&_.invalidateCollisionParts(e,this.collisionParts),this.visibleAlive=!1}scenarioChanged(e){this.visibleScenario=e.spawner.checkAliveScenario(this.zoneAndLayer)}setIndirectTextureOverride(e){!function(e,t){const a=e.getTextureMappingReference("IndDummy");null!==a&&b(a,t)}(this.modelInstance,e)}getBaseMtx(){return null===this.modelInstance?null:this.modelInstance.modelMatrix}getJointMtx(e){return null===this.modelInstance?null:this.modelInstance.getJointToWorldMatrixReference(e)}static requestArchives(e,t){const a=e.modelCache,r=l.getObjectName(t);a.requestObjectData(r)}initModelManagerWithAnm(e,t){this.modelManager=new y(e,t),o.vec3.copy(this.modelManager.modelInstance.baseScale,this.scale),this.calcAndSetBaseMtxBase(),this.modelManager.modelInstance.calcJointToWorld(),this.actorAnimKeeper=T.tryCreate(this)}initActorCollisionParts(e,t,a,r,n,s){if(null!==r)throw"whoops";this.collisionParts=_.createCollisionPartsFromLiveActor(e,this,t,a,n,s),A.invalidateCollisionPartsForActor(e,this)}initLightCtrl(e){this.actorLightCtrl=new i.ActorLightCtrl(this),this.actorLightCtrl.init(e)}initEffectKeeper(e,t){null!==e.effectSystem&&(null===t&&null!==this.modelInstance&&(t=this.modelInstance.name),this.effectKeeper=new n.EffectKeeper(e,this,m.assertExists(t)))}initRailRider(e,t){this.railRider=new p.RailRider(e,this,t)}initHitSensor(){this.hitSensorKeeper=new g.HitSensorKeeper}initStageSwitch(e,t){this.stageSwitchCtrl=S.createStageSwitchCtrl(e,t)}initNerve(e){this.spine=new s.Spine,this.spine.setNerve(e)}setNerve(e){this.spine.setNerve(e)}getCurrentNerve(){return this.spine.getCurrentNerve()}getNerveStep(){return this.spine.getNerveStep()}calcAndSetBaseMtxBase(){M(this.modelInstance.modelMatrix,this)}calcAndSetBaseMtx(e,t){this.calcAndSetBaseMtxBase()}getActorVisible(e){return!(!this.visibleScenario||!this.visibleAlive)&&(null===this.boundingSphereRadius||e.frustum.containsSphere(this.translation,this.boundingSphereRadius))}calcAnim(e,t){null!==this.modelManager&&(o.vec3.copy(this.modelManager.modelInstance.baseScale,this.scale),this.calcAndSetBaseMtx(e,t),this.modelManager.calcAnim(t))}calcViewAndEntry(e,t){if(null===this.modelInstance)return;this.modelInstance.calcView(t.camera);const a=this.visibleModel&&this.getActorVisible(t.camera);if(this.modelInstance.visible=a,a)if(null!==this.actorLightCtrl)this.actorLightCtrl.loadLight(this.modelInstance,t.camera);else{const a=e.sceneNameObjListExecutor.findLightType(this);if(-1!==a){e.lightDirector.findDefaultAreaLight(e).getActorLightInfo(a).setOnModelInstance(this.modelInstance,t.camera,!1)}}}updateSpine(e,t,a){}control(e,t){}updateBinder(e,t){null!==this.binder?this.calcBinderFlag?(this.binder.bind(k,this.velocity),o.vec3.scaleAndAdd(this.translation,this.translation,k,t)):(o.vec3.scaleAndAdd(this.translation,this.translation,this.velocity,t),this.binder.clear()):o.vec3.scaleAndAdd(this.translation,this.translation,this.velocity,t)}movement(e,t){if(this.calcGravityFlag&&A.calcGravity(e,this),null!==this.hitSensorKeeper&&this.hitSensorKeeper.doObjCol(e),!this.visibleAlive)return;const a=l.getDeltaTimeFrames(t);null!==this.modelManager&&this.modelManager.update(a),null!==this.spine&&(this.spine.changeNerve(),this.updateSpine(e,this.getCurrentNerve(),a),this.spine.updateTick(a),this.spine.changeNerve()),this.visibleAlive&&(this.control(e,t),this.visibleAlive&&(this.updateBinder(e,a),null!==this.effectKeeper&&(this.effectKeeper.updateSyncBckEffect(e.effectSystem,a),this.effectKeeper.setVisibleScenario(this.visibleAlive&&this.visibleScenario)),null!==this.actorLightCtrl&&this.actorLightCtrl.update(e,t.camera,!1,a),null!==this.hitSensorKeeper&&this.hitSensorKeeper.update()))}}function I(e){return!e.visibleAlive}t.LiveActor=D,t.isDead=I;class R extends r.NameObjGroup{appearAll(e){for(let t=0;t<this.objArray.length;t++)I(this.objArray[t])&&this.objArray[t].makeActorAppeared(e)}killAll(e){for(let t=0;t<this.objArray.length;t++)this.objArray[t].makeActorDead(e)}getLivingActorNum(){let e=0;for(let t=0;t<this.objArray.length;t++)I(this.objArray[t])||++e;return e}getActor(e){return this.objArray[e]}getDeadActor(){for(let e=0;e<this.objArray.length;e++)if(I(this.objArray[e]))return this.objArray[e];return null}registerActor(e){this.registerObj(e)}}t.LiveActorGroup=R},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(2);var n,s;function i(e){return e<<4|e}function o(e){return e<<3|e>>>2}function l(e,t,a,n,s){const l=[[-8,-2,2,8],[-17,-5,5,17],[-29,-9,9,29],[-42,-13,13,42],[-60,-18,18,60],[-80,-24,24,80],[-106,-33,33,106],[-183,-47,48,183]],c=[2,3,1,0],h=0!=(2&t),d=0!=(1&t),u=l[t>>5&7],m=l[t>>2&7];function p(e){return e<<29>>29}function f(e,t,a,n,s){for(let i=0;i<4;i++)e[3*i+0]=r.clamp(t+s[i],0,255),e[3*i+1]=r.clamp(a+s[i],0,255),e[3*i+2]=r.clamp(n+s[i],0,255)}const A=new Uint8Array(12),g=new Uint8Array(12);if(h){const e=t>>>27&31,a=p(t>>>24&7),r=t>>>19&31,n=p(t>>>16&7),s=t>>>11&31,i=p(t>>>8&7),l=o(e),c=o(e+a),h=o(r),d=o(r+n),_=o(s),S=o(s+i);f(A,l,h,_,u),f(g,c,d,S,m)}else{const e=i(t>>>28&15),a=i(t>>>24&15),r=i(t>>>20&15),n=i(t>>>16&15),s=i(t>>>12&15),o=i(t>>>8&15);f(A,e,r,s,u),f(g,a,n,o,m)}for(let t=0;t<16;t++){const r=c[(a>>>16+t&1)<<1|a>>>t&1],i=3&t,o=t>>>2,l=n+4*(i*s+o);let h;h=d?2&i:2&o;const u=h?g:A;e[l+0]=u[3*r+0],e[l+1]=u[3*r+1],e[l+2]=u[3*r+2]}}function c(e,t,a,r,n){for(let t=0;t<2;t++)for(let s=0;s<4;s++){e[r+4*(s*n+t)+3]=i(15&a),a>>=4}for(let a=2;a<4;a++)for(let s=0;s<4;s++){e[r+4*(s*n+a)+3]=i(15&t),t>>=4}}function h(e,t,a,r){const n=new Uint8Array(e*t*4),s=e,i=a.createDataView();let o=0;for(let a=0;a<t;a+=8)for(let t=0;t<e;t+=8)for(let e=0;e<8;e+=4)for(let h=0;h<8;h+=4){const d=4*((a+e)*s+(t+h));let u,m;r?(m=i.getUint32(o+0,!0),u=i.getUint32(o+4,!0),o+=8):(m=4294967295,u=4294967295),c(n,u,m,d,s);const p=i.getUint32(o+0,!0);l(n,i.getUint32(o+4,!0),p,d,s),o+=8}return n}function d(e,t,a){const r=new Uint8Array(e*t*4),n=e;function s(e){return e>>>2&4|e>>>1&2|1&e}for(let i=0;i<t;i+=8)for(let t=0;t<e;t+=8)for(let e=0;e<64;e++){const o=s(e);a(r,4*((i+s(e>>>1))*n+t+o))}return r}!function(e){e[e.RGB8=0]="RGB8",e[e.RGBA8=1]="RGBA8",e[e.RGBA5551=2]="RGBA5551",e[e.RGB565=3]="RGB565",e[e.RGBA4444=4]="RGBA4444",e[e.LA8=5]="LA8",e[e.HILO8=6]="HILO8",e[e.L8=7]="L8",e[e.A8=8]="A8",e[e.LA4=9]="LA4",e[e.L4=10]="L4",e[e.A4=11]="A4",e[e.ETC1=12]="ETC1",e[e.ETC1A4=13]="ETC1A4"}(n=t.TextureFormat||(t.TextureFormat={})),t.computeTextureByteSize=function(e,t,a){switch(e){case n.ETC1:return t*a/2;case n.ETC1A4:return t*a;case n.RGBA4444:case n.RGBA5551:case n.RGB565:case n.LA8:return t*a*2;case n.A8:case n.L8:return t*a;case n.L4:return t*a/2;default:throw"whoops"}},t.decodeTexture=function(e,t,a,r){switch(e){case n.ETC1:return h(t,a,r,!1);case n.ETC1A4:return h(t,a,r,!0);case n.RGBA4444:return function(e,t,a){const r=a.createDataView();let n=0;return d(e,t,(e,t)=>{const a=r.getUint16(n,!0);e[t+0]=i(a>>>12&15),e[t+1]=i(a>>>8&15),e[t+2]=i(a>>>4&15),e[t+3]=i(a>>>0&15),n+=2})}(t,a,r);case n.RGBA5551:return function(e,t,a){const r=a.createDataView();let n=0;return d(e,t,(e,t)=>{const a=r.getUint16(n,!0);e[t+0]=o(a>>>11&31),e[t+1]=o(a>>>6&31),e[t+2]=o(a>>>1&31),e[t+3]=1&a?255:0,n+=2})}(t,a,r);case n.RGB565:return function(e,t,a){const r=a.createDataView();let n=0;return d(e,t,(e,t)=>{const a=r.getUint16(n,!0);var s;e[t+1]=(s=a>>>5&63)<<2|s>>>4,e[t+0]=o(a>>>11&31),e[t+2]=o(31&a),e[t+3]=255,n+=2})}(t,a,r);case n.A8:return function(e,t,a){const r=a.createDataView();let n=0;return d(e,t,(e,t)=>{const a=r.getUint8(n++);e[t+0]=255,e[t+1]=255,e[t+2]=255,e[t+3]=a})}(t,a,r);case n.L4:return function(e,t,a){const r=a.createDataView();let n=0;return d(e,t,(e,t)=>{const a=r.getUint8(n>>>1),s=i(1&n?a>>>4:15&a);e[t+0]=s,e[t+1]=s,e[t+2]=s,e[t+3]=s,n++})}(t,a,r);case n.L8:return function(e,t,a){const r=a.createDataView();let n=0;return d(e,t,(e,t)=>{const a=r.getUint8(n++);e[t+0]=a,e[t+1]=a,e[t+2]=a,e[t+3]=a})}(t,a,r);case n.LA8:return function(e,t,a){const r=a.createDataView();let n=0;return d(e,t,(e,t)=>{const a=r.getUint8(n++),s=r.getUint8(n++);e[t+0]=s,e[t+1]=s,e[t+2]=s,e[t+3]=a})}(t,a,r);default:throw new Error(`Unsupported texture type! ${e.toString(16)}`)}},t.getTextureFormatName=function(e){switch(e){case n.RGB8:return"RGB8";case n.RGBA8:return"RGBA8";case n.RGBA5551:return"RGBA5551";case n.RGB565:return"RGB565";case n.RGBA4444:return"RGBA4444";case n.LA8:return"LA8";case n.HILO8:return"HILO8";case n.L8:return"L8";case n.A8:return"A8";case n.LA4:return"LA4";case n.L4:return"L4";case n.A4:return"A4";case n.ETC1:return"ETC1";case n.ETC1A4:return"ETC1A4"}},function(e){e[e.ETC1=26458]="ETC1",e[e.ETC1A4=26459]="ETC1A4",e[e.RGBA4444=2150852434]="RGBA4444",e[e.RGBA5551=2150917970]="RGBA5551",e[e.RGB565=2204329812]="RGB565",e[e.A8=335636310]="A8",e[e.L8=335636311]="L8",e[e.L4=1734436695]="L4",e[e.LA8=335636312]="LA8"}(s=t.TextureFormatGL||(t.TextureFormatGL={})),t.getTextureFormatFromGLFormat=function(e){switch(e){case s.ETC1:return n.ETC1;case s.ETC1A4:return n.ETC1A4;case s.RGBA4444:case s.RGBA4444:return n.RGBA4444;case s.RGBA5551:return n.RGBA5551;case s.RGB565:return n.RGB565;case s.A8:return n.A8;case s.L8:return n.L8;case s.L4:return n.L4;case s.LA8:return n.LA8}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=r(a(44)),i=a(1),o=a(2);function l(e){return e/4096}function c(e){return e/4096}function h(e,t,a){const r=e.createDataView();n.assert(0==r.getUint8(t+0));const s=r.getUint8(t+1),i=(r.getUint16(t+2,!0),t+r.getUint16(t+6,!0)),o=r.getUint16(i+0,!0),l=[];let c=i+4,h=i+r.getUint16(i+2,!0);for(let t=0;t<s;t++){const t=n.readString(e,h+0,16,!0),s=a(r,c);l.push({name:t,value:s}),c+=o,h+=16}return l}function d(e,t){return h(e,t,(e,t)=>e.getUint32(t+0,!0))}function u(e,t){const a=e.createDataView(),r=a.getUint16(0,!0),n=l(a.getInt16(2,!0));let s=4;const o=i.mat4.create();if(1&r||(o[12]=c(a.getInt32(s+0,!0)),o[13]=c(a.getInt32(s+4,!0)),o[14]=c(a.getInt32(s+8,!0)),s+=12),!(2&r))if(8&r){const e=r>>>4&15,t=256&r?-1:1,n=l(a.getInt16(s+0,!0)),i=l(a.getInt16(s+2,!0)),c=512&r?-i:i,h=1024&r?-n:n;0===e?(o[0]=t,o[1]=0,o[2]=0,o[4]=0,o[5]=n,o[6]=i,o[9]=0,o[10]=c,o[11]=h):2===e?(o[0]=0,o[1]=n,o[2]=i,o[4]=0,o[5]=c,o[6]=h,o[9]=t,o[10]=0,o[11]=0):4===e?(o[0]=n,o[1]=0,o[2]=i,o[4]=0,o[5]=t,o[6]=0,o[8]=c,o[9]=0,o[10]=h):8===e?(o[0]=n,o[1]=i,o[2]=0,o[4]=c,o[5]=h,o[6]=0,o[8]=0,o[9]=0,o[10]=t):console.warn(`Unsupported joint pivot ${e}`),s+=4}else o[0]=n,o[1]=l(a.getInt16(s+0,!0)),o[2]=l(a.getInt16(s+2,!0)),o[4]=l(a.getInt16(s+4,!0)),o[5]=l(a.getInt16(s+6,!0)),o[6]=l(a.getInt16(s+8,!0)),o[8]=l(a.getInt16(s+10,!0)),o[9]=l(a.getInt16(s+12,!0)),o[10]=l(a.getInt16(s+14,!0)),s+=16;return 4&r||(s+=6),{name:t,jointMatrix:o}}function m(e,t,a,r,n,s,i,o,l){e[0]=t*r*i,e[1]=a*n*-s*(t/a),e[2]=t*r*s*(a/t),e[3]=a*n*i,e[4]=r*(-.5*i-(.5*s-.5)-o),e[5]=n*(-.5*i+(.5*s-.5)+l)+1}function p(e,t,a,r,n,s,i,o,l,c){switch(t){case 0:return m(e,a,r,n,s,i,o,l,c);case 2:return function(e,t,a,r,n,s,i,o,l){e[0]=t*r*i,e[1]=a*n*-s*(t/a),e[2]=t*r*s*(a/t),e[3]=a*n*i,e[4]=r*-i*(o+.5)+r*s*(l-.5)+.5,e[5]=n*s*(o+.5)+n*i*(l-.5)+.5}(e,a,r,n,s,i,o,l,c);default:throw"whoops"}}function f(e,t,a){const r=e.createDataView(),s=r.getUint16(0,!0);n.assert(0===s);r.getUint16(2,!0),r.getUint32(4,!0),r.getUint32(8,!0);const o=r.getUint32(12,!0),l=(r.getUint32(16,!0),r.getUint32(20,!0)),h=(r.getUint32(24,!0),r.getUint16(28,!0),r.getUint16(30,!0)),d=r.getUint16(32,!0),u=r.getUint16(34,!0),p=(c(r.getInt32(36,!0)),c(r.getInt32(40,!0)),1/d),f=1/u,A=i.mat2d.create();let g=1,_=1,S=1,b=0,v=0,w=0,x=44;2&h||(g=c(r.getInt32(x+0,!0)),_=c(r.getInt32(x+4,!0)),x+=8),4&h||(b=c(r.getUint32(x+0,!0)),S=c(r.getUint32(x+4,!0)),x+=8),8&h||(v=c(r.getUint32(x+0,!0)),w=c(r.getUint32(x+4,!0)),x+=8),m(A,p,f,g,_,b,S,v,w);var T;return{name:t,textureName:null,paletteName:null,cullMode:function(e){switch(e){case 0:return 3;case 1:return 1;case 2:return 2;case 3:return 0;default:throw new Error("Unknown renderWhichFaces")}}(o>>6&3),alpha:(T=o>>16&31)<<3|T>>>2,polyAttribs:o,texParams:l,texMatrix:A,texScaleS:p,texScaleT:f}}function A(e,t){const a=e.createDataView(),r=a.getUint16(0,!0);n.assert(0===r);a.getUint16(2,!0),a.getUint32(4,!0);const s=a.getUint32(8,!0),i=a.getUint32(12,!0);return{name:t,dlBuffer:e.subarray(s,i)}}function g(e,t){const a=e.createDataView(),r=(a.getUint32(0,!0),a.getUint32(4,!0)),s=a.getUint32(8,!0),i=a.getUint32(12,!0),o=(a.getUint32(16,!0),a.getUint8(20),a.getUint8(21),a.getUint8(22)),l=a.getUint8(23),m=a.getUint8(24),p=a.getUint8(25),g=(a.getUint8(26),c(a.getInt32(28,!0))),_=(c(a.getInt32(32,!0)),a.getUint16(36,!0),a.getUint16(38,!0),a.getUint16(40,!0),a.getUint16(42,!0),a.getInt16(44,!0)),S=a.getInt16(46,!0),b=a.getInt16(48,!0),v=(a.getInt16(50,!0),a.getInt16(52,!0),a.getInt16(54,!0),c(a.getInt32(56,!0)),c(a.getInt32(60,!0)),d(e,64));n.assert(v.length===l);const w=[];for(let t=0;t<v.length;t++)w.push(u(e.slice(64+v[t].value),v[t].name));function x(e,t){const a=e.getUint16(t+0,!0),r=e.getUint8(t+2);return{isBound:!!e.getUint8(t+3),numMaterials:r,indexOffs:a}}const T=h(e,s+a.getUint16(s+0,!0),x),y=h(e,s+a.getUint16(s+2,!0),x),C=d(e,s+4);n.assert(C.length===m);const M=[];for(let t=0;t<C.length;t++)M.push(f(e.slice(s+C[t].value),C[t].name));function U(e){const t=[];for(let r=0;r<e.numMaterials;r++)t.push(M[a.getUint8(s+e.indexOffs+r)]);return t}for(const{name:e,value:t}of T)for(const a of U(t))a.textureName=e;for(const{name:e,value:t}of y)for(const a of U(t))a.paletteName=e;const k=d(e,i+0);n.assert(k.length===p);const D=[];for(let t=0;t<k.length;t++)D.push(A(e.slice(i+k[t].value),k[t].name));const I=e.slice(r,s);return{name:t,nodes:w,materials:M,shapes:D,sbcBuffer:I,posScale:g,texMtxMode:o}}function _(e,t,a){const r=e.duration;if(0===a)return t>r&&(t=r),t;if(1===a){for(;t>r;)t-=r;return t}throw"whoops"}function S(e,t){const a=e.frames;if(1===a.length)return a[0].value;let r=0;for(;r<a.length&&!(t<a[r].frame);r++);if(0===r)return a[0].value;const n=r-1;r%=a.length;const s=a[n],i=a[r],l=(t-s.frame)/(i.frame-s.frame);return o.lerp(s.value,i.value,l)}function b(e,t){e[0]=65535&t,e[1]=t>>>16&65535}t.fx16=l,t.fx32=c,t.parseResDictGeneric=h,t.parseResDict=d,t.calcTexMtx=p,t.parseNSBMD=function(e){const t=e.createDataView();n.assert("BMD0"===n.readString(e,0,6));const a=t.getUint16(6,!0);n.assert(2===a),t.getUint32(8,!0),n.assert(16===t.getUint16(12,!0));const r=t.getUint16(14,!0);n.assert(1===r||2===r);const s=t.getUint32(16,!0);n.assert("MDL0"===n.readString(e,s+0,4)),t.getUint32(s+4,!0);const i=d(e,s+8),o=[];for(let t=0;t<i.length;t++)o.push(g(e.slice(s+i[t].value),i[t].name));let l=null;if(r>1){const a=t.getUint32(20,!0);l=M(e.slice(a))}return{models:o,tex0:l}},t.parseNSBTA=function(e){const t=e.createDataView();n.assert("BTA0"===n.readString(e,0,6));const a=t.getUint16(6,!0);n.assert(1===a),t.getUint32(8,!0),n.assert(16===t.getUint16(12,!0));const r=t.getUint16(14,!0);n.assert(1===r),n.assert(20===t.getUint32(16,!0)),n.assert("SRT0"===n.readString(e,20,4));const s=d(e,28);return n.assert(1===s.length),{srt0:function(e){const t=e.createDataView();n.assert("M\0AT"===n.readString(e,0,4,!1));const a=t.getUint16(4,!0);function r(e,r){const n=[];if(536870912&e)n.push({frame:0,value:c(r)});else{const s=2147483648&e?4:1073741824&e?2:1;if(268435456&e){let e=r;for(let r=0;r<a;r+=s){const a=l(t.getInt16(e,!0));n.push({frame:r,value:a}),e+=2}}else{let e=r;for(let r=0;r<a;r+=s){const a=c(t.getInt32(e,!0));n.push({frame:r,value:a}),e+=4}}}return{frames:n}}t.getUint8(6),t.getUint8(7);const s=h(e,8,(e,t)=>{const a=e.getUint32(t+0,!0),n=e.getUint32(t+4,!0),s=e.getUint32(t+8,!0),i=e.getUint32(t+12,!0),o=e.getUint32(t+16,!0),l=e.getUint32(t+20,!0),c=e.getUint32(t+24,!0),h=e.getUint32(t+28,!0),d=e.getUint32(t+32,!0),u=e.getUint32(t+36,!0);return{scaleS:r(a,n),scaleT:r(s,i),rot:r(o,l),transS:r(c,h),transT:r(d,u)}});let i=[];for(let e=0;e<s.length;e++){const t=s[e];i.push(Object.assign({name:t.name},t.value))}return{duration:a,entries:i}}(e.slice(20+s[0].value))}},t.getAnimFrame=_;const v=i.vec2.create(),w=i.vec2.create();const x=i.vec2.create();class T{constructor(e,t,a){this.animationController=e,this.srt0=t,this.texData=a}calcTexMtx(e,t,a,r,n=1){const s=this.texData,i=this.animationController.getTimeInFrames(),l=_(this.srt0,i,n),c=S(s.scaleS,l),h=S(s.scaleT,l);!function(e,t,a){const r=t.frames;if(1===r.length)return b(e,r[0].value);let n=0;for(;n<r.length&&!(a<r[n].frame);n++);if(0===n)return b(e,r[0].value);const s=n-1;n%=r.length;const i=r[s],l=r[n],c=(a-s)/(l.frame-i.frame);b(v,i.value),b(w,l.value),e[0]=o.lerp(v[0],w[0],c),e[1]=o.lerp(v[1],w[1],c)}(x,s.rot,l);const d=S(s.transS,l),u=S(s.transT,l);p(e,t,a,r,c,h,x[0],x[1],d,u)}}function y(e,t){const a=e.createDataView();n.assert("M\0PT"===n.readString(e,0,4,!1));const r=a.getUint16(4,!0),s=a.getUint8(6),i=a.getUint8(7);let o=a.getUint16(8,!0),c=a.getUint16(10,!0);const d=[];for(let t=0;t<s;t++)d.push(n.readString(e,o,16,!0)),o+=16;const u=[];for(let t=0;t<i;t++)u.push(n.readString(e,c,16,!0)),c+=16;const m=h(e,12,(e,t)=>{const a=e.getUint16(t+0,!0);e.getUint16(t+2,!0),l(e.getUint16(t+4,!0));let r=e.getUint16(t+6,!0);const n=[];for(let t=0;t<a;t++){const t=e.getUint16(r+0,!0),a=e.getUint8(r+2),s=e.getUint8(r+3),i=d[a],o=u[s],l=`${i}/${o}`;n.push({frame:t,texName:i,plttName:o,fullTextureName:l}),r+=4}return{animationTrack:n}});let p=[];for(let e=0;e<m.length;e++){const t=m[e];p.push(Object.assign({name:t.name},t.value))}return{name:t,duration:r,entries:p}}t.SRT0TexMtxAnimator=T,t.bindSRT0=function(e,t,a){const r=t.entries.find(e=>e.name===a);return void 0===r?null:new T(e,t,r)},t.parseNSBTP=function(e){const t=e.createDataView();n.assert("BTP0"===n.readString(e,0,6));const a=t.getUint16(6,!0);n.assert(1===a),t.getUint32(8,!0),n.assert(16===t.getUint16(12,!0));const r=t.getUint16(14,!0);n.assert(1===r),n.assert(20===t.getUint32(16,!0)),n.assert("PAT0"===n.readString(e,20,4));const s=d(e,28);n.assert(s.length>=1);const i=[];for(let t=0;t<s.length;t++){const a=y(e.slice(20+s[t].value),s[t].name);i.push(a)}return{pat0:i}};class C{constructor(e,t,a){this.animationController=e,this.pat0=t,this.matData=a}calcFullTextureName(e=1){const t=this.animationController.getTimeInFrames(),a=_(this.pat0,t,e);return function(e,t){if(1===e.length)return e[0];let a=e.length;for(;a-- >0&&!(t>=e[a].frame););return e[a]}(this.matData.animationTrack,a).fullTextureName}}function M(e){const t=e.createDataView();n.assert("TEX0"==n.readString(e,0,4));t.getUint32(4,!0),t.getUint16(12,!0);const a=t.getUint16(14,!0),r=t.getUint32(20,!0),i=(t.getUint16(28,!0),t.getUint32(36,!0)),o=t.getUint32(40,!0),l=h(e,a,(t,a)=>{const n=t.getUint32(a+0,!0),l=s.parseTexImageParam(n);let c,h=null;const d=(65535&n)<<3;if(l.format===s.Format.Tex_CMPR_4x4){const t=i+d,a=o+(d>>>1);c=e.slice(t),h=e.slice(a)}else{const t=r+d;c=e.slice(t)}return{texData:c,palIdxData:h,texImageParam:l}}),c=t.getUint16(52,!0),d=t.getUint32(56,!0),u=h(e,c,(t,a)=>{const r=d+(t.getUint16(a+0,!0)<<3);return{data:e.slice(r)}}),m=[];for(const e of l){const t=e.name,{format:a,width:r,height:n,color0:s}=e.value.texImageParam,{texData:i,palIdxData:o}=e.value;m.push({name:t,format:a,width:r,height:n,color0:s,texData:i,palIdxData:o})}const p=[];for(const e of u){const t=e.name,a=e.value.data;p.push({name:t,data:a})}return{textures:m,palettes:p}}t.PAT0TexAnimator=C,t.bindPAT0=function(e,t,a){const r=t.entries.find(e=>e.name===a);return void 0===r?null:new C(e,t,r)},t.parseTex0Block=M,t.parseNSBTX=function(e){const t=e.createDataView();n.assert("BTX0"===n.readString(e,0,6));const a=t.getUint16(6,!0);n.assert(1===a),t.getUint32(8,!0),n.assert(16===t.getUint16(12,!0));const r=t.getUint16(14,!0);n.assert(1===r);const s=t.getUint32(16,!0);return{tex0:M(e.slice(s))}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=new Uint16Array([65279]),n=255==new DataView(r.buffer).getUint8(0)?0:1;t.getSystemEndianness=function(){return n}},function(e,t){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(48)),s=a(0),i=a(76),o=a(6),l=a(14);class c{constructor(){this.on=!1,this.tile=0,this.level=0,this.s=0,this.t=0}set(e,t,a,r,n){this.on=e,this.tile=t,this.level=a,this.s=r,this.t=n}copy(e){this.set(e.on,e.tile,e.level,e.s,e.t)}}t.TextureState=c;class h{constructor(){this.fmt=0,this.siz=0,this.w=0,this.addr=0}set(e,t,a,r){this.fmt=e,this.siz=t,this.w=a,this.addr=r}}t.TextureImageState=h;class d{constructor(){this.x=0,this.y=0,this.z=0,this.tx=0,this.ty=0,this.c0=0,this.c1=0,this.c2=0,this.a=0,this.matrixIndex=0}copy(e){this.x=e.x,this.y=e.y,this.z=e.z,this.matrixIndex=e.matrixIndex,this.tx=e.tx,this.ty=e.ty,this.c0=e.c0,this.c1=e.c1,this.c2=e.c2,this.a=e.a}}t.Vertex=d;class u extends d{constructor(){super(...arguments),this.outputIndex=-1}setFromView(e,t){this.outputIndex=-1,this.x=e.getInt16(t+0),this.y=e.getInt16(t+2),this.z=e.getInt16(t+4),this.tx=e.getInt16(t+8)/32+.5,this.ty=e.getInt16(t+10)/32+.5,this.c0=e.getUint8(t+12)/255,this.c1=e.getUint8(t+13)/255,this.c2=e.getUint8(t+14)/255,this.a=e.getUint8(t+15)/255}}t.StagingVertex=u,t.getImageFormatString=function(e,t){return`${i.getImageFormatName(e)}${i.getImageSizeName(t)}`};class m{constructor(){this.SP_GeometryMode=0,this.SP_TextureState=new c,this.DP_OtherModeL=0,this.DP_OtherModeH=0,this.textureIndices=[],this.firstIndex=0,this.indexCount=0}}t.DrawCall=m;t.RSPSharedOutput=class{constructor(){this.textureCache=new n.TextureCache,this.vertices=[],this.indices=[]}setVertexBufferFromData(e){const t=new u;for(let a=0;a<e.byteLength;a+=16)t.setFromView(e,a),this.loadVertex(t)}loadVertex(e){if(-1===e.outputIndex){const t=new d;t.copy(e),this.vertices.push(t),e.outputIndex=this.vertices.length-1}}};class p{constructor(){this.drawCalls=[],this.currentDrawCall=new m}newDrawCall(e){return this.currentDrawCall=new m,this.currentDrawCall.firstIndex=e,this.drawCalls.push(this.currentDrawCall),this.currentDrawCall}}function f(e){return e>>>20&3}function A(e,t){if(0===e)return t===o.GfxBlendFactor.SRC_ALPHA?o.GfxBlendFactor.ONE_MINUS_SRC_ALPHA:t===o.GfxBlendFactor.ONE?o.GfxBlendFactor.ZERO:o.GfxBlendFactor.ONE;if(1===e)return o.GfxBlendFactor.DST_ALPHA;if(2===e)return o.GfxBlendFactor.ONE;if(3===e)return o.GfxBlendFactor.ZERO;throw"Unknown Blend Param B: "+e}t.RSPOutput=p,t.getCycleTypeFromOtherModeH=f,t.getTextFiltFromOtherModeH=function(e){return e>>>12&3},t.translateBlendMode=function(e,t){const a={},r=t>>>28&3,n=t>>>24&3,i=t>>>16&3;if(!!(16384&t)&&1===(t>>>20&3)){let e;s.assert(0===r),e=3===n?o.GfxBlendFactor.ZERO:8192&t&&!(4096&t)?o.GfxBlendFactor.ONE:o.GfxBlendFactor.SRC_ALPHA,l.setAttachmentStateSimple(a,{blendSrcFactor:e,blendDstFactor:A(i,e),blendMode:o.GfxBlendMode.ADD})}else l.setAttachmentStateSimple(a,{blendSrcFactor:o.GfxBlendFactor.ONE,blendDstFactor:o.GfxBlendFactor.ZERO,blendMode:o.GfxBlendMode.ADD});if(a.cullMode=8192&e?4096&e?3:2:4096&e?1:0,16&t){const e=t>>>10&3;a.depthCompare=function(e){if(0===e)return o.GfxCompareMode.GREATER;if(1===e)return o.GfxCompareMode.GREATER;if(2===e)return o.GfxCompareMode.GREATER;if(3===e)return o.GfxCompareMode.GEQUAL;throw"Unknown Z mode: "+e}(e)}return 3===(t>>>10&3)&&(a.polygonOffset=!0),a.depthWrite=0!=(32&t),a};var g;t.RSPState=class{constructor(e,t){this.segmentBuffers=e,this.sharedOutput=t,this.output=new p,this.stateChanged=!1,this.vertexCache=s.nArray(64,()=>0),this.SP_GeometryMode=0,this.SP_TextureState=new c,this.SP_MatrixStackDepth=0,this.DP_OtherModeL=0,this.DP_OtherModeH=0,this.DP_CombineL=0,this.DP_CombineH=0,this.DP_TextureImageState=new h,this.DP_TileState=s.nArray(8,()=>new n.TileState),this.DP_TMemTracker=new Map}finish(){return 0===this.output.drawCalls.length?null:this.output}_setGeometryMode(e){this.SP_GeometryMode!==e&&(this.stateChanged=!0,this.SP_GeometryMode=e)}gSPSetGeometryMode(e){this._setGeometryMode(this.SP_GeometryMode|e)}gSPClearGeometryMode(e){this._setGeometryMode(this.SP_GeometryMode&~e)}gSPResetMatrixStackDepth(e){this.SP_MatrixStackDepth=e}gSPTexture(e,t,a,r,n){this.SP_TextureState.set(e,t,a,r/65536,n/65536),this.stateChanged=!0}gSPVertex(e,t,a){const r=(16777215&e)/16>>>0;for(let e=0;e<t;e++){const t=r+e;this.vertexCache[a+e]=t,this.sharedOutput.vertices[t].matrixIndex=this.SP_MatrixStackDepth}}_translateTileTexture(e){const t=this.DP_TileState[e],a=s.assertExists(this.DP_TMemTracker.get(t.tmem));let r;if(2===t.fmt){this.DP_OtherModeH;const e=256+(t.palette<<4);r=s.assertExists(this.DP_TMemTracker.get(e))}else r=0;return this.sharedOutput.textureCache.translateTileTexture(this.segmentBuffers,a,r,t)}_flushTextures(e){if(!this.SP_TextureState.on)return;if(!!(this.DP_OtherModeH>>>16&1))s.assert(!1);else{const t=f(this.DP_OtherModeH);s.assert(0===t||1===t),e.textureIndices.push(this._translateTileTexture(this.SP_TextureState.tile)),0==this.SP_TextureState.level&&n.combineParamsUsesT1(e.DP_Combine)&&e.textureIndices.push(this._translateTileTexture(this.SP_TextureState.tile+1))}}_flushDrawCall(){if(this.stateChanged){this.stateChanged=!1;const e=this.output.newDrawCall(this.sharedOutput.indices.length);e.SP_GeometryMode=this.SP_GeometryMode,e.SP_TextureState.copy(this.SP_TextureState),e.DP_Combine=n.decodeCombineParams(this.DP_CombineH,this.DP_CombineL),e.DP_OtherModeH=this.DP_OtherModeH,e.DP_OtherModeL=this.DP_OtherModeL,this._flushTextures(e)}}gSPTri(e,t,a){window.debug&&console.log("EXEC TRI"),this._flushDrawCall(),this.sharedOutput.indices.push(this.vertexCache[e],this.vertexCache[t],this.vertexCache[a]),this.output.currentDrawCall.indexCount+=3}gDPSetTextureImage(e,t,a,r){this.DP_TextureImageState.set(e,t,a,r)}gDPSetTile(e,t,a,r,n,s,i,o,l,c,h,d){this.DP_TileState[n].set(e,t,a,r,s,i,o,l,c,h,d)}gDPLoadTLUT(e,t){const a=this.DP_TileState[e].tmem;this.DP_TMemTracker.set(a,this.DP_TextureImageState.addr)}gDPLoadBlock(e,t,a,r,n){s.assert(0===t&&0===a),s.assert(7===e);const i=this.DP_TileState[e],o=r+1,l=2048/n,c=8*l*8/function(e){switch(e){case 0:return 4;case 1:return 8;case 2:return 16;case 3:return 32}}(i.siz);i.lrs=c-1<<2,i.lrt=o/l/4-1<<2,this.DP_TMemTracker.set(i.tmem,this.DP_TextureImageState.addr),this.stateChanged=!0}gDPSetTileSize(e,t,a,r,n){this.DP_TileState[e].setSize(t,a,r,n)}gDPSetOtherModeL(e,t,a){const r=(1<<t)-1<<e,n=this.DP_OtherModeL&~r|a&r;n!==this.DP_OtherModeL&&(this.DP_OtherModeL=n,this.stateChanged=!0)}gDPSetOtherModeH(e,t,a){const r=(1<<t)-1<<e,n=this.DP_OtherModeH&~r|a&r;n!==this.DP_OtherModeH&&(this.DP_OtherModeH=n,this.stateChanged=!0)}gDPSetCombine(e,t){this.DP_CombineH===e&&this.DP_CombineL===t||(this.DP_CombineH=e,this.DP_CombineL=t,this.stateChanged=!0)}},function(e){e[e.G_MTX=1]="G_MTX",e[e.G_MOVEMEM=3]="G_MOVEMEM",e[e.G_VTX=4]="G_VTX",e[e.G_DL=6]="G_DL",e[e.G_TRI1=191]="G_TRI1",e[e.G_CULLDL=190]="G_CULLDL",e[e.G_POPMTX=189]="G_POPMTX",e[e.G_MOVEWORD=188]="G_MOVEWORD",e[e.G_TEXTURE=187]="G_TEXTURE",e[e.G_SETOTHERMODE_H=186]="G_SETOTHERMODE_H",e[e.G_SETOTHERMODE_L=185]="G_SETOTHERMODE_L",e[e.G_ENDDL=184]="G_ENDDL",e[e.G_SETGEOMETRYMODE=183]="G_SETGEOMETRYMODE",e[e.G_CLEARGEOMETRYMODE=182]="G_CLEARGEOMETRYMODE",e[e.G_LINE3D=181]="G_LINE3D",e[e.G_RDPHALF_1=180]="G_RDPHALF_1",e[e.G_RDPHALF_2=179]="G_RDPHALF_2",e[e.G_MODIFYVTX=178]="G_MODIFYVTX",e[e.G_TRI2=177]="G_TRI2",e[e.G_BRANCH_Z=176]="G_BRANCH_Z",e[e.G_LOAD_UCODE=175]="G_LOAD_UCODE",e[e.G_SETCIMG=255]="G_SETCIMG",e[e.G_SETZIMG=254]="G_SETZIMG",e[e.G_SETTIMG=253]="G_SETTIMG",e[e.G_SETCOMBINE=252]="G_SETCOMBINE",e[e.G_SETENVCOLOR=251]="G_SETENVCOLOR",e[e.G_SETPRIMCOLOR=250]="G_SETPRIMCOLOR",e[e.G_SETBLENDCOLOR=249]="G_SETBLENDCOLOR",e[e.G_SETFOGCOLOR=248]="G_SETFOGCOLOR",e[e.G_SETFILLCOLOR=247]="G_SETFILLCOLOR",e[e.G_FILLRECT=246]="G_FILLRECT",e[e.G_SETTILE=245]="G_SETTILE",e[e.G_LOADTILE=244]="G_LOADTILE",e[e.G_LOADBLOCK=243]="G_LOADBLOCK",e[e.G_SETTILESIZE=242]="G_SETTILESIZE",e[e.G_LOADTLUT=240]="G_LOADTLUT",e[e.G_RDPSETOTHERMODE=239]="G_RDPSETOTHERMODE",e[e.G_SETPRIMDEPTH=238]="G_SETPRIMDEPTH",e[e.G_SETSCISSOR=237]="G_SETSCISSOR",e[e.G_SETCONVERT=236]="G_SETCONVERT",e[e.G_SETKEYR=235]="G_SETKEYR",e[e.G_SETKEYFB=234]="G_SETKEYFB",e[e.G_RDPFULLSYNC=233]="G_RDPFULLSYNC",e[e.G_RDPTILESYNC=232]="G_RDPTILESYNC",e[e.G_RDPPIPESYNC=231]="G_RDPPIPESYNC",e[e.G_RDPLOADSYNC=230]="G_RDPLOADSYNC",e[e.G_TEXRECTFLIP=229]="G_TEXRECTFLIP",e[e.G_TEXRECT=228]="G_TEXRECT"}(g=t.F3DEX_GBI||(t.F3DEX_GBI={})),t.runDL_F3DEX=function e(t,a){const r=t.segmentBuffers[a>>>24&255],n=r.createDataView();for(let i=16777215&a;i<r.byteLength;i+=8){const a=n.getUint32(i+0),r=n.getUint32(i+4),o=a>>>24;switch(window.debug&&console.log(s.hexzero(i,8),g[o],s.hexzero(a,8),s.hexzero(r,8)),o){case g.G_ENDDL:return;case g.G_CLEARGEOMETRYMODE:t.gSPClearGeometryMode(r);break;case g.G_SETGEOMETRYMODE:t.gSPSetGeometryMode(r);break;case g.G_TEXTURE:{const e=a>>>11&7;let n=a>>>8&7;const s=!!(a>>>0&127),i=r>>>16&65535,o=r>>>0&65535;t.gSPTexture(s,n,e,i,o)}break;case g.G_SETTIMG:{const e=a>>>21&7,n=a>>>19&3,s=1+(4095&a);t.gDPSetTextureImage(e,n,s,r)}break;case g.G_SETTILE:{const e=a>>>21&7,n=a>>>19&3,s=a>>>9&511,i=a>>>0&511,o=r>>>24&7,l=r>>>20&15,c=r>>>18&3,h=r>>>14&15,d=r>>>10&15,u=r>>>8&3,m=r>>>4&15,p=r>>>0&15;t.gDPSetTile(e,n,s,i,o,l,c,h,d,u,m,p)}break;case g.G_LOADTLUT:{const e=r>>>24&7,a=r>>>14&1023;t.gDPLoadTLUT(e,a)}break;case g.G_LOADBLOCK:{const e=a>>>12&4095,n=a>>>0&4095,s=r>>>24&7,i=r>>>12&4095,o=r>>>0&4095;t.gDPLoadBlock(s,e,n,i,o)}break;case g.G_VTX:{const e=(a>>>16&255)/2,n=a>>>10&63;t.gSPVertex(r,n,e)}break;case g.G_TRI1:{const e=(r>>>16&255)/2,a=(r>>>8&255)/2,n=(r>>>0&255)/2;t.gSPTri(e,a,n)}break;case g.G_TRI2:{const e=(a>>>16&255)/2,r=(a>>>8&255)/2,n=(a>>>0&255)/2;t.gSPTri(e,r,n)}{const e=(r>>>16&255)/2,a=(r>>>8&255)/2,n=(r>>>0&255)/2;t.gSPTri(e,a,n)}break;case g.G_DL:e(t,r);break;case g.G_SETOTHERMODE_H:{const e=a>>>0&255,n=a>>>8&255;t.gDPSetOtherModeH(n,e,r)}break;case g.G_SETOTHERMODE_L:{const e=a>>>0&255,n=a>>>8&255;t.gDPSetOtherModeL(n,e,r)}break;case g.G_SETCOMBINE:t.gDPSetCombine(16777215&a,r);break;case g.G_SETTILESIZE:{const e=a>>>12&4095,n=a>>>0&4095,s=r>>>24&7,i=r>>>12&4095,o=r>>>0&4095;t.gDPSetTileSize(s,e,n,i,o)}break;case g.G_POPMTX:break;case g.G_RDPFULLSYNC:case g.G_RDPTILESYNC:case g.G_RDPPIPESYNC:case g.G_RDPLOADSYNC:break;default:console.error(`Unknown DL opcode: ${o.toString(16)}`)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.XF_INVTXSPEC_ID=4104]="XF_INVTXSPEC_ID",e[e.XF_NUMCOLORS_ID=4105]="XF_NUMCOLORS_ID",e[e.XF_AMBIENT0_ID=4106]="XF_AMBIENT0_ID",e[e.XF_AMBIENT1_ID=4107]="XF_AMBIENT1_ID",e[e.XF_MATERIAL0_ID=4108]="XF_MATERIAL0_ID",e[e.XF_MATERIAL1_ID=4109]="XF_MATERIAL1_ID",e[e.XF_COLOR0CNTRL_ID=4110]="XF_COLOR0CNTRL_ID",e[e.XF_COLOR1CNTRL_ID=4111]="XF_COLOR1CNTRL_ID",e[e.XF_ALPHA0CNTRL_ID=4112]="XF_ALPHA0CNTRL_ID",e[e.XF_ALPHA1CNTRL_ID=4113]="XF_ALPHA1CNTRL_ID",e[e.XF_DUALTEXTRANS_ID=4114]="XF_DUALTEXTRANS_ID",e[e.XF_MATRIXINDEX0_ID=4120]="XF_MATRIXINDEX0_ID",e[e.XF_MATRIXINDEX1_ID=4121]="XF_MATRIXINDEX1_ID",e[e.XF_VPSCALEX_ID=4122]="XF_VPSCALEX_ID",e[e.XF_VPSCALEY_ID=4123]="XF_VPSCALEY_ID",e[e.XF_VPSCALEZ_ID=4124]="XF_VPSCALEZ_ID",e[e.XF_VPOFFSETX_ID=4125]="XF_VPOFFSETX_ID",e[e.XF_VPOFFSETY_ID=4126]="XF_VPOFFSETY_ID",e[e.XF_VPOFFSETZ_ID=4127]="XF_VPOFFSETZ_ID",e[e.XF_PROJECTIONA_ID=4128]="XF_PROJECTIONA_ID",e[e.XF_PROJECTIONB_ID=4129]="XF_PROJECTIONB_ID",e[e.XF_PROJECTIONC_ID=4130]="XF_PROJECTIONC_ID",e[e.XF_PROJECTIOND_ID=4131]="XF_PROJECTIOND_ID",e[e.XF_PROJECTIONE_ID=4132]="XF_PROJECTIONE_ID",e[e.XF_PROJECTIONF_ID=4133]="XF_PROJECTIONF_ID",e[e.XF_PROJECTORTHO_ID=4134]="XF_PROJECTORTHO_ID",e[e.XF_NUMTEX_ID=4159]="XF_NUMTEX_ID",e[e.XF_TEX0_ID=4160]="XF_TEX0_ID",e[e.XF_DUALTEX0_ID=4176]="XF_DUALTEX0_ID"}(t.XFRegister||(t.XFRegister={})),function(e){e[e.GEN_MODE_ID=0]="GEN_MODE_ID",e[e.IND_MTXA0_ID=6]="IND_MTXA0_ID",e[e.IND_MTXB0_ID=7]="IND_MTXB0_ID",e[e.IND_MTXC0_ID=8]="IND_MTXC0_ID",e[e.IND_CMD0_ID=16]="IND_CMD0_ID",e[e.RAS1_SS0_ID=37]="RAS1_SS0_ID",e[e.RAS1_IREF_ID=39]="RAS1_IREF_ID",e[e.RAS1_TREF_0_ID=40]="RAS1_TREF_0_ID",e[e.SU_SSIZE_I0_ID=48]="SU_SSIZE_I0_ID",e[e.SU_SSIZE_I1_ID=50]="SU_SSIZE_I1_ID",e[e.SU_SSIZE_I2_ID=52]="SU_SSIZE_I2_ID",e[e.SU_SSIZE_I3_ID=54]="SU_SSIZE_I3_ID",e[e.SU_SSIZE_I4_ID=56]="SU_SSIZE_I4_ID",e[e.SU_SSIZE_I5_ID=58]="SU_SSIZE_I5_ID",e[e.SU_SSIZE_I6_ID=60]="SU_SSIZE_I6_ID",e[e.SU_SSIZE_I7_ID=62]="SU_SSIZE_I7_ID",e[e.SU_TSIZE_I0_ID=49]="SU_TSIZE_I0_ID",e[e.SU_TSIZE_I1_ID=51]="SU_TSIZE_I1_ID",e[e.SU_TSIZE_I2_ID=53]="SU_TSIZE_I2_ID",e[e.SU_TSIZE_I3_ID=55]="SU_TSIZE_I3_ID",e[e.SU_TSIZE_I4_ID=57]="SU_TSIZE_I4_ID",e[e.SU_TSIZE_I5_ID=59]="SU_TSIZE_I5_ID",e[e.SU_TSIZE_I6_ID=61]="SU_TSIZE_I6_ID",e[e.SU_TSIZE_I7_ID=63]="SU_TSIZE_I7_ID",e[e.PE_ZMODE_ID=64]="PE_ZMODE_ID",e[e.PE_CMODE0_ID=65]="PE_CMODE0_ID",e[e.TX_LOADTLUT_I0_ID=100]="TX_LOADTLUT_I0_ID",e[e.TX_SETMODE0_I0_ID=128]="TX_SETMODE0_I0_ID",e[e.TX_SETMODE0_I4_ID=160]="TX_SETMODE0_I4_ID",e[e.TX_SETMODE1_I0_ID=132]="TX_SETMODE1_I0_ID",e[e.TX_SETMODE1_I4_ID=164]="TX_SETMODE1_I4_ID",e[e.TX_SETIMAGE0_I0_ID=136]="TX_SETIMAGE0_I0_ID",e[e.TX_SETIMAGE0_I4_ID=168]="TX_SETIMAGE0_I4_ID",e[e.TX_SETIMAGE1_I0_ID=140]="TX_SETIMAGE1_I0_ID",e[e.TX_SETIMAGE1_I4_ID=172]="TX_SETIMAGE1_I4_ID",e[e.TX_SETIMAGE2_I0_ID=144]="TX_SETIMAGE2_I0_ID",e[e.TX_SETIMAGE2_I4_ID=176]="TX_SETIMAGE2_I4_ID",e[e.TX_SETIMAGE3_I0_ID=148]="TX_SETIMAGE3_I0_ID",e[e.TX_SETIMAGE3_I4_ID=180]="TX_SETIMAGE3_I4_ID",e[e.TX_SETTLUT_I0_ID=152]="TX_SETTLUT_I0_ID",e[e.TX_SETTLUT_I4_ID=184]="TX_SETTLUT_I4_ID",e[e.TEV_COLOR_ENV_0_ID=192]="TEV_COLOR_ENV_0_ID",e[e.TEV_ALPHA_ENV_0_ID=193]="TEV_ALPHA_ENV_0_ID",e[e.TEV_REGISTERL_0_ID=224]="TEV_REGISTERL_0_ID",e[e.TEV_REGISTERH_0_ID=225]="TEV_REGISTERH_0_ID",e[e.TEV_FOG_PARAM_0_ID=238]="TEV_FOG_PARAM_0_ID",e[e.TEV_FOG_PARAM_1_ID=239]="TEV_FOG_PARAM_1_ID",e[e.TEV_FOG_PARAM_2_ID=240]="TEV_FOG_PARAM_2_ID",e[e.TEV_FOG_PARAM_3_ID=241]="TEV_FOG_PARAM_3_ID",e[e.TEV_FOG_COLOR_ID=242]="TEV_FOG_COLOR_ID",e[e.TEV_ALPHAFUNC_ID=243]="TEV_ALPHAFUNC_ID",e[e.TEV_KSEL_0_ID=246]="TEV_KSEL_0_ID",e[e.SS_MASK=254]="SS_MASK"}(t.BPRegister||(t.BPRegister={})),function(e){e[e.MATINDEX_A_ID=48]="MATINDEX_A_ID",e[e.MATINDEX_B_ID=64]="MATINDEX_B_ID",e[e.VCD_LO_ID=80]="VCD_LO_ID",e[e.VCD_HI_ID=96]="VCD_HI_ID",e[e.VAT_A_ID=112]="VAT_A_ID",e[e.VAT_B_ID=128]="VAT_B_ID",e[e.VAT_C_ID=144]="VAT_C_ID"}(t.CPRegister||(t.CPRegister={}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.default=class{constructor(e){this.numBits=e,r.assert(e>0);const t=this.numBits+31>>>5;this.words=new Uint32Array(t)}setWord(e,t){this.words[e]=t}setWords(e,t=0){for(let a=0;a<e.length;a++)this.words[t+a]=e[a]}setBit(e,t){const a=e>>>5,r=1<<31-(31&e);t?this.words[a]|=r:this.words[a]&=~r}getBit(e){const t=e>>>5,a=1<<31-(31&e);return!!(this.words[t]&a)}hasAnyBit(){for(let e=0;e<this.words.length;e++)if(0!==this.words[e])return!0;return!1}},t.bitMapSerialize=function(e,t,a){const r=a.numBits+7>>>3;for(let n=0;n<r;n++){const r=24-((3&n)<<3);e.setUint8(t++,a.words[n>>>2]>>>r&255)}return t},t.bitMapDeserialize=function(e,t,a){const r=a.numBits+7>>>3;for(let n=0;n<r;n++){const r=24-((3&n)<<3);a.words[n>>>2]|=e.getUint8(t++)<<r}return r}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(4),n=a(16),s=a(1),i=a(158),o=a(2),l=a(0),c=a(5),h=a(105),d=a(139),u=a(65);t.dScnKy_env_light_c=class{constructor(){this.curTime=0,this.timeAdv=.02,this.calendarDay=0,this.sunPos=s.vec3.create(),this.moonPos=s.vec3.create(),this.vrboxInvisible=!0,this.actCol=new i.stage_palet_info_class__DifAmb(r.White),this.bgCol=l.nArray(4,()=>new i.stage_palet_info_class__DifAmb(r.White)),this.vrSkyCol=r.colorNewCopy(r.White),this.vrUsoUmiCol=r.colorNewCopy(r.White),this.vrKumoCol=r.colorNewCopy(r.White),this.vrKumoCenterCol=r.colorNewCopy(r.White),this.vrKasumiMaeCol=r.colorNewCopy(r.White),this.fogCol=r.colorNewCopy(r.White),this.actAdd=new i.stage_palet_info_class__DifAmb(r.TransparentBlack),this.bgAdd=l.nArray(4,()=>new i.stage_palet_info_class__DifAmb(r.TransparentBlack)),this.vrSky0Add=r.colorNewCopy(r.TransparentBlack),this.vrKasumiAdd=r.colorNewCopy(r.TransparentBlack),this.fogAdd=r.colorNewCopy(r.TransparentBlack),this.allColRatio=1,this.actColRatio=1,this.bgColRatio=1,this.vrSoraColRatio=1,this.vrKumoColRatio=1,this.fogColRatio=1,this.fogStartZ=0,this.fogEndZ=0,this.fogGlobalStartZ=0,this.fogGlobalEndZ=0,this.fogGlobalRatio=0,this.blendPsel=1,this.blendPselGather=-1,this.baseLight=new m,this.plights=[],this.eflights=[],this.waveInfluences=[],this.lightStatus=l.nArray(2,()=>new n.Light),this.playerEflightIdx=-1,this.playerPlightIdx=-1,this.envrIdxCurr=0,this.envrIdxPrev=0,this.pselIdxPrev=0,this.pselIdxCurr=0,this.pselIdxPrevGather=-1,this.pselIdxCurrGather=-1,this.colSetMode=0,this.colSetModeGather=0,this.weatherPselIdx=0,this.windVec=s.vec3.fromValues(1,0,0),this.windPower=1,this.customWindPower=0,this.diceWeatherStop=!1,this.diceWeatherMode=p.Sunny,this.diceWeatherState=0,this.diceWeatherCurrPattern=0,this.diceWeatherCounter=0,this.diceWeatherTime=0,this.rainCount=0,this.rainCountOrig=0,this.thunderMode=0,this.thunderActive=!1,this.thunderState=0,this.thunderFlashTimer=0,this.thunderLightInfluence=new m,this.starAmount=0,this.starCount=0,this.waveCount=0,this.waveFlatInter=0,this.waveSpawnRadius=0,this.waveSpawnDist=0,this.waveScale=0,this.waveSpeed=0,this.waveScaleRand=0,this.waveCounterSpeedScale=0,this.waveScaleBottom=0,this.waveReset=!1,this.sunPacket=null,this.vrkumoPacket=null,this.rainPacket=null,this.windline=null,this.wavePacket=null,this.starPacket=null,this.eventNightStop=!1,this.forceTimePass=!1}};class m{constructor(){this.pos=s.vec3.create(),this.color=r.colorNewCopy(r.TransparentBlack),this.power=0,this.fluctuation=0,this.priority=!1}}t.LIGHT_INFLUENCE=m;t.WAVE_INFLUENCE=class{constructor(){this.pos=s.vec3.create(),this.outerRadius=0,this.innerRadius=0}};var p;t.dKy_tevstr_c=class{constructor(){this.lightObj=new n.Light,this.colorC0=r.colorNewCopy(r.White),this.colorK0=r.colorNewCopy(r.White),this.colorK1=r.colorNewCopy(r.White),this.fogCol=r.colorNewCopy(r.White),this.fogStartZ=0,this.fogEndZ=0,this.blendPsel=0}},function(e){e[e.Sunny=0]="Sunny",e[e.Overcast=1]="Overcast",e[e.LightRain=2]="LightRain",e[e.HeavyRain=3]="HeavyRain",e[e.LightThunder=4]="LightThunder",e[e.HeavyThunder=5]="HeavyThunder",e[e.Done=255]="Done"}(p||(p={}));class f{constructor(e){this.entries=[];const t=e.createDataView();let a=0;for(let e=0;e<11;e++){const e=t.getFloat32(a+0),r=t.getFloat32(a+4),n=t.getUint8(a+8),s=t.getUint8(a+9);this.entries.push({timeBegin:e,timeEnd:r,palIdxA:n,palIdxB:s}),a+=12}}}function A(e,t){let a=1/0,r=-1;for(let n=0;n<e.length;n++){const i=e[n];if(i.power<=.01)continue;const o=s.vec3.squaredDistance(i.pos,t);if(o<a&&(a=o,r=n),i.priority)return n}return r}function g(e,t,a,r){t.envrIdxPrev>=r.envr.length&&(t.envrIdxPrev=0),t.envrIdxCurr>=r.envr.length&&(t.envrIdxCurr=0),t.envrIdxPrev<0&&(t.envrIdxPrev=a.mStayNo),t.envrIdxCurr<0&&(t.envrIdxCurr=a.mStayNo);const n=r.envr[t.envrIdxPrev],s=r.envr[t.envrIdxCurr],i=r.colo[n.pselIdx[t.pselIdxPrev]],c=r.colo[s.pselIdx[t.pselIdxCurr]],h=function(e,t){l.assert(t>=0&&t<360);for(let a=0;a<e.entries.length;a++){const r=e.entries[a];if(t>=r.timeBegin&&t<r.timeEnd)return r}throw"whoops"}(r.schejule,r.curTime),d=i.palIdx[h.palIdxA],u=i.palIdx[h.palIdxB],m=c.palIdx[h.palIdxA],p=c.palIdx[h.palIdxB];if(e.palePrevA=r.pale[d],e.palePrevB=r.pale[u],e.paleCurrA=r.pale[m],e.paleCurrB=r.pale[p],e.blendPaleAB=o.invlerp(h.timeBegin,h.timeEnd,r.curTime),t.envrIdxPrev!==t.envrIdxCurr||t.pselIdxPrev!==t.pselIdxCurr){const e=1/30;c.changeRate<e&&(c.changeRate=e),0===r.colSetMode&&("sea"===a.stageName&&t.pselIdxPrev!==t.pselIdxCurr?t.blendPsel+=e/10:c.changeRate>0&&(t.blendPsel+=e/c.changeRate),t.blendPsel>=1&&(t.envrIdxPrev=t.envrIdxCurr,t.pselIdxPrev=t.pselIdxCurr))}return e}function _(e,t,a,r,n,s,i,l){const c=o.lerp(e,t,a),h=o.lerp(r,n,a),d=o.lerp(c,h,s);return Math.max(0,o.lerp(d,i,l))}function S(e,t,a,r,n,s,i,l){const c=o.lerp(e,t,a),h=o.lerp(r,n,a);return o.clamp((o.lerp(c,h,s)+i)*l,0,1)}function b(e,t,a,r,n,s,i,o,l,c){const h=c*e.allColRatio;t.r=S(a.r,r.r,n,s.r,i.r,o,null!==l?l.r:0,h),t.g=S(a.g,r.g,n,s.g,i.g,o,null!==l?l.g:0,h),t.b=S(a.b,r.b,n,s.b,i.b,o,null!==l?l.b:0,h),t.a=S(a.a,r.a,n,s.a,i.a,o,null!==l?l.a:0,h)}const v=new class{constructor(){this.blendPaleAB=0}};function w(e,t,a){-1!==a.envrOverride?a.envrIdxCurr=a.envrOverride:a.envrIdxCurr=a.roomNo,a.envrIdxPrev!==a.envrIdxCurr&&(a.blendPsel>=0||a.blendPsel<=1)&&(a.blendPsel=0),function(e,t,a){a.pselIdxPrev=t.pselIdxPrev,a.pselIdxCurr=t.pselIdxCurr,a.pselIdxPrev!==a.pselIdxCurr&&(a.blendPsel=t.blendPsel);const r=g(v,a,e,t);b(t,a.colorC0,r.palePrevA.actCol.C0,r.palePrevB.actCol.C0,r.blendPaleAB,r.paleCurrA.actCol.C0,r.paleCurrB.actCol.C0,a.blendPsel,t.actAdd.C0,t.actColRatio*t.actColRatio),b(t,a.colorK0,r.palePrevA.actCol.K0,r.palePrevB.actCol.K0,r.blendPaleAB,r.paleCurrA.actCol.K0,r.paleCurrB.actCol.K0,a.blendPsel,t.actAdd.K0,t.actColRatio),b(t,a.fogCol,r.palePrevA.fogCol,r.palePrevB.fogCol,r.blendPaleAB,r.paleCurrA.fogCol,r.paleCurrB.fogCol,a.blendPsel,t.fogAdd,t.fogColRatio),a.fogStartZ=_(r.palePrevA.fogStartZ,r.palePrevB.fogStartZ,r.blendPaleAB,r.paleCurrA.fogStartZ,r.paleCurrB.fogStartZ,a.blendPsel,t.fogGlobalStartZ,t.fogGlobalRatio),a.fogEndZ=Math.max(a.fogStartZ,_(r.palePrevA.fogEndZ,r.palePrevB.fogEndZ,r.blendPaleAB,r.paleCurrA.fogEndZ,r.paleCurrB.fogEndZ,a.blendPsel,t.fogGlobalStartZ,t.fogGlobalRatio))}(e,t,a)}function x(e,t,a,s=t.fogCol){r.colorCopy(e.Color,s);n.fogBlockSet(e,2,t.fogStartZ,t.fogEndZ,-a.frustum.near,32e3)}function T(e){const t=e.g_env_light;!function(e,t){let a;a=e.curTime<15?345+e.curTime:e.curTime-15;const r=.01745*a,n=Math.sin(r),i=Math.cos(r),o=8e4*n,l=-8e4*i,c=-48e3*i;s.vec3.set(e.sunPos,o,l,c),s.vec3.set(e.moonPos,-o,-l,-c),s.vec3.add(e.sunPos,e.sunPos,t),s.vec3.add(e.moonPos,e.moonPos,t)}(t,e.cameraPosition),function(e){const t=e.g_env_light,a=e.roomStatus[e.mStayNo].lgtv;null!==a?(s.vec3.copy(t.baseLight.pos,a.pos),r.colorFromRGBA(t.baseLight.color,0,0,0,0),t.baseLight.power=200*a.radius,t.baseLight.fluctuation=a.fluctuation):(h.dKyr__sun_arrival_check(t)?s.vec3.copy(t.baseLight.pos,t.sunPos):s.vec3.copy(t.baseLight.pos,t.moonPos),r.colorFromRGBA(t.baseLight.color,1,1,1,1),t.baseLight.power=0,t.baseLight.fluctuation=0)}(e),function(e,t){const a=g(v,t,e,t);b(t,t.actCol.C0,a.palePrevA.actCol.C0,a.palePrevB.actCol.C0,a.blendPaleAB,a.paleCurrA.actCol.C0,a.paleCurrB.actCol.C0,t.blendPsel,null,t.actColRatio*t.actColRatio),b(t,t.actCol.K0,a.palePrevA.actCol.K0,a.palePrevB.actCol.K0,a.blendPaleAB,a.paleCurrA.actCol.K0,a.paleCurrB.actCol.K0,t.blendPsel,null,t.actColRatio);for(let e=0;e<4;e++)b(t,t.bgCol[e].C0,a.palePrevA.bgCol[e].C0,a.palePrevB.bgCol[e].C0,a.blendPaleAB,a.paleCurrA.bgCol[e].C0,a.paleCurrB.bgCol[e].C0,t.blendPsel,null,t.bgColRatio),b(t,t.bgCol[e].K0,a.palePrevA.bgCol[e].K0,a.palePrevB.bgCol[e].K0,a.blendPaleAB,a.paleCurrA.bgCol[e].K0,a.paleCurrB.bgCol[e].K0,t.blendPsel,null,t.bgColRatio);b(t,t.fogCol,a.palePrevA.fogCol,a.palePrevB.fogCol,a.blendPaleAB,a.paleCurrA.fogCol,a.paleCurrB.fogCol,t.blendPsel,t.fogAdd,t.fogColRatio),t.fogStartZ=_(a.palePrevA.fogStartZ,a.palePrevB.fogStartZ,a.blendPaleAB,a.paleCurrA.fogStartZ,a.paleCurrB.fogStartZ,t.blendPsel,t.fogGlobalStartZ,t.fogGlobalRatio),t.fogEndZ=Math.max(t.fogStartZ,_(a.palePrevA.fogEndZ,a.palePrevB.fogEndZ,a.blendPaleAB,a.paleCurrA.fogEndZ,a.paleCurrB.fogEndZ,t.blendPsel,t.fogGlobalStartZ,t.fogGlobalRatio));const r=t.virt[a.palePrevA.virtIdx]||t.virt[0],n=t.virt[a.palePrevB.virtIdx]||t.virt[0],s=t.virt[a.paleCurrA.virtIdx]||t.virt[0],i=t.virt[a.paleCurrB.virtIdx]||t.virt[0];b(t,t.vrSkyCol,r.skyCol,n.skyCol,a.blendPaleAB,s.skyCol,i.skyCol,t.blendPsel,t.vrSky0Add,t.vrSoraColRatio),b(t,t.vrUsoUmiCol,r.usoUmiCol,n.usoUmiCol,a.blendPaleAB,s.usoUmiCol,i.usoUmiCol,t.blendPsel,t.vrSky0Add,t.vrSoraColRatio),b(t,t.vrKumoCol,r.kumoCol,n.kumoCol,a.blendPaleAB,s.kumoCol,i.kumoCol,t.blendPsel,t.vrSky0Add,t.vrKumoColRatio),b(t,t.vrKumoCenterCol,r.kumoCenterCol,n.kumoCenterCol,a.blendPaleAB,s.kumoCenterCol,i.kumoCenterCol,t.blendPsel,t.vrSky0Add,t.vrKumoColRatio),b(t,t.vrKasumiMaeCol,r.kasumiMaeCol,n.kasumiMaeCol,a.blendPaleAB,s.kasumiMaeCol,i.kasumiMaeCol,t.blendPsel,t.vrKasumiAdd,t.vrSoraColRatio)}(e,t)}function y(e){return e.g_env_light.eventNightStop}function C(e){return!1}function M(e){return e.g_env_light.forceTimePass||e.dStage_dt.rtbl[e.mStayNo].isTimePass}function U(e){e.rainCount>0&&(e.rainCount<41?h.dKyw_rain_set(e,e.rainCount-1):h.dKyw_rain_set(e,e.rainCount-3))}t.settingTevStruct=function(e,t,a,n){const i=e.g_env_light;if(r.colorFromRGBA(n.colorK1,0,0,0,0),0===t||9===t||99===t){if(n.lightMode=1,0!==t&&99!==t||w(e,i,n),99!==t){const e=0;!function(e,t,a,n){const i=A(e.plights,t);let l,c,h,u,m,p,f=null;if(i>-1){const a=e.plights[i];l=s.vec3.distance(a.pos,t),c=Math.max(a.power,.001),l<1e3+c&&(f=a)}null!==f?(p=f.pos,m=f.fluctuation,h=f.color,u=f.priority):(l=s.vec3.distance(e.baseLight.pos,t),c=e.baseLight.power,p=e.baseLight.pos,m=e.baseLight.fluctuation,h=r.OpaqueBlack,u=!1);let g=1;c>0&&0===n&&(g=Math.min(l/c,1));const _=1-g*g;let S;if(m>=1e3)S=m-1e3;else{const e=255-m/3*_;S=o.lerp(e,255,d.cM_rndF(1))}a.lightObj.Color.r=o.clamp(S/255,0,1),a.lightObj.Color.g=0,a.lightObj.Color.b=0,a.lightObj.Color.a=1;const b=.2*_;if(r.colorScaleAndAdd(a.colorC0,a.colorC0,h,b),r.colorScaleAndAdd(a.colorK0,a.colorK0,h,b),0!==n||u)s.vec3.copy(a.lightObj.Position,p);else{const e=Math.min(s.vec3.dist(t,a.lightObj.Position)/1e4,1),r=e*e,n=1-Math.min(l/1e4,1),i=10+1e4*r+100*n*n*n;a.lightObj.Position[0]=d.cLib_addCalc(a.lightObj.Position[0],p[0],.5,i,.001),a.lightObj.Position[1]=d.cLib_addCalc(a.lightObj.Position[1],p[1],.5,i,.001),a.lightObj.Position[2]=d.cLib_addCalc(a.lightObj.Position[2],p[2],.5,i,.001)}}(i,l.assertExists(a),n,e),function(e,t,a){if(e.playerEflightIdx<0)return;const r=e.eflights[e.playerEflightIdx];if(void 0===r)return;if(r.power<=0)return;const n=s.vec3.distance(t,r.pos)/r.power;n>1||(a.colorK1.r=o.clamp(r.color.r*n,0,1),a.colorK1.g=o.clamp(r.color.g*n,0,1),a.colorK1.b=o.clamp(r.color.b*n,0,1),a.colorK1.a=1)}(i,a,n)}}else{let a,o;n.lightMode=0,t>=5&&t<=8?(a=t-5,o=!0):(a=t-1,o=!1),function(e,t,a,n){a.pselIdxPrev=t.pselIdxPrev,a.pselIdxCurr=t.pselIdxCurr,a.pselIdxPrev!==a.pselIdxCurr&&(a.blendPsel=t.blendPsel);const s=g(v,a,e,t);b(t,a.colorC0,s.palePrevA.bgCol[n].C0,s.palePrevB.bgCol[n].C0,s.blendPaleAB,s.paleCurrA.bgCol[n].C0,s.paleCurrB.bgCol[n].C0,a.blendPsel,t.bgAdd[n].C0,t.bgColRatio),b(t,a.colorK0,s.palePrevA.bgCol[n].K0,s.palePrevB.bgCol[n].K0,s.blendPaleAB,s.paleCurrA.bgCol[n].K0,s.paleCurrB.bgCol[n].K0,a.blendPsel,t.bgAdd[n].K0,t.bgColRatio),1===n?r.colorCopy(a.fogCol,t.vrUsoUmiCol):b(t,a.fogCol,s.palePrevA.fogCol,s.palePrevB.fogCol,s.blendPaleAB,s.paleCurrA.fogCol,s.paleCurrB.fogCol,a.blendPsel,t.fogAdd,t.fogColRatio),a.fogStartZ=_(s.palePrevA.fogStartZ,s.palePrevB.fogStartZ,s.blendPaleAB,s.paleCurrA.fogStartZ,s.paleCurrB.fogStartZ,a.blendPsel,t.fogGlobalStartZ,t.fogGlobalRatio),a.fogEndZ=Math.max(a.fogStartZ,_(s.palePrevA.fogEndZ,s.palePrevB.fogEndZ,s.blendPaleAB,s.paleCurrA.fogEndZ,s.paleCurrB.fogEndZ,a.blendPsel,t.fogGlobalStartZ,t.fogGlobalRatio))}(e,i,n,a),s.vec3.copy(n.lightObj.Position,i.lightStatus[0].Position),o?r.colorFromRGBA(n.lightObj.Color,1,1,1,1):r.colorFromRGBA(n.lightObj.Color,1,0,0,1)}},t.dKy_tevstr_init=function(e,t,a=-1){e.roomNo=t,e.envrIdxCurr=e.roomNo,e.envrIdxPrev=e.roomNo,e.envrOverride=a},t.dKy_GxFog_set=function(e,t,a){x(t,e,a)},t.dKy_GxFog_sea_set=function(e,t,a){x(t,e,a,e.vrUsoUmiCol)},t.dKy_setLight__OnModelInstance=function(e,t,a){const r=t.getGXLightReference(0);n.lightSetFromWorldLight(r,e.lightStatus[0],a);const s=t.getGXLightReference(1);n.lightSetFromWorldLight(s,e.lightStatus[1],a)},t.setLightTevColorType=function(e,t,a,r){const s=e.g_env_light;0!==a.lightMode&&t.setColorOverride(c.ColorKind.K1,a.colorK1);const i=t.getGXLightReference(0);n.lightSetFromWorldLight(i,a.lightObj,r);const o=t.getGXLightReference(1);n.lightSetFromWorldLight(o,s.lightStatus[1],r),t.setColorOverride(c.ColorKind.C0,a.colorC0),t.setColorOverride(c.ColorKind.K0,a.colorK0);for(let e=0;e<t.materialInstances.length;e++)x(t.materialInstances[e].fogBlock,a,r)},t.dKy_checkEventNightStop=y,t.dKy_pship_existence_chk=C;const k=[0,1,3,2,0,1,3,2],D=[120,150,90,120,120,150,150,120],I=[[p.Overcast,p.LightRain,p.Overcast,p.Done],[p.LightThunder,p.HeavyThunder,p.LightThunder,p.Done],[p.LightRain,p.HeavyRain,p.LightRain,p.Done],[p.LightThunder,p.Done]],R=[[5,10,5],[7,15,5],[5,12.5,5],[10]];function B(e){const t=e.g_env_light;if("sea"===e.stageName){if(y(e))1!==t.weatherPselIdx&&(t.weatherPselIdx=1,t.pselIdxCurrGather=1),t.rainCount<250&&h.dKyw_rain_set(t,t.rainCount+1);else{const a=M(e);if(t.diceWeatherStop||!a)0!==t.weatherPselIdx&&(t.weatherPselIdx=0,t.pselIdxCurrGather=0),1===t.thunderMode&&(t.thunderMode=0),U(t);else{const e=t.curTime;if(0===t.diceWeatherState&&e>t.diceWeatherChangeTime&&e<t.diceWeatherChangeTime+180&&(t.diceWeatherState=1),1===t.diceWeatherState){const a=0|d.cM_rndF(7.99),r=k[a];t.diceWeatherCurrPattern=r,t.diceWeatherCounter=0,function(e,t,a,r){console.log("d_kankyo: dice_wether_init",p[t]),e.diceWeatherMode=t,e.diceWeatherTime=(r+a)%360}(t,I[r][0],R[r][0],e),t.diceWeatherCounter++,t.diceWeatherState=2}else if(2===t.diceWeatherState){if(e>t.diceWeatherTime&&e<t.diceWeatherTime+180){const a=t.diceWeatherCurrPattern,r=t.diceWeatherCounter;!function(e,t,a,r){console.log("d_kankyo: dice_wether_execute",p[t]),t===p.Done?(e.diceWeatherMode=p.Sunny,e.diceWeatherState=3):(e.diceWeatherMode=t,e.diceWeatherTime=(r+a)%360,e.diceWeatherCounter++)}(t,I[a][r],R[a][r],e)}}else if(3===t.diceWeatherState){const a=0|d.cM_rndF(7.99);t.diceWeatherChangeTime=(e+D[a])%360,t.diceWeatherState=0}if(0===t.colSetMode&&0===t.colSetModeGather){let e;if(t.diceWeatherMode===p.Sunny)e=0,1===t.thunderMode&&(t.thunderMode=0),U(t);else if(t.diceWeatherMode===p.Overcast)e=1,U(t);else if(t.diceWeatherMode===p.LightRain)e=1,t.rainCount<40?h.dKyw_rain_set(t,t.rainCount+1):h.dKyw_rain_set(t,t.rainCount-1);else if(t.diceWeatherMode===p.HeavyRain)e=1,t.rainCount<250&&h.dKyw_rain_set(t,t.rainCount+1);else if(t.diceWeatherMode===p.LightThunder)e=1,t.thunderMode=1,U(t);else{if(t.diceWeatherMode!==p.HeavyThunder)throw"whoops";e=1,t.thunderMode=1,t.rainCount<250&&h.dKyw_rain_set(t,t.rainCount+1)}t.weatherPselIdx!==e&&(t.pselIdxCurrGather=e,t.weatherPselIdx=e)}}}0===t.colSetMode&&0===t.colSetModeGather&&-1!==t.pselIdxCurrGather&&t.pselIdxCurrGather!==t.pselIdxCurr&&(t.blendPselGather=0)}}function P(e,t,a){const r=t.colSetModeGather,n=e.mStayNo;t.envrIdxCurr!==n&&(t.envrIdxPrev===n?(t.envrIdxPrev=t.envrIdxCurr,t.blendPsel=1-t.blendPsel,t.envrIdxCurr=n):1!==t.blendPsel&&0!==t.blendPsel||(t.blendPsel=0,t.envrIdxCurr=n)),t.colSetMode=t.colSetModeGather,0!==t.colSetModeGather&&(t.colSetModeGather<3?t.colSetModeGather++:t.colSetModeGather=0),0===r?t.pselIdxPrev===t.pselIdxCurr&&(-1!==t.pselIdxPrevGather&&(t.pselIdxPrev=t.pselIdxPrevGather,t.pselIdxPrevGather=-1),-1!==t.pselIdxCurrGather&&(t.pselIdxCurr=t.pselIdxCurrGather,t.weatherPselIdx=t.pselIdxCurr,t.pselIdxCurrGather=-1),t.blendPselGather>=0&&(t.blendPsel=t.blendPselGather,t.blendPselGather=-1)):(-1!==t.pselIdxPrevGather&&(t.pselIdxPrev=t.pselIdxPrevGather,0===t.colSetModeGather&&(t.pselIdxPrevGather=-1)),-1!==t.pselIdxCurrGather&&(t.pselIdxCurr=t.pselIdxCurrGather,0===t.colSetModeGather&&(t.pselIdxCurrGather=-1)),t.blendPselGather>=0&&(t.blendPsel=t.blendPselGather,0===t.colSetModeGather&&(t.blendPselGather=-1))),function(e,t,a){let r=M(e);r||(!function(e){const t=function(e){return e.g_env_light.curTime/15}(e);return t<5||t>17}(e)?t.curTime<165&&(r=!0):t.curTime>=270&&t.curTime<345&&(r=!0)),r&&(t.curTime+=t.timeAdv*a,t.curTime>=360&&(t.curTime=0,t.calendarDay+=1))}(e,t,a),function(e,t){e.playerEflightIdx=A(e.eflights,t),e.playerPlightIdx=A(e.plights,t)}(t,e.playerPosition)}function E(e){const t=e.g_env_light;t.pale=e.dStage_dt.pale,0===t.pale.length&&(t.pale=function(e){const t=e.findExtraSymbolData("d_kankyo_data.o","l_field_data"),a=[];let r=0;for(let e=0;e<16;e++){const e=new i.stage_palet_info_class;r+=e.parse(t.slice(r)),a.push(e)}return a}(e)),t.colo=e.dStage_dt.colo,0===t.colo.length&&(t.colo=function(e){const t=e.findExtraSymbolData("d_kankyo_data.o","l_pselect_default"),a=[];let r=0;for(let e=0;e<2;e++){const e=new i.stage_pselect_info_class;r+=e.parse(t.slice(r)),a.push(e)}return a}(e)),t.envr=e.dStage_dt.envr,0===t.envr.length&&(t.envr=function(e){const t=e.findExtraSymbolData("d_kankyo_data.o","l_pselect_default"),a=[];let r=0;for(let e=0;e<2;e++){const e=new i.stage_envr_info_class;r+=e.parse(t.slice(r)),a.push(e)}return a}(e)),t.virt=e.dStage_dt.virt,0===t.virt.length&&(t.virt=function(e){const t=e.findExtraSymbolData("d_kankyo_data.o","l_vr_box_data"),a=[];let r=0;for(let e=0;e<8;e++){const e=new i.stage_vrbox_info_class;r+=e.parse(t.slice(r)),a.push(e)}return a}(e));t.schejule=new f(e.findExtraSymbolData("d_kankyo_data.o","l_time_attribute")),y(e)?t.weatherPselIdx=1:t.weatherPselIdx=0,t.pselIdxPrev=t.weatherPselIdx,t.pselIdxCurr=t.weatherPselIdx;const a=new Date;t.calendarDay=a.getDay(),t.curTime=15*a.getHours(),t.timeAdv=.02,r.colorFromRGBA(t.lightStatus[0].Color,1,0,0,0),r.colorFromRGBA(t.lightStatus[1].Color,0,0,0,0),t.diceWeatherChangeTime=(t.curTime+15)%360,(5===a.getDay()&&13===a.getDate()||9===a.getMonth()&&31===a.getDate())&&(t.eventNightStop=!0)}function F(e,t,a,r,n){e.r=a*t*1/255,e.g=r*t*1/255,e.b=n*t*1/255}function V(e,t){e.vrSoraColRatio=t}function O(e,t){e.vrKumoColRatio=t}t.dKy_setLight=function(e){const t=e.g_env_light,a=t.lightStatus[0],r=t.baseLight;if(a.Position[0]=d.cLib_addCalc(a.Position[0],r.pos[0],.2,5e4,1e-5),a.Position[1]=d.cLib_addCalc(a.Position[1],r.pos[1],.2,5e4,1e-5),a.Position[2]=d.cLib_addCalc(a.Position[2],r.pos[2],.2,5e4,1e-5),r.fluctuation>=1e3)a.Color.r=(r.fluctuation-1e3)/255;else{let t;t=r.power>0?Math.min(s.vec3.distance(r.pos,e.playerPosition)/r.power,1):1,t=Math.min(20*(1-t),1);const n=255-r.fluctuation/3*t,i=o.lerp(n,255,d.cM_rndF(1))/255;a.Color.r=d.cLib_addCalc2(a.Color.r,i,.4,20)}const n=t.lightStatus[1];if(t.playerEflightIdx>=0){const a=t.eflights[t.playerEflightIdx];if(s.vec3.copy(n.Position,a.pos),a.fluctuation>=1e3)n.Color.g=a.fluctuation-1e3;else{let t;t=a.power>0?Math.min(s.vec3.distance(a.pos,e.playerPosition)/a.power,1):1,t=Math.min(20*(1-t),1);const i=255-r.fluctuation/3*t,l=o.lerp(i,255,d.cM_rndF(1))/255;n.Color.g=d.cLib_addCalc2(n.Color.g,l,.5,20)}}else n.Color.g=0},t.envcolor_init=E,t.dKy_actor_addcol_amb_set=function(e,t,a,r,n){F(e.actAdd.K0,t,a,r,n)},t.dKy_actor_addcol_dif_set=function(e,t,a,r,n){F(e.actAdd.C0,t,a,r,n)},t.dKy_bg_addcol_amb_set=function(e,t,a,r,n){F(e.bgAdd[0].K0,t,a,r,n)},t.dKy_bg_addcol_dif_set=function(e,t,a,r,n){F(e.bgAdd[0].C0,t,a,r,n)},t.dKy_bg1_addcol_amb_set=function(e,t,a,r,n){F(e.bgAdd[1].K0,t,a,r,n)},t.dKy_bg1_addcol_dif_set=function(e,t,a,r,n){F(e.bgAdd[1].C0,t,a,r,n)},t.dKy_bg2_addcol_amb_set=function(e,t,a,r,n){F(e.bgAdd[2].K0,t,a,r,n)},t.dKy_bg2_addcol_dif_set=function(e,t,a,r,n){F(e.bgAdd[2].C0,t,a,r,n)},t.dKy_bg3_addcol_amb_set=function(e,t,a,r,n){F(e.bgAdd[3].K0,t,a,r,n)},t.dKy_bg3_addcol_dif_set=function(e,t,a,r,n){F(e.bgAdd[3].C0,t,a,r,n)},t.dKy_vrbox_addcol_sky0_set=function(e,t,a,r,n){F(e.vrSky0Add,t,a,r,n)},t.dKy_vrbox_addcol_kasumi_set=function(e,t,a,r,n){F(e.vrKasumiAdd,t,a,r,n)},t.dKy_addcol_fog_set=function(e,t,a,r,n){F(e.fogAdd,t,a,r,n)},t.dKy_set_actcol_ratio=function(e,t){e.actColRatio=t},t.dKy_set_bgcol_ratio=function(e,t){e.bgColRatio=t},t.dKy_set_fogcol_ratio=function(e,t){e.fogColRatio=t},t.dKy_set_vrboxsoracol_ratio=V,t.dKy_set_vrboxkumocol_ratio=O,t.dKy_set_vrboxcol_ratio=function(e,t){V(e,t),O(e,t)},t.dKy_get_seacolor=function(e,t,a){r.colorAdd(t,e.bgCol[1].C0,e.bgAdd[1].C0),r.colorClampLDR(t,t),r.colorAdd(a,e.bgCol[1].K0,e.bgAdd[1].K0),r.colorClampLDR(a,a)},t.dKy_change_colpat=function(e,t){e.pselIdxCurrGather=t,e.pselIdxCurr!==t&&(e.blendPselGather=0)},t.dKy_plight_set=function(e,t){e.plights.push(t)},t.dKy_plight_cut=function(e,t){const a=l.arrayRemove(e.plights,t);e.playerPlightIdx===a&&(e.playerPlightIdx=-1)},t.dKy_efplight_set=function(e,t){e.eflights.push(t)},t.dKy_efplight_cut=function(e,t){const a=l.arrayRemove(e.eflights,t);e.playerEflightIdx===a&&(e.playerEflightIdx=-1)},t.dKy__waveinfl_set=function(e,t){e.waveInfluences.push(t)},t.dKy__waveinfl_cut=function(e,t){l.arrayRemove(e.waveInfluences,t)},t.dKy_get_dayofweek=function(e){return e.calendarDay%7};class N extends u.kankyo_class{subload(e){return E(e),h.dKy_wave_chan_init(e),2}execute(e,t){B(e),P(e,e.g_env_light,t),T(e)}draw(e){}}N.PROCESS_NAME=21;class L extends u.kankyo_class{subload(e){const t=e.g_env_light;t.wetherCommonTextures=new h.dKankyo__CommonTextures(e);const a=e.stageName;if("Name"===a){s.vec3.set(t.windVec,1,0,0),t.windPower=.7;const e=new Date;t.curTime=15*e.getHours()}if(y(e)){const r=e.dStage_dt.stag.roomTypeAndSchBit>>>16&7;0===r||7===r?(h.dKyw_rain_set(t,250),t.thunderMode=1):2===r&&("Ocrogh"!==a&&"Omori"!==a&&"Orichh"!==a&&"Atorizk"!==a&&"LinkRM"!==a&&"Ojhous2"!==a&&"Onobuta"!==a&&"Omasao"!==a&&"Obombh"!==a&&"Opub"!==a||(h.dKyw_rain_set(t,250),t.thunderMode=10))}return 2}execute(e,t){"Name"===e.stageName||h.dKyw_wether_move(e,t),h.dKyw_wether_move_draw(e,t)}draw(e,t,a){h.dKyw_wether_draw(e,t,a)}delete(e){const t=e.g_env_light,a=e.modelCache.device;t.wetherCommonTextures.destroy(a),null!==t.sunPacket&&t.sunPacket.destroy(a),null!==t.rainPacket&&t.rainPacket.destroy(a),null!==t.wavePacket&&t.wavePacket.destroy(a),null!==t.starPacket&&t.starPacket.destroy(a)}}L.PROCESS_NAME=484;class G extends u.kankyo_class{subload(e){return 2}execute(e,t){h.dKyw_wether_move_draw2(e,t)}draw(e,t,a){h.dKyw_wether_draw2(e,t,a)}delete(e){const t=e.g_env_light,a=e.modelCache.device;null!==t.vrkumoPacket&&t.vrkumoPacket.destroy(a)}}G.PROCESS_NAME=485,t.dKankyo_create=function(e){u.fopKyM_Create(e.frameworkGlobals,21,null),u.fopKyM_Create(e.frameworkGlobals,484,null),u.fopKyM_Create(e.frameworkGlobals,485,null)},t.dKy__RegisterConstructors=function(e){function t(t){u.fpcPf__Register(e,t.PROCESS_NAME,t)}t(N),t(L),t(G)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(1),s=a(4),i=a(45),o=a(54),l=a(30),c=a(2);function h(e,t){const a=t.createDataView();let r,n,s,i,o;if(0===e)r=a.getUint32(0,!0),n=a.getUint32(4,!0),s=a.getUint32(8,!0),i=1,o=a.getUint32(12,!0);else{if(1!==e&&2!==e)throw"whoops";r=a.getUint16(0,!0),n=a.getUint16(2,!0),s=a.getUint32(4,!0),i=a.getFloat32(8,!0),o=a.getUint32(12,!0)}let l=16;if(0===n)return null;if(1===r){const e=[];for(let t=0;t<n;t++){const t=a.getUint32(l+0,!0),r=a.getFloat32(l+4,!0);l+=8,e.push({time:t,value:r})}return{type:r,frames:e}}if(2===r){const e=[];for(let t=0;t<n;t++){const t=a.getUint32(l+0,!0),r=a.getFloat32(l+4,!0),n=a.getUint32(l+8,!0),s=a.getUint32(l+12,!0);l+=16,e.push({time:t,value:r,tangentIn:n,tangentOut:s})}return{type:r,frames:e}}if(3===r){const e=[];for(let t=0;t<n;t++){const t=a.getUint32(l+0,!0),r=a.getFloat32(l+4,!0);l+=8,e.push({time:t,value:r})}return{type:r,frames:e}}throw"whoops"}function d(e,t){const a=t.createDataView();r.assert("mmad"===r.readString(t,0,4,!1));const n=a.getUint32(4,!0),s=a.getUint32(8,!0),i=a.getUint32(12,!0);let o=16;const l=[];if(1===n)for(let r=0;r<2;r++){const n=a.getUint16(o,!0);if(o+=2,0===n)continue;const s=h(e,t.slice(n));null!==s&&(l[r]=s)}else if(2===n)for(let r=0;r<1;r++){const n=a.getUint16(o,!0);if(o+=2,0===n)continue;const s=h(e,t.slice(n));null!==s&&(l[r]=s)}else if(4===n)for(let r=0;r<4;r++){const n=a.getUint16(o,!0);if(o+=2,0===n)continue;const s=h(e,t.slice(n));null!==s&&(l[r]=s)}else if(5===n)for(let r=0;r<1;r++){const n=a.getUint16(o,!0);if(o+=2,0===n)continue;const s=h(e,t.slice(n));null!==s&&(l[r]=s)}return{animationType:n,materialIndex:s,channelIndex:i,tracks:l}}function u(e,t){const a=e.frames,r=a.findIndex(e=>t<e.time);if(0===r)return a[0].value;if(r<0)return a[a.length-1].value;const n=a[r-1],s=a[r];return s.time-n.time==1?n.value:function(e,t,a){const r=t.time-e.time,n=e.value,s=t.value,i=e.tangentOut*r,o=t.tangentIn*r;return l.getPointHermite(n,s,i,o,a)}(n,s,(t-n.time)/(s.time-n.time))}function m(e,t){if(1===e.type)return function(e,t){const a=e.frames,r=a.findIndex(e=>t<e.time);if(0===r)return a[0].value;if(r<0)return a[a.length-1].value;const n=a[r-1],s=a[r],i=(t-n.time)/(s.time-n.time);return c.lerp(n.value,s.value,i)}(e,t);if(2===e.type)return u(e,t);if(3===e.type)return function(e,t){const a=e.frames,r=a.findIndex(e=>t<e.time);return 0===r?a[0].value:r<0?a[a.length-1].value:a[r-1].value}(e,t);throw"whoops"}function p(e,t){const a=e.duration;if(0===e.loopMode)return t>a&&(t=a),t;if(1===e.loopMode){for(;t>a;)t-=a;return t}throw"whoops"}t.parse=function(e,t,a=""){const n=t.createDataView();r.assert("cmab"===r.readString(t,0,4,!1));const s=n.getUint32(4,!0);r.assert(1===s),n.getUint32(8,!0),r.assert(0===n.getUint32(12,!0)),r.assert(1===n.getUint32(16,!0)),r.assert(32===n.getUint32(20,!0));const i=n.getUint32(24,!0);r.assert("strt"===r.readString(t,i,4,!1));const l=[],c=n.getUint32(i+4,!0);let h=i+8;const u=h+4*c;for(let e=0;e<c;e++){const e=u+n.getUint32(h,!0);l.push(r.readString(t,e,255,!0)),h+=4}const m=n.getUint32(28,!0);r.assert(4294967295===n.getUint32(32,!0));const p=n.getUint32(36,!0);r.assert(20===n.getUint32(44,!0));const f=n.getUint32(48,!0);r.assert("mads"===r.readString(t,52,4,!1));const A=n.getUint32(56,!0),g=[];let _=60;for(let a=0;a<A;a++){const a=52+n.getUint32(_+0,!0);g.push(d(e,t.slice(a))),_+=4}let S=[];if(0!==f){const e=0!==m?t.slice(m):null;S=function(e,t,a,n=""){const s=e.createDataView();r.assert("txpt"===r.readString(e,0,4));const i=s.getUint32(4,!0);let l=8;const c=[];for(let e=0;e<i;e++){const e=s.getUint32(l+0,!0),r=s.getUint16(l+4,!0),i=(s.getUint16(l+6,!0),s.getUint16(l+8,!0)),h=s.getUint16(l+10,!0),d=s.getUint32(l+12,!0);let u=s.getUint32(l+16,!0);const m=`${n}${a[s.getUint32(l+20,!0)]}`,p=u+e,f=[],A=o.getTextureFormatFromGLFormat(d);if(null!==t){let e=i,a=h;for(let n=0;n<r;n++){const r=o.decodeTexture(A,e,a,t.slice(u,p));f.push({name:m,width:e,height:a,pixels:r}),u+=o.computeTextureByteSize(A,e,a),e/=2,a/=2}}c.push({name:m,format:A,width:i,height:h,levels:f}),l+=24}return c}(t.slice(32+f),e,l,a)}return{duration:p,loopMode:1,animEntries:g,textures:S}};t.TextureSRTAnimator=class{constructor(e,t,a){this.animationController=e,this.cmab=t,this.animEntry=a,r.assert(1===a.animationType||5===a.animationType)}calcTexMtx(e){const t=p(this.cmab,this.animationController.getTimeInFrames());if(n.mat4.identity(e),1===this.animEntry.animationType){const a=void 0!==this.animEntry.tracks[0]?m(this.animEntry.tracks[0],t):0,r=void 0!==this.animEntry.tracks[1]?m(this.animEntry.tracks[1],t):0;i.calcTexMtx(e,1,1,0,-a,-r)}else{if(5!==this.animEntry.animationType)throw"whoops";{const a=void 0!==this.animEntry.tracks[0]?m(this.animEntry.tracks[0],t):0;i.calcTexMtx(e,1,1,a,0,0)}}}};t.ColorAnimator=class{constructor(e,t,a){this.animationController=e,this.cmab=t,this.animEntry=a,r.assert(4===a.animationType)}calcColor(e){const t=p(this.cmab,this.animationController.getTimeInFrames()),a=void 0!==this.animEntry.tracks[0]?m(this.animEntry.tracks[0],t):1,r=void 0!==this.animEntry.tracks[1]?m(this.animEntry.tracks[1],t):1,n=void 0!==this.animEntry.tracks[2]?m(this.animEntry.tracks[2],t):1,i=void 0!==this.animEntry.tracks[3]?m(this.animEntry.tracks[3],t):1;s.colorFromRGBA(e,a,r,n,i)}};t.TexturePaletteAnimator=class{constructor(e,t,a){this.animationController=e,this.cmab=t,this.animEntry=a,r.assert(2===a.animationType)}fillTextureMapping(e,t){const a=p(this.cmab,this.animationController.getTimeInFrames()),r=m(this.animEntry.tracks[0],a);e.fillTextureMapping(t,this.cmab.textures[r].name)}}},function(e,t,a){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var a=t.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(var r in a)n(a,r)&&(e[r]=a[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,a,r,n){if(t.subarray&&e.subarray)e.set(t.subarray(a,a+r),n);else for(var s=0;s<r;s++)e[n+s]=t[a+s]},flattenChunks:function(e){var t,a,r,n,s,i;for(r=0,t=0,a=e.length;t<a;t++)r+=e[t].length;for(i=new Uint8Array(r),n=0,t=0,a=e.length;t<a;t++)s=e[t],i.set(s,n),n+=s.length;return i}},i={arraySet:function(e,t,a,r,n){for(var s=0;s<r;s++)e[n+s]=t[a+s]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,s)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(r)},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15)),s=a(0),i={0:{magics:["BY\0","BY\0","YB\0"],allowedNodeTypes:[160,192,193,194,208,209,211,210,255]},1:{magics:["CRG1"],allowedNodeTypes:[160,192,193,194,208,209,211,210,255,226,203]}};function o(e,t){const r=e.createTypedArray(Uint8Array,t);let n=0;for(;0!==r[n];)n++;return function(e){if("undefined"!=typeof TextDecoder)return new TextDecoder("utf8").decode(e);{const{StringDecoder:t}=a(207);return new t("utf8").write(e)}}(e.createTypedArray(Uint8Array,t,n))}class l{constructor(e,t){this.fileType=e,this.endianness=t,this.strKeyTable=null,this.strValueTable=null}get littleEndian(){return 0===this.endianness}}function c(e,t,a){const r=e.getUint8(t+0),n=e.getUint8(t+1),s=e.getUint8(t+2);return a?s<<16|n<<8|r:r<<16|n<<8|s}function h(e,t,a){const r=t.createDataView(),n=r.getUint8(a+0),i=c(r,a+1,e.littleEndian);s.assert(194===n);let l=a+4;const h=[];for(let n=0;n<i;n++){const n=a+r.getUint32(l,e.littleEndian);h.push(o(t,n)),l+=4}return h}function d(e,t,a,r){const n=t.createDataView(),i=n.getUint8(a+0),o=c(n,a+1,e.littleEndian);switch(void 0!==r&&s.assert(r===i),i){case 193:return function(e,t,a){const r=t.createDataView(),n=r.getUint8(a+0),i=c(r,a+1,e.littleEndian);s.assert(193===n);const o={};let l=a+4;for(let a=0;a<i;a++){const a=c(r,l+0,e.littleEndian),n=e.strKeyTable[a],s=u(e,t,r.getUint8(l+3),l+4);o[n]=s,l+=8}return o}(e,t,a);case 192:return function(e,t,a){const r=t.createDataView(),n=r.getUint8(a+0),i=c(r,a+1,e.littleEndian);s.assert(192===n);const o=[];let l=a+4,h=s.align(l+i,4);for(let a=0;a<i;a++){const a=r.getUint8(l);o.push(u(e,t,a,h)),l++,h+=4}return o}(e,t,a);case 194:return h(e,t,a);case 203:if(16777215==o){const r=n.getUint32(a+4,e.littleEndian);return t.subarray(a+8,o+r)}return t.subarray(a+4,o);case 226:return t.createTypedArray(Float32Array,a+4,o,e.endianness);default:throw new Error("whoops")}}function u(e,t,a,r){const n=t.createDataView();switch(function(e,t){s.assert(i[e.fileType].allowedNodeTypes.includes(t))}(e,a),a){case 192:case 193:case 194:case 203:case 226:return d(e,t,n.getUint32(r,e.littleEndian),a);case 160:{const t=n.getUint32(r,e.littleEndian);return e.strValueTable[t]}case 208:{const t=n.getUint32(r,e.littleEndian);return s.assert(0===t||1===t),!!t}case 209:return n.getInt32(r,e.littleEndian);case 211:return n.getUint32(r,e.littleEndian);case 210:return n.getFloat32(r,e.littleEndian);case 228:return n.getInt32(r,e.littleEndian);case 229:return n.getUint32(r,e.littleEndian);case 230:return n.getFloat64(r,e.littleEndian);case 255:return null;default:throw new Error}}t.parse=function(e,t=0){const a=s.readString(e,0,4,!1),r=i[t].magics;s.assert(r.includes(a));const n=e.createDataView(),o="YB"==a.slice(0,2),c=new l(t,o?0:1),u=n.getUint32(4,c.littleEndian),m=n.getUint32(8,c.littleEndian),p=n.getUint32(12,c.littleEndian);return 0===p?{}:(c.strKeyTable=0!==u?h(c,e,u):null,c.strValueTable=0!==m?h(c,e,m):null,d(c,e,p))};class m{constructor(e=65536,t=4096){this.growAmount=t,this.userSize=0,this.bufferSize=0,this.maybeGrow(0,e)}maybeGrow(e,t=e){if(e>this.userSize&&(this.userSize=e),t>this.bufferSize){this.bufferSize=s.align(t,this.growAmount);const e=new ArrayBuffer(this.bufferSize);new Uint8Array(e).set(new Uint8Array(this.buffer)),this.buffer=e,this.view=new DataView(this.buffer)}}finalize(){const e=this.buffer;return this.buffer=null,n.ArrayBuffer_slice.call(e,0,this.userSize)}}class p{constructor(e=new m,t=0){this.buffer=e,this.offs=t}setBufferSlice(e,t){this.buffer.maybeGrow(e+t.byteLength),new Uint8Array(this.buffer.buffer,this.offs).set(t.createTypedArray(Uint8Array))}writeBufferSlice(e){this.setBufferSlice(this.offs,e),this.offs+=e.byteLength}setString(e,t){this.buffer.maybeGrow(e+t.length);const a=new Uint8Array(this.buffer.buffer,this.offs);for(let e=0;e<t.length;e++)a[e]=t.charCodeAt(e)}writeString(e){this.setString(this.offs,e),this.offs+=e.length}setUint8(e,t){this.buffer.maybeGrow(e+1),this.buffer.view.setUint8(e,t)}writeUint8(e){this.setUint8(this.offs,e),this.offs+=1}setUint24(e,t,a){this.buffer.maybeGrow(e+3),function(e,t,a,r){r?(e.setUint8(t+0,a>>>0&255),e.setUint8(t+1,a>>>8&255),e.setUint8(t+2,a>>>16&255)):(e.setUint8(t+0,a>>>16&255),e.setUint8(t+1,a>>>8&255),e.setUint8(t+2,a>>>0&255))}(this.buffer.view,e,t,a)}writeUint24(e,t){this.setUint24(this.offs,e,t),this.offs+=3}setUint32(e,t,a){this.buffer.maybeGrow(e+4),this.buffer.view.setUint32(e,t,a)}writeUint32(e,t){this.setUint32(this.offs,e,t),this.offs+=4}setInt32(e,t,a){this.buffer.maybeGrow(e+4),this.buffer.view.setInt32(e,t,a)}writeInt32(e,t){this.setInt32(this.offs,e,t),this.offs+=4}setFloat32(e,t,a){this.buffer.maybeGrow(e+4),this.buffer.view.setFloat32(e,t,a)}writeFloat32(e,t){this.setFloat32(this.offs,e,t),this.offs+=4}seekTo(e){this.offs=e,this.buffer.maybeGrow(this.offs)}align(e){this.seekTo(s.align(this.offs,e))}finalize(){return this.buffer.finalize()}}class f{constructor(e,t,a,r,n){this.stream=e,this.fileType=t,this.endianness=a,this.strKeyTable=r,this.strValueTable=n}get littleEndian(){return 0===this.endianness}canUseNodeType(e){return i[this.fileType].allowedNodeTypes.includes(e)}}function A(e,t){const a=e.indexOf(t);return s.assert(a>=0),a}function g(e,t,a){const r=e.stream;r.writeUint8(t),r.writeUint24(a,e.littleEndian)}function _(e,t){if(null==t)return 255;if("boolean"==typeof t)return 208;if("string"==typeof t)return 160;if("number"==typeof t)return t>>>0===t?211:(0|t)===t?209:210;if(e.canUseNodeType(226)&&t instanceof Float32Array)return 226;if(e.canUseNodeType(203)&&t instanceof n.default)return 203;if(t instanceof Array)return 192;if(t.constructor===Object)return 193;throw"whoops"}function S(e,t){const a=e.stream,r=Object.keys(t),n=r.length;g(e,193,n);let s=a.offs;const i=8*n;a.seekTo(a.offs+i);for(let n=0;n<r.length;n++){const i=r[n],o=t[i],l=_(e,o),c=A(e.strKeyTable,i);a.setUint24(s+0,c,e.littleEndian),a.setUint8(s+3,l),b(e,l,o,s+4),s+=8}}function b(e,t,a,r){const i=e.stream;if(null==a)i.setUint32(r,0,e.littleEndian);else if("boolean"==typeof a)i.setUint32(r,a?1:0,e.littleEndian);else if("string"==typeof a)i.setUint32(r,A(e.strValueTable,a),e.littleEndian);else if("number"==typeof a)210===t?i.setFloat32(r,a,e.littleEndian):211===t?i.setUint32(r,a,e.littleEndian):i.setInt32(r,a,e.littleEndian);else if(e.canUseNodeType(226)&&a instanceof Float32Array)i.setUint32(r,i.offs,e.littleEndian),function(e,t){const a=e.stream;g(e,230,t.length);for(let r=0;r<t.length;r++)a.writeFloat32(t[r],e.littleEndian)}(e,a);else if(e.canUseNodeType(203)&&a instanceof n.default)i.setUint32(r,i.offs,e.littleEndian),function(e,t){const a=e.stream;if(t.byteLength>=16777215){g(e,203,16777215);const r=t.byteLength-16777215;s.assert(r<=4294967295),a.writeUint32(r,e.littleEndian)}else g(e,203,t.byteLength);a.writeBufferSlice(t),a.align(4)}(e,a);else if(a instanceof Array)i.setUint32(r,i.offs,e.littleEndian),function(e,t){const a=e.stream,r=t.length;g(e,192,r);for(let r=0;r<t.length;r++)a.writeUint8(_(e,t[r]));a.align(4);let n=a.offs;const s=4*r;a.seekTo(a.offs+s);for(let a=0;a<t.length;a++)b(e,_(e,t[a]),t[a],n+0),n+=4}(e,a);else{if(a.constructor!==Object)throw"whoops";i.setUint32(r,i.offs,e.littleEndian),S(e,a)}}function v(e,t){return""==e?1:""==t?-1:e.localeCompare(t)}function w(e,t){const a=e.stream;g(e,194,t.length-1);let r=4;for(let e=0;e<t.length;e++)r+=4;for(let n=0;n<t.length;n++)a.writeUint32(r,e.littleEndian),r+=t[n].length+1;for(let e=0;e<t.length;e++)a.writeString(t[e]+"\0")}t.write=function(e,t=1,a){const r=new p,o=i[t].magics;void 0!==a?s.assert(o.includes(a)):a=o[o.length-1],s.assert(4===a.length);const l="YB"==a.slice(0,2)?0:1,c=new Set([""]),h=new Set([""]);!function e(t,a,r){if(!(null==t||"number"==typeof t||"boolean"==typeof t||t instanceof Float32Array||t instanceof n.default))if("string"==typeof t)r.add(t);else if(t instanceof Array)for(let n=0;n<t.length;n++)e(t[n],a,r);else{if(t.constructor!==Object)throw"whoops";{const n=Object.keys(t);for(let e=0;e<n.length;e++)a.add(n[e]);for(let s=0;s<n.length;s++)e(t[n[s]],a,r)}}}(e,c,h);const d=[...c.keys()],u=[...h.keys()];d.sort(v),u.sort(v);const m=new f(r,t,l,d,u);r.setString(0,a),r.seekTo(16);const A=r.offs;r.setUint32(4,A,m.littleEndian),w(m,d),r.align(4);const g=r.offs;r.setUint32(8,g,m.littleEndian),w(m,u),r.align(4);const _=r.offs;return r.setUint32(12,_,m.littleEndian),S(m,e),r.finalize()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(0),s=a(61);t.fGlobals=class{constructor(e){this.f_pc_profiles=e,this.dtQueue=[],this.ctQueue=[],this.lyNextID=1,this.lyRoot=new u(0),this.lyCurr=this.lyRoot,this.liQueue=n.nArray(16,()=>[]),this.dwQueue=n.nArray(1e3,()=>[]),this.process_id=1,this.f_pc_constructors=[],this.f_pc_fallbackConstructor=null}delete(e){for(let e=0;e<this.liQueue.length;e++)for(let t=0;t<this.liQueue[e].length;t++)l(this,this.liQueue[e][t]);o(this,e)}};class i{constructor(e){this.mtd=e,this.step=0}Complete(){return this.mtd=null,3}Next(){return this.step++,this.step>=this.mtd.length?this.Complete():2}Do(e,t,a){if(null===this.mtd)return this.Complete();const r=this.mtd[this.step](e,t,a);return 3===r?this.Complete():2===r?this.Next():r}}function o(e,t){for(let a=0;a<e.dtQueue.length;a++){const r=e.dtQueue[a];p(e,r.ly),n.arrayRemove(e.liQueue[r.pi.listID],r),r.delete(t)}e.dtQueue.length=0}function l(e,t){!function(e,t){e.dtQueue.push(t),n.arrayRemove(t.ly.pcQueue,t)}(e,t)}class c{constructor(e,t,a,r,n){this.layer=e,this.pcId=t,this.constructor=a,this.profileBinary=r,this.userData=n,this.phase=new i([this.CreateProcess,this.SubCreateProcess,this.ChildrenLoading]),this.process=null}Handle(e,t){for(;;){const a=this.phase.Do(e,t,this);if(2!==a)return a}}CreateProcess(e,t,a){const r=a;return r.process=new r.constructor(e,r.pcId,r.profileBinary.createDataView()),2}SubCreateProcess(e,t,a){const r=a,n=r.process;return p(e,r.layer),n.load(t,r.userData)}ChildrenLoading(e,t,a){const r=a;return r.process instanceof _&&r.process.layer.creatingCount>0?1:2}}function h(e,t){let a=!1;for(let r=0;r<e.ctQueue.length;r++){const n=e.ctQueue[r],s=n.Handle(e,t);let i=!1;3===s?(f(e,n.process),i=!0):4===s?(console.error("Had error loading"),i=!0):1===s&&(a=!0),i&&(e.ctQueue.splice(r--,1),n.layer.creatingCount--)}return a}function d(e,t,a,r){const s=function(e,t){const a=e.f_pc_constructors[t];return void 0!==a?a:e.f_pc_fallbackConstructor}(e,a);if(null===s)return!1;null===t&&(t=m(e));const i=function(e,t){return n.assertExists(e.f_pc_profiles.Profiles[t])}(e,a),o=function(e){return e.process_id++}(e);return function(e,t){t.layer.creatingCount++,e.ctQueue.push(t)}(e,new c(t,o,s,i,r)),!0}t.fpcCt_Handler=h,t.fpcSCtRq_Request=d;class u{constructor(e){this.layerID=e,this.pcQueue=[],this.creatingCount=0}}function m(e){return e.lyCurr}function p(e,t){e.lyCurr=t}function f(e,t){t.ly=function(e,t){if(4294967293===t)return e.lyCurr;if(0===t)return e.lyRoot;throw"whoops"}(e,t.pi.layerID),t.ly.pcQueue.push(t),e.liQueue[t.pi.listID].push(t)}t.fpcLy_CurrentLayer=m,t.fpcLy_SetCurrentLayer=p;class A{constructor(){this.layerID=-1,this.listID=-1,this.listIndex=-1}}class g{constructor(e,t,a){this.processId=t,this.pi=new A,this.pi.layerID=a.getUint32(0),this.pi.listID=a.getUint16(4),this.pi.listIndex=a.getUint16(6),this.processName=a.getUint16(8),this.parameters=a.getUint32(24)}load(e,t){return 3}execute(e,t){}delete(e){}}t.base_process_class=g,t.fpcPf__Register=function(e,t,a){n.assert(void 0===e.f_pc_constructors[t]),e.f_pc_constructors[t]=a},t.fpcPf__RegisterFallback=function(e,t){e.f_pc_fallbackConstructor=t};class _ extends g{constructor(e,t,a){super(e,t,a),this.visible=!0,this.layer=new u(e.lyNextID++)}draw(e,t,a){p(e.frameworkGlobals,this.layer)}}class S extends g{constructor(e,t,a){super(e,t,a),this.visible=!0,this.drawPriority=a.getUint16(32)}draw(e,t,a){}}function b(e,t,a){e.dwQueue[a].push(t)}function v(e,t,a){n.arrayRemove(e.dwQueue[a],t)}t.fpcM_Management=function(e,t,a,r){o(e,t),h(e,t),function(e,t,a){for(let r=0;r<e.liQueue.length;r++)for(let n=0;n<e.liQueue[r].length;n++){p(e,e.liQueue[r][n].ly),e.liQueue[r][n].execute(t,a)}}(e,t,r.deltaTime/1e3*30),function(e,t,a,r){for(let n=0;n<e.lyRoot.pcQueue.length;n++){const s=e.lyRoot.pcQueue[n];if(s instanceof S||s instanceof _){if(!s.visible)continue;p(e,s.ly),s.draw(t,a,r)}}}(e,t,a,r)},t.fopDw_Draw=function(e,t,a,r){for(let n=0;n<e.dwQueue.length;n++)for(let s=0;s<e.dwQueue[n].length;s++){const i=e.dwQueue[n][s];i.visible&&(p(e,i.ly),e.dwQueue[n][s].draw(t,a,r))}};t.fopScn=class extends _{};t.fopAc_ac_c=class extends S{constructor(){super(...arguments),this.pos=r.vec3.create(),this.rot=r.vec3.create(),this.scale=r.vec3.fromValues(1,1,1),this.parentPcId=4294967295,this.subtype=255,this.roomNo=-1,this.tevStr=new s.dKy_tevstr_c,this.roomLayer=-1,this.loadInit=!1}load(e,t){this.loadInit||(this.loadInit=!0,null!==t&&(null!==t.pos&&r.vec3.copy(this.pos,t.pos),null!==t.rot&&r.vec3.copy(this.rot,t.rot),null!==t.scale&&r.vec3.copy(this.scale,t.scale),this.subtype=t.subtype,this.parentPcId=t.parentPcId,this.parameters=t.parameters,this.roomNo=t.roomNo,this.roomLayer=t.layer),s.dKy_tevstr_init(this.tevStr,this.roomNo));const a=this.subload(e,t);return 2===a&&b(e.frameworkGlobals,this,this.drawPriority),a}delete(e){v(e.frameworkGlobals,this,this.drawPriority)}subload(e,t){return 2}},t.fopAcM_create=function(e,t,a,r,n,s,i,o,l){return d(e,null,t,{parameters:a,pos:r,roomNo:n,rot:s,scale:i,subtype:o,parentPcId:l,enemyNo:-1,gbaName:0,layer:-1})};function w(e,t,a){return d(e,null,t,a)}t.kankyo_class=class extends S{constructor(){super(...arguments),this.pos=r.vec3.create(),this.scale=r.vec3.create(),this.loadInit=!1}load(e,t){this.loadInit||(this.loadInit=!0,null!==t&&(null!==t.pos&&r.vec3.copy(this.pos,t.pos),null!==t.scale&&r.vec3.copy(this.scale,t.scale),this.parameters=t.parameters));const a=this.subload(e);return 2===a&&b(e.frameworkGlobals,this,this.drawPriority),a}delete(e){v(e.frameworkGlobals,this,this.drawPriority)}subload(e){return 2}},t.fopKyM_Create=w,t.fopKyM_create=function(e,t,a,r,n){return w(e,t,{parameters:a,pos:r,scale:n})},t.fopKyM_Delete=function(e,t){l(e,t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(44),n=a(32);var s,i;!function(e){e[e.MTX_RESTORE=20]="MTX_RESTORE",e[e.COLOR=32]="COLOR",e[e.NORMAL=33]="NORMAL",e[e.TEXCOORD=34]="TEXCOORD",e[e.VTX_16=35]="VTX_16",e[e.VTX_10=36]="VTX_10",e[e.VTX_XY=37]="VTX_XY",e[e.VTX_XZ=38]="VTX_XZ",e[e.VTX_YZ=39]="VTX_YZ",e[e.VTX_DIFF=40]="VTX_DIFF",e[e.DIF_AMB=48]="DIF_AMB",e[e.BEGIN_VTXS=64]="BEGIN_VTXS",e[e.END_VTXS=65]="END_VTXS"}(s||(s={})),function(e){e[e.TRIANGLES=0]="TRIANGLES",e[e.QUADS=1]="QUADS",e[e.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",e[e.QUAD_STRIP=3]="QUAD_STRIP"}(i||(i={})),t.VERTEX_SIZE=13,t.VERTEX_BYTES=t.VERTEX_SIZE*Float32Array.BYTES_PER_ELEMENT;const o=new Uint8Array(3);function l(e){return r.bgr5(o,0,e),{r:o[0],g:o[1],b:o[2]}}function c(e){const t=e.s_startVertexIndex,a=e.vtxs.length-t,r=n.makeTriangleIndexBuffer(function(e){switch(e){case i.TRIANGLES:return 0;case i.TRIANGLE_STRIP:return 1;case i.QUADS:return 3;case i.QUAD_STRIP:return 4}}(e.s_polyType),t,a);for(let t=0;t<r.length;t++)e.indexes.push(r[t])}function h(e,t){switch(t){case 0:return;case s.MTX_RESTORE:return function(e){e.s_mtxId=e.readParam()}(e);case s.COLOR:return function(e){const t=e.readParam();e.s_color=l(t)}(e);case s.NORMAL:return function(e){const t=e.readParam();let a=1023&t,r=t>>10&1023,n=t>>20&1023;a=a<<22>>22,r=r<<22>>22,n=n<<22>>22,a/=1024,r/=1024,n/=1024,e.s_nrm={x:a,y:r,z:n}}(e);case s.TEXCOORD:return function(e){const t=e.readParam();let a=65535&t,r=t>>16;a=a<<16>>16,r=r<<16>>16,a/=16,r/=16,e.s_texCoord={s:a,t:r}}(e);case s.VTX_16:return function(e){const t=e.readParam();let a=65535&t,r=t>>16&65535,n=65535&e.readParam();a=a<<16>>16,r=r<<16>>16,n=n<<16>>16,a/=4096,r/=4096,n/=4096,e.vtx(a,r,n)}(e);case s.VTX_10:return function(e){const t=e.readParam();let a=1023&t,r=t>>10&1023,n=t>>20&1023;a=a<<22>>22,r=r<<22>>22,n=n<<22>>22,a/=64,r/=64,n/=64,e.vtx(a,r,n)}(e);case s.VTX_XY:return function(e){const t=e.readParam();let a=65535&t,r=t>>16&65535;a=a<<16>>16,r=r<<16>>16,a/=4096,r/=4096,e.vtx(a,r,e.s_vtx.z)}(e);case s.VTX_XZ:return function(e){const t=e.readParam();let a=65535&t,r=t>>16&65535;a=a<<16>>16,r=r<<16>>16,a/=4096,r/=4096,e.vtx(a,e.s_vtx.y,r)}(e);case s.VTX_YZ:return function(e){const t=e.readParam();let a=65535&t,r=t>>16&65535;a=a<<16>>16,r=r<<16>>16,a/=4096,r/=4096,e.vtx(e.s_vtx.x,a,r)}(e);case s.VTX_DIFF:return function(e){const t=e.readParam();let a=1023&t,r=t>>10&1023,n=t>>20&1023;a=a<<22>>22,r=r<<22>>22,n=n<<22>>22,a/=4096,r/=4096,n/=4096,a+=e.s_vtx.x,r+=e.s_vtx.y,n+=e.s_vtx.z,e.vtx(a,r,n)}(e);case s.DIF_AMB:return function(e){e.readParam()}(e);case s.BEGIN_VTXS:return function(e){const t=3&e.readParam();e.s_polyType=t,e.s_startVertexIndex=e.vtxs.length}(e);case s.END_VTXS:return c(e);default:console.warn("Missing command",t.toString(16))}}t.bgr5=l;t.Context=class{};class d{constructor(e,t,a){this.posScale=a,this.offs=0,this.s_mtxId=0,this.s_startVertexIndex=0,this.vtxs=[],this.indexes=[],this.drawCalls=[],this.view=e.createDataView(),this.alpha=t.alpha,this.s_color=t.color,this.s_texCoord={s:0,t:0},this.s_nrm={x:0,y:0,z:0}}readParam(){return this.view.getUint32((this.offs+=4)-4,!0)}vtx(e,t,a){this.s_vtx={x:e,y:t,z:a},this.vtxs.push({pos:this.s_vtx,nrm:this.s_nrm,color:this.s_color,uv:this.s_texCoord,mtxId:this.s_mtxId})}makePackedVertexBuffer(){const e=new Float32Array(this.vtxs.length*t.VERTEX_SIZE);for(let a=0;a<this.vtxs.length;a++){const r=this.vtxs[a];e[a*t.VERTEX_SIZE+0]=r.pos.x*this.posScale,e[a*t.VERTEX_SIZE+1]=r.pos.y*this.posScale,e[a*t.VERTEX_SIZE+2]=r.pos.z*this.posScale,e[a*t.VERTEX_SIZE+3]=r.color.r/255,e[a*t.VERTEX_SIZE+4]=r.color.g/255,e[a*t.VERTEX_SIZE+5]=r.color.b/255,e[a*t.VERTEX_SIZE+6]=this.alpha/255,e[a*t.VERTEX_SIZE+7]=r.uv.s,e[a*t.VERTEX_SIZE+8]=r.uv.t,e[a*t.VERTEX_SIZE+9]=r.nrm.x,e[a*t.VERTEX_SIZE+10]=r.nrm.y,e[a*t.VERTEX_SIZE+11]=r.nrm.z,e[a*t.VERTEX_SIZE+12]=r.mtxId}return e}}t.readCmds=function(e,t,a=1){const r=new d(e,t,a);for(;r.offs<e.byteLength;){const e=r.view.getUint8(r.offs++),t=r.view.getUint8(r.offs++),a=r.view.getUint8(r.offs++),n=r.view.getUint8(r.offs++);h(r,e),h(r,t),h(r,a),h(r,n)}const n=r.makePackedVertexBuffer(),s=new Uint16Array(r.indexes);return r.drawCalls.push({startIndex:0,numIndices:s.length}),{packedVertexBuffer:n,indexBuffer:s,drawCalls:r.drawCalls}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(30),s=a(2);function i(e,t){if(0===e)return function(e,t){const a=t.createDataView(),r=a.getUint32(0,!0),n=a.getUint32(4,!0),s=(a.getUint32(8,!0),a.getUint32(12,!0)+1);let i=16;if(1===r){const e=[];for(let t=0;t<n;t++){const t=a.getUint32(i+0,!0),r=a.getFloat32(i+4,!0);i+=8,e.push({time:t,value:r})}return{type:r,frames:e}}if(2===r){const e=[];for(let t=0;t<n;t++){const t=a.getUint32(i+0,!0),r=a.getFloat32(i+4,!0),n=a.getFloat32(i+8,!0),s=a.getFloat32(i+12,!0);i+=16,e.push({time:t,value:r,tangentIn:n,tangentOut:s})}return{type:r,frames:e,timeEnd:s}}throw"whoops"}(0,t);if(1===e)return function(e,t){const a=t.createDataView(),n=a.getUint8(0);r.assert(0===n||1===n);const s=a.getUint8(1);r.assert(1===s);const i=a.getUint16(2,!0);if(1===s){const e=[],t=a.getFloat32(4,!0);let r=a.getFloat32(8,!0),n=12;for(let s=0;s<i;s++){const i=s,o=a.getInt16(n+0,!0)*t-r;n+=2,e.push({time:i,value:o})}return{type:s,frames:e}}throw"whoops"}(0,t);throw"xxx"}function o(e,t){const a=t.createDataView();r.assert("anod"===r.readString(t,0,4,!1));const n=a.getUint16(4,!0),s=a.getUint16(8,!0),o=a.getUint16(10,!0),l=a.getUint16(12,!0),c=a.getUint16(14,!0),h=a.getUint16(16,!0),d=a.getUint16(18,!0),u=a.getUint16(20,!0),m=a.getUint16(22,!0),p=a.getUint16(24,!0);return r.assert(0===a.getUint16(26,!0)),{boneIndex:n,translationX:0!==s?i(e,t.slice(s)):null,translationY:0!==o?i(e,t.slice(o)):null,translationZ:0!==l?i(e,t.slice(l)):null,rotationX:0!==c?i(e,t.slice(c)):null,rotationY:0!==h?i(e,t.slice(h)):null,rotationZ:0!==d?i(e,t.slice(d)):null,scaleX:0!==u?i(e,t.slice(u)):null,scaleY:0!==m?i(e,t.slice(m)):null,scaleZ:0!==p?i(e,t.slice(p)):null}}function l(e,t){const a=e.frames,r=a.findIndex(e=>t<e.time);let s,i;if(r<=0)s=a[a.length-1],i=a[0];else{s=a[r-1],i=a[r]}const o=(l=i.time-s.time,c=e.timeEnd,(l+c)%c);var l,c;return function(e,t,a,r){const s=e.value,i=t.value,o=e.tangentOut*r,l=t.tangentIn*r;return n.getPointHermite(s,i,o,l,a)}(s,i,(t-s.time)/o,o)}function c(e,t){if(1===e.type)return function(e,t){const a=e.frames,r=a.findIndex(e=>t<e.time);if(0===r)return a[0].value;if(r<0)return a[a.length-1].value;const n=a[r-1],i=a[r],o=(t-n.time)/(i.time-n.time);return s.lerp(n.value,i.value,o)}(e,t);if(2===e.type)return l(e,t);throw"whoops"}function h(e,t){if(1===e.type)return function(e,t){const a=e.frames,r=a.findIndex(e=>t<e.time);if(0===r)return a[0].value;if(r<0)return a[a.length-1].value;const n=a[r-1],i=a[r],o=(t-n.time)/(i.time-n.time);return s.lerpAngle(n.value,i.value,o,6.283)}(e,t);if(2===e.type)return l(e,t);throw"whoops"}t.parse=function(e,t){if(0===e)return function(e,t){const a=t.createDataView();r.assert("csab"===r.readString(t,0,4,!1)),a.getUint32(4,!0);const n=a.getUint32(8,!0);r.assert(3===n),r.assert(0===a.getUint32(12,!0)),r.assert(1===a.getUint32(16,!0)),r.assert(24===a.getUint32(20,!0)),r.assert(0===a.getUint32(24,!0)),r.assert(0===a.getUint32(28,!0)),r.assert(0===a.getUint32(32,!0)),r.assert(0===a.getUint32(36,!0));const s=a.getUint32(40,!0)+1,i=a.getUint32(48,!0),l=a.getUint32(52,!0);r.assert(i<=l);const c=new Int16Array(l);let h=56;for(let e=0;e<l;e++)c[e]=a.getInt16(h+0,!0),h+=2;let d=r.align(h,4);const u=[];for(let r=0;r<i;r++){const r=a.getUint32(d+0,!0);u.push(o(e,t.slice(24+r))),d+=4}return{duration:s,loopMode:1,boneToAnimationTable:c,animationNodes:u}}(e,t);if(1===e)return function(e,t){const a=t.createDataView();r.assert("csab"===r.readString(t,0,4,!1)),a.getUint32(4,!0);const n=a.getUint32(8,!0);r.assert(5===n),r.assert(0===a.getUint32(12,!0)),r.assert(1109393408===a.getUint32(16,!0)),r.assert(1109393408===a.getUint32(20,!0)),r.assert(1109393408===a.getUint32(24,!0)),r.assert(1===a.getUint32(28,!0)),r.assert(36===a.getUint32(32,!0)),r.assert(0===a.getUint32(36,!0)),r.assert(0===a.getUint32(40,!0)),r.assert(0===a.getUint32(44,!0)),r.assert(0===a.getUint32(48,!0));const s=a.getUint32(52,!0)+1,i=a.getUint32(60,!0),l=a.getUint32(64,!0);r.assert(i<=l);const c=new Int16Array(l);let h=68;for(let e=0;e<l;e++)c[e]=a.getInt16(h+0,!0),h+=2;let d=r.align(h,4);const u=[];for(let r=0;r<i;r++){const r=a.getUint32(d+0,!0);u.push(o(e,t.slice(36+r))),d+=4}return{duration:s,loopMode:1,boneToAnimationTable:c,animationNodes:u}}(e,t);throw"xxx"},t.calcBoneMatrix=function(e,t,a,n){let i=null;if(null!==a){const e=a.boneToAnimationTable[n.boneId];e>=0&&(i=a.animationNodes[e])}let o=n.scaleX,l=n.scaleY,d=n.scaleZ,u=n.rotationX,m=n.rotationY,p=n.rotationZ,f=n.translationX,A=n.translationY,g=n.translationZ;if(null!==i){const e=function(e,t){const a=e.duration;if(0===e.loopMode)return t>a&&(t=a),t;if(1===e.loopMode){for(;t>a;)t-=a;return t}throw"whoops"}(a,r.assertExists(t).getTimeInFrames());null!==i.scaleX&&(o=c(i.scaleX,e)),null!==i.scaleY&&(l=c(i.scaleY,e)),null!==i.scaleZ&&(d=c(i.scaleZ,e)),null!==i.rotationX&&(u=h(i.rotationX,e)),null!==i.rotationY&&(m=h(i.rotationY,e)),null!==i.rotationZ&&(p=h(i.rotationZ,e)),null!==i.translationX&&(f=c(i.translationX,e)),null!==i.translationY&&(A=c(i.translationY,e)),null!==i.translationZ&&(g=c(i.translationZ,e))}s.computeModelMatrixSRT(e,o,l,d,u,m,p,f,A,g)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(45)),i=r(a(62)),o=r(a(67)),l=r(a(95)),c=a(20),h=n(a(18)),d=a(1),u=a(6),m=a(13),p=a(4),f=a(54),A=a(10),g=a(0),_=a(7),S=a(38),b=a(8),v=a(17),w=a(37),x=a(22);function T(e){const t=e.levels.map(e=>function(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.title=e.name;const a=t.getContext("2d"),r=a.createImageData(t.width,t.height);return r.data.set(e.pixels,0),a.putImageData(r,0,0),t}(e)),a=new Map;return a.set("Format",f.getTextureFormatName(e.format)),{name:e.name,surfaces:t,extraInfo:a}}class y extends A.TextureHolder{loadTexture(e,t){const a=e.createTexture(u.makeTextureDescriptor2D(u.GfxFormat.U8_RGBA_NORM,t.width,t.height,t.levels.length));e.setResourceName(a,t.name);const r=e.createHostAccessPass();return r.uploadTextureData(a,0,t.levels.map(e=>e.pixels)),e.submitPass(r),{gfxTexture:a,viewerTexture:T(t)}}}t.CtrTextureHolder=y;class C extends c.DeviceProgram{constructor(e,t){super(),this.material=e,this.materialHacks=t,this.generateFragmentShader()}generateFloat(e){let t=e.toString();return t.includes(".")||(t+=".0"),t}generateColor(e){return`vec4(${this.generateFloat(e.r)}, ${this.generateFloat(e.g)}, ${this.generateFloat(e.b)}, ${this.generateFloat(e.a)})`}generateAlphaTestCompare(e,t){const a=this.generateFloat(t);switch(e){case u.GfxCompareMode.NEVER:return"false";case u.GfxCompareMode.LESS:return`t_CmbOut.a <  ${a}`;case u.GfxCompareMode.LEQUAL:return`t_CmbOut.a <= ${a}`;case u.GfxCompareMode.EQUAL:return`t_CmbOut.a == ${a}`;case u.GfxCompareMode.NEQUAL:return`t_CmbOut.a != ${a}`;case u.GfxCompareMode.GREATER:return`t_CmbOut.a >  ${a}`;case u.GfxCompareMode.GEQUAL:return`t_CmbOut.a >= ${a}`;case u.GfxCompareMode.ALWAYS:return"true";default:throw"whoops"}}generateTexAccess(e){if(!this.materialHacks.texturesEnabled)return"vec4(0.5, 0.5, 0.5, 1.0)";switch(e){case 0:return"texture(u_Texture[0], v_TexCoord0)";case 1:return"texture(u_Texture[1], v_TexCoord1)";case 2:return"texture(u_Texture[2], v_TexCoord2)";case 3:return console.warn("Accessing procedural texture slot"),"vec4(1.0)"}}generateVertexColorAccess(){return this.materialHacks.vertexColorsEnabled?"v_Color":"vec4(0.5, 0.5, 0.5, 1.0)"}generateTexCombinerSrc(e){switch(e){case 34166:return"t_CmbConstant";case 33984:return this.generateTexAccess(0);case 33985:return this.generateTexAccess(1);case 33986:return this.generateTexAccess(2);case 33987:return this.generateTexAccess(3);case 34168:return"t_CmbOut";case 34169:return"t_CmbOutBuffer";case 34167:return this.generateVertexColorAccess();case 25104:case 25105:return this.generateVertexColorAccess()}}generateTexCombinerOp(e,t){const a=this.generateTexCombinerSrc(e);switch(t){case 768:return`${a}`;case 34176:return`${a}.rrrr`;case 34177:return`${a}.gggg`;case 34178:return`${a}.bbbb`;case 770:return`${a}.aaaa`;case 769:return`(1.0 - ${a}.rgba)`;case 34179:return`(1.0 - ${a}.rrrr)`;case 34180:return`(1.0 - ${a}.gggg)`;case 34181:return`(1.0 - ${a}.bbbb)`;case 771:return`(1.0 - ${a}.aaaa)`}}generateTexCombinerCombine(e){switch(e){case 7681:return"(t_CmbIn0)";case 8448:return"(t_CmbIn0 * t_CmbIn1)";case 260:return"(t_CmbIn0 + t_CmbIn1)";case 34164:return"(t_CmbIn0 + t_CmbIn1 - 0.5)";case 34165:return"(mix(t_CmbIn0, t_CmbIn1, t_CmbIn2))";case 34023:return"(t_CmbIn0 - t_CmbIn1)";case 34478:return"vec4(vec3(4.0 * (dot(t_CmbIn0 - 0.5, t_CmbIn1 - 0.5))), 1.0)";case 34479:return"vec4(4.0 * (dot(t_CmbIn0 - 0.5, t_CmbIn1 - 0.5))))";case 25601:return"((t_CmbIn0 * t_CmbIn1) + t_CmbIn2)";case 25602:return"((t_CmbIn0 + t_CmbIn1) * t_CmbIn2)"}}generateTexCombinerScale(e,t){const a=this.generateTexCombinerCombine(e);switch(t){case 1:return`${a}`;case 2:return`(${a} * 2.0)`;case 4:return`(${a} * 4.0)`}}generateTexCombinerBuffer(e){switch(e){case 34168:return"t_CmbOut";case 34169:return"t_CmbOutBuffer"}}generateTexCombiner(e,t){return`\n    // Texture Combiner Stage ${t}\n    // Constant index ${e.constantIndex}\n    t_CmbConstant = u_ConstantColor[${e.constantIndex}];\n    t_CmbIn0 = vec4(${this.generateTexCombinerOp(e.source0RGB,e.op0RGB)}.rgb, ${this.generateTexCombinerOp(e.source0Alpha,e.op0Alpha)}.a);\n    t_CmbIn1 = vec4(${this.generateTexCombinerOp(e.source1RGB,e.op1RGB)}.rgb, ${this.generateTexCombinerOp(e.source1Alpha,e.op1Alpha)}.a);\n    t_CmbIn2 = vec4(${this.generateTexCombinerOp(e.source2RGB,e.op2RGB)}.rgb, ${this.generateTexCombinerOp(e.source2Alpha,e.op2Alpha)}.a);\n    t_CmbOut = vec4(${this.generateTexCombinerScale(e.combineRGB,e.scaleRGB)}.rgb, ${this.generateTexCombinerScale(e.combineAlpha,e.scaleAlpha)}.a);\n    t_CmbOutBuffer = vec4(${this.generateTexCombinerBuffer(e.bufferInputRGB)}.rgb, ${this.generateTexCombinerBuffer(e.bufferInputRGB)}.a);\n`}generateTextureEnvironment(e){let t=`\n    vec4 t_CmbConstant;\n    vec4 t_CmbIn0, t_CmbIn1, t_CmbIn2;\n    vec4 t_CmbOut, t_CmbOutBuffer;\n\n    t_CmbOutBuffer = clamp(${this.generateColor(e.combinerBufferColor)}, vec4(0.0), vec4(1.0));\n    `;for(let a=0;a<e.textureCombiners.length;a++)t+=this.generateTexCombiner(e.textureCombiners[a],a);return t}generateFragmentShader(){this.frag=`\nprecision mediump float;\n${C.BindingsDefinition}\n\nin vec4 v_Color;\nin vec2 v_TexCoord0;\nin vec2 v_TexCoord1;\nin vec2 v_TexCoord2;\n\nin vec3 v_Lighting;\nin vec3 v_FogColor;\nin vec3 v_Normal;\nin float v_Depth;\n\nvoid main() {\n    ${this.generateTextureEnvironment(this.material.textureEnvironment)}\n\n    if (!(${this.generateAlphaTestCompare(this.material.alphaTestFunction,this.material.alphaTestReference)}))\n        discard;\n\n    vec4 t_ResultColor = t_CmbOut;\n\n    #ifdef USE_VERTEX_NORMAL\n        t_ResultColor.rgba = vec4((v_Normal * 0.5 + 0.5), 1.0);\n    #endif\n\n    #ifdef USE_UV\n        t_ResultColor.rgba = vec4(v_TexCoord0.xy, 1.0, 1.0);\n    #endif\n\n    gl_FragColor = t_ResultColor;\n\n    gl_FragDepth = gl_FragCoord.z + u_DepthOffset;\n}\n`}}C.ub_SceneParams=0,C.ub_MaterialParams=1,C.ub_PrmParams=2,C.a_Position=0,C.a_Normal=1,C.a_Color=3,C.a_TexCoord0=4,C.a_TexCoord1=5,C.a_TexCoord2=6,C.a_BoneIndices=7,C.a_BoneWeights=8,C.BindingsDefinition="\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n};\n\n// Expected to change with each material.\nlayout(row_major, std140) uniform ub_MaterialParams {\n    vec4 u_ConstantColor[6];\n    Mat4x3 u_TexMtx[3];\n    vec4 u_MatMisc[1];\n};\n\n// xyz are used by GenerateTextureCoord\n#define u_DepthOffset      (u_MatMisc[0].w)\n\nlayout(row_major, std140) uniform ub_PrmParams {\n    Mat4x3 u_BoneMatrix[16];\n    Mat4x3 u_ViewMatrix;\n    vec4 u_PrmMisc[2];\n};\n\n#define u_PosScale        (u_PrmMisc[0].x)\n#define u_TexCoord0Scale  (u_PrmMisc[0].y)\n#define u_TexCoord1Scale  (u_PrmMisc[0].z)\n#define u_TexCoord2Scale  (u_PrmMisc[0].w)\n#define u_BoneWeightScale (u_PrmMisc[1].x)\n#define u_BoneDimension   (u_PrmMisc[1].y)\n#define u_UseVertexColor  (u_PrmMisc[1].z)\n\nuniform sampler2D u_Texture[3];\n";class M extends C{constructor(e,t){super(e,t),this.vert=`\nprecision mediump float;\n${C.BindingsDefinition}\n\nlayout(location = ${C.a_Position}) in vec3 a_Position;\nlayout(location = ${C.a_Normal}) in vec3 a_Normal;\nlayout(location = ${C.a_Color}) in vec4 a_Color;\nlayout(location = ${C.a_TexCoord0}) in vec2 a_TexCoord0;\nlayout(location = ${C.a_TexCoord1}) in vec2 a_TexCoord1;\nlayout(location = ${C.a_TexCoord2}) in vec2 a_TexCoord2;\nlayout(location = ${C.a_BoneIndices}) in vec4 a_BoneIndices;\nlayout(location = ${C.a_BoneWeights}) in vec4 a_BoneWeights;\n\nout vec4 v_Color;\nout vec2 v_TexCoord0;\nout vec2 v_TexCoord1;\nout vec2 v_TexCoord2;\n\nout vec3 v_FogColor;\nout vec3 v_Normal;\nout float v_Depth;\nout float v_DrawDistance;\nout float v_FogStart;\n\nvec3 Monochrome(vec3 t_Color) {\n    // NTSC primaries.\n    return vec3(dot(t_Color.rgb, vec3(0.299, 0.587, 0.114)));\n}\n\nivec4 UnpackParams(float t_Param) {\n    int t_Int = int(t_Param);\n    ivec4 t_Params;\n    t_Params.x = (t_Int >> 12) & 0x0F;\n    t_Params.y = (t_Int >>  8) & 0x0F;\n    t_Params.z = (t_Int >>  4) & 0x0F;\n    t_Params.w = (t_Int >>  0) & 0x0F;\n    return t_Params;\n}\n\nvec2 CalcTextureSrc(in int t_TexSrcIdx) {\n    if (t_TexSrcIdx == 0)\n        return a_TexCoord0 * u_TexCoord0Scale;\n    else if (t_TexSrcIdx == 1)\n        return a_TexCoord1 * u_TexCoord1Scale;\n    else if (t_TexSrcIdx == 2)\n        return a_TexCoord2 * u_TexCoord2Scale;\n    else\n        // Should not be possible.\n        return vec2(0.0, 0.0);\n}\n\nvec2 CalcTextureCoordRaw(in int t_Idx) {\n    ivec4 t_Params = UnpackParams(u_MatMisc[0][t_Idx]);\n    int t_MappingMode = t_Params.x;\n\n    if (t_MappingMode == 0) {\n        // No mapping, should be illegal.\n        return vec2(0.0, 0.0);\n    } else if (t_MappingMode == 1) {\n        // UV mapping.\n        vec2 t_TexSrc = CalcTextureSrc(t_Params.y);\n        return Mul(u_TexMtx[t_Idx], vec4(t_TexSrc, 0.0, 1.0)).st;\n    } else if (t_MappingMode == 2) {\n        // Cube env mapping.\n        // Not implemented yet.\n        return vec2(0.0, 0.0);\n    } else if (t_MappingMode == 3) {\n        // Sphere env mapping.\n        // Convert view-space normal to proper place.\n        vec2 t_TexSrc = (v_Normal.xy * 0.5) + 0.5;\n        return Mul(u_TexMtx[t_Idx], vec4(t_TexSrc, 0.0, 1.0)).st;\n    } else if (t_MappingMode == 4) {\n        // Projection mapping.\n        // Not implemented yet.\n        return vec2(0.0, 0.0);\n    } else {\n        // Should not be possible.\n        return vec2(0.0, 0.0);\n    }\n}\n\nvec2 CalcTextureCoord(in int t_Idx) {\n    vec2 t_Coords = CalcTextureCoordRaw(t_Idx);\n    t_Coords.t = 1.0 - t_Coords.t;\n    return t_Coords;\n}\n\nvoid main() {\n    // Compute our matrix.\n    Mat4x3 t_BoneMatrix;\n\n    vec4 t_BoneWeights = a_BoneWeights * u_BoneWeightScale;\n\n    // Mask off bone dimension.\n    if (u_BoneDimension < 4.0)\n        t_BoneWeights.w = 0.0;\n    if (u_BoneDimension < 3.0)\n        t_BoneWeights.z = 0.0;\n    if (u_BoneDimension < 2.0)\n        t_BoneWeights.y = 0.0;\n    if (u_BoneDimension < 1.0)\n        t_BoneWeights.x = 0.0;\n\n    if ((t_BoneWeights.x + t_BoneWeights.y + t_BoneWeights.z + t_BoneWeights.w) > 0.0) {\n        t_BoneMatrix = _Mat4x3(0.0);\n\n        Fma(t_BoneMatrix, u_BoneMatrix[int(a_BoneIndices.x)], t_BoneWeights.x);\n        Fma(t_BoneMatrix, u_BoneMatrix[int(a_BoneIndices.y)], t_BoneWeights.y);\n        Fma(t_BoneMatrix, u_BoneMatrix[int(a_BoneIndices.z)], t_BoneWeights.z);\n        Fma(t_BoneMatrix, u_BoneMatrix[int(a_BoneIndices.w)], t_BoneWeights.w);\n    } else {\n        // If we have no bone weights, then we're in rigid skinning, so take the first bone index.\n        // If we're single-bone, then our bone indices will be 0, so this also works for that.\n        t_BoneMatrix = u_BoneMatrix[int(a_BoneIndices.x)];\n    }\n\n    vec4 t_LocalPosition = vec4(a_Position * u_PosScale, 1.0);\n    vec4 t_ModelPosition = Mul(_Mat4x4(t_BoneMatrix), t_LocalPosition);\n    vec4 t_ViewPosition = Mul(_Mat4x4(u_ViewMatrix), t_ModelPosition);\n    gl_Position = Mul(u_Projection, t_ViewPosition);\n\n    // TODO(jstpierre): Use a separate normal matrix to determine the view-space normal.\n    vec3 t_ModelNormal = Mul(_Mat4x4(t_BoneMatrix), vec4(a_Normal, 0.0)).xyz;\n    v_Normal = normalize(Mul(_Mat4x4(u_ViewMatrix), vec4(t_ModelNormal, 0.0)).xyz);\n\n    if (u_UseVertexColor > 0.0)\n        v_Color = a_Color;\n    else\n        v_Color = vec4(1.0);\n\n    v_Depth = gl_Position.w;\n\n#ifdef USE_MONOCHROME_VERTEX_COLOR\n    v_Color.rgb = Monochrome(v_Color.rgb);\n#endif\n\n    v_Color.rgb *= VERTEX_COLOR_SCALE;\n\n    v_TexCoord0 = CalcTextureCoord(0);\n    v_TexCoord1 = CalcTextureCoord(1);\n    v_TexCoord2 = CalcTextureCoord(2);\n}\n`}}t.fillSceneParamsDataOnTemplate=function(e,t){let a=e.allocateUniformBuffer(C.ub_SceneParams,16);const r=e.mapUniformBufferF32(C.ub_SceneParams);a+=m.fillMatrix4x4(r,a,t.projectionMatrix)};const U=d.mat4.create(),k=d.vec4.create(),D=p.colorNewFromRGBA(0,0,0,1);class I{constructor(e,t,a){this.cmb=t,this.material=a,this.textureMappings=g.nArray(3,()=>new A.TextureMapping),this.gfxSamplers=[],this.colorAnimators=[],this.srtAnimators=[],this.texturePaletteAnimators=[],this.constantColors=[],this.visible=!0,this.texturesEnabled=!0,this.vertexColorsEnabled=!0,this.monochromeVertexColorsEnabled=!1,this.vertexNormalsEnabled=!1,this.uvEnabled=!1,this.vertexColorScale=1,this.program=null,this.gfxProgram=null,this.environmentSettings=new l.ZSIEnvironmentSettings;for(let e=0;e<this.material.constantColors.length;e++)this.constantColors[e]=p.colorNewCopy(this.material.constantColors[e]);for(let t=0;t<this.material.textureBindings.length;t++){const a=this.material.textureBindings[t];if(a.textureIdx<0)continue;const[r,n]=this.translateTextureFilter(a.minFilter),[s]=this.translateTextureFilter(a.magFilter),i=e.createSampler({wrapS:this.translateWrapMode(a.wrapS),wrapT:this.translateWrapMode(a.wrapT),magFilter:s,minFilter:r,mipFilter:n,minLOD:0,maxLOD:100});this.gfxSamplers.push(i),this.textureMappings[t].gfxSampler=i}this.createProgram()}setVertexColorsEnabled(e){this.vertexColorsEnabled=e,this.createProgram()}setTexturesEnabled(e){this.texturesEnabled=e,this.createProgram()}setMonochromeVertexColorsEnabled(e){this.monochromeVertexColorsEnabled=e,this.createProgram()}setVertexNormalsEnabled(e){this.vertexNormalsEnabled=e,this.createProgram()}setUVEnabled(e){this.uvEnabled=e,this.createProgram()}setEnvironmentSettings(e){this.environmentSettings.copy(e),this.createProgram()}setVertexColorScale(e){this.vertexColorScale=e,this.createProgram()}createProgram(){const e=new M(this.material,this);this.monochromeVertexColorsEnabled&&e.defines.set("USE_MONOCHROME_VERTEX_COLOR","1"),this.vertexNormalsEnabled&&e.defines.set("USE_VERTEX_NORMAL","1"),this.uvEnabled&&e.defines.set("USE_UV","1"),e.defines.set("VERTEX_COLOR_SCALE",e.generateFloat(this.vertexColorScale)),this.program=e,this.gfxProgram=null}calcTexMtx(e,t,a){this.srtAnimators[t]?(this.srtAnimators[t].calcTexMtx(e),d.mat4.mul(e,e,a.textureMatrix)):d.mat4.copy(e,a.textureMatrix)}packTexCoordParams(e){return e.mappingMethod<<12|e.sourceCoordinate<<8}setOnRenderInst(e,t,a,r){let n=a.allocateUniformBuffer(C.ub_MaterialParams,64);const s=this.material.isTransparent?128:32;a.sortKey=_.makeSortKey(s),a.setMegaStateFlags(this.material.renderFlags),null===this.gfxProgram&&(this.gfxProgram=t.createProgram(e,this.program)),a.setGfxProgram(this.gfxProgram);const i=a.mapUniformBufferF32(C.ub_MaterialParams);for(let e=0;e<6;e++)this.colorAnimators[e]?this.colorAnimators[e].calcColor(D):p.colorCopy(D,this.constantColors[e]),n+=m.fillColor(i,n,D);for(let e=0;e<3;e++){const t=this.material.textureBindings[e];if(t.textureIdx>=0){if(this.texturePaletteAnimators[e])this.texturePaletteAnimators[e].fillTextureMapping(r,this.textureMappings[e]);else{const a=this.cmb.textures[t.textureIdx];r.fillTextureMapping(this.textureMappings[e],a.name)}k[e]=this.packTexCoordParams(this.material.textureCoordinators[e]),this.calcTexMtx(U,e,this.material.textureCoordinators[e])}else k[e]=0,d.mat4.identity(U);n+=m.fillMatrix4x3(i,n,U)}const o=x.reverseDepthForDepthOffset(this.material.polygonOffset);k[3]=o,n+=m.fillVec4v(i,n,k),a.setSamplerBindingsFromTextureMappings(this.textureMappings)}bindCMAB(e,t){for(let a=0;a<e.animEntries.length;a++){const r=e.animEntries[a];r.materialIndex===this.material.index&&(1===r.animationType||5===r.animationType?this.srtAnimators[r.channelIndex]=new i.TextureSRTAnimator(t,e,r):4===r.animationType?this.colorAnimators[r.channelIndex]=new i.ColorAnimator(t,e,r):2===r.animationType&&(this.texturePaletteAnimators[r.channelIndex]=new i.TexturePaletteAnimator(t,e,r)))}}translateWrapMode(e){switch(e){case s.TextureWrapMode.CLAMP:case s.TextureWrapMode.CLAMP_TO_EDGE:return 0;case s.TextureWrapMode.REPEAT:return 1;case s.TextureWrapMode.MIRRORED_REPEAT:return 2;default:throw new Error}}translateTextureFilter(e){switch(e){case s.TextureFilter.LINEAR:case s.TextureFilter.NEAREST:return[1,0];case s.TextureFilter.LINEAR_MIPMAP_LINEAR:return[1,2];case s.TextureFilter.LINEAR_MIPMAP_NEAREST:return[1,1];case s.TextureFilter.NEAREST_MIPMAP_LINEAR:return[0,2];case s.TextureFilter.NEAREST_MIPMAP_NEAREST:return[0,1];default:throw new Error}}destroy(e){for(let t=0;t<this.gfxSamplers.length;t++)e.destroySampler(this.gfxSamplers[t])}}class R{constructor(e,t){this.prms=e,this.indexBufferOffset=t}}class B{constructor(e,t,a,r,n){this.sepd=n,this.perInstanceBuffer=null,this.useVertexColor=!1,this.prmsData=[];const i=[],o=new Float32Array(32);let l=0;const c=(e,t,a,r,n)=>{const c=function(e,t,a){const r=function(e){switch(e){case s.DataType.UByte:return 1;case s.DataType.UShort:return 2;case s.DataType.UInt:return 3;case s.DataType.Byte:return 4;case s.DataType.Short:return 5;case s.DataType.Int:return 6;case s.DataType.Float:return 8}}(e),n=t,i=a?1:0;return S.makeFormat(r,n,i)}(n.dataType,t,a);0===n.mode&&r>=0?i.push({location:e,format:c,bufferIndex:1+e,bufferByteOffset:n.start}):(i.push({location:e,format:c,bufferIndex:0,bufferByteOffset:4*l}),o.set(n.constant,l),l+=4)};c(C.a_Position,3,!1,r.positionByteOffset,n.position),c(C.a_Normal,3,!0,r.normalByteOffset,n.normal),this.useVertexColor=r.colorByteOffset>=0,c(C.a_Color,4,!0,r.colorByteOffset,n.color),c(C.a_TexCoord0,2,!1,r.texCoord0ByteOffset,n.texCoord0),c(C.a_TexCoord1,2,!1,r.texCoord1ByteOffset,n.texCoord1),c(C.a_TexCoord2,2,!1,r.texCoord2ByteOffset,n.texCoord2);const h=0!==n.prms[0].skinningMode&&n.boneIndices.dataType===s.DataType.UByte;c(C.a_BoneIndices,n.boneDimension,!1,h?r.boneIndicesByteOffset:-1,n.boneIndices);const d=2===n.prms[0].skinningMode;c(C.a_BoneWeights,n.boneDimension,!1,d?r.boneWeightsByteOffset:-1,n.boneWeights);let m=null;0!==l&&(this.perInstanceBuffer=v.makeStaticDataBuffer(e,2,new Uint8Array(o.buffer)),m={buffer:this.perInstanceBuffer,byteOffset:0});let p=0;for(let e=0;e<this.sepd.prms.length;e++){const t=n.prms[e];g.assert(t.prm.indexType===s.DataType.UShort||t.prm.indexType===s.DataType.UByte),p+=t.prm.count}const f=new Uint16Array(p);let A=0;for(let e=0;e<this.sepd.prms.length;e++){const t=n.prms[e];this.prmsData.push(new R(t,A)),t.prm.indexType===s.DataType.UShort?f.set(a.createTypedArray(Uint16Array,t.prm.offset,t.prm.count),A):t.prm.indexType===s.DataType.UByte&&f.set(a.createTypedArray(Uint8Array,t.prm.offset,t.prm.count),A),A+=t.prm.count}this.indexBuffer=v.makeStaticDataBuffer(e,1,f.buffer);const _=u.GfxFormat.U16_R;this.inputLayout=e.createInputLayout({vertexAttributeDescriptors:i,vertexBufferDescriptors:[{byteStride:0,frequency:2},{byteStride:0,frequency:1},{byteStride:0,frequency:1},null,{byteStride:0,frequency:1},{byteStride:0,frequency:1},{byteStride:0,frequency:1},{byteStride:0,frequency:1},{byteStride:0,frequency:1},{byteStride:0,frequency:1}],indexBufferFormat:_}),this.inputState=e.createInputState(this.inputLayout,[m,{buffer:t,byteOffset:r.positionByteOffset},{buffer:t,byteOffset:r.normalByteOffset},null,{buffer:t,byteOffset:r.colorByteOffset},{buffer:t,byteOffset:r.texCoord0ByteOffset},{buffer:t,byteOffset:r.texCoord1ByteOffset},{buffer:t,byteOffset:r.texCoord2ByteOffset},{buffer:t,byteOffset:r.boneIndicesByteOffset},{buffer:t,byteOffset:r.boneWeightsByteOffset}],{buffer:this.indexBuffer,byteOffset:0})}destroy(e){e.destroyBuffer(this.indexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState),null!==this.perInstanceBuffer&&e.destroyBuffer(this.perInstanceBuffer)}}class P{constructor(e,t){this.sepdData=e,this.materialInstance=t,this.visible=!0}prepareToRender(e,t,a,r,n,s){if(!this.visible||!this.materialInstance.visible)return;const i=this.sepdData.sepd,o=t.pushTemplateRenderInst();o.setInputLayoutAndState(this.sepdData.inputLayout,this.sepdData.inputState),this.materialInstance.setOnRenderInst(e,t.gfxRenderCache,o,a);for(let e=0;e<this.sepdData.sepd.prms.length;e++){const a=this.sepdData.prmsData[e],o=a.prms,l=t.pushRenderInst();l.drawIndexes(o.prm.count,a.indexBufferOffset);let c=l.allocateUniformBuffer(C.ub_PrmParams,212);const h=l.mapUniformBufferF32(C.ub_PrmParams);for(let e=0;e<16;e++){if(e<o.boneTable.length){const t=o.boneTable[e];2===o.skinningMode?d.mat4.mul(U,r[t],s[t]):d.mat4.copy(U,r[t])}else d.mat4.identity(U);c+=m.fillMatrix4x3(h,c,U)}c+=m.fillMatrix4x3(h,c,n),c+=m.fillVec4(h,c,i.position.scale,i.texCoord0.scale,i.texCoord1.scale,i.texCoord2.scale),c+=m.fillVec4(h,c,i.boneWeights.scale,i.boneDimension,this.sepdData.useVertexColor?1:0)}t.popTemplateRenderInst()}destroy(e){}}class E{constructor(e,t){this.cmb=t,this.sepdData=[],this.inverseBindPoseMatrices=[],this.vertexBuffer=v.makeStaticDataBufferFromSlice(e,2,t.vatrChunk.dataBuffer);const a=t.vatrChunk;for(let r=0;r<this.cmb.sepds.length;r++)this.sepdData[r]=new B(e,this.vertexBuffer,t.indexBuffer,a,this.cmb.sepds[r]);const r=g.nArray(t.bones.length,()=>d.mat4.create());for(let e=0;e<t.bones.length;e++){const a=t.bones[e];o.calcBoneMatrix(r[e],null,null,a),a.parentBoneId>=0&&d.mat4.mul(r[e],r[a.parentBoneId],r[e])}this.inverseBindPoseMatrices=g.nArray(t.bones.length,()=>d.mat4.create());for(let e=0;e<t.bones.length;e++)d.mat4.invert(this.inverseBindPoseMatrices[e],r[e])}destroy(e){for(let t=0;t<this.sepdData.length;t++)this.sepdData[t].destroy(e);e.destroyBuffer(this.vertexBuffer)}}t.CmbData=E;const F=d.vec3.create(),V=d.vec3.create(),O=d.mat4.create();class N{constructor(e,t,a,r=""){this.textureHolder=t,this.cmbData=a,this.name=r,this.animationController=new h.default,this.visible=!0,this.materialInstances=[],this.shapeInstances=[],this.csab=null,this.debugBones=!1,this.boneMatrices=[],this.modelMatrix=d.mat4.create(),this.isSkybox=!1,this.passMask=1;for(let t=0;t<this.cmbData.cmb.materials.length;t++)this.materialInstances.push(new I(e,this.cmbData.cmb,this.cmbData.cmb.materials[t]));for(let e=0;e<this.cmbData.cmb.meshs.length;e++){const t=this.cmbData.cmb.meshs[e];this.shapeInstances.push(new P(this.cmbData.sepdData[t.sepdIdx],this.materialInstances[t.matsIdx]))}this.boneMatrices=g.nArray(this.cmbData.cmb.bones.length,()=>d.mat4.create()),this.updateBoneMatrices()}setConstantColor(e,t){for(let a=0;a<this.materialInstances.length;a++)p.colorCopy(this.materialInstances[a].constantColors[e],t)}setVertexColorsEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setVertexColorsEnabled(e)}setTexturesEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setTexturesEnabled(e)}setMonochromeVertexColorsEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setMonochromeVertexColorsEnabled(e)}setVertexNormalsEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setVertexNormalsEnabled(e)}setUVEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setUVEnabled(e)}setEnvironmentSettings(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setEnvironmentSettings(e)}setVertexColorScale(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setVertexColorScale(e)}updateBoneMatrices(){for(let e=0;e<this.cmbData.cmb.bones.length;e++){const t=this.cmbData.cmb.bones[e];o.calcBoneMatrix(this.boneMatrices[t.boneId],this.animationController,this.csab,t);const a=t.parentBoneId>=0?this.boneMatrices[t.parentBoneId]:this.modelMatrix;d.mat4.mul(this.boneMatrices[t.boneId],a,this.boneMatrices[t.boneId])}}computeViewMatrix(e,t){this.isSkybox?b.computeViewMatrixSkybox(e,t.camera):b.computeViewMatrix(e,t.camera)}prepareToRender(e,t,a,r){if(!this.visible)return;if(this.animationController.setTimeInMilliseconds(r.time),this.computeViewMatrix(O,r),this.updateBoneMatrices(),this.debugBones){const e=w.getDebugOverlayCanvas2D();for(let t=0;t<this.cmbData.cmb.bones.length;t++){const a=this.cmbData.cmb.bones[t];a.parentBoneId<0||(d.vec3.set(F,0,0,0),d.vec3.transformMat4(F,F,this.boneMatrices[a.parentBoneId]),d.vec3.set(V,0,0,0),d.vec3.transformMat4(V,V,this.boneMatrices[a.boneId]),w.drawWorldSpaceLine(e,r.camera,F,V))}}t.pushTemplateRenderInst().filterKey=this.passMask;for(let a=0;a<this.shapeInstances.length;a++)this.shapeInstances[a].prepareToRender(e,t,this.textureHolder,this.boneMatrices,O,this.cmbData.inverseBindPoseMatrices);t.popTemplateRenderInst()}setVisible(e){this.visible=e}destroy(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].destroy(e);for(let t=0;t<this.shapeInstances.length;t++)this.shapeInstances[t].destroy(e)}bindCSAB(e){this.csab=e}bindCMAB(e,t=this.animationController){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].bindCMAB(e,t)}}t.CmbInstance=N;t.RoomRenderer=class{constructor(e,t,a,r){this.textureHolder=t,this.mesh=a,this.name=r,this.visible=!0,this.opaqueData=null,this.opaqueMesh=null,this.transparentData=null,this.transparentMesh=null,this.objectRenderers=[],this.roomSetups=[],null!==a.opaque&&(t.addTextures(e,a.opaque.textures),this.opaqueData=new E(e,a.opaque),this.opaqueMesh=new N(e,t,this.opaqueData,`${r} Opaque`),this.opaqueMesh.animationController.fps=20,this.opaqueMesh.setConstantColor(1,p.TransparentBlack)),null!==a.transparent&&(t.addTextures(e,a.transparent.textures),this.transparentData=new E(e,a.transparent),this.transparentMesh=new N(e,t,this.transparentData,`${r} Transparent`),this.transparentMesh.animationController.fps=20,this.transparentMesh.setConstantColor(1,p.TransparentBlack))}bindCMAB(e){null!==this.opaqueMesh&&this.opaqueMesh.bindCMAB(e),null!==this.transparentMesh&&this.transparentMesh.bindCMAB(e)}setVisible(e){null!==this.opaqueMesh&&this.opaqueMesh.setVisible(e),null!==this.transparentMesh&&this.transparentMesh.setVisible(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].setVisible(e)}setVertexColorsEnabled(e){null!==this.opaqueMesh&&this.opaqueMesh.setVertexColorsEnabled(e),null!==this.transparentMesh&&this.transparentMesh.setVertexColorsEnabled(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].setVertexColorsEnabled(e)}setTexturesEnabled(e){null!==this.opaqueMesh&&this.opaqueMesh.setTexturesEnabled(e),null!==this.transparentMesh&&this.transparentMesh.setTexturesEnabled(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].setTexturesEnabled(e)}setMonochromeVertexColorsEnabled(e){null!==this.opaqueMesh&&this.opaqueMesh.setMonochromeVertexColorsEnabled(e),null!==this.transparentMesh&&this.transparentMesh.setMonochromeVertexColorsEnabled(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].setMonochromeVertexColorsEnabled(e)}setShowVertexNormals(e){null!==this.opaqueMesh&&this.opaqueMesh.setVertexNormalsEnabled(e),null!==this.transparentMesh&&this.transparentMesh.setVertexNormalsEnabled(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].setVertexNormalsEnabled(e)}setShowTextureCoordinates(e){null!==this.opaqueMesh&&this.opaqueMesh.setUVEnabled(e),null!==this.transparentMesh&&this.transparentMesh.setUVEnabled(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].setUVEnabled(e)}setEnvironmentSettings(e){null!==this.opaqueMesh&&this.opaqueMesh.setEnvironmentSettings(e),null!==this.transparentMesh&&this.transparentMesh.setEnvironmentSettings(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].setEnvironmentSettings(e)}prepareToRender(e,t,a,r){if(this.visible){null!==this.opaqueMesh&&this.opaqueMesh.prepareToRender(e,t,a,r),null!==this.transparentMesh&&this.transparentMesh.prepareToRender(e,t,a,r);for(let n=0;n<this.objectRenderers.length;n++)this.objectRenderers[n].prepareToRender(e,t,a,r)}}destroy(e){null!==this.opaqueData&&this.opaqueData.destroy(e),null!==this.transparentData&&this.transparentData.destroy(e),null!==this.opaqueMesh&&this.opaqueMesh.destroy(e),null!==this.transparentMesh&&this.transparentMesh.destroy(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].destroy(e)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(1),i=a(6),o=r(a(66)),l=a(44),c=a(94),h=a(7),d=a(10),u=a(13),m=a(8),p=n(a(18)),f=a(0),A=a(55),g=a(14);const _=s.mat2d.create();class S{constructor(e,t,a,r){this.model=a,this.material=r,this.textureNames=[],this.gfxTextures=[],this.gfxSampler=null,this.textureMappings=f.nArray(1,()=>new d.TextureMapping),this.viewerTextures=[],this.srt0Animator=null,this.pat0Animator=null,this.baseCtx={color:{r:255,g:255,b:255},alpha:this.material.alpha};const n=this.translateTexture(e,t,this.material.textureName,this.material.paletteName);if(null!==n){this.gfxSampler=e.createSampler({minFilter:0,magFilter:0,mipFilter:0,wrapS:l.parseTexImageParamWrapModeS(this.material.texParams),wrapT:l.parseTexImageParamWrapModeT(this.material.texParams),minLOD:0,maxLOD:100});const t=this.textureMappings[0];t.gfxTexture=this.gfxTextures[0],t.gfxSampler=this.gfxSampler}const s=this.material.alpha<255||null!==n&&l.textureFormatIsTranslucent(n.format),o=!!(this.material.polyAttribs>>>11&1)||!s,c=s?128:32;this.sortKey=h.makeSortKeyOpaque(c,0),this.megaStateFlags={depthWrite:o,cullMode:this.material.cullMode},g.setAttachmentStateSimple(this.megaStateFlags,{blendMode:i.GfxBlendMode.ADD,blendDstFactor:i.GfxBlendFactor.ONE_MINUS_SRC_ALPHA,blendSrcFactor:i.GfxBlendFactor.SRC_ALPHA})}bindSRT0(e,t){this.srt0Animator=A.bindSRT0(e,t,this.material.name)}bindPAT0(e,t){return this.pat0Animator=A.bindPAT0(e,t,this.material.name),null!==this.pat0Animator}translatePAT0Textures(e,t){if(null!==this.pat0Animator){for(;this.gfxTextures.length>1;)e.destroyTexture(this.gfxTextures.pop()),this.textureNames.pop(),this.viewerTextures.pop();for(let a=0;a<this.pat0Animator.matData.animationTrack.length;a++){const{texName:r,plttName:n}=this.pat0Animator.matData.animationTrack[a];this.translateTexture(e,t,r,n)}}}translateTexture(e,t,a,r){if(null===t||null===a)return null;const n=f.assertExists(t.textures.find(e=>e.name===a)),s=null!==r?f.assertExists(t.palettes.find(e=>e.name===r)):null,o=`${a}/${r}`;if(this.textureNames.indexOf(o)>=0)return n;this.textureNames.push(o);const c=Object.assign(Object.assign({},n),{palData:null!==s?s.data:null}),h=l.readTexture(c),d=e.createTexture(i.makeTextureDescriptor2D(i.GfxFormat.U8_RGBA_NORM,n.width,n.height,1));e.setResourceName(d,a),this.gfxTextures.push(d);const u=e.createHostAccessPass();return u.uploadTextureData(d,0,[h]),e.submitPass(u),this.viewerTextures.push(function(e,t,a){const r=document.createElement("canvas");r.width=e.width,r.height=e.height,r.title=a;const n=r.getContext("2d"),s=n.createImageData(r.width,r.height);s.data.set(t),n.putImageData(s,0,0);const i=[r],o=new Map;return o.set("Format",l.getFormatName(e.format)),{name:a,surfaces:i,extraInfo:o}}(n,h,o)),n}setOnRenderInst(e,t){if(null!==this.srt0Animator?this.srt0Animator.calcTexMtx(_,this.model.texMtxMode,this.material.texScaleS,this.material.texScaleT):s.mat2d.copy(_,this.material.texMatrix),e.sortKey=this.sortKey,e.setMegaStateFlags(this.megaStateFlags),null!==this.pat0Animator){const e=this.pat0Animator.calcFullTextureName(),t=this.textureNames.indexOf(e);t>=0&&(this.textureMappings[0].gfxTexture=this.gfxTextures[t])}e.setSamplerBindingsFromTextureMappings(this.textureMappings);let a=e.allocateUniformBuffer(c.NITRO_Program.ub_MaterialParams,12);const r=e.mapUniformBufferF32(c.NITRO_Program.ub_MaterialParams);a+=u.fillMatrix3x2(r,a,_),a+=u.fillVec4(r,a,0)}destroy(e){for(let t=0;t<this.gfxTextures.length;t++)e.destroyTexture(this.gfxTextures[t]);null!==this.gfxSampler&&e.destroySampler(this.gfxSampler)}}class b{constructor(e){this.node=e,this.modelMatrix=s.mat4.create(),this.billboardMode=0}calcMatrix(e){s.mat4.mul(this.modelMatrix,e,this.node.jointMatrix)}}function v(e,t){const a=Math.hypot(t[0],t[1],t[2]),r=Math.hypot(t[4],t[5],t[6]),n=Math.hypot(t[8],t[9],t[10]);e[0]=a,e[4]=0,e[8]=0,e[12]=t[12],e[1]=0,e[5]=r,e[9]=0,e[13]=t[13],e[2]=0,e[6]=0,e[10]=n,e[14]=t[14],e[3]=9999,e[7]=9999,e[11]=9999,e[15]=9999}t.calcBBoardMtx=v;const w=s.vec3.create();function x(e,t,a=w){const r=Math.hypot(t[0],t[1],t[2]),n=Math.hypot(t[8],t[9],t[10]);s.vec3.set(a,0,-t[6],t[5]),s.vec3.normalize(a,a),e[0]=r,e[4]=t[4],e[8]=0,e[12]=t[12],e[1]=0,e[5]=t[5],e[9]=a[1]*n,e[13]=t[13],e[2]=0,e[6]=t[6],e[10]=a[2]*n,e[14]=t[14],t[3]=9999,t[7]=9999,t[11]=9999,t[15]=9999}t.calcYBBoardMtx=x;const T=s.mat4.create();class y{constructor(e,t,a,r,n){this.materialInstance=t,this.node=a,this.shape=r;const s=this.materialInstance.baseCtx,i=o.readCmds(r.dlBuffer,s,n);this.vertexData=new c.VertexData(e,i)}computeModelView(e,t,a){a?m.computeViewMatrixSkybox(e,t.camera):m.computeViewMatrix(e,t.camera),s.mat4.mul(e,e,this.node.modelMatrix),1===this.node.billboardMode?v(e,e):2===this.node.billboardMode&&x(e,e)}prepareToRender(e,t,a){const r=e.pushTemplateRenderInst();r.setInputLayoutAndState(this.vertexData.inputLayout,this.vertexData.inputState);let n=r.allocateUniformBuffer(c.NITRO_Program.ub_PacketParams,384);const s=r.mapUniformBufferF32(c.NITRO_Program.ub_PacketParams);this.computeModelView(T,t,a),n+=u.fillMatrix4x3(s,n,T),this.materialInstance.setOnRenderInst(r,t);for(let t=0;t<this.vertexData.nitroVertexData.drawCalls.length;t++){const a=this.vertexData.nitroVertexData.drawCalls[t];e.pushRenderInst().drawIndexes(a.numIndices,a.startIndex)}e.popTemplateRenderInst()}destroy(e){this.vertexData.destroy(e)}}const C=[{numUniformBuffers:3,numSamplers:1}];t.MDL0Renderer=class{constructor(e,t,a){this.model=t,this.tex0=a,this.modelMatrix=s.mat4.create(),this.isSkybox=!1,this.animationController=new p.default,this.materialInstances=[],this.shapeInstances=[],this.nodes=[],this.viewerTextures=[],this.bbox=null;const r=new c.NITRO_Program;r.defines.set("USE_VERTEX_COLOR","1"),r.defines.set("USE_TEXTURE","1"),this.gfxProgram=e.createProgram(r);s.mat4.fromScaling(this.modelMatrix,[50,50,50]);for(let t=0;t<this.model.materials.length;t++)this.materialInstances.push(new S(e,this.tex0,this.model,this.model.materials[t]));for(let e=0;e<this.model.nodes.length;e++)this.nodes.push(new b(this.model.nodes[e]));for(let e=0;e<this.materialInstances.length;e++)this.materialInstances[e].viewerTextures.length>0&&this.viewerTextures.push(this.materialInstances[e].viewerTextures[0]);this.execSBC(e)}bindSRT0(e,t=this.animationController){for(let a=0;a<this.materialInstances.length;a++)this.materialInstances[a].bindSRT0(t,e)}bindPAT0(e,t,a=this.animationController){for(let r=0;r<this.materialInstances.length;r++)this.materialInstances[r].bindPAT0(a,t)&&this.materialInstances[r].translatePAT0Textures(e,this.tex0)}execSBC(e){const t=this.model,a=t.sbcBuffer.createDataView();let r=0,n=null,s=null;for(;;){const i=a.getUint8(r++),o=31&i,l=(224&i)>>>5;if(0!==o){if(1===o)break;if(2===o){const e=a.getUint8(r++);a.getUint8(r++);n=this.nodes[e]}else if(3===o){a.getUint8(r++)}else if(4===o){const e=a.getUint8(r++);s=this.materialInstances[e]}else if(5===o){const i=a.getUint8(r++),o=t.shapes[i];this.shapeInstances.push(new y(e,f.assertExists(s),f.assertExists(n),o,this.model.posScale))}else if(6===o){a.getUint8(r++),a.getUint8(r++),a.getUint8(r++);let e=-1,t=-1;1&l&&(e=a.getUint8(r++)),2&l&&(t=a.getUint8(r++))}else if(7===o){const e=a.getUint8(r++);let t=-1,n=-1;1&l&&(t=a.getUint8(r++)),2&l&&(n=a.getUint8(r++)),0===l&&(this.nodes[e].billboardMode=1)}else if(8===o){const e=a.getUint8(r++);let t=-1,n=-1;1&l&&(t=a.getUint8(r++)),2&l&&(n=a.getUint8(r++)),0===l&&(this.nodes[e].billboardMode=2)}else if(11!==o)throw new Error(`UNKNOWN SBC ${o.toString(16)}`)}}}prepareToRender(e,t){if(null!==this.bbox&&!t.camera.frustum.contains(this.bbox))return;this.animationController.setTimeInMilliseconds(t.time);for(let e=0;e<this.nodes.length;e++)this.nodes[e].calcMatrix(this.modelMatrix);const a=e.pushTemplateRenderInst();a.setBindingLayouts(C),a.filterKey=this.isSkybox?2:1,a.setGfxProgram(this.gfxProgram);let r=a.allocateUniformBuffer(c.NITRO_Program.ub_SceneParams,16);const n=a.mapUniformBufferF32(c.NITRO_Program.ub_SceneParams);r+=u.fillMatrix4x4(n,r,t.camera.projectionMatrix);for(let a=0;a<this.shapeInstances.length;a++)this.shapeInstances[a].prepareToRender(e,t,this.isSkybox);e.popTemplateRenderInst()}destroy(e){e.destroyProgram(this.gfxProgram);for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].destroy(e);for(let t=0;t<this.shapeInstances.length;t++)this.shapeInstances[t].destroy(e)}}},function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var r=a(24);function n(e,t){return void 0===t&&(t=0),"string"!=typeof e||0===t?e:e.length<=t?e:e.substr(0,t)+"..."}function s(e,t){var a=e,r=a.length;if(r<=150)return a;t>r&&(t=r);var n=Math.max(t-60,0);n<5&&(n=0);var s=Math.min(n+140,r);return s>r-5&&(s=r),s===r&&(n=Math.max(s-140,0)),a=a.slice(n,s),n>0&&(a="'{snip} "+a),s<r&&(a+=" {snip}"),a}function i(e,t){if(!Array.isArray(e))return"";for(var a=[],r=0;r<e.length;r++){var n=e[r];try{a.push(String(n))}catch(e){a.push("[value cannot be serialized]")}}return a.join(t)}function o(e,t){return Object(r.j)(t)?t.test(e):"string"==typeof t&&-1!==e.indexOf(t)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(19),n=Object(r.g)(),s="Sentry Logger ",i=function(){function e(){this._enabled=!1}return e.prototype.disable=function(){this._enabled=!1},e.prototype.enable=function(){this._enabled=!0},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._enabled&&Object(r.c)((function(){n.console.log(s+"[Log]: "+e.join(" "))}))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._enabled&&Object(r.c)((function(){n.console.warn(s+"[Warn]: "+e.join(" "))}))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._enabled&&Object(r.c)((function(){n.console.error(s+"[Error]: "+e.join(" "))}))},e}();n.__SENTRY__=n.__SENTRY__||{};var o=n.__SENTRY__.logger||(n.__SENTRY__.logger=new i)},,function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(11)),i=n(a(130)),o=a(8),l=a(131),c=a(132),h=a(134),d=a(135),u=a(9),m=a(4);function p(e){e.bufferUploadCount=0,e.drawCallCount=0,e.textureBindCount=0,e.triangleCount=0}t.resizeCanvas=function(e,t,a,r){e.setAttribute("style",`width: ${t}px; height: ${a}px;`),e.width=t*r,e.height=a*r};class f{constructor(){this.colorAttachment=new u.ColorAttachment,this.renderPassDescriptor=u.makeClearRenderPassDescriptor(!0,m.OpaqueBlack)}minimize(e){this.colorAttachment.setParameters(e,1,1,1),e.setResourceLeakCheck(this.colorAttachment.gfxAttachment,!1)}render(e,t){this.colorAttachment.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.renderPassDescriptor.colorAttachment=this.colorAttachment.gfxAttachment,this.renderPassDescriptor.colorResolveTo=t.onscreenTexture;const a=e.createRenderPass(this.renderPassDescriptor);return e.submitPass(a),null}destroy(e){this.colorAttachment.destroy(e)}}class A{constructor(e,t){this.gfxSwapChain=e,this.canvas=t,this.cameraController=null,this.xrCameraController=new o.XRCameraController,this.camera=new o.Camera,this.fovY=.785375,this.sceneTime=0,this.rafTime=0,this.sceneTimeScale=1,this.renderStatisticsTracker=new d.RenderStatisticsTracker,this.viewport={x:0,y:0,w:1,h:1},this.scene=null,this.oncamerachanged=()=>{},this.onstatistics=()=>{},this.keyMoveSpeedListeners=[],this.debugGroup={name:"Scene Rendering",drawCallCount:0,bufferUploadCount:0,textureBindCount:0,triangleCount:0},this.clearScene=new f,this.resolveRenderPassDescriptor=u.makeEmptyRenderPassDescriptor(),this.inputManager=new i.default(this.canvas),this.rafTime=window.performance.now(),this.gfxDevice=this.gfxSwapChain.getDevice(),this.viewerRenderInput={camera:this.camera,time:this.sceneTime,deltaTime:0,backbufferWidth:0,backbufferHeight:0,viewport:this.viewport,onscreenTexture:null}}onKeyMoveSpeed(){for(let e=0;e<this.keyMoveSpeedListeners.length;e++)this.keyMoveSpeedListeners[e](this)}setKeyMoveSpeed(e){null!==this.cameraController&&(this.cameraController.setKeyMoveSpeed(e),this.onKeyMoveSpeed())}addKeyMoveSpeedListener(e){this.keyMoveSpeedListeners.push(e)}renderViewport(){let e=null;if(null!==this.scene?(e=this.scene.render(this.gfxDevice,this.viewerRenderInput),this.clearScene.minimize(this.gfxDevice)):this.clearScene.render(this.gfxDevice,this.viewerRenderInput),null!==e){const t=this.gfxDevice.queryRenderPass(e);this.gfxDevice.submitPass(e),this.resolveRenderPassDescriptor.colorAttachment=t.colorAttachment,this.resolveRenderPassDescriptor.colorResolveTo=this.viewerRenderInput.onscreenTexture,this.resolveRenderPassDescriptor.depthStencilAttachment=t.depthStencilAttachment;const a=this.gfxDevice.createRenderPass(this.resolveRenderPassDescriptor);this.gfxDevice.submitPass(a)}}render(){this.viewerRenderInput.camera=this.camera,this.viewerRenderInput.time=this.sceneTime,this.viewerRenderInput.backbufferWidth=this.canvas.width,this.viewerRenderInput.backbufferHeight=this.canvas.height,this.gfxSwapChain.configureSwapChain(this.canvas.width,this.canvas.height),this.viewerRenderInput.onscreenTexture=this.gfxSwapChain.getOnscreenTexture(),this.renderStatisticsTracker.beginFrame(),p(this.debugGroup),this.gfxDevice.pushDebugGroup(this.debugGroup),this.renderViewport(),this.gfxSwapChain.present(),this.gfxDevice.popDebugGroup(),this.renderStatisticsTracker.endFrame(),this.renderStatisticsTracker.applyDebugGroup(this.debugGroup),this.onstatistics(this.renderStatisticsTracker)}renderWebXR(e){if(!e.views||!e.xrSession)return;const t=e.xrSession.renderState.baseLayer;if(!t)return;const a=t.framebuffer,r=t.framebufferWidth,n=t.framebufferHeight;this.viewerRenderInput.camera=this.camera,this.viewerRenderInput.time=this.sceneTime,this.viewerRenderInput.backbufferWidth=r,this.viewerRenderInput.backbufferHeight=n,this.gfxSwapChain.configureSwapChain(r,n),this.renderStatisticsTracker.beginFrame(),p(this.debugGroup),this.gfxDevice.pushDebugGroup(this.debugGroup),this.viewerRenderInput.onscreenTexture=this.gfxSwapChain.getOnscreenTexture();for(let s=0;s<e.views.length;s++){this.viewerRenderInput.camera=this.xrCameraController.cameras[s];const i=e.views[s],o=t.getViewport(i);if(!o)continue;const l=o.width/r,c=o.height/n;this.renderViewport();const h={x:o.x/o.width*l,y:o.y/o.height*c,w:l,h:c};this.gfxSwapChain.present(a,h)}this.gfxDevice.popDebugGroup(),this.renderStatisticsTracker.endFrame(),this.renderStatisticsTracker.applyDebugGroup(this.debugGroup),this.onstatistics(this.renderStatisticsTracker)}setCameraController(e){this.cameraController=e,null!==this.scene&&void 0!==this.scene.adjustCameraController&&this.scene.adjustCameraController(e),this.cameraController.camera=this.camera,this.cameraController.forceUpdate=!0}setScene(e){this.scene=e,this.cameraController=null}update(e){const t=e.time-this.rafTime;this.updateDT(t,e)}updateDT(e,t){if(e<0)return;this.rafTime+=e;const a=this.camera;a.newFrame();const r=this.canvas.width/this.canvas.height;if(a.fovY=this.fovY,a.aspect=r,a.setClipPlanes(5),this.cameraController){this.cameraController.update(this.inputManager,e)&&this.oncamerachanged()}this.inputManager.afterFrame();const n=e*this.sceneTimeScale;this.viewerRenderInput.deltaTime+=n,this.sceneTime+=n,null!==t.webXRContext?(this.xrCameraController.update(t.webXRContext),this.renderWebXR(t.webXRContext)):this.render(),this.viewerRenderInput.deltaTime=0}takeScreenshotToCanvas(e){const t=document.createElement("canvas");if(null!==this.scene){const a=l.gfxDeviceGetImpl_GL(this.gfxDevice).gl,r=a.drawingBufferWidth,n=a.drawingBufferHeight;h.downloadTextureToCanvas(a,l.getPlatformTexture_GL(this.gfxSwapChain.getOnscreenTexture()),r,n,t,e)}return t}}function g(e){return s.createDOMFromString(`\n<div style="display: flex; background-color: #220000; flex-direction: column; position: absolute; top: 0; bottom: 0; left: 0; right: 0; justify-content: center;">\n<div style="display: flex; background-color: #aa2233; justify-content: center; box-shadow: 0 0 32px black;">\n<div style="max-width: 1000px; font: 16pt sans-serif; color: white; text-align: justify;">\n<style>\na:link, a:visited { color: #ccc; transition: .5s color; }\na:hover { color: #fff; }\n</style>\n${e}\n`)}t.Viewer=A,t.initializeViewer=async function(e,t){return window.localStorage.getItem("webgpu")?async function(e,t){const a=await c.createSwapChainForWebGPU(t);return null===a?5:(e.viewer=new A(a,t),0)}(e,t):async function(e,t){const a=t.getContext("webgl2",{alpha:!1,antialias:!1,preserveDrawingBuffer:!1,xrCompatible:!0});if(window.gl=a,!a)return navigator.vendor.includes("Apple")?2:1;const r=a.getInternalformatParameter(a.RENDERBUFFER,a.DEPTH32F_STENCIL8,a.SAMPLES);if(null===r||0===r.length){const e=a.getExtension("WEBGL_debug_renderer_info");return console.warn(`samplesArray = ${r}`),e&&a.getParameter(e.UNMASKED_RENDERER_WEBGL).includes("SwiftShader")?4:3}const n=l.createSwapChainForWebGL2(a);return e.viewer=new A(n,t),0}(e,t)},t.makeErrorMessageUI=g,t.makeErrorUI=function(e){if(2===e)return g('\n<p>This application requires WebGL 2. Unfortunately, that means Safari and iOS are currently not supported. The plan is to support <a href="https://github.com/gpuweb/gpuweb">WebGPU</a> once this arrives.\n');if(1===e)return g('\n<p>Your browser does not appear to have WebGL 2 support.\n<p>If <a href="http://webglreport.com/?v=2">WebGL Report</a> says your browser supports WebGL 2, please open a <a href="https://github.com/magcius/noclip.website/issues/new?template=tech_support.md">GitHub issue</a> with as much as information as possible.\n<p style="text-align: right">Thanks, Jasper.\n');if(4===e)return g('\n<p>This application requires hardware acceleration to be enabled.\n<p>Please enable hardware acceleration in your\'s browser settings.\n<p>If you have enabled hardware acceleration and are still getting this error message, please open a <a href="https://github.com/magcius/noclip.website/issues/new?template=tech_support.md">GitHub issue</a> with as much as information as possible.\n<p style="text-align: right">Thanks, Jasper.\n');if(3===e)return g('\n<p>This browser has a non-functioning version of WebGL 2 that I have not seen before.\n<p>If <a href="http://webglreport.com/?v=2">WebGL Report</a> says your browser supports WebGL 2, please open a <a href="https://github.com/magcius/noclip.website/issues/new?template=tech_support.md">GitHub issue</a> with as much as information as possible.\n<p style="text-align: right">Thanks, Jasper.\n');if(5===e)return g("\n<p>Your browser is too old and is missing support for web APIs that I rely on.\n<p>Please try to update your browser to a more recent version.\n");throw"whoops"}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(127));class s{constructor(){this.settingListeners=[],this.saveStateListeners=[],this.cleanOldKeys()}cleanOldKeys(){window.localStorage.removeItem("CameraStates"),window.localStorage.removeItem("SaveStates");for(let e=window.localStorage.length-1;e>=0;e--){const t=window.localStorage.key(e);t.startsWith("SaveState_")&&t.endsWith("/0")&&window.localStorage.removeItem(t)}}getSettingKey(e){return`Setting_${e}`}loadSetting(e,t){const a=window.localStorage.getItem(this.getSettingKey(e));return null!==a?JSON.parse(a):t}saveSetting(e,t,a=!1){if(!a&&this.loadSetting(e,null)!==t){window.localStorage.setItem(this.getSettingKey(e),JSON.stringify(t));for(let t=0;t<this.settingListeners.length;t++)this.settingListeners[t].key===e&&this.settingListeners[t].callback(this,e)}}addSettingListener(e,t,a=!0){this.settingListeners.push({callback:t,key:e}),a&&t(this,e)}getSaveStateSlotKey(e,t){return`SaveState_${e}/${t}`}getCurrentSceneDescId(){return window.sessionStorage.getItem("CurrentSceneDescId")||null}setCurrentSceneDescId(e){window.sessionStorage.setItem("CurrentSceneDescId",e)}addSaveStateListener(e){this.saveStateListeners.push(e)}callSaveStateListeners(){for(let e=0;e<this.saveStateListeners.length;e++)this.saveStateListeners[e](this)}saveTemporaryState(e,t){window.localStorage.removeItem(e),window.sessionStorage.setItem(e,t)}saveState(e,t){window.localStorage.setItem(e,t),this.callSaveStateListeners()}deleteState(e){window.localStorage.removeItem(e),this.callSaveStateListeners()}hasStateInLocation(e,t){return 0===t?e in window.localStorage:1===t?e in window.sessionStorage:2===t&&e in n}loadStateFromLocation(e,t){return 0===t?window.localStorage.getItem(e):1===t?window.sessionStorage.getItem(e):2===t&&n[e]||null}loadState(e){let t=null;return t=window.localStorage.getItem(e),t||(t=window.sessionStorage.getItem(e),t||(t=n[e],t||null))}export(){return JSON.stringify(Object.assign({},window.localStorage),null,4)}}t.SaveManager=s,t.GlobalSaveManager=new s},function(e,t){var a,r,n=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(a===setTimeout)return setTimeout(e,0);if((a===s||!a)&&setTimeout)return a=setTimeout,setTimeout(e,0);try{return a(e,0)}catch(t){try{return a.call(null,e,0)}catch(t){return a.call(this,e,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:s}catch(e){a=s}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var l,c=[],h=!1,d=-1;function u(){h&&l&&(h=!1,l.length?c=l.concat(c):d=-1,c.length&&m())}function m(){if(!h){var e=o(u);h=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,h=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];c.push(new p(e,t)),1!==c.length||h||o(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);function n(e){switch(e){case 0:return 4;case 1:return 8;case 2:return 16;case 3:return 32;default:throw"whoops"}}function s(e){switch(e){case 0:return 16;case 1:return 256;case 2:return 4096;case 3:return 65536;default:throw"whoops"}}function i(e){return 255&(e<<5|e<<2|e>>>1)}function o(e){return 255&(e<<4|e>>>0)}function l(e){return 255&(e<<3|e>>>2)}function c(e,t,a){e[t+0]=l((63488&a)>>11),e[t+1]=l((1984&a)>>6),e[t+2]=l((62&a)>>1),e[t+3]=1&a?255:0}function h(e,t,a,r){e[t+0]=a[4*r+0],e[t+1]=a[4*r+1],e[t+2]=a[4*r+2],e[t+3]=a[4*r+3]}t.getSizBitsPerPixel=n,t.getTLUTSize=s,t.decodeTex_RGBA16=function(e,t,a,r,n,s=0,i=!1){let o=0,l=0;const h=0!==s?(s<<2)-r<<1:0;for(let s=0;s<n;s++){const n=i?(1&s)<<2:0;for(let s=0;s<r;s++){c(e,o+0,t.getUint16(a+(l^n))),l+=2,o+=4}l+=h}},t.decodeTex_RGBA32=function(e,t,a,r,n,s=0){let i=0;const o=0!==s?(s<<1)-r<<2:0;for(let s=0;s<n;s++){for(let n=0;n<r;n++){const r=t.getUint32(a);e[i+0]=r>>>24&255,e[i+1]=r>>>16&255,e[i+2]=r>>>8&255,e[i+3]=r>>>0&255,a+=4,i+=4}a+=o}},t.decodeTex_CI4=function(e,t,a,r,n,s,i=0){let o=0;const l=0!==i?(i<<4)-r>>>1:0;for(let i=0;i<n;i++){for(let n=0;n<r;n+=2){const r=t.getUint8(a);h(e,o+0,s,r>>>4&15),h(e,o+4,s,r>>>0&15),a+=1,o+=8}a+=l}},t.decodeTex_CI8=function(e,t,a,r,n,s,i=0){let o=0;const l=0!==i?(i<<3)-r:0;for(let i=0;i<n;i++){for(let n=0;n<r;n++){h(e,o+0,s,t.getUint8(a)),a+=1,o+=4}a+=l}},t.decodeTex_IA4=function(e,t,a,r,n,s=0,o=!1){let l=0,c=0;const h=0!==s?(s<<4)-r>>>1:0;for(let s=0;s<n;s++){const n=o?(1&s)<<2:0;for(let s=0;s<r;s+=2){const r=t.getUint8(a+(c^n)),s=i(r>>>5&7),o=r>>>4&1?255:0;e[l+0]=s,e[l+1]=s,e[l+2]=s,e[l+3]=o;const h=i(r>>>1&7),d=r>>>0&1?255:0;e[l+4]=h,e[l+5]=h,e[l+6]=h,e[l+7]=d,c+=1,l+=8}c+=h}},t.decodeTex_IA8=function(e,t,a,r,n,s=0,i=!1){let l=0,c=0;const h=0!==s?(s<<3)-r:0;for(let s=0;s<n;s++){const n=i?(1&s)<<2:0;for(let s=0;s<r;s++){const r=t.getUint8(a+(c^n)),s=o(r>>>4&15),i=o(r>>>0&15);e[l+0]=s,e[l+1]=s,e[l+2]=s,e[l+3]=i,c+=1,l+=4}c+=h}},t.decodeTex_IA16=function(e,t,a,r,n,s=0,i=!1){let o=0,l=0;const c=0!==s?(s<<2)-r<<1:0;for(let s=0;s<n;s++){const n=i?(1&s)<<2:0;for(let s=0;s<r;s++){const r=t.getUint8(a+(l^n)+0),s=t.getUint8(a+(l^n)+1);e[o+0]=r,e[o+1]=r,e[o+2]=r,e[o+3]=s,l+=2,o+=4}l+=c}},t.decodeTex_I4=function(e,t,a,r,n,s=0,i=!1){let l=0,c=0;const h=0!==s?(s<<4)-r>>>1:0;for(let s=0;s<n;s++){const n=i?(1&s)<<2:0;for(let s=0;s<r;s+=2){const r=t.getUint8(a+(c^n)),s=o(r>>>4&15);e[l+0]=s,e[l+1]=s,e[l+2]=s,e[l+3]=s;const i=o(r>>>0&15);e[l+4]=i,e[l+5]=i,e[l+6]=i,e[l+7]=i,c+=1,l+=8}c+=h}},t.decodeTex_I8=function(e,t,a,r,n,s=0,i=!1){let o=0,l=0;const c=0!==s?(s<<3)-r<<1:0;for(let s=0;s<n;s++){const n=i?(1&s)<<2:0;for(let s=0;s<r;s++){const r=t.getUint8(a+(l^n));e[o+0]=r,e[o+1]=r,e[o+2]=r,e[o+3]=r,l+=1,o+=4}l+=c}},t.parseTLUT=function(e,t,a,n,i){r.assert(2===i);const o=s(n);for(let r=0;r<o;r++){c(e,4*r,t.getUint16(a)),a+=2}return 2*o},t.getImageFormatName=function(e){switch(e){case 2:return"CI";case 4:return"I";case 3:return"IA";case 0:return"RGBA";case 1:return"YUV"}},t.getImageSizeName=function(e){return""+n(e)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(48)),s=a(20),i=a(48),o=a(58),l=a(6),c=a(17),h=a(0),d=a(13),u=a(1),m=a(8),p=a(10),f=a(7),A=a(155),g=a(2),_=a(14),S=a(25);class b extends s.DeviceProgram{constructor(e,t,a,r=.5,n=[]){super(),this.DP_OtherModeH=e,this.DP_OtherModeL=t,this.blendAlpha=r,this.tiles=n,this.both="\nprecision mediump float;\n\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n#ifdef LIGHTING\n    #ifdef TEXTURE_GEN\n        vec4 u_LookAtVectors[2];\n    #endif\n#endif\n};\n\nlayout(row_major, std140) uniform ub_DrawParams {\n    Mat4x3 u_BoneMatrix[BONE_MATRIX_COUNT];\n    Mat4x2 u_TexMatrix[2];\n};\n\nuniform ub_CombineParameters {\n    vec4 u_PrimColor;\n    vec4 u_EnvColor;\n#ifdef EXTRA_COMBINE\n    vec4 u_MiscComb;\n#endif\n};\n\nuniform sampler2D u_Texture[2];\n\nvarying vec4 v_Color;\nvarying vec4 v_TexCoord;\n\nconst vec4 t_Zero = vec4(0.0);\nconst vec4 t_One = vec4(1.0);\n",this.vert=`\nlayout(location = ${b.a_Position}) in vec4 a_Position;\nlayout(location = ${b.a_Color}) in vec4 a_Color;\nlayout(location = ${b.a_TexCoord}) in vec2 a_TexCoord;\n\nvec3 Monochrome(vec3 t_Color) {\n    // NTSC primaries.\n    return vec3(dot(t_Color.rgb, vec3(0.299, 0.587, 0.114)));\n}\n\nvoid main() {\n    int t_BoneIndex = int(a_Position.w);\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_BoneMatrix[t_BoneIndex]), vec4(a_Position.xyz, 1.0)));\n    v_Color = t_One;\n\n#ifdef USE_VERTEX_COLOR\n    v_Color = a_Color;\n#endif\n\n#ifdef USE_MONOCHROME_VERTEX_COLOR\n    v_Color.rgb = Monochrome(v_Color.rgb);\n#endif\n\n    v_TexCoord.xy = Mul(u_TexMatrix[0], vec4(a_TexCoord, 1.0, 1.0));\n    v_TexCoord.zw = Mul(u_TexMatrix[1], vec4(a_TexCoord, 1.0, 1.0));\n\n    ${this.generateClamp()}\n\n#ifdef LIGHTING\n    // convert (unsigned) colors to normal vector components\n    vec4 t_Normal = vec4(2.0*a_Color.rgb - 2.0*trunc(2.0*a_Color.rgb), 0.0);\n    t_Normal = normalize(Mul(_Mat4x4(u_BoneMatrix[t_BoneIndex]), t_Normal));\n\n    // TODO: find and pass in lighting data\n    v_Color = vec4(vec3(.6 + .4*t_Normal.y), 1.0);\n\n#ifdef TEXTURE_GEN\n    // generate texture coordinates based on the vertex normal in screen space\n    t_Normal.xy = vec2(dot(t_Normal, u_LookAtVectors[0]), dot(t_Normal, u_LookAtVectors[1]));\n\n    // shift and rescale to tex coordinates - straight towards the camera is the center\n#   ifdef TEXTURE_GEN_LINEAR\n        v_TexCoord.xy = acos(t_Normal.xy)/radians(180.0);\n#   else\n        v_TexCoord.xy = (t_Normal.xy + vec2(1.0))/2.0;\n#   endif\n\n    v_TexCoord.zw = v_TexCoord.xy;\n#endif\n\n#endif\n}\n`,1===o.getCycleTypeFromOtherModeH(e)&&this.defines.set("TWO_CYCLE","1"),this.frag=this.generateFrag(a)}generateClamp(){let e="";for(let t=0;t<this.tiles.length;t++){const a=this.tiles[t];if(2&a.cms){const r=(1+(a.lrs-a.uls>>>2))/n.getTileWidth(a),s=0===t?"x":"z";r>1&&(e+=`v_TexCoord.${s} = clamp(v_TexCoord.${s}, 0.0, ${r.toFixed(1)});\n`)}if(2&a.cmt){const r=(1+(a.lrt-a.ult>>>2))/n.getTileHeight(a),s=0===t?"y":"w";r>1&&(e+=`v_TexCoord.${s} = clamp(v_TexCoord.${s}, 0.0, ${r.toFixed(1)});\n`)}}return e}generateAlphaTest(){const e=this.DP_OtherModeL>>>0&3,t=this.DP_OtherModeL>>>12&1;let a=0;return 1===e?a=this.blendAlpha:0!=e?a=.0125:0!=t&&(a=.125),a>0?`\n    if (t_Color.a < ${a})\n        discard;\n`:""}generateFrag(e){const t=o.getTextFiltFromOtherModeH(this.DP_OtherModeH);let a;if(0===t)a="Point";else if(3===t)a="Average";else{if(2!==t)throw"whoops";a="Bilerp"}const r=["t_CombColor.rgb","t_Tex0.rgb","t_Tex1.rgb","u_PrimColor.rgb","v_Color.rgb","u_EnvColor.rgb","t_One.rgb","t_Zero.rgb"],n=["t_CombColor.rgb","t_Tex0.rgb","t_Tex1.rgb","u_PrimColor.rgb","v_Color.rgb","u_EnvColor.rgb","t_Zero.rgb","t_CombColor.aaa","t_Tex0.aaa","t_Tex1.aaa","u_PrimColor.aaa","v_Color.aaa","u_EnvColor.aaa","t_Zero.rgb","u_MiscComb.rrr","t_Zero.rgb"],s=["combAlpha","t_Tex0","t_Tex1","u_PrimColor.a","v_Color.a","u_EnvColor.a","1.0","0.0"],i=["combAlpha","t_Tex0","t_Tex1","u_PrimColor.a","v_Color.a","u_EnvColor.a","u_MiscComb.r","0.0"];function l(e){return{x:e>>>12&15,y:e>>>8&15,z:e>>>4&15,w:e>>>0&15}}const c=l(e[0]),h=l(e[1]),d=l(e[2]),u=l(e[3]);return`\nvec4 Texture2D_N64_Point(sampler2D t_Texture, vec2 t_TexCoord) {\n    return texture(t_Texture, t_TexCoord);\n}\n\nvec4 Texture2D_N64_Average(sampler2D t_Texture, vec2 t_TexCoord) {\n    // Unimplemented.\n    return texture(t_Texture, t_TexCoord);\n}\n\n// Implements N64-style "triangle bilienar filtering" with three taps.\n// Based on ArthurCarvalho's implementation, modified by NEC and Jasper for noclip.\nvec4 Texture2D_N64_Bilerp(sampler2D t_Texture, vec2 t_TexCoord) {\n    vec2 t_Size = vec2(textureSize(t_Texture, 0));\n    vec2 t_Offs = fract(t_TexCoord*t_Size - vec2(0.5));\n    t_Offs -= step(1.0, t_Offs.x + t_Offs.y);\n    vec4 t_S0 = texture(t_Texture, t_TexCoord - t_Offs / t_Size);\n    vec4 t_S1 = texture(t_Texture, t_TexCoord - vec2(t_Offs.x - sign(t_Offs.x), t_Offs.y) / t_Size);\n    vec4 t_S2 = texture(t_Texture, t_TexCoord - vec2(t_Offs.x, t_Offs.y - sign(t_Offs.y)) / t_Size);\n    return t_S0 + abs(t_Offs.x)*(t_S1-t_S0) + abs(t_Offs.y)*(t_S2-t_S0);\n}\n\n#define Texture2D_N64 Texture2D_N64_${a}\n\nvec3 CombineColorCycle0(vec4 t_CombColor, vec4 t_Tex0, vec4 t_Tex1) {\n    return (${r[c.x]} - ${r[c.y]}) * ${n[c.z]} + ${r[c.w]};\n}\n\nfloat CombineAlphaCycle0(float combAlpha, float t_Tex0, float t_Tex1) {\n    return (${s[h.x]} - ${s[h.y]}) * ${i[h.z]} + ${s[h.w]};\n}\n\nvec3 CombineColorCycle1(vec4 t_CombColor, vec4 t_Tex0, vec4 t_Tex1) {\n    return (${r[d.x]} - ${r[d.y]}) * ${n[d.z]} + ${r[d.w]};\n}\n\nfloat CombineAlphaCycle1(float combAlpha, float t_Tex0, float t_Tex1) {\n    return (${s[u.x]} - ${s[u.y]}) * ${i[u.z]} + ${s[u.w]};\n}\n\nvoid main() {\n    vec4 t_Color = t_One;\n    vec4 t_Tex0 = t_One, t_Tex1 = t_One;\n\n#ifdef USE_TEXTURE\n    t_Tex0 = Texture2D_N64(u_Texture[0], v_TexCoord.xy);\n    t_Tex1 = Texture2D_N64(u_Texture[1], v_TexCoord.zw);\n#endif\n\n    t_Color = vec4(\n        CombineColorCycle0(t_Zero, t_Tex0, t_Tex1),\n        CombineAlphaCycle0(t_Zero.a, t_Tex0.a, t_Tex1.a)\n    );\n\n#ifdef TWO_CYCLE\n    t_Color = vec4(\n        CombineColorCycle1(t_Color, t_Tex0, t_Tex1),\n        CombineAlphaCycle1(t_Color.a, t_Tex0.a, t_Tex1.a)\n    );\n#endif\n\n#ifdef ONLY_VERTEX_COLOR\n    t_Color.rgba = v_Color.rgba;\n#endif\n\n#ifdef USE_ALPHA_VISUALIZER\n    t_Color.rgb = vec3(v_Color.a);\n    t_Color.a = 1.0;\n#endif\n\n${this.generateAlphaTest()}\n\n    gl_FragColor = t_Color;\n}\n`}}function v(e){switch(e){case 0:return 1;case 1:return 2;case 2:return 0;case 3:return 2}}function w(e,t,a){if(2===e.type){const t=(.08*Math.random()-.04)*a*30;e.colorFactor=g.clamp(e.colorFactor+t,.8,1)}else if(1===e.type)e.dty=t*e.subID%256;else if(6===e.type||4===e.type)e.dy=20*Math.sin(t*Math.PI/3);else if(3===e.type||7===e.type){const a=((3===e.type?e.xPhase:0)+t)*Math.PI;if(e.dtx=80*(Math.sin(.08*a)+1.5*Math.cos(.2*a))/64,e.dty=80*(Math.cos(.22*a)+.5*Math.sin(.5*a))/64,3===e.type)e.dy=e.subID*(.25*Math.sin(.11*a)+.75*Math.cos(.5*a));else if(7===e.type){const a=e.subID<10?e.subID/10:1;e.xPhase=3*a*t,e.yPhase=3*(a+.01)*t}}else if(5===e.type){const a=(.5+t*(e.subID+1)/100)%1.4;e.colorFactor=.3+(a<.7?a:1.4-a)}else if(8===e.type){const a=(.5+t*(e.subID+1)/100)%(2+(e.subID+1)/100);e.colorFactor=a<1?a:a<2?2-a:0}else if(9===e.type){const t=e.blinker;t.timer-=Math.max(a,0),0===t.duration&&(e.colorFactor=0,t.timer<=0&&(t.currBlink++,t.strength=(100+155*Math.random())/255,t.duration=.08+.04*Math.random(),t.timer=t.duration)),t.duration>0&&(t.timer<.04?e.colorFactor=t.strength*Math.max(t.timer,0)/.04:t.timer<t.duration-.04?e.colorFactor=t.strength:e.colorFactor=t.strength*(t.duration-t.timer)/.04,t.timer<=0&&(e.colorFactor=0,t.duration=0,t.currBlink<t.count?t.timer=.1+.1*Math.random():(t.currBlink=0,t.count=1+Math.floor(4*Math.random()),t.timer=4+2*Math.random())))}else 10===e.type&&(e.colorFactor=100*e.pairedEffect.colorFactor/255)}function x(e,t,a,r){if(7===e.type){const t=Math.sin(200*(a.x-e.bbMin[0])+e.xPhase)+Math.cos(200*(a.z-e.bbMin[2])+e.yPhase);e.dy=t*(e.bbMax[1]-e.bbMin[1])/4,e.colorFactor=(205+t/2*50)/255}3!==e.type&&7!==e.type||(t[10*r+1]=a.y+e.dy),1!==e.type&&3!==e.type&&7!==e.type||(t[10*r+4]=a.tx+e.dtx,t[10*r+5]=a.ty+e.dty),2===e.type||5===e.type||7===e.type?(t[10*r+6]=a.c0*e.colorFactor,t[10*r+7]=a.c1*e.colorFactor,t[10*r+8]=a.c2*e.colorFactor):10===e.type&&(t[10*r+6]=g.clamp(a.c0+e.colorFactor,0,1),t[10*r+7]=g.clamp(a.c1+e.colorFactor,0,1),t[10*r+8]=g.clamp(a.c2+e.colorFactor,0,1)),8===e.type?t[10*r+9]=a.a*e.colorFactor:9===e.type&&(t[10*r+9]=e.colorFactor)}t.F3DEX_Program=b,b.a_Position=0,b.a_Color=1,b.a_TexCoord=2,b.ub_SceneParams=0,b.ub_DrawParams=1,b.ub_CombineParams=2,t.textureToCanvas=function(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.title=e.name;const a=t.getContext("2d"),r=a.createImageData(t.width,t.height);r.data.set(e.pixels),a.putImageData(r,0,0);const n=[t],s=new Map;return s.set("Format",o.getImageFormatString(e.tile.fmt,e.tile.siz)),{name:e.name,surfaces:n,extraInfo:s}};class T{constructor(e,t,a){this.sharedOutput=a,this.textures=[],this.samplers=[],this.dynamicBufferCopies=[],this.dynamicStateCopies=[];const r=a.textureCache.textures;for(let a=0;a<r.length;a++){const n=r[a];this.textures.push(this.translateTexture(e,n)),this.samplers.push(this.translateSampler(e,t,n))}this.vertexBufferData=function(e){const t=new Float32Array(10*e.length);let a=0;for(let r=0;r<e.length;r++)t[a++]=e[r].x,t[a++]=e[r].y,t[a++]=e[r].z,t[a++]=e[r].matrixIndex,t[a++]=e[r].tx,t[a++]=e[r].ty,t[a++]=e[r].c0,t[a++]=e[r].c1,t[a++]=e[r].c2,t[a++]=e[r].a;return t}(a.vertices),this.vertexBuffer=c.makeStaticDataBuffer(e,2,this.vertexBufferData.buffer),h.assert(a.vertices.length<=4294967295);const n=new Uint32Array(a.indices);this.indexBuffer=c.makeStaticDataBuffer(e,1,n.buffer);const s=[{location:b.a_Position,bufferIndex:0,format:l.GfxFormat.F32_RGBA,bufferByteOffset:0},{location:b.a_TexCoord,bufferIndex:0,format:l.GfxFormat.F32_RG,bufferByteOffset:16},{location:b.a_Color,bufferIndex:0,format:l.GfxFormat.F32_RGBA,bufferByteOffset:24}];this.inputLayout=e.createInputLayout({indexBufferFormat:l.GfxFormat.U32_R,vertexBufferDescriptors:[{byteStride:40,frequency:1}],vertexAttributeDescriptors:s}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}translateTexture(e,t){const a=e.createTexture(l.makeTextureDescriptor2D(l.GfxFormat.U8_RGBA_NORM,t.width,t.height,1));e.setResourceName(a,t.name);const r=e.createHostAccessPass();return r.uploadTextureData(a,0,[t.pixels]),e.submitPass(r),a}translateSampler(e,t,a){return t.createSampler(e,{wrapS:v(n.getMaskedCMS(a.tile)),wrapT:v(n.getMaskedCMT(a.tile)),minFilter:0,magFilter:0,mipFilter:0,minLOD:0,maxLOD:0})}destroy(e){for(let t=0;t<this.textures.length;t++)e.destroyTexture(this.textures[t]);e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState);for(let t=0;t<this.dynamicBufferCopies.length;t++)e.destroyBuffer(this.dynamicBufferCopies[t]);for(let t=0;t<this.dynamicStateCopies.length;t++)e.destroyInputState(this.dynamicStateCopies[t])}}t.RenderData=T;const y=u.mat4.create(),C=u.mat4.create(),M=u.mat4.create();class U{constructor(e,t,a,r,n=null){this.node=t,this.drawMatrix=a,this.drawCall=r,this.textureAnimator=n,this.textureEntry=[],this.vertexColorsEnabled=!0,this.texturesEnabled=!0,this.monochromeVertexColorsEnabled=!1,this.alphaVisualizerEnabled=!1,this.gfxProgram=null,this.textureMappings=h.nArray(2,()=>new p.TextureMapping),this.envAlpha=1,this.visible=!0;for(let t=0;t<this.textureMappings.length;t++)if(t<this.drawCall.textureIndices.length){const a=this.drawCall.textureIndices[t];this.textureEntry[t]=e.sharedOutput.textureCache.textures[a],this.textureMappings[t].gfxTexture=e.textures[a],this.textureMappings[t].gfxSampler=e.samplers[a]}this.megaStateFlags=o.translateBlendMode(this.drawCall.SP_GeometryMode,this.drawCall.DP_OtherModeL),this.setBackfaceCullingEnabled(!0),this.createProgram()}createProgram(){const e=u.vec4.create();i.fillCombineParams(e,0,this.drawCall.DP_Combine);const t=new b(this.drawCall.DP_OtherModeH,this.drawCall.DP_OtherModeL,e);t.defines.set("BONE_MATRIX_COUNT","2"),this.texturesEnabled&&this.drawCall.textureIndices.length&&t.defines.set("USE_TEXTURE","1");const a=0!=(4&this.drawCall.SP_GeometryMode);this.vertexColorsEnabled&&a&&t.defines.set("USE_VERTEX_COLOR","1"),131072&this.drawCall.SP_GeometryMode&&t.defines.set("LIGHTING","1"),262144&this.drawCall.SP_GeometryMode&&t.defines.set("TEXTURE_GEN","1"),524288&this.drawCall.SP_GeometryMode&&t.defines.set("TEXTURE_GEN_LINEAR","1"),this.monochromeVertexColorsEnabled&&t.defines.set("USE_MONOCHROME_VERTEX_COLOR","1"),this.alphaVisualizerEnabled&&t.defines.set("USE_ALPHA_VISUALIZER","1"),this.program=t,this.gfxProgram=null}setBackfaceCullingEnabled(e){const t=e?function(e){const t=!!(4096&e),a=!!(8192&e);return t&&a?3:t?1:a?2:0}(this.drawCall.SP_GeometryMode):0;this.megaStateFlags.cullMode=t}setVertexColorsEnabled(e){this.vertexColorsEnabled=e,this.createProgram()}setTexturesEnabled(e){this.texturesEnabled=e,this.createProgram()}setMonochromeVertexColorsEnabled(e){this.monochromeVertexColorsEnabled=e,this.createProgram()}setAlphaVisualizerEnabled(e){this.alphaVisualizerEnabled=e,this.createProgram()}computeTextureMatrix(e,t){if(void 0!==this.textureEntry[t]){const a=this.textureEntry[t],r=this.drawCall.SP_TextureState.s/a.width,n=this.drawCall.SP_TextureState.t/a.height;e[0]=r,e[5]=n}else u.mat4.identity(e)}prepareToRender(e,t,a,r,n=0){if(!this.visible)return;null===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program));const s=t.pushRenderInst();if(s.setGfxProgram(this.gfxProgram),null!==this.textureAnimator)for(let e=0;e<this.drawCall.textureIndices.length&&e<this.textureMappings.length;e++)this.textureAnimator.fillTextureMapping(this.textureMappings[e],this.drawCall.textureIndices[e]);n>0&&(s.sortKey=f.setSortKeyDepthKey(s.sortKey,n)),s.setSamplerBindingsFromTextureMappings(this.textureMappings),s.setMegaStateFlags(this.megaStateFlags),s.drawIndexes(this.drawCall.indexCount,this.drawCall.firstIndex);let i=s.allocateUniformBuffer(b.ub_DrawParams,40);const o=s.mapUniformBufferF32(b.ub_DrawParams);r?m.computeViewMatrixSkybox(y,a.camera):m.computeViewMatrix(y,a.camera),u.mat4.mul(C,y,this.drawMatrix[0]),i+=d.fillMatrix4x3(o,i,C),u.mat4.mul(C,y,this.drawMatrix[1]),i+=d.fillMatrix4x3(o,i,C),this.computeTextureMatrix(M,0),i+=d.fillMatrix4x2(o,i,M),this.computeTextureMatrix(M,1),i+=d.fillMatrix4x2(o,i,M),i=s.allocateUniformBuffer(b.ub_CombineParams,8);const l=s.mapUniformBufferF32(b.ub_CombineParams);i+=d.fillVec4(l,i,1,1,1,1),i+=d.fillVec4(l,i,1,1,1,this.envAlpha)}}function k(e,t){const a=e.frames,r=a.findIndex(e=>t<e.time);if(0===r)return a[0].value;if(r<0)return a[a.length-1].value;const n=a[r-1],s=a[r],i=(t-n.time)/(s.time-n.time);return g.lerp(n.value,s.value,i)}const D=u.vec3.create(),I=u.mat4.create();t.BoneAnimator=class{constructor(e,t){this.animFile=e,this.duration=t}getPhase(e,t){return B(this.animFile,e,t)/(this.animFile.endFrame-this.animFile.startFrame)}fps(){return(this.animFile.endFrame-this.animFile.startFrame)/this.duration}calcBoneToParentMtx(e,t,a,r,n){r=B(this.animFile,r,n);let s=0,i=0,o=0,l=1,c=1,h=1,d=0,m=0,p=0;for(let e=0;e<this.animFile.tracks.length;e++){const n=this.animFile.tracks[e];if(n.boneID!==a.boneAnimID)continue;const u=k(n,r);0===n.trackType?s=.01745*u:1===n.trackType?i=.01745*u:2===n.trackType?o=.01745*u:3===n.trackType?l=u:4===n.trackType?c=u:5===n.trackType?h=u:6===n.trackType?d=u*t:7===n.trackType?m=u*t:8===n.trackType&&(p=u*t)}u.vec3.set(D,d,m,p),u.mat4.fromTranslation(e,D),u.mat4.translate(e,e,a.offset),u.mat4.identity(I),0!==o&&u.mat4.rotateZ(I,I,o),0!==i&&u.mat4.rotateY(I,I,i),0!==s&&u.mat4.rotateX(I,I,s),u.mat4.mul(e,e,I),u.vec3.set(D,l,c,h),u.mat4.scale(e,e,D),u.vec3.negate(D,a.offset),u.mat4.translate(e,e,D)}};const R=[{numUniformBuffers:3,numSamplers:2}];function B(e,t,a){const r=e.endFrame-e.startFrame;switch(a){case 2:for(;t>r;)t-=r;break;case 1:t>r&&(t=r);break;case 0:return e.startFrame}return t+e.startFrame}class P{constructor(e=30){this.fps=e,this.time=0,this.initialized=!1,this.phaseFrames=0}setTimeFromViewerInput(e){this.time=e.time/1e3,this.initialized||(this.initialized=!0,this.phaseFrames-=this.time*this.fps)}init(e,t=0){this.initialized=!1,this.fps=e,this.phaseFrames=t}adjust(e,t=0){this.fps=e,this.phaseFrames=t-this.time*this.fps}getTimeInFrames(){return this.initialized?this.time*this.fps+this.phaseFrames:this.phaseFrames}getTimeInSeconds(){return 0===this.fps?0:this.initialized?this.time+this.phaseFrames/this.fps:this.phaseFrames/this.fps}resetPhase(){this.initialized=!1,this.phaseFrames=0}}t.AdjustableAnimationController=P;t.GeometryData=class{constructor(e,t,a){this.geo=a,this.renderData=new T(e,t,a.sharedOutput),this.dynamic=a.vertexEffects.length>0||null!==a.vertexBoneTable}};const E=u.vec3.create();class F{constructor(e){this.node=e,this.drawCallInstances=[],this.children=[]}prepareToRender(e,t,a,r,n,s,i=0){const o=this.node;if(!A.isSelector(o.nodeData)||function(e,t,a){const r=e.values[t];if(void 0===r)return!0;if(r>0)return a===r-1;if(r<0){return!!(-r&1<<a)}return!1}(n,o.nodeData.stateIndex,i)){for(let n=0;n<this.drawCallInstances.length;n++)this.drawCallInstances[n].prepareToRender(e,t,a,r,s.key);if(A.isSorter(o.nodeData)){u.mat4.getTranslation(E,a.camera.worldMatrix),u.vec3.sub(E,E,o.nodeData.point);const i=u.vec3.dot(E,o.nodeData.normal)<0?0:1,l=s.key,c=s.mask;for(let o=0;o<this.children.length;o++)s.mask=c>>1,s.key=l,o===i&&(s.key|=c),this.children[o].prepareToRender(e,t,a,r,n,s,o);s.mask=c,s.key=l}else for(let i=0;i<this.children.length;i++)this.children[i].prepareToRender(e,t,a,r,n,s,i)}}setBackfaceCullingEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setBackfaceCullingEnabled(e);for(let t=0;t<this.children.length;t++)this.children[t].setBackfaceCullingEnabled(e)}setVertexColorsEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setVertexColorsEnabled(e);for(let t=0;t<this.children.length;t++)this.children[t].setVertexColorsEnabled(e)}setTexturesEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setTexturesEnabled(e);for(let t=0;t<this.children.length;t++)this.children[t].setTexturesEnabled(e)}setMonochromeVertexColorsEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setMonochromeVertexColorsEnabled(e);for(let t=0;t<this.children.length;t++)this.children[t].setMonochromeVertexColorsEnabled(e)}setAlphaVisualizerEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setAlphaVisualizerEnabled(e);for(let t=0;t<this.children.length;t++)this.children[t].setAlphaVisualizerEnabled(e)}setEnvironmentAlpha(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].envAlpha=e;for(let t=0;t<this.children.length;t++)this.children[t].setEnvironmentAlpha(e)}}t.layerFromFlags=function(e){return 4194304&e?4:131072&e?3:1024&e?0:1};class V{constructor(e,t){this.setup=e,this.animationController=new P(e.speed),this.textureMap=new Map;for(let a=0;a<e.indexLists.length;a++){const r=e.indexLists[a][0],n=[];for(let r=0;r<e.blockCount;r++)n.push(t[e.indexLists[a][r]]);this.textureMap.set(r,n)}}fillTextureMapping(e,t){const a=this.textureMap.get(t);if(void 0===a)return;const r=this.animationController.getTimeInFrames()%this.setup.blockCount>>>0;e.gfxTexture=a[r]}}const O={key:0,mask:2048},N=u.vec3.create(),L=u.vec3.create(),G=u.mat4.create(),H=u.vec3.create();t.GeometryRenderer=class{constructor(e,t){this.geometryData=t,this.visible=!0,this.isSkybox=!1,this.modelMatrix=u.mat4.create(),this.currAnimation=0,this.animationMode=2,this.animFrames=0,this.boneAnimators=[],this.animationController=new P(30),this.movementController=null,this.textureAnimator=null,this.objectFlags=0,this.megaStateFlags={},_.setAttachmentStateSimple(this.megaStateFlags,{blendMode:l.GfxBlendMode.ADD,blendSrcFactor:l.GfxBlendFactor.SRC_ALPHA,blendDstFactor:l.GfxBlendFactor.ONE_MINUS_SRC_ALPHA});const a=this.geometryData.geo;if(this.animationSetup=a.animationSetup,this.vertexEffects=a.vertexEffects,null!==a.textureAnimationSetup&&(this.textureAnimator=new V(a.textureAnimationSetup,t.renderData.textures)),null!==a.vertexBoneTable){const e=null!==a.animationSetup?a.animationSetup.bones.length:1;this.boneToModelMatrixArray=h.nArray(e,()=>u.mat4.create())}this.geometryData.dynamic?(this.vertexBufferData=new Float32Array(this.geometryData.renderData.vertexBufferData),this.vertexBuffer=e.createBuffer(h.align(this.vertexBufferData.byteLength,4)/4,2,2),this.inputState=e.createInputState(this.geometryData.renderData.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.geometryData.renderData.indexBuffer,byteOffset:0}),this.geometryData.renderData.dynamicBufferCopies.push(this.vertexBuffer),this.geometryData.renderData.dynamicStateCopies.push(this.inputState)):(this.vertexBufferData=this.geometryData.renderData.vertexBufferData,this.vertexBuffer=this.geometryData.renderData.vertexBuffer,this.inputState=this.geometryData.renderData.inputState);const r=null!==a.animationSetup?a.animationSetup.bones.length:1;this.boneToWorldMatrixArray=h.nArray(r,()=>u.mat4.create());const n=null!==a.animationSetup?a.animationSetup.bones.length:0;this.boneToParentMatrixArray=h.nArray(n,()=>u.mat4.create()),this.modelPointArray=h.nArray(a.modelPoints.length,()=>u.vec3.create()),this.selectorState={lastFrame:0,blinkState:0,values:[]},this.rootNodeRenderer=this.buildGeoNodeRenderer(a.rootNode)}buildGeoNodeRenderer(e){const t=new F(e);if(null!==e.rspOutput){const a=[this.boneToWorldMatrixArray[e.boneIndex],this.boneToWorldMatrixArray[e.boneIndex]];if(null!==this.animationSetup&&(-1===e.parentIndex||(a[1]=h.assertExists(this.boneToWorldMatrixArray[e.parentIndex]))),null!==e.rspOutput)for(let r=0;r<e.rspOutput.drawCalls.length;r++){const n=new U(this.geometryData.renderData,e,a,e.rspOutput.drawCalls[r],this.textureAnimator);t.drawCallInstances.push(n)}}for(let a=0;a<e.children.length;a++)t.children.push(this.buildGeoNodeRenderer(e.children[a]));return t}setBackfaceCullingEnabled(e){this.rootNodeRenderer.setBackfaceCullingEnabled(e)}setVertexColorsEnabled(e){this.rootNodeRenderer.setVertexColorsEnabled(e)}setTexturesEnabled(e){this.rootNodeRenderer.setTexturesEnabled(e)}setMonochromeVertexColorsEnabled(e){this.rootNodeRenderer.setMonochromeVertexColorsEnabled(e)}setAlphaVisualizerEnabled(e){this.rootNodeRenderer.setAlphaVisualizerEnabled(e)}setEnvironmentAlpha(e){this.rootNodeRenderer.setEnvironmentAlpha(e)}additionalSetup(e,t,a){if(a>0){const e=515===t?12:606===t?6:739===t?9:740===t?9:0;for(let t=0;t<=e;t++)this.selectorState.values[t]=t===a?1:0}7===t&&(this.selectorState.values[4]=1,this.selectorState.values[5]=0,this.selectorState.values[6]=1,this.selectorState.values[7]=0,this.selectorState.values[8]=0,this.selectorState.values[9]=0);const r=t-634;r>=1&&r<=6&&(this.selectorState.values[4]=r),60===t&&(this.modelMatrix[12]=5700,this.modelMatrix[13]=-2620,this.modelMatrix[14]=-20)}movement(e){null!==this.movementController&&this.movementController.movement(this.modelMatrix,this.animationController.getTimeInSeconds())}calcAnim(){this.animFrames=this.animationController.getTimeInFrames();const e=this.boneAnimators[this.currAnimation];if(void 0===e||null===this.animationSetup)return;const t=this.animationSetup.bones,a=this.animationSetup.translationScale;for(let r=0;r<t.length;r++)e.calcBoneToParentMtx(this.boneToParentMatrixArray[r],a,t[r],this.animFrames,this.animationMode)}changeAnimation(e,t){this.currAnimation=e,this.animationMode=t;const a=this.boneAnimators[e];if(void 0===a)throw`bad animation index ${e}`;this.animationController.adjust(a.fps())}animationPhaseTrigger(e){const t=this.boneAnimators[this.currAnimation],a=t.getPhase(this.animationController.getTimeInFrames(),this.animationMode),r=t.getPhase(this.animFrames,this.animationMode);return r<=e&&e<a||a<r&&(e<a||r<=e)}getAnimationPhase(){return this.boneAnimators[this.currAnimation].getPhase(this.animationController.getTimeInFrames(),this.animationMode)}calcBonesRelativeToMatrix(e,t){if(null!==this.animationSetup){const a=this.animationSetup.bones;for(let r=0;r<a.length;r++){const n=a[r].parentIndex,s=-1===n?t:e[n],i=r;u.mat4.mul(e[i],s,this.boneToParentMatrixArray[i])}}else u.mat4.copy(e[0],t)}calcBoneToWorld(){this.calcBonesRelativeToMatrix(this.boneToWorldMatrixArray,this.modelMatrix)}calcBoneToModel(){this.calcBonesRelativeToMatrix(this.boneToModelMatrixArray,G)}calcModelPoints(){for(let e=0;e<this.modelPointArray.length;e++){const t=this.geometryData.geo.modelPoints[e];if(void 0===t)continue;const a=-1===t.boneID?this.modelMatrix:this.boneToWorldMatrixArray[t.boneID];u.vec3.transformMat4(this.modelPointArray[e],t.offset,a)}}calcSelectorState(){const e=Math.floor(this.animationController.getTimeInFrames());if(e!==this.selectorState.lastFrame&&(this.selectorState.lastFrame=e,256&this.objectFlags)){let e=this.selectorState.values[1];switch(void 0===e&&(e=1),this.selectorState.blinkState){case 0:Math.random()<.03&&(this.selectorState.blinkState=1);break;case 1:e<4?e++:this.selectorState.blinkState=2;break;case 2:e>1?e--:this.selectorState.blinkState=0}this.selectorState.values[1]=e,this.selectorState.values[2]=e}}prepareToRender(e,t,a){if(!this.visible)return;this.animationController.setTimeFromViewerInput(a),null!==this.textureAnimator&&this.textureAnimator.animationController.setTimeFromViewerInput(a),this.movement(a),this.calcAnim(),this.calcBoneToWorld(),this.calcModelPoints(),this.calcSelectorState();const r=t.pushTemplateRenderInst();r.setBindingLayouts(R),r.setInputLayoutAndState(this.geometryData.renderData.inputLayout,this.inputState),r.setMegaStateFlags(this.megaStateFlags),r.filterKey=this.isSkybox?2:1,u.mat4.getTranslation(N,a.camera.worldMatrix),u.mat4.getTranslation(H,this.modelMatrix),r.sortKey=f.setSortKeyDepth(this.sortKeyBase,u.vec3.distance(N,H));const n=0!=(4&this.geometryData.geo.geoFlags),s=16+(n?8:0);let i=r.allocateUniformBuffer(b.ub_SceneParams,s);const o=r.mapUniformBufferF32(b.ub_SceneParams);i+=d.fillMatrix4x4(o,i,a.camera.projectionMatrix),n&&(u.mat4.getTranslation(H,this.modelMatrix),u.vec3.transformMat4(H,H,a.camera.viewMatrix),u.mat4.lookAt(C,g.Vec3Zero,H,g.Vec3UnitY),i+=d.fillVec4(o,i,C[0],C[4],C[8]),i+=d.fillVec4(o,i,C[1],C[5],C[9]));let l=!1;if(this.vertexEffects.length>0){l=!0;for(let e=0;e<this.vertexEffects.length;e++){const t=this.vertexEffects[e];w(t,a.time/1e3,a.deltaTime/1e3);for(let e=0;e<t.vertexIndices.length;e++)x(t,this.vertexBufferData,t.baseVertexValues[e],t.vertexIndices[e])}}if(null!==this.geometryData.geo.vertexBoneTable){this.calcBoneToModel(),l=!0;const e=this.geometryData.geo.vertexBoneTable.vertexBoneEntries;for(let t=0;t<e.length;t++){u.vec3.transformMat4(L,e[t].position,this.boneToModelMatrixArray[e[t].boneID]);for(let a=0;a<e[t].vertexIDs.length;a++){const r=e[t].vertexIDs[a];this.vertexBufferData[10*r+0]=L[0],this.vertexBufferData[10*r+1]=L[1],this.vertexBufferData[10*r+2]=L[2]}}}if(this.geometryData.dynamic){const t=e.createHostAccessPass();t.uploadBufferData(this.vertexBuffer,0,new Uint8Array(this.vertexBufferData.buffer)),e.submitPass(t)}O.key=0,O.mask=2048,this.rootNodeRenderer.prepareToRender(e,t,a,this.isSkybox,this.selectorState,O),t.popTemplateRenderInst()}};const j={c0:{a:1,b:7,c:3,d:7},c1:{a:1,b:7,c:3,d:7},a0:{a:1,b:7,c:3,d:7},a1:{a:1,b:7,c:3,d:7}},W={c0:{a:3,b:5,c:1,d:5},c1:{a:3,b:5,c:1,d:5},a0:{a:1,b:7,c:3,d:7},a1:{a:1,b:7,c:3,d:7}};t.FlipbookData=class{constructor(e,t,a){this.flipbook=a,this.mode=a.renderMode,this.renderData=new T(e,t,a.sharedOutput)}};const Z=h.nArray(1,()=>new p.TextureMapping),z=h.nArray(2,()=>u.vec3.create());t.FlipbookRenderer=class{constructor(e,t=0,a=!1){this.flipbookData=e,this.textureEntry=[],this.vertexColorsEnabled=!0,this.texturesEnabled=!0,this.monochromeVertexColorsEnabled=!1,this.alphaVisualizerEnabled=!1,this.megaStateFlags={},this.gfxProgram=null,this.textureMappings=[],this.visible=!0,this.modelMatrix=u.mat4.create(),this.animationController=new P(30),this.rotationAngle=0,this.screenOffset=u.vec2.create(),this.primColor=u.vec4.fromValues(1,1,1,1),this.envColor=u.vec4.fromValues(1,1,1,1);const r=e.renderData;for(let e=0;e<r.textures.length;e++)this.textureEntry.push(r.sharedOutput.textureCache.textures[e]),this.textureMappings.push(new p.TextureMapping),this.textureMappings[e].gfxTexture=r.textures[e],this.textureMappings[e].gfxSampler=r.samplers[e];_.setAttachmentStateSimple(this.megaStateFlags,{blendSrcFactor:l.GfxBlendFactor.SRC_ALPHA,blendDstFactor:l.GfxBlendFactor.ONE_MINUS_SRC_ALPHA}),this.mode=e.mode,this.megaStateFlags.depthWrite=2===this.mode,this.createProgram(),this.animationController.init(e.flipbook.frameRate,t/32*e.flipbook.frameSequence.length),this.animationParams={initialMirror:a,mirrored:!!(1&t),reversed:!!(2&t)}}changeData(e,t,a=!1){this.flipbookData=e;for(let t=0;t<e.renderData.textures.length;t++)this.textureEntry[t]=e.renderData.sharedOutput.textureCache.textures[t],t>=this.textureMappings.length&&this.textureMappings.push(new p.TextureMapping),this.textureMappings[t].gfxTexture=e.renderData.textures[t],this.textureMappings[t].gfxSampler=e.renderData.samplers[t];this.mode=void 0!==t?t:e.mode,this.megaStateFlags.depthWrite=2===this.mode,this.createProgram(),this.animationController.init(e.flipbook.frameRate),this.animationParams.initialMirror=a,this.animationParams.mirrored=a}createProgram(){let e=16;2===this.mode&&(e|=1);const t=u.vec4.create(),a=3===this.mode?W:j;i.fillCombineParams(t,0,a);const r=new b(8192,e,t);r.defines.set("BONE_MATRIX_COUNT","1"),this.texturesEnabled&&r.defines.set("USE_TEXTURE","1"),this.vertexColorsEnabled&&r.defines.set("USE_VERTEX_COLOR","1"),this.monochromeVertexColorsEnabled&&r.defines.set("USE_MONOCHROME_VERTEX_COLOR","1"),this.alphaVisualizerEnabled&&r.defines.set("USE_ALPHA_VISUALIZER","1"),this.program=r,this.gfxProgram=null}setBackfaceCullingEnabled(e){this.megaStateFlags.cullMode=0}setVertexColorsEnabled(e){this.vertexColorsEnabled=e,this.createProgram()}setTexturesEnabled(e){this.texturesEnabled=e,this.createProgram()}setMonochromeVertexColorsEnabled(e){this.monochromeVertexColorsEnabled=e,this.createProgram()}setAlphaVisualizerEnabled(e){this.alphaVisualizerEnabled=e,this.createProgram()}animateFlipbook(e,t){const a=this.flipbookData.flipbook;let r=Math.floor(this.animationController.getTimeInFrames()%a.frameSequence.length);u.mat4.identity(t);let n=!1;4===a.loopMode||1===a.loopMode?n=r>=a.rawFrames:0===a.mirrorMode?n=this.animationParams.initialMirror:1===a.mirrorMode?n=this.animationParams.mirrored:2===a.mirrorMode&&(n=!0),n&&(t[0]=-1);let s=!1;2===a.reverseMode?s=!0:1===a.reverseMode&&(s=this.animationParams.reversed),s&&(r=2===a.loopMode||1===a.loopMode?(r+a.rawFrames-1)%a.frameSequence.length:a.frameSequence.length-1-r);const i=a.frameSequence[r];e[0]=this.textureMappings[i]}prepareToRender(e,t,a){if(!this.visible)return;null===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program)),this.animationController.setTimeFromViewerInput(a),this.animateFlipbook(Z,M);const r=t.pushRenderInst();r.setBindingLayouts(R),r.setInputLayoutAndState(this.flipbookData.renderData.inputLayout,this.flipbookData.renderData.inputState),r.setMegaStateFlags(this.megaStateFlags),u.mat4.getTranslation(z[0],a.camera.worldMatrix),u.mat4.getTranslation(z[1],this.modelMatrix),u.vec3.sub(z[0],z[0],z[1]),r.sortKey=f.setSortKeyDepth(this.sortKeyBase,u.vec3.len(z[0])),r.filterKey=1;let n=r.allocateUniformBuffer(b.ub_SceneParams,16);const s=r.mapUniformBufferF32(b.ub_SceneParams);n+=d.fillMatrix4x4(s,n,a.camera.projectionMatrix),r.setGfxProgram(this.gfxProgram),r.setSamplerBindingsFromTextureMappings(Z),r.drawIndexes(6),n=r.allocateUniformBuffer(b.ub_DrawParams,28);const i=r.mapUniformBufferF32(b.ub_DrawParams);m.computeViewMatrix(y,a.camera),u.mat4.mul(C,y,this.modelMatrix),S.J3DCalcBBoardMtx(C,C),u.mat4.rotateZ(C,C,this.rotationAngle),C[12]+=this.screenOffset[0],C[13]+=this.screenOffset[1],n+=d.fillMatrix4x3(i,n,C),n+=d.fillMatrix4x2(i,n,M),n=r.allocateUniformBuffer(b.ub_CombineParams,8);const o=r.mapUniformBufferF32(b.ub_CombineParams);n+=d.fillVec4v(o,n,this.primColor),n+=d.fillVec4v(o,n,this.envColor)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=r(a(11)),i=a(26),o=r(a(39)),l=a(36),c=a(25),h=a(9),d=a(5),u=r(a(92));class m{constructor(e){this.renderTarget=new h.BasicRenderTarget,this.modelInstances=[],this.rarc=[],this.textureHolder=new d.GXTextureHolder,this.renderHelper=new d.GXRenderHelperGfx(e)}createPanels(){const e=new s.Panel;e.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,e.setTitle(s.RENDER_HACKS_ICON,"Render Hacks");const t=new s.Checkbox("Enable Vertex Colors",!0);t.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setVertexColorsEnabled(t.checked)},e.contents.appendChild(t.elem);const a=new s.Checkbox("Enable Textures",!0);return a.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setTexturesEnabled(a.checked)},e.contents.appendChild(a.elem),[new s.LayerPanel(this.modelInstances),e]}addModelInstance(e){this.modelInstances.push(e)}prepareToRender(e,t,a){const r=this.renderHelper.renderInstManager,n=this.renderHelper.pushTemplateRenderInst();d.fillSceneParamsDataOnTemplate(n,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,r,a);r.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,h.standardFullClearRenderPassDescriptor);return this.renderHelper.renderInstManager.drawOnPassRenderer(e,r),this.renderHelper.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e)}}t.BasicRenderer=m;const p={lightingFudge:e=>`(0.5 * (${e.ambSource} + 0.6) * ${e.matSource})`};function f(e,t,a,r,n,s,o){const l=i.BMD.parse(a.buffer),h=o?i.BMT.parse(o.buffer):null,d=new c.J3DModelData(e,t,l),u=new c.J3DModelInstanceSimple(d,p);if(null!==h&&u.setModelMaterialDataOwned(new c.BMDModelMaterialData(e,t,h)),null!==r){const e=i.BTK.parse(r.buffer);u.bindTTK1(e)}if(null!==n){const e=i.BRK.parse(n.buffer);u.bindTRK1(e)}if(null!==s){const e=i.BCK.parse(s.buffer);u.bindANK1(e)}return u}t.createModelInstance=f,t.createSceneFromBuffer=function(e,t){if("RARC"===n.readString(t,0,4)){const a=o.parse(t);if(null!==a.findFile("ParticleNames.bcsv"))return u.createRendererFromSMGArchive(e,a)}const a=e.device,r=new m(a);return function(e,t,a){if("RARC"===n.readString(a,0,4)){const r=o.parse(a);t.rarc.push(r);for(let a=0;a<r.files.length;a++){const n=r.files[a];if(n.name.endsWith(".bmd")||n.name.endsWith(".bdl")){const a=n.name.split(".")[0],s=r.files.find(e=>e.name===`${a}.btk`)||null,i=r.files.find(e=>e.name===`${a}.brk`)||null,o=r.files.find(e=>e.name===`${a}.bck`)||null,l=r.files.find(e=>e.name===`${a}.bmt`)||null;let c;try{c=f(e,t.renderHelper.renderInstManager.gfxRenderCache,n,s,i,o,l)}catch(e){console.warn(`File ${a} failed to parse:`,e);continue}c.name=a,a.includes("_sky")&&(c.isSkybox=!0),t.addModelInstance(c)}else if(n.name.endsWith(".bti")){const a=l.readBTI_Texture(n.buffer,n.name);t.textureHolder.addTextures(e,[a])}}}if(["J3D2bmd3","J3D2bdl4"].includes(n.readString(a,0,8))){const r=i.BMD.parse(a),n=new c.J3DModelData(e,t.renderHelper.renderInstManager.gfxRenderCache,r),s=new c.J3DModelInstanceSimple(n);t.addModelInstance(s)}}(a,r,t),r}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(40),s=r(a(60)),i=a(0),o=a(43);function l(e){return null!==e.getValueNumberNoInit("SW_SLEEP")}t.isExistStageSwitchA=function(e){return null!==e.getValueNumberNoInit("SW_A")},t.isExistStageSwitchB=function(e){return null!==e.getValueNumberNoInit("SW_B")},t.isExistStageSwitchAppear=function(e){return null!==e.getValueNumberNoInit("SW_APPEAR")},t.isExistStageSwitchDead=function(e){return null!==e.getValueNumberNoInit("SW_DEAD")},t.isExistStageSwitchSleep=l;class c{constructor(e=-1){this.zoneId=e,this.bitMap=new s.default(128)}}class h extends n.NameObj{constructor(e){super(e,"StageSwitchContainer"),this.zoneSwitches=[],this.globalZoneSwitch=new c}findZoneSwitchFromTable(e){for(let t=0;t<this.zoneSwitches.length;t++)if(this.zoneSwitches[t].zoneId===e.zoneId)return this.zoneSwitches[t];return null}createAndAddZone(e){null===this.findZoneSwitchFromTable(e)&&this.zoneSwitches.push(new c(e.zoneId))}getZoneSwitch(e){return e.isGlobalSwitch?this.globalZoneSwitch:i.assertExists(this.findZoneSwitchFromTable(e))}setSwitch(e,t,a=0){const r=new d(a,e);this.getZoneSwitch(r).bitMap.setBit(r.getSwitchNo(),t)}}t.StageSwitchContainer=h;class d{constructor(e,t){this.zoneId=e,this.switchId=t,this.isGlobalSwitch=this.switchId>=1e3}getSwitchNo(){return this.isGlobalSwitch?this.switchId-1e3:this.switchId}}function u(e,t,a){const r=i.fallback(a.getValueNumber(t),-1);if(r<0)return null;const n=i.assertExists(e.stageDataHolder.findPlacedStageDataHolder(a)).zoneId,s=new d(n,r);return s.isGlobalSwitch||(e.create(10),e.stageSwitchContainer.createAndAddZone(s)),s}function m(e,t){e.stageSwitchContainer.getZoneSwitch(t).bitMap.setBit(t.getSwitchNo(),!0)}function p(e,t){e.stageSwitchContainer.getZoneSwitch(t).bitMap.setBit(t.getSwitchNo(),!1)}function f(e,t){return e.stageSwitchContainer.getZoneSwitch(t).bitMap.getBit(t.getSwitchNo())}function A(e,t,a){a?null!==t.switchOn&&t.switchOn(e):null!==t.switchOff&&t.switchOff(e)}t.SwitchIdInfo=d,t.onSwitchBySwitchIdInfo=m,t.offSwitchBySwitchIdInfo=p,t.isOnSwitchBySwitchIdInfo=f;class g{constructor(e,t){this.switchOn=e,this.switchOff=t}}t.SwitchFunctorEventListener=g;class _{constructor(e,t){this.switchA=u(e,"SW_A",t),this.switchB=u(e,"SW_B",t),this.switchAppear=u(e,"SW_APPEAR",t),this.switchDead=u(e,"SW_DEAD",t)}isOnSwitchA(e){return f(e,this.switchA)}onSwitchA(e){m(e,this.switchA)}offSwitchA(e){p(e,this.switchA)}isOnSwitchB(e){return f(e,this.switchB)}onSwitchB(e){m(e,this.switchB)}offSwitchB(e){p(e,this.switchB)}isValidSwitchAppear(){return null!==this.switchAppear}isOnSwitchAppear(e){return f(e,this.switchAppear)}onSwitchAppear(e){m(e,this.switchAppear)}offSwitchAppear(e){p(e,this.switchAppear)}isValidSwitchDead(){return null!==this.switchDead}onSwitchDead(e){m(e,this.switchDead)}offSwitchDead(e){p(e,this.switchDead)}}function S(e,t){return new _(e,t)}t.StageSwitchCtrl=_,t.createStageSwitchCtrl=S;class b{constructor(e){this.switchCtrl=e,this.flags=0,this.listenerA=null,this.listenerB=null,this.listenerAppear=null}checkSwitch(e,t,a,r){!r||this.flags&a?!r&&this.flags&a&&(A(e,t,!1),this.flags&=~a):(A(e,t,!0),this.flags|=a)}movement(e){null!==this.listenerA&&this.checkSwitch(e,this.listenerA,1,this.switchCtrl.isOnSwitchA(e)),null!==this.listenerB&&this.checkSwitch(e,this.listenerB,2,this.switchCtrl.isOnSwitchB(e)),null!==this.listenerAppear&&this.checkSwitch(e,this.listenerAppear,4,this.switchCtrl.isOnSwitchAppear(e))}}class v extends n.NameObj{constructor(e){super(e,"SwitchWatcherHolder"),this.watchers=[],o.connectToScene(e,this,27,-1,-1,-1)}movement(e,t){super.movement(e,t);for(let t=0;t<this.watchers.length;t++)this.watchers[t].movement(e)}findAndCreateSwitchWatcher(e){for(let t=0;t<this.watchers.length;t++)if(this.watchers[t].switchCtrl===e)return this.watchers[t];const t=new b(e);return this.watchers.push(t),t}joinSwitchEventListenerA(e,t){this.findAndCreateSwitchWatcher(e).listenerA=t}joinSwitchEventListenerB(e,t){this.findAndCreateSwitchWatcher(e).listenerB=t}joinSwitchEventListenerAppear(e,t){this.findAndCreateSwitchWatcher(e).listenerAppear=t}}t.SwitchWatcherHolder=v;class w{constructor(e,t,a){this.eventListener=a,this.isSwitchOn=!1,this.switchIdInfo=i.assertExists(u(e,"SW_SLEEP",t))}initSync(e){const t=f(e,this.switchIdInfo);A(e,this.eventListener,t)}update(e){const t=f(e,this.switchIdInfo);!this.isSwitchOn&&t?A(e,this.eventListener,!0):this.isSwitchOn&&!t&&A(e,this.eventListener,!1),this.isSwitchOn=t}}class x extends n.NameObj{constructor(e){super(e,"SleepControllerHolder"),this.controllers=[]}initSync(e){for(let t=0;t<this.controllers.length;t++)this.controllers[t].initSync(e);o.connectToSceneMapObjMovement(e,this)}movement(e,t){super.movement(e,t);for(let t=0;t<this.controllers.length;t++)this.controllers[t].update(e)}add(e,t,a){this.controllers.push(new w(e,t,a))}}t.SleepControllerHolder=x,t.addSleepControlForLiveActor=function(e,t,a){if(!l(a))return;const r=new g(e=>t.makeActorAppeared(e),e=>t.makeActorDead(e));e.create(12),e.sleepControllerHolder.add(e,a,r)},t.addSleepControlForAreaObj=function(e,t,a){if(!l(a))return;const r=new g(e=>t.awake(e),e=>t.sleep(e));e.create(12),e.sleepControllerHolder.add(e,a,r)},t.initSyncSleepController=function(e){null!==e.sleepControllerHolder&&e.sleepControllerHolder.initSync(e)};class T extends n.NameObj{constructor(e,t,a){super(t,name),this.reverse=!1,o.connectToSceneMapObjMovement(t,this),this.switchCtrl=S(t,a),this.reverse=!0}movement(e,t){super.movement(e,t),this.reverse?this.switchCtrl.isOnSwitchB(e)?this.switchCtrl.offSwitchA(e):this.switchCtrl.onSwitchA(e):this.switchCtrl.isOnSwitchB(e)?this.switchCtrl.onSwitchA(e):this.switchCtrl.offSwitchA(e)}}t.SwitchSynchronizer=T,t.getSwitchWatcherHolder=function(e){return e.create(11),e.switchWatcherHolder}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);function n(e,t){const a=e.files.find(e=>e.name.toLowerCase()===t.toLowerCase());return void 0!==a?a:null}t.findFile=n,t.findFileData=function(e,t){const a=n(e,t);return null!==a?a.buffer:null},t.parse=function(e){const t=r.readString(e,0,4,!1);if(["ZAR","GAR"].includes(t))return function(e){const t=e.createDataView(),a=r.readString(e,0,4,!1);r.assert(["ZAR","GAR"].includes(a));const n="ZAR"==a?0:1,s=(t.getUint32(4,!0),t.getUint16(8,!0),t.getUint16(10,!0)),i=(t.getUint32(12,!0),t.getUint32(16,!0)),o=t.getUint32(20,!0),l=r.readString(e,24,8,!0);r.assert(["queen","jenkins"].includes(l));const c=[];let h=i,d=o;for(let n=0;n<s;n++){const n=t.getUint32(h+0,!0),s=t.getUint32(h+("GAR"===a?8:4),!0),i=r.readString(e,s,255,!0),o=t.getUint32(d+0,!0),l=e.subarray(o,n);c.push({name:i,buffer:l}),h+="GAR"===a?12:8,d+=4}return{files:c,version:n}}(e);if(["GAR"].includes(t))return function(e){const t=e.createDataView(),a=r.readString(e,0,4,!1);r.assert(["GAR"].includes(a)),t.getUint32(4,!0);const n=t.getUint16(8,!0),s=(t.getUint16(10,!0),t.getUint32(12,!0)),i=t.getUint32(16,!0),o=(t.getUint32(20,!0),r.readString(e,24,8,!0));r.assert(["SYSTEM"].includes(o));const l=[];let c=s;for(let a=0;a<n;a++){const a=t.getUint32(c+0,!0),n=(t.getUint32(c+4,!0),t.getUint32(c+8,!0)),s=t.getUint32(c+12,!0),o=r.readString(e,s,16,!0);t.getUint32(c+16,!0);r.assert(0===t.getUint32(c+20,!0)),r.assert(0===t.getUint32(c+24,!0)),r.assert(0===t.getUint32(c+28,!0)),c+=32;for(let s=0;s<a;s++){const a=i+16*(n+s),c=t.getUint32(a+0,!0),h=t.getUint32(a+4,!0),d=t.getUint32(a+8,!0),u=`${r.readString(e,d,255,!0)}.${o}`,m=e.subarray(h,c);l.push({name:u,buffer:m})}}return{files:l,version:2}}(e);throw"whoops"}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(16)),s=a(0),i=a(31),o=a(1),l=a(12),c=a(4),h=a(2),d=a(30),u=a(32),m=a(56),p=a(34),f=o.mat4.create(),A=o.mat4.create(),g=o.mat4.create(),_=o.mat4.create(),S=[0,0,0];function b(e,t,a,r,n,s,i,l){function c(e,t,a=0){return S[0]=e,S[1]=t,S[2]=a,S}o.mat4.fromTranslation(e,c(.5*i*r,(.5*l-1)*n,0)),o.mat4.fromZRotation(g,.01745*-s),o.mat4.fromTranslation(f,c(-.5*i*r,-(.5*l-1)*n,0)),o.mat4.mul(g,g,e),o.mat4.mul(g,f,g),o.mat4.fromScaling(_,c(r,n,1)),o.mat4.fromTranslation(A,c(t,-a,0)),o.mat4.mul(e,_,g),o.mat4.mul(e,A,e)}function v(e,t){const a=e.duration-1;return function(e,t){switch(t){case 0:return Math.min(e,1);case 2:return e%1;case 3:return 1-Math.abs(Math.min(e,2)-1);case 4:return 1-Math.abs(e%2-1)}}(t/a,2)*a}function w(e,t,a,r){if(e.step)return e.value;const n=e.value,s=t.value,i=e.tangentOut*r,o=t.tangentIn*r;return d.getPointHermite(n,s,i,o,a)}t.parse=function(e){const t=e.createDataView(),a=(t.getUint32(0),t.getUint32(4)),r=t.getUint32(8),d=t.getUint32(12),f=32+a+4*r,A=["animation_table","curve_table","fog_table","information","light_table","material_name_table","texture_table","vcd_table"],g=8===d,_=7===d;s.assert(_||g);const S=[];let v=f;const w=f+8*d;for(let a=0;a<d;a++){const r=32+t.getUint32(v+0),n=w+t.getUint32(v+4),i=s.readString(e,n,255,!0);s.assert(i===A[a]),S[a]=r,v+=8}const[x,T,y,C,M,U,k,D]=S,I=t.getUint32(k+0);let R=k+4;const B=[];for(let a=0;a<I;a++){const r=32+t.getUint32(R+0),n=s.readString(e,r,64,!0);B[a]=n,R+=4}const P=t.getUint32(x+0);let E=x+4;const F=[];for(let a=0;a<P;a++){const a=32+t.getUint32(E+0);E+=4;const r=32+t.getUint32(a+0),n=s.readString(e,r,64,!0),i=t.getFloat32(a+8),o=t.getUint32(a+12),l=t.getUint32(a+16);let c=null,h=null;if(0!==o){const a=32+o,r=t.getUint32(a+0);let n=a+4;const i=[];for(let a=0;a<r;a++){let a=32+t.getUint32(n+0);const r=32+t.getUint32(a+0),o=s.readString(e,r,64,!0),l=t.getFloat32(a+4),c=t.getFloat32(a+8),h=t.getFloat32(a+12),d=t.getFloat32(a+16),u=t.getFloat32(a+20),m=t.getFloat32(a+24),p=t.getFloat32(a+28),f=t.getFloat32(a+32),A=t.getFloat32(a+36),g=t.getUint32(a+88);a+=92;const _=[];for(let e=0;e<g;e++){const e=t.getFloat32(a+0);a+=4;const r=()=>{const e=t.getFloat32(a+0),r=t.getFloat32(a+4),n=t.getFloat32(a+8),s=!!t.getUint32(a+16);return a+=20,{value:e,tangentIn:r,tangentOut:n,step:s}},n=r(),s=r(),i=r(),o=r(),l=r(),c=r(),h=r(),d=r(),u=r();a+=240,_.push({time:e,translationX:n,translationY:s,translationZ:i,rotationX:o,rotationY:l,rotationZ:c,scaleX:h,scaleY:d,scaleZ:u})}n+=4,i.push({meshName:o,translationOffsetX:l,translationOffsetY:c,translationOffsetZ:h,rotationOffsetX:d,rotationOffsetY:u,rotationOffsetZ:m,scaleDividerX:p,scaleDividerY:f,scaleDividerZ:A,frames:_})}c={tracks:i}}if(0!==l){const a=32+l,r=t.getUint32(a+0);let n=a+4;const i=[];for(let a=0;a<r;a++){let a=32+t.getUint32(n+0);const r=32+t.getUint32(a+0),o=s.readString(e,r,64,!0),l=t.getUint32(a+4),c=t.getFloat32(a+8),h=t.getFloat32(a+12),d=t.getUint32(a+16);a+=20;const u=[];for(let e=0;e<d;e++){const e=t.getFloat32(a+0);a+=4;const r=()=>{const e=t.getFloat32(a+0),r=t.getFloat32(a+4),n=t.getFloat32(a+8),s=!!t.getUint32(a+16);return a+=20,{value:e,tangentIn:r,tangentOut:n,step:s}},n=r(),s=r(),i=r(),o=r(),l=r();u.push({time:e,translationS:n,translationT:s,scaleS:i,scaleT:o,rotation:l})}n+=4,i.push({materialName:o,texGenIndex:l,skewS:c,skewT:h,frames:u})}h={tracks:i}}F.push({name:n,duration:i,materialAnimation:h,meshAnimation:c})}const V=t.getUint32(U+0);let O=U+4;const N=new Map,L=[];for(let a=0;a<V;a++){const r=s.readString(e,32+t.getUint32(O+0)),n=32+t.getUint32(O+4);O+=8;const i=s.readString(e,32+t.getUint32(n+0));s.assert(r===i);const l=c.colorNewFromRGBA8(t.getUint32(n+4)),h=t.getUint8(n+8);let d=0;const u=t.getUint8(n+10);s.assert(u<=2),d=Math.max(d,u);const m=t.getUint8(n+11),f=new p.GXMaterialBuilder(r),A=[],g=[];let _=n+12,S=n+44;for(let a=0;a<m;a++){const r=32+t.getUint32(_),n=32+t.getUint32(r+0),i=t.getUint32(r+4);s.assert(0===i);const l=t.getUint8(r+8),c=t.getUint8(r+9),h=t.getUint8(r+10);s.assert(h<=2),d=Math.max(d,h);const u=s.readString(e,32+t.getUint32(n+0)),p=(t.getUint8(n+4),t.getUint16(n+8),t.getUint16(n+10),t.getUint8(n+12));s.assert(0===p);const v=m-a-1,w=[30,33,36,39,42,45,48,51];f.setTexCoordGen(0+a,1,4+v,w[v]),A[v]={textureName:u,wrapS:l,wrapT:c};const x=t.getFloat32(S+0),T=t.getFloat32(S+4),y=t.getFloat32(S+8),C=t.getFloat32(S+12),M=t.getFloat32(S+16),U=t.getFloat32(S+20),k=t.getFloat32(S+24);g[v]=o.mat4.create(),b(g[v],x,T,y,C,M,U,k),_+=4,S+=28}f.setChanCtrl(4,!1,1,h,0,0,2);const v=t.getUint32(n+272);let w=0;if(0!==v){const e=32+v;w=t.getUint8(e+0)}if(0===m?(f.setTevOrder(0,0,0,0),f.setTevColorIn(0,15,15,15,10),f.setTevAlphaIn(0,7,7,7,5),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0)):0===w?(f.setTevOrder(0,0,0,0),f.setTevColorIn(0,15,10,8,15),f.setTevAlphaIn(0,7,5,4,7),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0)):1===w?(f.setTevOrder(0,0,0,7),f.setTevColorIn(0,15,15,15,8),f.setTevAlphaIn(0,7,7,7,4),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0),f.setTevOrder(1,1,1,7),f.setTevColorIn(1,0,8,9,15),f.setTevAlphaIn(1,7,7,7,0),f.setTevColorOp(1,0,0,0,!0,0),f.setTevAlphaOp(1,0,0,0,!0,0),f.setTevOrder(2,255,255,0),f.setTevColorIn(2,15,0,10,15),f.setTevAlphaIn(2,7,0,5,7),f.setTevColorOp(2,0,0,0,!0,0),f.setTevAlphaOp(2,0,0,0,!0,0)):2===w?(f.setTevOrder(0,0,0,7),f.setTevColorIn(0,15,15,15,8),f.setTevAlphaIn(0,7,7,7,4),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0),f.setTevOrder(1,1,1,7),f.setTevColorIn(1,15,0,9,15),f.setTevAlphaIn(1,7,0,4,7),f.setTevColorOp(1,0,0,0,!0,0),f.setTevAlphaOp(1,0,0,0,!0,0),f.setTevOrder(2,255,255,0),f.setTevColorIn(2,15,0,10,15),f.setTevAlphaIn(2,7,0,5,7),f.setTevColorOp(2,0,0,0,!0,0),f.setTevAlphaOp(2,0,0,0,!0,0)):3===w?(f.setTevOrder(0,0,0,7),f.setTevColorIn(0,15,15,15,8),f.setTevAlphaIn(0,7,7,7,4),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0),f.setTevOrder(1,1,1,7),f.setTevColorIn(1,0,15,9,15),f.setTevAlphaIn(1,0,7,4,7),f.setTevColorOp(1,0,0,0,!0,0),f.setTevAlphaOp(1,0,0,0,!0,0),f.setTevOrder(2,255,255,0),f.setTevColorIn(2,15,0,10,15),f.setTevAlphaIn(2,7,0,5,7),f.setTevColorOp(2,0,0,0,!0,0),f.setTevAlphaOp(2,0,0,0,!0,0)):4===w?(f.setTevOrder(0,0,0,7),f.setTevColorIn(0,15,15,15,8),f.setTevAlphaIn(0,7,7,7,4),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0),f.setTevOrder(1,1,1,7),f.setTevColorIn(1,15,0,8,15),f.setTevAlphaIn(1,7,0,4,7),f.setTevColorOp(1,0,0,0,!0,0),f.setTevAlphaOp(1,0,0,0,!0,0),f.setTevOrder(2,0,0,7),f.setTevColorIn(2,8,0,1,15),f.setTevAlphaIn(2,7,7,7,4),f.setTevColorOp(2,0,0,0,!0,0),f.setTevAlphaOp(2,0,0,0,!0,0)):5===w?(f.setTevOrder(0,0,0,7),f.setTevColorIn(0,15,15,15,8),f.setTevAlphaIn(0,7,7,7,4),f.setTevColorOp(0,0,0,0,!0,1),f.setTevAlphaOp(0,0,0,0,!0,1),f.setTevOrder(1,1,1,7),f.setTevColorIn(1,15,15,15,8),f.setTevAlphaIn(1,7,7,7,4),f.setTevColorOp(1,0,0,0,!0,2),f.setTevAlphaOp(1,0,0,0,!0,2),f.setTevOrder(2,2,2,7),f.setTevColorIn(2,2,4,9,15),f.setTevAlphaIn(2,1,2,4,7),f.setTevColorOp(2,0,0,0,!0,0),f.setTevAlphaOp(2,0,0,0,!0,0),f.setTevOrder(3,255,255,0),f.setTevColorIn(3,15,0,10,15),f.setTevAlphaIn(3,7,0,5,7),f.setTevColorOp(3,0,0,0,!0,0),f.setTevAlphaOp(3,0,0,0,!0,0)):6===w?(f.setTevOrder(0,0,0,7),f.setTevColorIn(0,15,15,15,8),f.setTevAlphaIn(0,7,7,7,4),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0),f.setTevOrder(1,1,1,7),f.setTevColorIn(1,0,8,1,15),f.setTevAlphaIn(1,7,4,0,7),f.setTevColorOp(1,0,0,0,!0,0),f.setTevAlphaOp(1,0,0,0,!0,0),f.setTevOrder(2,255,255,0),f.setTevColorIn(2,15,0,10,15),f.setTevAlphaIn(2,7,0,5,7),f.setTevColorOp(2,0,0,0,!0,0),f.setTevAlphaOp(2,0,0,0,!0,0)):7===w?(f.setTevOrder(0,0,0,7),f.setTevColorIn(0,15,15,15,8),f.setTevAlphaIn(0,7,7,7,4),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0),f.setTevOrder(1,1,1,7),f.setTevColorIn(1,0,8,9,15),f.setTevAlphaIn(1,0,7,4,4),f.setTevColorOp(1,0,0,0,!0,0),f.setTevAlphaOp(1,0,0,0,!0,0),f.setTevOrder(2,255,255,0),f.setTevColorIn(2,15,0,10,15),f.setTevAlphaIn(2,7,0,5,7),f.setTevColorOp(2,0,0,0,!0,0),f.setTevAlphaOp(2,0,0,0,!0,0)):(console.error(`Unimplemented TEV mode ${w}`),f.setTevOrder(0,0,0,0),f.setTevColorIn(0,15,10,8,15),f.setTevAlphaIn(0,7,5,4,7),f.setTevColorOp(0,0,0,0,!0,0),f.setTevAlphaOp(0,0,0,0,!0,0)),0===d)f.setBlendMode(0,1,0),f.setAlphaCompare(7,0,0,7,0),f.setZMode(!0,3,!0);else if(1===d)f.setBlendMode(0,1,0),f.setAlphaCompare(6,128,1,0,0),f.setZMode(!0,3,!0);else{if(2!==d)throw"whoops";f.setBlendMode(1,4,5),f.setAlphaCompare(7,0,0,7,0),f.setZMode(!0,3,!1)}const x={index:a,name:r,materialLayer:d,samplers:A,gxMaterial:f.finish(),matColorReg:l,texMtx:g};N.set(n,x),L.push(x)}s.assert(32===C);const G=s.readString(e,32+t.getUint32(C+0));_?s.assert("ver1.00"===G):g&&s.assert("ver1.02"===G);const H=s.readString(e,32+t.getUint32(C+8)),j=s.readString(e,32+t.getUint32(C+12)),W=_?"":s.readString(e,32+t.getUint32(C+16)),Z=function a(r){const c=s.readString(e,32+t.getUint32(r+0)),d=s.readString(e,32+t.getUint32(r+4)),p=(t.getUint32(r+8),t.getUint32(r+12)),f=t.getUint32(r+16),A=(t.getUint32(r+20),t.getFloat32(r+24)),_=t.getFloat32(r+28),S=t.getFloat32(r+32),b=.01745*t.getFloat32(r+36),v=.01745*t.getFloat32(r+40),w=.01745*t.getFloat32(r+44),x=t.getFloat32(r+48),T=t.getFloat32(r+52),y=t.getFloat32(r+56),C=t.getFloat32(r+60),M=t.getFloat32(r+64),U=t.getFloat32(r+68),k=t.getFloat32(r+72),I=t.getFloat32(r+76),R=t.getFloat32(r+80),B=new l.AABB(C,M,U,k,I,R),P=o.mat4.create();h.computeModelMatrixSRT(P,A,_,S,b,v,w,x,T,y);const E=32+t.getUint32(r+88),F=[1,2,3,0][t.getUint8(E+1)],V=t.getUint8(E+2),O=t.getUint32(E+8),L=t.getUint32(r+92),G=[];let H=!1;for(let a=0,n=r+96;a<L;a++,n+=8){const a=t.getUint32(n+0);if(0===a)continue;const r=s.assertExists(N.get(32+a));2===r.materialLayer&&(H=!0);const o=32+t.getUint32(n+4),l=!!t.getUint8(o+3),c=32+t.getUint32(o+12),h=[];h[9]={buffer:e,offs:32+t.getUint32(c+0)+4,stride:6},h[10]={buffer:e,offs:32+t.getUint32(c+4)+4,stride:6};const d=t.getUint32(c+8);s.assert(1===d),h[11]={buffer:e,offs:32+t.getUint32(c+12)+4,stride:4},s.assert(0===t.getUint32(c+16));const p=t.getUint32(c+20);if(s.assert(p<=3),h[13]={buffer:e,offs:32+t.getUint32(c+24)+4,stride:4},h[14]={buffer:e,offs:32+t.getUint32(c+28)+4,stride:4},h[15]={buffer:e,offs:32+t.getUint32(c+32)+4,stride:4},l){const a=t.getUint32(o+4),n=t.getUint32(o+8),l=32+t.getUint32(o+12);s.assert(g),s.assert(l===D);let c=n;const d=[],u=[];s.assert(0!=(1&c)),0!=(1&c)&&(d[9]={compType:3,compCnt:1,compShift:t.getUint32(l+68)},u[9]={type:3},c&=-2),0!=(2&c)&&(d[10]={compType:3,compCnt:0,compShift:0},u[10]={type:3},c&=-3),0!=(4&c)&&(d[11]={compType:5,compCnt:1,compShift:0},u[11]={type:3},c&=-5),0!=(16&c)&&(d[13]={compType:3,compCnt:1,compShift:t.getUint32(l+72)},u[13]={type:3},c&=-17),0!=(32&c)&&(d[14]={compType:3,compCnt:1,compShift:t.getUint32(l+76)},u[14]={type:3},c&=-33),0!=(64&c)&&(d[15]={compType:3,compCnt:1,compShift:t.getUint32(l+80)},u[15]={type:3},c&=-65),s.assert(0===c);const m=i.compileVtxLoader(d,u),p=m.loadedVertexLayout;let f=o+16;const A=[];let _=0;for(let r=0;r<a;r++){const a=32+t.getUint32(f+0),r=t.getUint32(f+4),n=m.runVertices(h,e.subarray(a,r),{firstVertexId:_});_=n.vertexId,A.push(n),f+=8}const S={loadedVertexLayout:p,loadedVertexData:i.coalesceLoadedDatas(p,A)};G.push({material:r,batch:S})}else{const e=0===m.getSystemEndianness(),a=t.getUint32(o+4),n=t.getUint32(o+8);s.assert(a===n);const l=[],d=[];l[9]={compType:4,compCnt:1,compShift:t.getUint32(c+68)},d[9]={type:3},l[10]={compType:4,compCnt:0,compShift:0},d[10]={type:3},l[11]={compType:5,compCnt:1,compShift:0},d[11]={type:3},l[13]={compType:4,compCnt:1,compShift:t.getUint32(c+72)},d[13]={type:3},l[14]={compType:4,compCnt:1,compShift:t.getUint32(c+76)},d[14]={type:3},l[15]={compType:4,compCnt:1,compShift:t.getUint32(c+80)},d[15]={type:3};const p=i.compileLoadedVertexLayout([l],d);let f=o+16;const A=[];let g=0;for(let r=0;r<a;r++){const a=32+t.getUint32(f+0),r=t.getUint32(a+0),n=new ArrayBuffer(p.vertexBufferStrides[0]*r),i=new DataView(n);let o=a+4,l=0;for(let a=0;a<r;a++){const a=t.getUint16(o+0),r=t.getUint16(o+2),n=t.getUint16(o+4),c=t.getUint16(o+8),d=t.getUint16(o+10),u=t.getUint16(o+12);s.assert(65535!==a);const m=p.singleVertexInputLayouts[0],f=h[9].offs+12*a,A=t.getFloat32(f+0),g=t.getFloat32(f+4),_=t.getFloat32(f+8);if(i.setFloat32(l+m.bufferOffset+0,A,e),i.setFloat32(l+m.bufferOffset+4,g,e),i.setFloat32(l+m.bufferOffset+8,_,e),65535!==r){const a=p.singleVertexInputLayouts[1],n=h[10].offs+12*r,s=t.getFloat32(n+0),o=t.getFloat32(n+4),c=t.getFloat32(n+8);i.setFloat32(l+a.bufferOffset+0,s,e),i.setFloat32(l+a.bufferOffset+4,o,e),i.setFloat32(l+a.bufferOffset+8,c,e)}if(65535!==n){const e=p.singleVertexInputLayouts[2],a=h[11].offs+4*n,r=t.getUint8(a+0),s=t.getUint8(a+1),o=t.getUint8(a+2),c=t.getUint8(a+3);i.setUint8(l+e.bufferOffset+0,r),i.setUint8(l+e.bufferOffset+1,s),i.setUint8(l+e.bufferOffset+2,o),i.setUint8(l+e.bufferOffset+3,c)}if(65535!==c){const a=p.singleVertexInputLayouts[3],r=h[13].offs+8*c,n=t.getFloat32(r+0),s=t.getFloat32(r+4);i.setFloat32(l+a.bufferOffset+0,n,e),i.setFloat32(l+a.bufferOffset+4,s,e)}if(65535!==d){const a=p.singleVertexInputLayouts[4],r=h[14].offs+8*d,n=t.getFloat32(r+0),s=t.getFloat32(r+4);i.setFloat32(l+a.bufferOffset+0,n,e),i.setFloat32(l+a.bufferOffset+4,s,e)}if(65535!==u){const a=p.singleVertexInputLayouts[5],r=h[15].offs+8*u,n=t.getFloat32(r+0),s=t.getFloat32(r+4);i.setFloat32(l+a.bufferOffset+0,n,e),i.setFloat32(l+a.bufferOffset+4,s,e)}o+=24,l+=p.vertexBufferStrides[0]}const c=u.makeTriangleIndexBuffer(1,g,r);g+=r;const d=c.length,m=c.buffer,_=r,S=[n];A.push({indexData:m,packets:[],totalIndexCount:d,totalVertexCount:_,vertexBuffers:S,vertexId:g}),f+=4}const _={loadedVertexLayout:p,loadedVertexData:i.coalesceLoadedDatas(p,A)};G.push({material:r,batch:_})}}const j=[];if(0!==p){let e=a(32+p);for(;null!==e;)j.unshift(e),e=e.nextSibling}let W=null;return 0!==f&&(W=a(32+f)),{nameStr:c,typeStr:d,modelMatrix:P,bbox:B,children:j,parts:G,isTranslucent:H,renderFlags:{cullMode:n.translateCullMode(F)},drawModeFlags:V,collisionFlags:O,nextSibling:W}}(32+t.getUint32(C+4));return s.assert(null===Z.nextSibling),{information:{versionStr:G,aNodeStr:j,sNodeStr:H,dateStr:W},textureNameTable:B,rootNode:Z,materials:L,animations:F}};class x{constructor(e,t,a){this.animationController=e,this.animation=t,this.track=a}calcModelMtx(e){const t=this.animationController.getTimeInFrames(),a=v(this.animation,t),r=this.track.frames;let n,s;if(1===r.length)n=s=r[0];else{const e=r.findIndex(e=>a<e.time);if(e<0)n=s=r[r.length-1];else{n=r[e-1],s=r[e]}}const i=s.time-n.time;let o=i>0?(a-n.time)/i:0;const l=w(n.translationX,s.translationX,o,i)-this.track.translationOffsetX,c=w(n.translationY,s.translationY,o,i)-this.track.translationOffsetY,d=w(n.translationZ,s.translationZ,o,i)-this.track.translationOffsetZ,u=.01745*(w(n.rotationX,s.rotationX,o,i)-this.track.rotationOffsetX),m=.01745*(w(n.rotationY,s.rotationY,o,i)-this.track.rotationOffsetY),p=.01745*(w(n.rotationZ,s.rotationZ,o,i)-this.track.rotationOffsetZ),f=w(n.scaleX,s.scaleX,o,i)/this.track.scaleDividerX,A=w(n.scaleY,s.scaleY,o,i)/this.track.scaleDividerY,g=w(n.scaleZ,s.scaleZ,o,i)/this.track.scaleDividerZ;h.computeModelMatrixSRT(e,f,A,g,u,m,p,l,c,d)}}t.MeshAnimator=x,t.bindMeshAnimator=function(e,t,a){const r=function(e,t){if(null!==e.meshAnimation){const a=e.meshAnimation.tracks.find(e=>e.meshName===t);if(a)return a}return null}(t,a);return null!==r?new x(e,t,r):null};class T{constructor(e,t,a){this.animationController=e,this.animation=t,this.track=a}calcTexMtx(e){const t=this.animationController.getTimeInFrames(),a=v(this.animation,t),r=this.track.frames;let n,s;if(1===r.length)n=s=r[0];else{const e=r.findIndex(e=>a<e.time);if(e<0)n=s=r[r.length-1];else{n=r[e-1],s=r[e]}}const i=s.time-n.time;let o=i>0?(a-n.time)/i:0;const l=this.track.skewS,c=this.track.skewT,h=w(n.scaleS,s.scaleT,o,i),d=w(n.scaleT,s.scaleT,o,i),u=w(n.rotation,s.rotation,o,i);b(e,w(n.translationS,s.translationS,o,i),w(n.translationT,s.translationT,o,i),h,d,u,l,c)}}function y(e,t){return e===t||e===t.replace(/_[vx]/g,"")}t.MaterialAnimator=T,t.bindMaterialAnimator=function(e,t,a,r){const n=function(e,t,a){if(null!==e.materialAnimation)for(const r of e.materialAnimation.tracks)if(y(r.materialName,t)&&a===r.texGenIndex)return r;return null}(t,a,r);return null!==n?new T(e,t,n):null}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(27)),i=r(a(29)),o=r(a(49)),l=r(a(11)),c=a(119),h=a(0),d=a(41),u=n(a(18)),m=a(5),p={lightingFudge:e=>`(0.5 * (${e.ambSource} + 0.2) * ${e.matSource})`};class f extends m.BasicGXRendererHelper{constructor(e,t,a=new d.RRESTextureHolder){super(e),this.stageRRESes=t,this.textureHolder=a,this.modelInstances=[],this.models=[],this.scn0Animators=[],this.lightSettings=[],this.animationController=new u.default;for(let a=0;a<t.length;a++){const r=t[a];this.textureHolder.addRRESTextures(e,r);let n=null;if(r.scn0.length>0){n=new i.LightSetting;const e=new i.SCN0Animator(this.animationController,r.scn0[0]);this.lightSettings.push(n),this.scn0Animators.push(e)}for(let t=0;t<r.mdl0.length;t++){const a=new d.MDL0Model(e,this.getCache(),r.mdl0[t],n?void 0:p);this.models.push(a);const s=new d.MDL0ModelInstance(this.textureHolder,a);this.modelInstances.push(s),s.bindRRESAnimations(this.animationController,r),null!==n&&s.bindLightSetting(n)}}}createPanels(){const e=[];if(this.modelInstances.length>1){const t=new l.LayerPanel;t.setLayers(this.modelInstances),e.push(t)}return e}prepareToRender(e,t,a){this.animationController.setTimeInMilliseconds(a.time);for(let e=0;e<this.scn0Animators.length;e++)this.scn0Animators[e].calcLightSetting(this.lightSettings[e]);const r=this.renderHelper.pushTemplateRenderInst();m.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}destroy(e){super.destroy(e),this.textureHolder.destroy(e);for(let t=0;t<this.models.length;t++)this.models[t].destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e)}}function A(e,t){const a=[];return function e(t,a){for(let r=0;r<a.files.length;r++)if((a.files[r].name.endsWith(".brres")||a.files[r].name.endsWith(".brtex"))&&t.push(i.parse(a.files[r].buffer)),a.files[r].name.endsWith(".arc")){e(t,o.parse(a.files[r].buffer).root)}for(let r=0;r<a.subdirs.length;r++)e(t,a.subdirs[r])}(a,t.root),console.log(t,a),new f(e,a)}t.BasicRRESRenderer=f,t.createBasicRRESRendererFromBRRES=function(e,t){const a=t.map(e=>i.parse(e));return new f(e,a)},t.createBasicRRESRendererFromU8Archive=A,t.createBasicRRESRendererFromU8Buffer=function(e,t){return Promise.resolve(t).then(e=>"Yaz0"===h.readString(e,0,4)?s.decompress(e):e).then(t=>{const a=o.parse(t);return A(e,a)})},t.createSceneFromU8Buffer=function(e,t){const a=e.device,r=o.parse(t);return null!==r.findFile("./course.kmp")?c.createMarioKartWiiSceneFromU8Archive(a,r):A(a,r)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GlobalCursorOverride=new class{constructor(){this.styleElem=document.createElement("style"),document.head.appendChild(this.styleElem),this.style=this.styleElem.sheet}setCursor(e){if(this.style.cssRules.length&&this.style.deleteRule(0),e){const t=`* { ${e.map(e=>`cursor: ${e} !important;`).join(" ")} }`;this.style.insertRule(t,0)}}};class r{constructor(){this.grabListener=null,this.grabOptions=null,this.lastX=-1,this.lastY=-1,this._onMouseMove=e=>{if(null===this.grabListener)return;let t,a;void 0!==e.movementX?(t=e.movementX,a=e.movementY):(t=e.pageX-this.lastX,a=e.pageY-this.lastY,this.lastX=e.pageX,this.lastY=e.pageY),this.grabListener.onMotion(t,a)},this._onMouseDown=e=>{const t=this.grabOptions.grabElement;t&&!function(e,t){let a=e;for(;null!==a;){if(a===t)return!0;a=a.parentElement}return!1}(e.target,t)&&this.releaseGrab()},this._onMouseUp=e=>{this.releaseGrab()}}hasGrabListener(e){return this.grabListener===e}isGrabbed(){return null!==this.grabListener}takeGrab(e,a,r){if(null!==this.grabListener)return;this.grabListener=e,this.grabOptions=r,r.useGrabbingCursor&&t.GlobalCursorOverride.setCursor(["grabbing","-webkit-grabbing"]),this.lastX=a.pageX,this.lastY=a.pageY,document.body.focus(),a.preventDefault();const n=a.target;r.takePointerLock&&void 0!==n.requestPointerLock&&n.requestPointerLock(),document.addEventListener("mousemove",this._onMouseMove),r.releaseOnMouseUp?document.addEventListener("mouseup",this._onMouseUp):document.addEventListener("mousedown",this._onMouseDown,{capture:!0})}releaseGrab(){document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("mousedown",this._onMouseDown,{capture:!0}),void 0!==document.exitPointerLock&&document.exitPointerLock(),t.GlobalCursorOverride.setCursor(null);const e=this.grabListener;this.grabListener=null,e.onGrabReleased(),this.grabOptions=null}}t.GrabManager=r,t.GlobalGrabManager=new r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Buffer=0]="Buffer",e[e.Texture=1]="Texture",e[e.Attachment=2]="Attachment",e[e.Sampler=3]="Sampler",e[e.Program=4]="Program",e[e.Bindings=5]="Bindings",e[e.InputLayout=6]="InputLayout",e[e.InputState=7]="InputState",e[e.RenderPipeline=8]="RenderPipeline",e[e.Readback=9]="Readback"}(t._T||(t._T={}));t.GfxBugQuirksImpl=class{constructor(){this.rowMajorMatricesBroken=!1}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(14);function n(e,t){const a=Array(e.length);for(let r=0;r<e.length;r++)a[r]=t(e[r]);return a}function s(e,t,a){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!a(e[r],t[r]))return!1;return!0}function i(e){return{gfxSampler:e.gfxSampler,gfxTexture:e.gfxTexture}}function o(e){return{buffer:e.buffer,wordOffset:e.wordOffset,wordCount:e.wordCount}}function l(e){return{numSamplers:e.numSamplers,numUniformBuffers:e.numUniformBuffers}}function c(e,t){return e.buffer===t.buffer&&e.wordCount===t.wordCount&&e.wordOffset===t.wordOffset}function h(e,t){return null===e?null===t:null!==t&&(e.gfxSampler===t.gfxSampler&&e.gfxTexture===t.gfxTexture)}function d(e,t){return e.blendMode==t.blendMode&&e.blendSrcFactor===t.blendSrcFactor&&e.blendDstFactor===t.blendDstFactor}function u(e,t){return!!d(e.rgbBlendState,t.rgbBlendState)&&(!!d(e.alphaBlendState,t.alphaBlendState)&&e.colorWriteMask===t.colorWriteMask)}function m(e,t){return e.numSamplers===t.numSamplers&&e.numUniformBuffers===t.numUniformBuffers}function p(e,t){return e.bufferIndex===t.bufferIndex&&e.bufferByteOffset===t.bufferByteOffset&&e.location===t.location&&e.format===t.format}function f(e,t){return null===e?null===t:null!==t&&(e.byteStride===t.byteStride&&e.frequency===t.frequency)}t.gfxSamplerBindingCopy=i,t.gfxBufferBindingCopy=o,t.gfxBindingsDescriptorCopy=function(e){return{bindingLayout:e.bindingLayout,samplerBindings:n(e.samplerBindings,i),uniformBufferBindings:n(e.uniformBufferBindings,o)}},t.gfxBindingLayoutDescriptorCopy=l,t.gfxRenderPipelineDescriptorCopy=function(e){const t=n(e.bindingLayouts,l),a=e.inputLayout,s=e.program,i=e.topology;return{bindingLayouts:t,inputLayout:a,megaStateDescriptor:r.copyMegaState(e.megaStateDescriptor),program:s,topology:i,sampleCount:e.sampleCount}},t.gfxBindingsDescriptorEquals=function(e,t){return e.samplerBindings.length===t.samplerBindings.length&&(!!s(e.samplerBindings,t.samplerBindings,h)&&(!!s(e.uniformBufferBindings,t.uniformBufferBindings,c)&&e.bindingLayout===t.bindingLayout))},t.gfxRenderPipelineDescriptorEquals=function(e,t){return e.topology===t.topology&&(e.inputLayout===t.inputLayout&&(e.sampleCount===t.sampleCount&&(!!function(e,t){return!!s(e.attachmentsState,t.attachmentsState,u)&&(a=e.blendConstant,r=t.blendConstant,a.r===r.r&&a.g===r.g&&a.b===r.b&&a.a===r.a&&(e.depthCompare===t.depthCompare&&e.depthWrite===t.depthWrite&&e.stencilCompare===t.stencilCompare&&e.stencilWrite===t.stencilWrite&&e.stencilPassOp===t.stencilPassOp&&e.cullMode===t.cullMode&&e.frontFace===t.frontFace&&e.polygonOffset===t.polygonOffset));var a,r}(e.megaStateDescriptor,t.megaStateDescriptor)&&(!!function(e,t){return e.ResourceUniqueId===t.ResourceUniqueId}(e.program,t.program)&&!!s(e.bindingLayouts,t.bindingLayouts,m)))))},t.gfxVertexAttributeDescriptorEquals=p,t.gfxInputLayoutBufferDescriptorEquals=f,t.gfxInputLayoutDescriptorEquals=function(e,t){return e.indexBufferFormat===t.indexBufferFormat&&(!!s(e.vertexBufferDescriptors,t.vertexBufferDescriptors,f)&&!!s(e.vertexAttributeDescriptors,t.vertexAttributeDescriptors,p))},t.gfxSamplerDescriptorEquals=function(e,t){return e.wrapS===t.wrapS&&e.wrapT===t.wrapT&&e.minFilter===t.minFilter&&e.magFilter===t.magFilter&&e.mipFilter===t.mipFilter&&e.minLOD===t.minLOD&&e.maxLOD===t.maxLOD}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);function n(e){return 0}t.hashCodeNumberUpdate=function(e,t){return e+=t,e+=e<<10,(e+=e>>>6)>>>0},t.hashCodeNumberFinish=function(e){return e+=e<<3,e^=e>>>11,(e+=e<<15)>>>0},t.nullHashFunc=n;class s{constructor(){this.keys=[],this.values=[]}}t.HashMap=class{constructor(e,t,a=16,s=null){this.keyEqualFunc=e,this.keyHashFunc=t,this.autoLoadFactor=s,this.needsReconfigure=!1,t===n&&(a=1),this.buckets=r.nArray(a,()=>null)}findBucketIndex(e,t){for(let a=0;a<e.keys.length;a++)if(this.keyEqualFunc(t,e.keys[a]))return a;return-1}findBucket(e){const t=this.keyHashFunc(e)%this.buckets.length;return this.buckets[t]}get(e){const t=this.findBucket(e);if(null===t)return null;const a=this.findBucketIndex(t,e);return a<0?null:t.values[a]}add(e,t){const a=this.keyHashFunc(e)%this.buckets.length;null===this.buckets[a]&&(this.buckets[a]=new s);const r=this.buckets[a];r.keys.push(e),r.values.push(t),null!==this.autoLoadFactor&&this.checkForReconfigure()}delete(e){const t=this.findBucket(e);if(null===t)return;const a=this.findBucketIndex(t,e);-1!==a&&(t.keys.splice(a,1),t.values.splice(a,1))}clear(){for(let e=0;e<this.buckets.length;e++){const t=this.buckets[e];null!==t&&(t.keys=[],t.values=[])}}size(){let e=0;for(let t=0;t<this.buckets.length;t++){const a=this.buckets[t];null!==a&&(e+=a.keys.length)}return e}*entries(){for(let e=0;e<this.buckets.length;e++){const t=this.buckets[e];if(null!==t)for(let e=t.keys.length-1;e>=0;e--)yield[t.keys[e],t.values[e]]}}checkForReconfigure(){if(this.needsReconfigure)return;Math.ceil(this.size()/r.assertExists(this.autoLoadFactor))<=this.buckets.length||(this.needsReconfigure=!0,requestAnimationFrame(()=>this.manuallyReconfigure()))}manuallyReconfigure(){let e=Math.ceil(this.size()/r.assertExists(this.autoLoadFactor));if(e<=this.buckets.length)return;const t=r.nArray(e,()=>null);for(let e=0;e<this.buckets.length;e++){const a=this.buckets[e];if(null!==a)for(let e=0;e<a.keys.length;e++){const r=this.keyHashFunc(a.keys[e])%t.length;null===t[r]&&(t[r]=new s);const n=t[r];n.keys.push(a.keys[e]),n.values.push(a.values[e])}}this.buckets=t,this.needsReconfigure=!1}calcLoadFactor(){return this.size()/this.buckets.length}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.yaz0_asInstance=function(e){return WebAssembly.compile(Uint8Array.from(window.atob("AGFzbQEAAAABBwFgA39/fwADAgEABQMBAAAHFwIGbWVtb3J5AgAKZGVjb21wcmVzcwAACpECAY4CAQZ/A0AgASIDQQFqIQEgAy0AACEHQQghBgNAIAYiA0EBayEGIAMEQCAHQQEgBnRxBEAgAkEBayECIAAiA0EBaiEAIAEiBEEBaiEBIAMgBC0AADoAAAUgAS8BACIDQQh0IANB//8DcUEIdnIhAyABQQJqIQEgA0H/H3FBAWohBCADQf//A3FBDHZBAmpB/wFxIgVBAkYEQCABIgNBAWohASAFIAMtAABBEGpqIQULIAAgBEH//wNxayEDIAIgBUH//wNxayECA0AgBSIEQQFrIQUgBEH//wNxBEAgACIEQQFqIQAgAyIIQQFqIQMgBCAILQAAOgAADAELCwsgAkEATARADwsMAQsLDAAACwAL"),(function(e){return e.charCodeAt(0)}))).then(t=>WebAssembly.instantiate(t,e)).then(e=>e.exports)};t.gx_texture_asInstance=function(e){return WebAssembly.compile(Uint8Array.from(window.atob("AGFzbQEAAAABCQFgBX9/f39/AAMJCAAAAAAAAAAABQMBAAAHeQkGbWVtb3J5AgAJZGVjb2RlX0k0AAAJZGVjb2RlX0k4AAEKZGVjb2RlX0lBNAACCmRlY29kZV9JQTgAAw1kZWNvZGVfUkdCNTY1AAQNZGVjb2RlX1JHQjVBMwAFDGRlY29kZV9SR0JBOAAGC2RlY29kZV9DTVBSAAcK2RQIwAEBBX9BACEAA0AgACAESQRAQQAhBQNAIAUgA0kEQEEAIQYDQCAGQQhIBEBBACEHA0AgB0EISARAQQEgACAGaiAETyAFIAdqIANPG0UEQCABIAcgBSADIAAgBmpsampBAnRqIAIgCEEBdmotAABBAEEEIAhBAXEbdkEPcSIJIAlBBHRyQYGChAhsNgIACyAHQQFqIQcgCEEBaiEIDAELCyAGQQFqIQYMAQsLIAVBCGohBQwBCwsgAEEIaiEADAELCwunAQEEf0EAIQADQCAAIARJBEBBACEFA0AgBSADSQRAQQAhBgNAIAZBBEgEQEEAIQcDQCAHQQhIBEBBASAAIAZqIARPIAUgB2ogA08bRQRAIAEgByAFIAMgACAGamxqakECdGogAiAIai0AAEGBgoQIbDYCAAsgB0EBaiEHIAhBAWohCAwBCwsgBkEBaiEGDAELCyAFQQhqIQUMAQsLIABBBGohAAwBCwsL0AEBBn9BACEAA0AgACAESQRAQQAhBQNAIAUgA0kEQEEAIQYDQCAGQQRIBEBBACEHA0AgB0EISARAQQEgACAGaiAETyAFIAdqIANPG0UEQCACIApqLQAAIghBBHYiCSAJQQR0ciEJIAEgByAFIAMgACAGamxqakECdGogCEEPcSIIIAhBBHRyQf8BcUGBggRsIAlB/wFxQRh0cjYCAAsgB0EBaiEHIApBAWohCgwBCwsgBkEBaiEGDAELCyAFQQhqIQUMAQsLIABBBGohAAwBCwsLtQEBBH9BACEAA0AgACAESQRAQQAhBQNAIAUgA0kEQEEAIQYDQCAGQQRIBEBBACEHA0AgB0EESARAQQEgACAGaiAETyAFIAdqIANPG0UEQCABIAcgBSADIAAgBmpsampBAnRqIAIgCGpBAWotAABBgYIEbCACIAhqLQAAQRh0cjYCAAsgB0EBaiEHIAhBAmohCAwBCwsgBkEBaiEGDAELCyAFQQRqIQUMAQsLIABBBGohAAwBCwsLiAIBCH9BACEAA0AgACAESQRAQQAhBQNAIAUgA0kEQEEAIQYDQCAGQQRIBEBBACEHA0AgB0EESARAQQEgACAGaiAETyAFIAdqIANPG0UEQCABIAcgBSADIAAgBmpsampBAnRqIgkgAiALai8BACIIQQh0IAhB//8DcUEIdnIiCEH//wNxIgpBC3YiDEEDdCAMQQJ2cjoAACAJQQFqIApBBXZBP3EiCkECdCAKQQR2cjoAACAJQQJqIAhBH3EiCEEDdCAIQQJ2cjoAACAJQQNqQf8BOgAACyAHQQFqIQcgC0ECaiELDAELCyAGQQFqIQYMAQsLIAVBBGohBQwBCwsgAEEEaiEADAELCwv/AgEIfwNAIAsgBEkEQEEAIQcDQCAHIANJBEBBACEIA0AgCEEESARAQQAhCQNAIAlBBEgEQEEBIAggC2ogBE8gByAJaiADTxtFBEAgASAJIAcgAyAIIAtqbGpqQQJ0aiEAIAIgDGovAQAiBUEIdCAFQf//A3FBCHZyIgVBgIACcQRAIAAgBUH//wNxIgZBCnZBH3EiCkEDdCAKQQJ2cjoAACAAQQFqIAZBBXZBH3EiBkEDdCAGQQJ2cjoAACAAQQJqIAVBH3EiBUEDdCAFQQJ2cjoAACAAQQNqQf8BOgAABSAAIAVB//8DcSIGQQh2QQ9xIgogCkEEdHI6AAAgAEEBaiAGQQR2QQ9xIgogCkEEdHI6AAAgAEECaiAFQQ9xIgUgBUEEdHI6AAAgAEEDaiAGQQx2IgBBBXQgAEECdHIgAEH/AXFBAXZyOgAACwsgCUEBaiEJIAxBAmohDAwBCwsgCEEBaiEIDAELCyAHQQRqIQcMAQsLIAtBBGohCwwBCwsLtQIBBn8DQCAHIARJBEBBACEGA0AgBiADSQRAQQAhAANAIABBBEkEQEEAIQUDQCAFQQRJBEBBASAAIAdqIARPIAUgBmogA08bRQRAIAEgBSAGIAMgACAHamxqakECdGoiCUEDaiACIAhqIgotAAA6AAAgCSAKQQFqLQAAOgAACyAFQQFqIQUgCEECaiEIDAELCyAAQQFqIQAMAQsLQQAhAANAIABBBEkEQEEAIQUDQCAFQQRJBEBBASAAIAdqIARPIAUgBmogA08bRQRAIAEgBSAGIAMgACAHamxqakECdGoiCUEBaiACIAhqIgotAAA6AAAgCUECaiAKQQFqLQAAOgAACyAFQQFqIQUgCEECaiEIDAELCyAAQQFqIQAMAQsLIAZBBGohBgwBCwsgB0EEaiEHDAELCwugBwENfwNAIA0gBEkEQCADIA1sIQ9BACEJA0AgCSADSQRAIAkgD2ohEEEAIQoDQCAKQQhJBEAgECADIApsaiERQQAhCwNAIAtBCEkEQEEBIAogDWogBE8gCSALaiADTxtFBEAgAkECai8BACIFQQh0IAVB//8DcUEIdnIhBSAAIAIvAQAiBkEIdCAGQf//A3FBCHZyIgdB//8DcSIGQQt2IghBA3QgCEECdnI6AAAgAEEBaiAGQQV2QT9xIghBAnQgCEEEdnI6AAAgAEECaiAHQR9xIgdBA3QgB0ECdnI6AAAgAEEDakH/AToAACAAQQRqIAVB//8DcSIHQQt2IghBA3QgCEECdnI6AAAgAEEFaiAHQQV2QT9xIghBAnQgCEEEdnI6AAAgAEEGaiAFQR9xIgVBA3QgBUECdnI6AAAgAEEHakH/AToAACAGIAdLBEAgAEEIaiAAQQRqIgUtAAAiBiAGQQF0aiAALQAAIgYgBkECdGpqQQN2OgAAIABBCWogAEEFaiIGLQAAIgcgB0EBdGogAEEBaiIHLQAAIgggCEECdGpqQQN2OgAAIABBCmogAEEGaiIILQAAIgwgDEEBdGogAEECaiIMLQAAIg4gDkECdGpqQQN2OgAAIABBC2pB/wE6AAAgAEEMaiAALQAAIg4gDkEBdGogBS0AACIFIAVBAnRqakEDdjoAACAAQQ1qIActAAAiBSAFQQF0aiAGLQAAIgUgBUECdGpqQQN2OgAAIABBDmogDC0AACIFIAVBAXRqIAgtAAAiBSAFQQJ0ampBA3Y6AAAgAEEPakH/AToAAAUgAEEIaiIFIAAtAAAgAEEEai0AAGpBAXY6AAAgAEEJaiIGIABBAWotAAAgAEEFai0AAGpBAXY6AAAgAEEKaiIHIABBAmotAAAgAEEGai0AAGpBAXY6AAAgAEELakH/AToAACAAQQxqIAUtAAA6AAAgAEENaiAGLQAAOgAAIABBDmogBy0AADoAACAAQQ9qQQA6AAALIAsgEWohCEEAIQUDQCAFQQRIBEAgBSACQQRqai0AACEHIAggAyAFbGohDEEAIQYDQCAGQQRIBEAgASAGIAxqQQJ0aiAAIAdB/wFxQQZ2QQJ0aigCADYCACAHQQJ0IQcgBkEBaiEGDAELCyAFQQFqIQUMAQsLCyALQQRqIQsgAkEIaiECDAELCyAKQQRqIQoMAQsLIAlBCGohCQwBCwsgDUEIaiENDAELCws="),(function(e){return e.charCodeAt(0)}))).then(t=>WebAssembly.instantiate(t,e)).then(e=>e.exports)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.PAGE_SIZE=65536,this.mem=void 0!==e?e:new WebAssembly.Memory({initial:1}),this.currentNumPages=this.mem.buffer.byteLength/this.PAGE_SIZE,this.heap=null}resize(e){const t=Math.ceil(e/this.PAGE_SIZE);return t>this.currentNumPages&&(this.mem.grow(t-this.currentNumPages),this.currentNumPages=t,this.heap=null),null===this.heap&&(this.heap=new Uint8Array(this.mem.buffer)),this.heap}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(26),n=a(0),s=a(25),i=a(2);t.J3DFrameCtrl=class{constructor(e){this.updateFlags=0,this.init(e)}init(e){this.loopMode=2,this.startFrame=0,this.endFrame=e,this.repeatStartFrame=0,this.speedInFrames=1,this.currentTimeInFrames=0}update(e){if(0!==this.speedInFrames)if(this.updateFlags=0,this.currentTimeInFrames+=this.speedInFrames*e,0===this.loopMode)this.currentTimeInFrames>=this.endFrame&&(this.updateFlags|=1,this.speedInFrames=0,this.currentTimeInFrames=this.endFrame-.001);else if(1===this.loopMode)this.currentTimeInFrames>=this.endFrame&&(this.updateFlags|=1,this.speedInFrames=0,this.currentTimeInFrames=this.startFrame);else if(2===this.loopMode)for(;this.currentTimeInFrames>=this.endFrame;)this.updateFlags|=2,this.currentTimeInFrames-=this.endFrame-this.repeatStartFrame;else 3===this.loopMode?(this.currentTimeInFrames>=this.endFrame&&(this.speedInFrames*=-1,this.currentTimeInFrames=this.endFrame-(this.currentTimeInFrames-this.endFrame)),this.currentTimeInFrames<this.startFrame&&(this.speedInFrames=0,this.currentTimeInFrames=this.startFrame-(this.currentTimeInFrames-this.startFrame),this.updateFlags|=1)):4===this.loopMode&&(this.currentTimeInFrames>=this.endFrame-1&&(this.speedInFrames*=-1,this.currentTimeInFrames=this.endFrame-(this.currentTimeInFrames-this.endFrame)),this.currentTimeInFrames<this.startFrame&&(this.speedInFrames*=-1,this.currentTimeInFrames=this.startFrame-(this.currentTimeInFrames-this.startFrame),this.updateFlags|=2))}checkPass(e,t,a=this.currentTimeInFrames,r=this.speedInFrames){if(0===this.loopMode||1===this.loopMode){const n=a+r*t;return a<e&&n>=e}return!1}},t.VAF1_getVisibility=function(e,t,a){const r=n.assertExists(e.visibilityAnimationTracks[t]),s=a+.5|0;return s<0?r.shapeVisibility.getBit(0):s>=r.shapeVisibility.numBits?r.shapeVisibility.getBit(r.shapeVisibility.numBits-1):r.shapeVisibility.getBit(s)};class o{constructor(e,t){this.frameCtrl=e,this.animationEntry=t}set(e,t){this.frameCtrl=e,this.animationEntry=t}calcColor(e){const t=this.frameCtrl.currentTimeInFrames;e.r=r.sampleAnimationData(this.animationEntry.r,t),e.g=r.sampleAnimationData(this.animationEntry.g,t),e.b=r.sampleAnimationData(this.animationEntry.b,t),e.a=r.sampleAnimationData(this.animationEntry.a,t)}}function l(e,t){for(let a=0;a<e.materialInstances.length;a++)if(e.materialInstances[a].name===t)return e.materialInstances[a];return null}t.J3DTexRegAnm=o,t.entryTevRegAnimator=function(e,t,a){for(let r=0;r<t.animationEntries.length;r++){const n=t.animationEntries[r],s=l(e,t.animationEntries[r].materialName);null!==s&&(s.colorCalc[n.colorKind]?s.colorCalc[n.colorKind].set(a,n):s.colorCalc[n.colorKind]=new o(a,n))}},t.removeTevRegAnimator=function(e,t){for(let a=0;a<t.animationEntries.length;a++){const r=t.animationEntries[a],n=l(e,t.animationEntries[a].materialName);null!==n&&(n.colorCalc[r.colorKind]=null)}};class c{constructor(e,t,a){this.frameCtrl=e,this.ttk1=t,this.animationEntry=a}set(e,t,a){this.frameCtrl=e,this.ttk1=t,this.animationEntry=a}calcTexMtx(e){const t=this.frameCtrl.currentTimeInFrames,a=r.sampleAnimationData(this.animationEntry.scaleS,t),n=r.sampleAnimationData(this.animationEntry.scaleT,t),s=r.sampleAnimationData(this.animationEntry.rotationQ,t),i=r.sampleAnimationData(this.animationEntry.translationS,t),o=r.sampleAnimationData(this.animationEntry.translationT,t);if(this.ttk1.isMaya)r.calcTexMtx_Maya(e,a,n,s,i,o);else{const t=this.animationEntry.centerS,l=this.animationEntry.centerT,c=this.animationEntry.centerQ;r.calcTexMtx_Basic(e,a,n,s,i,o,t,l,c)}}}t.J3DTexMtxAnm=c,t.entryTexMtxAnimator=function(e,t,a){for(let r=0;r<t.uvAnimationEntries.length;r++){const n=t.uvAnimationEntries[r],s=l(e,t.uvAnimationEntries[r].materialName);null!==s&&(s.texMtxCalc[n.texGenIndex]?s.texMtxCalc[n.texGenIndex].set(a,t,n):s.texMtxCalc[n.texGenIndex]=new c(a,t,n))}},t.removeTexMtxAnimator=function(e,t){for(let a=0;a<t.uvAnimationEntries.length;a++){const r=t.uvAnimationEntries[a],n=l(e,t.uvAnimationEntries[a].materialName);null!==n&&(n.texMtxCalc[r.texGenIndex]=null)}};class h{constructor(e,t){this.frameCtrl=e,this.animationEntry=t}set(e,t){this.frameCtrl=e,this.animationEntry=t}calcTextureIndex(){const e=this.frameCtrl.currentTimeInFrames;return this.animationEntry.textureIndices[0|e]}}t.J3DTexNoAnm=h,t.entryTexNoAnimator=function(e,t,a){for(let r=0;r<t.animationEntries.length;r++){const n=t.animationEntries[r],s=l(e,t.animationEntries[r].materialName);null!==s&&(s.texNoCalc[n.texMapIndex]?s.texNoCalc[n.texMapIndex].set(a,n):s.texNoCalc[n.texMapIndex]=new h(a,n))}},t.removeTexNoAnimator=function(e,t){for(let a=0;a<t.animationEntries.length;a++){const r=t.animationEntries[a],n=l(e,t.animationEntries[a].materialName);null!==n&&(n.texMtxCalc[r.texMapIndex]=null)}};class d{constructor(e,t){this.frameCtrl=e,this.ank1=t}set(e,t){this.frameCtrl=e}calcJointMatrix(e,t,a){const n=this.frameCtrl.currentTimeInFrames,s=this.ank1.jointAnimationEntries[t];if(void 0!==s){const t=r.sampleAnimationData(s.scaleX,n),a=r.sampleAnimationData(s.scaleY,n),o=r.sampleAnimationData(s.scaleZ,n),l=r.sampleAnimationData(s.rotationX,n)*Math.PI,c=r.sampleAnimationData(s.rotationY,n)*Math.PI,h=r.sampleAnimationData(s.rotationZ,n)*Math.PI,d=r.sampleAnimationData(s.translationX,n),u=r.sampleAnimationData(s.translationY,n),m=r.sampleAnimationData(s.translationZ,n);i.computeModelMatrixSRT(e,t,a,o,l,c,h,d,u,m)}else{const t=a.scaleX,r=a.scaleY,n=a.scaleZ,s=a.rotationX,o=a.rotationY,l=a.rotationZ,c=a.translationX,h=a.translationY,d=a.translationZ;i.computeModelMatrixSRT(e,t,r,n,s,o,l,c,h,d)}}}t.J3DJointMatrixAnm=d,t.entryJointAnimator=function(e,t,a){e.jointMatrixCalc instanceof d?e.jointMatrixCalc.set(a,t):e.jointMatrixCalc=new d(a,t)},t.removeJointAnimator=function(e,t){e.jointMatrixCalc=new s.JointMatrixCalcNoAnm}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(1),s=a(6),i=a(30),o=a(16),l=a(4),c=a(5),h=a(5),d=a(2),u=a(17),m=a(7),p=a(13),f=a(8),A=a(32),g=a(10),_=a(34),S=a(36),b=[0,1,2],v=[0,1,2,3,2,3,4,5,6,7],w=[0,1,3,2,5,6,4,7],x=[0,1,2,3],T=[15,8,12,15,15,2,8,15,2,12,8,15,4,2,8,15,15,8,2,4,15,15,15,2],y=[7,4,1,7,7,7,7,1];function C(e){switch(e){case 0:case 1:return!1;default:return!0}}t.JPACData=class{constructor(e){this.jpac=e,this.texData=[],this.textureMapping=[]}ensureTexture(e,t,a){void 0===this.texData[a]&&(this.texData[a]=new S.BTIData(e,t,this.jpac.textures[a].texture),this.textureMapping[a]=new g.TextureMapping,this.texData[a].fillTextureMapping(this.textureMapping[a]))}getTextureMappingReference(e){for(let t=0;t<this.texData.length;t++){const a=this.texData[t];if(void 0!==a&&a.btiTexture.name===e)return this.textureMapping[t]}return null}fillTextureMapping(e,t){e.copy(this.textureMapping[t])}destroy(e){for(let t=0;t<this.texData.length;t++)void 0!==this.texData[t]&&this.texData[t].destroy(e)}};function M(e,t){if(e.isLoopEnable){t%=e.keyValues[e.keyValues.length-4]}const a=function(e,t){for(let a=0;a<e.keyValues.length;a+=4){if(e.keyValues[a+0]>t)return a}return e.keyValues.length-4}(e,t);return 0===a||a>=e.keyValues.length-4?e.keyValues[a+1]:function(e,t,a){const r=t-4,n=t,s=e[r+0],o=e[n+0]-s,l=(a-s)/o,c=e[r+1],h=e[n+1],d=e[r+3]*o,u=e[n+2]*o;return i.getPointHermite(c,h,d,u,l)}(e.keyValues,a,t)}function U(e){return e.state=1664525*e.state+1013904223>>>0,e.state}function k(e){return U(e)/4294967295}function D(e){return 2*k(e)-1}function I(e){return k(e)-.5}t.JPAResourceData=class{constructor(e,t,a,s){this.jpacData=a,this.supportedParticle=!0,this.supportedChild=!0,this.textureIds=[],this.res=function(e,t){if("JEFFjpa1"===e)return function(e){const t=e.data,a=t.createDataView(),s=a.getUint32(12);let i=0,o=null,c=null,h=null,d=null,u=null,m=[],p=[],f=32;for(let e=0;e<s;e++){const e=r.readString(t,f+0,4,!1),s=a.getUint32(f+4);if("BEM1"===e){const e=a.getFloat32(f+12),t=a.getFloat32(f+16),r=a.getFloat32(f+20),s=n.vec3.fromValues(e,t,r),l=a.getFloat32(f+24),c=a.getFloat32(f+28),h=a.getFloat32(f+32),d=n.vec3.fromValues(l,c,h),u=a.getInt16(f+36),m=a.getInt16(f+38),p=a.getInt16(f+40),A=n.vec3.fromValues(u,m,p),g=a.getUint8(f+42),_=a.getUint8(f+43),S=a.getUint16(f+46),b=a.getFloat32(f+48),v=te(a.getInt16(f+52)),w=a.getInt16(f+54),x=a.getUint16(f+56),T=a.getUint16(f+58),y=te(a.getInt16(f+60)),C=te(a.getInt16(f+62)),M=a.getUint16(f+64),U=te(a.getInt16(f+66)),k=te(a.getInt16(f+68)),D=te(a.getInt16(f+70)),I=te(a.getInt16(f+72)),R=te(a.getInt16(f+74)),B=te(a.getInt16(f+76)),P=te(a.getInt16(f+78)),E=a.getFloat32(f+80),F=a.getFloat32(f+84),V=a.getFloat32(f+88),O=a.getFloat32(f+92),N=a.getFloat32(f+96),L=te(a.getInt16(f+100)),G=te(a.getInt16(f+102)),H=te(a.getInt16(f+104)),j=n.vec3.fromValues(L,G,H);n.vec3.normalize(j,j);const W=te(a.getInt16(f+106)),Z=a.getUint32(f+108);i=a.getUint32(f+112),o={flags:Z,volumeType:g,emitterScl:s,emitterTrs:d,emitterDir:j,emitterRot:A,volumeSweep:y,volumeMinRad:C,volumeSize:T,divNumber:S,spread:W,rate:b,rateRndm:v,rateStep:_,initialVelOmni:E,initialVelAxis:F,initialVelRndm:V,initialVelDir:O,initialVelRatio:I,lifeTime:M,lifeTimeRndm:U,maxFrame:w,startFrame:x,airResist:B,airResistRndm:P,moment:k,momentRndm:D,accel:N,accelRndm:R}}else if("BSP1"===e){const e=a.getFloat32(f+24),r=a.getFloat32(f+28),s=n.vec2.fromValues(e,r),i=a.getUint16(f+32),o=a.getUint8(f+34),h=a.getUint8(f+35),d=1&o?65535:0,u=1&h?65535:0,m=!!(2&o),p=!!(2&h),A=a.getUint8(f+36),g=a.getUint8(f+37),_=a.getUint8(f+38),S=0,b=!1,v=!1,w=a.getUint8(f+48),x=0,T=a.getUint8(f+53),y=a.getUint8(f+54),C=a.getUint8(f+55),M=(a.getUint8(f+56),a.getUint8(f+57)),U=a.getUint8(f+58),k=a.getUint8(f+59),D=a.getUint8(f+60),I=a.getUint8(f+61),R=a.getUint8(f+63),B=a.getUint8(f+64),P=a.getUint8(f+65),E=C<<6|y<<2|T<<0,F=D<<5|k<<3|M<<0,V=P<<4|B<<1|R<<0,O=!!a.getUint8(f+67),N=a.getUint8(f+68),L=a.getUint8(f+76),G=a.getUint8(f+77),H=a.getUint8(f+79);let j=null;if(1&L){const e=f+a.getUint16(f+18),r=a.getUint8(f+78);j=t.createTypedArray(Uint8Array,e,r,1)}const W=a.getUint16(f+92),Z=a.getUint8(f+94),z=a.getUint8(f+96),K=a.getUint8(f+97);let X=null;if(2&z){const e=f+a.getUint16(f+20),r=a.getUint8(f+98);X=ee(t.slice(e),r,W)}let Y=null;if(2&K){const e=f+a.getUint16(f+22),r=a.getUint8(f+99);Y=ee(t.slice(e),r,W)}const $=l.colorNewFromRGBA8(a.getUint32(f+100)),q=l.colorNewFromRGBA8(a.getUint32(f+104)),Q=10*te(a.getInt16(f+128)),J=10*te(a.getInt16(f+130)),ae=10*te(a.getInt16(f+132)),re=10*te(a.getInt16(f+134)),ne=10*te(a.getInt16(f+136)),se=10*te(a.getInt16(f+138)),ie=te(a.getInt16(f+140)),oe=te(a.getInt16(f+142)),le=.1*te(a.getInt16(f+144)),ce=.1*te(a.getInt16(f+146)),he=te(a.getInt16(f+148)),de=0,ue=!!a.getUint8(f+150);c={shapeType:A,dirType:g,rotType:_,planeType:S,globalScale2D:s,tilingX:ne,tilingY:se,traverseOrder:1&N,drawChildrenBefore:!!(2&N),stopDrawParent:b,stopDrawChild:v,colorInSelect:w,alphaInSelect:x,blendModeFlags:E,alphaCompareFlags:F,alphaRef0:U,alphaRef1:I,zModeFlags:V,anmRndm:i,texCalcOnEmitter:m,texIdx:H,texIdxAnimData:j,texIdxAnimRndmMask:d,texCalcIdxType:G,isEnableTexScrollAnm:ue,isEnableProjection:O,texStaticTransX:Q,texStaticTransY:J,texStaticScaleX:ae,texStaticScaleY:re,texStaticRotate:de,texScrollTransX:ie,texScrollTransY:oe,texScrollScaleX:le,texScrollScaleY:ce,texScrollRotate:he,colorCalcOnEmitter:p,colorCalcIdxType:Z,colorPrm:$,colorEnv:q,colorEnvAnimData:Y,colorPrmAnimData:X,colorAnimMaxFrm:W,colorAnimRndmMask:u}}else if("ESP1"===e){const e=te(a.getInt16(f+20)),t=te(a.getInt16(f+22)),r=te(a.getInt16(f+24)),n=te(a.getInt16(f+26)),s=te(a.getInt16(f+28)),i=a.getUint8(f+30),o=!!(1&i),l=!!(2&i),c=a.getUint8(f+31),d=l?c:-1;let u=1;e>0&&(u=(n-r)/e);let m=1;t<1&&(m=(s-n)/(1-t));const p=te(a.getInt16(f+32)),A=te(a.getInt16(f+34)),g=te(a.getInt16(f+36)),_=te(a.getInt16(f+38)),S=te(a.getInt16(f+52)),b=te(a.getInt16(f+54)),v=te(a.getInt16(f+56)),w=te(a.getInt16(f+58)),x=te(a.getInt16(f+62)),T=a.getUint8(f+64),y=a.getUint8(f+65),C=a.getUint16(f+66),M=te(a.getInt16(f+68)),U=te(a.getInt16(f+72)),k=a.getUint8(f+74),D=a.getUint8(f+75),I=a.getUint16(f+76),R=a.getUint8(f+78),B=!!(1&R),P=!!(2&R),E=!!(8&R)?D?2:1:0,F=!!(4&R)?y?2:1:0,V=!!(16&R),O=!!(32&R);let N=1,L=1;b>0&&(N=(1-M)/b,L=(1-w)/b);let G=1,H=1;v<1&&(G=(U-1)/(1-v),H=(x-1)/(1-v));const j=6.283*te(a.getInt16(f+90)),W=6.283*te(a.getInt16(f+92)),Z=6.283*te(a.getInt16(f+94)),z=te(a.getInt16(f+96)),K=te(a.getInt16(f+82)),X=!!a.getUint8(f+100);h={isEnableScale:B,isDiffXY:P,scaleAnmTypeX:E,scaleAnmTypeY:F,isEnableScaleBySpeedX:O,isEnableScaleBySpeedY:V,isEnableAlpha:o,alphaWaveType:d,isEnableRotate:X,pivotX:k,pivotY:T,scaleInTiming:b,scaleOutTiming:v,scaleInValueX:M,scaleOutValueX:U,scaleInValueY:w,scaleOutValueY:x,scaleIncreaseRateX:N,scaleIncreaseRateY:L,scaleDecreaseRateX:G,scaleDecreaseRateY:H,scaleOutRandom:S,scaleAnmMaxFrameX:I,scaleAnmMaxFrameY:C,alphaInTiming:e,alphaOutTiming:t,alphaInValue:r,alphaBaseValue:n,alphaOutValue:s,alphaIncreaseRate:u,alphaDecreaseRate:m,alphaWaveParam1:p,alphaWaveParam2:A,alphaWaveParam3:g,alphaWaveRandom:_,rotateAngle:j,rotateAngleRandom:Z,rotateSpeed:W,rotateSpeedRandom:z,rotateDirection:K}}else if("SSP1"===e){const e=a.getUint8(f+16),t=a.getUint8(f+17),s=a.getUint8(f+18),i=0,o=a.getUint16(f+20),h=a.getUint16(f+22),d=a.getUint8(f+26),m=a.getFloat32(f+40),p=a.getFloat32(f+44),A=!!a.getUint8(f+54),g=!!a.getUint8(f+68);r.assertExists(c).stopDrawParent=!g;const _=!!a.getUint8(f+69),S=!!a.getUint8(f+70),b=a.getUint8(f+71),v=a.getFloat32(f+76),w=a.getFloat32(f+80),x=n.vec2.fromValues(v,w),T=!!a.getUint8(f+86),y=a.getUint8(f+87),C=!!(4&y),M=!!(2&y),U=!!(1&y),k=l.colorNewFromRGBA8(a.getUint32(f+88)),D=l.colorNewFromRGBA8(a.getUint32(f+92)),I=te(a.getUint16(f+24)),R=te(a.getUint16(f+48)),B=te(a.getUint16(f+50)),P=te(a.getUint16(f+52)),E=te(a.getUint16(f+50)),F=te(a.getUint16(f+50)),V=te(a.getUint16(f+50)),O=te(a.getUint16(f+50));u={isEnableRotate:T,isEnableAlphaOut:S,isEnableScaleOut:_,isEnableField:A,isInheritedRGB:C,isInheritedAlpha:M,isInheritedScale:U,shapeType:e,dirType:t,rotType:s,planeType:i,posRndm:m,baseVel:p,baseVelRndm:B,velInfRate:R,gravity:P,globalScale2D:x,inheritScale:E,inheritAlpha:F,inheritRGB:V,colorPrm:k,colorEnv:D,timing:I,life:o,rate:h,step:d,texIdx:b,rotateSpeed:O}}else if("ETX1"===e){const e=a.getUint8(f+16),t=(a.getUint8(f+17),te(a.getFloat32(f+18))),r=te(a.getFloat32(f+20)),n=te(a.getFloat32(f+22)),s=te(a.getFloat32(f+24)),i=te(a.getFloat32(f+26)),o=te(a.getFloat32(f+28)),l=Math.pow(2,a.getInt8(f+30)),c=new Float32Array([t*l,r*l,n*l,l,s*l,i*l,o*l,0]),h=a.getUint8(f+31),u=a.getUint8(f+32),m=1&a.getUint8(f+48)?a.getUint8(f+51):-1;d={indTextureMode:e,indTextureMtx:c,indTextureID:h,subTextureID:u,secondTextureIndex:m}}else if("KFA1"===e){r.assert(0!==i);let e=-1;for(let t=0;t<16;t++)if(i&1<<t){e=t;break}const n=a.getUint8(f+16),s=!!a.getUint8(f+18),o=t.createTypedArray(Float32Array,f+32,4*n,1);p.push({keyType:e,isLoopEnable:s,keyValues:o}),i&=~(1<<e)}else if("FLD1"===e){const e=a.getUint8(f+12),t=a.getUint8(f+14),r=a.getUint8(f+15),s=a.getUint8(f+16),i=a.getFloat32(f+20),o=a.getFloat32(f+24),l=a.getFloat32(f+28),c=l*l,h=a.getFloat32(f+32),d=a.getFloat32(f+36),u=a.getFloat32(f+40),p=n.vec3.fromValues(h,d,u),A=a.getFloat32(f+44),g=a.getFloat32(f+48),_=a.getFloat32(f+52),S=n.vec3.fromValues(A,g,_),b=a.getFloat32(f+56),v=a.getFloat32(f+60),w=(a.getFloat32(f+64),te(a.getInt16(f+68))),x=te(a.getInt16(f+70)),T=te(a.getInt16(f+72)),y=te(a.getInt16(f+74));let C=1;w>T&&(C=1/(w-T));let M=1;x<y&&(M=1/(y-x));let U=-1,k=-1,D=-1;3===e&&(U=b*b),4===e&&(k=i,D=o),7===e&&(U=v),8===e&&(k=i),m.push({sttFlag:s,type:e,velType:t,pos:p,dir:S,maxDistSq:c,mag:i,magRndm:o,refDistanceSq:U,innerSpeed:k,outerSpeed:D,fadeIn:w,fadeOut:x,enTime:T,disTime:y,cycle:r,fadeInRate:C,fadeOutRate:M})}else if("TEX1"!==e)throw"whoops";f+=s}return{bem1:r.assertExists(o),bsp1:r.assertExists(c),esp1:h,etx1:d,ssp1:u,fld1:m,kfa1:p,tdb1:null}}(t);if("JPAC1-00"===e)return function(e){const t=e.data,a=t.createDataView(),s=a.getUint32(12),i=a.getUint8(20),o=a.getUint8(21);let c=null,h=null,d=null,u=null,m=null,p=[],f=[],A=null,g=32;for(let e=0;e<s;e++){const e=r.readString(t,g+0,4,!1),s=a.getUint32(g+4),i=g+12;if("BEM1"===e){const e=a.getUint32(i+0),t=e>>>8&7,r=a.getFloat32(i+4),s=a.getFloat32(i+8),o=a.getInt16(i+12),l=a.getInt16(i+14),h=a.getFloat32(i+16),d=a.getFloat32(i+20),u=a.getUint8(i+24),m=a.getInt16(i+26),p=a.getInt16(i+28),f=a.getInt16(i+30),A=a.getFloat32(i+32),g=a.getFloat32(i+36),_=a.getFloat32(i+40),S=a.getFloat32(i+44),b=a.getFloat32(i+48),v=a.getFloat32(i+52),w=a.getFloat32(i+56),x=a.getFloat32(i+60),T=a.getFloat32(i+64),y=a.getFloat32(i+68),C=a.getFloat32(i+72),M=a.getFloat32(i+76),U=a.getFloat32(i+80),k=a.getFloat32(i+84),D=a.getFloat32(i+88),I=a.getFloat32(i+92),R=n.vec3.fromValues(k,D,I),B=a.getFloat32(i+96),P=a.getFloat32(i+100),E=a.getFloat32(i+104),F=n.vec3.fromValues(B,P,E),V=a.getFloat32(i+108),O=a.getFloat32(i+112),N=a.getFloat32(i+116),L=n.vec3.fromValues(V,O,N);n.vec3.normalize(L,L);const G=a.getInt16(i+120)/180,H=a.getInt16(i+122)/180,j=a.getInt16(i+124)/180,W=n.vec3.fromValues(G,H,j);c={flags:e,volumeType:t,emitterScl:R,emitterTrs:F,emitterDir:L,emitterRot:W,volumeSweep:r,volumeMinRad:s,volumeSize:o,divNumber:l,spread:w,rate:h,rateRndm:d,rateStep:u,initialVelOmni:g,initialVelAxis:_,initialVelRndm:S,initialVelDir:b,initialVelRatio:v,lifeTime:f,lifeTimeRndm:A,maxFrame:m,startFrame:p,airResist:x,airResistRndm:T,moment:y,momentRndm:C,accel:M,accelRndm:U}}else if("BSP1"===e){const e=a.getUint32(i+0),r=e>>>0&15,s=e>>>4&7,o=e>>>7&7;let c=e>>>10&1;4!==r&&8!==r||(c=2);const d=e>>>15&7,u=e>>>18&1,m=e>>>21&1,p=!!(16777216&e),f=!!(4194304&e),A=!!(1048576&e),_=!!(16384&e),S=!!(4096&e),b=!1,v=!1,w=a.getFloat32(i+8),x=a.getFloat32(i+12),T=n.vec2.fromValues(w,x),y=a.getInt16(i+16),C=-(e>>>11&1),M=-(e>>>13&1),U=a.getUint16(i+18),k=a.getUint8(i+20),D=a.getUint8(i+21),I=a.getUint8(i+22),R=a.getUint8(i+23),B=a.getUint8(i+24),P=a.getUint8(i+25),E=a.getUint8(i+26),F=a.getUint8(i+27),V=a.getUint16(i+30),O=l.colorNewFromRGBA8(a.getUint32(i+32)),N=l.colorNewFromRGBA8(a.getUint32(i+36)),L=F>>>4&7;let G=null;if(2&F){const e=g+a.getUint16(i+4),r=a.getUint8(i+28);G=ee(t.slice(e),r,V)}let H=null;if(8&F){const e=g+a.getUint16(i+6),r=a.getUint8(i+29);H=ee(t.slice(e),r,V)}const j=a.getFloat32(i+40),W=a.getFloat32(i+44),Z=B>>>2&7,z=a.getFloat32(i+48),K=a.getFloat32(i+52),X=a.getFloat32(i+56),Y=a.getFloat32(i+60),$=0,q=a.getFloat32(i+64),Q=a.getFloat32(i+68),J=a.getFloat32(i+72),te=a.getFloat32(i+76),ae=a.getFloat32(i+80);let re=null;!!(1&B)&&(re=t.createTypedArray(Uint8Array,g+96,P,1)),h={shapeType:r,dirType:s,rotType:o,planeType:c,globalScale2D:T,tilingX:j,tilingY:W,traverseOrder:m,drawChildrenBefore:f,stopDrawParent:b,stopDrawChild:v,colorInSelect:d,alphaInSelect:u,blendModeFlags:U,alphaCompareFlags:k,alphaRef0:D,alphaRef1:I,zModeFlags:R,anmRndm:y,texCalcOnEmitter:_,texCalcIdxType:Z,texIdx:E,texIdxAnimData:re,texIdxAnimRndmMask:M,isEnableTexScrollAnm:p,isEnableProjection:A,texStaticTransX:z,texStaticTransY:K,texStaticScaleX:X,texStaticScaleY:Y,texStaticRotate:$,texScrollTransX:q,texScrollTransY:Q,texScrollScaleX:J,texScrollScaleY:te,texScrollRotate:ae,colorCalcOnEmitter:S,colorCalcIdxType:L,colorPrm:O,colorEnv:N,colorEnvAnimData:H,colorPrmAnimData:G,colorAnimMaxFrm:V,colorAnimRndmMask:C}}else if("ESP1"===e){const e=a.getUint32(i+0),t=!!(256&e),r=!!(512&e),n=!!(4096&e),s=!!(8192&e),o=!!(1&e),l=!!(16777216&e),c=e>>>2&3,h=!!(2&e)?c:-1,u=!!(e>>>18&1),m=!!(e>>>19&1),p=!!(2048&e)?u?2:1:0,f=!!(1024&e)?m?2:1:0,A=e>>>14&3,g=e>>>16&3,_=a.getFloat32(i+8),S=a.getFloat32(i+12),b=a.getFloat32(i+16),v=a.getFloat32(i+20),w=a.getFloat32(i+24);let x=1;_>0&&(x=(v-b)/_);let T=1;S<1&&(T=(w-v)/(1-S));const y=a.getFloat32(i+28),C=a.getFloat32(i+32),M=a.getFloat32(i+36),U=a.getFloat32(i+40),k=a.getFloat32(i+44),D=a.getFloat32(i+48),I=a.getFloat32(i+52),R=a.getFloat32(i+56),B=a.getFloat32(i+60),P=a.getFloat32(i+64),E=a.getFloat32(i+68),F=a.getUint16(i+72),V=a.getUint16(i+74);let O=1,N=1;k>0&&(O=(1-I)/k,N=(1-B)/k);let L=1,G=1;D<1&&(L=(R-1)/(1-D),G=(P-1)/(1-D));const H=6.283*a.getFloat32(i+76),j=6.283*a.getFloat32(i+80),W=6.283*a.getFloat32(i+84),Z=a.getFloat32(i+88),z=a.getFloat32(i+92);d={isEnableScale:t,isDiffXY:r,scaleAnmTypeX:p,scaleAnmTypeY:f,isEnableScaleBySpeedX:s,isEnableScaleBySpeedY:n,isEnableAlpha:o,alphaWaveType:h,isEnableRotate:l,pivotX:A,pivotY:g,scaleInTiming:k,scaleOutTiming:D,scaleInValueX:I,scaleOutValueX:R,scaleInValueY:B,scaleOutValueY:P,scaleIncreaseRateX:O,scaleIncreaseRateY:N,scaleDecreaseRateX:L,scaleDecreaseRateY:G,scaleOutRandom:E,scaleAnmMaxFrameX:F,scaleAnmMaxFrameY:V,alphaInTiming:_,alphaOutTiming:S,alphaInValue:b,alphaBaseValue:v,alphaOutValue:w,alphaIncreaseRate:x,alphaDecreaseRate:T,alphaWaveParam1:y,alphaWaveParam2:C,alphaWaveParam3:M,alphaWaveRandom:U,rotateAngle:H,rotateAngleRandom:W,rotateSpeed:j,rotateSpeedRandom:Z,rotateDirection:z}}else if("SSP1"===e){const e=a.getUint32(i+0),t=e>>>0&15,s=e>>>4&7,o=e>>>7&7;let c=e>>>10&1;4!==t&&8!==t||(c=2);const d=!!(524288&e);r.assertExists(h).stopDrawParent=!d;const u=a.getFloat32(i+4),p=a.getFloat32(i+8),f=a.getFloat32(i+12),A=a.getFloat32(i+16),g=a.getFloat32(i+20),_=a.getFloat32(i+24),S=a.getUint16(i+28),b=a.getUint8(i+30),v=a.getUint32(i+32),w=a.getFloat32(i+36),x=a.getFloat32(i+40),T=n.vec2.fromValues(w,x),y=a.getFloat32(i+44),C=!!(16777216&e),M=!!(8388608&e),U=!!(4194304&e),k=!!(2097152&e),D=!!(262144&e),I=!!(131072&e),R=!!(65536&e),B=a.getFloat32(i+48),P=a.getFloat32(i+52),E=a.getFloat32(i+56),F=l.colorNewFromRGBA8(a.getUint32(i+60)),V=l.colorNewFromRGBA8(a.getUint32(i+64)),O=a.getUint8(i+68);m={isEnableRotate:C,isEnableAlphaOut:M,isEnableScaleOut:U,isEnableField:k,isInheritedRGB:D,isInheritedAlpha:I,isInheritedScale:R,shapeType:t,dirType:s,rotType:o,planeType:c,posRndm:u,baseVel:p,baseVelRndm:f,velInfRate:A,gravity:g,globalScale2D:T,inheritScale:B,inheritAlpha:P,inheritRGB:E,colorPrm:F,colorEnv:V,timing:_,life:S,rate:b,step:v,texIdx:O,rotateSpeed:y}}else if("ETX1"===e){const e=a.getUint32(i+0),t=a.getFloat32(i+4),r=a.getFloat32(i+8),n=a.getFloat32(i+12),s=a.getFloat32(i+16),o=a.getFloat32(i+20),l=a.getFloat32(i+24),c=Math.pow(2,a.getInt8(i+28)),h=new Float32Array([t*c,r*c,n*c,c,s*c,o*c,l*c,0]),d=3&e,m=a.getUint8(i+32),p=a.getUint8(i+33),f=256&e?a.getUint8(i+34):-1;u={indTextureMode:d,indTextureMtx:h,indTextureID:m,subTextureID:p,secondTextureIndex:f}}else if("KFA1"===e){const e=a.getUint8(i+0),r=a.getUint8(i+4),n=!!a.getUint8(i+6),s=t.createTypedArray(Float32Array,g+32,4*r,1);f.push({keyType:e,isLoopEnable:n,keyValues:s})}else if("FLD1"===e){const e=a.getUint32(i+0),t=e>>>16,r=15&e,s=e>>>8&3,o=a.getFloat32(i+4),l=a.getFloat32(i+8),c=a.getFloat32(i+12),h=c*c,d=a.getFloat32(i+16),u=a.getFloat32(i+20),m=a.getFloat32(i+24),f=n.vec3.fromValues(d,u,m),A=a.getFloat32(i+28),g=a.getFloat32(i+32),_=a.getFloat32(i+36),S=n.vec3.fromValues(A,g,_),b=a.getFloat32(i+40),v=a.getFloat32(i+44),w=(a.getFloat32(i+48),a.getFloat32(i+52)),x=a.getFloat32(i+56),T=a.getFloat32(i+60),y=a.getFloat32(i+64),C=a.getUint8(i+68);let M=1;w>T&&(M=1/(w-T));let U=1;x<y&&(U=1/(y-x));let k=-1,D=-1,I=-1;3===r&&(k=b*b),4===r&&(D=o,I=l),7===r&&(k=v),8===r&&(D=o),p.push({sttFlag:t,type:r,velType:s,maxDistSq:h,pos:f,dir:S,mag:o,magRndm:l,refDistanceSq:k,innerSpeed:D,outerSpeed:I,fadeIn:w,fadeOut:x,enTime:T,disTime:y,cycle:C,fadeInRate:M,fadeOutRate:U})}else{if("TDB1"!==e)throw"whoops";A=t.subarray(i+0,s-12).createTypedArray(Uint16Array,0,void 0,1)}g+=s}return r.assert(p.length===o),r.assert(f.length===i),{bem1:r.assertExists(c),bsp1:r.assertExists(h),esp1:d,etx1:u,ssp1:m,fld1:p,kfa1:f,tdb1:r.assertExists(A)}}(t);if("JPAC2-10"===e)return function(e){const t=e.data,a=t.createDataView(),s=a.getUint16(2),i=a.getUint8(4),o=a.getUint8(5);let c=null,h=null,d=null,u=null,m=null,p=[],f=[],A=null,g=8;for(let e=0;e<s;e++){const e=r.readString(t,g+0,4,!1),s=a.getUint32(g+4);if("BEM1"===e){const e=a.getUint32(g+8),t=e>>>8&7,r=a.getFloat32(g+16),s=a.getFloat32(g+20),i=a.getFloat32(g+24),o=n.vec3.fromValues(r,s,i),l=a.getFloat32(g+28),h=a.getFloat32(g+32),d=a.getFloat32(g+36),u=n.vec3.fromValues(l,h,d),m=a.getFloat32(g+40),p=a.getFloat32(g+44),f=a.getFloat32(g+48),A=n.vec3.fromValues(m,p,f);n.vec3.normalize(A,A);const _=a.getFloat32(g+52),S=a.getFloat32(g+56),b=a.getFloat32(g+60),v=a.getFloat32(g+64),w=a.getFloat32(g+68),x=a.getFloat32(g+72),T=a.getFloat32(g+76),y=a.getFloat32(g+80),C=a.getFloat32(g+84),M=a.getFloat32(g+88),U=a.getFloat32(g+92),k=a.getFloat32(g+96),D=a.getFloat32(g+100),I=a.getInt16(g+104)/180,R=a.getInt16(g+106)/180,B=a.getInt16(g+108)/180,P=n.vec3.fromValues(I,R,B),E=a.getInt16(g+110),F=a.getInt16(g+112),V=a.getInt16(g+114),O=a.getInt16(g+116),N=a.getInt16(g+118),L=a.getUint8(g+120);c={flags:e,volumeType:t,emitterScl:o,emitterTrs:u,emitterDir:A,emitterRot:P,volumeSweep:M,volumeMinRad:U,volumeSize:O,divNumber:N,spread:w,rate:T,rateRndm:y,rateStep:L,initialVelOmni:_,initialVelAxis:S,initialVelRndm:b,initialVelDir:v,initialVelRatio:x,lifeTime:V,lifeTimeRndm:C,maxFrame:E,startFrame:F,airResist:k,airResistRndm:0,moment:1,momentRndm:D,accel:0,accelRndm:0}}else if("BSP1"===e){const e=a.getUint32(g+8),r=e>>>0&15,s=e>>>4&7,i=e>>>7&7;let o=e>>>10&1;4!==r&&8!==r||(o=2);const c=e>>>25&1?2:1,d=e>>>26&1?2:1,u=!!(134217728&e),m=!!(268435456&e),p=e>>>15&7,f=e>>>18&1,A=e>>>21&1,_=!!(16777216&e),S=!!(4194304&e),b=!!(1048576&e),v=!!(16384&e),w=!!(4096&e),x=a.getFloat32(g+16),T=a.getFloat32(g+20),y=n.vec2.fromValues(x,T),C=a.getUint16(g+24),M=a.getUint8(g+26),U=a.getUint8(g+27),k=a.getUint8(g+28),D=a.getUint8(g+29),I=a.getUint8(g+30),R=a.getUint8(g+31),B=a.getUint8(g+32),P=a.getUint8(g+33),E=l.colorNewFromRGBA8(a.getUint32(g+38)),F=l.colorNewFromRGBA8(a.getUint32(g+42)),V=I>>>2&7,O=a.getUint8(g+46),N=a.getUint8(g+47),L=a.getUint8(g+48);let G=g+52,H=0,j=0,W=0,Z=0,z=0,K=0,X=0,Y=0,$=0,q=0;16777216&e&&(H=a.getFloat32(G+0),j=a.getFloat32(G+4),W=a.getFloat32(G+8),Z=a.getFloat32(G+12),z=a.getFloat32(G+16),K=a.getFloat32(G+20),X=a.getFloat32(G+24),Y=a.getFloat32(G+28),$=a.getFloat32(G+32),q=a.getFloat32(G+36),G+=40);let Q=null;!!(1&I)&&(Q=t.createTypedArray(Uint8Array,G,R,1));const J=a.getUint16(g+36);let te=null;if(2&P){const e=g+a.getUint16(g+12),r=a.getUint8(g+34);te=ee(t.slice(e),r,J)}let ae=null;if(8&P){const e=g+a.getUint16(g+14),r=a.getUint8(g+35);ae=ee(t.slice(e),r,J)}h={shapeType:r,dirType:s,rotType:i,planeType:o,globalScale2D:y,tilingX:c,tilingY:d,traverseOrder:A,drawChildrenBefore:S,stopDrawParent:u,stopDrawChild:m,colorInSelect:p,alphaInSelect:f,blendModeFlags:C,alphaCompareFlags:M,alphaRef0:U,alphaRef1:k,zModeFlags:D,anmRndm:O,texCalcOnEmitter:v,texCalcIdxType:V,texIdx:B,texIdxAnimData:Q,texIdxAnimRndmMask:L,isEnableTexScrollAnm:_,isEnableProjection:b,texStaticTransX:H,texStaticTransY:j,texStaticScaleX:W,texStaticScaleY:Z,texStaticRotate:z,texScrollTransX:K,texScrollTransY:X,texScrollScaleX:Y,texScrollScaleY:$,texScrollRotate:q,colorCalcOnEmitter:w,colorCalcIdxType:P>>>4&7,colorPrm:E,colorEnv:F,colorEnvAnimData:ae,colorPrmAnimData:te,colorAnimMaxFrm:J,colorAnimRndmMask:N}}else if("ESP1"===e){const e=a.getUint32(g+8),t=!!(1&e),r=!!(2&e),n=!1,s=!1,i=!!(65536&e),o=!!(16777216&e),l=!!(131072&e)?0:-1,c=e>>>8&3,h=e>>>10&3,u=e>>>12&3,m=e>>>14&3,p=a.getFloat32(g+12),f=a.getFloat32(g+16),A=a.getFloat32(g+20),_=a.getFloat32(g+24),S=a.getFloat32(g+28),b=a.getFloat32(g+32),v=a.getFloat32(g+36),w=a.getUint16(g+40),x=a.getUint16(g+42);let T=1,y=1;p>0&&(T=(1-A)/p,y=(1-S)/p);let C=1,M=1;f<1&&(C=(_-1)/(1-f),M=(b-1)/(1-f));const U=a.getFloat32(g+44),k=a.getFloat32(g+48),D=a.getFloat32(g+52),I=a.getFloat32(g+56),R=a.getFloat32(g+60);let B=1;U>0&&(B=(I-D)/U);let P=1;k<1&&(P=(R-I)/(1-k));const E=a.getFloat32(g+64),F=a.getFloat32(g+68),V=a.getFloat32(g+72),O=E,N=0,L=V,G=6.283*a.getFloat32(g+76)/65535,H=6.283*a.getFloat32(g+80)/65535,j=6.283*a.getFloat32(g+84)/65535,W=a.getFloat32(g+88),Z=a.getFloat32(g+92);d={isEnableScale:t,isDiffXY:r,scaleAnmTypeX:c,scaleAnmTypeY:h,isEnableScaleBySpeedX:n,isEnableScaleBySpeedY:s,isEnableAlpha:i,alphaWaveType:l,isEnableRotate:o,pivotX:u,pivotY:m,scaleInTiming:p,scaleOutTiming:f,scaleInValueX:A,scaleOutValueX:_,scaleInValueY:S,scaleOutValueY:b,scaleIncreaseRateX:T,scaleIncreaseRateY:y,scaleDecreaseRateX:C,scaleDecreaseRateY:M,scaleOutRandom:v,scaleAnmMaxFrameX:w,scaleAnmMaxFrameY:x,alphaInTiming:U,alphaOutTiming:k,alphaInValue:D,alphaBaseValue:I,alphaOutValue:R,alphaIncreaseRate:B,alphaDecreaseRate:P,alphaWaveParam1:O,alphaWaveParam2:N,alphaWaveParam3:L,alphaWaveRandom:F,rotateAngle:G,rotateAngleRandom:H,rotateSpeed:j,rotateSpeedRandom:W,rotateDirection:Z}}else if("SSP1"===e){const e=a.getUint32(g+8),t=e>>>0&15,r=e>>>4&7,s=e>>>7&7;let i=e>>>10&1;4!==t&&8!==t||(i=2);const o=a.getFloat32(g+12),c=a.getFloat32(g+16),h=a.getFloat32(g+20),d=a.getFloat32(g+24),u=a.getFloat32(g+28),p=a.getFloat32(g+32),f=a.getFloat32(g+36),A=n.vec2.fromValues(p,f),_=!!(16777216&e),S=!!(8388608&e),b=!!(4194304&e),v=!!(2097152&e),w=!!(262144&e),x=!!(131072&e),T=!!(65536&e),y=a.getFloat32(g+40),C=a.getFloat32(g+44),M=a.getFloat32(g+48),U=l.colorNewFromRGBA8(a.getUint32(g+52)),k=l.colorNewFromRGBA8(a.getUint32(g+56)),D=a.getFloat32(g+60),I=a.getUint16(g+64),R=a.getUint16(g+66),B=a.getUint8(g+68),P=a.getUint8(g+69),E=a.getUint16(g+70)/65535;m={isEnableRotate:_,isEnableAlphaOut:S,isEnableScaleOut:b,isEnableField:v,isInheritedRGB:w,isInheritedAlpha:x,isInheritedScale:T,shapeType:t,dirType:r,rotType:s,planeType:i,posRndm:o,baseVel:c,baseVelRndm:h,velInfRate:d,gravity:u,globalScale2D:A,inheritScale:y,inheritAlpha:C,inheritRGB:M,colorPrm:U,colorEnv:k,timing:D,life:I,rate:R,step:B,texIdx:P,rotateSpeed:E}}else if("ETX1"===e){const e=a.getUint32(g+8),t=a.getFloat32(g+12),r=a.getFloat32(g+16),n=a.getFloat32(g+20),s=a.getFloat32(g+24),i=a.getFloat32(g+28),o=a.getFloat32(g+32),l=Math.pow(2,a.getInt8(g+36)),c=new Float32Array([t*l,r*l,n*l,l,s*l,i*l,o*l,0]),h=1&e,d=a.getUint8(g+37),m=0,p=256&e?a.getUint8(g+38):-1;u={indTextureMode:h,indTextureMtx:c,indTextureID:d,subTextureID:m,secondTextureIndex:p}}else if("KFA1"===e){const e=a.getUint8(g+8),r=a.getUint8(g+9),n=!!a.getUint8(g+11),s=t.createTypedArray(Float32Array,g+12,4*r,1);f.push({keyType:e,isLoopEnable:n,keyValues:s})}else if("FLD1"===e){const e=a.getUint32(g+8),t=e>>>16,r=15&e,s=e>>>8&3,i=0,o=i*i,l=a.getFloat32(g+12),c=a.getFloat32(g+16),h=a.getFloat32(g+20),d=n.vec3.fromValues(l,c,h),u=a.getFloat32(g+24),m=a.getFloat32(g+28),f=a.getFloat32(g+32),A=n.vec3.fromValues(u,m,f),_=a.getFloat32(g+36),S=a.getFloat32(g+40),b=a.getFloat32(g+44),v=a.getFloat32(g+48),w=a.getFloat32(g+52),x=a.getFloat32(g+56),T=a.getFloat32(g+60),y=a.getUint8(g+64);let C=1;v>x&&(C=1/(v-x));let M=1;w<T&&(M=1/(T-w));let U=0,k=0,D=-1,I=-1,R=-1;0!==r&&1!==r&&2!==r&&3!==r&&5!==r&&6!==r&&7!==r||(U=_),k=0,3===r&&(D=b*b),4===r&&(I=_,R=S),7===r&&(D=b),8===r&&(I=_),p.push({sttFlag:t,type:r,velType:s,maxDistSq:o,pos:d,dir:A,mag:U,magRndm:k,refDistanceSq:D,innerSpeed:I,outerSpeed:R,fadeIn:v,fadeOut:w,enTime:x,disTime:T,cycle:y,fadeInRate:C,fadeOutRate:M})}else{if("TDB1"!==e)throw"whoops";A=t.subarray(g+8,s-8).createTypedArray(Uint16Array,0,void 0,1)}g+=s}return r.assert(p.length===i),r.assert(f.length===o),{bem1:r.assertExists(c),bsp1:r.assertExists(h),esp1:d,etx1:u,ssp1:m,fld1:p,kfa1:f,tdb1:r.assertExists(A)}}(t);throw"whoops"}(this.jpacData.jpac.version,s),this.resourceId=s.resourceId;const i=this.res.bsp1,o=this.res.etx1,c=this.res.ssp1;C(i.shapeType)||(console.warn(`Unsupported particle shape type ${i.shapeType}`),this.supportedParticle=!1),null===c||C(c.shapeType)||(console.warn(`Unsupported child shape type ${c.shapeType}`),this.supportedChild=!1);const d=s.texIdBase;if(null!==i.texIdxAnimData)for(let a=0;a<i.texIdxAnimData.length;a++)this.ensureTextureFromTDB1Index(e,t,i.texIdxAnimData[a],d);else this.ensureTextureFromTDB1Index(e,t,i.texIdx,d);null!==o&&(0!==o.indTextureMode&&(this.ensureTextureFromTDB1Index(e,t,o.indTextureID,d),2===o.indTextureMode&&this.ensureTextureFromTDB1Index(e,t,o.subTextureID,d)),-1!==o.secondTextureIndex&&this.ensureTextureFromTDB1Index(e,t,o.secondTextureIndex,d)),null!==c&&this.ensureTextureFromTDB1Index(e,t,c.texIdx,d);const u=new _.GXMaterialBuilder("JPA Material");u.setBlendMode(b[i.blendModeFlags>>>0&3],v[i.blendModeFlags>>>2&15],v[i.blendModeFlags>>>6&15]),u.setZMode(!!(i.zModeFlags>>>0&1),w[i.zModeFlags>>>1&7],!!(i.zModeFlags>>>4&1)),u.setAlphaCompare(w[i.alphaCompareFlags>>>0&7],i.alphaRef0,x[i.alphaCompareFlags>>>3&3],w[i.alphaCompareFlags>>>5&7],i.alphaRef1);let m=0;if(i.isEnableProjection?u.setTexCoordGen(m++,0,0,30):u.setTexCoordGen(m++,1,4,30),u.setTevOrder(0,0,0,7),u.setTevColorIn(0,T[4*i.colorInSelect+0],T[4*i.colorInSelect+1],T[4*i.colorInSelect+2],T[4*i.colorInSelect+3]),u.setTevAlphaIn(0,y[4*i.alphaInSelect+0],y[4*i.alphaInSelect+1],y[4*i.alphaInSelect+2],y[4*i.alphaInSelect+3]),u.setTevColorOp(0,0,0,0,!0,0),u.setTevAlphaOp(0,0,0,0,!0,0),null!==o){if(0!==o.indTextureMode){const e=m++;u.setTexCoordGen(e,1,4,60),u.setIndTexOrder(0,e,2),u.setTevIndirect(0,0,0,7,1,0,0,!1,!1,0)}-1!==o.secondTextureIndex&&(u.setTexCoordGen(m++,1,4,60),u.setTevOrder(1,m,3,7),u.setTevColorIn(1,15,8,0,15),u.setTevAlphaIn(1,7,4,0,7),u.setTevColorOp(1,0,0,0,!0,0),u.setTevAlphaOp(1,0,0,0,!0,0))}u.setUsePnMtxIdx(!1),this.materialHelper=new h.GXMaterialHelperGfx(u.finish())}ensureTextureFromTDB1Index(e,t,a,r){const n=r+(null!==this.res.tdb1?this.res.tdb1[a]:a);this.textureIds[a]=n,this.jpacData.ensureTexture(e,t,this.textureIds[a])}fillTextureMapping(e,t){this.jpacData.fillTextureMapping(e,this.textureIds[t])}};class R{constructor(e){const t=[{location:o.getVertexInputLocation(2),format:s.GfxFormat.F32_RGB,bufferIndex:0,bufferByteOffset:0},{location:o.getVertexInputLocation(8),format:s.GfxFormat.F32_RG,bufferIndex:0,bufferByteOffset:12}];this.inputLayout=e.createInputLayout({indexBufferFormat:s.GfxFormat.U16_R,vertexAttributeDescriptors:t,vertexBufferDescriptors:[{byteStride:20,frequency:1}]});const a=-25;this.vertexBufferQuad=u.makeStaticDataBuffer(e,2,new Float32Array([25,25,0,1,0,25,a,0,1,1,a,25,0,0,0,a,a,0,0,1,0,25,25,1,0,0,a,25,1,1,0,25,a,0,0,0,a,a,0,1]).buffer),this.indexBufferQuad=u.makeStaticDataBuffer(e,1,new Uint16Array([0,1,2,2,1,3,4,5,6,6,5,7]).buffer),this.inputStateQuad=e.createInputState(this.inputLayout,[{buffer:this.vertexBufferQuad,byteOffset:0}],{buffer:this.indexBufferQuad,byteOffset:0})}destroy(e){e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputStateQuad),e.destroyBuffer(this.vertexBufferQuad),e.destroyBuffer(this.indexBufferQuad)}}class B{constructor(){this.random={state:0},this.volumePos=n.vec3.create(),this.velOmni=n.vec3.create(),this.velAxis=n.vec3.create(),this.volumeEmitAngleMax=1,this.volumeEmitAngleCount=0,this.volumeEmitXCount=0,this.emitterTrs=n.vec3.create(),this.emitterDirMtx=n.mat4.create(),this.emitterGlobalRot=n.mat4.create(),this.emitterGlobalSR=n.mat4.create(),this.emitterGlobalScl=n.vec3.create(),this.emitterGlobalDir=n.vec3.create(),this.emitterGlobalSRT=n.vec3.create(),this.globalRotation=n.mat4.create(),this.globalScale=n.vec3.create(),this.globalScale2D=n.vec2.create(),this.pivotX=1,this.pivotY=1,this.ybbCamMtx=n.mat4.create(),this.posCamMtx=n.mat4.create(),this.prjMtx=n.mat4.create(),this.texPrjMtx=n.mat4.create(),this.deltaTime=0,this.prevParticlePos=n.vec3.create(),this.particleSortKey=m.makeSortKeyTranslucent(128),this.forceTexMtxIdentity=!1,this.materialParams=new c.MaterialParams,this.packetParams=new c.PacketParams}}t.JPADrawInfo=class{};class P{constructor(e,t,a){this.wordCount=e,this.gfxBuffer=t,this.inputState=a,this.isInUse=!0,this.shadowBufferF32=new Float32Array(e),this.shadowBufferU8=new Uint8Array(this.shadowBufferF32.buffer)}destroy(e){e.destroyBuffer(this.gfxBuffer),e.destroyInputState(this.inputState)}}class E{constructor(e,t){this.inputLayout=t,this.stripeEntry=[];const a=A.makeTriangleIndexBuffer(1,0,512);this.indexBuffer=u.makeStaticDataBuffer(e,1,a.buffer),this.indexBufferDescriptor={buffer:this.indexBuffer,byteOffset:0}}allocateVertexBuffer(e,t){r.assert(t<512);for(let e=0;e<this.stripeEntry.length;e++){const t=this.stripeEntry[e];if(!t.isInUse&&t.wordCount>=2560)return t.isInUse=!0,t}const a=e.createBuffer(2560,2,2),n=e.createInputState(this.inputLayout,[{buffer:a,byteOffset:0}],this.indexBufferDescriptor),s=new P(2560,a,n);return this.stripeEntry.push(s),s}upload(e){for(let t=0;t<this.stripeEntry.length;t++){const a=this.stripeEntry[t];a.isInUse&&e.uploadBufferData(a.gfxBuffer,0,a.shadowBufferU8)}}reset(){for(let e=0;e<this.stripeEntry.length;e++)this.stripeEntry[e].isInUse=!1}destroy(e){for(let t=0;t<this.stripeEntry.length;t++)this.stripeEntry[t].destroy(e);e.destroyBuffer(this.indexBuffer)}}function F(e,t){const a=Math.PI*t[0],r=Math.PI*t[1],n=Math.PI*t[2];d.computeModelMatrixR(e,a,r,n)}function V(e,t){const a=e/t|0,r=e-a*t;return a%2==1?t-r:r}function O(e,t,a,n){const s=e.baseEmitter.resData.res.bsp1,i=r.assertExists(s.texIdxAnimData);let o;if(0===s.texCalcIdxType)o=Math.min(i.length-1,t);else if(1===s.texCalcIdxType)o=((0|t)+n)%i.length;else if(2===s.texCalcIdxType)o=V((0|t)+n,i.length-1);else if(3===s.texCalcIdxType)o=((a*i.length|0)+n)%i.length;else{if(4!==s.texCalcIdxType)throw"whoops";o=n%i.length}return i[o]}function N(e,t,a,r,n,s){const i=a.baseEmitter.resData.res.bsp1;let o=0;if(0===i.colorCalcIdxType)o=Math.min(i.colorAnimMaxFrm,0|r);else if(1===i.colorCalcIdxType)o=((0|r)+s)%(i.colorAnimMaxFrm+1);else if(2===i.colorCalcIdxType)o=V((0|r)+s,i.colorAnimMaxFrm);else if(3===i.colorCalcIdxType)o=((n*(i.colorAnimMaxFrm+1)|0)+s)%(i.colorAnimMaxFrm+1);else{if(4!==i.colorCalcIdxType)throw"whoops";o=s%(i.colorAnimMaxFrm+1)}null!==i.colorPrmAnimData&&l.colorCopy(e,i.colorPrmAnimData[o]),null!==i.colorEnvAnimData&&l.colorCopy(t,i.colorEnvAnimData[o])}t.JPAEmitterManager=class{constructor(e,t,a){this.maxParticleCount=t,this.maxEmitterCount=a,this.workData=new B,this.deadParticlePool=[],this.deadEmitterPool=[],this.aliveEmitters=[],this.workData.emitterManager=this;for(let e=0;e<this.maxEmitterCount;e++)this.deadEmitterPool.push(new G(this));for(let e=0;e<this.maxParticleCount;e++)this.deadParticlePool.push(new Q);this.globalRes=new R(e),this.stripeBufferManager=new E(e,this.globalRes.inputLayout)}createEmitter(e){if(0===this.deadEmitterPool.length)return null;const t=r.assertExists(this.deadEmitterPool.pop());return t.init(e),r.assert(0===t.aliveParticlesBase.length),this.aliveEmitters.push(t),t}forceDeleteEmitter(e){e.deleteAllParticle(),e.flags|=768;const t=this.aliveEmitters.indexOf(e);r.assert(t>=0),this.aliveEmitters.splice(t,1),this.deadEmitterPool.push(e)}calc(e){if(this.workData.deltaTime=Math.min(e,1.5),0!==this.workData.deltaTime)for(let e=0;e<this.aliveEmitters.length;e++){const t=this.aliveEmitters[e];t.calc(this.workData)||0!=(512&t.flags)||(t.deleteAllParticle(),t.flags|=768,this.aliveEmitters.splice(e,1),this.deadEmitterPool.push(t),e--)}}calcYBBMtx(){const e=this.workData.posCamMtx,t=this.workData.ybbCamMtx;n.vec3.set(K,0,e[5],e[6]),n.vec3.normalize(K,K),t[12]=e[12],t[5]=K[1],t[9]=-K[2],t[13]=e[13],t[6]=K[2],t[10]=K[1],t[14]=e[14]}draw(e,t,a,r){if(this.aliveEmitters.length<1)return;n.mat4.copy(this.workData.posCamMtx,a.posCamMtx),n.mat4.copy(this.workData.prjMtx,a.prjMtx),this.calcYBBMtx(),null!==a.texPrjMtx?n.mat4.copy(this.workData.texPrjMtx,a.texPrjMtx):n.mat4.identity(this.workData.texPrjMtx);for(let a=0;a<this.aliveEmitters.length;a++){this.aliveEmitters[a].drawGroupId===r&&this.aliveEmitters[a].draw(e,t,this.workData)}const s=e.createHostAccessPass();this.stripeBufferManager.upload(s),e.submitPass(s),this.stripeBufferManager.reset()}destroy(e){this.globalRes.destroy(e),this.stripeBufferManager.destroy(e)}},t.JPASetRMtxSTVecFromMtx=function(e,t,a,r){if(n.mat4.identity(t),e[0]=Math.hypot(r[0],r[1],r[2]),e[1]=Math.hypot(r[4],r[5],r[6]),e[2]=Math.hypot(r[8],r[9],r[10]),0!==e[0]){const a=1/e[0];t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a}if(0!==e[1]){const a=1/e[1];t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a}if(0!==e[2]){const a=1/e[2];t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a}a[0]=r[12],a[1]=r[13],a[2]=r[14]};const L=r.nArray(4,()=>n.vec3.create());class G{constructor(e){this.emitterManager=e,this.drawParticle=!0,this.emitterScl=n.vec3.create(),this.emitterTrs=n.vec3.create(),this.emitterDir=n.vec3.create(),this.emitterRot=n.vec3.create(),this.random={state:0},this.colorPrm=l.colorNewCopy(l.White),this.colorEnv=l.colorNewCopy(l.White),this.userData=null,this.globalColorPrm=l.colorNewCopy(l.White),this.globalColorEnv=l.colorNewCopy(l.White),this.globalRotation=n.mat4.create(),this.globalScale=n.vec3.create(),this.globalTranslation=n.vec3.create(),this.globalScale2D=n.vec2.create(),this.aliveParticlesBase=[],this.aliveParticlesChild=[],this.drawGroupId=0,this.emitterCallBack=null}setGlobalScale(e){n.vec3.copy(this.globalScale,e),this.globalScale2D[0]=e[0],this.globalScale2D[1]=e[1]}setDrawParticle(e){this.drawParticle=e}init(e){this.resData=e;const t=this.resData.res.bem1,a=this.resData.res.bsp1;var r,s;n.vec3.copy(this.emitterScl,t.emitterScl),n.vec3.copy(this.emitterTrs,t.emitterTrs),n.vec3.copy(this.emitterDir,t.emitterDir),n.vec3.copy(this.emitterRot,t.emitterRot),this.maxFrame=t.maxFrame,this.lifeTime=t.lifeTime,this.rate=t.rate,this.volumeSize=t.volumeSize,this.volumeMinRad=t.volumeMinRad,this.volumeSweep=t.volumeSweep,this.initialVelOmni=t.initialVelOmni,this.initialVelAxis=t.initialVelAxis,this.initialVelDir=t.initialVelDir,this.initialVelRndm=t.initialVelRndm,this.spread=t.spread,this.moment=t.moment,U(this.emitterManager.workData.random),r=this.random,s=this.emitterManager.workData.random,r.state=s.state,n.mat4.identity(this.globalRotation),n.vec3.set(this.globalScale,1,1,1),n.vec3.set(this.globalTranslation,0,0,0),n.vec2.set(this.globalScale2D,1,1),l.colorCopy(this.globalColorPrm,l.White),l.colorCopy(this.globalColorEnv,l.White),l.colorCopy(this.colorPrm,a.colorPrm),l.colorCopy(this.colorEnv,a.colorEnv),this.scaleOut=1,this.emitCount=0,this.waitTime=0,this.tick=0,this.rateStepTimer=0,this.texAnmIdx=0,this.flags=48,this.resData.supportedParticle||(this.flags|=8),this.emitterCallBack=null,this.userData=null}deleteAllParticle(){for(let e=0;e<this.aliveParticlesBase.length;e++)this.emitterManager.deadParticlePool.push(this.aliveParticlesBase[e]);this.aliveParticlesBase.length=0;for(let e=0;e<this.aliveParticlesChild.length;e++)this.emitterManager.deadParticlePool.push(this.aliveParticlesChild[e]);this.aliveParticlesChild.length=0}createChild(e){if(0===this.emitterManager.deadParticlePool.length)return;const t=this.emitterManager.deadParticlePool.pop();this.aliveParticlesChild.push(t),t.init_c(this.emitterManager.workData,e)}calcKey(){for(let e=0;e<this.resData.res.kfa1.length;e++){const t=this.resData.res.kfa1[e],a=M(t,this.tick);if(r.assert(void 0!==a),0===t.keyType)this.rate=a;else if(1===t.keyType)this.volumeSize=a;else if(2===t.keyType)this.volumeSweep=a;else if(3===t.keyType)this.volumeMinRad=a;else if(4===t.keyType)this.lifeTime=a;else if(5===t.keyType)this.moment=a;else if(6===t.keyType)this.initialVelOmni=a;else if(7===t.keyType)this.initialVelAxis=a;else if(8===t.keyType)this.initialVelDir=a;else if(9===t.keyType)this.spread=a;else{if(10!==t.keyType)throw"whoops";this.scaleOut=a}}}calcVolumeCube(e){const t=k(this.random)-.5,a=k(this.random)-.5,r=k(this.random)-.5;n.vec3.set(e.volumePos,t*this.volumeSize,a*this.volumeSize,r*this.volumeSize),n.vec3.mul(e.velOmni,e.volumePos,e.emitterGlobalScl),n.vec3.set(e.velAxis,e.volumePos[0],0,e.volumePos[2])}calcVolumeSphere(e){const t=e.baseEmitter.resData.res.bem1;let a,r;if(2&t.flags){a=Math.PI,e.volumeEmitAngleMax>1&&(a+=e.volumeSweep*(e.volumeEmitAngleCount/(e.volumeEmitAngleMax-1))*6.283),r=.5*Math.PI+e.volumeEmitXCount/(e.divNumber-1)*Math.PI,e.volumeEmitAngleCount++,e.volumeEmitAngleCount===e.volumeEmitAngleMax&&(e.volumeEmitAngleCount=0,e.volumeEmitXCount++,2*e.volumeEmitXCount<e.divNumber?e.volumeEmitAngleMax=1!==e.volumeEmitAngleMax?e.volumeEmitAngleMax+4:e.volumeEmitAngleMax+3:e.volumeEmitAngleMax=4!==e.volumeEmitAngleMax?e.volumeEmitAngleMax-4:1)}else a=e.volumeSweep*I(this.random)*6.283,r=.5*Math.PI+I(this.random)*Math.PI;let s=k(this.random);1&t.flags&&(s=1-s*s*s);const i=e.volumeSize*d.lerp(e.volumeMinRad,1,s);n.vec3.set(e.volumePos,i*Math.cos(r)*Math.sin(a),i*Math.sin(r),i*Math.cos(r)*Math.cos(a)),n.vec3.mul(e.velOmni,e.volumePos,e.emitterGlobalScl),n.vec3.set(e.velAxis,e.volumePos[0],0,e.volumePos[2])}calcVolumeCylinder(e){const t=e.baseEmitter.resData.res.bem1;let a=k(this.random);1&t.flags&&(a=1-a*a);const r=e.volumeSize*d.lerp(e.volumeMinRad,1,a);let s=e.volumeSweep*I(this.random)*6.283;const i=e.volumeSize*D(this.random);n.vec3.set(e.volumePos,r*Math.sin(s),i,r*Math.cos(s)),n.vec3.mul(e.velOmni,e.volumePos,e.emitterGlobalScl),n.vec3.set(e.velAxis,e.volumePos[0],0,e.volumePos[2])}calcVolumeTorus(e){const t=e.volumeSize*e.volumeMinRad,a=e.volumeSweep*I(this.random)*6.283,r=6.283*I(this.random);n.vec3.set(e.velAxis,t*Math.sin(a)*Math.cos(r),t*Math.sin(r),t*Math.cos(a)*Math.sin(r)),n.vec3.set(e.volumePos,e.velAxis[0]+e.volumeSize*Math.sin(a),e.velAxis[1],e.velAxis[2]+e.volumeSize*Math.cos(a)),n.vec3.mul(e.velOmni,e.volumePos,e.emitterGlobalScl)}calcVolumePoint(e){n.vec3.set(e.volumePos,0,0,0);const t=k(this.random)-.5,a=k(this.random)-.5,r=k(this.random)-.5;n.vec3.set(e.velOmni,t,a,r),n.vec3.set(e.velAxis,e.velOmni[0],0,e.velOmni[2])}calcVolumeCircle(e){const t=this.resData.res.bem1;let a;if(2&t.flags){const t=e.volumeEmitIdx++;a=e.volumeSweep*(t/e.volumeEmitCount)*6.283}else a=e.volumeSweep*I(this.random)*6.283;let r=k(this.random);1&t.flags&&(r=1-r*r);const s=e.volumeSize*d.lerp(e.volumeMinRad,1,r);n.vec3.set(e.volumePos,s*Math.sin(a),0,s*Math.cos(a)),n.vec3.mul(e.velOmni,e.volumePos,e.emitterGlobalScl),n.vec3.set(e.velAxis,e.volumePos[0],0,e.volumePos[2])}calcVolumeLine(e){const t=this.resData.res.bem1;if(2&t.flags){const a=e.volumeEmitIdx++;n.vec3.set(e.volumePos,0,0,t.volumeSize*(a/e.volumeEmitCount))}else n.vec3.set(e.volumePos,0,0,t.volumeSize*I(this.random));n.vec3.set(e.velOmni,0,0,e.volumePos[2]*e.globalScale[2]),n.vec3.set(e.velAxis,0,0,e.volumePos[2])}calcVolume(e){const t=this.resData.res.bem1;if(0===t.volumeType)this.calcVolumeCube(e);else if(1===t.volumeType)this.calcVolumeSphere(e);else if(2===t.volumeType)this.calcVolumeCylinder(e);else if(3===t.volumeType)this.calcVolumeTorus(e);else if(4===t.volumeType)this.calcVolumePoint(e);else if(5===t.volumeType)this.calcVolumeCircle(e);else{if(6!==t.volumeType)throw"whoops";this.calcVolumeLine(e)}}createParticle(){if(0===this.emitterManager.deadParticlePool.length)return null;const e=this.emitterManager.deadParticlePool.pop();return this.aliveParticlesBase.push(e),this.calcVolume(this.emitterManager.workData),e.init_p(this.emitterManager.workData),e}create(){const e=this.emitterManager.workData,t=this.resData.res.bem1;if(32&this.flags){if(2&t.flags)1===t.volumeType?this.emitCount=t.divNumber*t.divNumber*4+2:this.emitCount=t.divNumber,e.volumeEmitCount=this.emitCount,e.volumeEmitIdx=0;else{const e=this.rate*(1+t.rateRndm*D(this.random));this.emitCount+=e,16&this.flags&&0!=this.rate&&this.emitCount<1&&(this.emitCount=1)}for(1&this.flags&&(this.emitCount=0);this.emitCount>=1;)this.createParticle(),this.emitCount--}this.rateStepTimer+=e.deltaTime,this.rateStepTimer>=t.rateStep+1?(this.rateStepTimer-=t.rateStep+1,this.flags|=32):this.flags&=-33,this.flags&=-17}processTillStartFrame(){return this.waitTime>=this.resData.res.bem1.startFrame||(2&this.flags||(this.waitTime+=this.emitterManager.workData.deltaTime),!1)}processTermination(){return!!(256&this.flags)||0!==this.maxFrame&&(this.maxFrame<0?(this.flags|=8,0===this.aliveParticlesBase.length&&0===this.aliveParticlesChild.length):this.tick>=this.maxFrame&&(this.flags|=8,!(64&this.flags)&&(0===this.aliveParticlesBase.length&&0===this.aliveParticlesChild.length)))}calcWorkData_c(e){e.volumeSize=this.volumeSize,e.volumeMinRad=this.volumeMinRad,e.volumeSweep=this.volumeSweep,e.volumeEmitXCount=0,e.volumeEmitAngleCount=0,e.volumeEmitAngleMax=1,e.divNumber=2*this.resData.res.bem1.divNumber+1,n.mat4.copy(e.globalRotation,this.globalRotation),F(z,this.emitterRot),n.mat4.mul(e.emitterGlobalRot,e.globalRotation,z),n.mat4.fromScaling(z,this.emitterScl),n.mat4.mul(e.emitterGlobalSR,e.emitterGlobalRot,z),n.vec3.mul(e.emitterGlobalScl,this.globalScale,this.emitterScl),function(e,t,a=K){n.vec3.set(a,t[1],-t[0],0);const r=n.vec3.length(a);n.vec3.normalize(a,a);const s=a[0],i=a[1],o=t[2];e[0]=s*s+o*(1-s*s),e[4]=s*i*(1-o),e[8]=-i*r,e[12]=0,e[1]=s*i*(1-o),e[5]=i*i+o*(1-i*i),e[9]=s*r,e[13]=0,e[2]=i*r,e[6]=-s*r,e[10]=o,e[14]=0}(e.emitterDirMtx,this.emitterDir),n.vec3.copy(e.globalScale,this.globalScale),n.vec3.copy(e.emitterTrs,this.emitterTrs),n.mat4.fromScaling(z,this.globalScale),n.mat4.mul(z,this.globalRotation,z),z[12]=this.globalTranslation[0],z[13]=this.globalTranslation[1],z[14]=this.globalTranslation[2],n.vec3.transformMat4(e.emitterGlobalSRT,this.emitterTrs,z)}calcWorkData_d(e){F(z,this.emitterRot),n.mat4.mul(e.emitterGlobalRot,this.globalRotation,z),n.vec3.transformMat4(e.emitterGlobalDir,this.emitterDir,e.emitterGlobalRot);{this.calcEmitterGlobalPosition(K);const t=f.computeViewSpaceDepthFromWorldSpacePointAndViewMatrix(e.posCamMtx,K);e.particleSortKey=m.setSortKeyDepth(e.particleSortKey,t)}}calc(e){if(!this.processTillStartFrame())return!0;if(this.processTermination())return!1;if(e.baseEmitter=this,!(2&this.flags)){this.calcKey(),null!==this.emitterCallBack&&this.emitterCallBack.execute(this),this.calcWorkData_c(e);const t=this.resData.res.bsp1;null!==t.texIdxAnimData&&t.texCalcOnEmitter&&(this.texAnmIdx=O(e,this.tick,0,0)),t.colorCalcOnEmitter&&N(this.colorPrm,this.colorEnv,e,this.tick,0,0),8&this.flags||this.create();for(let t=0;t<this.aliveParticlesBase.length;t++){const a=this.aliveParticlesBase[t];a.calc_p(e)||(this.aliveParticlesBase.splice(t,1),e.emitterManager.deadParticlePool.push(a),t--)}for(let t=0;t<this.aliveParticlesChild.length;t++){const a=this.aliveParticlesChild[t];a.calc_c(e)||(this.aliveParticlesChild.splice(t,1),e.emitterManager.deadParticlePool.push(a),t--)}this.tick+=e.deltaTime,this.tick<0&&(this.tick=.01)}return!0}calcEmitterGlobalPosition(e){n.mat4.scale(z,this.globalRotation,this.globalScale),z[12]+=this.globalTranslation[0],z[13]+=this.globalTranslation[1],z[14]+=this.globalTranslation[2],n.vec3.transformMat4(e,this.emitterTrs,z)}drawStripe(e,t,a,r,s){const i=r.length;if(i<2)return;const o=this.resData.res.bsp1,l=this.resData.res.esp1,c=0===o.traverseOrder,h=a.packetParams,u=a.materialParams;n.mat4.copy(h.u_PosMtx[0],a.posCamMtx),j(u.u_TexMtx[0],a,a.posCamMtx,u.m_TextureMapping[0].flipY)||o.isEnableTexScrollAnm&&H(u.u_TexMtx[0],o,a.baseEmitter.tick);const m=4===s.dirType;m&&this.calcEmitterGlobalPosition(a.prevParticlePos);const p=25*a.globalScale2D[0],f=null!==l&&l.isEnableScale?l.pivotX-1:0,g=null!==l&&l.isEnableScale?l.pivotY-1:0,_=p*(1+f),S=p*(1-f),b=p*(1+g),v=p*(1-g),w=6===s.shapeType,x=2*i,T=w?2*x:x,y=a.emitterManager.stripeBufferManager.allocateVertexBuffer(e,T);z[12]=0,z[13]=0,z[14]=0;const C=w?4:2;let M=0,U=5*x;for(let e=0;e<i;e++){const t=r[c?i-1-e:e];W(K,t,s.dirType,a),d.isNearZeroVec3(K,.001)?n.vec3.set(K,0,1,0):n.vec3.normalize(K,K),n.vec3.cross(X,t.prevAxis,K),d.isNearZeroVec3(X,.001)?n.vec3.set(X,1,0,0):n.vec3.normalize(X,X),n.vec3.cross(t.prevAxis,K,X),n.vec3.normalize(t.prevAxis,t.prevAxis),z[0]=X[0],z[1]=X[1],z[2]=X[2],z[4]=K[0],z[5]=K[1],z[6]=K[2],z[8]=t.prevAxis[0],z[9]=t.prevAxis[1],z[10]=t.prevAxis[2];const o=_*-t.scale[0],l=S*t.scale[0],h=Math.sin(t.rotateAngle),u=Math.cos(t.rotateAngle);if(n.vec3.set(L[0],o*u,0,o*h),n.vec3.set(L[1],l*u,0,l*h),w){const e=b*-t.scale[1],a=v*t.scale[1];n.vec3.set(L[2],e*-h,0,e*u),n.vec3.set(L[3],a*-h,0,a*u)}for(let e=0;e<C;e++)n.vec3.transformMat4(L[e],L[e],z);const p=e/(i-1);y.shadowBufferF32[M++]=L[0][0]+t.position[0],y.shadowBufferF32[M++]=L[0][1]+t.position[1],y.shadowBufferF32[M++]=L[0][2]+t.position[2],y.shadowBufferF32[M++]=0,y.shadowBufferF32[M++]=p,y.shadowBufferF32[M++]=L[1][0]+t.position[0],y.shadowBufferF32[M++]=L[1][1]+t.position[1],y.shadowBufferF32[M++]=L[1][2]+t.position[2],y.shadowBufferF32[M++]=1,y.shadowBufferF32[M++]=p,w&&(y.shadowBufferF32[U++]=L[2][0]+t.position[0],y.shadowBufferF32[U++]=L[2][1]+t.position[1],y.shadowBufferF32[U++]=L[2][2]+t.position[2],y.shadowBufferF32[U++]=0,y.shadowBufferF32[U++]=p,y.shadowBufferF32[U++]=L[3][0]+t.position[0],y.shadowBufferF32[U++]=L[3][1]+t.position[1],y.shadowBufferF32[U++]=L[3][2]+t.position[2],y.shadowBufferF32[U++]=1,y.shadowBufferF32[U++]=p),m&&n.vec3.copy(a.prevParticlePos,t.position)}const k=a.emitterManager.globalRes,D=t.pushTemplateRenderInst();D.sortKey=a.particleSortKey,D.setInputLayoutAndState(k.inputLayout,y.inputState),Z(e,t,a,D,u,h);const I=A.getTriangleIndexCountForTopologyIndexCount(1,x),R=t.newRenderInst();if(R.drawIndexes(I),t.submitRenderInst(R),w){const e=t.newRenderInst();e.drawIndexes(I,I+6),t.submitRenderInst(e)}t.popTemplateRenderInst()}drawP(e,t,a){const r=this.resData.res.bsp1,s=this.resData.res.etx1;this.flags=4294967167&this.flags,n.vec2.mul(a.globalScale2D,this.globalScale2D,r.globalScale2D),0===r.shapeType?a.globalScale2D[0]*=1.02:1===r.shapeType&&(a.globalScale2D[0]*=1.02,a.globalScale2D[1]*=.4);const i=a.materialParams;if(null===r.texIdxAnimData?this.resData.fillTextureMapping(i.m_TextureMapping[0],r.texIdx):r.texCalcOnEmitter&&this.resData.fillTextureMapping(i.m_TextureMapping[0],this.texAnmIdx),null!==s&&(1===s.indTextureMode&&(this.resData.fillTextureMapping(i.m_TextureMapping[2],s.indTextureID),c.fillIndTexMtx(i.u_IndTexMtx[0],s.indTextureMtx)),-1!==s.secondTextureIndex&&this.resData.fillTextureMapping(i.m_TextureMapping[3],s.secondTextureIndex)),a.forceTexMtxIdentity=!1,0===r.shapeType||1===r.shapeType?n.mat4.identity(i.u_TexMtx[0]):r.isEnableTexScrollAnm||function(e,t){const a=t.tilingX,r=t.tilingY;e[0]=a,e[4]=0,e[8]=0,e[12]=0,e[1]=0,e[5]=r,e[9]=0,e[13]=0,e[2]=0,e[6]=0,e[10]=1,e[14]=0}(i.u_TexMtx[0],r),5===r.shapeType||6===r.shapeType)l.colorMult(i.u_Color[c.ColorKind.C0],this.colorPrm,a.baseEmitter.globalColorPrm),l.colorMult(i.u_Color[c.ColorKind.C1],this.colorEnv,a.baseEmitter.globalColorEnv),this.drawStripe(e,t,a,this.aliveParticlesBase,r);else{const s=4===r.dirType;s&&this.calcEmitterGlobalPosition(a.prevParticlePos);let o=0;const l=this.aliveParticlesBase.length;for(let c=0;c<l;c++){const h=0===r.traverseOrder?l-1-c:c;a.particleSortKey=m.setSortKeyBias(a.particleSortKey,o++),this.aliveParticlesBase[h].drawP(e,t,a,i),s&&n.vec3.copy(a.prevParticlePos,this.aliveParticlesBase[h].position)}}}drawC(e,t,a){const r=this.resData.res.bsp1,s=this.resData.res.ssp1,i=a.materialParams;if(this.flags=128|this.flags,s.isInheritedScale?n.vec2.mul(a.globalScale2D,this.globalScale2D,r.globalScale2D):n.vec2.mul(a.globalScale2D,this.globalScale2D,s.globalScale2D),0===s.shapeType?a.globalScale2D[0]*=1.02:1===s.shapeType&&(a.globalScale2D[0]*=1.02,a.globalScale2D[1]*=.4),a.forceTexMtxIdentity=!0,n.mat4.identity(i.u_TexMtx[0]),a.baseEmitter.resData.fillTextureMapping(i.m_TextureMapping[0],s.texIdx),5===s.shapeType||6===s.shapeType)l.colorMult(i.u_Color[c.ColorKind.C0],s.colorPrm,a.baseEmitter.globalColorPrm),l.colorMult(i.u_Color[c.ColorKind.C1],s.colorEnv,a.baseEmitter.globalColorEnv),this.drawStripe(e,t,a,this.aliveParticlesChild,s);else{const o=4===s.dirType;o&&this.calcEmitterGlobalPosition(a.prevParticlePos);let l=0;const c=this.aliveParticlesChild.length;for(let s=0;s<c;s++){const h=0===r.traverseOrder?c-1-s:s;a.particleSortKey=m.setSortKeyBias(a.particleSortKey,l++),this.aliveParticlesChild[h].drawC(e,t,a,i),o&&n.vec3.copy(a.prevParticlePos,this.aliveParticlesChild[h].position)}}}draw(e,t,a){if(4&this.flags||!this.drawParticle)return;const r=this.resData.res.bsp1,n=this.resData.res.ssp1;a.baseEmitter=this,this.calcWorkData_d(a),!r.stopDrawChild&&null!==n&&r.drawChildrenBefore&&this.drawC(e,t,a),r.stopDrawParent||this.drawP(e,t,a),r.stopDrawChild||null===n||r.drawChildrenBefore||this.drawC(e,t,a)}}function H(e,t,a){const r=.5*t.tilingX,n=.5*t.tilingY,s=t.texStaticTransX+a*t.texScrollTransX+r,i=t.texStaticTransY+a*t.texScrollTransY+n,o=t.texStaticScaleX+a*t.texScrollScaleX,l=t.texStaticScaleY+a*t.texScrollScaleY,c=6.283*(t.texStaticRotate+a*t.texScrollRotate)/65535,h=Math.sin(c),d=Math.cos(c);e[0]=t.tilingX*o*d,e[4]=t.tilingX*o*-h,e[8]=0,e[12]=r+o*(h*i-d*s),e[1]=t.tilingY*l*h,e[5]=t.tilingY*l*d,e[9]=0,e[13]=n+-l*(h*s+d*i),e[2]=0,e[6]=0,e[10]=1,e[14]=0}function j(e,t,a,r){const s=t.baseEmitter.resData.res.bsp1;return s.isEnableProjection&&(s.isEnableTexScrollAnm?(H(e,s,t.baseEmitter.tick),function(e){const t=e[12];e[12]=e[8],e[8]=t;const a=e[13];e[13]=e[9],e[9]=a}(e),n.mat4.copy(z,t.texPrjMtx),r&&(z[5]*=-1,z[13]+=2),n.mat4.mul(e,e,z),n.mat4.mul(e,e,a)):(n.mat4.copy(z,t.texPrjMtx),r&&(z[5]*=-1,z[13]+=2),n.mat4.mul(e,z,a))),s.isEnableProjection}function W(e,t,a,r){0===a?n.vec3.copy(e,t.velocity):1===a?n.vec3.copy(e,t.localPosition):2===a?n.vec3.negate(e,t.localPosition):3===a?n.vec3.copy(e,r.emitterGlobalDir):4===a&&n.vec3.sub(e,r.prevParticlePos,t.position)}function Z(e,t,a,r,n,s){const i=a.baseEmitter.resData.materialHelper;i.setOnRenderInst(e,t.gfxRenderCache,r);let o=r.allocateUniformBuffer(c.ub_MaterialParams,i.materialParamsBufferSize),l=r.allocateUniformBuffer(c.ub_PacketParams,c.u_PacketParamsBufferSize);const h=r.getUniformBuffer().mapBufferF32(o,i.materialParamsBufferSize+c.u_PacketParamsBufferSize);o+=36,o+=p.fillColor(h,o,n.u_Color[c.ColorKind.C0]),o+=p.fillColor(h,o,n.u_Color[c.ColorKind.C1]),o+=4,o+=p.fillMatrix4x3(h,o,n.u_TexMtx[0]),o+=108,o+=c.fillTextureMappingInfo(h,o,n.m_TextureMapping[0]),o+=4,o+=c.fillTextureMappingInfo(h,o,n.m_TextureMapping[2]),o+=c.fillTextureMappingInfo(h,o,n.m_TextureMapping[3]),o+=16,o+=p.fillMatrix4x2(h,o,n.u_IndTexMtx[0]),l+=p.fillMatrix4x3(h,l,s.u_PosMtx[0]),r.setSamplerBindingsFromTextureMappings(n.m_TextureMapping)}t.JPABaseEmitter=G;const z=n.mat4.create(),K=n.vec3.create(),X=n.vec3.create(),Y=n.vec3.create(),$=n.vec3.create(),q=n.mat4.fromValues(1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1);class Q{constructor(){this.position=n.vec3.create(),this.localPosition=n.vec3.create(),this.globalPosition=n.vec3.create(),this.velocity=n.vec3.create(),this.baseVel=n.vec3.create(),this.fieldAccel=n.vec3.create(),this.fieldVel=n.vec3.create(),this.prevAxis=n.vec3.create(),this.accel=n.vec3.create(),this.scale=n.vec2.create(),this.colorPrm=l.colorNewCopy(l.White),this.colorEnv=l.colorNewCopy(l.White)}init_p(e){const t=e.baseEmitter,a=t.resData.res.bem1,r=t.resData.res.bsp1,s=t.resData.res.esp1;this.tick=-1,this.flags=0,this.time=0;const i=k(t.random);if(this.lifeTime=t.lifeTime*(1-i*a.lifeTimeRndm),n.vec3.transformMat4(this.localPosition,e.volumePos,e.emitterGlobalSR),8&a.flags&&(this.flags=32|this.flags),n.vec3.copy(this.globalPosition,e.emitterGlobalSRT),this.position[0]=this.globalPosition[0]+this.localPosition[0]*e.globalScale[0],this.position[1]=this.globalPosition[1]+this.localPosition[1]*e.globalScale[1],this.position[2]=this.globalPosition[2]+this.localPosition[2]*e.globalScale[2],n.vec3.set(this.baseVel,0,0,0),0!==t.initialVelOmni&&d.normToLengthAndAdd(this.baseVel,e.velOmni,t.initialVelOmni),0!==t.initialVelAxis&&d.normToLengthAndAdd(this.baseVel,e.velAxis,t.initialVelAxis),0!==t.initialVelDir){const a=U(t.random)>>>16,r=D(t.random);n.mat4.identity(z),n.mat4.rotateZ(z,z,a/65535*Math.PI),n.mat4.rotateY(z,z,t.spread*r*Math.PI),n.mat4.mul(z,e.emitterDirMtx,z),this.baseVel[0]+=t.initialVelDir*z[8],this.baseVel[1]+=t.initialVelDir*z[9],this.baseVel[2]+=t.initialVelDir*z[10]}if(0!==t.initialVelRndm){const e=I(t.random),a=I(t.random),r=I(t.random);this.baseVel[0]+=t.initialVelRndm*r,this.baseVel[1]+=t.initialVelRndm*a,this.baseVel[2]+=t.initialVelRndm*e}const o=1+D(t.random)*a.initialVelRatio;this.baseVel[0]*=o,this.baseVel[1]*=o,this.baseVel[2]*=o,4&a.flags&&(this.baseVel[0]*=t.emitterScl[0],this.baseVel[1]*=t.emitterScl[1],this.baseVel[2]*=t.emitterScl[2]),n.vec3.transformMat4(this.baseVel,this.baseVel,e.emitterGlobalRot),n.vec3.copy(this.accel,this.baseVel);const c=a.accel*(1+D(t.random)*a.accelRndm);d.normToLength(this.accel,c),n.vec3.set(this.fieldAccel,0,0,0),this.drag=1,this.airResist=Math.min(a.airResist+a.airResistRndm*I(t.random),1),this.moment=t.moment*(1-a.momentRndm*k(t.random)),n.vec3.set(this.prevAxis,e.emitterGlobalRot[4],e.emitterGlobalRot[5],e.emitterGlobalRot[6]),l.colorCopy(this.colorPrm,t.colorPrm),l.colorCopy(this.colorEnv,t.colorEnv),this.anmRandom=k(t.random)*r.anmRndm&255,null!==s&&s.isEnableScale?this.scaleOut=t.scaleOut*(1+s.scaleOutRandom*D(t.random)):this.scaleOut=t.scaleOut,n.vec2.set(this.scale,this.scaleOut,this.scaleOut),this.prmColorAlphaAnm=1,null!==s&&s.isEnableAlpha?this.alphaWaveRandom=1+D(t.random)*s.alphaWaveRandom:this.alphaWaveRandom=1,null!==s&&s.isEnableRotate?(this.rotateAngle=s.rotateAngle+(k(t.random)-.5)*s.rotateAngleRandom,this.rotateSpeed=s.rotateSpeed*(1+s.rotateSpeedRandom*D(t.random)),D(t.random)>=s.rotateDirection&&(this.rotateSpeed*=-1)):(this.rotateAngle=0,this.rotateSpeed=0),this.texAnmIdx=0,this.initField(e)}init_c(e,t){const a=e.baseEmitter,r=a.resData.res.bem1,s=a.resData.res.ssp1;if(this.tick=-1,this.time=0,this.flags=4,this.lifeTime=s.life,n.vec3.copy(this.localPosition,t.localPosition),0!==s.posRndm){const e=k(a.random)-.5,t=k(a.random)-.5,r=k(a.random)-.5;n.vec3.set(K,e,t,r);const i=k(a.random)*s.posRndm;d.normToLengthAndAdd(this.localPosition,K,i)}16&r.flags&&(this.flags=32|this.flags),n.vec3.copy(this.globalPosition,t.globalPosition);const i=s.baseVel*(1+s.baseVelRndm*k(a.random)),o=k(a.random)-.5,c=k(a.random)-.5,h=k(a.random)-.5;n.vec3.set(K,o,c,h),d.normToLength(K,i),n.vec3.scaleAndAdd(this.baseVel,K,t.baseVel,s.velInfRate),n.vec3.scale(this.fieldAccel,t.fieldVel,s.velInfRate),this.moment=t.moment,s.isEnableField?this.drag=t.drag:(this.flags|=64,this.drag=1),n.vec3.copy(this.fieldVel,this.fieldAccel),n.vec3.add(this.velocity,this.baseVel,this.fieldVel);const u=this.moment*this.drag;if(n.vec3.scale(this.velocity,this.velocity,u),n.vec3.copy(this.prevAxis,t.prevAxis),s.isInheritedScale){const e=t.scale[0]*s.inheritScale;this.scale[0]=e;const a=t.scale[1]*s.inheritScale;this.scale[1]=a,this.scaleOut=e,this.alphaWaveRandom=a}else n.vec2.set(this.scale,1,1),this.scaleOut=1,this.alphaWaveRandom=1;s.isInheritedRGB?(this.colorPrm.r=t.colorPrm.r*s.inheritRGB,this.colorPrm.g=t.colorPrm.g*s.inheritRGB,this.colorPrm.b=t.colorPrm.b*s.inheritRGB,this.colorEnv.r=t.colorEnv.r*s.inheritRGB,this.colorEnv.g=t.colorEnv.g*s.inheritRGB,this.colorEnv.b=t.colorEnv.b*s.inheritRGB):(l.colorCopy(this.colorPrm,s.colorPrm),l.colorCopy(this.colorEnv,s.colorEnv)),this.prmColorAlphaAnm=1,s.isInheritedAlpha?this.colorPrm.a=t.colorPrm.a*t.prmColorAlphaAnm*s.inheritAlpha:this.colorPrm.a=s.colorPrm.a,this.rotateAngle=t.rotateAngle,s.isEnableRotate?this.rotateSpeed=s.rotateSpeed:this.rotateSpeed=0,this.texAnmIdx=0}calcFieldFadeAffect(e,t){return 8&e.sttFlag&&t<e.enTime||16&e.sttFlag&&t>=e.disTime?0:64&e.sttFlag&&t>=e.fadeOut?(e.disTime-t)*e.fadeOutRate:32&e.sttFlag&&t<e.fadeIn?(t-e.enTime)*e.fadeInRate:1}calcFieldAffect(e,t){!(4&this.flags)&&120&t.sttFlag&&n.vec3.scale(e,e,this.calcFieldFadeAffect(t,this.time)),0===t.velType?n.vec3.add(this.fieldAccel,this.fieldAccel,e):1===t.velType?n.vec3.add(this.baseVel,this.baseVel,e):2===t.velType&&n.vec3.add(this.fieldVel,this.fieldVel,e)}calcFieldGravity(e,t){2&e.sttFlag?n.vec3.scale(K,e.dir,e.mag):(n.vec3.transformMat4(K,e.dir,t.globalRotation),n.vec3.scale(K,K,e.mag)),this.calcFieldAffect(K,e)}calcFieldAir(e,t){n.vec3.normalize(K,e.dir),2&e.sttFlag?n.vec3.scale(K,K,e.mag):(n.vec3.transformMat4(K,K,t.globalRotation),n.vec3.scale(K,K,e.mag)),this.calcFieldAffect(K,e)}calcFieldMagnet(e,t){n.vec3.sub(K,e.pos,t.emitterTrs),n.vec3.transformMat4(K,K,t.globalRotation),n.vec3.sub(K,K,this.localPosition),d.normToLength(K,e.mag),this.calcFieldAffect(K,e)}calcFieldNewton(e,t){n.vec3.sub(K,e.pos,t.emitterTrs),n.vec3.transformMat4(K,K,t.globalRotation);const a=10*e.mag,r=e.refDistanceSq;n.vec3.sub(K,K,this.localPosition);const s=n.vec3.squaredLength(K);s<=r?d.normToLength(K,a):d.normToLength(K,r/s*a),this.calcFieldAffect(K,e)}calcFieldVortex(e,t){const a=K,r=X;n.vec3.transformMat4(a,e.dir,t.emitterGlobalRot),n.vec3.normalize(a,a);const s=e.pos[2],i=s*s,o=e.innerSpeed,l=e.outerSpeed;n.vec3.scale(r,a,n.vec3.dot(a,this.localPosition)),n.vec3.sub(r,this.localPosition,r);const c=n.vec3.squaredLength(r);if(0===c)return;let h=0;h=c>=i?l:d.lerp(o,l,c/i),n.vec3.normalize(r,r),n.vec3.cross(r,r,a),n.vec3.scale(r,r,h),this.calcFieldAffect(r,e)}calcFieldRandom(e,t){const a=0|this.tick;let r=0===a;if(!r&&e.cycle>0&&a%e.cycle==0&&(r=!0),r){const a=I(t.baseEmitter.random),r=I(t.baseEmitter.random),s=I(t.baseEmitter.random);n.vec3.set(K,a,r,s),n.vec3.scale(K,K,e.mag),this.calcFieldAffect(K,e)}}calcFieldDrag(e,t){4&this.flags?this.drag*=this.dragFieldEffect:this.drag*=1-this.calcFieldFadeAffect(e,this.time)*(1-this.dragFieldEffect)}calcFieldConvection(e,t){n.vec3.cross(Y,e.pos,e.dir),n.vec3.cross(K,e.dir,Y),n.vec3.transformMat4(K,K,t.emitterGlobalRot),n.vec3.transformMat4(X,e.dir,t.emitterGlobalRot),n.vec3.transformMat4(Y,Y,t.emitterGlobalRot),n.vec3.normalize(K,K),n.vec3.normalize(X,X),n.vec3.normalize(Y,Y);const a=n.vec3.dot(K,this.localPosition);n.vec3.scale(K,K,a);const r=n.vec3.dot(Y,this.localPosition);n.vec3.scale(Y,Y,r),n.vec3.add(K,K,Y);const s=n.vec3.length(K);if(0===s)n.vec3.set(K,0,0,0);else{const t=e.refDistanceSq/s;n.vec3.scale(K,K,t)}n.vec3.sub($,this.localPosition,K),n.vec3.cross(Y,X,K),n.vec3.cross(K,Y,$),d.normToLength(K,e.mag),this.calcFieldAffect(K,e)}calcFieldSpin(e,t){n.vec3.transformMat4(K,e.dir,t.emitterGlobalRot),n.vec3.normalize(K,K),n.mat4.identity(z),n.mat4.rotate(z,z,e.innerSpeed,K),n.vec3.transformMat4(K,this.localPosition,z),n.vec3.sub(K,K,this.localPosition),this.calcFieldAffect(K,e)}calcField(e){const t=e.baseEmitter.resData.res.fld1;for(let a=t.length-1;a>=0;a--){const r=t[a];if(!(128&r.sttFlag&&n.vec3.squaredDistance(r.pos,this.position)>=r.maxDistSq))if(0===r.type)this.calcFieldGravity(r,e);else if(1===r.type)this.calcFieldAir(r,e);else if(2===r.type)this.calcFieldMagnet(r,e);else if(3===r.type)this.calcFieldNewton(r,e);else if(4===r.type)this.calcFieldVortex(r,e);else if(5===r.type)this.calcFieldRandom(r,e);else if(6===r.type)this.calcFieldDrag(r,e);else if(7===r.type)this.calcFieldConvection(r,e);else{if(8!==r.type)throw"whoops";this.calcFieldSpin(r,e)}}}initFieldDrag(e,t){this.dragFieldEffect=e.mag+e.magRndm*I(t.random)}initField(e){const t=e.baseEmitter.resData.res.fld1;for(let a=t.length-1;a>=0;a--){const r=t[a];6===r.type&&this.initFieldDrag(r,e)}}canCreateChild(e){if(!e.baseEmitter.resData.supportedChild)return!1;const t=e.baseEmitter.resData.res.ssp1,a=this.tick-(this.lifeTime-1)*t.timing;return!(a<0)&&(0|a)%(t.step+1)==0}calcScaleAnm(e,t){if(0===e)return this.time;if(1===e)return this.tick/t%1;if(2===e)return 1-this.time;throw"whoops"}calcScaleFade(e,t,a,r,n){return e<t.scaleInTiming?e*r+a:e>t.scaleOutTiming?(e-t.scaleOutTiming)*n+1:1}calc_p(e){if(-1===this.tick?this.tick++:this.tick+=e.deltaTime,this.tick<0||this.tick>=this.lifeTime)return!1;const t=e.baseEmitter.resData.res;this.time=this.tick/this.lifeTime,32&this.flags&&n.vec3.copy(this.globalPosition,e.emitterGlobalSRT),n.vec3.set(this.fieldVel,0,0,0),n.vec3.scaleAndAdd(this.baseVel,this.baseVel,this.accel,e.deltaTime),64&this.flags||this.calcField(e),n.vec3.add(this.fieldVel,this.fieldVel,this.fieldAccel),n.vec3.scale(this.baseVel,this.baseVel,this.airResist),n.vec3.add(this.velocity,this.baseVel,this.fieldVel);const a=this.moment*this.drag;if(n.vec3.scale(this.velocity,this.velocity,a),!(2&this.flags)){const a=t.bsp1,r=t.esp1,s=t.ssp1;if(null!==a.texIdxAnimData&&!a.texCalcOnEmitter){const t=this.anmRandom&a.texIdxAnimRndmMask;this.texAnmIdx=O(e,this.tick,this.time,t)}if(a.colorCalcOnEmitter)l.colorCopy(this.colorPrm,e.baseEmitter.colorPrm),l.colorCopy(this.colorEnv,e.baseEmitter.colorEnv);else{const t=this.anmRandom&a.colorAnimRndmMask;N(this.colorPrm,this.colorEnv,e,this.tick,this.time,t)}if(null!==r){if(r.isEnableScale){const e=this.calcScaleAnm(r.scaleAnmTypeX,r.scaleAnmMaxFrameX);if(this.scale[0]=this.scaleOut*this.calcScaleFade(e,r,r.scaleInValueX,r.scaleIncreaseRateX,r.scaleDecreaseRateX),r.isEnableScaleBySpeedX&&(this.scale[0]*=1/n.vec3.length(this.velocity)),r.isDiffXY){const e=this.calcScaleAnm(r.scaleAnmTypeY,r.scaleAnmMaxFrameY);this.scale[1]=this.scaleOut*this.calcScaleFade(e,r,r.scaleInValueY,r.scaleIncreaseRateY,r.scaleDecreaseRateY),r.isEnableScaleBySpeedY&&(this.scale[1]*=1/n.vec3.length(this.velocity))}else this.scale[1]=this.scale[0]}if(r.isEnableAlpha||-1!==r.alphaWaveType){let e;e=this.time<r.alphaInTiming?r.alphaInValue+this.time*r.alphaIncreaseRate:this.time>r.alphaOutTiming?r.alphaBaseValue+(this.time-r.alphaOutTiming)*r.alphaDecreaseRate:r.alphaBaseValue;const t=this.alphaWaveRandom*r.alphaWaveParam3,a=this.alphaWaveRandom*this.tick*6.283/4;if(0===r.alphaWaveType){const n=1+t*(.5*(Math.sin(a*(1-r.alphaWaveParam1))-1));this.prmColorAlphaAnm=e*n}else if(1===r.alphaWaveType){const n=1+t*(.5*(Math.sin(a*(1-r.alphaWaveParam1))+Math.sin(a*(1-r.alphaWaveParam2))-1));this.prmColorAlphaAnm=e*n}else if(2===r.alphaWaveType){const n=1+t*(.5*(Math.sin(a*(1-r.alphaWaveParam1))-1)),s=1+t*(.5*(Math.sin(a*(1-r.alphaWaveParam2))-1));this.prmColorAlphaAnm=e*n*s}else this.prmColorAlphaAnm=e}}if(this.rotateAngle+=this.rotateSpeed*e.deltaTime,null!==s&&this.canCreateChild(e))for(let t=0;t<s.rate;t++)e.baseEmitter.createChild(this);return n.vec3.scaleAndAdd(this.localPosition,this.localPosition,this.velocity,e.deltaTime),n.vec3.mul(this.position,this.localPosition,e.globalScale),n.vec3.add(this.position,this.position,this.globalPosition),!0}return!1}calc_c(e){if(-1===this.tick?this.tick++:this.tick+=e.deltaTime,this.tick<0||this.tick>=this.lifeTime)return!1;const t=e.baseEmitter.resData.res,a=t.ssp1;if(this.time=this.tick/this.lifeTime,0!=this.tick){32&this.flags&&n.vec3.copy(this.globalPosition,e.emitterGlobalSRT),this.baseVel[1]-=a.gravity,n.vec3.set(this.fieldVel,0,0,0),64&this.flags||this.calcField(e),n.vec3.add(this.fieldVel,this.fieldVel,this.fieldAccel),n.vec3.scale(this.baseVel,this.baseVel,t.bem1.airResist),n.vec3.add(this.velocity,this.baseVel,this.fieldVel);const r=this.moment*this.drag;n.vec3.scale(this.velocity,this.velocity,r)}if(!(2&this.flags)){const t=1-this.time;return a.isEnableScaleOut&&(this.scale[0]=this.scaleOut*t,this.scale[1]=this.alphaWaveRandom*t),a.isEnableAlphaOut&&(this.prmColorAlphaAnm=t),this.rotateAngle+=this.rotateSpeed*e.deltaTime,n.vec3.scaleAndAdd(this.localPosition,this.localPosition,this.velocity,e.deltaTime),n.vec3.mul(this.position,this.localPosition,e.globalScale),n.vec3.add(this.position,this.position,this.globalPosition),!0}return!1}loadTexMtx(e,t,a,r){if(!a.forceTexMtxIdentity&&!j(e,a,r,t.flipY)){const t=a.baseEmitter.resData.res.bsp1;t.isEnableTexScrollAnm&&H(e,t,this.tick)}}applyPlane(e,t,a,r){0===t?(e[0]*=a,e[1]*=a,e[2]*=a,e[4]*=r,e[5]*=r,e[6]*=r):1===t?(e[0]*=a,e[1]*=a,e[2]*=a,e[8]*=r,e[9]*=r,e[10]*=r,n.mat4.mul(e,e,q)):2===t&&(e[0]*=a,e[1]*=a,e[2]*=a,e[4]*=r,e[5]*=r,e[6]*=r,e[8]*=a,e[9]*=a,e[10]*=a)}applyRot(e,t,a){const r=Math.cos(t),n=Math.sin(t);if(1===a)e[0]=1,e[4]=0,e[8]=0,e[12]=0,e[1]=0,e[5]=r,e[9]=-n,e[13]=0,e[2]=0,e[6]=n,e[10]=r,e[14]=0;else if(0===a)e[0]=r,e[4]=0,e[8]=-n,e[12]=0,e[1]=0,e[5]=1,e[9]=0,e[13]=0,e[2]=n,e[6]=0,e[10]=r,e[14]=0;else if(2===a)e[0]=r,e[4]=-n,e[8]=0,e[12]=0,e[1]=n,e[5]=r,e[9]=0,e[13]=0,e[2]=0,e[6]=0,e[10]=1,e[14]=0;else if(3===a){const t=1/3*(1-r),a=t+r,s=t-.57735*n,i=t+.57735*n;e[0]=a,e[4]=s,e[8]=i,e[12]=0,e[1]=s,e[5]=a,e[9]=i,e[13]=0,e[2]=i,e[6]=s,e[10]=a,e[14]=0}else if(4===a){const t=.207912,a=.978148;e[0]=r,e[4]=t,e[8]=-n,e[12]=0,e[1]=0,e[5]=a,e[9]=-t,e[13]=0,e[2]=n,e[6]=r*t,e[10]=r*a,e[14]=0}}applyPivot(e,t){const a=t.pivotX;0!==a&&2!==a||(n.mat4.identity(z),0===a?z[12]=-25:2===a&&(z[12]=25),n.mat4.mul(e,e,z));const r=t.pivotY;0!==r&&2!==r||(n.mat4.identity(z),0===r?z[13]=-25:2===r&&(z[13]=25),n.mat4.mul(e,e,z))}drawCommon(e,t,a,r,s){if(8&this.flags)return;const i=a.baseEmitter.resData.res.esp1,o=null!==i&&i.isEnableRotate,h=t.newRenderInst();h.sortKey=a.particleSortKey,t.submitRenderInst(h);const u=a.emitterManager.globalRes,m=s.shapeType,p=a.packetParams;if(2===m){const e=o?this.rotateAngle:0;n.vec3.transformMat4(K,this.position,a.posCamMtx),d.computeModelMatrixSRT(p.u_PosMtx[0],this.scale[0]*a.globalScale2D[0],this.scale[1]*a.globalScale2D[1],1,0,0,e,K[0],K[1],K[2]),this.applyPivot(p.u_PosMtx[0],a),this.loadTexMtx(r.u_TexMtx[0],r.m_TextureMapping[0],a,p.u_PosMtx[0]),h.setInputLayoutAndState(u.inputLayout,u.inputStateQuad),h.drawIndexes(6,0)}else if(3===m||4===m){W(K,this,s.dirType,a),n.vec3.normalize(K,K),n.vec3.cross(X,this.prevAxis,K),n.vec3.normalize(X,X),n.vec3.cross(this.prevAxis,K,X),n.vec3.normalize(this.prevAxis,this.prevAxis);const e=p.u_PosMtx[0];e[0]=this.prevAxis[0],e[1]=this.prevAxis[1],e[2]=this.prevAxis[2],e[4]=K[0],e[5]=K[1],e[6]=K[2],e[8]=X[0],e[9]=X[1],e[10]=X[2],e[12]=this.position[0],e[13]=this.position[1],e[14]=this.position[2];const t=a.globalScale2D[0]*this.scale[0],i=a.globalScale2D[1]*this.scale[1];o?(this.applyRot(z,this.rotateAngle,s.rotType),this.applyPlane(z,s.planeType,t,i),n.mat4.mul(e,e,z)):this.applyPlane(e,s.planeType,t,i),this.applyPivot(e,a),n.mat4.mul(e,a.posCamMtx,e),this.loadTexMtx(r.u_TexMtx[0],r.m_TextureMapping[0],a,e),h.setInputLayoutAndState(u.inputLayout,u.inputStateQuad),4===m?h.drawIndexes(12,0):h.drawIndexes(6,0)}else if(7===m||8===m){const e=p.u_PosMtx[0];this.applyRot(e,this.rotateAngle,s.rotType);const t=a.globalScale2D[0]*this.scale[0],i=a.globalScale2D[1]*this.scale[1];this.applyPlane(e,s.planeType,t,i),e[12]=this.position[0],e[13]=this.position[1],e[14]=this.position[2],this.applyPivot(e,a),n.mat4.mul(e,a.posCamMtx,e),this.loadTexMtx(r.u_TexMtx[0],r.m_TextureMapping[0],a,e),h.setInputLayoutAndState(u.inputLayout,u.inputStateQuad),8===m?h.drawIndexes(12,0):h.drawIndexes(6,0)}else if(9===m){W(K,this,s.dirType,a),n.vec3.set(X,a.posCamMtx[2],a.posCamMtx[6],a.posCamMtx[10]),n.vec3.cross(K,K,X),n.vec3.normalize(K,K),d.computeMatrixWithoutTranslation(z,a.posCamMtx),n.vec3.transformMat4(K,K,z),n.vec3.transformMat4(X,this.position,a.posCamMtx);const e=a.globalScale2D[0]*this.scale[0],t=a.globalScale2D[1]*this.scale[1],i=p.u_PosMtx[0];i[0]=K[0]*e,i[4]=-K[1]*t,i[8]=0,i[12]=X[0],i[1]=K[1]*e,i[5]=K[0]*t,i[9]=0,i[13]=X[1],i[2]=0,i[6]=0,i[10]=1,i[14]=X[2],this.applyPivot(i,a),this.loadTexMtx(r.u_TexMtx[0],r.m_TextureMapping[0],a,i),h.setInputLayoutAndState(u.inputLayout,u.inputStateQuad),h.drawIndexes(6,0)}else{if(10!==m)throw"whoops";{n.vec3.set(K,0,a.posCamMtx[1],a.posCamMtx[2]),n.vec3.normalize(K,K),n.vec3.transformMat4(X,this.position,a.posCamMtx);const e=p.u_PosMtx[0],t=a.globalScale2D[0]*this.scale[0],s=a.globalScale2D[1]*this.scale[1];if(o){const r=Math.sin(this.rotateAngle),n=Math.cos(this.rotateAngle);e[0]=n*t,e[1]=r*a.ybbCamMtx[5]*t,e[2]=r*t*a.ybbCamMtx[9],e[4]=-r*s,e[5]=n*a.ybbCamMtx[5]*s,e[6]=n*s*a.ybbCamMtx[9],e[8]=0,e[9]=-a.ybbCamMtx[9],e[10]=a.ybbCamMtx[5]}else e[0]=t,e[1]=0,e[2]=0,e[4]=0,e[5]=a.ybbCamMtx[5]*s,e[6]=a.ybbCamMtx[6]*s,e[8]=0,e[9]=a.ybbCamMtx[9],e[10]=a.ybbCamMtx[10];e[12]=X[0],e[13]=X[1],e[14]=X[2],this.applyPivot(e,a),this.loadTexMtx(r.u_TexMtx[0],r.m_TextureMapping[0],a,e),h.setInputLayoutAndState(u.inputLayout,u.inputStateQuad),h.drawIndexes(6,0)}}l.colorMult(r.u_Color[c.ColorKind.C0],this.colorPrm,a.baseEmitter.globalColorPrm),r.u_Color[c.ColorKind.C0].a*=this.prmColorAlphaAnm,l.colorMult(r.u_Color[c.ColorKind.C1],this.colorEnv,a.baseEmitter.globalColorEnv),Z(e,t,a,h,r,p)}drawP(e,t,a,r){const n=a.baseEmitter.resData,s=n.res.bsp1,i=n.res.esp1;null===s.texIdxAnimData||s.texCalcOnEmitter||n.fillTextureMapping(r.m_TextureMapping[0],this.texAnmIdx),null!==i?(a.pivotX=i.pivotX,a.pivotY=i.pivotY):(a.pivotX=1,a.pivotY=1),this.drawCommon(e,t,a,r,s)}drawC(e,t,a,r){const n=a.baseEmitter.resData.res.ssp1;a.pivotX=1,a.pivotY=1,this.drawCommon(e,t,a,r,n)}}t.JPABaseParticle=Q;const J=l.colorNewFromRGBA(0,0,0,0);function ee(e,t,a){const n=e.createDataView();r.assert(t>0&&a>0);const s=r.nArray(a+1,()=>l.colorNewFromRGBA(0,0,0,0));let i=0;const o=n.getUint32(2);l.colorFromRGBA8(s[i++],o);const c=n.getUint16(0);for(let e=1;e<=Math.min(c,a);e++)l.colorCopy(s[i++],s[0]);let h=c;for(let e=1;e<t;e++){const t=e-1,o=e,c=n.getUint16(6*t+0);h=n.getUint16(6*o+0),r.assert(c===i-1),l.colorFromRGBA8(J,n.getUint32(6*o+2));for(let e=c+1;e<=Math.min(h,a);e++)l.colorLerp(s[i++],s[c],J,(e-c)/(h-c));r.assert(i===Math.min(h,a)+1)}for(let e=h+1;e<=a;e++)l.colorCopy(s[e],s[h]);return s}function te(e){return 1*e/32768}t.parse=function(e){const t=r.readString(e,0,8);if("JEFFjpa1"===t)return function(e){const t=e.createDataView(),a=r.readString(e,0,8);r.assert("JEFFjpa1"===a);const n=[];n.push({resourceId:0,data:e,texIdBase:0});const s=[],i=t.getUint32(12);let o=32;for(let a=0;a<i;a++){const a=r.readString(e,o+0,4),n=t.getUint32(o+4);if("TEX1"===a){const t=r.readString(e,o+12,20,!0),a=S.BTI.parse(e.slice(o+32,o+n),t);s.push(a)}o+=n}return{version:a,effects:n,textures:s}}(e);if("JPAC1-00"===t)return function(e){const t=e.createDataView(),a=r.readString(e,0,8);r.assert("JPAC1-00"===a);const n=t.getUint16(8),s=t.getUint16(10),i=[];let o=32;for(let a=0;a<n;a++){const a=o,r=t.getUint32(o+12),n=t.getUint16(o+24);o+=32;for(let e=0;e<r;e++){o+=t.getUint32(o+4)}const s=e.slice(a,o);i.push({resourceId:n,data:s,texIdBase:0})}const l=[];let c=o;for(let a=0;a<s;a++){r.assert("TEX1"===r.readString(e,c+0,4,!1));const a=t.getUint32(c+4),n=r.readString(e,c+12,20,!0),s=S.BTI.parse(e.slice(c+32,c+a),n);l.push(s),c+=a}return{version:a,effects:i,textures:l}}(e);if("JPAC2-10"===t)return function(e){const t=e.createDataView(),a=r.readString(e,0,8);r.assert("JPAC2-10"===a);const n=t.getUint16(8),s=t.getUint16(10),i=t.getUint32(12),o=[];let l=16;for(let a=0;a<n;a++){const a=l,r=t.getUint16(l+0),n=t.getUint16(l+2);l+=8;for(let e=0;e<n;e++){l+=t.getUint32(l+4)}const s=e.slice(a,l);o.push({resourceId:r,data:s,texIdBase:0})}const c=[];let h=i;for(let a=0;a<s;a++){r.assert("TEX1"===r.readString(e,h+0,4,!1));const a=t.getUint32(h+4),n=r.readString(e,h+12,20,!0),s=S.BTI.parse(e.slice(h+32,h+a),n);c.push(s),h+=a}return{version:a,effects:o,textures:c}}(e);throw"whoops"}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(12),s=a(0);class i{constructor(){this.vtxIdx0=0,this.vtxIdx1=0,this.vtxIdx2=0,this.infIdx=0,this.grpIdx=0}}class o{constructor(){this.scale=r.vec3.create(),this.rotation=r.vec3.create(),this.translation=r.vec3.create(),this.parentIdx=0,this.nextSiblingIdx=0,this.firstChildIdx=0,this.roomIdx=0,this.treIdx=0,this.attr=0}}class l{constructor(){this.flag=0,this.parentIdx=-1}}class c{constructor(){this.polyID0=0,this.polyID1=0,this.polyID2=0,this.passFlag=0}}t.cBgD_t=class{constructor(e){const t=e.createDataView(),a=t.getUint32(0),n=t.getUint32(4),h=t.getUint32(8),d=t.getUint32(12),u=t.getUint32(16),m=t.getUint32(20),p=t.getUint32(24),f=t.getUint32(28),A=t.getUint32(32),g=t.getUint32(36),_=t.getUint32(40),S=t.getUint32(44);this.vtxTbl=s.nArray(a,()=>r.vec3.create());let b=n;for(let e=0;e<a;e++){const a=this.vtxTbl[e];a[0]=t.getFloat32(b+0),a[1]=t.getFloat32(b+4),a[2]=t.getFloat32(b+8),b+=12}this.triTbl=s.nArray(h,()=>new i);let v=d;for(let e=0;e<h;e++){const a=this.triTbl[e];a.vtxIdx0=t.getUint16(v+0),a.vtxIdx1=t.getUint16(v+2),a.vtxIdx2=t.getUint16(v+4),a.infIdx=t.getUint16(v+6),a.grpIdx=t.getUint16(v+8),v+=10}this.blkTbl=e.createTypedArray(Uint16Array,m,u,1),this.treTbl=s.nArray(p,()=>new l);let w=f;for(let a=0;a<p;a++){const r=this.treTbl[a];r.flag=t.getUint16(w+0),r.parentIdx=t.getUint16(w+2),r.childBlk=e.createTypedArray(Int16Array,w+4,8,1),w+=20}this.grpTbl=s.nArray(A,()=>new o);let x=g;for(let a=0;a<A;a++){const r=this.grpTbl[a],n=t.getUint32(x+0);r.name=s.readString(e,n),r.scale[0]=t.getFloat32(x+4),r.scale[1]=t.getFloat32(x+8),r.scale[2]=t.getFloat32(x+12),r.rotation[0]=t.getInt16(x+16)/32767,r.rotation[1]=t.getInt16(x+18)/32767,r.rotation[2]=t.getInt16(x+20)/32767,r.translation[0]=t.getFloat32(x+24),r.translation[1]=t.getFloat32(x+28),r.translation[2]=t.getFloat32(x+32),r.parentIdx=t.getInt16(x+36),r.nextSiblingIdx=t.getInt16(x+38),r.firstChildIdx=t.getInt16(x+40),r.roomIdx=t.getInt16(x+42),r.treIdx=t.getInt16(x+46),r.attr=t.getUint32(x+48),x+=52}this.infTbl=s.nArray(_,()=>new c);let T=S;for(let e=0;e<_;e++){const a=this.infTbl[e];a.polyID0=t.getUint32(T+0),a.polyID1=t.getUint32(T+4),a.polyID2=t.getUint32(T+8),a.passFlag=t.getUint32(T+12),T+=16}}};class h{constructor(){this.aabb=new n.AABB}}class d{constructor(){this.groundIdx=-1,this.wallIdx=-1,this.roofIdx=-1}}class u{constructor(){this.aabb=new n.AABB}}class m{constructor(){this.triIdx=-1,this.bgIdx=-1,this.bgW=null,this.processId=-1}Reset(){this.triIdx=-1,this.bgIdx=-1,this.bgW=null,this.processId=-1}}t.cBgS_GndChk=class extends class{constructor(){this.polyInfo=new m,this.processId=-1,this.excludeSameProcessId=!0,this.grpPassChk=null,this.polyPassChk=null}ChkSameActorPid(e){return!(-1===this.processId||-1===e||!this.excludeSameProcessId)&&this.processId===e}Reset(){this.polyInfo.Reset(),this.processId=-1,this.excludeSameProcessId=!0,this.grpPassChk=null,this.polyPassChk=null}}{constructor(){super(...arguments),this.pos=r.vec3.create(),this.flags=0,this.retY=-1/0,this.searchGnd=!0,this.searchWall=!0}Reset(){super.Reset(),r.vec3.set(this.pos,0,0,0),this.retY=-1/0,this.flags=3}};const p=r.vec3.create();t.dBgW=class extends class{constructor(){this.flags=0,this.needsFullTransform=!0,this.curMtx=r.mat4.create(),this.oldMtx=r.mat4.create(),this.moveCounter=0,this.translationDelta=r.vec3.create(),this.rootGrpIdx=-1}Set(e,t,a){this.flags=t,this.modelMtxPtr=a,this.dt=e,this.SetVtx(),this.SetTri(),this.rwg=s.nArray(this.dt.triTbl.length,()=>-1),this.blk=s.nArray(this.dt.triTbl.length,()=>new d),this.grp=s.nArray(this.dt.grpTbl.length,()=>new h),this.tre=s.nArray(this.dt.treTbl.length,()=>new u),this.ClassifyPlane(),this.needsFullTransform=!0,this.MakeNodeTree()}Move(){var e,t;1&this.flags&&(128&this.flags||(2&this.flags||(255===this.moveCounter||(e=this.curMtx,t=this.modelMtxPtr,e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[4]!==t[4]||e[5]!==t[5]||e[6]!==t[6]||e[8]!==t[8]||e[9]!==t[9]||e[10]!==t[10])?this.needsFullTransform=!0:this.curMtx[12]===this.modelMtxPtr[12]&&this.curMtx[13]===this.modelMtxPtr[13]&&this.curMtx[14]===this.modelMtxPtr[14]?r.mat4.copy(this.oldMtx,this.curMtx):(this.translationDelta[0]=this.modelMtxPtr[12]-this.curMtx[12],this.translationDelta[1]=this.modelMtxPtr[13]-this.curMtx[13],this.translationDelta[2]=this.modelMtxPtr[14]-this.curMtx[14],this.needsFullTransform=!1),255===this.moveCounter?this.moveCounter=0:this.moveCounter++,this.GlobalVtx()),this.CopyOldMtx(),this.CalcPlane(),this.ClassifyPlane(),this.MakeNodeTree()))}CopyOldMtx(){null!==this.modelMtxPtr&&(r.mat4.copy(this.oldMtx,this.curMtx),r.mat4.copy(this.curMtx,this.modelMtxPtr))}CalcPlane(){if(this.needsFullTransform)for(let e=0;e<this.dt.triTbl.length;e++){const t=this.dt.triTbl[e],a=this.vtx[t.vtxIdx0],r=this.vtx[t.vtxIdx1],n=this.vtx[t.vtxIdx2];this.triElm[e].set(a,r,n)}else for(let e=0;e<this.dt.triTbl.length;e++){const t=this.triElm[e];t.getNormal(p),t.d-=r.vec3.dot(p,this.translationDelta)}}ClassifyPlane(){if(null!==this.vtx)for(let e=0;e<this.dt.blkTbl.length;e++){const t=this.blk[e],a=this.dt.blkTbl[e],r=e<this.dt.blkTbl.length-1?this.dt.blkTbl[e+1]:this.dt.triTbl.length;let n=-1,s=-1,i=-1;for(let e=a;e<r;e++){const a=this.triElm[e];Math.abs(a.x)<=1e-6&&Math.abs(a.y)<=1e-6&&Math.abs(a.z)<=1e-6||(a.y<-.8?(t.roofIdx<0&&(t.roofIdx=e),n>=0&&(this.rwg[n]=e),n=e):a.y<.5?(t.wallIdx<0&&(t.wallIdx=e),s>=0&&(this.rwg[s]=e),s=e):(t.groundIdx<0&&(t.groundIdx=e),i>=0&&(this.rwg[i]=e),i=e))}}}SetTri(){this.triElm=s.nArray(this.dt.triTbl.length,()=>new n.Plane),this.CalcPlane()}SetVtx(){16&this.flags||(1&this.flags?(this.vtx=s.nArray(this.dt.vtxTbl.length,()=>r.vec3.create()),this.GlobalVtx()):this.vtx=this.dt.vtxTbl)}GlobalVtx(){if(null!==this.modelMtxPtr)if(this.needsFullTransform)for(let e=0;e<this.dt.vtxTbl.length;e++)r.vec3.transformMat4(this.vtx[e],this.dt.vtxTbl[e],this.modelMtxPtr);else for(let e=0;e<this.dt.vtxTbl.length;e++)r.vec3.add(this.vtx[e],this.vtx[e],this.translationDelta)}MakeNodeTree(){if(null!==this.vtx){for(let e=0;e<this.grp.length;e++)this.grp[e].aabb.setInf();for(let e=0;e<this.dt.grpTbl.length;e++)-1===this.dt.grpTbl[e].parentIdx&&(this.rootGrpIdx=e,this.MakeNodeTreeGrpRp(e))}else for(let e=0;e<this.dt.grpTbl.length;e++)-1===this.dt.grpTbl[e].parentIdx&&(this.rootGrpIdx=e)}MakeNodeTreeGrpRp(e){const t=this.grp[e],a=this.dt.grpTbl[e].treIdx;a>=0&&(this.MakeNodeTreeRp(a),t.aabb.union(t.aabb,this.tre[a].aabb));for(let a=this.dt.grpTbl[e].firstChildIdx;a>=0;a=this.dt.grpTbl[a].nextSiblingIdx)this.MakeNodeTreeGrpRp(a),t.aabb.union(t.aabb,this.grp[a].aabb)}MakeNodeTreeRp(e){const t=this.tre[e];if(1&this.dt.treTbl[e].flag){const a=this.dt.treTbl[e].childBlk[0];a>=0&&this.MakeBlckBnd(a,t.aabb)}else{t.aabb.setInf();for(let a=0;a<8;a++){const r=this.dt.treTbl[e].childBlk[a];r>=0&&(this.MakeNodeTreeRp(r),t.aabb.union(t.aabb,this.tre[r].aabb))}}}MakeBlckBnd(e,t){const a=this.dt.blkTbl[e],r=e<this.dt.blkTbl.length-1?this.dt.blkTbl[e+1]:this.dt.triTbl.length;if(this.needsFullTransform){t.setInf();for(let e=a;e<r;e++){const a=this.dt.triTbl[e];t.unionPoint(this.vtx[a.vtxIdx0]),t.unionPoint(this.vtx[a.vtxIdx1]),t.unionPoint(this.vtx[a.vtxIdx2])}t.minX-=1,t.minY-=1,t.minZ-=1,t.maxX+=1,t.maxY+=1,t.maxZ+=1}else t.minX+=this.translationDelta[0],t.minY+=this.translationDelta[1],t.minZ+=this.translationDelta[2],t.maxX+=this.translationDelta[0],t.maxY+=this.translationDelta[1],t.maxZ+=this.translationDelta[2]}GroundCrossGrpRp(e,t=this.rootGrpIdx,a=1){if(this.ChkGrpThrough(t,e.grpPassChk,a))return!1;const r=this.grp[t];if(e.pos[0]<=r.aabb.minX||e.pos[0]>r.aabb.maxX)return!1;if(e.pos[1]<=r.aabb.minY||e.retY>r.aabb.maxY)return!1;if(e.pos[2]<=r.aabb.minZ||e.pos[2]>r.aabb.maxZ)return!1;let n=!1;const s=this.dt.grpTbl[t].treIdx;s>=0&&this.GroundCrossRp(e,s)&&(n=!0);for(let r=this.dt.grpTbl[t].firstChildIdx;r>=0;r=this.dt.grpTbl[r].nextSiblingIdx)this.GroundCrossGrpRp(e,r,a+1)&&(n=!0);return n}GroundCrossRp(e,t){let a=!1;const r=this.dt.treTbl[t];if(1&r.flag){const t=r.childBlk[0];if(e.searchGnd){const r=this.blk[t].groundIdx;this.RwgGroundCheckGnd(r,e)&&(a=!0)}if(e.searchWall){const r=this.blk[t].wallIdx;this.RwgGroundCheckWall(r,e)&&(a=!0)}}else for(let t=0;t<8;t++){const n=r.childBlk[t];if(n<0)continue;const s=this.tre[n];e.pos[0]<s.aabb.minX||e.pos[0]>s.aabb.maxX||(e.pos[1]<s.aabb.minY||e.retY>s.aabb.maxY||e.pos[2]<s.aabb.minZ||e.pos[2]>s.aabb.maxZ||this.GroundCrossRp(e,n)&&(a=!0))}return a}RwgGroundCheckWall(e,t){let a=!1;for(;e>=0;e=this.rwg[e]){const r=this.triElm[e];if(r.y<.014)continue;const n=-(r.x*t.pos[0]+r.z*t.pos[2]+r.d)/r.y;this.RwgGroundCheckCommon(n,e,t)&&(a=!0)}return a}RwgGroundCheckGnd(e,t){let a=!1;for(;e>=0;e=this.rwg[e]){const r=this.triElm[e],n=-(r.x*t.pos[0]+r.z*t.pos[2]+r.d)/r.y;this.RwgGroundCheckCommon(n,e,t)&&(a=!0)}return a}RwgGroundCheckCommon(e,t,a){if(e>=a.pos[1]||e<=a.retY)return!1;const r=this.dt.triTbl[t];return n=this.vtx[r.vtxIdx0],s=this.vtx[r.vtxIdx1],i=this.vtx[r.vtxIdx2],!((o=a.pos)[0]<Math.min(n[0],s[0],i[0])||o[0]>Math.max(n[0],s[0],i[0]))&&!(o[2]<Math.min(n[2],s[2],i[2])||o[2]>Math.max(n[2],s[2],i[2]))&&(s[2]-n[2])*(o[0]-n[0])-(s[0]-n[0])*(o[2]-n[2])>=-20&&(i[2]-s[2])*(o[0]-s[0])-(i[0]-s[0])*(o[2]-s[2])>=-20&&(n[2]-i[2])*(o[0]-i[0])-(n[0]-i[0])*(o[2]-i[2])>=-20&&(!this.ChkPolyThrough(t,a.polyPassChk)&&(a.retY=e,a.polyInfo.triIdx=t,!0));var n,s,i,o}ChkGrpThrough(e,t,a){return!1}ChkPolyThrough(e,t){return!1}}{ChkGrpThrough(e,t,a){if(2===a&&null!==t){const a=this.dt.grpTbl[e].attr;return!(!(526080&a)&&1&t.attr)&&(!(256&a&&2&t.attr)&&(!(512&a&&4&t.attr)&&(!(1024&a&&8&t.attr)&&!(524288&a&&16&t.attr))))}return!1}ChkPolyThrough(e,t){if(null!==t){const a=this.dt.infTbl[this.dt.triTbl[e].infIdx];if(t.pass0&&2&a.passFlag)return!0;if(t.pass1&&1&a.passFlag)return!0;if(t.pass2&&4&a.passFlag)return!0;if(t.pass3&&8&a.passFlag)return!0;if(t.pass4&&32&a.passFlag)return!0;if(t.pass5&&64&a.passFlag)return!0;if(t.pass6&&128&a.passFlag)return!0}return!1}};class f{constructor(e,t,a){this.bgW=e,this.processId=t,this.owner=a}}t.dBgS=class extends class{constructor(){this.chkElm=[]}RegistOwner(e,t,a){this.chkElm.push(new f(e,t,a))}Release(e){const t=this.chkElm.findIndex(t=>t.bgW===e);s.assert(t>=0),this.chkElm.splice(t,1)}GroundCross(e){e.searchWall=!!(2&e.flags),e.searchGnd=!!(1&e.flags);for(let t=0;t<this.chkElm.length;t++){const a=this.chkElm[t];e.ChkSameActorPid(a.processId)||a.bgW.GroundCrossGrpRp(e)&&(e.polyInfo.bgIdx=t,e.polyInfo.bgW=a.bgW,e.polyInfo.processId=a.processId)}return e.retY}GetTriPla(e,t){return this.chkElm[e].bgW.triElm[t]}}{Regist(e,t){const a=null!==t?t.processId:-1;this.RegistOwner(e,a,t)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(9),s=a(23),i=a(8),o=a(4),l=r(a(90)),c=a(1),h=a(7),d=a(0),u=a(11),m=a(107),p=a(37),f=a(28),A=a(5),g=a(16);function _(e,t){e.gfxTexture=t,e.width=g.EFB_WIDTH,e.height=g.EFB_HEIGHT,e.flipY=!0}class S{constructor(e,t){this.jpac=t,this.drawInfo=new l.JPADrawInfo,this.resourceDatas=new Map,this.fbTextureNames=["P_ms_fb_8x8i4","AK_kagerouSwap00","IndDummy"],this.emitterManager=new l.JPAEmitterManager(e,6e3,300),this.jpacData=new l.JPACData(this.jpac)}findResourceData(e){const t=this.jpacData.jpac.effects.find(t=>t.resourceId===e);return void 0!==t?[this.jpacData,t]:null}setOpaqueSceneTexture(e){for(let t=0;t<this.fbTextureNames.length;t++){const a=this.jpacData.getTextureMappingReference(this.fbTextureNames[t]);null!==a&&_(a,e)}}resourceDataUsesFB(e){for(let t=0;t<e.textureIds.length;t++){const a=e.textureIds[t],r=this.jpacData.jpac.textures[a].texture.name;if(this.fbTextureNames.includes(r))return!0}return!1}getResourceData(e,t,a){if(!this.resourceDatas.has(a)){const r=this.findResourceData(a);if(null!==r){const[n,s]=r,i=new l.JPAResourceData(e,t,n,s);this.resourceDatas.set(a,i)}}return this.resourceDatas.get(a)}setDrawInfo(e,t,a){this.drawInfo.posCamMtx=e,this.drawInfo.prjMtx=t,this.drawInfo.texPrjMtx=a}calc(e){const t=30*e.deltaTime/1e3;this.emitterManager.calc(t)}draw(e,t,a){this.emitterManager.draw(e,t,this.drawInfo,a)}forceDeleteEmitter(e){this.emitterManager.forceDeleteEmitter(e)}createBaseEmitter(e,t,a){const r=d.assertExists(this.getResourceData(e,t,a));return this.emitterManager.createEmitter(r)}destroy(e){this.jpacData.destroy(e),this.emitterManager.destroy(e)}}function b(e,t,a){return r=t+a,n=e.length,(r+n)%n;var r,n}class v{constructor(){this.onclick=null,this.elem=document.createElement("div"),this.elem.style.font="16px monospace",this.elem.style.textShadow="0px 0px 6px rgba(0, 0, 0, 0.5)",this.elem.style.color="white",this.elem.style.lineHeight="32px",this.elem.style.textAlign="center",this.elem.style.userSelect="none",this.elem.onclick=()=>{null!==this.onclick&&this.onclick()}}setActive(e){this.elem.style.backgroundColor=e?u.HIGHLIGHT_COLOR:"#666",this.elem.style.cursor=e?"pointer":""}setLabel(e){this.elem.textContent=e}}t.SimpleButton=v;class w{constructor(){this.onsubmit=null,this.toplevel=document.createElement("div"),this.toplevel.style.display="grid",this.toplevel.style.gridAutoFlow="column",this.toplevel.style.lineHeight="20px",this.label=document.createElement("div"),this.label.style.font="16px monospace",this.label.style.color="white",this.label.style.userSelect="none",this.toplevel.appendChild(this.label),this.textfield=new u.TextField,this.textfield.textarea.onchange=()=>{null!==this.onsubmit&&this.onsubmit(this.textfield.getValue())},this.toplevel.appendChild(this.textfield.elem),this.elem=this.toplevel}setLabel(e){this.label.textContent=e}}function x(e){const t=document.createElement("datalist");for(let a=0;a<e.length;a++){const r=document.createElement("option");r.textContent=e[a],t.appendChild(r)}return t}const T=n.makeClearRenderPassDescriptor(!0,o.colorNewFromRGBA(.2,.2,.2,1)),y=c.vec3.create(),C=c.mat4.create();class M{constructor(e,t,a=null){this.context=e,this.jpac=t,this.effectNames=a,this.renderTarget=new n.BasicRenderTarget,this.emitters=[],this.currentEffectIndex=-1,this.wiggleEmitters=!1,this.loopEmitters=!0,this.forceCentered=!1,this.opaqueSceneTexture=new n.ColorTexture,this.currentNameEntry=null;const r=e.device;this.uiContainer=e.uiContainer,this.renderHelper=new s.GfxRenderHelper(r),this.effectSystem=new S(r,this.jpac),this.gridPlane=new m.GridPlane(r),this.createUI(),this.setEffectIndex(0)}getResourceIdString(e){const t=this.jpac.effects[e];return d.hexzero(t.resourceId,4)}findByEffectName(e){const t=this.effectNames.findIndex(t=>t.toLowerCase()===e.toLowerCase());return t>=0?t:null}findByResourceId(e){const t=this.jpac.effects.findIndex(t=>t.resourceId===e);return t>=0?t:null}createUI(){const e=new u.FloatingPanel;e.setTitle(u.LAYER_ICON,"Particle Explorer"),e.setWidth(600),this.uiContainer.appendChild(e.elem);const t=x(this.jpac.effects.map((e,t)=>""+t));t.id="EffectIndexList",e.contents.appendChild(t),this.currentEffectIndexEntry=new w,this.currentEffectIndexEntry.setLabel("Effect Index"),this.currentEffectIndexEntry.textfield.textarea.setAttribute("list",t.id),this.currentEffectIndexEntry.onsubmit=e=>{const t=parseInt(e,10);null!==t?this.setEffectIndex(t):this.setUIToCurrent()},e.contents.appendChild(this.currentEffectIndexEntry.elem);const a=x(this.jpac.effects.map((e,t)=>this.getResourceIdString(t)));if(a.id="ResourceIdList",e.contents.appendChild(a),this.currentResourceIdEntry=new w,this.currentResourceIdEntry.setLabel("Resource ID"),this.currentResourceIdEntry.textfield.textarea.setAttribute("list",a.id),this.currentResourceIdEntry.onsubmit=e=>{const t=parseInt(e,16),a=this.findByResourceId(t);null!==a?this.setEffectIndex(a):this.setUIToCurrent()},e.contents.appendChild(this.currentResourceIdEntry.elem),null!==this.effectNames){const t=x(this.effectNames);t.id="EffectNameList",e.contents.appendChild(t),this.currentNameEntry=new w,this.currentNameEntry.setLabel("Name"),this.currentNameEntry.textfield.textarea.setAttribute("list",t.id),this.currentNameEntry.onsubmit=e=>{const t=this.findByEffectName(e);null!==t?this.setEffectIndex(t):this.setUIToCurrent()},e.contents.appendChild(this.currentNameEntry.elem)}const r=document.createElement("div");r.style.display="grid",r.style.gridAutoFlow="column",r.style.gridGap="4px",e.contents.appendChild(r);const n=new v;n.setActive(!0),n.setLabel("Previous"),n.onclick=()=>{this.setEffectIndex(b(this.jpac.effects,this.currentEffectIndex,-1))},r.appendChild(n.elem);const s=new v;s.setActive(!0),s.setLabel("Play"),s.onclick=()=>{this.setEffectIndex(this.currentEffectIndex)},r.appendChild(s.elem);const i=new v;i.setActive(!0),i.setLabel("Next"),i.onclick=()=>{this.setEffectIndex(b(this.jpac.effects,this.currentEffectIndex,1))},r.appendChild(i.elem);const o=new u.Checkbox("Wiggle Emitter",this.wiggleEmitters);o.onchanged=()=>{this.wiggleEmitters=o.checked},e.contents.appendChild(o.elem);const l=new u.Checkbox("Loop",this.loopEmitters);l.onchanged=()=>{this.loopEmitters=l.checked},e.contents.appendChild(l.elem);const c=new u.Checkbox("Force Centered",this.forceCentered);c.onchanged=()=>{this.forceCentered=c.checked},e.contents.appendChild(c.elem)}setUIToCurrent(){this.currentEffectIndexEntry.textfield.setValue(""+this.currentEffectIndex),this.currentResourceIdEntry.textfield.setValue(this.getResourceIdString(this.currentEffectIndex)),null!==this.currentNameEntry&&this.currentNameEntry.textfield.setValue(this.effectNames[this.currentEffectIndex])}createEmitter(e=this.currentEffectIndex){const t=this.jpac.effects[e].resourceId,a=this.effectSystem.createBaseEmitter(this.context.device,this.renderHelper.getCache(),t);a.drawGroupId=this.effectSystem.resourceDataUsesFB(a.resData)?1:0,this.emitters.push(a)}setEffectIndex(e){this.currentEffectIndex=e;for(let e=0;e<this.emitters.length;e++){256&this.emitters[e].flags||this.effectSystem.forceDeleteEmitter(this.emitters[e])}this.emitters.length=0,this.createEmitter(),this.setUIToCurrent()}createCameraController(){return new i.OrbitCameraController}prepareToRender(e,t,a){const r=this.renderHelper.renderInstManager;if(this.renderHelper.pushTemplateRenderInst().filterKey=0,this.gridPlane.prepareToRender(e,r,a),this.loopEmitters)for(let e=this.emitters.length-1;e>=0;e--)256&this.emitters[e].flags&&(this.emitters.splice(e,1),this.createEmitter());if(this.wiggleEmitters){const e=a.time/100;y[0]=50*Math.sin(e),y[1]=50*Math.sin(.777*e),y[2]=50*Math.cos(e)}else c.vec3.set(y,0,0,0);for(let e=0;e<this.emitters.length;e++){c.vec3.copy(this.emitters[e].globalTranslation,y),this.forceCentered&&c.vec3.set(this.emitters[e].emitterTrs,0,0,0);const t=p.getDebugOverlayCanvas2D();p.drawWorldSpacePoint(t,a.camera,this.emitters[e].globalTranslation)}this.effectSystem.calc(a),this.effectSystem.setOpaqueSceneTexture(this.opaqueSceneTexture.gfxTexture);const n=r.pushTemplateRenderInst();n.setBindingLayouts(A.gxBindingLayouts),n.allocateUniformBuffer(A.ub_SceneParams,A.u_SceneParamsBufferSize),A.fillSceneParamsDataOnTemplate(n,a),n.filterKey=0,this.effectSystem.setDrawInfo(a.camera.viewMatrix,a.camera.projectionMatrix,null),this.effectSystem.draw(e,this.renderHelper.renderInstManager,0);{n.filterKey=1;const t=C;i.texProjCameraSceneTex(t,a.camera,a.viewport,1),this.effectSystem.setDrawInfo(a.camera.viewMatrix,a.camera.projectionMatrix,t),this.effectSystem.draw(e,this.renderHelper.renderInstManager,1)}r.popTemplateRenderInst(),r.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=this.renderHelper.renderInstManager,r=e.createHostAccessPass();this.prepareToRender(e,r,t),e.submitPass(r),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.opaqueSceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight);const s=this.renderTarget.createRenderPass(e,t.viewport,T,this.opaqueSceneTexture.gfxTexture);h.executeOnPass(a,e,s,0),e.submitPass(s);const i=this.renderTarget.createRenderPass(e,t.viewport,n.noClearRenderPassDescriptor);return h.executeOnPass(a,e,i,1),a.resetRenderInsts(),i}destroy(e){this.effectSystem.destroy(e)}}t.Explorer=M,t.createRendererFromBuffers=function(e,t){const a=t.map(e=>l.parse(e)),r=a[0],n=[];let s=0;for(let e=0;e<a.length;e++){const i=a[e];d.assert(r.version===i.version);for(let a=0;a<i.effects.length;a++){i!==r&&r.effects.push(i.effects[a]),i.effects[a].texIdBase=s;const o=t[e].name;n.push(1===i.effects.length?o:`${o} ${a}`)}for(let e=0;e<i.textures.length;e++)i!==r&&r.textures.push(i.textures[e]),s++}if(a.length>1)for(let e=0;e<r.effects.length;e++)r.effects[e].resourceId=e;return new M(e,r,n)},t.createRendererFromSMGArchive=function(e,t){const a=f.createCsvParser(t.findFileData("ParticleNames.bcsv")).mapRecords(e=>d.assertExists(e.getValueString("name"))),r=l.parse(t.findFileData("particles.jpc"));return new M(e,r,a)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(52),n=a(28),s=a(1),i=a(2),o=a(4),l=a(5),c=a(40),h=a(0),d=a(109),u=a(53),m=a(223),p=a(164),f=a(43),A=a(144),g=a(106),_=a(6),S=a(34),b=a(17),v=a(16),w=a(32),x=a(25),T=a(165),y=a(110),C=a(79),M=new l.MaterialParams,U=new l.PacketParams,k=s.vec3.create(),D=s.vec3.create(),I=s.vec3.create(),R=s.vec3.create(),B=s.vec2.create(),P=s.mat4.create(),E=s.quat.create(),F=o.colorNewCopy(o.White);function V(e,t,a,r,n){return new xe(e,t,a,r,n,30,-2,-2)}function O(e,t,a,r,n){return new xe(e,t,a,r,n,8,-2,-2)}function N(e,t,a){null!==t.effectKeeper&&t.effectKeeper.createEmitter(e,a)}function L(e,t,a,r){if(null===t.effectKeeper)return;const n=t.effectKeeper.createEmitter(e,a);s.vec3.set(k,r,r,r),n.setGlobalScale(k)}function G(e,t,a,r){if(null===e.effectKeeper)return;const n=h.assertExists(e.effectKeeper.getEmitter(t));n.setGlobalPrmColor(a,-1),n.setGlobalEnvColor(r,-1)}function H(e,t,a){if(null===e.effectKeeper)return;h.assertExists(e.effectKeeper.getEmitter(t)).setGlobalEnvColor(a,-1)}function j(e,t,a){null!==t.effectKeeper&&t.effectKeeper.deleteEmitter(e,a)}function W(e,t,a){null!==t.effectKeeper&&t.effectKeeper.forceDeleteEmitter(e,a)}function Z(e){null!==e.effectKeeper&&e.effectKeeper.deleteEmitterAll()}function z(e,t){return null!==e.effectKeeper&&e.effectKeeper.isRegisteredEmitter(t)}function K(e){e.visibleModel=!1}function X(e){e.visibleModel=!0}function Y(e){return!e.visibleModel}function $(e,t,a,r){const n=P;u.makeMtxTRFromActor(n,r),f.calcMtxAxis(e,t,a,n)}function q(e,t){const a=h.assertExists(t.getBaseMtx());s.vec3.set(e,a[4],a[5],a[6])}function Q(e,t,a,r){s.vec3.negate(I,a),f.makeMtxUpFrontPos(e,I,r,t.translation)}function J(e,t){i.getMatrixTranslation(e,t.worldMatrix)}function ee(e,t){i.getMatrixAxisY(e,t.worldMatrix)}function te(e,t){i.getMatrixAxisZ(e,t.worldMatrix),e[2]*=-1}function ae(e,t,a=k){return J(a,t),s.vec3.distance(e.translation,a)}function re(e,t,a=k){return J(a,t),s.vec3.squaredDistance(e.translation,a)}function ne(e,t,a=k){return ae(e,t,a)}function se(e){return e.modelInstance.shapeInstanceState.jointToWorldMatrixArray.length}function ie(e,t){return e.modelInstance.shapeInstanceState.jointToWorldMatrixArray[t]}function oe(e,t){e[0]*=t,e[4]*=t,e[8]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[2]*=t,e[6]*=t,e[10]*=t}function le(e,t,a,r){const n=Math.cos(e/r*Math.PI*.5);return i.lerp(t,a,1-n)}function ce(e,t,a,r){const n=Math.sin(e/r*Math.PI*.5);return i.lerp(t,a,n)}t.createModelObjBloomModel=V,t.createModelObjMapObj=O,t.emitEffect=N,t.emitEffectWithScale=L,t.setEffectColor=G,t.setEffectEnvColor=H,t.deleteEffect=j,t.forceDeleteEffect=W,t.deleteEffectAll=Z,t.isRegisteredEffect=z,t.hideModel=K,t.showModel=X,t.isHiddenModel=Y,t.calcActorAxis=$,t.calcUpVec=q,t.calcMtxFromGravityAndZAxis=Q,t.getCamPos=J,t.getCamYdir=ee,t.getCamZdir=te,t.calcDistToCamera=ae,t.calcSqDistanceToPlayer=re,t.calcDistanceToPlayer=ne,t.getJointNum=se,t.getJointMtx=ie,t.scaleMatrixScalar=oe;function he(e,t){return e.scenarioData.getMasterZoneFilename()===t}function de(e,t){return(e+t)%t}function ue(e,t,a,r){const n=function(e,t){return`${e.name}${t}`}(t,a);if(!e.modelCache.isObjectDataExist(n))return null;const s=new Ue(e,n,n,t,r);return s.initFixedPositionRelative(null),f.tryStartAllAnim(s,n),s}function me(e,t){return ue(e,t,"Indirect",29)}function pe(e,t,a,r,n=null){const s=function(e,t,a,r,n=null){const s=new Ue(e,"npc parts",a,t,27);return s.initFixedPositionJoint(r,n),s}(e,t,a,r,n);return s.initLightCtrl(e),s}function fe(e,t,a,r=null){const n=new Ue(e,a,a,t,13);return n.initFixedPositionRelative(r),n}function Ae(e,t,a,r){const n=function(e,t,a,r,n=null){const s=new Ue(e,"npc parts",a,t,16);return s.initFixedPositionJoint(r,n),s}(e,t,a,r);return n.initLightCtrl(e),n}function ge(e,t,a){const r=e.modelCache,n=e.npcDirector.getNPCItemData(t,a);null!==n&&(n.goods0&&r.requestObjectData(n.goods0),n.goods1&&r.requestObjectData(n.goods1))}function _e(e){e.setDefaultPos=!0,e.connectToScene=!0,e.initEffect=!0,e.effectFilename=null}function Se(e,t){e.colorChangeFrame=h.fallback(n.getJMapInfoArg0(t),-1)}function be(e,t){e.texChangeFrame=h.fallback(n.getJMapInfoArg1(t),-1)}t.isEqualStageName=he;class ve{constructor(){this.lightType=3,this.initLightControl=!1,this.connectToScene=!1,this.setDefaultPos=!0,this.modelName=null,this.initEffect=!1,this.effectFilename=null,this.colorChangeFrame=-1,this.texChangeFrame=-1,this.rotator=!1,this.railMover=!1,this.initNerve=null,this.initHitSensor=!1}setupDefaultPos(){this.setDefaultPos=!0}setupConnectToScene(){this.connectToScene=!0}setupModelName(e){this.modelName=e}setupEffect(e){this.initEffect=!0,this.effectFilename=e}setupRotator(){this.rotator=!0}setupRailMover(){this.railMover=!0}setupNerve(e){this.initNerve=e}}class we extends u.LiveActor{constructor(e,t,a,n){if(super(e,t,r.getObjectName(a)),this.bloomModel=null,this.rotator=null,this.railMover=null,this.objName=this.name,null!==n.modelName&&(this.objName=n.modelName),n.setDefaultPos&&f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,this.objName),n.connectToScene&&this.connectToScene(t,n),n.initLightControl&&this.initLightCtrl(t),null!==n.initEffect&&this.initEffectKeeper(t,n.effectFilename),null!==n.initNerve&&this.initNerve(n.initNerve),f.isExistCollisionResource(this,this.name)){n.initHitSensor||(this.initHitSensor(),f.addBodyMessageSensorMapObj(t,this));let e=null;const a=this.getSensor("body");f.initCollisionParts(t,this,this.name,a,e)}const s=p.isConnectedWithRail(a);s&&this.initRailRider(t,a),s&&n.railMover&&(this.railMover=new m.MapPartsRailMover(t,this,a)),n.rotator&&(this.rotator=new m.MapPartsRotator(t,this,a)),f.tryStartAllAnim(this,this.objName),-1!==n.colorChangeFrame&&(f.startBrk(this,"ColorChange"),f.setBrkFrameAndStop(this,n.colorChangeFrame)),-1!==n.texChangeFrame&&(f.isBtpExist(this,"TexChange")&&(f.startBtp(this,"TexChange"),f.setBtpFrameAndStop(this,n.texChangeFrame)),f.isBtkExist(this,"TexChange")&&(f.startBtk(this,"TexChange"),f.setBtkFrameAndStop(this,n.texChangeFrame)));const i=`${this.objName}Bloom`;t.modelCache.isObjectDataExist(i)&&(this.bloomModel=V(e,t,this.name,i,this.modelInstance.modelMatrix)),this.makeActorAppeared(t),f.useStageSwitchWriteA(t,this,a)?this.initCaseUseSwitchA(t,a):this.initCaseNoUseSwitchA(t,a),f.useStageSwitchWriteB(t,this,a)?this.initCaseUseSwitchB(t,a):this.initCaseNoUseSwitchB(t,a),f.useStageSwitchReadAppear(t,this,a)&&(f.syncStageSwitchAppear(t,this),this.makeActorDead(t)),f.useStageSwitchSleep(t,this,a)}makeActorAppeared(e){super.makeActorAppeared(e),null!==this.bloomModel&&this.bloomModel.makeActorAppeared(e)}makeActorDead(e){super.makeActorDead(e),null!==this.bloomModel&&this.bloomModel.makeActorDead(e)}connectToScene(e,t){1===t.lightType?f.connectToSceneCollisionMapObjStrongLight(e,this):2===t.lightType?f.connectToSceneCollisionMapObjWeakLight(e,this):f.connectToSceneCollisionMapObj(e,this)}initCaseUseSwitchA(e,t){}initCaseUseSwitchB(e,t){}initCaseNoUseSwitchA(e,t){}initCaseNoUseSwitchB(e,t){}isObjectName(e){return this.objName===e}startMapPartsFunctions(){null!==this.rotator&&this.rotator.start(),null!==this.railMover&&this.railMover.start()}control(e,t){super.control(e,t),null!==this.rotator&&this.rotator.movement(e,t),null!==this.railMover&&this.railMover.movement(e,t)}calcAndSetBaseMtx(e,t){if(null!==this.rotator&&this.rotator.isWorking()){const e=this.modelInstance.modelMatrix;s.mat4.identity(e),null!==this.rotator&&this.rotator.isWorking()&&s.mat4.mul(e,e,this.rotator.mtx),null!==this.railMover&&this.railMover.isWorking()&&s.mat4.mul(e,e,this.railMover.mtx),e[12]=this.translation[0],e[13]=this.translation[1],e[14]=this.translation[2]}else super.calcAndSetBaseMtx(e,t)}}t.SimpleMapObj=class extends we{constructor(e,t,a){const n=new ve;_e(n),r.getObjectName(a),Se(n,a),be(n,a),super(e,t,a,n)}};t.SimpleEnvironmentObj=class extends we{constructor(e,t,a){const r=new ve;_e(r),super(e,t,a,r)}connectToScene(e,t){1===t.lightType?f.connectToSceneEnvironmentStrongLight(e,this):f.connectToSceneEnvironment(e,this)}};class xe extends u.LiveActor{constructor(e,t,a,r,n,i,o,l){super(e,t,a),this.transformMatrix=n,this.initModelManagerWithAnm(t,r),null!==this.transformMatrix&&s.mat4.getTranslation(this.translation,this.transformMatrix),o<-1&&(o=8),l<-1&&(l=35),i<-1&&(i=11),f.connectToScene(t,this,o,l,i,-1)}calcAndSetBaseMtx(e,t){null!==this.transformMatrix?(s.mat4.getTranslation(this.translation,this.transformMatrix),s.mat4.copy(this.modelInstance.modelMatrix,this.transformMatrix)):super.calcAndSetBaseMtx(e,t)}}t.ModelObj=xe;t.RotateMoveObj=class extends we{constructor(e,t,a){const n=new ve;_e(n),n.setupRotator(),r.getObjectName(a),Se(n,a),be(n,a),super(e,t,a,n),0===m.getMapPartsArgMoveConditionType(a)&&this.startMapPartsFunctions()}};t.RailMoveObj=class extends we{constructor(e,t,a){const n=new ve;n.setupDefaultPos(),n.setupConnectToScene(),n.setupEffect(null),n.setupRailMover(),n.setupNerve(0),r.getObjectName(a),super(e,t,a,n),this.isWorking=!1,p.isConnectedWithRail(a)||this.setNerve(1),1===m.getMapPartsArgMoveConditionType(a)&&this.setNerve(2)}startMoveInner(){f.isBckExist(this,"Move")&&f.startBck(this,"Move")}receiveMessage(e,t,a,r){return 207===t&&0===this.getCurrentNerve()?(this.makeActorDead(e),!0):super.receiveMessage(e,t,a,r)}move(){}doAtEndPoint(){}endMove(){return this.doAtEndPoint(),!0}movement(e,t){if(super.movement(e,t),0===this.getCurrentNerve()){d.isFirstStep(this)&&this.startMapPartsFunctions();const e=this.railMover.isWorking();!this.isWorking&&e&&this.startMoveInner(),this.isWorking=this.isWorking,this.move(),this.railMover.isReachedEnd()&&(this.railMover.isDone()&&this.endMove()?this.setNerve(1):this.doAtEndPoint())}}};class Te extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.bloomModel=null,this.waterModel=null,this.indirectModel=null,f.initDefaultPos(t,this,a),this.initModel(t,this.name,a),f.connectToScenePlanet(t,this),this.initEffectKeeper(t,null),this.initHitSensor(),f.addBodyMessageSensorMapObj(t,this);const n=this.getSensor("body");if(f.isExistCollisionResource(this,this.name)){let e=null;f.initCollisionParts(t,this,this.name,n,e)}f.tryStartAllAnim(this,this.name),this.tryStartMyEffect(t),this.makeActorAppeared(t)}initModel(e,t,a){this.initModelManagerWithAnm(e,this.name),this.initBloomModel(e,t),this.waterModel=function(e,t){return ue(e,t,"Water",8)}(e,this),this.indirectModel=me(e,this)}initBloomModel(e,t){const a=`${t}Bloom`;e.modelCache.isObjectDataExist(a)&&(this.bloomModel=V(this.zoneAndLayer,e,this.name,a,this.getBaseMtx()),s.vec3.copy(this.bloomModel.scale,this.scale))}tryStartMyEffect(e){if(null!==this.effectKeeper){N(e,this,this.name);for(let t=0;t<this.effectKeeper.multiEmitters.length;t++)N(e,this,`${this.name}${h.leftPad(""+t,2,"0")}`)}}}t.PlanetMap=Te;t.RailPlanetMap=class extends Te{constructor(e,t,a){super(e,t,a),this.initRailRider(t,a)}};class ye{constructor(){this.goods0="",this.goods1="",this.goodsJoint0="",this.goodsJoint1=""}}t.NPCDirector=class{constructor(e){this.npcDataArc=e,this.scratchNPCActorItem=new ye}getNPCItemData(e,t,a=this.scratchNPCActorItem){if(-1===t)return null;const r=n.createCsvParser(this.npcDataArc.findFileData(`${e}Item.bcsv`));return r.setRecord(t),a.goods0=h.assertExists(r.getValueString("mGoods0")),a.goods1=h.assertExists(r.getValueString("mGoods1")),a.goodsJoint0=h.assertExists(r.getValueString("mGoodsJoint0")),a.goodsJoint1=h.assertExists(r.getValueString("mGoodsJoint1")),a}};class Ce extends u.LiveActor{constructor(){super(...arguments),this.goods0=null,this.goods1=null,this.lastRotation=s.vec3.create(),this.poseQuat=s.quat.create(),this.waitAction=null,this.walkAction=null,this.desiredRailSpeed=2,this.maxChangeRailSpeed=.1,this.railTurnSpeed=.08,this.turnBckRate=1,this.railGrounded=!1}calcAndSetBaseMtx(e,t){s.vec3.equals(this.rotation,this.lastRotation)||(i.quatFromEulerRadians(this.poseQuat,this.rotation[0],this.rotation[1],this.rotation[2]),s.vec3.copy(this.lastRotation,this.rotation)),u.makeMtxTRFromActor(this.modelInstance.modelMatrix,this),f.makeMtxTRFromQuatVec(this.modelInstance.modelMatrix,this.poseQuat,this.translation)}initAfterPlacement(e){super.initAfterPlacement(e),f.calcGravity(e,this),null!==this.waitAction&&(f.startAction(this,this.waitAction),f.isBckExist(this,this.waitAction)&&f.startBckNoInterpole(this,this.waitAction),f.setBckFrameAtRandom(this))}equipment(e,t,a=!1){null!==t&&(a?(t.goods0&&(this.goods0=Ae(e,this,t.goods0,t.goodsJoint0)),t.goods1&&(this.goods1=Ae(e,this,t.goods1,t.goodsJoint1))):(t.goods0&&(this.goods0=pe(e,this,t.goods0,t.goodsJoint0)),t.goods1&&(this.goods1=pe(e,this,t.goods1,t.goodsJoint1))))}makeActorAppeared(e){super.makeActorAppeared(e),null!==this.goods0&&this.goods0.makeActorAppeared(e),null!==this.goods1&&this.goods1.makeActorAppeared(e)}makeActorDead(e){super.makeActorDead(e),null!==this.goods0&&this.goods0.makeActorDead(e),null!==this.goods1&&this.goods1.makeActorDead(e)}}class Me{constructor(e,t=null){this.baseMtx=e,this.transformMatrix=s.mat4.create(),this.localTrans=s.vec3.create(),null!==t&&this.setLocalTrans(t)}setLocalTrans(e){s.vec3.copy(this.localTrans,e)}calc(){s.mat4.copy(this.transformMatrix,this.baseMtx),s.mat4.translate(this.transformMatrix,this.transformMatrix,this.localTrans)}}class Ue extends u.LiveActor{constructor(e,t,a,r,n,s=null){super(r.zoneAndLayer,e,t),this.parentActor=r,this.fixedPosition=null,this.transformMatrix=null,this.initModelManagerWithAnm(e,a),this.initEffectKeeper(e,null);let i=43,o=11;n>=21&&n<=24?(i=38,o=10):16!==n&&27!==n||(i=40,o=6),this.transformMatrix=s,f.connectToScene(e,this,i,o,n,-1)}initFixedPositionRelative(e){this.fixedPosition=new Me(this.parentActor.modelInstance.modelMatrix,e),this.transformMatrix=this.fixedPosition.transformMatrix}initFixedPositionJoint(e,t){this.fixedPosition=new Me(this.parentActor.getJointMtx(e),t),this.transformMatrix=this.fixedPosition.transformMatrix}calcAnim(e,t){null!==this.fixedPosition&&this.fixedPosition.calc(),super.calcAnim(e,t)}calcAndSetBaseMtx(e,t){null!==this.transformMatrix?(this.translation[0]=this.transformMatrix[12],this.translation[1]=this.transformMatrix[13],this.translation[2]=this.transformMatrix[14],s.mat4.copy(this.modelInstance.modelMatrix,this.transformMatrix)):super.calcAndSetBaseMtx(e,t)}}t.CollapsePlane=class extends we{constructor(e,t,a){const r=new ve;r.setupConnectToScene(),super(e,t,a,r)}};const ke=[o.colorNewFromRGBA8(2139029759),o.colorNewFromRGBA8(2147523071),o.colorNewFromRGBA8(3886022911),o.colorNewFromRGBA8(1184958719),o.colorNewFromRGBA8(928686335),o.colorNewFromRGBA8(3191016447),o.colorNewFromRGBA8(2155905279)];class De extends u.LiveActor{constructor(e,t,a){super(e,t,"StarPiece"),this.effectCounter=0;let r=-1;null!==a&&(f.initDefaultPos(t,this,a),r=h.fallback(n.getJMapInfoArg3(a),-1)),this.initModelManagerWithAnm(t,this.name),f.connectToSceneNoSilhouettedMapObj(t,this),(r<0||r>5)&&(r=f.getRandomInt(1,7));const s=ke[r];this.effectPrmColor=o.colorNewCopy(s),this.effectPrmColor.r=i.saturate(this.effectPrmColor.r+1),this.effectPrmColor.g=i.saturate(this.effectPrmColor.g+1),this.effectPrmColor.b=i.saturate(this.effectPrmColor.b+1),this.effectEnvColor=o.colorNewCopy(s),this.effectEnvColor.r=i.saturate(this.effectEnvColor.r+32/255),this.effectEnvColor.g=i.saturate(this.effectEnvColor.g+32/255),this.effectEnvColor.b=i.saturate(this.effectEnvColor.b+32/255),this.modelInstance.setColorOverride(l.ColorKind.MAT0,s),this.initEffectKeeper(t,"StarPiece"),f.startBtk(this,"Gift"),f.setBtkFrameAndStop(this,5)}movement(e,t){super.movement(e,t);const a=this.effectCounter+r.getDeltaTimeFrames(t);var n,s,i;n=this.effectCounter,s=a,n<(i=20)&&s>=i&&this.emitGettableEffect(e,t,4),this.effectCounter=a%90}emitGettableEffect(e,t,a){ae(this,t.camera)>200&&L(e,this,"GetAble",1),G(this,"GetAble",this.effectPrmColor,this.effectEnvColor)}calcAndSetBaseMtx(e,t){this.rotation[1]+=.26175*r.getDeltaTimeFrames(t),super.calcAndSetBaseMtx(e,t)}}t.StarPiece=De;class Ie extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.pipeStream=null,this.axisY=s.vec3.create(),this.origTranslation=s.vec3.create(),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"EarthenPipe");const i=h.fallback(n.getJMapInfoArg7(a),0);f.startBrk(this,"EarthenPipe"),f.setBrkFrameAndStop(this,i),f.connectToSceneCollisionMapObjStrongLight(t,this),this.initEffectKeeper(t,null),n.getJMapInfoBool(h.fallback(n.getJMapInfoArg2(a),-1))&&K(this),s.vec3.copy(this.origTranslation,this.translation);n.getJMapInfoBool(h.fallback(n.getJMapInfoArg7(a),-1));q(this.axisY,this),this.scaleY=100*this.scale[1],this.scale[1]=1,this.calcTrans(),"EarthenPipeInWater"===this.name&&(this.pipeStream=function(e,t,a,r=null){const n=new Ue(e,a,a,t,8);return n.initFixedPositionRelative(r),n}(t,this,"EarthenPipeStream"),f.tryStartAllAnim(this.pipeStream,"EarthenPipeStream"))}calcTrans(){s.vec3.copy(this.translation,this.axisY),s.vec3.scale(this.translation,this.translation,this.scaleY),s.vec3.add(this.translation,this.translation,this.origTranslation)}static requestArchives(e,t){e.modelCache.requestObjectData("EarthenPipe"),"EarthenPipeInWater"===r.getObjectName(t)&&e.modelCache.requestObjectData("EarthenPipeStream")}}function Re(e,t,a){h.assertExists(e.effectKeeper.getEmitter(t)).setHostMtx(a)}function Be(e,t,a,r,n){h.assertExists(e.effectKeeper.getEmitter(t)).setHostSRT(a,r,n)}t.EarthenPipe=Ie;class Pe extends u.LiveActor{constructor(e,t,a){let i;super(e,t,r.getObjectName(a)),this.effectHostMtx=s.mat4.create(),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"BlackHoleRange"),f.connectToSceneCollisionMapObj(t,this),this.blackHoleModel=O(e,t,"BlackHole","BlackHole",this.modelInstance.modelMatrix),this.initEffectKeeper(t,"BlackHoleRange"),Re(this,"BlackHoleSuction",this.effectHostMtx),f.startBck(this,"BlackHoleRange"),f.startBtk(this,"BlackHoleRange"),f.startBtk(this.blackHoleModel,"BlackHole");const o=h.fallback(n.getJMapInfoArg0(a),-1);i=o<0?"BlackHoleCube"!==this.name?this.scale[0]:1:o/1e3,this.updateModelScale(i,i)}calcAndSetBaseMtx(e,t){if(super.calcAndSetBaseMtx(e,t),null!==this.effectKeeper){const e=D,a=I;J(e,t.camera),s.vec3.sub(e,e,this.translation),ee(a,t.camera),f.makeMtxFrontUpPos(this.effectHostMtx,e,a,this.translation),oe(this.effectHostMtx,this.scale[0])}}updateModelScale(e,t){s.vec3.set(this.scale,e,e,e),s.vec3.set(this.blackHoleModel.scale,.5*t,.5*t,.5*t)}static requestArchives(e,t){e.modelCache.requestObjectData("BlackHole"),e.modelCache.requestObjectData("BlackHoleRange")}}t.BlackHole=Pe;t.PeachCastleGardenPlanet=class extends we{constructor(e,t,a){const r=new ve;!function(e){e.setDefaultPos=!0,e.connectToScene=!0,e.initEffect=!0,e.effectFilename=null}(r),r.setupNerve(0),super(e,t,a,r),this.indirectModel=me(t,this)}initCaseUseSwitchA(e,t){super.initCaseUseSwitchA(e,t),f.listenStageSwitchOnOffA(e,this,this.startDamage.bind(this),this.startWait.bind(this))}startWait(e){this.setNerve(0)}startDamage(e){this.setNerve(1)}updateSpine(e,t,a){super.updateSpine(e,t,a),0===t?d.isFirstStep(this)&&f.startBrk(this,"Before"):1===t&&d.isFirstStep(this)&&f.startBrk(this,"After")}connectToScene(e){f.connectToScenePlanet(e,this)}};class Ee extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"HatchWaterPlanet"),f.connectToScenePlanet(t,this),this.initEffectKeeper(t,null),f.tryStartAllAnim(this,"HatchWaterPlanet"),f.setLoopMode(this,0)}}t.HatchWaterPlanet=Ee;class Fe extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),s.vec3.set(this.scale,1.2,1.2,1.2),this.initModelManagerWithAnm(t,"Kinopio"),f.connectToSceneNpc(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null),this.initNerve(0),p.isConnectedWithRail(a)&&this.initRailRider(t,a),this.boundingSphereRadius=100;const i=h.fallback(n.getJMapInfoArg7(a),-1),o=t.npcDirector.getNPCItemData("Kinopio",i);this.equipment(t,o),this.waitAction="Wait",this.walkAction="Walk",this.railGrounded=!0,this.desiredRailSpeed=.83;const l=h.fallback(n.getJMapInfoArg2(a),-1);0===l?this.waitAction="SpinWait1":1===l?this.waitAction="SpinWait2":2===l?this.waitAction="SpinWait3":3===l||4===l||(5===l?(this.waitAction="SwimWait",this.walkAction="SwimWait"):6===l?this.waitAction="Pickel":7===l?this.waitAction="Sleep":8===l||(9===l?(this.waitAction="KinopioGoodsWeapon",this.walkAction="KinopioGoodsWeaponWalk"):10===l?(this.waitAction="Joy",this.walkAction="Joy"):11===l?this.waitAction="Rightened":12===l?(this.waitAction="StarPieceWait",this.walkAction="KinopioGoodsStarPieceWalk"):13===l?(this.walkAction="Getaway",this.desiredRailSpeed=3.32):-1===l&&2===i&&(this.waitAction="WaitPickel",this.walkAction="WalkPickel"))),f.startBrk(this,"ColorChange"),f.setBrkFrameAndStop(this,h.fallback(n.getJMapInfoArg1(a),0)),-1!==h.fallback(a.getValueNumber("SW_APPEAR"),-1)&&this.makeActorDead(t),f.useStageSwitchSleep(t,this,a)}updateSpine(e,t,a){if(super.updateSpine(e,t,a),0===t){const t=f.isExistRail(this)?f.getNextRailPointNo(this):0;Le(e,this,a),f.isExistRail(this)&&f.getNextRailPointNo(this)!==t&&this.tryStartArgs()}}tryStartArgs(){}static requestArchives(e,t){e.modelCache.requestObjectData("Kinopio"),ge(e,"Kinopio",h.fallback(n.getJMapInfoArg7(t),-1))}}t.Kinopio=Fe;t.KinopioAstro=class extends Fe{};function Ve(e,t,a,r,n,o,l){s.vec3.lerp(e.translation,e.translation,r,l),s.vec3.equals(t,i.Vec3Zero),Number.isNaN(e.poseQuat[0]),1===n&&1===o?f.makeQuatUpFront(e.poseQuat,t,a):f.blendQuatUpFront(e.poseQuat,e.poseQuat,t,a,n,o)}function Oe(e,t,a){f.isExistRail(t)&&(f.adjustmentRailCoordSpeed(t,t.desiredRailSpeed*a,t.maxChangeRailSpeed),f.moveRailRider(t),t.railGrounded?function(e,t,a,r){f.getRailPos(D,a),s.vec3.scaleAndAdd(I,D,t.gravityVector,-10),s.vec3.scale(R,t.gravityVector,1e3),y.getFirstPolyOnLineToMap(e,D,null,I,R),f.getRailDirection(I,t),s.vec3.negate(R,t.gravityVector),Ve(t,R,I,D,1,r,1)}(e,t,t,t.railTurnSpeed*a):function(e,t,a){f.getRailPos(D,e),f.getRailDirection(I,e),s.vec3.negate(R,e.gravityVector),Ve(e,R,I,D,1,t,a)}(t,t.railTurnSpeed*a,t.railTurnSpeed*a),f.isRailReachedGoal(t)&&f.reverseRailDirection(t))}function Ne(e,t){!function(e,t){null!==t.waitAction&&f.tryStartAction(t,t.waitAction)}(0,t)}function Le(e,t,a){!function(e,t,a){if(!f.isExistRail(t))return void Ne(0,t);if(i.isNearZero(t.desiredRailSpeed,.001)&&i.isNearZero(f.getRailCoordSpeed(t),.001))return void Ne(0,t);Oe(e,t,a);let r=t.walkAction;null!==r&&f.tryStartAction(t,r)}(e,t,a)}t.Peach=class extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a));const n=this.name;f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,n),f.connectToSceneNpc(t,this),this.initLightCtrl(t),this.boundingSphereRadius=100,f.startAction(this,"Help")}static requestArchives(e,t){super.requestArchives(e,t),ge(e,"Kinopio",h.fallback(n.getJMapInfoArg7(t),-1))}};t.Penguin=class extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.diveCounter=0;const s=this.name;f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,s),f.connectToSceneNpc(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null),this.boundingSphereRadius=100,p.isConnectedWithRail(a)&&(this.initRailRider(t,a),f.moveCoordAndTransToNearestRailPos(this)),this.arg0=h.fallback(n.getJMapInfoArg0(a),-1),0===this.arg0?this.waitAction="SitDown":1===this.arg0?(this.waitAction="SwimWait",this.walkAction="Swim",this.desiredRailSpeed=5):2===this.arg0?(this.waitAction="SwimWaitSurface",this.walkAction="SwimSurface",this.desiredRailSpeed=5):3===this.arg0?this.waitAction="SwimWaitSurface":4===this.arg0?(this.waitAction="SwimTurtleTalk",this.walkAction="SwimTurtle",this.desiredRailSpeed=10):6===this.arg0?(this.waitAction="Wait",this.walkAction="DashA",this.desiredRailSpeed=6,this.railTurnSpeed=.8,this.railGrounded=!0):(this.waitAction="Wait",this.walkAction="Walk",this.desiredRailSpeed=1.5,this.turnBckRate=2,this.railGrounded=!0),f.setBckFrameAtRandom(this),f.startBrk(this,"ColorChange"),f.setBrkFrameAndStop(this,h.fallback(n.getJMapInfoArg7(a),0)),this.initNerve(0)}updateSpine(e,t,a){super.updateSpine(e,t,a),0===t?(d.isFirstStep(this)&&(this.diveCounter=f.getRandomInt(120,300)),Le(e,this,a),3===this.arg0&&d.isGreaterStep(this,this.diveCounter)&&this.setNerve(1)):1===t&&(d.isFirstStep(this)&&f.startBck(this,"SwimDive"),f.isBckStopped(this)&&(f.startAction(this,"SwimWaitSurface"),this.setNerve(0)))}};t.PenguinRacer=class extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"Penguin"),f.connectToSceneNpc(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null),this.boundingSphereRadius=100;const s=t.npcDirector.getNPCItemData(this.name,0);this.equipment(t,s);const i=h.fallback(n.getJMapInfoArg7(a),0);f.startBrk(this,"ColorChange"),f.setBrkFrameAndStop(this,i),f.startAction(this,"RacerWait")}static requestArchives(e,t){e.modelCache.requestObjectData("Penguin"),ge(e,r.getObjectName(t),0)}};t.TicoComet=class extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a));const n=this.name;f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,n),f.connectToSceneNpc(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null),this.boundingSphereRadius=100;const s=t.npcDirector.getNPCItemData("TicoComet",0);this.equipment(t,s),f.startAction(this.goods0,"LeftRotate"),f.startAction(this.goods1,"RightRotate"),f.startBtk(this,"TicoComet"),f.startBva(this,"Small0"),f.startBrk(this,"Normal"),f.setBrkFrameAndStop(this,0),f.startAction(this,"Wait")}static requestArchives(e,t){super.requestArchives(e,t);ge(e,"TicoComet",0)}};class Ge extends c.NameObj{constructor(e){super(e,"CoinRotater"),this.coinRotateY=0,this.coinHiSpeedRotateY=0,this.coinInWaterRotateY=0,this.coinRotateMtx=s.mat4.create(),this.coinHiSpeedRotateMtx=s.mat4.create(),this.coinInWaterRotateMtx=s.mat4.create(),f.connectToSceneMapObjMovement(e,this)}movement(e,t){super.movement(e,t),this.coinRotateY+=8*r.getDeltaTimeFrames(t)*.01745,this.coinInWaterRotateY+=4*r.getDeltaTimeFrames(t)*.01745,this.coinHiSpeedRotateY+=16*r.getDeltaTimeFrames(t)*.01745,i.computeModelMatrixR(this.coinRotateMtx,0,this.coinRotateY,0),i.computeModelMatrixR(this.coinInWaterRotateMtx,0,this.coinInWaterRotateY,0),i.computeModelMatrixR(this.coinHiSpeedRotateMtx,0,this.coinHiSpeedRotateY,0)}}t.CoinRotater=Ge;class He extends u.LiveActor{constructor(e,t,a,r){if(super(e,t,r?"PurpleCoin":"Coin"),this.isPurpleCoin=r,this.isInWater=!1,this.useLocalGravity=!1,this.airBubble=null,f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,this.isPurpleCoin?"PurpleCoin":"Coin"),f.connectToSceneItemStrongLight(t,this),this.initLightCtrl(t),null!==a){n.getJMapInfoBool(h.fallback(n.getJMapInfoArg7(a),-1))&&(this.airBubble=fe(t,this,"AirBubble",s.vec3.fromValues(0,70,0)),f.startBck(this.airBubble,"Move")),this.useLocalGravity=n.getJMapInfoBool(h.fallback(n.getJMapInfoArg4(a),-1))}this.calcGravityFlag=!1,this.useLocalGravity?($(null,this.gravityVector,null,this),s.vec3.negate(this.gravityVector,this.gravityVector)):f.calcGravity(t,this)}initAfterPlacement(e){super.initAfterPlacement(e),this.isInWater=T.isInWater(e,this.translation)}calcAndSetBaseMtx(e,t){this.useLocalGravity?this.calcAndSetBaseMtxBase():(s.vec3.negate(k,this.gravityVector),f.makeMtxUpNoSupportPos(this.modelInstance.modelMatrix,k,this.translation)),e.create(56);const a=e.coinRotater,r=this.isInWater?a.coinInWaterRotateMtx:a.coinRotateMtx;s.mat4.mul(this.modelInstance.modelMatrix,this.modelInstance.modelMatrix,r)}}function je(e,t,a){return new He(e,t,a,!1)}function We(e,t,a){return new He(e,t,a,!0)}t.createCoin=je,t.createPurpleCoin=We,t.requestArchivesCoin=function(e,t){e.modelCache.requestObjectData("Coin"),n.getJMapInfoBool(h.fallback(n.getJMapInfoArg7(t),-1))&&e.modelCache.requestObjectData("AirBubble")},t.requestArchivesPurpleCoin=function(e,t){e.modelCache.requestObjectData("PurpleCoin"),n.getJMapInfoBool(h.fallback(n.getJMapInfoArg7(t),-1))&&e.modelCache.requestObjectData("AirBubble")};class Ze extends u.LiveActor{constructor(e,t,a){super(e,t,"QuestionCoin"),this.useLocalGravity=!1,this.mtx=s.mat4.create(),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"QuestionCoin"),f.startBpk(this,"QuestionCoin"),f.connectToSceneItemStrongLight(t,this),this.useLocalGravity=n.getJMapInfoBool(h.fallback(n.getJMapInfoArg2(a),-1)),u.makeMtxTRFromActor(this.mtx,this)}calcAndSetBaseMtx(e,t){e.create(56);const a=e.coinRotater.coinInWaterRotateMtx;s.mat4.mul(this.modelInstance.modelMatrix,this.mtx,a)}}t.QuestionCoin=Ze;class ze extends u.LiveActor{constructor(e,t,a,i){super(e,t,r.getObjectName(a)),this.isPurpleCoin=i,this.coinArray=[];const o=h.fallback(n.getJMapInfoArg0(a),0);for(let r=0;r<o;r++){this.isPurpleCoin?this.coinArray.push(We(e,t,a)):this.coinArray.push(je(e,t,a));const n=this.coinArray[r];s.vec3.set(n.scale,1,1,1)}this.initCoinArray(t,a),this.placementCoin(),f.connectToSceneMapObjMovement(t,this),this.makeActorDead(t)}setCoinTrans(e,t){s.vec3.copy(this.coinArray[e].translation,t)}}class Ke extends ze{initCoinArray(e,t){f.initDefaultPos(e,this,t),this.initRailRider(e,t)}placementCoin(){this.placementNormalRail()}placementNormalRail(){const e=this.coinArray.length,t=f.getRailTotalLength(this);let a;a=e<2?0:f.isLoopRail(this)?t/e:t/(e-1),f.moveCoordToStartPos(this),f.setRailCoordSpeed(this,a);for(let t=0;t<e;t++)f.getRailPos(k,this),this.setCoinTrans(t,k),f.moveRailRider(this)}}t.createRailCoin=function(e,t,a){return new Ke(e,t,a,!1)},t.createPurpleRailCoin=function(e,t,a){return new Ke(e,t,a,!0)};class Xe extends ze{initCoinArray(e,t){this.radius=h.fallback(n.getJMapInfoArg2(t),200),f.initDefaultPos(e,this,t)}placementCoin(){u.makeMtxTRFromActor(P,this),s.vec3.set(D,P[0],P[1],P[2]),s.vec3.set(I,P[8],P[9],P[10]);const e=this.coinArray.length;for(let t=0;t<e;t++){const a=t/e*6.283;s.vec3.set(k,0,0,0),s.vec3.scaleAndAdd(k,k,D,this.radius*Math.cos(a)),s.vec3.scaleAndAdd(k,k,I,this.radius*Math.sin(a)),s.vec3.add(k,k,this.translation),this.setCoinTrans(t,k)}}}t.createCircleCoinGroup=function(e,t,a){return new Xe(e,t,a,!1)},t.createPurpleCircleCoinGroup=function(e,t,a){return new Xe(e,t,a,!0)};class Ye extends u.LiveActor{constructor(e,t,a){super(e,t,"MiniRoutePoint"),this.initModelManagerWithAnm(t,"MiniRoutePoint"),s.vec3.copy(this.translation,a.position),f.tryStartAllAnim(this,"Open"),a.isPink?f.startBrk(this,"TicoBuild"):f.startBrk(this,"Normal"),a.isSmall&&s.vec3.set(this.scale,.5,1,.5),f.connectToSceneNoSilhouettedMapObj(t,this)}}t.MiniRoutePoint=Ye;class $e extends u.LiveActor{constructor(e,t,a,r){super(e,t,"MiniRouteGalaxy");const n=h.assertExists(a.getValueString("MiniatureName")),i=h.assertExists(a.getValueString("StageType")),o=h.assertExists(a.getValueNumber("ScaleMin")),l=s.vec3.fromValues(h.assertExists(a.getValueNumber("PosOffsetX")),h.assertExists(a.getValueNumber("PosOffsetY")),h.assertExists(a.getValueNumber("PosOffsetZ")));s.vec3.add(this.translation,r.position,l),s.vec3.set(this.scale,o,o,o),this.initModelManagerWithAnm(t,n),this.initEffectKeeper(t,null),"BossGalaxyLv3"===i?(this.rotateSpeed=0,this.rotation[1]=-.25*Math.PI):this.rotateSpeed=.0043625,f.connectToSceneNoSilhouettedMapObj(t,this),f.startAction(this,n),N(t,this,n)}calcAndSetBaseMtx(e,t){super.calcAndSetBaseMtx(e,t);const a=r.getTimeFrames(t)*this.rotateSpeed;s.mat4.rotateY(this.modelInstance.modelMatrix,this.modelInstance.modelMatrix,a)}}t.MiniRouteGalaxy=$e;class qe extends u.LiveActor{constructor(e,t,a,r){super(e,t,"MiniRoutePart");const n=a.getValueString("PartsTypeName");let i;if("WorldWarpPoint"===n)i="MiniWorldWarpPoint";else if("EarthenPipe"===n)i="MiniEarthenPipe";else if("StarCheckPoint"===n)i="MiniStarCheckPointMark";else if("TicoRouteCreator"===n)i="MiniTicoMasterMark";else{if("StarPieceMine"!==n)throw"whoops";i="MiniStarPieceMine"}this.initModelManagerWithAnm(t,i),"WorldWarpPoint"===n&&(this.modelInstance.modelData.shapeData[0].sortKeyBias=1),s.vec3.copy(this.translation,r.position),f.tryStartAllAnim(this,"Open"),r.isPink?f.startBrkIfExist(this,"TicoBuild"):f.startBrkIfExist(this,"Normal"),this.initEffectKeeper(t,null),f.connectToSceneNoSilhouettedMapObj(t,this)}}t.MiniRoutePart=qe;class Qe extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.isVisible=!0,f.initDefaultPos(t,this,a),null!==t.effectSystem&&(this.initEffectKeeper(t,this.name),N(t,this,this.name),f.connectToSceneMapObjMovement(t,this))}getClippingRadius(){return 500}getFarClipDistance(){return 50}getClippingCenterOffset(e){s.vec3.set(e,0,0,0)}isSyncClipping(){return!1}movement(e,t){super.movement(e,t),this.getClippingCenterOffset(k),s.vec3.add(k,this.translation,k);let a=this.visibleScenario&&this.visibleAlive;const r=t.camera;a&&(a=r.frustum.containsSphere(k,this.getClippingRadius())),this.isVisible!==a&&(this.isVisible=a,null!==this.effectKeeper&&this.effectKeeper.setDrawParticle(a),this.isSyncClipping()&&(a?N(e,this,this.name):Z(this)))}static requestArchives(e,t){}}t.SimpleEffectObj=Qe;t.EffectObjR500F50=class extends Qe{getClippingRadius(){return 500}};t.EffectObjR1000F50=class extends Qe{getClippingRadius(){return 1e3}};t.EffectObjR100F50SyncClipping=class extends Qe{getClippingRadius(){return 1e3}isSyncClipping(){return!0}};t.EffectObj10x10x10SyncClipping=class extends Qe{getClippingCenterOffset(e){s.vec3.set(e,0,580,0)}getClippingRadius(){return 1e3}isSyncClipping(){return!0}};t.EffectObj20x20x10SyncClipping=class extends Qe{getClippingCenterOffset(e){s.vec3.set(e,0,200,0)}getClippingRadius(){return 1e3}isSyncClipping(){return!0}};t.EffectObj50x50x10SyncClipping=class extends Qe{getClippingCenterOffset(e){s.vec3.set(e,0,200,0)}getClippingRadius(){return 2500}isSyncClipping(){return!0}};t.RandomEffectObj=class extends Qe{constructor(e,t,a){super(e,t,a),this.counter=-1,this.randBase=h.fallback(n.getJMapInfoArg0(a),600),this.randRange=h.fallback(n.getJMapInfoArg1(a),180),this.initNerve(0)}movement(e,t){super.movement(e,t),-1===this.counter&&(this.counter=this.randBase+(Math.random()*this.randRange*2-this.randRange)),this.getNerveStep()>=this.counter&&(N(e,this,this.name),this.counter=-1,this.spine.setNerve(0))}getClippingRadius(){return 400}};class Je extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"GCaptureTarget"),f.connectToSceneNoSilhouettedMapObjStrongLight(t,this),this.initEffectKeeper(t,null),f.startBck(this,"Wait"),f.startBrk(this,"Switch"),f.setBrkFrameAndStop(this,1),N(t,this,"TargetLight"),N(t,this,"TouchAble")}}t.GCaptureTarget=Je;class et extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.upVec=s.vec3.create(),this.randomPhase=0,f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"FountainBig"),f.connectToSceneMapObj(t,this),this.initEffectKeeper(t,null),q(this.upVec,this),s.vec3.scaleAndAdd(this.upVec,this.translation,this.upVec,300),K(this),f.startBtk(this,"FountainBig"),this.randomPhase=300*Math.random()|0,this.initNerve(0)}updateSpine(e,t,a){if(super.updateSpine(e,t,a),0===t){if(d.isGreaterStep(this,this.randomPhase))return void this.setNerve(1)}else if(1===t){if(d.isGreaterStep(this,120))return void this.setNerve(2)}else if(2===t){if(d.isFirstStep(this)&&N(e,this,"FountainBigSign"),d.isGreaterStep(this,80))return void this.setNerve(3)}else if(3===t){if(d.isFirstStep(this)&&j(e,this,"FountainBigSign"),d.isGreaterStep(this,30))return void this.setNerve(4)}else if(4===t){d.isFirstStep(this)&&(X(this),N(e,this,"FountainBig"));const t=d.calcNerveRate(this,20);if(t<=1&&(this.scale[1]=i.clamp(t,.01,1)),d.isGreaterStep(this,180))return j(e,this,"FountainBig"),void this.setNerve(5)}else if(5===t){const e=1-d.calcNerveRate(this,10);if(this.scale[1]=i.clamp(e,.01,1),d.isGreaterStep(this,10))return K(this),void this.setNerve(1)}}}t.FountainBig=et;class tt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),f.connectToSceneMapObjMovement(t,this),this.initEffectKeeper(t,r.getObjectName(a)),N(t,this,r.getObjectName(a))}static requestArchives(){}}t.Fountain=tt;class at extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),f.connectToSceneMapObjMovement(t,this),this.initEffectKeeper(t,r.getObjectName(a)),N(t,this,r.getObjectName(a))}static requestArchives(){}}t.PhantomTorch=at;t.AstroEffectObj=class extends Qe{};class rt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"AstroCountDownPlate"),f.connectToSceneMapObj(t,this),this.initEffectKeeper(t,null),N(t,this,"Light"),f.startBrk(this,"Green")}}t.AstroCountDownPlate=rt;t.Butler=class extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"Butler"),f.connectToSceneNpc(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null);n.getJMapInfoArg0(a);f.startAction(this,"Wait")}};t.Rosetta=class extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"Rosetta"),f.connectToSceneIndirectNpc(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null),f.startAction(this,"WaitA")}};class nt extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"Tico"),f.connectToSceneIndirectNpc(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null);const s=h.fallback(n.getJMapInfoArg0(a),-1);-1!==s&&(f.startBrk(this,"ColorChange"),f.setBrkFrameAndStop(this,s)),f.startAction(this,"Wait"),f.setBckFrameAtRandom(this)}static requestArchives(e,t){e.modelCache.requestObjectData("Tico")}}t.Tico=nt;t.TicoAstro=class extends nt{};class st extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.isSkybox=!0,f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,this.name),f.connectToSceneSky(t,this),f.tryStartAllAnim(this,this.name)}calcAnim(e,t){this.isSkybox&&J(this.translation,t.camera),super.calcAnim(e,t)}}t.Sky=st;class it extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,this.name),f.connectToSceneAir(t,this);let s=h.fallback(n.getJMapInfoArg0(a),-1);s<0&&(s=70);const i=100*s;this.distInThresholdSq=i*i;const o=100*(20+s);this.distOutThresholdSq=o*o,f.tryStartAllAnim(this,r.getObjectName(a)),this.initNerve(0)}isDrawing(){return!u.isDead(this)&&!Y(this)}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve(),r=re(this,t.camera);1===a?(!Y(this)&&f.isAnyAnimStopped(this,"Disappear")&&K(this),r<this.distInThresholdSq&&(X(this),f.tryStartAllAnim(this,"Appear"),this.setNerve(0))):0===a&&r>this.distOutThresholdSq&&(f.tryStartAllAnim(this,"Disappear"),this.setNerve(1))}}t.Air=it;class ot extends c.NameObj{constructor(e){super(e,"PriorDrawAirHolder"),this.airs=[]}add(e){this.airs.push(e)}isExistValidDrawAir(){for(let e=0;e<this.airs.length;e++)if(this.airs[e].isDrawing())return!0;return!1}}t.PriorDrawAirHolder=ot;t.PriorDrawAir=class extends it{constructor(e,t,a){super(e,t,a)}};class lt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.axisY=s.vec3.create(),this.initialTranslation=s.vec3.create(),this.initModelManagerWithAnm(t,this.name),f.connectToSceneMapObj(t,this),f.initDefaultPos(t,this,a),s.vec3.copy(this.initialTranslation,this.translation);h.fallback(n.getJMapInfoArg0(a),5);this.delay=h.fallback(n.getJMapInfoArg1(a),240),this.distance=h.fallback(n.getJMapInfoArg2(a),2e3),this.initNerve(0),this.initEffectKeeper(t,"ShootingStar"),this.calcAndSetBaseMtxBase(),q(this.axisY,this),f.startBpk(this,"ShootingStar")}movement(e,t){super.movement(e,t);this.rotation[1]=(this.rotation[1]+.1745*r.getDeltaTimeFrames(t))%6.283;const a=this.getCurrentNerve();if(0===a){d.isFirstStep(this)&&(s.vec3.scaleAndAdd(this.translation,this.initialTranslation,this.axisY,this.distance),X(this),N(e,this,"ShootingStarAppear"));const t=d.calcNerveRate(this,20);s.vec3.set(this.scale,t,t,t),d.isGreaterStep(this,20)&&this.setNerve(1)}else 1===a?(d.isFirstStep(this)&&(s.vec3.negate(this.velocity,this.axisY),s.vec3.scale(this.velocity,this.velocity,25),N(e,this,"ShootingStarBlur")),d.isGreaterStep(this,360)&&(this.setNerve(2),j(e,this,"ShootingStarBlur"))):2===a&&(d.isFirstStep(this)&&(K(this),N(e,this,"ShootingStarBreak"),s.vec3.set(this.velocity,0,0,0)),d.isGreaterStep(this,this.delay)&&this.setNerve(0))}}t.ShootingStar=lt;class ct extends we{constructor(e,t,a){const s=new ve,i=r.getObjectName(a),o=h.fallback(n.getJMapInfoArg0(a),-1);s.setupModelName(ct.getModelName(i,o)),s.setupConnectToScene(),s.setupEffect(i),"AstroRotateStepA"!==i&&"AstroRotateStepB"!==i&&"AstroDecoratePartsA"!==i||s.setupRotator(),super(e,t,a,s),f.tryStartAllAnim(this,"Open"),this.tryStartAllAnimAndEffect(t,"AliveWait"),null!==this.rotator&&this.startMapPartsFunctions(),this.setStateAlive(t)}tryStartAllAnimAndEffect(e,t){f.tryStartAllAnim(this,t),this.isObjectName("AstroDomeEntranceKitchen")&&N(e,this,"KitchenSmoke"),z(this,t)&&N(e,this,t)}setStateAlive(e){f.tryStartAllAnim(this,"Revival"),this.tryStartAllAnimAndEffect(e,"AliveWait"),f.tryStartAllAnim(this,"Open")}static requestArchives(e,t){const a=r.getObjectName(t),s=h.fallback(n.getJMapInfoArg0(t),-1);e.modelCache.requestObjectData(ct.getModelName(a,s))}static getModelName(e,t){if("AstroDomeEntrance"===e){return["AstroDomeEntranceObservatory","AstroDomeEntranceWell","AstroDomeEntranceKitchen","AstroDomeEntranceBedRoom","AstroDomeEntranceMachine","AstroDomeEntranceTower"][t-1]}if("AstroStarPlate"===e){return["AstroStarPlateObservatory","AstroStarPlateWell","AstroStarPlateKitchen","AstroStarPlateBedRoom","AstroStarPlateMachine","AstroStarPlateTower"][t-1]}return e}}t.AstroMapObj=ct;t.AstroCore=class extends we{constructor(e,t,a){const r=new ve;_e(r),super(e,t,a,r),f.tryStartAllAnim(this,"Revival4")}};t.UFOKinokoUnderConstruction=class extends we{constructor(e,t,a){const r=new ve;_e(r),Se(r,a),be(r,a),r.setupModelName("UFOKinokoLandingAstro"),super(e,t,a,r)}static requestArchives(e,t){e.modelCache.requestObjectData("UFOKinokoLandingAstro")}};class ht extends u.LiveActor{constructor(e,t,a,r){if(super(e,t,r),this.airBubble=null,f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,r),f.connectToSceneNoSilhouettedMapObjStrongLight(t,this),this.initEffectKeeper(t,null),f.tryStartAllAnim(this,"Wait"),null!==a){n.getJMapInfoBool(h.fallback(n.getJMapInfoArg7(a),-1))&&(this.airBubble=fe(t,this,"AirBubble"),f.tryStartAllAnim(this,"Move"))}}static requestArchives(e,t){super.requestArchives(e,t),n.getJMapInfoBool(h.fallback(n.getJMapInfoArg7(t),-1))&&e.modelCache.requestObjectData("AirBubble")}}t.BlueChip=class extends ht{constructor(e,t,a){super(e,t,a,"BlueChip")}};class dt extends ht{constructor(e,t,a){super(e,t,a,"YellowChip")}}t.YellowChip=dt;class ut extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),"CrystalCageS"===this.name?this.size=0:"CrystalCageM"===this.name?this.size=1:"CrystalCageL"===this.name&&(this.size=2),this.initModelManagerWithAnm(t,this.name),f.connectToSceneCrystal(t,this),2===this.size&&this.initEffectKeeper(t,null),2===this.size?this.makeActorAppeared(t):C.isExistStageSwitchSleep(a)?(f.useStageSwitchSleep(t,this,a),this.makeActorDead(t)):f.useStageSwitchReadAppear(t,this,a)?(f.syncStageSwitchAppear(t,this),this.makeActorDead(t)):this.makeActorAppeared(t)}}t.CrystalCage=ut;class mt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.effectScale=s.vec3.create(),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"LavaSteam"),this.initEffectKeeper(t,null),Be(this,"Sign",this.translation,this.rotation,this.effectScale),this.initNerve(0),f.connectToSceneNoSilhouettedMapObj(t,this)}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();if(0===a){if(d.isFirstStep(this)&&(N(e,this,"Sign"),s.vec3.set(this.effectScale,1,1,1)),d.isGreaterStep(this,82)){const e=le(.125*(90-this.getNerveStep()),.001,1,1);s.vec3.set(this.effectScale,e,e,e)}d.isGreaterStep(this,90)&&W(e,this,"Sign"),d.isGreaterStep(this,120)&&this.setNerve(1)}else 1===a&&(d.isFirstStep(this)&&N(e,this,"Steam"),d.isGreaterStep(this,90)&&(j(e,this,"Steam"),this.setNerve(0)))}}t.LavaSteam=mt;t.SignBoard=class extends Ce{constructor(e,t,a){super(e,t,r.getObjectName(a));const n=this.name;f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,n),f.connectToSceneNpc(t,this)}};class pt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"WoodBox"),f.connectToSceneMapObjStrongLight(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null)}}t.WoodBox=pt;class ft extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"MiniSurprisedGalaxy"),f.connectToSceneMapObj(t,this),f.startAction(this,"MiniSurprisedGalaxy")}static requestArchives(e,t){e.modelCache.requestObjectData("MiniSurprisedGalaxy")}}t.SurprisedGalaxy=ft;class At extends u.LiveActor{constructor(e,t,a,n){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"SuperSpinDriver"),f.connectToSceneNoSilhouettedMapObjStrongLight(t,this),this.initColor(n),f.startBck(this,"Wait")}static requestArchives(e,t){e.modelCache.requestObjectData("SuperSpinDriver")}initColor(e){f.startBtp(this,"SuperSpinDriver"),f.setBtpFrameAndStop(this,e),0===e?f.startBrk(this,"Yellow"):1===e?f.startBrk(this,"Green"):f.startBrk(this,"Pink")}}t.requestArchivesSuperSpinDriver=function(e,t){At.requestArchives(e,t)},t.createSuperSpinDriverYellow=function(e,t,a){return new At(e,t,a,0)},t.createSuperSpinDriverGreen=function(e,t,a){return new At(e,t,a,1)},t.createSuperSpinDriverPink=function(e,t,a){return new At(e,t,a,2)};class gt{constructor(e,t){this.frequency=e,this.amplitude=t,this.theta=6.283*Math.random()}update(e){this.theta+=6.283/this.frequency*e,this.theta=this.theta%6.283}getCurrentValue(){return this.amplitude*Math.sin(this.theta)}}t.OceanWaveFloater=class extends we{constructor(e,t,a){const r=new ve;let n,i;if(r.setupDefaultPos(),r.setupConnectToScene(),r.setupEffect(null),super(e,t,a,r),"OceanPierFloaterA"===this.name)n=300,i=30,this.rippleStopThreshold=140,this.rippleStartThreshold=120;else{if("OceanHexagonFloater"!==this.name)throw"whoops";n=330,i=50,this.rippleStopThreshold=150,this.rippleStartThreshold=100}this.waveForce=new gt(n,i),Be(this,"Ripple",this.translation,null,null),this.upVec=s.vec3.create(),q(this.upVec,this),s.vec3.negate(this.gravityVector,this.upVec),this.isRippling=!1}getCurrentSinkDepth(){return s.mat4.getTranslation(k,this.getBaseMtx()),s.vec3.subtract(k,this.translation,k),s.vec3.length(k)*Math.sign(s.vec3.dot(k,this.gravityVector))}calcAndSetBaseMtx(e,t){super.calcAndSetBaseMtx(e,t),s.vec3.scale(k,this.gravityVector,this.waveForce.getCurrentValue()),s.mat4.translate(this.modelInstance.modelMatrix,this.modelInstance.modelMatrix,k)}movement(e,t){super.movement(e,t),this.waveForce.update(r.getDeltaTimeFrames(t));const a=this.getCurrentSinkDepth();a<=this.rippleStopThreshold||!this.isRippling?a<this.rippleStartThreshold&&!this.isRippling&&(N(e,this,"Ripple"),this.isRippling=!0):(j(e,this,"Ripple"),this.isRippling=!1)}};class _t extends u.LiveActor{constructor(e,t,a,r){super(e,t,r),this.fishGroup=a,this.followPointPos=s.vec3.create(),this.offset=s.vec3.create(),this.direction=s.vec3.create(),this.counter=0,s.vec3.set(this.offset,f.getRandomFloat(-150,150),f.getRandomFloat(-150,150),f.getRandomFloat(-150,150)),this.approachThreshold=f.getRandomFloat(100,500),this.updateFollowPointPos(),s.vec3.copy(this.translation,this.followPointPos),f.getRailDirection(this.direction,this.fishGroup),this.initModelManagerWithAnm(t,r),f.startBck(this,"Swim"),this.initNerve(1),f.connectToSceneEnvironment(t,this)}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();0===a?(d.isFirstStep(this)&&(this.counter=0),--this.counter,this.counter<1&&(s.vec3.sub(k,this.followPointPos,this.translation),s.vec3.normalize(k,k),s.vec3.dot(k,this.direction)<=.9?(s.vec3.lerp(this.direction,this.direction,k,.8),i.isNearZeroVec3(this.direction,.01)?s.vec3.copy(this.direction,k):s.vec3.normalize(this.direction,this.direction)):s.vec3.copy(this.direction,k),s.vec3.scaleAndAdd(this.velocity,this.velocity,this.direction,5),this.counter=f.getRandomInt(5,30)),s.vec3.squaredDistance(this.followPointPos,this.translation)<this.approachThreshold*this.approachThreshold&&this.setNerve(1)):1===a&&(d.isFirstStep(this)&&(this.counter=0),--this.counter,this.counter<1&&(s.vec3.add(this.velocity,this.velocity,this.direction),this.counter=f.getRandomInt(60,180)),s.vec3.squaredDistance(this.followPointPos,this.translation)>this.approachThreshold*this.approachThreshold&&this.setNerve(0)),s.vec3.scale(this.velocity,this.velocity,.95),f.setBckRate(this,.2*s.vec3.length(this.velocity)),i.isNearZeroVec3(this.direction,.001)&&(i.isNearZeroVec3(this.velocity,.001)?s.vec3.set(this.direction,1,0,0):s.vec3.copy(this.direction,this.velocity)),this.updateFollowPointPos()}calcAndSetBaseMtx(e,t){f.makeMtxFrontUpPos(this.modelInstance.modelMatrix,this.direction,this.fishGroup.upVec,this.translation)}updateFollowPointPos(){f.getRailPos(this.followPointPos,this.fishGroup),s.vec3.add(this.followPointPos,this.followPointPos,this.offset)}}class St extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.railSpeed=5,this.fish=[],this.upVec=s.vec3.create();const i=h.fallback(n.getJMapInfoArg0(a),10);f.initDefaultPos(t,this,a),$(null,this.upVec,null,this),this.initRailRider(t,a),f.moveCoordAndTransToNearestRailPos(this);const o=St.getArchiveName(a);for(let a=0;a<i;a++)this.fish.push(new _t(e,t,this,o));f.connectToSceneEnemyMovement(t,this)}movement(e,t){super.movement(e,t),s.vec3.negate(this.upVec,this.gravityVector),f.moveCoordAndFollowTrans(this,this.railSpeed*r.getDeltaTimeFrames(t))}static getArchiveName(e){const t=r.getObjectName(e);if("FishGroupA"===t)return"FishA";if("FishGroupB"===t)return"FishB";if("FishGroupC"===t)return"FishC";if("FishGroupD"===t)return"FishD";if("FishGroupE"===t)return"FishE";if("FishGroupF"===t)return"FishF";throw"whoops"}static requestArchives(e,t){e.modelCache.requestObjectData(St.getArchiveName(t))}}t.FishGroup=St;class bt extends u.LiveActor{constructor(e,t,a,n){super(e,t,r.getObjectName(n)),this.seaGullGroup=a,this.axisX=s.vec3.create(),this.axisY=s.vec3.create(),this.axisZ=s.vec3.create(),this.upVec=s.vec3.create(),this.bankRotation=0,this.hoverStep=0,this.flyUpCounter=0,this.maintainHeightCounter=0,this.calcGravityFlag=!0,f.initDefaultPos(t,this,n),$(this.axisX,this.axisY,this.axisZ,this),s.vec3.copy(this.upVec,this.axisY),this.initModelManagerWithAnm(t,"SeaGull"),f.startBck(this,"Fly"),f.connectToSceneEnvironment(t,this);const i=f.getRailTotalLength(this.seaGullGroup),o=f.getRandomFloat(1,i-1);this.chasePointIndex=o/500|0,f.calcRailPosAtCoord(this.translation,this.seaGullGroup,o),this.direction=Math.random()>=.5,this.updatePosCounter=f.getRandomInt(0,180),this.chasePointIndex=this.seaGullGroup.updatePosInfoIndex(this.chasePointIndex,this.direction),s.vec3.scale(D,this.axisX,f.getRandomFloat(-1,1)),s.vec3.scale(I,this.axisZ,f.getRandomFloat(-1,1)),s.vec3.add(this.axisZ,D,I),s.vec3.normalize(this.axisZ,this.axisZ),this.initNerve(0)}updateHover(){if(Math.abs(this.bankRotation)>.01&&(s.vec3.negate(this.upVec,this.gravityVector),this.bankRotation=i.clampRange(this.bankRotation,30),s.mat4.fromRotation(P,.01745*this.bankRotation,this.axisZ),s.vec3.transformMat4(this.axisY,this.upVec,P),s.mat4.fromRotation(P,-1745e-7*this.bankRotation,this.upVec),s.vec3.transformMat4(this.axisZ,this.axisZ,P)),s.vec3.scaleAndAdd(this.velocity,this.velocity,this.axisZ,.05),this.flyUpCounter<1){this.velocity[1]-=.005;const e=this.seaGullGroup.points[this.chasePointIndex];s.vec3.sub(k,e,this.translation);const t=s.vec3.dot(k,this.upVec);t>=500?(--this.maintainHeightCounter,(t>500||this.maintainHeightCounter<1)&&(this.flyUpCounter=f.getRandomInt(30,180))):this.maintainHeightCounter=300}else s.vec3.scaleAndAdd(this.velocity,this.velocity,this.axisY,.04),--this.flyUpCounter,this.flyUpCounter<1&&(this.maintainHeightCounter=f.getRandomInt(60,300))}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();if(0===a){if(d.isFirstStep(this)&&(this.hoverStep=f.getRandomInt(0,60)),this.bankRotation*=.995*r.getDeltaTimeFrames(t),d.isGreaterStep(this,this.hoverStep)){const e=this.seaGullGroup.points[this.chasePointIndex];if(s.vec3.subtract(k,e,this.translation),s.vec3.squaredLength(k)>500){s.vec3.dot(this.axisX,k)<=0?this.setNerve(2):this.setNerve(1)}}}else 1===a?(d.isFirstStep(this)&&(this.hoverStep=f.getRandomInt(60,120)),this.bankRotation-=.1*r.getDeltaTimeFrames(t),d.isGreaterStep(this,this.hoverStep)&&this.setNerve(0)):2===a&&(d.isFirstStep(this)&&(this.hoverStep=f.getRandomInt(60,120)),this.bankRotation+=.1*r.getDeltaTimeFrames(t),d.isGreaterStep(this,this.hoverStep)&&this.setNerve(0));this.updateHover(),s.vec3.squaredLength(this.velocity)>100&&i.normToLength(this.velocity,10),s.vec3.cross(this.axisX,this.axisY,this.axisZ),s.vec3.normalize(this.axisX,this.axisX),s.vec3.cross(this.axisY,this.axisZ,this.axisX),s.vec3.normalize(this.axisY,this.axisY),--this.updatePosCounter,this.updatePosCounter<1&&(this.chasePointIndex=this.seaGullGroup.updatePosInfoIndex(this.chasePointIndex,this.direction),this.updatePosCounter=180)}calcAndSetBaseMtx(e,t){f.setMtxAxisXYZ(this.modelInstance.modelMatrix,this.axisX,this.axisY,this.axisZ),f.setTrans(this.modelInstance.modelMatrix,this.translation)}}class vt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.seaGulls=[],this.points=[];const i=h.fallback(n.getJMapInfoArg0(a),10);this.initRailRider(t,a),f.getRailPos(this.translation,this);const o=f.getRailTotalLength(this),l=1+(o/500|0),c=o/l;for(let e=0;e<l;e++){const t=s.vec3.create();f.calcRailPosAtCoord(t,this,c*e),this.points.push(t)}for(let r=0;r<i;r++)this.seaGulls.push(new bt(e,t,this,a))}updatePosInfoIndex(e,t){return de(e+(t?-1:1),this.points.length)}static requestArchives(e,t){e.modelCache.requestObjectData("SeaGull")}}t.SeaGullGroup=vt;class wt extends u.LiveActor{constructor(e,t,a,r,n){super(e,t,"CoconutTreeLeaf"),this.leafGroup=a,this.jointMtx=r,this.treeAxisZ=n,this.axisX=s.vec3.create(),this.axisY=s.vec3.create(),this.axisZ=s.vec3.create(),this.upVec=s.vec3.create(),this.currFrontChase=s.vec3.create(),this.origFrontChase=s.vec3.create(),this.accelCounter=0,this.waitCounter=0,this.accel=s.vec3.create(),this.initHitSensor(),f.addBodyMessageSensorMapObj(t,this),f.calcMtxAxis(this.axisX,this.axisY,this.axisZ,this.jointMtx),s.vec3.copy(this.upVec,this.axisY),i.getMatrixTranslation(this.translation,this.jointMtx),s.vec3.scaleAndAdd(this.origFrontChase,this.translation,this.axisZ,100),s.vec3.copy(this.currFrontChase,this.origFrontChase)}getBaseMtx(){return this.jointMtx}update(e,t,a){let r,n,i;r=.005,n=.99,i=.001,this.accelCounter<1?(--this.waitCounter,this.waitCounter<1&&(s.vec3.scale(this.accel,this.treeAxisZ,e),s.vec3.scaleAndAdd(this.accel,this.accel,this.upVec,t*f.getRandomFloat(-1,1)),this.accelCounter=f.getRandomFloat(10,30))):(s.vec3.add(this.velocity,this.velocity,this.accel),--this.accelCounter,this.accelCounter<1&&(this.waitCounter=f.getRandomInt(15,150))),s.vec3.scaleAndAdd(this.velocity,this.velocity,this.upVec,-r),s.vec3.sub(k,this.origFrontChase,this.currFrontChase);const o=-s.vec3.dot(k,this.treeAxisZ);s.vec3.scaleAndAdd(this.velocity,this.velocity,k,i),s.vec3.scale(this.velocity,this.velocity,n),s.vec3.scaleAndAdd(this.currFrontChase,this.currFrontChase,this.velocity,a),s.vec3.sub(this.axisZ,this.currFrontChase,this.translation),s.vec3.normalize(this.axisZ,this.axisZ),s.vec3.scaleAndAdd(k,this.upVec,this.treeAxisZ,Math.max(0,.01*o)),s.vec3.cross(this.axisX,k,this.axisZ),s.vec3.normalize(this.axisX,this.axisX),s.vec3.cross(this.axisY,this.axisZ,this.axisX),s.vec3.normalize(this.axisY,this.axisY),f.setMtxAxisXYZ(this.jointMtx,this.axisX,this.axisY,this.axisZ)}}class xt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.leaves=[],this.axisZ=s.vec3.fromValues(0,0,1),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"CoconutTreeLeaf"),f.connectToSceneMapObjNoCalcAnim(t,this);for(let a=1;a<se(this);a++){const r=ie(this,a);this.leaves.push(new wt(e,t,this,r,this.axisZ))}}movement(e,t){super.movement(e,t);const a=ne(this,t.camera);let n=0,s=0;a>5e3?(n=.05,s=.03):a>3e3?(n=.03,s=.01):(n=.02,s=.005);const i=r.getDeltaTimeFrames(t);for(let e=0;e<this.leaves.length;e++)this.leaves[e].update(n,s,i)}}t.CoconutTreeLeafGroup=xt;class Tt extends u.LiveActor{constructor(e,t,a){super(e,t,"AirBubble"),this.lifetime=180,this.spawnLocation=s.vec3.create(),this.accel=s.vec3.create(),f.initDefaultPos(t,this,a),s.vec3.copy(this.spawnLocation,this.translation),this.initModelManagerWithAnm(t,"AirBubble"),f.connectToSceneItem(t,this),this.initEffectKeeper(t,null),this.initNerve(0),f.startBck(this,"Move")}appearMove(e,t,a){s.vec3.copy(this.translation,t),this.makeActorAppeared(e),X(this),this.setNerve(1),a<=0&&(a=180),this.lifetime=a}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();var r,n;0===a||(1===a?(d.isFirstStep(this)&&(s.vec3.set(this.gravityVector,0,-1,0),s.vec3.negate(k,this.gravityVector),s.vec3.scale(this.velocity,k,7)),s.mat4.fromRotation(P,.026175,this.gravityVector),s.vec3.transformMat4(this.accel,this.accel,P),s.vec3.scaleAndAdd(this.accel,this.accel,this.gravityVector,-s.vec3.dot(this.gravityVector,this.accel)),i.isNearZeroVec3(this.accel,.001)&&(r=this.accel,n=1,s.vec3.set(r,f.getRandomFloat(-n,n),f.getRandomFloat(-n,n),f.getRandomFloat(-n,n))),s.vec3.normalize(this.accel,this.accel),s.vec3.scaleAndAdd(this.velocity,this.velocity,this.accel,.1),s.vec3.scaleAndAdd(this.velocity,this.velocity,this.gravityVector,-.3),s.vec3.scale(this.velocity,this.velocity,.85),d.isGreaterStep(this,this.lifetime)&&(K(this),N(e,this,"RecoveryBubbleBreak"),this.setNerve(2))):2===a&&d.isGreaterStep(this,90)&&this.makeActorDead(e))}}t.AirBubble=Tt;class yt extends u.LiveActorGroup{constructor(e){super(e,"AirBubbleHolder",64);for(let t=0;t<32;t++){const t=new Tt(u.dynamicSpawnZoneAndLayer,e,null);t.makeActorDead(e),this.registerActor(t)}}appearAirBubble(e,t,a){const r=this.getDeadActor();null!==r&&r.appearMove(e,t,a)}static requestArchives(e,t){e.modelCache.requestObjectData("AirBubble")}}t.AirBubbleHolder=yt;class Ct extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),r.createSceneObj(t,57),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"AirBubbleGenerator"),f.connectToSceneNoSilhouettedMapObj(t,this),this.initEffectKeeper(t,null),this.initNerve(0),this.delay=h.fallback(n.getJMapInfoArg0(a),180),this.lifetime=h.fallback(n.getJMapInfoArg1(a),-1)}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();0===a?d.isGreaterStep(this,this.delay)&&this.setNerve(1):1===a&&(d.isFirstStep(this)&&f.startBck(this,"Generate"),d.isGreaterStep(this,6)&&($(null,k,null,this),s.vec3.scaleAndAdd(k,this.translation,k,120),e.airBubbleHolder.appearAirBubble(e,k,this.lifetime),this.setNerve(0)))}static requestArchives(e,t){super.requestArchives(e,t),yt.requestArchives(e,t)}}t.AirBubbleGenerator=Ct;class Mt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.type=Mt.getBoxType(a),1===this.type?this.initModelManagerWithAnm(t,"TreasureBoxCracked"):2===this.type?this.initModelManagerWithAnm(t,"TreasureBoxGold"):this.initModelManagerWithAnm(t,"TreasureBox"),f.connectToSceneMapObjStrongLight(t,this),this.initEffectKeeper(t,null),2===h.fallback(n.getJMapInfoArg2(a),0)?this.initNerve(1):this.initNerve(0)}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();0===a&&(1===this.type?(f.startBrk(this,"Wait"),N(e,this,"Light")):2===this.type&&N(e,this,"Gold"))}static getBoxType(e){const t=r.getObjectName(e);return t.includes("TreasureBoxCracked")?1:t.includes("TreasureBoxGold")?2:0}static requestArchives(e,t){const a=r.getObjectName(t);a.includes("TreasureBoxCracked")?e.modelCache.requestObjectData("TreasureBoxCracked"):a.includes("TreasureBoxGold")?e.modelCache.requestObjectData("TreasureBoxGold"):e.modelCache.requestObjectData("TreasureBox")}}t.TreasureBoxCracked=Mt;class Ut extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.direction=s.vec3.create(),this.talkingActor=null,f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"Tico"),f.connectToSceneNpc(t,this),this.initHitSensor(),f.addHitSensorNpc(t,this,"body",8,50,s.vec3.fromValues(0,50,0)),this.hitSensorKeeper.validateBySystem(),this.initLightCtrl(t),this.initEffectKeeper(t,null),this.initRailRider(t,a),f.moveCoordAndTransToNearestRailPos(this),f.getRailDirection(this.direction,this);const i=h.fallback(n.getJMapInfoArg0(a),0);f.startBrk(this,"ColorChange"),f.setBrkFrameAndStop(this,i),0===f.getRandomInt(0,2)?this.initNerve(0):this.initNerve(4)}attackSensor(e,t,a){if(A.isSensorPlayer(a));else if(A.isSensorNpc(a)){const r=this.getCurrentNerve();if(6!==r&&7!==r&&8!==r&&9!==r)if(f.sendArbitraryMsg(e,206,a,t))this.talkingActor=a.actor,this.setNerve(6);else{if(f.isExistRail(a.actor)&&f.isRailGoingToEnd(this)===f.isRailGoingToEnd(a.actor))return;this.setNerve(8)}}}isSameRailActor(e){return!!f.isExistRail(e)&&(s.vec3.equals(f.getRailPointPosStart(this),f.getRailPointPosStart(e))&&s.vec3.equals(f.getRailPointPosEnd(this),f.getRailPointPosEnd(e)))}receiveMessage(e,t,a,r){if(206===t){const e=this.getCurrentNerve();if(6!==e&&7!==e&&8!==e&&9!==e&&this.isSameRailActor(r.actor)){if(0!==f.getRandomInt(0,2)){if(f.calcDistanceVertical(this,r.actor.translation)<=30)return this.talkingActor=r.actor,this.setNerve(6),!0}}return!1}return super.receiveMessage(e,t,a,r)}calcAndSetBaseMtx(e,t){Q(this.modelInstance.modelMatrix,this,this.gravityVector,this.direction)}isGreaterEqualStepAndRandom(e){return!!d.isGreaterStep(this,e+300)||!(!d.isGreaterStep(this,e)||0!==f.getRandomInt(0,300))}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();if(0===a)d.isFirstStep(this)&&f.startBck(this,"Turn"),this.isGreaterEqualStepAndRandom(60)&&this.setNerve(1);else if(1===a){let e;if(d.isFirstStep(this)&&f.tryStartBck(this,"Turn"),q(k,this),e=d.isLessStep(this,40)?1.2:d.isLessStep(this,120)?-1.2:d.isLessStep(this,160)?1.2:0,e*=r.getDeltaTimeFrames(t),function(e,t,a,r=P){const n=.01745*a;s.mat4.fromRotation(r,n,t),s.vec3.transformMat4(e,e,r)}(this.direction,k,e),d.isGreaterStep(this,160)){0===f.getRandomInt(0,2)?this.setNerve(2):this.setNerve(3)}}else if(3===a||2===a){d.isFirstStep(this)&&(f.startBck(this,"Spin"),2===a&&f.reverseRailDirection(this));const e=f.getBckFrameMax(this),t=d.calcNerveRate(this,e);f.getRailDirection(D,this),s.vec3.negate(I,D),s.vec3.lerp(this.direction,I,D,t),f.isBckStopped(this)&&this.setNerve(4)}else if(4===a){d.isFirstStep(this)&&f.tryStartBck(this,"Wait");const e=r.getDeltaTimeFrames(t)*d.calcNerveValue(this,0,200,15);f.moveCoordAndFollowTrans(this,e),f.getRailDirection(this.direction,this),this.isGreaterEqualStepAndRandom(500)&&this.setNerve(5)}else if(5===a){d.isFirstStep(this)&&f.startBck(this,"Spin");const e=f.getBckFrameMax(this),a=r.getDeltaTimeFrames(t)*d.calcNerveValue(this,e,15,0);f.moveCoordAndFollowTrans(this,a),f.isBckStopped(this)&&this.setNerve(0)}else if(8===a)d.isFirstStep(this)&&f.tryStartBck(this,"Spin"),f.moveCoordAndFollowTrans(this,15*r.getDeltaTimeFrames(t)),f.getRailDirection(this.direction,this),f.isBckStopped(this)&&this.setNerve(4);else if(6===a){s.vec3.sub(D,this.talkingActor.translation,this.translation),s.vec3.normalize(D,D),d.isFirstStep(this)&&(f.startBck(this,"Spin"),f.getRailDirection(I,this),s.vec3.dot(D,I)>0&&f.reverseRailDirection(this)),f.moveCoordAndFollowTrans(this,2*r.getDeltaTimeFrames(t));const e=f.getBckFrameMax(this),a=d.calcNerveRate(this,e);f.getRailDirection(I,this),s.vec3.lerp(this.direction,I,D,a),f.isBckStopped(this)&&this.setNerve(7)}else if(7===a)d.isFirstStep(this)&&f.startBck(this,"Talk"),f.isBckPlaying(this,"Reaction")||0!==f.getRandomInt(0,60)||f.startBckWithInterpole(this,"Reaction",5),f.isBckOneTimeAndStopped(this)&&f.startBck(this,"Talk"),d.isGreaterStep(this,320)&&this.setNerve(9);else if(9===a){d.isFirstStep(this)&&(f.startBck(this,"CallBack"),f.getRailDirection(D,this),s.vec3.dot(this.direction,D)>0&&f.reverseRailDirection(this)),f.moveCoordAndFollowTrans(this,1.5*r.getDeltaTimeFrames(t));const e=f.getBckFrameMax(this);d.isGreaterStep(this,e)&&(this.talkingActor=null,this.setNerve(3))}}isStopped(e){return 0===this.getCurrentNerve()&&d.isGreaterStep(this,e)}static requestArchives(e,t){e.modelCache.requestObjectData("Tico")}}t.TicoRail=Ut;class kt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),f.connectToSceneMapObjMovement(t,this),this.initEffectKeeper(t,r.getObjectName(a)),N(t,this,"Steam")}static requestArchives(e,t){}}t.SubmarineSteam=kt;class Dt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.rippleTranslation=s.vec3.create(),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"PalmIsland"),f.connectToSceneMapObj(t,this),this.initEffectKeeper(t,null),this.floatDelay=f.getRandomInt(0,60),this.initNerve(0),q(this.gravityVector,this),s.vec3.negate(this.gravityVector,this.gravityVector)}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();if(0===a)d.isGreaterStep(this,this.floatDelay)&&this.setNerve(1);else if(1===a){d.isFirstStep(this)&&(s.vec3.copy(this.rippleTranslation,this.translation),N(e,this,"Ripple"),Be(this,"Ripple",this.rippleTranslation,null,null));const t=.01745*(90+1.44*this.getNerveStep()),a=1.44*Math.sin(t);s.vec3.scale(this.velocity,this.gravityVector,a)}}}t.PalmIsland=Dt;const It=[o.colorNewFromRGBA8(6605055),o.colorNewFromRGBA8(754920191),o.colorNewFromRGBA8(4282137855),o.colorNewFromRGBA8(3299213567),o.colorNewFromRGBA8(16711935),o.colorNewFromRGBA8(4278255615),o.colorNewFromRGBA8(4294902015),o.colorNewFromRGBA8(4294967295)];class Rt{constructor(e,t,a,r){this.points=a,this.color=r,this.ddraw=new g.TDDraw,this.testColor=f.loadBTIData(e,t,"TestColor.bti"),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1);const n=new S.GXMaterialBuilder("WarpPodPathDrawer");n.setChanCtrl(4,!1,1,1,0,0,2),n.setTexCoordGen(0,1,4,30),n.setTevOrder(0,0,0,7),n.setTevColorIn(0,2,12,9,15),n.setTevColorOp(0,0,0,0,!0,0),n.setTevAlphaIn(0,7,4,6,7),n.setTevAlphaOp(0,0,0,1,!0,0),n.setBlendMode(1,4,1),n.setZMode(!0,3,!1),n.setUsePnMtxIdx(!1),this.materialHelper=new l.GXMaterialHelperGfx(n.finish())}drawPathPart(e,t){this.ddraw.begin(152);for(let a=0;a<this.points.length-1;a++){s.vec3.sub(D,this.points[a+1],this.points[a]),te(I,e),f.vecKillElement(R,D,I),s.vec3.normalize(R,R),s.vec3.cross(D,R,I),t&&(s.vec3.normalize(D,D),s.vec3.cross(D,D,R)),i.normToLength(D,30);const r=Math.abs(a/this.points.length*2-1);s.vec3.add(R,this.points[a],D),this.ddraw.position3vec3(R),this.ddraw.texCoord2f32(13,0,r),s.vec3.sub(R,this.points[a],D),this.ddraw.position3vec3(R),this.ddraw.texCoord2f32(13,1,r)}this.ddraw.end()}drawPath(e){this.drawPathPart(e,!1),this.drawPathPart(e,!0)}draw(e,t,a){this.testColor.fillTextureMapping(M.m_TextureMapping[0]),o.colorCopy(M.u_Color[l.ColorKind.C0],this.color);const r=t.pushTemplateRenderInst(),n=r.allocateUniformBuffer(l.ub_MaterialParams,this.materialHelper.materialParamsBufferSize);this.materialHelper.fillMaterialParamsDataOnInst(r,n,M),r.setSamplerBindingsFromTextureMappings(M.m_TextureMapping),r.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),s.mat4.copy(U.u_PosMtx[0],a.camera.viewMatrix),l.fillPacketParamsData(r.mapUniformBufferF32(l.ub_PacketParams),r.getUniformBufferOffset(l.ub_PacketParams),U),this.materialHelper.setOnRenderInst(e,t.gfxRenderCache,r),this.ddraw.beginDraw(),this.drawPath(a.camera);const i=this.ddraw.endDraw(e,t);t.submitRenderInst(i),t.popTemplateRenderInst()}destroy(e){this.testColor.destroy(e),this.ddraw.destroy(e)}}class Bt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.pairedWarpPod=null,this.isPairPrimary=!1,this.warpPathPoints=null,this.pathDrawer=null,f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"WarpPod"),this.visible=0!==h.fallback(n.getJMapInfoArg1(a),1);n.getJMapInfoBool(h.fallback(n.getJMapInfoArg3(a),-1)),n.getJMapInfoBool(h.fallback(n.getJMapInfoArg4(a),-1));const s=h.fallback(n.getJMapInfoArg6(a),0);let i=It[s];void 0===i&&(i=It[0]),this.color=i,this.initEffectKeeper(t,null),this.visible&&(f.startBck(this,"Active"),f.startBrk(this,"Active"),f.setLoopMode(this,0));this.glowEffect(t),this.groupId=h.assertExists(n.getJMapInfoGroupId(a));const o=this.lookForPair(t);null!==o&&(this.initPair(t,o),o.initPair(t,this)),this.visible?f.connectToScene(t,this,34,5,8,24):f.connectToScene(t,this,34,-1,-1,-1)}initPair(e,t){var a,r;this.pairedWarpPod=t,this.isPairPrimary=(a=this.translation,r=this.pairedWarpPod.translation,(a[0]!==r[0]?a[0]-r[0]:a[1]!==r[1]?a[1]-r[1]:a[2]!==r[2]?a[2]-r[2]:0)<0),this.isPairPrimary&&this.initDraw(e)}initDraw(e){if(null===this.pairedWarpPod||!this.isPairPrimary)return;this.warpPathPoints=[];const t=s.vec3.create();s.vec3.sub(t,this.pairedWarpPod.translation,this.translation);const a=s.vec3.length(t),r=s.vec3.create();q(r,this);const n=s.vec3.create();s.vec3.negate(n,r);const o=s.vec3.create(),l=s.vec3.create();s.vec3.cross(o,t,n),s.vec3.normalize(o,o),s.vec3.cross(l,o,t),s.vec3.normalize(l,l);const c=s.vec3.create();s.vec3.scale(c,t,.5),s.vec3.add(c,this.translation,c);const h=.5*a,d=h/Math.sin(.785375);let u=d*d-h*h;if(u>=0){const e=1/Math.sqrt(u),t=u*e;u=-(t*e-3)*t*.5}const m=s.vec3.create(),p=s.vec3.create();s.vec3.scaleAndAdd(m,c,l,u),s.vec3.scale(p,l,-d);for(let e=0;e<60;e++){const t=s.vec3.create(),a=1-(e-30)/60,n=.5*(Math.sin(Math.PI*a)+1),l=i.lerp(-.785375,.785375,n);s.mat4.fromRotation(P,l,o),s.vec3.transformMat4(t,p,P),s.vec3.add(t,t,m),s.vec3.scaleAndAdd(t,t,r,200),this.warpPathPoints.push(t)}this.pathDrawer=new Rt(e,this.resourceHolder.arc,this.warpPathPoints,this.color)}lookForPair(e){for(let t=0;t<e.sceneNameObjListExecutor.nameObjExecuteInfos.length;t++){const a=e.sceneNameObjListExecutor.nameObjExecuteInfos[t].nameObj;if(a!==this&&a instanceof Bt){const e=a;if(e.groupId===this.groupId)return e}}return null}draw(e,t,a){super.draw(e,t,a),f.isValidDraw(this)&&null!==this.pathDrawer&&this.pathDrawer.draw(e.modelCache.device,t,a)}glowEffect(e){this.visible&&(N(e,this,"EndGlow"),H(this,"EndGlow",this.color))}destroy(e){super.destroy(e),null!==this.pathDrawer&&this.pathDrawer.destroy(e)}}t.WarpPod=Bt;class Pt extends c.NameObj{constructor(e){super(e,"WaterPlantDrawInit"),this.angle=0,this.swingSpeed=.03,this.swingWidth=20,this.swingPoints=h.nArray(64,()=>0),this.drawVec=s.vec3.create(),f.connectToScene(e,this,34,-1,-1,-1);const t=e.modelCache.getObjectData("WaterPlant");this.waterPlantA=f.loadBTIData(e,t,"WaterPlantA.bti"),this.waterPlantB=f.loadBTIData(e,t,"WaterPlantB.bti"),this.waterPlantC=f.loadBTIData(e,t,"WaterPlantC.bti"),this.waterPlantD=f.loadBTIData(e,t,"WaterPlantD.bti");const a=new S.GXMaterialBuilder("WaterPlant");a.setChanCtrl(4,!1,1,1,0,0,2),a.setTexCoordGen(0,1,4,60),a.setTevOrder(0,0,0,7),a.setTevColorIn(0,8,15,15,15),a.setTevColorOp(0,0,0,0,!0,0),a.setTevAlphaIn(0,4,7,7,7),a.setTevAlphaOp(0,0,0,0,!0,0),a.setBlendMode(1,4,5,5),a.setAlphaCompare(4,50,1,4,50),a.setZMode(!0,3,!0),a.setCullMode(0),a.setUsePnMtxIdx(!1),this.materialHelper=new l.GXMaterialHelperGfx(a.finish()),this.updateSwingPos()}movement(e,t){super.movement(e,t),this.updateSwingPos(),this.angle+=this.swingSpeed*r.getDeltaTimeFrames(t);const a=t.camera.worldMatrix;s.vec3.set(this.drawVec,a[0],a[1],a[2])}updateSwingPos(){let e=this.angle;for(let t=0;t<this.swingPoints.length;t++)this.swingPoints[t]=Math.sin(e)*this.swingWidth,e+=.2}loadTex(e,t){if(0===t)this.waterPlantA.fillTextureMapping(e);else if(1===t)this.waterPlantB.fillTextureMapping(e);else if(2===t)this.waterPlantC.fillTextureMapping(e);else{if(3!==t)throw"whoops";this.waterPlantD.fillTextureMapping(e)}}destroy(e){super.destroy(e),this.waterPlantA.destroy(e),this.waterPlantB.destroy(e),this.waterPlantC.destroy(e),this.waterPlantD.destroy(e)}}t.WaterPlantDrawInit=Pt;class Et{constructor(){this.position=s.vec3.create(),this.axisZ=s.vec3.create(),this.height=0,this.swingPosIdx0=0,this.swingPosIdx1=0,this.swingPosIdx2=0}}const Ft=[150,200,300,250];class Vt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.plantData=[],this.ddraw=new g.TDDraw,t.create(99),f.connectToScene(t,this,34,-1,-1,27),f.initDefaultPos(t,this,a),this.plantCount=h.fallback(n.getJMapInfoArg0(a),22),this.radius=h.fallback(n.getJMapInfoArg1(a),500),this.plantType=h.fallback(n.getJMapInfoArg3(a),0),this.height=Ft[this.plantType],this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1)}initAfterPlacement(e){super.initAfterPlacement(e),i.computeModelMatrixR(P,0,.26175,0);const t=k;let a=0;s.vec3.set(t,0,0,1);for(let r=0;r<this.plantCount;r++){const r=new Et;for(let t=0;t<10;t++){const t=f.getRandomFloat(-this.radius,this.radius),a=f.getRandomFloat(-this.radius,this.radius);if(s.vec3.set(r.position,this.translation[0]+t,this.translation[1]+500,this.translation[2]+a),y.calcMapGround(e,r.position,r.position,1e3))break}s.vec3.copy(r.axisZ,t),r.height=f.getRandomFloat(this.height,2*this.height),r.swingPosIdx0=a+6,r.swingPosIdx1=a+3,r.swingPosIdx2=a,a=(a+60)%57,s.vec3.transformMat4(t,t,P),this.plantData.push(r)}}drawStrip(e,t,a,r,n){e.position3f32(t[0]-a,t[1],t[2]-r),e.texCoord2f32(13,0,n),e.position3f32(t[0]+a,t[1],t[2]+r),e.texCoord2f32(13,1,n)}draw(e,t,a){if(super.draw(e,t,a),!f.isValidDraw(this))return;const r=e.waterPlantDrawInit;this.ddraw.beginDraw();for(let e=0;e<this.plantData.length;e++){const t=this.plantData[e];s.vec3.scaleAndAdd(D,t.position,t.axisZ,r.swingPoints[t.swingPosIdx0]),s.vec3.scaleAndAdd(I,t.position,t.axisZ,r.swingPoints[t.swingPosIdx1]),s.vec3.scaleAndAdd(R,t.position,t.axisZ,r.swingPoints[t.swingPosIdx2]),D[1]+=.5*t.height,I[1]+=.8*t.height,R[1]+=1*t.height,this.ddraw.begin(152),this.ddraw.allocVertices(8);const a=20*r.drawVec[0],n=20*r.drawVec[2];this.drawStrip(this.ddraw,R,a,n,0),this.drawStrip(this.ddraw,I,a,n,.2),this.drawStrip(this.ddraw,D,a,n,.5),this.drawStrip(this.ddraw,t.position,a,n,1),this.ddraw.end()}const n=e.modelCache.device,i=this.ddraw.endDraw(n,t);r.loadTex(M.m_TextureMapping[0],this.plantType);const o=r.materialHelper,c=i.allocateUniformBuffer(l.ub_MaterialParams,o.materialParamsBufferSize);o.fillMaterialParamsDataOnInst(i,c,M),i.setSamplerBindingsFromTextureMappings(M.m_TextureMapping),i.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),s.mat4.copy(U.u_PosMtx[0],a.camera.viewMatrix),l.fillPacketParamsData(i.mapUniformBufferF32(l.ub_PacketParams),i.getUniformBufferOffset(l.ub_PacketParams),U),o.setOnRenderInst(n,t.gfxRenderCache,i),t.submitRenderInst(i)}destroy(e){super.destroy(e),this.ddraw.destroy(e)}}t.WaterPlant=Vt;class Ot extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.starPieces=[],this.isConnectedWithRail=!1,this.spawnOnRailPoints=!1,f.initDefaultPos(t,this,a);let s=6;s=h.fallback(n.getJMapInfoArg0(a),s),this.radius=h.fallback(n.getJMapInfoArg1(a),400);const i=h.fallback(n.getJMapInfoArg2(a),-1);p.isConnectedWithRail(a)&&(this.initRailRider(t,a),this.isConnectedWithRail=!0,1===i&&(s=f.getRailPointNum(this),this.spawnOnRailPoints=!0));for(let r=0;r<s;r++){const r=new De(e,t,null);f.initDefaultPos(t,r,a),this.starPieces.push(r)}this.placementAllPiece()}placementAllPiece(){this.isConnectedWithRail?this.spawnOnRailPoints?this.placementPieceOnRailPoint():this.placementPieceOnRail():this.placementPieceOnCircle()}placementPieceOnCircle(){if(1===this.starPieces.length)s.vec3.copy(this.starPieces[0].translation,this.translation);else{u.makeMtxTRFromActor(P,this),f.calcMtxAxis(D,null,I,P);for(let e=0;e<this.starPieces.length;e++){const t=this.starPieces[e],a=e/this.starPieces.length*6.283;s.vec3.scaleAndAdd(t.translation,t.translation,D,Math.cos(a)*this.radius),s.vec3.scaleAndAdd(t.translation,t.translation,I,Math.sin(a)*this.radius)}}}placementPieceOnRailPoint(){h.assert(this.starPieces.length===f.getRailPointNum(this));for(let e=0;e<this.starPieces.length;e++)f.calcRailPointPos(this.starPieces[e].translation,this,e)}placementPieceOnRail(){const e=f.getRailTotalLength(this);let t=0;if(this.starPieces.length>1){let a=this.starPieces.length;f.isLoopRail(this)||(a-=1),t=e/a}let a=0;for(let e=0;e<this.starPieces.length;e++)f.calcRailPosAtCoord(this.starPieces[e].translation,this,a),a+=t}static requestArchives(e,t){e.modelCache.requestObjectData("StarPiece")}}t.StarPieceGroup=Ot;const Nt=s.vec3.fromValues(0,100,50),Lt=s.vec3.fromValues(0,50,30);class Gt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"Shellfish"),f.connectToSceneMapObjStrongLight(t,this),this.initEffectKeeper(t,null),this.initItem(t),this.initNerve(0)}initItem(e){"ShellfishCoin"===this.name?this.initCoin(e):"ShellfishYellowChip"===this.name&&this.initYellowChip(e)}initCoin(e){this.item=new He(this.zoneAndLayer,e,null,!1);const t=this.getBaseMtx();s.vec3.transformMat4(this.item.translation,Lt,t)}initYellowChip(e){this.item=new dt(this.zoneAndLayer,e,null);const t=this.getBaseMtx();s.vec3.transformMat4(this.item.translation,Nt,t)}movement(e,t){super.movement(e,t);const a=this.getCurrentNerve();0===a?(d.isFirstStep(this)&&f.startBck(this,"Wait"),d.isFirstStep(this)&&this.setNerve(1)):1===a?(d.isFirstStep(this)&&f.startBck(this,"Open"),d.isGreaterStep(this,100)&&this.setNerve(2)):2===a?d.isGreaterStep(this,170)&&this.setNerve(3):3===a?(d.isFirstStep(this)&&f.startBck(this,"CloseSignal"),d.isGreaterStep(this,150)&&this.setNerve(4)):4===a&&(d.isFirstStep(this)&&f.startBck(this,"Close"),f.isBckStopped(this)&&this.setNerve(0))}static requestArchives(e,t){e.modelCache.requestObjectData("Shellfish")}}t.Shellfish=Gt;class Ht extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"PunchBox"),f.connectToSceneMapObjStrongLight(t,this),this.initEffectKeeper(t,null)}}t.PunchBox=Ht;class jt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.trainBodies=[],f.initDefaultPos(t,this,a),this.initRailRider(t,a),this.initModelManagerWithAnm(t,"ChooChooTrain"),f.connectToSceneCollisionMapObj(t,this),this.initEffectKeeper(t,null);const s=h.fallback(n.getJMapInfoArg0(a),3);this.speed=h.fallback(n.getJMapInfoArg1(a),5);for(let a=0;a<s;a++){const a=new xe(e,t,"ChooChooTrainBody","ChooChooTrainBody",null,-2,30,2);this.trainBodies.push(a)}f.moveCoordAndTransToNearestRailPos(this);const i=f.getRailCoord(this);f.reverseRailDirection(this);for(let e=0;e<this.trainBodies.length;e++)f.moveCoord(this,1080*this.scale[1]),f.moveTransToOtherActorRailPos(this.trainBodies[e],this),f.startBck(this.trainBodies[e],"Run");f.setRailCoord(this,i),f.startBck(this,"Run")}movement(e,t){super.movement(e,t),f.moveCoordAndFollowTrans(this,this.speed),f.getRailDirection(D,this);const a=Math.atan2(D[2],D[0]);this.rotation[1]=1.57075-a;const r=f.getRailCoord(this);f.reverseRailDirection(this);for(let e=0;e<this.trainBodies.length;e++){const t=this.trainBodies[e];f.moveCoord(this,1080*this.scale[1]),f.moveTransToOtherActorRailPos(t,this),f.getRailDirection(D,this);const a=Math.atan2(D[2],D[0]);t.rotation[1]=-a-1.57075}f.reverseRailDirection(this),f.setRailCoord(this,r)}static requestArchives(e,t){super.requestArchives(e,t),e.modelCache.requestObjectData("ChooChooTrainBody")}}t.ChooChooTrain=jt;class Wt{constructor(e){this.position=s.vec3.create(),this.accel=s.vec3.create(),this.axisX=s.vec3.fromValues(1,0,0),this.axisY=s.vec3.fromValues(0,1,0),this.axisZ=s.vec3.fromValues(0,0,1),s.vec3.copy(this.position,e)}addAccel(e){s.vec3.add(this.accel,this.accel,e)}restrict(e,t,a){s.vec3.add(D,this.position,this.accel),s.vec3.sub(D,D,e),null!==a&&s.vec3.sub(D,D,a);const r=s.vec3.squaredLength(D);s.vec3.normalize(I,D),s.vec3.negate(this.axisY,I),r>=t*t&&(s.vec3.scale(I,I,t),s.vec3.sub(D,D,I),s.vec3.sub(this.accel,this.accel,D))}updatePos(e){s.vec3.add(this.position,this.position,this.accel),s.vec3.scale(this.accel,this.accel,e)}updateAxis(e){s.vec3.cross(this.axisX,this.axisY,e),s.vec3.normalize(this.axisX,this.axisX),s.vec3.cross(this.axisZ,this.axisX,this.axisY),s.vec3.normalize(this.axisZ,this.axisZ)}updatePosAndAxis(e,t){this.updatePos(t),this.updateAxis(e)}}class Zt extends c.NameObj{constructor(e){super(e,"SwingRopeGroup");const t=e.modelCache.getObjectData("SwingRope");this.swingRope=f.loadBTIData(e,t,"SwingRope.bti");const a=new S.GXMaterialBuilder("SwingRope");a.setChanCtrl(4,!1,1,1,0,0,2),a.setTexCoordGen(0,0,4,60),a.setTevOrder(0,0,0,0),a.setTevColorIn(0,15,8,10,15),a.setTevColorOp(0,0,0,0,!0,0),a.setTevAlphaIn(0,4,7,7,7),a.setTevAlphaOp(0,0,0,0,!0,0),a.setBlendMode(1,4,5,5),a.setAlphaCompare(4,50,1,4,50),a.setZMode(!0,3,!0),a.setCullMode(0),a.setUsePnMtxIdx(!1),this.materialHelper=new l.GXMaterialHelperGfx(a.finish())}destroy(e){super.destroy(e),this.swingRope.destroy(e)}}t.SwingRopeGroup=Zt;const zt=o.colorNewFromRGBA8(4294967295),Kt=o.colorNewFromRGBA8(4294967295),Xt=o.colorNewFromRGBA8(4294967295);class Yt extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.pos=s.vec3.create(),this.ddraw=new g.TDDraw,this.swingRopePoints=[],t.create(71),f.connectToScene(t,this,41,-1,-1,0),f.initDefaultPos(t,this,a),s.vec3.copy(this.pos,this.translation),this.height=100*this.scale[1],this.initPoints(),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(11,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,11,1),this.ddraw.setVtxAttrFmt(0,13,1)}initPoints(){const e=this.height/50|0;for(let t=0;t<e;t++){s.vec3.scaleAndAdd(D,this.pos,this.gravityVector,50*(t+1));const e=new Wt(D);this.swingRopePoints.push(e)}}sendPoint(e,t,a,r,n,s,i,o){this.ddraw.position3f32(e[0]+t[0]*r+a[0]*n,e[1]+t[1]*r+a[1]*n,e[2]+t[2]*r+a[2]*n),this.ddraw.color4color(11,s),this.ddraw.texCoord2f32(13,i,o)}drawStop(e,t,a){this.ddraw.beginDraw(),this.ddraw.allocVertices(12);const r=this.height/50*.13,n=this.swingRopePoints[0];s.vec3.copy(D,this.pos),s.vec3.copy(I,this.pos),I[1]-=this.height,this.ddraw.begin(152),this.sendPoint(D,n.axisX,n.axisZ,-30,43,zt,0,0),this.sendPoint(D,n.axisX,n.axisZ,33,-43,Kt,1,0),this.sendPoint(I,n.axisX,n.axisZ,-30,43,zt,0,r),this.sendPoint(I,n.axisX,n.axisZ,33,-43,Kt,1,r),this.ddraw.end(),this.ddraw.begin(152),this.sendPoint(D,n.axisX,n.axisZ,-33,-43,Xt,0,0),this.sendPoint(D,n.axisX,n.axisZ,30,43,zt,1,0),this.sendPoint(I,n.axisX,n.axisZ,-33,-43,Xt,0,r),this.sendPoint(I,n.axisX,n.axisZ,30,43,zt,1,r),this.ddraw.end(),this.ddraw.begin(152),this.sendPoint(D,n.axisX,n.axisZ,43,-3,Kt,0,0),this.sendPoint(D,n.axisX,n.axisZ,-43,-3,Xt,1,0),this.sendPoint(I,n.axisX,n.axisZ,43,-3,Kt,0,r),this.sendPoint(I,n.axisX,n.axisZ,-43,-3,Xt,1,r),this.ddraw.end();const i=e.modelCache.device,o=this.ddraw.endDraw(i,t),c=e.swingRopeGroup;c.swingRope.fillTextureMapping(M.m_TextureMapping[0]);const h=c.materialHelper,d=o.allocateUniformBuffer(l.ub_MaterialParams,h.materialParamsBufferSize);h.fillMaterialParamsDataOnInst(o,d,M),o.setSamplerBindingsFromTextureMappings(M.m_TextureMapping),o.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),s.mat4.copy(U.u_PosMtx[0],a.camera.viewMatrix),l.fillPacketParamsData(o.mapUniformBufferF32(l.ub_PacketParams),o.getUniformBufferOffset(l.ub_PacketParams),U),h.setOnRenderInst(i,t.gfxRenderCache,o),t.submitRenderInst(o)}draw(e,t,a){super.draw(e,t,a),f.isValidDraw(this)&&this.drawStop(e,t,a)}destroy(e){super.destroy(e),this.ddraw.destroy(e)}}t.SwingRope=Yt;class $t extends c.NameObj{constructor(e){super(e,"TrapezeRopeDrawInit");const t=e.modelCache.getObjectData("Trapeze");this.trapezeRope=f.loadBTIData(e,t,"TrapezeRope.bti");const a=new S.GXMaterialBuilder("TrapezeRope");a.setChanCtrl(4,!1,1,1,0,0,2),a.setTexCoordGen(0,0,4,60),a.setTevOrder(0,0,0,0),a.setTevColorIn(0,15,8,10,15),a.setTevColorOp(0,0,0,0,!0,0),a.setTevAlphaIn(0,4,7,7,7),a.setTevAlphaOp(0,0,0,0,!0,0),a.setBlendMode(1,4,5,5),a.setAlphaCompare(4,50,1,4,50),a.setZMode(!0,3,!0),a.setCullMode(0),a.setUsePnMtxIdx(!1),this.materialHelper=new l.GXMaterialHelperGfx(a.finish())}destroy(e){super.destroy(e),this.trapezeRope.destroy(e)}}t.TrapezeRopeDrawInit=$t;const qt=o.colorNewFromRGBA8(4294967295),Qt=o.colorNewFromRGBA8(3031741695),Jt=o.colorNewFromRGBA8(1684301055);class ea extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.axisX=s.vec3.create(),this.axisY=s.vec3.create(),this.axisZ=s.vec3.create(),this.stickMtx=s.mat4.create(),this.ddraw=new g.TDDraw,t.create(74),f.connectToScene(t,this,41,-1,-1,6),f.initDefaultPos(t,this,a),u.makeMtxTRFromActor(P,this),f.calcMtxAxis(this.axisX,this.axisY,this.axisZ,P),this.height=100*this.scale[1],s.vec3.set(this.scale,1,1,1),s.vec3.set(k,this.translation[0],this.translation[1]-this.height,this.translation[2]),this.swingRopePoint=new Wt(k),this.swingRopePoint.updatePosAndAxis(this.axisZ,.995),this.stick=new Ue(t,"TrapezeStick","Trapeze",this,18,this.stickMtx),this.updateStickMtx(),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(11,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,11,1),this.ddraw.setVtxAttrFmt(0,13,1)}drawRope(e,t,a,r,n,s){this.ddraw.allocVertices(12),this.ddraw.begin(152),this.ddraw.position3f32(e[0]-12*a[0]+19*r[0],e[1]-12*a[1]+19*r[1],e[2]-12*a[2]+19*r[2]),this.ddraw.color4color(11,qt),this.ddraw.texCoord2f32(13,0,n),this.ddraw.position3f32(e[0]+19*a[0]-19*r[0],e[1]+19*a[1]-19*r[1],e[2]+19*a[2]-19*r[2]),this.ddraw.color4color(11,Qt),this.ddraw.texCoord2f32(13,1,n),this.ddraw.position3f32(t[0]-12*a[0]+19*r[0],t[1]-12*a[1]+19*r[1],t[2]-12*a[2]+19*r[2]),this.ddraw.color4color(11,qt),this.ddraw.texCoord2f32(13,0,s),this.ddraw.position3f32(t[0]+19*a[0]-19*r[0],t[1]+19*a[1]-19*r[1],t[2]+19*a[2]-19*r[2]),this.ddraw.color4color(11,Qt),this.ddraw.texCoord2f32(13,1,s),this.ddraw.end(),this.ddraw.begin(152),this.ddraw.position3f32(e[0]-19*a[0]-19*r[0],e[1]-19*a[1]-19*r[1],e[2]-19*a[2]-19*r[2]),this.ddraw.color4color(11,Jt),this.ddraw.texCoord2f32(13,0,.7+n),this.ddraw.position3f32(e[0]+12*a[0]+19*r[0],e[1]+12*a[1]+19*r[1],e[2]+12*a[2]+19*r[2]),this.ddraw.color4color(11,qt),this.ddraw.texCoord2f32(13,1,.7+n),this.ddraw.position3f32(t[0]-19*a[0]+19*r[0],t[1]-19*a[1]+19*r[1],t[2]-19*a[2]+19*r[2]),this.ddraw.color4color(11,Jt),this.ddraw.texCoord2f32(13,0,.7+s),this.ddraw.position3f32(t[0]+12*a[0]+19*r[0],t[1]+12*a[1]+19*r[1],t[2]+12*a[2]+19*r[2]),this.ddraw.color4color(11,qt),this.ddraw.texCoord2f32(13,1,.7+s),this.ddraw.end(),this.ddraw.begin(152),this.ddraw.position3f32(e[0]+19*a[0]-7*r[0],e[1]+19*a[1]-7*r[1],e[2]+19*a[2]-7*r[2]),this.ddraw.color4color(11,Qt),this.ddraw.texCoord2f32(13,0,.5+n),this.ddraw.position3f32(e[0]-19*a[0]-7*r[0],e[1]-19*a[1]-7*r[1],e[2]-19*a[2]-7*r[2]),this.ddraw.color4color(11,Jt),this.ddraw.texCoord2f32(13,1,.5+n),this.ddraw.position3f32(t[0]+19*a[0]-7*r[0],t[1]+19*a[1]-7*r[1],t[2]+19*a[2]-7*r[2]),this.ddraw.color4color(11,Qt),this.ddraw.texCoord2f32(13,0,.5+s),this.ddraw.position3f32(t[0]-19*a[0]-7*r[0],t[1]-19*a[1]-7*r[1],t[2]-19*a[2]-7*r[2]),this.ddraw.color4color(11,Jt),this.ddraw.texCoord2f32(13,1,.5+s),this.ddraw.end()}draw(e,t,a){if(super.draw(e,t,a),!f.isValidDraw(this))return;this.ddraw.beginDraw(),s.vec3.scaleAndAdd(D,this.translation,this.axisX,-60),s.vec3.scaleAndAdd(I,this.swingRopePoint.position,this.axisX,-60),this.drawRope(D,I,this.swingRopePoint.axisX,this.swingRopePoint.axisZ,0,.003*this.height),s.vec3.scaleAndAdd(D,this.translation,this.axisX,60),s.vec3.scaleAndAdd(I,this.swingRopePoint.position,this.axisX,60),this.drawRope(D,I,this.swingRopePoint.axisX,this.swingRopePoint.axisZ,0,.003*this.height);const r=e.modelCache.device,n=this.ddraw.endDraw(r,t),i=e.trapezeRopeDrawInit;i.trapezeRope.fillTextureMapping(M.m_TextureMapping[0]);const o=i.materialHelper,c=n.allocateUniformBuffer(l.ub_MaterialParams,o.materialParamsBufferSize);o.fillMaterialParamsDataOnInst(n,c,M),n.setSamplerBindingsFromTextureMappings(M.m_TextureMapping),n.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),s.mat4.copy(U.u_PosMtx[0],a.camera.viewMatrix),l.fillPacketParamsData(n.mapUniformBufferF32(l.ub_PacketParams),n.getUniformBufferOffset(l.ub_PacketParams),U),o.setOnRenderInst(r,t.gfxRenderCache,n),t.submitRenderInst(n)}updateStickMtx(){const e=this.swingRopePoint;f.setMtxAxisXYZ(this.stickMtx,e.axisX,e.axisY,e.axisZ),f.setTrans(this.stickMtx,e.position)}destroy(e){super.destroy(e),this.ddraw.destroy(e)}}t.Trapeze=ea;class ta{constructor(e,t,a,r,n,i){this.coordAcrossRail=a,this.coordOnRail=r,this.height=n,this.flowSpeedRate=i,this.originalPos=s.vec3.create(),this.pos=s.vec3.create(),this.upVec=s.vec3.create(),this.alpha=1,s.vec3.copy(this.originalPos,e),s.vec3.copy(this.upVec,t)}calcHeight(e,t,a,r,n,s){const i=r*Math.sin(t+.0025*s),o=a*Math.sin(e+.003*n+3e-4*s);return this.height*(o+i)}updatePos(e,t,a,r,n){const i=this.calcHeight(e,t,a,r,this.coordAcrossRail,this.coordOnRail)*n;s.vec3.scaleAndAdd(this.pos,this.originalPos,this.upVec,-i)}}class aa{constructor(e,t){this.oceanRing=t,this.ddraw=new g.TDDraw,this.tex0Trans=s.vec2.create(),this.tex1Trans=s.vec2.create(),this.tex2Trans=s.vec2.create(),this.pointCount=this.oceanRing.points.length,f.isLoopRail(this.oceanRing)||(this.pointCount-=this.oceanRing.pointsPerSegment),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(11,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxDesc(14,!0),this.ddraw.setVtxDesc(15,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,11,1),this.ddraw.setVtxAttrFmt(0,13,1),this.ddraw.setVtxAttrFmt(0,14,1),this.ddraw.setVtxAttrFmt(0,15,1);const a=new S.GXMaterialBuilder("OceanRing");a.setChanCtrl(4,!1,1,1,0,0,2),a.setTexCoordGen(0,1,4,30),a.setTexCoordGen(1,1,5,33),a.setTexCoordGen(2,1,6,36),a.setTexCoordGen(3,0,0,39);a.setIndTexOrder(0,2,2),a.setTevIndWarp(3,0,!0,!1,1),a.setTevOrder(0,0,0,7),a.setTevColorIn(0,8,15,15,15),a.setTevColorOp(0,0,0,0,!1,0),a.setTevAlphaIn(0,7,7,7,7),a.setTevAlphaOp(0,0,0,0,!1,0),a.setTevOrder(1,1,0,7),a.setTevColorIn(1,15,8,0,15),a.setTevColorOp(1,0,0,3,!1,0),a.setTevAlphaIn(1,7,7,7,7),a.setTevAlphaOp(1,0,0,1,!1,0),a.setTevOrder(2,255,255,7),a.setTevColorIn(2,0,3,2,0),a.setTevColorOp(2,9,0,0,!1,0),a.setTevAlphaIn(2,6,7,7,7),a.setTevAlphaOp(2,0,0,0,!1,0),a.setTevOrder(3,3,1,0),a.setTevColorIn(3,15,8,4,0),a.setTevColorOp(3,0,0,0,!0,0),a.setTevAlphaIn(3,5,7,7,7),a.setTevAlphaOp(3,0,0,0,!1,0),a.setBlendMode(1,4,5,5),a.setAlphaCompare(4,0,1,4,0),a.setZMode(!0,3,!1),a.setCullMode(0),a.setUsePnMtxIdx(!1),this.materialHelper=new l.GXMaterialHelperGfx(a.finish());const r=e.modelCache.getObjectData("WaterWave");this.water=f.loadBTIData(e,r,"Water.bti"),this.waterIndirect=f.loadBTIData(e,r,"WaterIndirect.bti")}update(e){this.tex0Trans[0]=(this.tex0Trans[0]+-.003*e)%1,this.tex0Trans[1]=(this.tex0Trans[1]+-.001*e)%1,this.tex1Trans[0]=(this.tex1Trans[0]+-.002*e)%1,this.tex1Trans[1]=(this.tex1Trans[1]+.001*e)%1,this.tex2Trans[0]=(this.tex2Trans[0]+0*e)%1,this.tex2Trans[1]=(this.tex2Trans[1]+.003*e)%1}draw(e,t,a){this.ddraw.beginDraw();const r=this.oceanRing.points,n=this.oceanRing.pointsPerSegment;let i=0,c=0,h=0;for(let e=0;e<this.pointCount;e+=n){this.ddraw.begin(152);let t=0,a=0,s=0;const o=i+.05,l=c+.05,d=h+.1;for(let u=e;u<e+n;u++){const e=r[u],m=r[(u+n)%r.length];this.ddraw.position3vec3(e.pos),this.ddraw.color4rgba8(11,255,255,255,255*e.alpha),this.ddraw.texCoord2f32(13,i,t),this.ddraw.texCoord2f32(14,c,a),this.ddraw.texCoord2f32(15,h,s),this.ddraw.position3vec3(m.pos),this.ddraw.color4rgba8(11,255,255,255,255*m.alpha),this.ddraw.texCoord2f32(13,o,t),this.ddraw.texCoord2f32(14,l,a),this.ddraw.texCoord2f32(15,d,s),t+=.05,a+=.05,s+=.1}i=o,c=l,h=d,this.ddraw.end()}const d=e.modelCache.device,u=this.ddraw.endDraw(d,t);f.setTextureMatrixST(M.u_IndTexMtx[0],.1,null),f.setTextureMatrixST(M.u_TexMtx[0],1,this.tex0Trans),f.setTextureMatrixST(M.u_TexMtx[1],1,this.tex1Trans),f.setTextureMatrixST(M.u_TexMtx[2],1,this.tex2Trans),f.loadTexProjectionMtx(M.u_TexMtx[3],a.camera,a.viewport),this.water.fillTextureMapping(M.m_TextureMapping[0]),e.captureSceneDirector.fillTextureMappingOpaqueSceneTexture(M.m_TextureMapping[1]),this.waterIndirect.fillTextureMapping(M.m_TextureMapping[2]),o.colorFromRGBA8(M.u_Color[l.ColorKind.C0],673720340),o.colorFromRGBA8(M.u_Color[l.ColorKind.C1],1993867263);const m=this.materialHelper,p=u.allocateUniformBuffer(l.ub_MaterialParams,m.materialParamsBufferSize);m.fillMaterialParamsDataOnInst(u,p,M),u.setSamplerBindingsFromTextureMappings(M.m_TextureMapping),u.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),s.mat4.copy(U.u_PosMtx[0],a.camera.viewMatrix),l.fillPacketParamsData(u.mapUniformBufferF32(l.ub_PacketParams),u.getUniformBufferOffset(l.ub_PacketParams),U),m.setOnRenderInst(d,t.gfxRenderCache,u),t.submitRenderInst(u)}destroy(e){this.water.destroy(e),this.waterIndirect.destroy(e),this.ddraw.destroy(e)}}class ra extends u.LiveActor{constructor(e,t,a){super(e,t,"OceanRingPipeOutside"),this.pipe=a,this.tex0Trans=s.vec2.create(),f.connectToScene(t,this,-1,-1,-1,10);const r=t.modelCache.getObjectData("OceanRing");this.waterPipeIndirect=f.loadBTIData(t,r,"WaterPipeIndirect.bti"),this.waterPipeHighLight=f.loadBTIData(t,r,"WaterPipeHighLight.bti");const n=new S.GXMaterialBuilder("OceanRingPipeOutside");n.setChanCtrl(0,!1,0,0,0,0,2),n.setChanCtrl(2,!0,0,0,4,2,2),n.setTexCoordGen(0,1,4,30),n.setTexCoordGen(1,1,1,33),n.setIndTexOrder(0,0,0),n.setTevIndWarp(0,0,!0,!1,1),n.setTevOrder(0,1,1,0),n.setTevColorIn(0,8,15,15,2),n.setTevColorOp(0,0,0,0,!0,0),n.setTevAlphaIn(0,1,7,5,7),n.setTevAlphaOp(0,0,2,1,!0,0),n.setTevOrder(1,255,255,0),n.setTevColorIn(1,0,15,15,1),n.setTevColorOp(1,0,0,0,!0,0),n.setTevAlphaIn(1,6,7,7,7),n.setTevAlphaOp(1,0,0,0,!1,0),n.setUsePnMtxIdx(!1),this.materialHelper=new l.GXMaterialHelperGfx(n.finish())}movement(e,t){super.movement(e,t),this.tex0Trans[0]+=-.004*r.getDeltaTimeFrames(t)}draw(e,t,a){if(super.draw(e,t,a),!f.isValidDraw(this))return;const r=e.modelCache.device,n=t.newRenderInst();n.setInputLayoutAndState(this.pipe.inputLayout,this.pipe.inputState),n.drawIndexes(this.pipe.indexCount),this.waterPipeIndirect.fillTextureMapping(M.m_TextureMapping[0]),this.waterPipeHighLight.fillTextureMapping(M.m_TextureMapping[1]),f.setTextureMatrixST(M.u_TexMtx[0],1,this.tex0Trans);const c=M.u_TexMtx[1];i.computeNormalMatrix(c,a.camera.viewMatrix,!0),i.computeModelMatrixS(P,.6,.6,.6),s.mat4.mul(c,c,P);const h=M.m_TextureMapping[1].flipY?-1:1;x.buildEnvMtx(P,h),s.mat4.mul(c,c,P),o.colorFromRGBA8(M.u_Color[l.ColorKind.C0],342228921);const d=M.u_Lights[2];d.reset(),d.Color.a=.5,d.Direction[1]=-1;const u=this.materialHelper,m=n.allocateUniformBuffer(l.ub_MaterialParams,u.materialParamsBufferSize);u.fillMaterialParamsDataOnInst(n,m,M),n.setSamplerBindingsFromTextureMappings(M.m_TextureMapping),n.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),s.mat4.copy(U.u_PosMtx[0],a.camera.viewMatrix),l.fillPacketParamsData(n.mapUniformBufferF32(l.ub_PacketParams),n.getUniformBufferOffset(l.ub_PacketParams),U),u.setOnRenderInst(r,t.gfxRenderCache,n),t.submitRenderInst(n)}destroy(e){super.destroy(e),this.waterPipeIndirect.destroy(e),this.waterPipeHighLight.destroy(e)}}class na extends u.LiveActor{constructor(e,t,a,r){super(e,t,"OceanRingPipe"),this.oceanRing=r,this.pointsPerSegment=8,this.width1=1200,this.width2=1200,f.connectToSceneMapObjMovement(t,this),this.initRailRider(t,a);const n=this.initPoints(t);if("OceanRingAndFlag"===this.oceanRing.name)for(let a=0;a<this.segmentCount;a+=7)if(f.calcGravityVector(t,this,n[a*this.pointsPerSegment],D),D[1]<=-.9){const r=1&a?n[a*this.pointsPerSegment]:n[a*this.pointsPerSegment+this.pointsPerSegment-1],i=new oa(e,t,null,"FlagSurfing");s.vec3.set(k,1,0,0),i.setInfoPos("FlagSurfing",r,k,500,300,200,2,3),i.init(t)}this.outside=new ra(e,t,this)}initPoints(e){const t=e.modelCache.device,a=e.modelCache.cache,r=f.getRailTotalLength(this);this.segmentCount=1+(r/300|0);const n=(this.segmentCount+1)*this.pointsPerSegment,i=[],o=3.1415/(this.pointsPerSegment-1),l=r/this.segmentCount,c=new Float32Array(10*n);let d=0;h.assert(n<65535);const u=2*this.pointsPerSegment,m=w.getTriangleIndexCountForTopologyIndexCount(1,u);this.indexCount=(this.segmentCount+1)*m;const p=new Uint16Array(this.indexCount);let A=0,g=0,S=0;for(let t=0;t<this.segmentCount+1;t++){f.getRailPos(D,this),f.calcGravityVector(e,this,D,D),s.vec3.negate(D,D),f.getRailDirection(I,this),s.mat4.fromRotation(P,o,I),s.vec3.cross(R,I,D),s.vec3.normalize(R,R);const a=this.width1*this.oceanRing.calcCurrentWidthRate(f.getRailCoord(this),this.width2);f.getRailPos(D,this);let r=0;for(let e=0;e<this.pointsPerSegment;e++){const n=D[0]+a*R[0],o=D[1]+a*R[1],l=D[2]+a*R[2];if(c[d++]=n,c[d++]=o,c[d++]=l,i.push(s.vec3.fromValues(n,o,l)),c[d++]=R[0],c[d++]=R[1],c[d++]=R[2],c[d++]=S,c[d++]=r,c[d++]=0,c[d++]=0,r+=1,s.vec3.transformMat4(R,R,P),t<this.segmentCount&&e<this.pointsPerSegment-1){const e=g,t=g+this.pointsPerSegment,a=e+0,r=t+0,n=e+1,s=t+1;p[A++]=a,p[A++]=r,p[A++]=n,p[A++]=n,p[A++]=r,p[A++]=s}g++}S+=.08,f.moveCoord(this,l)}this.vertexBuffer=b.makeStaticDataBuffer(t,2,c.buffer),this.indexBuffer=b.makeStaticDataBuffer(t,1,p.buffer);const x=[{location:v.getVertexInputLocation(2),format:_.GfxFormat.F32_RGB,bufferIndex:0,bufferByteOffset:0},{location:v.getVertexInputLocation(3),format:_.GfxFormat.F32_RGB,bufferIndex:0,bufferByteOffset:12},{location:v.getVertexInputLocation(8),format:_.GfxFormat.F32_RGBA,bufferIndex:0,bufferByteOffset:24}];return this.inputLayout=a.createInputLayout(t,{indexBufferFormat:_.GfxFormat.U16_R,vertexAttributeDescriptors:x,vertexBufferDescriptors:[{byteStride:40,frequency:1}]}),this.inputState=t.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0}),i}movement(e,t){super.movement(e,t),this.outside.movement(e,t)}destroy(e){super.destroy(e),e.destroyBuffer(this.vertexBuffer),e.destroyBuffer(this.indexBuffer),e.destroyInputState(this.inputState)}}class sa extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.points=[],this.pointsPerSegment=15,this.waveTheta1=0,this.waveTheta2=0,f.connectToScene(t,this,34,-1,-1,8),f.initDefaultPos(t,this,a),this.initRailRider(t,a),this.initPoints(t);const s=h.fallback(n.getJMapInfoArg0(a),0);0===s?(this.waveHeight1=80,this.waveHeight2=100):1===s?(this.waveHeight1=50,this.waveHeight2=80):2===s&&(this.waveHeight1=20,this.waveHeight2=30),this.oceanRingDrawer=new aa(t,this),this.arg1=h.fallback(n.getJMapInfoArg1(a),30),0===s&&(this.oceanRingPipe=new na(e,t,a,this))}initPoints(e){const t=f.getRailTotalLength(this);this.segmentCount=1+(t/200|0);const a=t/this.segmentCount;for(let t=0;t<this.segmentCount;t++){f.getRailPos(D,this),f.calcGravityVector(e,this,D,D),s.vec3.negate(D,D),f.getRailDirection(I,this),s.vec3.cross(R,I,D),s.vec3.normalize(R,R);const r=f.getRailCoord(this),n=this.calcCurrentWidthRate(r),i=this.calcCurrentFlowSpeedRate(r);for(let e=-7;e<=7;e++){f.getRailPos(I,this);const r=1200/7*e;s.vec3.scaleAndAdd(I,I,R,n*r);const o=7-Math.abs(e),l=o<2?ce(o/2,0,1,1):1,c=new ta(I,D,r,t*a,l,i);this.points.push(c)}f.moveCoord(this,a)}}updatePoints(){for(let e=0;e<this.points.length;e++)this.points[e].updatePos(this.waveTheta1,this.waveTheta2,this.waveHeight1,this.waveHeight2,1)}movement(e,t){super.movement(e,t);const a=r.getDeltaTimeFrames(t);this.waveTheta2+=-.06*a,this.waveTheta1+=-.04*a,this.updatePoints(),null!==this.oceanRingDrawer&&this.oceanRingDrawer.update(a)}draw(e,t,a){super.draw(e,t,a),f.isValidDraw(this)&&null!==this.oceanRingDrawer&&this.oceanRingDrawer.draw(e,t,a)}calcCurrentFlowSpeedRate(e){f.setRailCoord(this,e),f.calcDistanceToCurrentAndNextRailPoint(B,this);const t=B[0]+B[1];if(t>=1){const e=h.fallback(this.railRider.getCurrentPointArg("point_arg0"),100),a=h.fallback(this.railRider.getNextPointArg("point_arg0"),100);return(e*B[1]+a*B[0])/t/100}return 1}calcCurrentWidthRate(e,t=1200){f.setRailCoord(this,e),f.calcDistanceToCurrentAndNextRailPoint(B,this);const a=B[0]+B[1];if(a>=1){const e=t/100,r=h.fallback(this.railRider.getCurrentPointArg("point_arg1"),e),n=h.fallback(this.railRider.getNextPointArg("point_arg1"),e);return(r*B[1]+n*B[0])/a/e}return 1}static requestArchives(e,t){e.modelCache.requestObjectData("WaterWave"),0===h.fallback(n.getJMapInfoArg0(t),0)&&(e.modelCache.requestObjectData("OceanRing"),"OceanRingAndFlag"===r.getObjectName(t)&&e.modelCache.requestObjectData("FlagSurfing"))}destroy(e){super.destroy(e),this.oceanRingDrawer.destroy(e)}}t.OceanRing=sa;class ia{constructor(){this.position=s.vec3.create(),this.points=[]}}class oa extends u.LiveActor{constructor(e,t,a,i=null){if(super(e,t,null!==i?i:r.getObjectName(a)),this.fixPoints=[],this.poleHeight=0,this.flyPerPoint=0,this.hoistPerPoint=0,this.axisX=s.vec3.fromValues(0,0,0),this.axisY=s.vec3.fromValues(0,1,0),this.windDirection=s.vec3.fromValues(0,0,1),this.vertical=!1,this.animCounter=0,this.noColorTint=!1,this.affectGravity=.1,this.affectWindConst=.1,this.affectWindWave=10,this.affectRndmMin=1,this.affectRndmMax=4,this.dragMin=.6,this.dragMax=1,this.ddraw=new g.TDDraw,f.connectToScene(t,this,34,-1,-1,29),this.fixPointCount=10,this.swingPointCount=10,this.flyPerPoint=40,this.hoistPerPoint=40,null!==a){f.initDefaultPos(t,this,a),this.poleHeight=h.fallback(n.getJMapInfoArg1(a),0);const e=this.name;if("FlagKoopaCastle"===e)this.flyPerPoint=1e3/this.swingPointCount,this.hoistPerPoint=500/(this.fixPointCount-1);else if("FlagKoopaA"===e)this.flyPerPoint=450/this.swingPointCount,this.hoistPerPoint=275/(this.fixPointCount-1);else if("FlagKoopaB"===e)this.flyPerPoint=450/this.swingPointCount,this.hoistPerPoint=112.5/(this.fixPointCount-1);else if("FlagPeachCastleA"===e)this.fixPointCount=5,this.swingPointCount=6,this.flyPerPoint=160/6,this.hoistPerPoint=36.25,this.vertical=!0,this.affectGravity=.5,this.dragMin=.85,this.dragMax=1,this.affectWindWave=0,this.affectWindConst=.01,this.affectRndmMin=.5,this.affectRndmMax=1.5;else if("FlagPeachCastleB"===e)this.fixPointCount=5,this.swingPointCount=5,this.flyPerPoint=100,this.hoistPerPoint=100;else if("FlagPeachCastleC"===e)this.fixPointCount=5,this.swingPointCount=5,this.flyPerPoint=100,this.hoistPerPoint=100;else if("FlagRaceA"!==e)throw"whoops";$(null,this.axisY,this.windDirection,this),this.init(t)}this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(11,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,11,1),this.ddraw.setVtxAttrFmt(0,13,1);const o=new S.GXMaterialBuilder("Flag");o.setChanCtrl(4,!1,1,1,0,0,2),o.setTexCoordGen(0,1,4,60),o.setTevOrder(0,0,0,0),o.setTevColorIn(0,15,8,10,15),o.setTevColorOp(0,0,0,0,!1,0),o.setTevAlphaIn(0,7,4,1,7),o.setTevAlphaOp(0,0,0,0,!1,0),o.setBlendMode(1,4,5,5),o.setAlphaCompare(4,0,1,4,0),o.setZMode(!0,3,!0),o.setUsePnMtxIdx(!1),this.materialHelper=new l.GXMaterialHelperGfx(o.finish())}setInfoPos(e,t,a,r,n,i,o,l){this.name=e,s.vec3.copy(this.translation,t),s.vec3.copy(this.windDirection,a),this.poleHeight=r,o>0&&(this.swingPointCount=o),l>0&&(this.fixPointCount=l),this.flyPerPoint=n/this.swingPointCount,this.hoistPerPoint=i/(this.fixPointCount-1)}init(e){"FlagSurfing"===this.name&&(this.noColorTint=!0),h.assert(0===this.fixPoints.length);for(let e=0;e<this.fixPointCount;e++){const t=new ia,a=this.fixPointCount-1-e;s.vec3.scaleAndAdd(k,this.translation,this.axisY,this.poleHeight+this.hoistPerPoint*a),s.vec3.copy(t.position,k);for(let e=0;e<this.swingPointCount;e++){if(this.vertical){const a=this.flyPerPoint*(e+1);s.vec3.scaleAndAdd(k,t.position,this.gravityVector,a)}const a=new Wt(k);t.points.push(a)}this.fixPoints.push(t)}this.colors=new Uint32Array(this.fixPointCount*(this.swingPointCount+1));for(let e=0;e<this.colors.length;e++)this.colors[e]=4294967295;const t=e.modelCache.getObjectData(this.name);this.texture=f.loadBTIData(e,t,`${this.name}.bti`)}drawPolePoint(e,t,a,r){s.vec3.set(D,5*e,0,5*t),s.vec3.add(D,this.translation,D),s.vec3.scaleAndAdd(I,D,this.axisY,a),this.ddraw.position3vec3(I),this.ddraw.color4rgba8(11,0,r,0,0),this.ddraw.texCoord2f32(13,0,0),this.ddraw.position3vec3(D),this.ddraw.color4rgba8(11,0,r,0,0),this.ddraw.texCoord2f32(13,0,0)}getColorIdx(e,t){return e*(this.swingPointCount+1)+t}draw(e,t,a){if(super.draw(e,t,a),!f.isValidDraw(this))return;this.ddraw.beginDraw();for(let e=1;e<this.fixPoints.length;e++){this.ddraw.begin(152);const t=this.fixPoints[e-1],a=this.fixPoints[e],r=(e-1)/(this.fixPoints.length-1),n=e/(this.fixPoints.length-1);this.ddraw.position3vec3(t.position),o.colorFromRGBA8(F,this.colors[this.getColorIdx(e-1,0)]),this.ddraw.color4color(11,F),this.ddraw.texCoord2f32(13,0,r),this.ddraw.position3vec3(a.position),o.colorFromRGBA8(F,this.colors[this.getColorIdx(e,0)]),this.ddraw.color4color(11,F),this.ddraw.texCoord2f32(13,0,n);for(let s=0;s<this.swingPointCount;s++){const i=t.points[s],l=a.points[s],c=(s+1)/this.swingPointCount;this.ddraw.position3vec3(i.position),o.colorFromRGBA8(F,this.colors[this.getColorIdx(e-1,s+1)]),this.ddraw.color4color(11,F),this.ddraw.texCoord2f32(13,c,r),this.ddraw.position3vec3(l.position),o.colorFromRGBA8(F,this.colors[this.getColorIdx(e,s+1)]),this.ddraw.color4color(11,F),this.ddraw.texCoord2f32(13,c,n)}this.ddraw.end()}if(this.poleHeight>0){this.ddraw.begin(152);const e=this.poleHeight+this.hoistPerPoint*(this.fixPointCount-1);this.drawPolePoint(1,0,e,200),this.drawPolePoint(0,1,e,220),this.drawPolePoint(-1,0,e,180),this.drawPolePoint(1,0,e,200),this.ddraw.end()}const r=e.modelCache.device,n=this.ddraw.endDraw(r,t);this.texture.fillTextureMapping(M.m_TextureMapping[0]),o.colorFromRGBA8(M.u_Color[l.ColorKind.C0],4294967295);const i=this.materialHelper,c=n.allocateUniformBuffer(l.ub_MaterialParams,i.materialParamsBufferSize);i.fillMaterialParamsDataOnInst(n,c,M),n.setSamplerBindingsFromTextureMappings(M.m_TextureMapping),n.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),s.mat4.copy(U.u_PosMtx[0],a.camera.viewMatrix),l.fillPacketParamsData(n.mapUniformBufferF32(l.ub_PacketParams),n.getUniformBufferOffset(l.ub_PacketParams),U),i.setOnRenderInst(r,t.gfxRenderCache,n),t.submitRenderInst(n)}updateFlag(e){s.vec3.cross(this.axisX,this.windDirection,this.axisY),s.vec3.normalize(this.axisX,this.axisX),s.vec3.scale(D,this.gravityVector,this.affectGravity);for(let e=0;e<this.fixPoints.length;e++){const t=this.fixPoints[e];for(let a=0;a<t.points.length;a++){const r=t.points[a];r.addAccel(D);const n=Math.abs(Math.sin(.01745*(this.animCounter+10*e+10*a))),i=this.affectWindConst+n*this.affectWindWave;s.vec3.scale(I,this.windDirection,i),r.addAccel(I)}}if(this.vertical){if(0===f.getRandomInt(0,2)){const e=f.getRandomInt(0,this.fixPointCount),t=f.getRandomInt(0,this.swingPointCount);s.vec3.set(D,f.getRandomFloat(-1,1),0,f.getRandomFloat(-1,1)),f.vecKillElement(D,D,this.axisY),s.vec3.scale(D,D,f.getRandomFloat(this.affectRndmMin,this.affectRndmMax)),this.fixPoints[e].points[t].addAccel(D)}}else for(let e=0;e<this.fixPoints.length;e++)s.vec3.set(D,f.getRandomFloat(-1,1),0,f.getRandomFloat(-1,1)),s.vec3.scale(D,D,f.getRandomFloat(this.affectRndmMin,this.affectRndmMax)),this.fixPoints[e].points[0].addAccel(D);for(let e=0;e<this.swingPointCount;e++)for(let t=1;t<this.fixPoints.length;t++){const a=this.fixPoints[t-1].points[e];this.fixPoints[t].points[e].restrict(a.position,this.hoistPerPoint,a.accel)}for(let e=0;e<this.fixPoints.length;e++){const t=this.fixPoints[e];let a=t.position;for(let e=0;e<this.swingPointCount;e++){const r=t.points[e];r.restrict(a,this.flyPerPoint,null),a=r.position}}let t=0;if(!this.noColorTint){J(k,e);const a=s.vec3.distance(this.translation,k),r=i.saturate(i.invlerp(1e3,500,a));t=i.lerp(120,200,r)}for(let e=0;e<this.fixPoints.length;e++){const a=this.fixPoints[e];for(let r=0;r<this.swingPointCount;r++){const n=i.lerp(this.dragMin,this.dragMax,1-r/(this.swingPointCount-1)),o=a.points[r];if(o.updatePos(n),!this.noColorTint){const a=s.vec3.dot(o.axisY,this.axisX),n=i.clamp((a+1)/1.5*255,t,255);this.colors[this.getColorIdx(e,r+1)]=n<<24|n<<16|n<<8|255}}}}movement(e,t){super.movement(e,t),this.animCounter+=5*r.getDeltaTimeFrames(t),this.updateFlag(t.camera)}destroy(e){super.destroy(e),this.ddraw.destroy(e),this.texture.destroy(e)}}t.Flag=oa;class la extends c.NameObj{constructor(e){super(e,"ElectricRailHolder"),this.models=h.nArray(4,()=>null),this.rails=[],f.connectToScene(e,this,35,5,-1,14)}calcAnim(e,t){super.calcAnim(e,t);for(let a=0;a<this.models.length;a++){const r=this.models[a];null!==r&&r.calcAnim(e,t)}}movement(e,t){super.movement(e,t);for(let a=0;a<this.models.length;a++){const r=this.models[a];null!==r&&r.movement(e,t)}}draw(e,t,a){super.draw(e,t,a);const r=e.modelCache.device,n=t.gfxRenderCache;for(let i=0;i<4;i++){const o=this.models[i];if(null===o)continue;const c=t.pushTemplateRenderInst(),h=o.modelInstance;s.mat4.copy(U.u_PosMtx[0],a.camera.viewMatrix),c.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),h.shapeInstances[0].shapeData.shapeHelpers[0].fillPacketParams(U,c);const d=h.materialInstances[0];d.setOnRenderInst(r,n,c);for(let r=0;r<this.rails.length;r++){const n=this.rails[r];if(n.type!==i)continue;if(!n.visibleScenario||!n.visibleAlive)continue;d.fillOnMaterialParams(M,h.materialInstanceState,a.camera,h.modelMatrix,a.viewport,U);const s=t.pushTemplateRenderInst();s.setSamplerBindingsFromTextureMappings(M.m_TextureMapping);const o=d.materialHelper.allocateMaterialParams(s);n.drawRail(e,t,M,a),d.materialHelper.fillMaterialParamsDataOnInst(s,o,M),t.popTemplateRenderInst()}t.popTemplateRenderInst()}}registerRail(e,t){this.createModel(e,t.type),this.rails.push(t)}createModel(e,t){if(null===this.models[t])if(0===t){const a=new xe(u.dynamicSpawnZoneAndLayer,e,"ElectricRailModel","ElectricRail",null,-1,-1,-1);f.startBtk(a,"ElectricRail"),f.startBrk(a,"ElectricRail"),f.setBrkFrameAndStop(a,0),this.models[t]=a}else if(1===t){const a=new xe(u.dynamicSpawnZoneAndLayer,e,"ElectricRailModel","ElectricRail",null,-1,-1,-1);f.startBtk(a,"ElectricRail"),f.startBrk(a,"ElectricRail"),f.setBrkFrameAndStop(a,1),this.models[t]=a}else if(2===t){const a=new xe(u.dynamicSpawnZoneAndLayer,e,"ElectricRailModel","ElectricRailMoving",null,-1,-1,-1);f.startBtk(a,"ElectricRailMoving"),f.startBrk(a,"ElectricRailMoving"),f.setBrkFrameAndStop(a,0),this.models[t]=a}else if(3===t){const a=new xe(u.dynamicSpawnZoneAndLayer,e,"ElectricRailModel","ElectricRailMoving",null,-1,-1,-1);f.startBtk(a,"ElectricRailMoving"),f.startBrk(a,"ElectricRailMoving"),f.setBrkFrameAndStop(a,1),this.models[t]=a}}}t.ElectricRailHolder=la;class ca extends u.LiveActor{constructor(e,t){super(e,t,"ElectricRailPoint"),this.initModelManagerWithAnm(t,"ElectricRailPoint"),f.connectToSceneMapObjDecoration(t,this)}}function ha(e,t,a,r){s.vec3.cross(e,r,a),s.vec3.normalize(e,e),s.vec3.cross(t,a,e)}function da(e,t,a){!function(e,t){s.vec3.scaleAndAdd(e,i.Vec3UnitZ,t,-s.vec3.dot(t,i.Vec3UnitZ)),i.isNearZeroVec3(e,.001)&&s.vec3.scaleAndAdd(e,i.Vec3UnitX,t,-s.vec3.dot(t,i.Vec3UnitX)),s.vec3.normalize(e,e)}(e,a),s.vec3.cross(t,a,e),s.vec3.normalize(t,t)}class ua{constructor(){this.position=s.vec3.create(),this.right=s.vec3.create(),this.up=s.vec3.create(),this.front=s.vec3.create(),this.gravity=s.vec3.create()}setup(){s.vec3.negate(this.front,this.front),s.vec3.negate(D,this.gravity),f.isSameDirection(D,this.front,.01)?da(this.right,this.up,this.front):ha(this.right,this.up,this.front,D)}}class ma extends u.LiveActor{constructor(e,t,a){super(e,t,"ElectricRail"),this.points=[],this.separators=[],this.useGlobalGravity=!1,this.size=30,this.ddraw=new g.TSDraw,this.type=h.fallback(n.getJMapInfoArg3(a),0),f.connectToSceneMapObjMovement(t,this),f.initDefaultPos(t,this,a),this.height=h.fallback(n.getJMapInfoArg0(a),1),this.initRailRider(t,a),this.useGlobalGravity=n.getJMapInfoBool(h.fallback(n.getJMapInfoArg4(a),-1)),this.useGlobalGravity&&f.calcGravityVector(t,this,this.translation,this.gravityVector),this.initPoints(t),this.initSeparators(t),t.create(89),t.electricRailHolder.registerRail(t,this),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1)}initAfterPlacement(e){super.initAfterPlacement(e),this.drawAndUploadRail(e)}initPoints(e){const t=f.getRailPointNum(this);for(let a=0;a<t;a++){if(!(-1!==h.fallback(this.railRider.getPointArg(a,"point_arg0"),-1)))for(let t=0;t<this.height;t++){const r=new ca(this.zoneAndLayer,e);f.calcRailPointPos(r.translation,this,a),t>=1&&(this.calcGravity(e,k,r.translation),s.vec3.scaleAndAdd(r.translation,r.translation,k,-100*t)),this.points.push(r)}}}initSeparators(e){const t=1+(f.getRailTotalLength(this)/200|0);for(let a=0;a<t;a++){a===t-1?f.isLoopRail(this)?f.moveCoordToStartPos(this):f.moveCoordToEndPos(this):f.setRailCoord(this,200*a);const r=new ua;f.getRailPos(r.position,this),this.calcGravity(e,r.gravity,r.position),i.isNearZeroVec3(r.gravity,.001)&&s.vec3.set(r.gravity,0,-1,0),f.getRailDirection(r.front,this),r.setup(),this.separators.push(r)}f.moveCoordToStartPos(this)}calcGravity(e,t,a){this.useGlobalGravity?s.vec3.copy(t,this.gravityVector):f.calcGravityVector(e,this,a,t)}drawPlane(e,t,a,r,n){for(let i=0;i<this.height;i++){const o=100*i;e.begin(152);for(let i=0;i<this.separators.length;i++){const l=this.separators[i];s.vec3.scaleAndAdd(k,l.position,l.up,o);const c=.5*i;s.vec3.scaleAndAdd(D,k,l.right,t),s.vec3.scaleAndAdd(D,D,l.up,a),e.position3vec3(D),e.texCoord2f32(13,c,0),s.vec3.scaleAndAdd(D,k,l.right,r),s.vec3.scaleAndAdd(D,D,l.up,n),e.position3vec3(D),e.texCoord2f32(13,c,1)}e.end()}}drawAndUploadRail(e){this.ddraw.beginDraw(),this.drawPlane(this.ddraw,this.size,this.size,-this.size,-this.size),this.drawPlane(this.ddraw,-this.size,this.size,this.size,-this.size);const t=e.modelCache;this.ddraw.endDraw(t.device,t.cache)}drawRail(e,t,a,r){const n=t.newRenderInst();this.ddraw.setOnRenderInst(n),t.submitRenderInst(n)}destroy(e){this.ddraw.destroy(e)}static requestArchives(e,t){super.requestArchives(e,t),e.modelCache.requestObjectData("ElectricRailPoint")}}t.ElectricRail=ma;class pa extends u.LiveActor{constructor(e,t,a){super(e,t,"ElectricRailMoving"),this.separators=[],this.points=[],this.size=30,this.ddraw=new g.TSDraw,this.coordPhaseAnim=0,this.alpha=1,this.type=2+h.fallback(n.getJMapInfoArg4(a),0),f.connectToSceneMapObjMovement(t,this),f.initDefaultPos(t,this,a),this.segmentCount=h.fallback(n.getJMapInfoArg0(a),10),this.speed=h.fallback(n.getJMapInfoArg1(a),10),this.height=h.fallback(n.getJMapInfoArg3(a),1),this.initRailRider(t,a);const r=n.getJMapInfoArg2(a);this.visibleSegmentLength=null!==r?r:f.getRailTotalLength(this)/(2*this.segmentCount);const i=2+(f.getRailTotalLength(this)/100|0);for(let e=0;e<i;e++){const t=s.vec3.create(),a=Math.min(100*e,f.getRailTotalLength(this));f.calcRailPosAtCoord(t,this,a),this.separators.push(t)}this.initPoints(t),t.create(89),t.electricRailHolder.registerRail(t,this),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1)}initAfterPlacement(e){super.initAfterPlacement(e),this.drawAndUploadRail(e)}initPoints(e){const t=2*this.segmentCount*this.height;for(let a=0;a<t;a++)this.points.push(new ca(this.zoneAndLayer,e));if(!f.isLoopRail(this))for(let t=0;t<this.height;t++){const a=new ca(this.zoneAndLayer,e);this.points.push(a),f.calcRailStartPointPos(a.translation,this),t>=1&&(f.calcGravityVector(e,this,a.translation,k),s.vec3.scaleAndAdd(a.translation,a.translation,k,-100*t));const r=new ca(this.zoneAndLayer,e);this.points.push(r),f.calcRailEndPointPos(r.translation,this),t>=1&&(f.calcGravityVector(e,this,r.translation,k),s.vec3.scaleAndAdd(r.translation,r.translation,k,-100*t))}this.updatePointPos(e)}movement(e,t){super.movement(e,t),this.move(e,t)}getRepeatedCoord(e){return de(e,f.getRailTotalLength(this))}calcPointPos(e,t){const a=t/100|0;let r=100;a>this.separators.length-3&&(r=f.getRailTotalLength(this)-100*a);const n=t%100/r;s.vec3.lerp(e,this.separators[a],this.separators[a+1],n)}updatePointPos(e){let t=this.coordPhaseAnim;const a=f.getRailTotalLength(this)/this.segmentCount;let r=0,n=!1;for(let i=0;i<this.segmentCount;i++){const i=this.getRepeatedCoord(t),o=this.getRepeatedCoord(t-this.visibleSegmentLength);for(let t=0;t<this.height;t++){const a=this.points[r++];this.calcPointPos(a.translation,i),t>=1&&(f.calcGravityVector(e,this,a.translation,k),s.vec3.scaleAndAdd(a.translation,a.translation,k,-100*t));const n=this.points[r++];this.calcPointPos(n.translation,o),t>=1&&(f.calcGravityVector(e,this,n.translation,k),s.vec3.scaleAndAdd(n.translation,n.translation,k,-100*t))}if(!f.isLoopRail(this)){this.getRepeatedCoord(t+this.speed)<this.visibleSegmentLength+3*this.speed&&(n=!0)}t+=a}return n}updatePointPosAndModel(e){const t=this.updatePointPos(e);if(!f.isLoopRail(this)){for(let e=this.points.length-2*this.height;e<this.points.length;e++)this.points[e].visibleModel=t}}move(e,t){this.coordPhaseAnim=this.getRepeatedCoord(this.coordPhaseAnim+this.speed*r.getDeltaTimeFrames(t));const a=f.getRailTotalLength(this)/this.segmentCount,n=this.visibleSegmentLength/a;this.alpha=i.saturate(n+15/255*Math.sin(6.283*n)),this.updatePointPosAndModel(e)}drawPlane(e,t,a,r,n,i){const o=f.getRailTotalLength(this);for(let l=0;l<this.height;l++){t.begin(152);for(let c=0;c<this.separators.length;c++){const h=Math.min(100*c,o),d=.25*h/100;f.calcRailDirectionAtCoord(D,this,h),s.vec3.negate(D,D),f.calcGravityVector(e,this,k,I),s.vec3.negate(I,I),s.vec3.scaleAndAdd(k,this.separators[c],I,100*l),f.isSameDirection(I,D,.01)?da(R,I,D):ha(R,I,D,I),s.vec3.scaleAndAdd(D,k,R,a),s.vec3.scaleAndAdd(D,D,I,r),t.position3vec3(D),t.texCoord2f32(13,d,0),s.vec3.scaleAndAdd(D,k,R,n),s.vec3.scaleAndAdd(D,D,I,i),t.position3vec3(D),t.texCoord2f32(13,d,1)}t.end()}}drawAndUploadRail(e){this.ddraw.beginDraw(),this.drawPlane(e,this.ddraw,this.size,this.size,-this.size,-this.size),this.drawPlane(e,this.ddraw,-this.size,this.size,this.size,-this.size);const t=e.modelCache;this.ddraw.endDraw(t.device,t.cache)}drawRail(e,t,a,r){a.u_Color[l.ColorKind.C1].a=this.alpha;const n=a.u_TexMtx[1];s.mat4.identity(n);const i=100*this.segmentCount/(.25*f.getRailTotalLength(this));n[0]=i,n[12]=-.25*i*this.coordPhaseAnim/100;const o=t.newRenderInst();this.ddraw.setOnRenderInst(o),t.submitRenderInst(o)}destroy(e){this.ddraw.destroy(e)}static requestArchives(e,t){super.requestArchives(e,t),e.modelCache.requestObjectData("ElectricRailPoint")}}t.ElectricRailMoving=pa;class fa extends u.LiveActor{constructor(e,t){super(e,t,"FluffWindEffect"),this.effectHostMtx=s.mat4.create(),this.lifetime=0}initEffectInfo(e,t,a,r,n){s.vec3.copy(this.translation,t),f.connectToSceneMapObjMovement(e,this),f.makeMtxFrontUpPos(this.effectHostMtx,a,r,t),this.effectName=n,this.initEffectKeeper(e,n),Re(this,this.effectName,this.effectHostMtx),this.initNerve(0)}updateSpine(e,t,a){super.updateSpine(e,t,a),0===t?(d.isFirstStep(this)&&(this.lifetime=f.getRandomInt(0,600)),d.isGreaterStep(this,this.lifetime)&&this.setNerve(1)):1===t&&(d.isFirstStep(this)&&(N(e,this,this.effectName),this.lifetime=f.getRandomInt(60,240)),d.isGreaterStep(this,this.lifetime)&&this.setNerve(1))}}class Aa extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.effects=[],this.initRailRider(t,a),this.initEffectKeeper(t,"FluffWind");const n=1+(f.getRailTotalLength(this)/600|0);for(let a=0;a<n;a++){const r=new fa(e,t),s=a/n*f.getRailTotalLength(this);f.calcRailPosAtCoord(D,this,s),f.calcRailDirectionAtCoord(I,this,s),r.initEffectInfo(t,D,I,i.Vec3UnitY,"FluffWind")}}static requestArchives(e,t){}}t.FluffWind=Aa;class ga extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,this.name),f.connectToSceneCollisionMapObj(t,this),p.isConnectedWithRail(a)&&this.initRailRider(t,a),"OceanFloaterTypeU"===this.name&&(f.moveCoordToEndPos(this),f.moveTransToCurrentRailPos(this))}}t.OceanFloaterLandParts=ga;class _a extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.lowerPos=s.vec3.create(),this.upperPos=s.vec3.create(),f.initDefaultPos(t,this,a),this.upperHeight=h.fallback(n.getJMapInfoArg0(a),1e3),this.maxUpperStep=h.fallback(n.getJMapInfoArg1(a),180),s.vec3.copy(this.lowerPos,this.translation),this.initModelManagerWithAnm(t,"Dossun"),f.startBva(this,"Wait"),f.connectToSceneCollisionEnemyStrongLight(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null),this.initNerve(0),this.calcParameters(t)}calcParameters(e){s.vec3.set(k,0,this.upperHeight,0),i.transformVec3Mat4w0(k,this.getBaseMtx(),k),s.vec3.add(this.upperPos,this.lowerPos,k);this.maxFallingStep=this.upperHeight/30;this.maxRisingStep=this.upperHeight/25}updateSpine(e,t,a){if(super.updateSpine(e,t,a),0===t)d.isFirstStep(this)&&s.vec3.copy(this.translation,this.upperPos),d.isGreaterStep(this,this.maxUpperStep)&&this.setNerve(1);else if(1===t)d.isFirstStep(this)&&(f.startBck(this,"FallStart"),f.startBva(this,"Attack")),f.isBckStopped(this)&&this.setNerve(2);else if(2===t){const e=le(this.getNerveStep(),0,1,this.maxFallingStep);s.vec3.lerp(this.translation,this.upperPos,this.lowerPos,e),d.isGreaterStep(this,this.maxFallingStep)&&this.setNerve(3)}else if(3===t){d.isFirstStep(this)&&(s.vec3.copy(this.translation,this.lowerPos),N(e,this,"Land"));const t=48;d.isGreaterStep(this,t)&&this.setNerve(4)}else if(4===t){d.isFirstStep(this)&&f.startBva(this,"Wait");const e=function(e,t,a,r){const n=Math.cos(e/r*Math.PI);return i.lerp(t,a,.5*(1-n))}(this.getNerveStep(),0,1,this.maxRisingStep);s.vec3.lerp(this.translation,this.lowerPos,this.upperPos,e),d.isGreaterStep(this,this.maxRisingStep)&&this.setNerve(0)}}}t.Dossun=_a;t.Tsukidashikun=class extends we{constructor(e,t,a){const r=new ve;r.setupDefaultPos(),r.setupConnectToScene(),r.setupEffect(null),r.setupNerve(4),r.initLightControl=!0,r.lightType=1,super(e,t,a,r),this.speed=h.fallback(n.getJMapInfoArg0(a),10),this.waitStep=h.fallback(n.getJMapInfoArg0(a),120),f.moveCoordToNearestPos(this)}updateSpine(e,t,a){super.updateSpine(e,t,a),3===t||6===t?(f.moveCoordAndFollowTrans(this,this.speed*a),f.isRailReachedGoal(this)&&(f.reverseRailDirection(this),3===t?this.setNerve(1):this.setNerve(4))):1===t||4===t?(d.isFirstStep(this)&&(1===t?f.startBva(this,"FWait"):f.startBva(this,"BWait")),d.isGreaterStep(this,this.waitStep)&&(1===t?this.setNerve(5):this.setNerve(2))):2!==t&&5!==t||(d.isFirstStep(this)&&(f.startBck(this,"Sign"),2===t?f.startBva(this,"FSign"):f.startBva(this,"BSign")),d.isGreaterStep(this,60)&&(f.setBckFrameAndStop(this,0),2===t?this.setNerve(3):this.setNerve(6)))}};class Sa extends u.LiveActor{constructor(e,t,a,r){super(e,t,a),this.hasItem=!1,this.initModelManagerWithAnm(t,a),f.connectToSceneNoSilhouettedMapObjWeakLightNoMovement(t,this),r&&this.initLightCtrl(t),this.initNerve(0)}updateSpine(e,t,a){super.updateSpine(e,t,a),1===t&&(d.isFirstStep(this)&&f.startBck(this,"HintShake"),f.isBckStopped(this)&&this.setNerve(0))}initAfterPlacement(e){}initPosture(e){f.calcGravity(e,this),f.isSameDirection(this.gravityVector,i.Vec3UnitX,.01)?s.vec3.copy(D,i.Vec3UnitY):s.vec3.copy(D,i.Vec3UnitX),Q(P,this,this.gravityVector,D);const t=f.getRandomFloat(-Math.PI,Math.PI);s.mat4.rotate(P,P,t,this.gravityVector),i.computeEulerAngleRotationFromSRTMatrix(this.rotation,P)}tryEmitHint(){return 0===this.getCurrentNerve()&&(this.setNerve(1),!0)}animControl(e){}}class ba extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.effectTranslation=s.vec3.create(),this.effectRotation=s.vec3.create(),this.members=[],this.lastHintPlant=0,f.connectToScene(t,this,34,-1,-1,-1),f.initDefaultPos(t,this,a),"FlowerGroup"===this.name?this.modelName="Flower":"FlowerBlueGroup"===this.name?this.modelName="FlowerBlue":this.modelName="CutBush",this.count=h.fallback(n.getJMapInfoArg0(a),7);const i=h.fallback(n.getJMapInfoArg1(a),0);this.whichItem=h.fallback(n.getJMapInfoArg2(a),0),this.initMember(t,i,a),this.initEffectKeeper(t,"Bush"),Be(this,"HintShakeLeaf",this.effectTranslation,this.effectRotation,null),this.hintTimer=10*f.getRandomInt(3,10)}control(e,t){super.control(e,t);for(let a=0;a<this.members.length;a++){const r=this.members[a];r.animControl(e),r.movement(e,t)}const a=r.getDeltaTimeFrames(t);this.emitHintEffect(e,a)}emitHintEffect(e,t){if(this.hintTimer-=t,this.hintTimer<=0){this.hintTimer=300;let t=this.lastHintPlant;for(;;){t=(t+1)%this.members.length;const a=this.members[t];if(a.hasItem&&a.tryEmitHint()&&(this.lastHintPlant=t,s.vec3.copy(this.effectTranslation,a.translation),s.vec3.copy(this.effectRotation,a.rotation),N(e,this,"HintShakeLeaf")),t===this.lastHintPlant)break}}}initAfterPlacement(e){super.initAfterPlacement(e),f.calcGravityVector(e,this,this.translation,k),this.placeOnCollisionFormCircle(e,R,k)}makeActorAppeared(e){super.makeActorAppeared(e);for(let t=0;t<this.members.length;t++)this.members[t].makeActorAppeared(e)}makeActorDead(e){super.makeActorDead(e);for(let t=0;t<this.members.length;t++)this.members[t].makeActorDead(e)}initMember(e,t,a){const r="CutBush"===this.modelName;for(let a=0;a<this.count;a++){const n=new Sa(this.zoneAndLayer,e,this.modelName,r);this.members.push(n),a<t&&(n.hasItem=!0)}for(let e=0;e<this.count;e++){const t=f.getRandomInt(0,e+1),a=this.members[t].hasItem;this.members[t].hasItem=this.members[e].hasItem,this.members[e].hasItem=a}this.initHitSensor(),f.addHitSensorMapObj(e,this,"Plant",16,100,i.Vec3Zero)}placeOnCollisionFormCircle(e,t,a){s.vec3.set(t,0,0,0);let r=6.283,n=0,o=0,l=0;for(let c=0;c<this.members.length;c++){const h=this.members[c];s.vec3.copy(D,i.Vec3UnitX),s.vec3.copy(I,i.Vec3UnitY),da(D,I,a),s.vec3.scaleAndAdd(D,this.translation,D,Math.cos(r)*l),s.vec3.scaleAndAdd(D,D,I,Math.sin(r)*l),s.vec3.scaleAndAdd(D,D,a,-100),s.vec3.scale(I,a,1e3),y.getFirstPolyOnLineToMap(e,h.translation,null,D,I),s.vec3.add(t,t,h.translation),h.initPosture(e),r>=6.283?(n+=6,o++,l=160*o,r=0):r+=6.283/n}s.vec3.scale(t,t,1/this.members.length)}static requestArchives(e){}}t.PlantGroup=ba;class va extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.useStageSwitchReadAppear(t,this,a)&&f.listenStageSwitchOnOffAppear(t,this,this.onAppeared.bind(this),this.offAppeared.bind(this)),f.useStageSwitchWriteDead(t,this,a)}onAppeared(e){this.stageSwitchCtrl.onSwitchDead(e)}offAppeared(e){this.stageSwitchCtrl.offSwitchDead(e)}static requestArchives(e){}}t.MovieStarter=va;class wa extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),f.initDefaultPos(t,this,a),this.initModelManagerWithAnm(t,"WaterLeakPipe"),this.jointTop=h.assertExists(this.getJointMtx("Top")),this.jointBottom=h.assertExists(this.getJointMtx("Bottom")),this.pipeHeight=h.fallback(n.getJMapInfoArg0(a),500),this.initPipeHeight(),f.connectToSceneMapObj(t,this),this.initHitSensor(),this.initEffectKeeper(t,null),this.initNerve(0),this.makeActorAppeared(t)}calcAnim(e,t){}initPipeHeight(){q(k,this),s.vec3.scaleAndAdd(k,this.translation,k,this.pipeHeight),this.jointTop[12]=k[0],this.jointTop[13]=k[1],this.jointTop[14]=k[2],this.calcAndSetBaseMtxBase()}updateSpine(e,t,a){super.updateSpine(e,t,a),0===t&&d.isFirstStep(this)&&N(e,this,"Splash")}}t.WaterLeakPipe=wa;class xa extends u.LiveActor{constructor(e,t,a){super(e,t,r.getObjectName(a)),this.effectHostMtx=s.mat4.create(),this.rotationAxis=s.vec3.create(),this.poseQuat=s.quat.create(),this.poseQuatLast=s.quat.create(),this.poseQuatNext=s.quat.create(),f.initDefaultPos(t,this,a),this.initRailRider(t,a),this.initFromRailPoint(t),this.initModelManagerWithAnm(t,"Onimasu"),f.connectToSceneCollisionEnemyNoShadowedMapObjStrongLight(t,this),this.initLightCtrl(t),this.initEffectKeeper(t,null),Re(this,"Move",this.effectHostMtx),this.initHitSensor(),this.calcGravityFlag=!0,this.initNerve(0),f.useStageSwitchSleep(t,this,a),this.makeActorAppeared(t)}calcAndSetBaseMtx(){f.makeMtxTRFromQuatVec(this.modelInstance.modelMatrix,this.poseQuat,this.translation)}initAfterPlacement(e){if(this.collectRailPointInfo(e),f.moveCoordAndTransToRailStartPoint(this),f.setRailDirectionToEnd(this),this.calcAndSetBaseMtxBase(),he(e,"FactoryGalaxy")&&(i.getMatrixAxisX(this.rotationAxis,this.modelInstance.modelMatrix),s.vec3.normalize(this.rotationAxis,this.rotationAxis)),s.mat4.getRotation(this.poseQuatLast,this.modelInstance.modelMatrix),s.quat.copy(this.poseQuatNext,this.poseQuatLast),s.quat.copy(this.poseQuat,this.poseQuatLast),he(e,"FactoryGalaxy")){-1===this.calcTurnDirection()&&this.setNerve(2)}}updateSpine(e,t,a){if(super.updateSpine(e,t,a),0===t||2===t){const e=90;d.isGreaterEqualStep(this,e)&&(2===t?this.setNerve(3):this.setNerve(1))}else if(1===t){d.isFirstStep(this)&&(this.incrementNextPoint(e),this.calcTargetPose(e),this.startMoveInner(e)),d.isGreaterEqualStep(this,1)&&(this.calcGravityFlag=!1),this.updatePose(e),this.updatePoseInner(e);const t=this.getTimeToNextPoint(e);d.isGreaterEqualStep(this,t)&&(this.land(e),-1===this.calcTurnDirection()?this.setNerve(2):this.setNerve(0))}else if(3===t){d.isFirstStep(this)&&this.updateStompVelocity(e);const t=this.getNextPointNormal(),a=this.getGravityScalar(e);s.vec3.scaleAndAdd(this.velocity,this.velocity,t,-1*a);const r=this.getTimeToNextPoint(e);d.isGreaterEqualStep(this,r)&&(this.land(e),this.setNerve(0))}}calcTargetPose(e){const t=this.getLastPointNormal(),a=this.getNextPointNormal();if(f.isSameDirection(t,a,.01))if(null!==this.calcTurnDirection()){s.quat.identity(E);const e=Math.PI*this.calcTurnDirection();s.mat4.fromRotation(P,e,t),i.transformVec3Mat4w0(this.rotationAxis,P,this.rotationAxis)}else s.quat.identity(E);else s.quat.rotationTo(E,t,a),s.quat.getAxisAngle(this.rotationAxis,E),s.vec3.normalize(this.rotationAxis,this.rotationAxis);s.quat.copy(this.poseQuatLast,this.poseQuatNext),s.quat.mul(this.poseQuatNext,E,this.poseQuatNext),s.quat.setAxisAngle(E,this.rotationAxis,1.57075),s.quat.mul(this.poseQuatNext,E,this.poseQuatNext)}updatePose(e){const t=this.getTimeToNextPoint(e),a=i.saturate(this.getNerveStep()/t);s.quat.slerp(this.poseQuat,this.poseQuatLast,this.poseQuatNext,a)}emitEffectLand(e){const t=this.getNextPointNo();f.calcRailPointPos(k,this,t);const a=this.getNextPointNormal();s.vec3.scaleAndAdd(k,k,a,-400),f.isSameDirection(this.rotationAxis,a,.01)?f.makeMtxUpNoSupportPos(this.effectHostMtx,a,k):f.makeMtxUpFrontPos(this.effectHostMtx,a,this.rotationAxis,k),N(e,this,"Move")}land(e){this.emitEffectLand(e);const t=this.getNextPointNo();f.calcRailPointPos(this.translation,this,t),s.vec3.set(this.velocity,0,0,0),f.moveCoordToRailPoint(this,t)}updateStompVelocity(e){const t=this.getGravityScalar(e),a=this.getTimeToNextPoint(e),r=this.getNextPointNormal();s.vec3.scale(this.velocity,r,.5*t*a)}calcTurnDirection(){const e=f.getCurrentRailPointArg0(this);return 0===e?.5:1===e?-.5:2===e?-1:null}calcGravityDir(e){s.vec3.negate(e,this.getNextPointNormal())}getTimeToNextPoint(e){return 30}getGravityScalar(e){return 1.6}}const Ta=new y.Triangle;function ya(e,t,a,r,n){return f.calcRailPointPos(t,r,n),f.calcGravityVector(e,r,t,a),s.vec3.scale(a,a,2e3),y.getFirstPolyOnLineToMap(e,t,Ta,t,a)?(s.vec3.copy(a,Ta.faceNormal),!0):(s.vec3.normalize(a,a),s.vec3.negate(a,a),!1)}t.OnimasuJump=class extends xa{constructor(){super(...arguments),this.nextPointNo=0}initFromRailPoint(e){this.pointCount=f.getRailPointNum(this),this.normals=h.nArray(this.pointCount,()=>s.vec3.create())}collectRailPointInfo(e){for(let t=0;t<this.pointCount;t++)ya(e,k,this.normals[t],this,t)}incrementNextPoint(){this.nextPointNo++,this.nextPointNo>=f.getRailPointNum(this)&&(this.nextPointNo=0)}getLastPointNo(){let e=this.nextPointNo-1;return e<0&&(e+=f.getRailPointNum(this)),e}getLastPointNormal(){return this.normals[this.getLastPointNo()]}getNextPointNo(){return this.nextPointNo}getNextPointNormal(){return this.normals[this.nextPointNo]}updatePoseInner(e){this.calcGravityDir(k);const t=this.getGravityScalar(e);s.vec3.scaleAndAdd(this.velocity,this.velocity,k,t)}startMoveInner(e){f.calcRailPointPos(k,this,this.nextPointNo),this.calcGravityFlag=!0,f.calcGravity(e,this);const t=s.vec3.distance(k,this.translation),a=this.getTimeToNextPoint(e);s.vec3.sub(D,k,this.translation),i.normToLength(D,t/a),this.calcGravityDir(I);const r=this.getGravityScalar(e);s.vec3.scale(I,I,-.5*r*a),s.vec3.add(this.velocity,D,I)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=r(a(66)),i=a(20),o=a(8),l=a(10),c=a(6),h=a(13),d=a(7),u=a(17),m=a(44),p=a(0),f=a(112),A=a(2),g=a(14);class _ extends i.DeviceProgram{constructor(){super(...arguments),this.both=_.both,this.vert=`\nlayout(location = ${_.a_Position}) in vec3 a_Position;\nlayout(location = ${_.a_UV}) in vec2 a_UV;\nlayout(location = ${_.a_Color}) in vec4 a_Color;\nlayout(location = ${_.a_Normal}) in vec3 a_Normal;\nlayout(location = ${_.a_PosMtxIdx}) in float a_PosMtxIdx;\nout vec4 v_Color;\nout vec2 v_TexCoord;\n\nvoid main() {\n    Mat4x3 t_PosMtx = u_PosMtx[int(a_PosMtxIdx)];\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(t_PosMtx), vec4(a_Position, 1.0)));\n    v_Color = a_Color;\n\n    vec2 t_TexSpaceCoord;\n    if (u_TexCoordMode == 2.0) { // TexCoordMode.NORMAL\n        v_TexCoord = Mul(u_TexMtx[0], vec4(a_Normal, 1.0)).st;\n    } else {\n        v_TexCoord = Mul(u_TexMtx[0], vec4(a_UV, 1.0, 1.0)).st;\n    }\n}\n`,this.frag="\nprecision mediump float;\nin vec2 v_TexCoord;\nin vec4 v_Color;\n\nvoid main() {\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n#ifdef USE_TEXTURE\n    gl_FragColor *= texture(u_Texture, v_TexCoord);\n#endif\n\n#ifdef USE_VERTEX_COLOR\n    gl_FragColor *= v_Color;\n#endif\n\n    if (gl_FragColor.a == 0.0)\n        discard;\n}\n"}}t.NITRO_Program=_,_.a_Position=0,_.a_UV=1,_.a_Color=2,_.a_Normal=3,_.a_PosMtxIdx=4,_.ub_SceneParams=0,_.ub_MaterialParams=1,_.ub_PacketParams=2,_.both="\nprecision mediump float;\n\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n};\n\n// Expected to change with each material.\nlayout(row_major, std140) uniform ub_MaterialParams {\n    Mat4x2 u_TexMtx[1];\n    vec4 u_Misc0;\n};\n#define u_TexCoordMode (u_Misc0.x)\n\nlayout(row_major, std140) uniform ub_PacketParams {\n    Mat4x3 u_PosMtx[32];\n};\n\nuniform sampler2D u_Texture;\n";class S{constructor(e,t){this.nitroVertexData=t,this.vertexBuffer=u.makeStaticDataBuffer(e,2,this.nitroVertexData.packedVertexBuffer.buffer),this.indexBuffer=u.makeStaticDataBuffer(e,1,this.nitroVertexData.indexBuffer.buffer);const a=[{location:_.a_Position,format:c.GfxFormat.F32_RGB,bufferIndex:0,bufferByteOffset:0},{location:_.a_Color,format:c.GfxFormat.F32_RGBA,bufferIndex:0,bufferByteOffset:12},{location:_.a_UV,format:c.GfxFormat.F32_RG,bufferIndex:0,bufferByteOffset:28},{location:_.a_Normal,format:c.GfxFormat.F32_RGB,bufferIndex:0,bufferByteOffset:36},{location:_.a_PosMtxIdx,format:c.GfxFormat.F32_R,bufferIndex:0,bufferByteOffset:48}],r=[{byteStride:s.VERTEX_BYTES,frequency:1}],n=c.GfxFormat.U16_R;this.inputLayout=e.createInputLayout({vertexAttributeDescriptors:a,vertexBufferDescriptors:r,indexBufferFormat:n}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}destroy(e){e.destroyBuffer(this.vertexBuffer),e.destroyBuffer(this.indexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}t.VertexData=S;class b{constructor(e,t,a){this.rootJoint=t,this.batch=a,this.vertexData=new S(e,a.vertexData)}destroy(e){this.vertexData.destroy(e)}}class v{constructor(e,t,a){this.material=a,this.gfxTexture=null,this.gfxSampler=null,this.textureMapping=p.nArray(1,()=>new l.TextureMapping);const r=this.material.texture;if(null!==r){this.gfxTexture=e.createTexture(c.makeTextureDescriptor2D(c.GfxFormat.U8_RGBA_NORM,r.width,r.height,1)),e.setResourceName(this.gfxTexture,r.name);const a=e.createHostAccessPass();a.uploadTextureData(this.gfxTexture,0,[r.pixels]),e.submitPass(a),this.gfxSampler=t.createSampler(e,{minFilter:0,magFilter:0,mipFilter:0,wrapS:m.parseTexImageParamWrapModeS(this.material.texParams),wrapT:m.parseTexImageParamWrapModeT(this.material.texParams),minLOD:0,maxLOD:100}),this.textureMapping[0].gfxTexture=this.gfxTexture,this.textureMapping[0].gfxSampler=this.gfxSampler}}destroy(e){null!==this.gfxTexture&&e.destroyTexture(this.gfxTexture)}}function w(e,t){return e[(0|t)%e.length]}t.BMDData=class{constructor(e,t,a){this.bmd=a,this.materialData=[],this.batchData=[];for(let a=0;a<this.bmd.materials.length;a++)this.materialData.push(new v(e,t,this.bmd.materials[a]));for(let t=0;t<this.bmd.joints.length;t++){const a=this.bmd.joints[t];for(let t=0;t<a.batches.length;t++)this.batchData.push(new b(e,a,a.batches[t]))}}destroy(e){for(let t=0;t<this.materialData.length;t++)this.materialData[t].destroy(e);for(let t=0;t<this.batchData.length;t++)this.batchData[t].destroy(e)}};const x=n.mat2d.create(),T=n.mat4.create(),y=n.vec2.create();class C{constructor(e,t){this.materialData=t,this.crg1TextureAnimation=null,this.texturesEnabled=!0,this.vertexColorsEnabled=!0;const a=this.materialData.material;if(null!==e){const t=e.TextureAnimations.find(e=>e.MaterialName===a.name);void 0!==t&&(this.crg1TextureAnimation=t)}this.megaStateFlags={depthWrite:a.depthWrite,cullMode:a.cullMode},g.setAttachmentStateSimple(this.megaStateFlags,{blendMode:c.GfxBlendMode.ADD,blendDstFactor:c.GfxBlendFactor.ONE_MINUS_SRC_ALPHA,blendSrcFactor:c.GfxBlendFactor.SRC_ALPHA}),this.createProgram(),this.texCoordMode=a.texParams>>>30}createProgram(){const e=new _,t=this.materialData.material;this.texturesEnabled&&null!==t.texture&&e.defines.set("USE_TEXTURE","1"),this.vertexColorsEnabled&&e.defines.set("USE_VERTEX_COLOR","1"),this.program=e}setVertexColorsEnabled(e){this.vertexColorsEnabled=e,this.createProgram()}setTexturesEnabled(e){this.texturesEnabled=e,this.createProgram()}prepareToRender(e,t,a,r,s,i){const o=t.gfxRenderCache.createProgram(e,this.program);a.setGfxProgram(o),a.setMegaStateFlags(this.megaStateFlags);const l=this.materialData.material,c=l.isTranslucent?128:32;if(a.sortKey=d.makeSortKey(c),null!==l.texture)if(2===this.texCoordMode)n.mat4.copy(T,s),T[12]+=l.texCoordMat[4],T[13]+=-l.texCoordMat[5],p.assert(null===this.crg1TextureAnimation);else{if(null!==this.crg1TextureAnimation){const e=r.time/30,t=w(this.crg1TextureAnimation.Scale,e),a=w(this.crg1TextureAnimation.Rotation,e),s=w(this.crg1TextureAnimation.X,e),i=w(this.crg1TextureAnimation.Y,e);n.mat2d.identity(x),n.mat2d.scale(x,x,n.vec2.set(y,t,t)),n.mat2d.rotate(x,x,a/180*Math.PI),n.mat2d.translate(x,x,n.vec2.set(y,-s,i)),n.mat2d.mul(x,x,l.texCoordMat)}else n.mat2d.copy(x,l.texCoordMat);null!==i&&n.mat2d.mul(x,x,i),function(e,t){const a=t[0],r=t[1],n=t[2],s=t[3],i=t[4],o=t[5];e[0]=a,e[1]=n,e[2]=0,e[3]=0,e[4]=r,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=i,e[13]=o,e[14]=0,e[15]=1}(T,x)}let u=a.allocateUniformBuffer(_.ub_MaterialParams,12);const m=a.mapUniformBufferF32(_.ub_MaterialParams);u+=h.fillMatrix4x2(m,u,T),u+=h.fillVec4(m,u,this.texCoordMode),a.setSamplerBindingsFromTextureMappings(this.materialData.textureMapping)}}class M{constructor(e,t){this.materialInstance=e,this.batchData=t,this.visible=!0,p.assert(this.batchData.batch.matrixTable.length<=32)}prepareToRender(e,t,a,r,n,s){if(!this.visible)return;const i=this.batchData.vertexData,o=t.pushTemplateRenderInst();o.setInputLayoutAndState(i.inputLayout,i.inputState),this.materialInstance.prepareToRender(e,t,o,a,r,n);let l=o.allocateUniformBuffer(_.ub_PacketParams,384);const c=o.mapUniformBufferF32(_.ub_PacketParams),d=this.batchData.rootJoint;for(let e=0;e<this.batchData.batch.matrixTable.length;e++){const t=this.batchData.batch.matrixTable[e];s.computeModelView(T,t,a,d.billboard),l+=h.fillMatrix4x3(c,l,T)}const u=i.nitroVertexData;for(let e=0;e<u.drawCalls.length;e++){t.pushRenderInst().drawIndexes(u.drawCalls[e].numIndices,u.drawCalls[e].startIndex)}t.popTemplateRenderInst()}}const U=n.mat4.create(),k=n.mat4.create();t.BMDModelInstance=class{constructor(e,t=null){this.bmdData=e,this.crg1Level=t,this.name="",this.isSkybox=!1,this.modelMatrix=n.mat4.create(),this.extraTexCoordMat=null,this.visible=!0,this.materialInstances=[],this.shapeInstances=[],this.bcaAnimator=null,this.jointMatrices=p.nArray(this.bmdData.bmd.joints.length,()=>n.mat4.create());for(let t=0;t<this.bmdData.batchData.length;t++){const a=this.bmdData.batchData[t],r=e.materialData[a.batch.materialIdx],n=new C(this.crg1Level,r);this.materialInstances.push(n);const s=new M(n,a);this.shapeInstances.push(s)}}setVertexColorsEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setVertexColorsEnabled(e)}setTexturesEnabled(e){for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].setTexturesEnabled(e)}bindBCA(e,t){this.bcaAnimator=f.bindBCAAnimator(e,t)}computeJointMatrices(){for(let e=0;e<this.bmdData.bmd.joints.length;e++){const t=this.bmdData.bmd.joints[e],a=this.jointMatrices[e];let r;null!==this.bcaAnimator?(this.bcaAnimator.calcJointMatrix(U,e),r=U):r=t.modelMatrix,t.parentJointIdx>=0?n.mat4.mul(a,this.jointMatrices[t.parentJointIdx],r):n.mat4.mul(a,this.modelMatrix,r)}}prepareToRender(e,t,a){if(!this.visible)return;this.computeJointMatrices(),t.pushTemplateRenderInst().filterKey=this.isSkybox?2:1,this.computeNormalMatrix(k,a);for(let r=0;r<this.shapeInstances.length;r++)this.shapeInstances[r].prepareToRender(e,t,a,k,this.extraTexCoordMat,this);t.popTemplateRenderInst()}computeViewMatrix(e,t){this.isSkybox?o.computeViewMatrixSkybox(e,t.camera):o.computeViewMatrix(e,t.camera)}computeModelView(e,t,a,r){const s=this.bmdData.bmd.matrixToJointTable[t],i=this.jointMatrices[s];n.mat4.copy(U,i),this.computeViewMatrix(e,a),n.mat4.mul(e,e,U),r&&function(e,t){const a=Math.hypot(t[0],t[1],t[2]),r=Math.hypot(t[4],t[5],t[6]),n=Math.hypot(t[8],t[9],t[10]);e[0]=a,e[4]=0,e[8]=0,e[12]=t[12],e[1]=0,e[5]=r,e[9]=0,e[13]=t[13],e[2]=0,e[6]=0,e[10]=n,e[14]=t[14],e[3]=9999,e[7]=9999,e[11]=9999,e[15]=9999}(e,e)}computeNormalMatrix(e,t){A.computeRotationMatrixFromSRTMatrix(U,this.modelMatrix),this.computeViewMatrix(e,t),e[12]=0,e[13]=0,e[14]=0,n.mat4.mul(e,e,U)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(45)),s=a(0),i=a(1);class o{constructor(){this.actors=[]}}t.ZSIRoomSetup=o;class l{constructor(){this.ambientLightColor=i.vec3.create(),this.primaryLightDir=i.vec3.create(),this.primaryLightColor=i.vec3.create(),this.secondaryLightDir=i.vec3.create(),this.secondaryLightColor=i.vec3.create(),this.fogColor=i.vec3.create(),this.fogStart=0,this.drawDistance=0}copy(e){i.vec3.copy(this.ambientLightColor,e.ambientLightColor),i.vec3.copy(this.primaryLightDir,e.primaryLightDir),i.vec3.copy(this.primaryLightColor,e.primaryLightColor),i.vec3.copy(this.secondaryLightDir,e.secondaryLightDir),i.vec3.copy(this.secondaryLightColor,e.secondaryLightColor),i.vec3.copy(this.fogColor,e.fogColor),this.fogStart=e.fogStart,this.drawDistance=e.drawDistance}}function c(e,t,a,r){const n=t.createDataView(),s=[];let o=r;const l=i.quat.create();for(let t=0;t<a;t++){const t=4095&n.getUint16(o+0,!0),a=n.getInt16(o+2,!0),r=n.getInt16(o+4,!0),c=n.getInt16(o+6,!0),h=n.getInt16(o+8,!0),d=n.getInt16(o+10,!0),u=n.getInt16(o+12,!0),m=n.getUint16(o+14,!0);let p=255;const f=i.mat4.create();if(0===e){const e=180/32767;i.quat.fromEuler(l,h*e,d*e,u*e),i.mat4.fromRotationTranslation(f,l,[a,r,c])}else if(1===e){const e=h>>7,t=d>>7,n=u>>7;i.quat.fromEuler(l,e,t,n),i.mat4.fromRotationTranslation(f,l,[a,r,c]),p=(7&h)<<7|127&d}s.push({actorId:t,modelMatrix:f,variable:m,timeSpawnFlags:p}),o+=16}return s}function h(e,t,a,r){const n=t.createDataView(),s=[];let o=r;const l=i.quat.create();for(let e=0;e<a;e++){n.getUint8(o+0),n.getUint8(o+1),n.getUint8(o+2),n.getUint8(o+3);const e=n.getUint16(o+4,!0),t=n.getInt16(o+6,!0),a=n.getInt16(o+8,!0),r=n.getInt16(o+10,!0),c=n.getInt16(o+12,!0)/32767,h=n.getUint16(o+14,!0),d=i.mat4.create();i.quat.fromEuler(l,0,180*c,0),i.mat4.fromRotationTranslation(d,l,[t,a,r]),s.push({actorId:e,modelMatrix:d,variable:h,timeSpawnFlags:255}),o+=16}return s}function d(e,t,a,r){const n=[],i=0===e?68:52;for(let e=0;e<a;e++)n.push(s.readString(t,r,i)),r+=i;return n}function u(e,t,a,r){const n=t.createDataView(),s=[];for(let e=0;e<a;e++){let e=new l;const t=n.getFloat32(r+0,!0),a=n.getFloat32(r+4,!0),o=(n.getUint8(r+8),n.getUint8(r+9),n.getUint8(r+10)/255),c=n.getUint8(r+11)/255,h=n.getUint8(r+12)/255,d=n.getUint8(r+13)/255,u=n.getUint8(r+14)/255,m=n.getUint8(r+15)/255,p=n.getUint8(r+16)/255,f=n.getUint8(r+17)/255,A=n.getUint8(r+18)/255,g=n.getUint8(r+19)/255,_=n.getUint8(r+20)/255,S=n.getUint8(r+21)/255,b=n.getUint8(r+22)/255,v=n.getUint8(r+23)/255,w=n.getUint8(r+24)/255,x=n.getUint8(r+25)/255,T=n.getUint8(r+26)/255,y=n.getUint8(r+27)/255;r+=28,e.drawDistance=t,e.fogStart=a>=t?t-a:a,e.ambientLightColor=i.vec3.fromValues(o,c,h),e.primaryLightDir=i.vec3.fromValues(d,u,m),e.primaryLightColor=i.vec3.fromValues(p,f,A),e.secondaryLightDir=i.vec3.fromValues(g,_,S),e.secondaryLightColor=i.vec3.fromValues(b,v,w),e.fogColor=i.vec3.fromValues(x,T,y),s.push(e)}return s}function m(e,t){const a=e.createDataView(),r=a.getUint32(t),i=r>>24,o=r>>16&255,l=a.getUint32(t+4,!0);if(0===o)return{opaque:null,transparent:null};s.assert(2===i),s.assert(1===o);const c=a.getUint32(l+8,!0),h=a.getUint32(l+12,!0);return{opaque:0!==c?n.parse(e.slice(c)):null,transparent:0!==h?n.parse(e.slice(h)):null}}t.ZSIEnvironmentSettings=l,t.parseScene=function(e){const t=s.readString(e,0,4);return s.assert(["ZSI","ZSI\t"].includes(t)),function(e,t,a,r=0){const n=a.createDataView();let s=[],i=[],o=[],l=0;for(;;){const t=n.getUint32(r+0,!1),c=n.getUint32(r+4,!0);r+=8;const m=t>>>24;if(20==m)break;switch(m){case 15:i=u(0,a,t>>>16&255,c);break;case 14:o=h(0,a,t>>>16&255,c);break;case 4:s=d(e,a,t>>>16&255,c);break;case 17:l=c}}return{name:t,rooms:s,doorActors:o,environmentSettings:i,skyboxSettings:l}}("ZSI"===t?0:1,s.readString(e,4,12),e.slice(16))},t.parseRooms=function(e){const t=s.readString(e,0,4);s.assert(["ZSI","ZSI\t"].includes(t));const a="ZSI"===t?0:1;return s.readString(e,4,12),function e(t,a,r=0){const n=a.createDataView(),i=[],l=new o;for(i.push(l);;){const o=n.getUint32(r+0,!1),h=n.getUint32(r+4,!0);r+=8;const d=o>>>24;if(20==d)break;switch(d){case 24:{const r=o>>>16&255;let l=h;for(let o=0;o<r;o++){const r=n.getUint32(l,!0);if(l+=4,0===r)continue;const o=e(t,a,r);s.assert(1===o.length),i.push(o[0])}break}case 1:{const e=o>>>16&255;l.actors=c(t,a,e,h);break}case 10:l.mesh=m(a,h)}}return i}(a,e.slice(16))}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15)),s=a(0);function i(e){let t=e.getUint32(8,!0);const a=new Uint8Array(t);let r=16,s=0;const i=new Uint8Array(4096);let o=4078;for(;;){const l=e.getUint8(r++);for(let c=0;c<8;c++){if(l&1<<c)t--,i[o++]=a[s++]=e.getUint8(r++),o%=4096;else{const n=e.getUint8(r++),l=e.getUint8(r++);let c=n|(240&l)<<4,h=3+(15&l);for(t-=h;h--;)i[o++]=a[s++]=i[c++],o%=4096,c%=4096}if(t<=0)return new n.default(a.buffer)}}}t.decompress=i,t.maybeDecompress=function(e){return"LzS"===s.readString(e,0,4)?i(e.createDataView()):e}},function(e,t,a){"use strict";var r={};(0,a(63).assign)(r,a(240),a(243),a(175)),e.exports=r},function(e,t,a){"use strict";function r(e){return e<<3|e>>>2}function n(e){return e<<2|e>>>4}function s(e,t){return(e<<1)+e+((t<<2)+t)>>>3}function i(e,t,a){e[0]=r(t>>11&31),e[1]=n(t>>5&63),e[2]=r(31&t),e[3]=255,e[4]=r(a>>11&31),e[5]=n(a>>5&63),e[6]=r(31&a),e[7]=255,t>a?(e[8]=s(e[4],e[0]),e[9]=s(e[5],e[1]),e[10]=s(e[6],e[2]),e[11]=255,e[12]=s(e[0],e[4]),e[13]=s(e[1],e[5]),e[14]=s(e[2],e[6]),e[15]=255):(e[8]=e[0]+e[4]>>>1,e[9]=e[1]+e[5]>>>1,e[10]=e[2]+e[6]>>>1,e[11]=255,e[12]=0,e[13]=0,e[14]=0,e[15]=0)}Object.defineProperty(t,"__esModule",{value:!0}),t.decompressBC=function(e){switch(e.type){case"BC1":return function(e){const t=e.width,a=e.height,r=e.depth,n=new Uint8Array(t*a*r*4),s=new DataView(e.pixels.buffer,e.pixels.byteOffset,e.pixels.byteLength),o=new Uint8Array(16);let l=0;const c=a*r;for(let e=0;e<c;e+=4)for(let a=0;a<t;a+=4){i(o,s.getUint16(l+0,!0),s.getUint16(l+2,!0));let r=s.getUint32(l+4,!0);for(let s=0;s<4;s++)for(let i=0;i<4;i++){const l=4*((e+s)*t+a+i),c=3&r;n[l+0]=o[4*c+0],n[l+1]=o[4*c+1],n[l+2]=o[4*c+2],n[l+3]=o[4*c+3],r>>=2}l+=8}const h=n;return{type:"RGBA",flag:e.flag,width:t,height:a,depth:r,pixels:h}}(e);case"BC2":return function(e){const t=e.width,a=e.height,r=e.depth,n=new Uint8Array(t*a*r*4),s=new DataView(e.pixels.buffer,e.pixels.byteOffset,e.pixels.byteLength),o=new Uint8Array(16);let l=0;const c=a*r;for(let e=0;e<c;e+=4)for(let a=0;a<t;a+=4){const r=s.getUint32(l+0,!0),c=s.getUint32(l+4,!0);for(let s=0;s<4;s++)for(let i=0;i<4;i++){const o=4*(4*s+i),l=(o<32?r:c)>>>o%32&15;n[4*((e+s)*t+a+i)+3]=(h=l)<<4|h>>>0}l+=8,i(o,s.getUint16(l+0,!0),s.getUint16(l+2,!0));let d=s.getUint32(l+4,!0);for(let r=0;r<4;r++)for(let s=0;s<4;s++){const i=4*((e+r)*t+a+s),l=3&d;n[i+0]=o[4*l+0],n[i+1]=o[4*l+1],n[i+2]=o[4*l+2],d>>=2}l+=8}var h;const d=n;return{type:"RGBA",flag:e.flag,width:t,height:a,depth:r,pixels:d}}(e);case"BC3":return function(e){const t=e.width,a=e.height,r=e.depth,n=new Uint8Array(t*a*r*4),s=new DataView(e.pixels.buffer,e.pixels.byteOffset,e.pixels.byteLength),o=new Uint8Array(16),l=new Uint8Array(8);let c=0;const h=a*r;for(let e=0;e<h;e+=4)for(let a=0;a<t;a+=4){const r=s.getUint8(c+0),h=s.getUint8(c+1);l[0]=r,l[1]=h,r>h?(l[2]=(6*r+1*h)/7,l[3]=(5*r+2*h)/7,l[4]=(4*r+3*h)/7,l[5]=(3*r+4*h)/7,l[6]=(2*r+5*h)/7,l[7]=(1*r+6*h)/7):(l[2]=(4*r+1*h)/5,l[3]=(3*r+2*h)/5,l[4]=(2*r+3*h)/5,l[5]=(1*r+4*h)/5,l[6]=0,l[7]=255);const d=16777215&s.getUint32(c+2,!0),u=s.getUint32(c+4,!0)>>>8;for(let r=0;r<4;r++)for(let s=0;s<4;s++){const i=3*(4*r+s),o=(i<24?d:u)>>>i%24&7;n[4*((e+r)*t+a+s)+3]=l[o]}c+=8,i(o,s.getUint16(c+0,!0),s.getUint16(c+2,!0));let m=s.getUint32(c+4,!0);for(let r=0;r<4;r++)for(let s=0;s<4;s++){const i=4*((e+r)*t+a+s),l=3&m;n[i+0]=o[4*l+0],n[i+1]=o[4*l+1],n[i+2]=o[4*l+2],m>>=2}c+=8}const d=n;return{type:"RGBA",flag:e.flag,width:t,height:a,depth:r,pixels:d}}(e);case"BC4":case"BC5":return function(e){const t=e.width,a=e.height,r=e.depth,n="SNORM"===e.flag,s=new DataView(e.pixels.buffer,e.pixels.byteOffset,e.pixels.byteLength);let i,o,l;l="BC4"===e.type?1:2,n?(i=new Int8Array(t*a*r*4),o=new Int8Array(8)):(i=new Uint8Array(t*a*r*4),o=new Uint8Array(8));let c=0;const h=a*r;for(let e=0;e<h;e+=4)for(let a=0;a<t;a+=4)for(let r=0;r<l;r++){let h,d;n?(h=s.getInt8(c+0),d=s.getInt8(c+1)):(h=s.getUint8(c+0),d=s.getUint8(c+1)),o[0]=h,o[1]=d,h>d?(o[2]=(6*h+1*d)/7,o[3]=(5*h+2*d)/7,o[4]=(4*h+3*d)/7,o[5]=(3*h+4*d)/7,o[6]=(2*h+5*d)/7,o[7]=(1*h+6*d)/7):(o[2]=(4*h+1*d)/5,o[3]=(3*h+2*d)/5,o[4]=(2*h+3*d)/5,o[5]=(1*h+4*d)/5,o[6]=n?-128:0,o[7]=n?127:255);const u=16777215&s.getUint32(c+2,!0),m=s.getUint32(c+4,!0)>>>8;for(let s=0;s<4;s++)for(let c=0;c<4;c++){const h=4*((e+s)*t+a+c),d=3*(4*s+c),p=(d<24?u:m)>>>d%24&7;1===l?(i[h+0]=o[p],i[h+1]=o[p],i[h+2]=o[p],i[h+3]=o[p]):0===r?i[h+0]=o[p]:1===r&&(i[h+1]=o[p],i[h+2]=n?127:255,i[h+3]=n?127:255)}c+=8}if("SNORM"===e.flag){const n=i;return{type:"RGBA",flag:e.flag,width:t,height:a,depth:r,pixels:n}}{const n=i;return{type:"RGBA",flag:e.flag,width:t,height:a,depth:r,pixels:n}}}(e)}},t.surfaceToCanvas=function(e,t,a){e.width=t.width,e.height=t.height;const r=e.getContext("2d"),n=t.width,s=t.height,i=t.width*t.height*4,o=i*a,l=new ImageData(n,s);switch(t.type){case"RGBA":if("UNORM"===t.flag)l.data.set(t.pixels.subarray(o,o+i));else if("SRGB"===t.flag)l.data.set(t.pixels.subarray(o,o+i));else if("SNORM"===t.flag){const e=t.pixels,a=new Uint8Array(i);for(let t=0;t<e.length;t++)a[t]=e[o+t]+128;l.data.set(a)}}r.putImageData(l,0,0)}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15)),s=a(0),i=a(42);function o(e,t=i.IS_DEVELOPMENT){return s.assert(!e.startsWith("data/")),`${function(e){return e?"/data":"https://gznoclip1.b-cdn.net"}(t)}/${e}`}t.getDataURLForPath=o;class l{constructor(e,t,a){this.url=e,this.flags=t,this.abortedCallback=a,this.request=null,this.progress=0,this.ondone=null,this.onprogress=null,this.retriesLeft=2,this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}done(){this.progress=1,null!==this.onprogress&&this.onprogress(),null!==this.ondone&&this.ondone()}isConsidered404Error(){const e=this.request;return 404===e.status||0===e.status}resolveError(){const e=this.request;if(!!(1&this.flags)&&this.isConsidered404Error()){const e=new n.default(new ArrayBuffer(0));return e.name=this.url,this.resolve(e),this.done(),!0}return 200!==e.status&&(this.retriesLeft>0?(this.retriesLeft--,this.destroy(),this.start(),!0):(console.error(`DataFetcherRequest: Received non-success status code ${e.status} when fetching file ${this.url}.`),this.reject(null),this.done(),!0))}start(){this.request=new XMLHttpRequest,this.request.open("GET",this.url,!0),this.request.responseType="arraybuffer",this.request.send(),this.request.onload=e=>{if(!this.resolveError()){const e=this.request.response,t=new n.default(e);t.name=this.url,this.resolve(t),this.done()}},this.request.onerror=e=>{console.error("DataFetcherRequest: Received error",this,this.request,e),this.resolveError()},this.request.onprogress=e=>{e.lengthComputable&&(this.progress=e.loaded/e.total),null!==this.onprogress&&this.onprogress()}}destroy(){null!==this.request&&(this.request.onload=null,this.request.onerror=null,this.request.onprogress=null),this.request=null}abort(){null!==this.request&&this.request.abort(),null!==this.abortedCallback&&this.abortedCallback(),this.destroy()}}t.DataFetcher=class{constructor(e){this.progressMeter=e,this.requests=[],this.doneRequestCount=0,this.maxParallelRequests=2,this.aborted=!1,this.useDevelopmentStorage=null}async init(){if(i.IS_DEVELOPMENT){const e=o("",!0);try{await this.fetchURL(e),this.useDevelopmentStorage=!0}catch(e){this.useDevelopmentStorage=!1}}else this.useDevelopmentStorage=!1}abort(){this.aborted=!0;for(let e=0;e<this.requests.length;e++)this.requests[e].abort();this.requests=[]}reset(){this.aborted=!1}waitForLoad(){return Promise.all(this.requests.map(e=>e.promise))}calcProgress(){if(0===this.requests.length)return 1;let e=0;for(let t=0;t<this.requests.length;t++)e+=this.requests[t].progress;return e+=this.doneRequestCount,e/(this.requests.length+this.doneRequestCount)}setProgress(){this.progressMeter.setProgress(this.calcProgress())}pump(){for(let e=0;e<Math.min(this.requests.length,this.maxParallelRequests);e++)null===this.requests[e].request&&this.requests[e].start()}fetchURL(e,t=0,a=null){if(this.aborted)throw new Error("Tried to fetch new data while aborted; should not happen");const r=new l(e,t,a);return this.requests.push(r),r.ondone=()=>{this.doneRequestCount++,r.destroy(),this.requests.splice(this.requests.indexOf(r),1),this.pump()},r.onprogress=()=>{this.setProgress()},this.pump(),r.promise}fetchData(e,t=0,a=null){const r=o(e,s.assertExists(this.useDevelopmentStorage));return this.fetchURL(r,t,a)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(97)),i=a(0),o=n(a(15));class l{constructor(e){this.magic=e.getUint32(0),this.unk4=e.getUint32(4),this.unk8=e.getUint32(8),this.size=e.getUint32(12)}}function c(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}l.SIZE=16,t.loadRes=function(e){const t=e.createDataView().getUint32(0);switch(t){case c("ZLB\0"):return new o.default(function(e){const t=e.createDataView(),a=new l(t);if(a.magic!=c("ZLB\0"))throw Error(`Invalid magic identifier 0x${i.hexzero(a.magic,8)}`);return s.inflate(new Uint8Array(e.copyToBuffer(l.SIZE,a.size))).buffer}(e));case c("DIRn"):return new o.default(function(e){const t=e.createDataView().getUint32(8);return e.copyToBuffer(32,t)}(e));case c("LZOn"):return new o.default(function(e,t){const a=e.createDataView(),r=a.getUint32(t+8);t+=16;let n=0;const s=new Uint8Array(r);function i(e,r){const n=(1<<r)-1;let s=e&n;if(0==s){for(s=n;0==a.getUint8(t);)s+=255,t++;s+=a.getUint8(t++)}return s}let o=0;const l=a.getUint8(t++);if(l>=0&&l<=16){let e=i(l,4)+3;o=4;for(let r=0;r<e;r++)s[n++]=a.getUint8(t++)}else{if(17==l)throw Error("RLE compression mode not implemented");if(!(l>=18&&l<=21))throw Error("firstByte in 22..255 not handled");o=l-17;for(let e=0;e<o;e++)s[n++]=a.getUint8(t++)}for(;n<r;){const e=a.getUint8(t++);if(e>=128){const r=3&e;o=r;const i=e>>2&7,l=5+(e>>5&3);let c=n-((a.getUint8(t++)<<3)+i+1);for(let e=0;e<l;e++)s[n++]=s[c++];for(let e=0;e<r;e++)s[n++]=a.getUint8(t++)}else if(e>=64){const r=e>>2&7,i=3&e;o=i;const l=3+(e>>5&1);let c=n-((a.getUint8(t++)<<3)+r+1);for(let e=0;e<l;e++)s[n++]=s[c++];for(let e=0;e<i;e++)s[n++]=a.getUint8(t++)}else if(e>=32){const r=i(e,5)+2,l=a.getUint16(t,!0)>>2,c=3&a.getUint16(t,!0);t+=2,o=c;let h=n-(l+1);for(let e=0;e<r;e++)s[n++]=s[h++];for(let e=0;e<c;e++)s[n++]=a.getUint8(t++)}else if(e>=16){const r=i(e,3)+2,l=e>>3&1,c=a.getUint16(t,!0)>>2,h=3&a.getUint16(t,!0);t+=2;const d=16384+(l<<14)+c;if(o=h,16384==d)return s.buffer;let u=n-d;for(let e=0;e<r;e++)s[n++]=s[u++];for(let e=0;e<h;e++)s[n++]=a.getUint8(t++)}else if(0==o){const r=i(e,4)+3;o=4;for(let e=0;e<r;e++)s[n++]=a.getUint8(t++)}else if(o>=1&&o<=3){const r=3&e,i=e>>2&3,l=2;o=r;let c=n-((a.getUint8(t++)<<2)+i+1);for(let e=0;e<l;e++)s[n++]=s[c++];for(let e=0;e<r;e++)s[n++]=a.getUint8(t++)}else if(4==o){const r=3&e;o=r;const i=3,l=e>>2;let c=n-((a.getUint8(t++)<<2)+l+2049);for(let e=0;e<i;e++)s[n++]=s[c++];for(let e=0;e<r;e++)s[n++]=a.getUint8(t++)}}return s.buffer}(e,0));default:return console.warn(`Invalid magic identifier 0x${i.hexzero(t,8)}`),e}},t.getSubdir=function(e,t){if(void 0===t.subdirs[e])throw Error(`Subdirectory for location ${e} unknown`);return t.subdirs[e]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataSubarray=function(e,t,a){return new DataView(e.buffer,e.byteOffset+t,a)},t.interpS16=function(e){const t=new Uint16Array(1),a=new Int16Array(t.buffer);return t[0]=65535&e,a[0]};t.LowBitReader=class{constructor(e,t=0){this.dv=e,this.offs=t,this.num=0,this.buf=0}peek(e){for(;this.num<e;)this.buf|=this.dv.getUint8(this.offs)<<this.num,this.offs++,this.num+=8;return this.buf&(1<<e)-1}drop(e){this.peek(e),this.buf>>>=e,this.num-=e}get(e){const t=this.peek(e);return this.drop(e),t}},t.createDownloadLink=function(e,t,a){const r=document.createElement("a");return r.href=URL.createObjectURL(new Blob([e.createDataView()],{type:"application/octet-stream"})),r.download=t,void 0!==a&&r.append(a),r}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(325));let s=null;class i{constructor(e){if(!e)throw new Error("cannot construct NULL object");this.p=e}get ptr(){if(this.p)return this.p;throw new Error("use after free")}is(e){return this.ptr===e.ptr}delete(){delete this.p}static string(e){return function(e){let t=0;for(;t<e.length&&e[t];)t++;return(new TextDecoder).decode(e.subarray(0,t))}(s.HEAPU8.subarray(e))}static uint8Array(e,t){return e?s.HEAPU8.subarray(e,e+t):null}static uint16Array(e,t){if(!e)return null;let a=e/2;return s.HEAPU16.subarray(a,a+t)}static uint32Array(e,t){if(!e)return null;let a=e/4;return s.HEAPU32.subarray(a,a+t)}static float32Array(e,t){if(!e)return null;let a=e/4;return s.HEAPF32.subarray(a,a+t)}}var o,l,c;t.CObject=i,function(e){e[e.PLATFORM_NULL=0]="PLATFORM_NULL",e[e.PLATFORM_GL=2]="PLATFORM_GL",e[e.PLATFORM_PS2=4]="PLATFORM_PS2",e[e.PLATFORM_XBOX=5]="PLATFORM_XBOX",e[e.PLATFORM_D3D8=8]="PLATFORM_D3D8",e[e.PLATFORM_D3D9=9]="PLATFORM_D3D9"}(t.Platform||(t.Platform={})),function(e){e[e.ID_NAOBJECT=0]="ID_NAOBJECT",e[e.ID_STRUCT=1]="ID_STRUCT",e[e.ID_STRING=2]="ID_STRING",e[e.ID_EXTENSION=3]="ID_EXTENSION",e[e.ID_CAMERA=5]="ID_CAMERA",e[e.ID_TEXTURE=6]="ID_TEXTURE",e[e.ID_MATERIAL=7]="ID_MATERIAL",e[e.ID_MATLIST=8]="ID_MATLIST",e[e.ID_WORLD=11]="ID_WORLD",e[e.ID_MATRIX=13]="ID_MATRIX",e[e.ID_FRAMELIST=14]="ID_FRAMELIST",e[e.ID_GEOMETRY=15]="ID_GEOMETRY",e[e.ID_CLUMP=16]="ID_CLUMP",e[e.ID_LIGHT=18]="ID_LIGHT",e[e.ID_ATOMIC=20]="ID_ATOMIC",e[e.ID_TEXTURENATIVE=21]="ID_TEXTURENATIVE",e[e.ID_TEXDICTIONARY=22]="ID_TEXDICTIONARY",e[e.ID_IMAGE=24]="ID_IMAGE",e[e.ID_GEOMETRYLIST=26]="ID_GEOMETRYLIST",e[e.ID_ANIMANIMATION=27]="ID_ANIMANIMATION",e[e.ID_RIGHTTORENDER=31]="ID_RIGHTTORENDER",e[e.ID_UVANIMDICT=43]="ID_UVANIMDICT",e[e.ID_SKYMIPMAP=272]="ID_SKYMIPMAP",e[e.ID_SKIN=278]="ID_SKIN",e[e.ID_HANIM=286]="ID_HANIM",e[e.ID_USERDATA=287]="ID_USERDATA",e[e.ID_MATFX=288]="ID_MATFX",e[e.ID_PDS=305]="ID_PDS",e[e.ID_ADC=308]="ID_ADC",e[e.ID_UVANIMATION=309]="ID_UVANIMATION",e[e.ID_MESH=1294]="ID_MESH",e[e.ID_NATIVEDATA=1296]="ID_NATIVEDATA",e[e.ID_VERTEXFMT=1297]="ID_VERTEXFMT",e[e.ID_RASTERGL=2562]="ID_RASTERGL",e[e.ID_RASTERPS2=2564]="ID_RASTERPS2",e[e.ID_RASTERXBOX=2565]="ID_RASTERXBOX",e[e.ID_RASTERD3D8=2568]="ID_RASTERD3D8",e[e.ID_RASTERD3D9=2569]="ID_RASTERD3D9",e[e.ID_RASTERWDGL=2571]="ID_RASTERWDGL",e[e.ID_RASTERGL3=2572]="ID_RASTERGL3",e[e.ID_DRIVER=2816]="ID_DRIVER"}(t.PluginID||(t.PluginID={}));class h extends i{}t.Stream=h;t.StreamMemory=class extends h{constructor(e){super(s._rw_StreamMemory_new());const t=e.byteLength;this.data=s._malloc(t),s.HEAPU8.set(e,this.data),s._rw_StreamMemory_open(this.ptr,this.data,t)}delete(){s._rw_StreamMemory_close(this.ptr),s._free(this.data),this.data=null,s._rw_StreamMemory_delete(this.ptr),super.delete()}};t.ChunkHeaderInfo=class extends i{constructor(e){if(super(s._rw_ChunkHeaderInfo_new()),!s._rw_readChunkHeaderInfo(e.ptr,this.ptr))throw new Error("rw::readChunkHeaderInfo failed")}get type(){return s._rw_ChunkHeaderInfo_type(this.ptr)}delete(){s._rw_ChunkHeaderInfo_delete(this.ptr),super.delete()}};t.TexDictionary=class extends i{constructor(e){super(s._rw_TexDictionary_streamRead(e.ptr))}setCurrent(){s._rw_TexDictionary_setCurrent(this.ptr)}get textures(){return new d(s._rw_TexDictionary_textures(this.ptr))}delete(){s._rw_TexDictionary_destroy(this.ptr),super.delete()}};class d extends i{get begin(){return this.end.next}get end(){return new u(s._rw_LinkList_end(this.ptr))}}t.LinkList=d;class u extends i{get next(){return new u(s._rw_LLLink_next(this.ptr))}}t.LLLink=u,function(e){e[e.NEAREST=1]="NEAREST",e[e.LINEAR=2]="LINEAR",e[e.MIPNEAREST=3]="MIPNEAREST",e[e.MIPLINEAR=4]="MIPLINEAR",e[e.LINEARMIPNEAREST=5]="LINEARMIPNEAREST",e[e.LINEARMIPLINEAR=6]="LINEARMIPLINEAR"}(o||(o={})),function(e){e[e.WRAP=1]="WRAP",e[e.MIRROR=2]="MIRROR",e[e.CLAMP=3]="CLAMP",e[e.BORDER=4]="BORDER"}(l||(l={}));class m extends i{static fromDict(e){return new m(s._rw_Texture_fromDict(e.ptr))}static setCreateDummies(e){s._rw_Texture_setCreateDummies(e?1:0)}static setLoadTextures(e){s._rw_Texture_setLoadTextures(e?1:0)}get name(){return i.string(s._rw_Texture_name(this.ptr))}get raster(){return new p(s._rw_Texture_raster(this.ptr))}get filter(){return s._rw_Texture_getFilter(this.ptr)}get addressU(){return s._rw_Texture_getAddressU(this.ptr)}get addressV(){return s._rw_Texture_getAddressV(this.ptr)}}t.Texture=m,m.FilterMode=o,m.Addressing=l,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.C1555=256]="C1555",e[e.C565=512]="C565",e[e.C4444=768]="C4444",e[e.LUM8=1024]="LUM8",e[e.C8888=1280]="C8888",e[e.C888=1536]="C888",e[e.D16=1792]="D16",e[e.D24=2048]="D24",e[e.D32=2304]="D32",e[e.C555=2560]="C555",e[e.AUTOMIPMAP=4096]="AUTOMIPMAP",e[e.PAL8=8192]="PAL8",e[e.PAL4=16384]="PAL4",e[e.MIPMAP=32768]="MIPMAP",e[e.D3DFMT_DXT1=827611204]="D3DFMT_DXT1",e[e.D3DFMT_DXT2=844388420]="D3DFMT_DXT2",e[e.D3DFMT_DXT3=861165636]="D3DFMT_DXT3",e[e.D3DFMT_DXT4=877942852]="D3DFMT_DXT4",e[e.D3DFMT_DXT5=894720068]="D3DFMT_DXT5"}(c||(c={}));class p extends i{static formatHasAlpha(e){return 0!==s._rw_Raster_formatHasAlpha(e)}get format(){return s._rw_Raster_format(this.ptr)}get platform(){return s._rw_Raster_platform(this.ptr)}toImage(){return new _(s._rw_Raster_toImage(this.ptr))}toD3dRaster(){return new g(s._rw_Raster_d3d(this.ptr))}}t.Raster=p,p.Format=c;class f extends i{get length(){return s._rw_RasterLevels_numlevels(this.ptr)}get format(){return s._rw_RasterLevels_format(this.ptr)}level(e){return new A(s._rw_RasterLevels_levels(this.ptr,e))}}t.RasterLevels=f;class A extends i{get width(){return s._rw_RasterLevels_Level_width(this.ptr)}get height(){return s._rw_RasterLevels_Level_height(this.ptr)}get size(){return s._rw_RasterLevels_Level_size(this.ptr)}get data(){return i.uint8Array(s._rw_RasterLevels_Level_data(this.ptr),this.size)}}t.RasterLevel=A;class g extends i{get texture(){return new f(s._rw_d3d_D3dRaster_texture(this.ptr))}get format(){return s._rw_d3d_D3dRaster_format(this.ptr)}get hasAlpha(){return 0!==s._rw_d3d_D3dRaster_hasAlpha(this.ptr)}get customFormat(){return 0!==s._rw_d3d_D3dRaster_customFormat(this.ptr)}}t.D3dRaster=g;class _ extends i{get bpp(){return s._rw_Image_bpp(this.ptr)}get depth(){return s._rw_Image_depth(this.ptr)}get width(){return s._rw_Image_width(this.ptr)}get height(){return s._rw_Image_height(this.ptr)}get pixels(){return i.uint8Array(s._rw_Image_pixels(this.ptr),this.bpp*this.width*this.height)}hasAlpha(){return 0!==s._rw_Image_hasAlpha(this.ptr)}unindex(){s._rw_Image_unindex(this.ptr)}delete(){s._rw_Image_destroy(this.ptr),super.delete()}}t.Image=_;class S extends i{static streamRead(e){return new S(s._rw_UVAnimDictionary_streamRead(e.ptr))}static set current(e){let t=null===e?0:e.ptr;s._rw_currentUVAnimDictionary_set(t)}get animations(){return new d(s._rw_UVAnimDictionary_animations(this.ptr))}delete(){s._rw_UVAnimDictionary_destroy(this.ptr),super.delete()}}t.UVAnimDictionary=S;class b extends i{static fromDict(e){return new b(s._rw_UVAnimDictEntry_fromDict(e.ptr))}get anim(){return new v(s._rw_UVAnimDictEntry_anim(this.ptr))}}t.UVAnimDictEntry=b;class v extends i{get duration(){return s._rw_Animation_duration(this.ptr)}get numFrames(){return s._rw_Animation_numFrames(this.ptr)}get numNodes(){return s._rw_Animation_getNumNodes(this.ptr)}get uv(){return new x(s._rw_UVAnimCustomData_get(this.ptr))}frame(e){return new w(s._rw_Animation_keyframes(this.ptr,e))}}t.Animation=v;class w extends i{get time(){return s._rw_UVAnimKeyFrame_time(this.ptr)}get uv(){return i.float32Array(s._rw_UVAnimKeyFrame_uv(this.ptr),6)}get prev(){return new w(s._rw_UVAnimKeyFrame_prev(this.ptr))}}t.UVAnimKeyFrame=w;class x extends i{get name(){return i.string(s._rw_UVAnimCustomData_name(this.ptr))}get channels(){return i.uint32Array(s._rw_UVAnimCustomData_nodeToUVChannel(this.ptr),8)}}t.UVAnimCustomData=x;class T extends i{interp(e){const t=s._rw_UVAnim_interp(this.ptr,e);return t?new y(t):null}}t.UVAnim=T;class y extends i{get currentAnim(){return new v(s._rw_AnimInterpolator_currentAnim(this.ptr))}}t.AnimInterpolator=y;class C extends i{static streamRead(e){return new C(s._rw_Clump_streamRead(e.ptr))}get atomics(){return new d(s._rw_Clump_atomics(this.ptr))}get frame(){return new U(s._rw_Clump_getFrame(this.ptr))}delete(){s._rw_Clump_destroy(this.ptr),super.delete()}}t.Clump=C;class M extends i{static fromClump(e){return new M(s._rw_Atomic_fromClump(e.ptr))}get frame(){return new U(s._rw_Atomic_getFrame(this.ptr))}get geometry(){return new k(s._rw_Atomic_geometry(this.ptr))}}t.Atomic=M;class U extends i{get name(){return i.string(s._gta_getNodeName(this.ptr))}}t.Frame=U;class k extends i{get numVertices(){return s._rw_Geometry_numVertices(this.ptr)}get numTexCoordSets(){return s._rw_Geometry_numTexCoordSets(this.ptr)}get colors(){return i.uint8Array(s._rw_Geometry_colors(this.ptr),4*this.numVertices)}get meshHeader(){return new I(s._rw_Geometry_meshHeader(this.ptr))}morphTarget(e){return new D(s._rw_Geometry_morphTargets(this.ptr,e))}texCoords(e){return i.float32Array(s._rw_Geometry_texCoords(this.ptr,e),2*this.numVertices)}}t.Geometry=k;class D extends i{get parent(){return new k(s._rw_MorphTarget_parent(this.ptr))}get vertices(){return i.float32Array(s._rw_MorphTarget_vertices(this.ptr),3*this.parent.numVertices)}get normals(){return i.float32Array(s._rw_MorphTarget_normals(this.ptr),3*this.parent.numVertices)}}t.MorphTarget=D;class I extends i{get numMeshes(){return s._rw_MeshHeader_numMeshes(this.ptr)}get tristrip(){return 0!=(1&s._rw_MeshHeader_flags(this.ptr))}mesh(e){return new R(s._rw_MeshHeader_getMeshes(this.ptr,e))}}t.MeshHeader=I;class R extends i{get numIndices(){return s._rw_Mesh_numIndices(this.ptr)}get indices(){return i.uint16Array(s._rw_Mesh_indices(this.ptr),this.numIndices)}get material(){return new B(s._rw_Mesh_material(this.ptr))}}t.Mesh=R;class B extends i{get texture(){let e=s._rw_Material_texture(this.ptr);return e?new m(e):null}get color(){return i.uint8Array(s._rw_Material_color(this.ptr),4)}get surfaceProps(){return new P(s._rw_Material_surfaceProps(this.ptr))}get uvAnim(){return new T(s._rw_Material_uvAnim(this.ptr))}}t.Material=B;class P extends i{get ambient(){return s._rw_SurfaceProperties_ambient(this.ptr)}get specular(){return s._rw_SurfaceProperties_specular(this.ptr)}get diffuse(){return s._rw_SurfaceProperties_diffuse(this.ptr)}}t.SurfaceProperties=P,t.init=function(e){return new Promise(t=>n.default(e).then(a=>{s=a,e.platform&&s._rw_platform_set(e.platform),s._rw_Engine_init(),e.gtaPlugins&&s._gta_attachPlugins(),s._rw_Engine_open(),s._rw_Engine_start(0),e.loadTextures&&m.setLoadTextures(e.loadTextures),t()}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r,n=a(24);!function(e){e.PENDING="PENDING",e.RESOLVED="RESOLVED",e.REJECTED="REJECTED"}(r||(r={}));var s=function(){function e(e){var t=this;this._state=r.PENDING,this._handlers=[],this._resolve=function(e){t._setResult(r.RESOLVED,e)},this._reject=function(e){t._setResult(r.REJECTED,e)},this._setResult=function(e,a){t._state===r.PENDING&&(Object(n.m)(a)?a.then(t._resolve,t._reject):(t._state=e,t._value=a,t._executeHandlers()))},this._attachHandler=function(e){t._handlers=t._handlers.concat(e),t._executeHandlers()},this._executeHandlers=function(){t._state!==r.PENDING&&(t._state===r.REJECTED?t._handlers.forEach((function(e){e.onrejected&&e.onrejected(t._value)})):t._handlers.forEach((function(e){e.onfulfilled&&e.onfulfilled(t._value)})),t._handlers=[])};try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}return e.prototype.toString=function(){return"[object SyncPromise]"},e.resolve=function(t){return new e((function(e){e(t)}))},e.reject=function(t){return new e((function(e,a){a(t)}))},e.all=function(t){return new e((function(a,r){if(Array.isArray(t))if(0!==t.length){var n=t.length,s=[];t.forEach((function(t,i){e.resolve(t).then((function(e){s[i]=e,0===(n-=1)&&a(s)})).then(null,r)}))}else a([]);else r(new TypeError("Promise.all requires an array as input."))}))},e.prototype.then=function(t,a){var r=this;return new e((function(e,n){r._attachHandler({onfulfilled:function(a){if(t)try{return void e(t(a))}catch(e){return void n(e)}else e(a)},onrejected:function(t){if(a)try{return void e(a(t))}catch(e){return void n(e)}else n(t)}})}))},e.prototype.catch=function(e){return this.then((function(e){return e}),e)},e.prototype.finally=function(t){var a=this;return new e((function(e,r){var n,s;return a.then((function(e){s=!1,n=e,t&&t()}),(function(e){s=!0,n=e,t&&t()})).then((function(){s?r(n):e(n)}))}))},e}()},,function(e,t,a){"use strict";var r=this&&this.__decorate||function(e,t,a,r){var n,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,r);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(s<3?n(i):s>3?n(t,a,i):n(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i};Object.defineProperty(t,"__esModule",{value:!0});const n=a(61),s=a(139),i=a(1),o=a(4),l=a(2),c=a(65),h=a(25),d=a(159),u=a(140),m=a(36),p=a(8),f=a(106),A=a(34),g=a(5),_=a(6),S=a(0),b=a(157),v=a(161),w=a(22),x=a(11);function T(e){return e.curTime>97.5&&e.curTime<292.5}function y(e){return e.curTime>277.5||e.curTime<112.5}function C(e){return Math.atan2(e[1],Math.hypot(e[2],e[0]))}t.dKyr__sun_arrival_check=T,t.dKyr_moon_arrival_check=y,t.dKyw_rain_set=function(e,t){e.rainCount=t,e.rainCountOrig=t};const M=new g.MaterialParams,U=new g.PacketParams;function k(e,t,a,r,n,s=M,o=U){a.setOnRenderInst(e,t.gfxRenderCache,r),r.setSamplerBindingsFromTextureMappings(s.m_TextureMapping);const l=a.allocateMaterialParams(r);a.fillMaterialParamsDataOnInst(r,l,s),r.allocateUniformBuffer(g.ub_PacketParams,g.u_PacketParamsBufferSize),i.mat4.copy(o.u_PosMtx[0],n.camera.viewMatrix),g.fillPacketParamsData(r.mapUniformBufferF32(g.ub_PacketParams),r.getUniformBufferOffset(g.ub_PacketParams),o),t.submitRenderInst(r)}t.dKankyo__CommonTextures=class{constructor(e){const t=e.resCtrl.getObjectRes(11,"Always",129);this.snowTexture=function(e,t,a,r,n,s,i,o=""){const l={name:o,width:a,height:r,format:n,wrapS:s,wrapT:i,minFilter:1,magFilter:1,data:t,lodBias:0,minLOD:0,maxLOD:100,mipCount:1,paletteData:null,paletteFormat:0},c=e.modelCache.device,h=e.modelCache.cache;return new m.BTIData(c,h,l)}(e,t,64,64,1,0,0)}destroy(e){this.snowTexture.destroy(e)}};const D=i.mat4.create(),I=i.vec3.create(),R=i.vec3.create(),B=i.vec3.create(),P=i.vec3.create(),E=i.vec3.create(),F=i.vec3.create(),V=i.vec4.create();class O{constructor(e){this.ddraw=new f.TDDraw,this.moonTextures=[],this.sunPos=i.vec3.create(),this.moonPos=i.vec3.create(),this.sunAlpha=0,this.moonAlpha=0,this.visibility=1,this.lenzflarePos=S.nArray(6,()=>i.vec3.create()),this.lenzflareAngle=0,this.distFalloff=0,this.hideLenz=!1,this.chkPoints=[i.vec2.fromValues(0,0),i.vec2.fromValues(-10,-20),i.vec2.fromValues(10,20),i.vec2.fromValues(-20,10),i.vec2.fromValues(20,-10)],this.peekZResults=S.nArray(5,()=>new v.PeekZResult),this.lensflareColor=o.colorNewCopy(o.White,80/255),this.lensflareBaseSize=960,this.lensflareCount=16,this.lensflareAngles=[b.uShortTo2PI(63498),b.uShortTo2PI(16747)],this.lensflareAngleSteps=[b.uShortTo2PI(4096),b.uShortTo2PI(7281)],this.lensflareSizes=[.1,1.1,.2,.4],this.lensflareWidth=b.uShortTo2PI(1600);const t=e.resCtrl;this.moonTextures.push(t.getObjectRes(7,"Always",135)),this.moonTextures.push(t.getObjectRes(7,"Always",136)),this.moonTextures.push(t.getObjectRes(7,"Always",137)),this.moonTextures.push(t.getObjectRes(7,"Always",138)),this.sunTexture=t.getObjectRes(7,"Always",134),this.lensHalfTexture=t.getObjectRes(7,"Always",130),this.ringHalfTexture=t.getObjectRes(7,"Always",133),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1);const a=new A.GXMaterialBuilder;a.setTexCoordGen(0,1,4,60),a.setTevOrder(0,0,0,7),a.setTevColorIn(0,4,2,8,15),a.setTevColorOp(0,0,0,0,!0,0),a.setTevAlphaIn(0,7,1,4,7),a.setTevAlphaOp(0,0,0,0,!0,0),a.setBlendMode(1,4,5),a.setZMode(!0,3,!1),a.setUsePnMtxIdx(!1),this.materialHelperSunMoon=new g.GXMaterialHelperGfx(a.finish("dKankyo_sun_packet")),g.setChanWriteEnabled(this.materialHelperSunMoon,8,!1),a.setZMode(!1,3,!1),this.materialHelperLenzflare=new g.GXMaterialHelperGfx(a.finish("dKankyo_lenzflare_packet textured")),g.setChanWriteEnabled(this.materialHelperLenzflare,8,!1),a.setChanCtrl(0,!1,0,0,0,2,2),a.setTevOrder(0,255,255,0),a.setTevColorIn(0,15,15,15,2),a.setTevColorOp(0,0,0,0,!0,0),a.setTevAlphaIn(0,7,7,7,1),a.setTevAlphaOp(0,0,0,0,!0,0),this.materialHelperLenzflareSolid=new g.GXMaterialHelperGfx(a.finish("dKankyo_lenzflare_packet solid")),g.setChanWriteEnabled(this.materialHelperLenzflareSolid,8,!1)}drawSquare(e,t,a,r,n,s,o=r){e.begin(128),i.vec3.set(I,n*-r,r,0),i.vec3.transformMat4(I,I,t),i.vec3.add(I,I,a),e.position3vec3(I),e.texCoord2f32(13,0*s,0*s),i.vec3.set(I,n*r,r,0),i.vec3.transformMat4(I,I,t),i.vec3.add(I,I,a),e.position3vec3(I),e.texCoord2f32(13,1*s,0*s),i.vec3.set(I,n*o,-o,0),i.vec3.transformMat4(I,I,t),i.vec3.add(I,I,a),e.position3vec3(I),e.texCoord2f32(13,1*s,1*s),i.vec3.set(I,n*-r,-r,0),i.vec3.transformMat4(I,I,t),i.vec3.add(I,I,a),e.position3vec3(I),e.texCoord2f32(13,0*s,1*s),e.end()}drawSunMoon(e,t,a,r){const s=e.modelCache.device,c=e.g_env_light;let h=this.sunAlpha>0,d=this.moonAlpha>0;const u=e.dStage_dt.stag.roomTypeAndSchBit>>>16&7;if(0===c.baseLight.color.r&&2!==u&&(c.curTime>285||c.curTime<105)&&(d=!1),!h&&!d)return;const m=C(e.cameraFwd);if(a.setCurrentRenderInstList(e.dlst.sky[1]),d){let h=n.dKy_get_dayofweek(c);c.curTime<180&&(h=(h+7-1)%7);const d=this.moonPos;0===c.baseLight.color.r&&2!==u?i.vec3.copy(d,this.sunPos):(i.vec3.sub(d,this.sunPos,e.cameraPosition),i.vec3.scaleAndAdd(d,e.cameraPosition,d,-1));const p=h<4?-1:1,f=h<4?h:7-h,A=C(d);for(let e=1;e>=0;e--){let n=700;if(1===e&&(n*=1.7),l.computeMatrixWithoutTranslation(D,r.camera.worldMatrix),i.mat4.rotateZ(D,D,.01745*(45+(A-m)/-8*360)),0===e)this.moonTextures[f].fillTextureMapping(M.m_TextureMapping[0]),o.colorFromRGBA8(M.u_Color[g.ColorKind.C0],4093613311),M.u_Color[g.ColorKind.C0].a*=this.moonAlpha,o.colorFromRGBA8(M.u_Color[g.ColorKind.C1],255),this.drawSquare(t,D,d,n,p,1);else{i.mat4.rotateZ(D,D,.8725*p),c.wetherCommonTextures.snowTexture.fillTextureMapping(M.m_TextureMapping[0]),o.colorFromRGBA8(M.u_Color[g.ColorKind.C0],4294954828),M.u_Color[g.ColorKind.C0].a*=this.moonAlpha,o.colorFromRGBA8(M.u_Color[g.ColorKind.C1],3312002047),M.u_Color[g.ColorKind.C1].a*=this.moonAlpha;let e=n;1===h||6===h?e*=.83:0!==h&&(e*=.6),this.drawSquare(t,D,d,n,p,1,e)}const u=t.makeRenderInst(s,a);k(s,a,this.materialHelperSunMoon,u,r)}}if(h){const e=this.sunPos,n=C(e);l.computeMatrixWithoutTranslation(D,r.camera.worldMatrix),i.mat4.rotateZ(D,D,.01745*((n-m)/-8*360-50));let h=575;this.visibility>0&&(h+=500*this.visibility*$(1-this.distFalloff));for(let n=1;n>=0;n--){let i=h;1===n&&(i*=1.6),0===n?this.sunTexture.fillTextureMapping(M.m_TextureMapping[0]):c.wetherCommonTextures.snowTexture.fillTextureMapping(M.m_TextureMapping[0]),o.colorFromRGBA8(M.u_Color[g.ColorKind.C0],4294963711),M.u_Color[g.ColorKind.C0].a=this.sunAlpha,o.colorFromRGBA8(M.u_Color[g.ColorKind.C1],4287693055),this.drawSquare(t,D,e,i,1,1);const l=t.makeRenderInst(s,a);k(s,a,this.materialHelperSunMoon,l,r)}}}drawLenzflare(e,t,a,r){if(this.visibility<=.1)return;const n=e.modelCache.device,s=e.g_env_light;l.computeMatrixWithoutTranslation(D,r.camera.worldMatrix),this.hideLenz?a.setCurrentRenderInstList(e.dlst.sky[1]):a.setCurrentRenderInstList(e.dlst.wetherEffect);const c=1-this.distFalloff,h=.6+.8*this.visibility*$(c),d=300*h,u=this.lensflareBaseSize*h*(3+c),m=$(this.visibility);let p=this.lensflareAngles[0],f=this.lensflareAngles[1];for(let e=0;e<this.lensflareCount;e++){let a;t.begin(144),a=0!=(1&e)?p:f;const r=Math.abs(Math.sin(34*a)),n=this.lensflareWidth*(.5+r),s=a+n;i.vec3.set(I,d*Math.sin(s),d*Math.cos(s),0),i.vec3.transformMat4(I,I,D),i.vec3.add(I,I,this.sunPos),t.position3vec3(I),t.texCoord2f32(13,0,0);const o=3&e;let l=(.6+.4*r)*u*(1.5*this.visibility);0!==o&&(l*=.2);const c=this.lensflareSizes[o],h=l*(this.visibility*($(this.visibility)+c));i.vec3.set(I,h*Math.sin(a),h*Math.cos(a),0),i.vec3.transformMat4(I,I,D),i.vec3.add(I,I,this.sunPos),t.position3vec3(I),t.texCoord2f32(13,0,0),p+=this.lensflareAngleSteps[0],f+=this.lensflareAngleSteps[1];const m=a-n;i.vec3.set(I,d*Math.sin(m),d*Math.cos(m),0),i.vec3.transformMat4(I,I,D),i.vec3.add(I,I,this.sunPos),t.position3vec3(I),t.texCoord2f32(13,0,0),t.end()}o.colorCopy(M.u_Color[g.ColorKind.C0],this.lensflareColor);const A=t.makeRenderInst(n,a);k(n,a,this.materialHelperLenzflareSolid,A,r),i.mat4.rotateZ(D,D,this.lenzflareAngle);const _=[255,80,140,255,125,140,170,140],S=[8e3,1e4,1600,4800,1200,5600,2400,7200];for(let e=7;e>=0;e--){if(this.hideLenz&&0!==e)continue;let i,l,h=m*_[e]/255;e>=2&&(h*=.8*this.distFalloff),i=e>=2?.08*c*this.visibility*S[e]:(.04+.075*this.visibility)*S[e]+.2*this.visibility*S[e]*$(c),l=e>=2?this.lenzflarePos[e-2]:this.sunPos;const d=1,u=0===e?1:2;this.drawSquare(t,D,l,i,d,u);const p=t.makeRenderInst(n,a);0===e?s.wetherCommonTextures.snowTexture.fillTextureMapping(M.m_TextureMapping[0]):1===e?this.ringHalfTexture.fillTextureMapping(M.m_TextureMapping[0]):e>=2&&this.lensHalfTexture.fillTextureMapping(M.m_TextureMapping[0]),o.colorFromRGBA8(M.u_Color[g.ColorKind.C0],4294963711),M.u_Color[g.ColorKind.C0].a*=h,o.colorFromRGBA8(M.u_Color[g.ColorKind.C1],4287711518),k(n,a,this.materialHelperLenzflare,p,r)}}draw(e,t,a){const r=e.modelCache.device;this.ddraw.beginDraw(),this.ddraw.allocVertices(2048),this.drawLenzflare(e,this.ddraw,t,a),this.drawSunMoon(e,this.ddraw,t,a),this.ddraw.endAndUpload(r,t)}destroy(e){this.ddraw.destroy(e)}}r([x.dfShow()],O.prototype,"lensflareColor",void 0),r([x.dfRange(0,1600,1)],O.prototype,"lensflareBaseSize",void 0),r([x.dfRange(0,32,1)],O.prototype,"lensflareCount",void 0),r([x.dfRange(0,6.283,1e-4)],O.prototype,"lensflareAngles",void 0),r([x.dfRange(0,.8,1e-4)],O.prototype,"lensflareAngleSteps",void 0),r([x.dfRange(-5,5)],O.prototype,"lensflareSizes",void 0),r([x.dfRange(0,6.283,1e-4)],O.prototype,"lensflareWidth",void 0),t.dKankyo_sun_Packet=O;class N{constructor(){this.position=i.vec3.create();const e=s.cM_rndF(6.283);let t=s.cM_rndF(18e3);t>15e3&&(t=14e3+s.cM_rndF(1e3)),this.position[0]=t*Math.sin(e),this.position[2]=t*Math.cos(e),this.alpha=0,this.speed=.5+s.cM_rndF(4),this.height=.3*s.cM_rndFX(.3)}}class L{constructor(e){this.enabled=!1,this.count=0,this.strength=0,this.instances=S.nArray(100,()=>new N),this.bounceAnimTimer=0,this.ddraw=new f.TDDraw,this.textures=[];const t=e.resCtrl.getStageResByName(7,"Stage","cloudtx_01.bti");if(null===t)return;this.textures.push(t),this.textures.push(S.assertExists(e.resCtrl.getStageResByName(7,"Stage","cloudtx_02.bti"))),this.textures.push(S.assertExists(e.resCtrl.getStageResByName(7,"Stage","cloudtx_03.bti"))),this.enabled=!0,this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(11,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,11,1),this.ddraw.setVtxAttrFmt(0,13,1);const a=new A.GXMaterialBuilder;a.setChanCtrl(4,!1,0,1,0,0,2),a.setTexCoordGen(0,1,4,60),a.setTevOrder(0,0,0,0),a.setTevColorIn(0,4,10,8,15),a.setTevColorOp(0,0,0,0,!0,0),a.setTevAlphaIn(0,7,5,4,7),a.setTevAlphaOp(0,0,0,0,!0,0),a.setBlendMode(1,4,5),a.setZMode(!0,3,!1),a.setUsePnMtxIdx(!1),this.materialHelper=new g.GXMaterialHelperGfx(a.finish("dKankyo_vrkumo_packet")),g.setChanWriteEnabled(this.materialHelper,8,!1)}draw(e,t,a){const r=e.modelCache.device;S.assert(this.textures.length>0);const n=e.g_env_light,s=e.dStage_dt.stag.farPlane-1e4,l=this.ddraw;t.setCurrentRenderInstList(e.dlst.sky[1]),l.beginDraw(),l.allocPrimitives(128,1200),o.colorFromRGBA(M.u_Color[g.ColorKind.C1],0,0,0,0);for(let c=2;c>=0;c--){this.textures[c].fillTextureMapping(M.m_TextureMapping[0]),l.begin(128);for(let t=0;t<this.instances.length;t++){const a=this.instances[t];if(a.alpha<=1e-6)continue;const r=a.distFalloff*(1-Math.pow(1*(c+t&15)/16,3))*(.45+.55*this.strength),h=r+.06*r*Math.sin(c+1e-4*this.bounceAnimTimer)*a.distFalloff,d=h+h*a.height,u=.15*h,m=.65*h;let p=0,f=0;if(0!==c){const e=3&t;0===e?2===c&&(p=m,f=u):1===e?1===c?(p=-u,f=u):2===c&&(p=-m,f=m):2===e?1===c?(p=m,f=-m):2===c&&(p=u,f=-m):3===e&&(1===c?p=-m:2===c&&(p=-u,f=u))}const A=Math.atan2(a.position[1],Math.hypot(a.position[0],a.position[2]))+p,_=Math.pow(Math.min(A/1.9,1),3),S=Math.atan2(a.position[0],a.position[2])+f,b=.6*h*(1+16*_),v=.6*h*(1+2*_),w=Math.min(A+.9*d*(1+-4*_),1.21);let x=0,T=0,y=0;o.colorLerp(M.u_Color[g.ColorKind.C0],n.vrKumoCol,n.vrKumoCenterCol,a.distFalloff),M.u_Color[g.ColorKind.C0].a=a.alpha,x=Math.cos(w)*Math.sin(S+b),T=Math.sin(w),y=Math.cos(w)*Math.cos(S+b),i.vec3.set(I,x*s,T*s,y*s),i.vec3.add(I,I,e.cameraPosition),l.position3vec3(I),l.color4color(11,M.u_Color[g.ColorKind.C0]),l.texCoord2f32(13,0,0),x=Math.cos(w)*Math.sin(S-b),T=Math.sin(w),y=Math.cos(w)*Math.cos(S-b),i.vec3.set(I,x*s,T*s,y*s),i.vec3.add(I,I,e.cameraPosition),l.position3vec3(I),l.color4color(11,M.u_Color[g.ColorKind.C0]),l.texCoord2f32(13,1,0),x=Math.cos(A)*Math.sin(S-v),T=Math.sin(A),y=Math.cos(A)*Math.cos(S-v),i.vec3.set(I,x*s,T*s,y*s),i.vec3.add(I,I,e.cameraPosition),l.position3vec3(I),l.color4color(11,M.u_Color[g.ColorKind.C0]),l.texCoord2f32(13,1,1),x=Math.cos(A)*Math.sin(S+v),T=Math.sin(A),y=Math.cos(A)*Math.cos(S+v),i.vec3.set(I,x*s,T*s,y*s),i.vec3.add(I,I,e.cameraPosition),l.position3vec3(I),l.color4color(11,M.u_Color[g.ColorKind.C0]),l.texCoord2f32(13,0,1)}l.end();const h=l.makeRenderInst(r,t);k(r,t,this.materialHelper,h,a)}l.endAndUpload(r,t)}destroy(e){this.ddraw.destroy(e)}}t.dKankyo_vrkumo_Packet=L;class G{constructor(){this.initialized=!1,this.alpha=0,this.timer=0,this.basePos=i.vec3.create(),this.pos=i.vec3.create(),this.minY=0}}class H{constructor(e){this.ddraw=new f.TDDraw,this.sibukiAlpha=0,this.offsets=[i.vec3.fromValues(150,0,0),i.vec3.fromValues(0,150,150),i.vec3.fromValues(150,320,150),i.vec3.fromValues(45,480,45)],this.instances=S.nArray(250,()=>new G),this.rainCount=0,this.camEyePos=i.vec3.create(),this.centerDelta=i.vec3.create(),this.centerDeltaMul=0,this.sibukiHidden=!1;const t=e.resCtrl;this.ringTexture=t.getObjectRes(7,"Always",133),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1);const a=new A.GXMaterialBuilder;a.setTexCoordGen(0,1,4,60),a.setTevOrder(0,0,0,7),a.setTevColorIn(0,4,2,8,15),a.setTevColorOp(0,0,0,0,!0,0),a.setTevAlphaIn(0,7,1,4,7),a.setTevAlphaOp(0,0,0,0,!0,0),a.setBlendMode(1,4,5),a.setZMode(!0,3,!1),a.setUsePnMtxIdx(!1),this.materialHelperRain=new g.GXMaterialHelperGfx(a.finish("dKankyo_rain_packet")),g.setChanWriteEnabled(this.materialHelperRain,8,!1),a.setZMode(!0,6,!1),this.materialHelperSibuki=new g.GXMaterialHelperGfx(a.finish("dKankyo_rain_packet sibuki")),g.setChanWriteEnabled(this.materialHelperSibuki,8,!1)}drawRain(e,t,a){const r=e.modelCache.device,n=e.g_env_light,s=this.ddraw;l.computeMatrixWithoutTranslation(D,a.camera.worldMatrix),t.setCurrentRenderInstList(e.dlst.wetherEffect),o.colorFromRGBA8(M.u_Color[g.ColorKind.C1],2155905034),n.wetherCommonTextures.snowTexture.fillTextureMapping(M.m_TextureMapping[0]);const c=14*this.instances[0].alpha/255;o.colorFromRGBA(M.u_Color[g.ColorKind.C0],1,1,1,c);for(let t=0;t<this.rainCount;t++){const a=this.instances[t];if(a.alpha<=.001)continue;const r=2.5+t/250;i.vec3.set(P,-r,0,0),i.vec3.transformMat4(P,P,D),i.vec3.set(E,r,0,0),i.vec3.transformMat4(E,E,D),i.vec3.add(I,a.basePos,a.pos);const o=i.vec3.distance(I,e.cameraPosition);i.vec3.add(P,P,I),i.vec3.add(E,E,I),ce(I,n);const l=5+70*Math.min(.1+o/1500),c=7&t;i.vec3.set(I,l*(I[0]+10*this.centerDelta[0]*this.centerDeltaMul+.08*c),l*(-2+I[1]+this.centerDelta[1]*this.centerDeltaMul),l*(I[2]+10*this.centerDelta[2]*this.centerDeltaMul+.08*c)),i.vec3.sub(R,E,I),i.vec3.sub(B,P,I),s.begin(128,20*this.rainCount);for(let e=0;e<4;e++)i.vec3.add(I,R,this.offsets[e]),s.position3vec3(I),s.texCoord2f32(13,0,0),i.vec3.add(I,B,this.offsets[e]),s.position3vec3(I),s.texCoord2f32(13,1,0),i.vec3.add(I,P,this.offsets[e]),s.position3vec3(I),s.texCoord2f32(13,1,1),i.vec3.add(I,E,this.offsets[e]),s.position3vec3(I),s.texCoord2f32(13,0,1);s.end()}const h=s.makeRenderInst(r,t);k(r,t,this.materialHelperRain,h,a)}drawSibuki(e,t,a){const r=e.modelCache.device,n=e.g_env_light,l=this.ddraw,c=this.sibukiHidden?0:200/255;let h;this.sibukiAlpha=s.cLib_addCalc(this.sibukiAlpha,c,.2,3,.001),h=e.cameraFwd[1]>0&&e.cameraFwd[1]<.5?1-e.cameraFwd[1]/.5:e.cameraFwd[1]>0?0:1;const d=this.sibukiAlpha*h;if(d<=.001)return;t.setCurrentRenderInstList(e.dlst.wetherEffect),o.colorFromRGBA8(M.u_Color[g.ColorKind.C0],3033057280),M.u_Color[g.ColorKind.C0].a=d,o.colorCopy(M.u_Color[g.ColorKind.C1],M.u_Color[g.ColorKind.C0]),this.ringTexture.fillTextureMapping(M.m_TextureMapping[0]);const u=n.rainCount>>>1;ee(e,I,7e3,4e3),l.begin(128,4*u);for(let e=0;e<u;e++){const e=20+0*s.cM_rndF(25),t=I[0]+s.cM_rndFX(3600),a=I[1]+s.cM_rndFX(1500),r=I[2]+s.cM_rndFX(3600);i.vec3.set(R,t-e,a,r-e),l.position3vec3(R),l.texCoord2f32(13,0,0),i.vec3.set(R,t+e,a,r-e),l.position3vec3(R),l.texCoord2f32(13,2,0),i.vec3.set(R,t+e,a,r+e),l.position3vec3(R),l.texCoord2f32(13,2,2),i.vec3.set(R,t-e,a,r+e),l.position3vec3(R),l.texCoord2f32(13,0,2)}l.end();const m=l.makeRenderInst(r,t);k(r,t,this.materialHelperSibuki,m,a)}draw(e,t,a){const r=e.modelCache.device;0!==e.g_env_light.rainCount&&(this.ddraw.beginDraw(),this.drawRain(e,t,a),this.drawSibuki(e,t,a),this.ddraw.endAndUpload(r,t))}destroy(e){this.ddraw.destroy(e)}}t.dKankyo_rain_Packet=H;class j{constructor(){this.emitter=null,this.state=0,this.swerveAngleXZ=0,this.swerveAngleY=0,this.alpha=0,this.loopDeLoopCounter=0,this.swerveAnimCounter=0,this.doLoopDeLoop=!1,this.stateTimer=0,this.basePos=i.vec3.create(),this.animPos=i.vec3.create()}}class W{constructor(){this.windEff=S.nArray(50,()=>new j),this.count=0,this.frameCounter=0,this.hasCustomWindPower=!1}}t.dKankyo__Windline=W;class Z{constructor(){this.initialized=!1,this.basePos=i.vec3.create(),this.pos=i.vec3.create(),this.animCounter=0,this.alpha=0,this.strengthEnv=0,this.scale=0,this.speed=0,this.animCounterSpeed=0}}class z{constructor(e){this.instances=S.nArray(300,()=>new Z),this.ddraw=new f.TDDraw,this.skewDirection=0,this.skewWidth=0;const t=e.resCtrl;this.texUsonami=t.getObjectRes(7,"Always",139),this.texUsonamiM=t.getObjectRes(7,"Always",140),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxDesc(11,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1),this.ddraw.setVtxAttrFmt(0,11,1);const a=new A.GXMaterialBuilder;a.setChanCtrl(2,!1,0,1,0,0,2),a.setTexCoordGen(0,1,4,60),a.setTevOrder(0,0,0,0),a.setTevColorIn(0,2,14,8,15),a.setTevColorOp(0,0,0,0,!0,0),a.setTevAlphaIn(0,7,5,4,7),a.setTevAlphaOp(0,0,0,0,!0,0),a.setTevKColorSel(0,12),a.setBlendMode(1,4,5),a.setAlphaCompare(4,0,0,4,0),a.setZMode(!0,3,!0),a.setUsePnMtxIdx(!1),a.setFog(2,!0),this.materialHelper=new g.GXMaterialHelperGfx(a.finish("dKankyo_wave_Packet")),g.setChanWriteEnabled(this.materialHelper,8,!1)}draw(e,t,a){const r=e.modelCache.device,s=e.g_env_light;if(0===s.waveCount||s.waveFlatInter>=1)return;const o=this.ddraw;l.computeMatrixWithoutTranslation(D,a.camera.worldMatrix),t.setCurrentRenderInstList(e.dlst.wetherEffect),n.dKy_get_seacolor(s,M.u_Color[g.ColorKind.K0],M.u_Color[g.ColorKind.C0]),"MajyuE"===e.stageName?this.texUsonamiM.fillTextureMapping(M.m_TextureMapping[0]):this.texUsonami.fillTextureMapping(M.m_TextureMapping[0]),n.dKy_GxFog_sea_set(s,M.u_FogBlock,a.camera),this.ddraw.beginDraw(),o.begin(128,4*s.waveCount);for(let e=0;e<s.waveCount;e++){const t=this.instances[e],a=Math.sin(t.animCounter);if(a<0)continue;const r=255*t.alpha,n=t.scale*s.waveScale,l=n*a*t.strengthEnv,c=n*s.waveScaleBottom*(t.strengthEnv-15e-8*l*(15*e)),h=(this.skewDirection>=0?1:-1)*this.skewWidth*c*1.2*t.speed;i.vec3.add(R,t.basePos,t.pos),i.vec3.set(I,-c+h,l,0),i.vec3.transformMat4(I,I,D),i.vec3.add(I,I,R),o.position3vec3(I),o.color4rgba8(11,0,0,0,r),o.texCoord2f32(13,0,0),i.vec3.set(I,c+h,l,0),i.vec3.transformMat4(I,I,D),i.vec3.add(I,I,R),o.position3vec3(I),o.color4rgba8(11,0,0,0,r),o.texCoord2f32(13,250/255,0),i.vec3.set(I,c,0,0),i.vec3.transformMat4(I,I,D),i.vec3.add(I,I,R),o.position3vec3(I),o.color4rgba8(11,0,0,0,r),o.texCoord2f32(13,250/255,250/255),i.vec3.set(I,-c,0,0),i.vec3.transformMat4(I,I,D),i.vec3.add(I,I,R),o.position3vec3(I),o.color4rgba8(11,0,0,0,r),o.texCoord2f32(13,0,250/255)}o.end();const c=o.makeRenderInst(r,t);k(r,t,this.materialHelper,c,a),this.ddraw.endAndUpload(r,t)}destroy(e){this.ddraw.destroy(e)}}t.dKankyo_wave_Packet=z;class K{constructor(){this.animCounter=0,this.animWave=0}}class X{constructor(e){this.instances=S.nArray(1,()=>new K),this.rot=0,this.hokuto_pos=[i.vec3.fromValues(13e3,10500,-16e3),i.vec3.fromValues(9400,9800,-12646),i.vec3.fromValues(10200,11800,-13525),i.vec3.fromValues(10300,13450,-13525),i.vec3.fromValues(15e3,18400,-16162),i.vec3.fromValues(12500,19800,-15e3),i.vec3.fromValues(9179,17200,-14404),i.vec3.fromValues(9500,9800,-12646),i.vec3.fromValues(-7421,31005,18798),i.vec3.fromValues(-10937,28e3,15e3),i.vec3.fromValues(-1e4,24902,18400),i.vec3.fromValues(-9400,22500,15900),i.vec3.fromValues(-9179,21300,14300),i.vec3.fromValues(-10300,22e3,21e3),i.vec3.fromValues(-16e3,25500,2e4),i.vec3.fromValues(0,3e4,19e3)],this.star_col=[o.colorNewFromRGBA8(3706257407),o.colorNewFromRGBA8(4291348735),o.colorNewFromRGBA8(4294953215),o.colorNewFromRGBA8(3368615935)],this.ddraw=new f.TDDraw,this.renderInMain=!1,this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(11,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,11,1);const t=new A.GXMaterialBuilder;t.setChanCtrl(4,!1,0,1,0,0,2),t.setTevOrder(0,255,255,0),t.setTevColorIn(0,15,15,15,10),t.setTevColorOp(0,0,0,0,!0,0),t.setTevAlphaIn(0,7,7,7,5),t.setTevAlphaOp(0,0,0,0,!0,0),t.setZMode(!0,3,!1),t.setBlendMode(1,4,5),t.setAlphaCompare(4,0,0,4,0),t.setUsePnMtxIdx(!1),this.materialHelper=new g.GXMaterialHelperGfx(t.finish("dKankyo_star_Packet")),g.setChanWriteEnabled(this.materialHelper,8,!1)}draw(e,t,a){const r=e.modelCache.device,s=e.g_env_light;if(0===s.starCount)return;const o=this.ddraw;this.renderInMain?t.setCurrentRenderInstList(e.dlst.main[1]):t.setCurrentRenderInstList(e.dlst.sky[1]),n.dKy_GxFog_sea_set(s,M.u_FogBlock,a.camera),this.ddraw.beginDraw(),o.begin(144,4*s.waveCount);const c=this.instances[0];i.vec3.set(B,0,.9,0),i.vec3.set(P,.9,-.45,0),i.vec3.set(E,-.9,-.45,0),l.computeMatrixWithoutTranslation(D,a.camera.worldMatrix),i.mat4.rotateZ(D,D,.01745*this.rot),i.vec3.transformMat4(B,B,D),i.vec3.transformMat4(P,P,D),i.vec3.transformMat4(E,E,D),Q(F,s.moonPos,a);let h=0,d=-Math.PI,u=0;for(let t=0;t<s.starCount;t++){let r;if(t<this.hokuto_pos.length){const e=(t<8?190:290)+c.animWave;r=e-0*e,i.vec3.copy(R,this.hokuto_pos[t])}else{r=c.animWave+.066*(15&t),r>1&&(r=1-(r-1));const e=1-h/202;R[0]=-300*e*Math.sin(d),R[1]=h+45,R[2]=300*e*Math.cos(d),d+=u,u+=b.uShortTo2PI(2500),h+=1+3*Math.pow(h/200,3),h>200&&(h=20*t/1e3)}if(i.vec3.add(R,R,e.cameraPosition),Q(I,R,a),i.vec3.dist(I,F)<80)continue;let n;n=6===t||8===t?1:0==(63&t)?t>>>4&3:0;const s=this.star_col[n];i.vec3.scaleAndAdd(I,R,B,r),o.position3vec3(I),o.color4color(11,s),i.vec3.scaleAndAdd(I,R,P,r),o.position3vec3(I),o.color4color(11,s),i.vec3.scaleAndAdd(I,R,E,r),o.position3vec3(I),o.color4color(11,s),i.vec3.scaleAndAdd(I,R,B,-r),o.position3vec3(I),o.color4color(11,s),i.vec3.scaleAndAdd(I,R,P,-r),o.position3vec3(I),o.color4color(11,s),i.vec3.scaleAndAdd(I,R,E,-r),o.position3vec3(I),o.color4color(11,s)}o.end();const m=o.makeRenderInst(r,t);k(r,t,this.materialHelper,m,a),this.ddraw.endAndUpload(r,t)}destroy(e){this.ddraw.destroy(e)}}function Y(e,t,a){i.vec3.sub(a,t,e),i.vec3.normalize(a,a)}function $(e){return e*e}function q(e,t,a,r=V){i.vec4.set(r,t[0],t[1],t[2],1),i.vec4.transformMat4(r,r,a.clipFromWorldMatrix),p.divideByW(r,r),i.vec3.set(e,r[0],r[1],r[2])}function Q(e,t,a){q(e,t,a.camera),e[0]=(.5*e[0]+.5)*a.viewport.w*a.backbufferWidth,e[1]=(.5*e[1]+.5)*a.viewport.h*a.backbufferHeight,e[2]=0}function J(e,t,a,r){if(t.newData(e,a[0]+r[0]*(1/640),a[1]+r[1]*(1/480)),e.triviallyCulled)return 2;if(null===e.value)return 0;const n=.5*a[2]+.5;return w.compareDepthValues(n,e.value,_.GfxCompareMode.LESS)?0:1}function ee(e,t,a,r=a){t[0]=e.cameraPosition[0]+e.cameraFwd[0]*a,t[1]=e.cameraPosition[1]+e.cameraFwd[1]*r-200,t[2]=e.cameraPosition[2]+e.cameraFwd[2]*a}function te(e,t,a,r=a){i.vec3.copy(t,e.cameraFwd),0===r&&(t[1]=0),i.vec3.normalize(t,t),t[0]=e.cameraPosition[0]+t[0]*a,t[1]=e.cameraPosition[1]+t[1]*a,t[2]=e.cameraPosition[2]+t[2]*a}function ae(e){const t=e.g_env_light;t.thunderActive?function(e,t,a){const r=t.thunderState<10;if(0===t.thunderState?(t.thunderFlashTimer=0,s.cM_rndF(1)>.007?t.thunderMode<10&&s.cM_rndF(1)<.005&&(i.vec3.copy(t.thunderLightInfluence.pos,a),o.colorFromRGBA(t.thunderLightInfluence.color,0,0,0),t.thunderLightInfluence.power=9e4,t.thunderLightInfluence.fluctuation=150,n.dKy_efplight_set(t,t.thunderLightInfluence),t.thunderState=1):t.thunderState=11):1===t.thunderState||11===t.thunderState?(t.thunderFlashTimer=s.cLib_addCalc(t.thunderFlashTimer,1,.3,.2,.001),t.thunderFlashTimer>=1&&t.thunderState++,s.cM_rndF(1)<.18&&c.fopKyM_create(e.frameworkGlobals,441,-1,null,null)):2!==t.thunderState&&12!==t.thunderState||(t.thunderFlashTimer=s.cLib_addCalc(t.thunderFlashTimer,0,.1,.05,.001),t.thunderFlashTimer<=0&&(r&&n.dKy_efplight_cut(t,t.thunderLightInfluence),t.thunderState=0,0===t.thunderMode&&(t.thunderActive=!1))),0!==t.thunderState){const e=t.thunderFlashTimer;if(r){const r=t.thunderLightInfluence;r.pos[0]=a[0],r.pos[1]=a[1]+150,r.pos[2]=a[2];const s=.2*e/255;r.color.r=l.saturate(180*s),r.color.g=l.saturate(235*s),r.color.b=l.saturate(255*s),!1||(n.dKy_actor_addcol_amb_set(t,.5*e,90,160,245),n.dKy_actor_addcol_dif_set(t,.5*e,90,160,245),n.dKy_bg_addcol_amb_set(t,.7*e,50,120,255),n.dKy_bg_addcol_dif_set(t,.7*e,50,120,255),n.dKy_bg1_addcol_amb_set(t,.35*e,90,160,245),n.dKy_bg1_addcol_dif_set(t,.35*e,90,160,245),n.dKy_vrbox_addcol_sky0_set(t,.4*e,90,160,245),n.dKy_vrbox_addcol_kasumi_set(t,.5*e,90,160,245),n.dKy_addcol_fog_set(t,.3*e,90,160,245))}else n.dKy_vrbox_addcol_sky0_set(t,.15*e,90,160,245),n.dKy_vrbox_addcol_kasumi_set(t,.35*e,90,160,245),n.dKy_addcol_fog_set(t,.12*e,90,160,245)}}(e,t,e.cameraPosition):0!==t.thunderMode&&(!function(e){e.thunderState=0}(t),t.thunderActive=!0)}function re(e,t){const a=e.g_env_light;let r=0;const n=e.roomStatus[e.mStayNo].fili;null!==n&&1048576&n.param&&"GTower"!==e.stageName&&(r=10*le(a)|0),r<=0||(null===a.windline&&(a.windline=new W),a.windline.count=r,function(e,t){const a=e.g_env_light,r=a.windline,n=oe(a),o=le(a),c=a.customWindPower>0;if(c!==r.hasCustomWindPower){r.hasCustomWindPower=c;for(let e=0;e<r.windEff.length;e++){const t=r.windEff[e];null!==t.emitter&&(t.emitter.deleteAllParticle(),t.emitter=null,t.state=0)}}let h,d,u,m,p,f;c?(h=9,d=b.uShortTo2PI(8),u=200,m=8,p=160,f=160):(h=r.count,d=b.uShortTo2PI(800),u=250,m=80,p=2e3,f=2500),h*=4;const A=0|r.frameCounter;r.frameCounter+=t;const g=0|r.frameCounter;if(A!==g)for(let A=0;A<r.windEff.length;A++){const _=r.windEff[A];if(!(A>=h&&0===_.state))if(0===_.state){const t=c||(g/8|0)%h===A;if(o>=.3&&t){c?(i.vec3.copy(_.basePos,e.playerPosition),_.basePos[1]+=200):(te(e,_.basePos,4e3,4e3),_.basePos[1]+=1e3),i.vec3.set(_.animPos,s.cM_rndFX(5*p),s.cM_rndFX(3*p),s.cM_rndFX(5*p)),i.vec3.scaleAndAdd(_.animPos,_.animPos,n,-(f+f*s.cM_rndF(1))),_.swerveAnimCounter=s.cM_rndF(6.283);const t=e.modelCache.device,a=e.modelCache.cache;_.emitter=e.renderer.effectSystem.createBaseEmitter(t,a,49),i.vec3.add(_.emitter.globalTranslation,_.basePos,_.animPos);let r=c?.14:1;_.emitter.globalColorPrm.a=0,r*=1.8,i.vec3.set(_.emitter.globalScale,r,r,r),_.emitter.setGlobalScale(_.emitter.globalScale),_.state=1,_.swerveAngleXZ=Math.atan2(n[0],n[2]),_.swerveAngleY=Math.atan2(n[1],Math.hypot(n[0],n[2])),_.loopDeLoopCounter=0,_.doLoopDeLoop=s.cM_rndF(1)<.2}}else if(1===_.state||2===_.state){const r=_.emitter;_.swerveAnimCounter+=d;const c=t*b.uShortTo2PI(u-.2*u*(1-o))*Math.sin(_.swerveAnimCounter);if(_.swerveAngleY+=c,_.swerveAngleXZ+=c*(1&A?1:-1),_.stateTimer<=.5||!_.doLoopDeLoop){const e=Math.atan2(n[0],n[2]),t=Math.atan2(n[1],Math.hypot(n[0],n[2]));_.swerveAngleXZ=s.cLib_addCalcAngleRad(_.swerveAngleXZ,e,10,b.uShortTo2PI(1e3),b.uShortTo2PI(1)),_.swerveAngleY=s.cLib_addCalcAngleRad(_.swerveAngleY,t,10,b.uShortTo2PI(1e3),b.uShortTo2PI(1))}else{const e=b.uShortTo2PI(3600)/1.8;_.loopDeLoopCounter+=e,_.swerveAngleY+=e,_.loopDeLoopCounter>b.uShortTo2PI(60535)&&(_.doLoopDeLoop=!1)}const h=(1.3*m-.2*m*(1-o))*l.saturate(_.swerveAnimCounter/6.283);i.vec3.set(I,Math.cos(_.swerveAngleY)*Math.sin(_.swerveAngleXZ),Math.sin(_.swerveAngleY),Math.cos(_.swerveAngleY)*Math.cos(_.swerveAngleXZ)),i.vec3.scaleAndAdd(_.animPos,_.animPos,I,h*t),i.vec3.add(r.globalTranslation,_.basePos,_.animPos);const p=i.vec3.distance(r.globalTranslation,e.cameraPosition),f=Math.min(p/200,1),g=(a.bgCol[0].K0.r+a.bgCol[0].K0.g+a.bgCol[0].K0.b)/3,S=Math.max(o*(f*g*g),.5);r.globalColorPrm.a=S*_.alpha;const v=.08+A/30*.008;if(1===_.state)_.stateTimer=s.cLib_addCalc(_.stateTimer,1,.3,.1*v,.01),_.stateTimer>=1&&(_.state=2),_.stateTimer>.5&&(_.alpha=s.cLib_addCalc(_.alpha,1,.5,.05,.001));else{const e=.4;_.stateTimer=s.cLib_addCalc(_.stateTimer,0,e,v*(.1+A/30*.01),.01),_.stateTimer<=0&&(r.deleteAllParticle(),r.maxFrame=-1,r.flags|=1,_.emitter=null,_.state=0),_.stateTimer<.5&&(_.alpha=s.cLib_addCalc(_.alpha,0,.5,.05,.001))}}}}(e,t))}function ne(e){const t=e.g_env_light;e.scnPlay.vrboxLoaded&&!t.vrboxInvisible&&(null===t.sunPacket&&(t.sunPacket=new O(e)),function(e){const t=e.g_env_light,a=t.sunPacket,r=e.dStage_dt.stag.roomTypeAndSchBit>>>16&7;0===t.baseLight.color.r&&2!==r?Y(e.cameraPosition,t.baseLight.pos,I):Y(e.cameraPosition,t.sunPos,I),i.vec3.scaleAndAdd(a.sunPos,e.cameraPosition,I,8e3);let o=!0;0!==t.weatherPselIdx||0!==t.pselIdxCurr&&t.blendPsel>0?o=!1:2===r?o=!1:(t.curTime<120||t.curTime>270)&&(o=!1);let c=0,h=0,d=0,u=0;if(T(t)){if(a.sunAlpha=s.cLib_addCalc(a.sunAlpha,1,.5,.1,.01),o){q(I,a.sunPos,e.camera);const t=e.dlst.peekZ;for(let e=0;e<a.chkPoints.length;e++){const r=J(a.peekZResults[e],t,I,a.chkPoints[e]);2===r?d++:0===r&&(h++,0===e&&c++)}0!==d&&0!==h&&0!==c&&(c=1,h=5)}I[2]=0;const t=320*i.vec3.length(I),r=$(1-Math.min(t/450,1));a.distFalloff=1-r,u=$(r)}else a.sunAlpha=s.cLib_addCalc(a.sunAlpha,0,.5,.1,.01);if(a.visibility=0===c?h>=3?s.cLib_addCalc(a.visibility,1,.1,.1,.001):s.cLib_addCalc(a.visibility,0,.5,.2,.001):5===h?s.cLib_addCalc(a.visibility,1,.5,.2,.01):4===h?s.cLib_addCalc(a.visibility,1,.1,.1,.001):s.cLib_addCalc(a.visibility,0,.1,.2,.001),a.hideLenz=h<2,a.sunPos[1]>0){const r=1-$(1-l.saturate(a.sunPos[1]-e.cameraPosition[1]/8e3));n.dKy_set_actcol_ratio(t,1-u*a.visibility),n.dKy_set_bgcol_ratio(t,1-u*a.visibility),n.dKy_set_fogcol_ratio(t,1+r*u*a.visibility*.5),n.dKy_set_vrboxcol_ratio(t,1+r*u*a.visibility*.5)}if(y(t)){const t=(a.sunPos[1]-e.cameraPosition[1])/-8e3,r=Math.min(t*t*6,1);a.moonAlpha=s.cLib_addCalc(a.moonAlpha,r,.2,.01,.001)}else a.moonAlpha=s.cLib_addCalc(a.moonAlpha,0,.2,.01,.001)}(e),function(e){const t=e.g_env_light.sunPacket;ee(e,I,7200),Y(I,t.sunPos,I);const a=250+350*i.vec3.distance(I,e.cameraFwd);for(let e=0;e<6;e++){const r=e+2;i.vec3.scaleAndAdd(t.lenzflarePos[e],t.sunPos,I,-a*r)}q(I,t.sunPos,e.camera),t.lenzflareAngle=Math.atan2(I[1],I[0])+Math.PI/2}(e))}function se(e,t,a,r){if(t<r)if(t<a||a>r)e.strengthEnv=0;else{const n=(t-a)/(r-a);n<e.strengthEnv&&(e.strengthEnv=n)}}function ie(e,t){const a=e.g_env_light;null===a.vrkumoPacket&&(a.vrkumoPacket=new L(e),n.dKy_checkEventNightStop(e)&&(a.vrkumoPacket.strength=1));const r=a.vrkumoPacket;if(r.enabled){if("Name"===e.stageName)r.count=70;else if(!e.scnPlay.vrboxLoaded||a.vrboxInvisible)r.count=0;else{if((1===a.pselIdxCurr||2===a.pselIdxCurr)&&a.blendPsel>0||(1===a.pselIdxPrev||2===a.pselIdxPrev)&&a.blendPsel<1?r.strength=s.cLib_addCalc(r.strength,1,.1,.003,7e-7):r.strength=s.cLib_addCalc(r.strength,0,.08,.002,7e-8),"sea"===e.stageName&&9===e.mStayNo){i.vec3.set(I,-18e4,750,-2e5),i.vec3.squaredDistance(e.cameraPosition,I)<$(2500)&&(r.strength=1)}r.count=50+50*r.strength,"GTower"===e.stageName&&(r.count=0)}!function(e,t){const a=e.g_env_light;ce(I,a);const r=a.vrkumoPacket;let n;"M_DragB"===e.stageName?(i.vec3.set(I,-1,0,0),n=300):n=1e3+-500*r.strength;{const t=e.roomStatus[e.mStayNo].fili;let a=0;null!==t&&(a=t.skyboxY),"Siren"===e.stageName&&17===e.mStayNo&&(a=-14101),n-=.09*(e.cameraPosition[1]-a)}for(let a=0;a<100;a++){const o=r.instances[a];{const e=Math.hypot(o.position[0],o.position[2]);e>15e3&&(e<=15100?(o.position[0]*=-1,o.position[2]*=-1):(o.position[0]=s.cM_rndFX(14e3),o.position[2]=s.cM_rndFX(14e3)),o.alpha=0);const n=4+4.3*r.strength;if(o.alpha>0){const e=n*o.distFalloff*o.speed*t;i.vec3.scaleAndAdd(o.position,o.position,I,e)}else{const e=n+a/1e3*n*t;i.vec3.scaleAndAdd(o.position,o.position,I,e)}}const l=Math.hypot(o.position[0],o.position[2]),c=Math.min(l/15e3,1),h=3e3+-1e3*r.strength,d=1-Math.pow(c,3);let u;o.position[1]=a/100*500+n+h*d,o.distFalloff=1-Math.pow(c,6);let m=1;"M_DragB"===e.stageName?(o.alpha=1,u=1):a<r.count?(m=.1,u=o.distFalloff>=.05&&o.distFalloff<.2?(o.distFalloff-.05)/.15:o.distFalloff<.2?0:1+-.55*r.strength):(u=0,m=.005);let p=0;p=d>.98?0:d>.88?u*((.98-d)/.1):u,o.alpha=s.cLib_addCalc(o.alpha,p,.2*t,m,.01)}r.bounceAnimTimer+=200*t}(e,t)}}function oe(e){return e.windVec}function le(e){return e.windPower}function ce(e,t){i.vec3.scale(e,t.windVec,t.windPower)}t.dKankyo_star_Packet=X,t.dKyr_get_vectle_calc=Y,t.dKyw_wether_move=function(e,t){ae(e),re(e,t)},t.dKyw_wether_move_draw=function(e,t){"Name"!==e.stageName&&(ne(e),function(e,t){const a=e.g_env_light;if(0===a.rainCount)return;null===a.rainPacket&&(a.rainPacket=new H(e));const r=a.rainPacket;if(ce(R,a),a.rainCount>r.rainCount&&(r.rainCount=a.rainCount),0!==r.rainCount){te(e,I,700,600);for(let a=0;a<r.rainCount;a++){const n=r.instances[a];if(n.initialized){n.pos[0]+=20*t*(R[0]+10*r.centerDelta[0]*r.centerDeltaMul+.08*(7&a)),n.pos[1]+=20*t*(-2+R[1]+(10*r.centerDelta[1]+r.centerDeltaMul)),n.pos[2]+=20*t*(R[2]+10*r.centerDelta[2]*r.centerDeltaMul+.08*(3&a)),i.vec3.set(P,n.basePos[0]+n.pos[0],I[1],n.basePos[2]+n.pos[2]);const o=i.vec3.distance(P,I);if(n.timer<=0){o>800&&(n.timer=10,i.vec3.copy(n.basePos,I),o<=850?(Y(P,I,B),i.vec3.scale(n.pos,B,800+s.cM_rndFX(40))):i.vec3.set(n.pos,s.cM_rndFX(800),s.cM_rndFX(800),s.cM_rndFX(800)),n.minY=-800+e.cameraPosition[1]),n.basePos[1]+n.pos[1]<20+n.minY&&(i.vec3.copy(n.basePos,I),i.vec3.set(n.pos,s.cM_rndFX(800),200,s.cM_rndFX(800)),n.minY=-800+e.cameraPosition[1],n.timer=10)}else n.timer-=t}else i.vec3.copy(n.basePos,I),i.vec3.set(n.pos,s.cM_rndFX(800),s.cM_rndFX(600),s.cM_rndFX(800)),n.alpha=1,n.timer=0,n.minY=-800+e.cameraPosition[1],n.initialized=!0;n.alpha=1}a.rainCount<r.rainCount&&(r.rainCount=a.rainCount)}}(e,t)),function(e,t){const a=e.g_env_light,r="Name"===e.stageName;if(!r&&(a.vrboxInvisible||"M_DragB"===e.stageName))return;let n=1;const i=a.curTime;if(n=r?1:i>=60&&i<75?1-l.invlerp(60,75,i):i>=75&&i<270?0:i>=270&&i<315?l.invlerp(270,315,i):1,0!==a.weatherPselIdx?n=0:0!==a.pselIdxCurr&&a.blendPsel>.5&&(n=0),a.starAmount=s.cLib_addCalc(a.starAmount,n,.1,.01,1e-6),a.starCount=1e3*a.starAmount|0,0===a.starCount)return;null===a.starPacket&&(a.starPacket=new X(e));const o=a.starPacket,c=o.instances[0];c.animCounter+=.01*t,c.animWave=Math.sin(c.animCounter),o.rot+=t}(e,t),"Name"!==e.stageName&&function(e,t){const a=e.g_env_light;if(0===a.waveCount)return;null===a.wavePacket&&(a.wavePacket=new z(e));const r=a.wavePacket;if(a.waveFlatInter>=1)return;ce(I,a),te(e,B,a.waveSpawnDist,0);const n=oe(a);let o=le(a);o=Math.min(o,.6);let c=n[0],h=n[1],d=n[2];e.dStage_dt.stag.roomTypeAndSchBit;const u=e.roomStatus[e.mStayNo].fili;let m=0;null!==u&&(m=u.skyboxY),i.vec3.copy(R,e.cameraFwd),R[1]=0,i.vec3.normalize(R,R),r.skewDirection=-c*R[2]- -d*R[0];const p=(1-Math.abs(c*R[0]+d*R[2]))*(1-h)*Math.abs(r.skewDirection);r.skewWidth=.6*o*p;for(let n=0;n<a.waveCount;n++){const c=r.instances[n];a.waveReset&&(c.initialized=!1),c.initialized||(c.basePos[0]=B[0],c.basePos[1]=m,c.basePos[2]=B[2],c.pos[0]=s.cM_rndFX(a.waveSpawnRadius),c.pos[1]=0,c.pos[2]=s.cM_rndFX(a.waveSpawnRadius),c.animCounter=s.cM_rndF(65536),c.alpha=0,c.strengthEnv=1,c.scale=a.waveScaleRand+s.cM_rndF(1-a.waveScaleRand),c.speed=c.scale,c.animCounterSpeed=(.02+.05*(1-c.scale))*a.waveCounterSpeedScale,c.initialized=!0);const h=(.2+.8*c.alpha)*(.5+.5*c.strengthEnv)*c.speed*a.waveSpeed;c.pos[0]+=h*I[0]*t,c.pos[2]+=h*I[2]*t,c.animCounter+=c.animCounterSpeed*t,i.vec3.add(E,c.basePos,c.pos);const d=Math.hypot(B[0]-E[0],B[2]-E[2]);d>a.waveSpawnRadius&&(c.basePos[0]=B[0],c.basePos[2]=B[2],d<=a.waveSpawnRadius+350?(Y(E,B,P),c.pos[0]=P[0]*a.waveSpawnRadius,c.pos[2]=P[2]*a.waveSpawnRadius):(c.pos[0]=s.cM_rndFX(a.waveSpawnRadius),c.pos[2]=s.cM_rndFX(a.waveSpawnRadius)),c.alpha=0),c.strengthEnv=1;for(let e=0;e<a.waveInfluences.length;e++){const t=a.waveInfluences[e];se(c,Math.hypot(t.pos[0]-E[0],t.pos[2]-E[2]),t.innerRadius,t.outerRadius)}if(a.waveFlatInter>0){const t=Math.hypot(e.cameraPosition[0]-E[0],e.cameraPosition[2]-E[2]),r=1.5*a.waveFlatInter*a.waveSpawnRadius;se(c,t,r,r+1e3)}se(c,Math.hypot(e.playerPosition[0]-E[0],e.playerPosition[2]-E[2]),200,2e3),i.vec3.add(E,c.basePos,c.pos);const u=Math.max(o,i.vec3.distance(E,e.cameraPosition)),p=l.saturate(1.03*(1-u/(2*a.waveSpawnDist))*Math.sin(c.animCounter));c.alpha=s.cLib_addCalc(c.alpha,p,.5,.5,.001),c.basePos[1]=m}}(e,t)},t.dKyw_wether_move_draw2=function(e,t){ie(e,t)},t.dKyw_wether_draw=function(e,t,a){const r=e.g_env_light;"Name"!==e.stageName&&null!==r.wavePacket&&r.wavePacket.draw(e,t,a),"Name"!==e.stageName&&null!==r.sunPacket&&r.sunPacket.draw(e,t,a),null!==r.starPacket&&r.starPacket.draw(e,t,a),"Name"!==e.stageName&&null!==r.rainPacket&&r.rainPacket.draw(e,t,a)},t.dKyw_wether_draw2=function(e,t,a){const r=e.g_env_light;null!==r.vrkumoPacket&&r.vrkumoPacket.enabled&&r.vrkumoPacket.draw(e,t,a)},t.dKyw_get_wind_vec=oe,t.dKyw_get_wind_pow=le,t.dKyw_get_wind_vecpow=ce,t.dKy_wave_chan_init=function(e){const t=e.g_env_light;t.waveSpeed=.1,t.waveSpawnDist=3e3,t.waveSpawnRadius=3150,t.waveScale=250,t.waveScaleRand=.217,t.waveCounterSpeedScale=1.6,t.waveScaleBottom=5,t.waveCount=0,t.waveReset=!1},t.dKy_usonami_set=function(e,t){const a=e.g_env_light;a.waveCount<200&&(a.waveSpawnDist=2e4,a.waveSpawnRadius=22e3,a.waveReset=!1,a.waveScale=300,a.waveScaleRand=.001,a.waveCounterSpeedScale=1.2,a.waveScaleBottom=6,a.waveCount=300,a.waveSpeed=30),a.waveFlatInter=t};class he extends c.kankyo_class{constructor(){super(...arguments),this.btkAnm=new d.mDoExt_btkAnm,this.btkTime=0,this.brkAnm=new d.mDoExt_brkAnm,this.rotation=0}subload(e){const t=e.resCtrl.getObjectRes(0,"Always",62);this.model=new h.J3DModelInstance(t);const a=e.resCtrl.getObjectRes(6,"Always",96);this.btkAnm.init(t,a,!1,2);const r=e.resCtrl.getObjectRes(4,"Always",82);this.brkAnm.init(t,r,!0,0),this.btkTime=s.cM_rndF(1);const n=e.g_env_light.thunderState<10?1:.5;this.rotation=s.cM_rndFX(4e3)*n,this.scale[0]=n*(5+s.cM_rndF(15)),s.cM_rndFX(1)>=.5&&(this.scale[0]*=-1),this.scale[1]=n*(20+s.cM_rndF(60)),this.scale[2]=1;const i=e.cameraFwd,o=Math.atan2(i[0],i[2]),l=s.cM_rndFX(1)<0?o-Math.PI/2:o+Math.PI/2,c=C(i),d=Math.sin(l),u=Math.cos(l),m=Math.cos(c),p=s.cM_rndFX(12e4);return this.pos[0]=e.cameraPosition[0]+1e5*i[0]+m*d*p,this.pos[1]=e.cameraPosition[1]+s.cM_rndFX(2e3),this.pos[2]=e.cameraPosition[2]+1e5*i[2]+m*u*p,2}draw(e,t,a){u.MtxTrans(this.pos,!1),u.mDoMtx_ZrotM(u.calc_mtx,this.rotation),u.mDoMtx_XrotM(u.calc_mtx,this.rotation),i.mat4.copy(this.model.modelMatrix,u.calc_mtx),i.vec3.copy(this.model.baseScale,this.scale),this.btkAnm.entry(this.model,this.btkTime),this.brkAnm.entry(this.model),d.mDoExt_modelUpdateDL(e,this.model,t,a)}execute(e,t){this.brkAnm.play(t)&&c.fopKyM_Delete(e.frameworkGlobals,this)}}t.d_thunder=he,he.PROCESS_NAME=441,t.dKyw__RegisterConstructors=function(e){var t;t=he,c.fpcPf__Register(e,t.PROCESS_NAME,t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(31),n=a(0),s=a(5),i=a(32),o=a(56);function l(e){if(128===e)return 3;if(152===e)return 1;if(144===e)return 0;throw"whoops"}class c{constructor(){this.vcd=[],this.vat=[[]],this.loadedVertexLayout=null,this.inputLayout=null;for(let e=9;e<=20;e++)this.vcd[e]={type:0},this.vat[0][e]={compType:4,compShift:0}}setVtxDesc(e,t){const a=n.assertExists(this.vcd[e]),r=t?1:0;a.type!==r&&(a.type=r,this.dirtyInputLayout())}setVtxAttrFmt(e,t,a){n.assert(0===e);const r=n.assertExists(this.vat[e][t]);r.compCnt!==a&&(r.compCnt=a,this.dirtyInputLayout())}dirtyInputLayout(){this.loadedVertexLayout=null,this.inputLayout=null}createLoadedVertexLayout(){null===this.loadedVertexLayout&&(this.loadedVertexLayout=r.compileLoadedVertexLayout(this.vat,this.vcd))}createInputLayoutInternal(e,t){return null===this.inputLayout&&(this.inputLayout=s.createInputLayout(e,t,this.loadedVertexLayout,!1),!0)}createInputLayout(e,t){this.createLoadedVertexLayout(),this.createInputLayoutInternal(e,t)}}t.TDDraw=class extends c{constructor(){super(),this.frequencyHint=2,this.inputState=null,this.vertexBuffer=null,this.indexBuffer=null,this.recreateVertexBuffer=!0,this.recreateIndexBuffer=!0,this.vertexData=new DataView(new ArrayBuffer(1024)),this.indexData=new Uint16Array(256)}ensureVertexBufferData(e){if(e>this.vertexData.byteLength){const t=n.align(e,this.vertexData.byteLength),a=new Uint8Array(t);a.set(new Uint8Array(this.vertexData.buffer)),this.vertexData=new DataView(a.buffer),this.recreateVertexBuffer=!0}}ensureIndexBufferData(e){if(e>this.indexData.length){const t=n.align(e,this.indexData.byteLength),a=new Uint16Array(t);a.set(this.indexData),this.indexData=a,this.recreateIndexBuffer=!0}}getOffs(e,t){return e*this.loadedVertexLayout.vertexBufferStrides[0]+this.loadedVertexLayout.vertexAttributeOffsets[t]}writeUint8(e,t){this.vertexData.setUint8(e,t)}writeFloat32(e,t){const a=0===o.getSystemEndianness();this.vertexData.setFloat32(e,t,a)}beginDraw(){this.createLoadedVertexLayout(),this.currentVertex=-1,this.currentIndex=0,this.startIndex=0}allocVertices(e){const t=this.currentVertex+1+e,a=this.loadedVertexLayout.vertexBufferStrides[0];this.ensureVertexBufferData(t*a)}allocPrimitives(e,t){const a=this.currentVertex+1+t,r=l(e),n=this.loadedVertexLayout.vertexBufferStrides[0];this.ensureVertexBufferData(a*n),this.ensureIndexBufferData(i.getTriangleIndexCountForTopologyIndexCount(r,a))}begin(e,t=null){this.currentPrim=e,this.currentPrimVertex=-1,null!==t&&this.allocPrimitives(e,t)}position3f32(e,t,a){++this.currentVertex,++this.currentPrimVertex,this.allocVertices(0);const r=this.getOffs(this.currentVertex,9);this.writeFloat32(r+0,e),this.writeFloat32(r+4,t),this.writeFloat32(r+8,a)}position3vec3(e){this.position3f32(e[0],e[1],e[2])}texCoord2f32(e,t,a){const r=this.getOffs(this.currentVertex,e);this.writeFloat32(r+0,t),this.writeFloat32(r+4,a)}color4rgba8(e,t,a,r,n){const s=this.getOffs(this.currentVertex,e);this.writeUint8(s+0,t),this.writeUint8(s+1,a),this.writeUint8(s+2,r),this.writeUint8(s+3,n)}color4color(e,t){this.color4rgba8(e,255*t.r,255*t.g,255*t.b,255*t.a)}end(){const e=l(this.currentPrim),t=i.getTriangleIndexCountForTopologyIndexCount(e,this.currentPrimVertex+1);this.ensureIndexBufferData(this.currentIndex+t);const a=this.currentVertex-this.currentPrimVertex,r=this.currentPrimVertex+1;i.convertToTrianglesRange(this.indexData,this.currentIndex,e,a,r),this.currentIndex+=t}flushDeviceObjects(e,t){let a=!1;if(this.createInputLayoutInternal(e,t)&&(a=!0),this.recreateVertexBuffer&&(null!==this.vertexBuffer&&e.destroyBuffer(this.vertexBuffer),this.vertexBuffer=e.createBuffer(this.vertexData.byteLength+3>>>2,2,this.frequencyHint),this.recreateVertexBuffer=!1,a=!0),this.recreateIndexBuffer&&(null!==this.indexBuffer&&e.destroyBuffer(this.indexBuffer),this.indexBuffer=e.createBuffer(this.indexData.byteLength+3>>>2,1,this.frequencyHint),this.recreateIndexBuffer=!1,a=!0),a){null!==this.inputState&&e.destroyInputState(this.inputState);const t=[{buffer:this.vertexBuffer,byteOffset:0}],a={buffer:this.indexBuffer,byteOffset:0};this.inputState=e.createInputState(this.inputLayout,t,a)}}makeRenderInst(e,t){this.flushDeviceObjects(e,t.gfxRenderCache);const a=t.newRenderInst();return a.setInputLayoutAndState(this.inputLayout,this.inputState),a.drawIndexes(this.currentIndex-this.startIndex,this.startIndex),this.startIndex=this.currentIndex,a}endAndUploadCache(e,t){this.flushDeviceObjects(e,t);const a=e.createHostAccessPass();a.uploadBufferData(this.vertexBuffer,0,new Uint8Array(this.vertexData.buffer)),a.uploadBufferData(this.indexBuffer,0,new Uint8Array(this.indexData.buffer)),e.submitPass(a)}endAndUpload(e,t){return this.endAndUploadCache(e,t.gfxRenderCache)}endDraw(e,t){return this.endAndUpload(e,t),this.makeRenderInst(e,t)}destroy(e){null!==this.inputState&&e.destroyInputState(this.inputState),null!==this.indexBuffer&&e.destroyBuffer(this.indexBuffer),null!==this.vertexBuffer&&e.destroyBuffer(this.vertexBuffer)}};t.TSDraw=class extends c{constructor(){super(),this.frequencyHint=1,this.inputState=null,this.vertexBuffer=null,this.indexBuffer=null,this.vertexData=new DataView(new ArrayBuffer(1024)),this.indexData=new Uint16Array(256)}ensureVertexBufferData(e){if(e>this.vertexData.byteLength){const t=n.align(e,this.vertexData.byteLength),a=new Uint8Array(t);a.set(new Uint8Array(this.vertexData.buffer)),this.vertexData=new DataView(a.buffer)}}ensureIndexBufferData(e){if(e>this.indexData.length){const t=n.align(e,this.indexData.byteLength),a=new Uint16Array(t);a.set(this.indexData),this.indexData=a}}getOffs(e,t){return e*this.loadedVertexLayout.vertexBufferStrides[0]+this.loadedVertexLayout.vertexAttributeOffsets[t]}writeUint8(e,t){this.vertexData.setUint8(e,t)}writeFloat32(e,t){const a=0===o.getSystemEndianness();this.vertexData.setFloat32(e,t,a)}beginDraw(){n.assert(null===this.vertexBuffer),n.assert(null===this.indexBuffer),this.createLoadedVertexLayout(),this.currentVertex=-1,this.currentIndex=0}allocVertices(e){const t=this.currentVertex+1+e,a=this.loadedVertexLayout.vertexBufferStrides[0];this.ensureVertexBufferData(t*a)}allocPrimitives(e,t){const a=this.currentVertex+1+t,r=l(e),n=this.loadedVertexLayout.vertexBufferStrides[0];this.ensureVertexBufferData(a*n),this.ensureIndexBufferData(i.getTriangleIndexCountForTopologyIndexCount(r,a))}begin(e,t=null){this.currentPrim=e,this.currentPrimVertex=-1,null!==t&&this.allocPrimitives(e,t)}position3f32(e,t,a){++this.currentVertex,++this.currentPrimVertex,this.allocVertices(0);const r=this.getOffs(this.currentVertex,9);this.writeFloat32(r+0,e),this.writeFloat32(r+4,t),this.writeFloat32(r+8,a)}position3vec3(e){this.position3f32(e[0],e[1],e[2])}texCoord2f32(e,t,a){const r=this.getOffs(this.currentVertex,e);this.writeFloat32(r+0,t),this.writeFloat32(r+4,a)}color4rgba8(e,t,a,r,n){const s=this.getOffs(this.currentVertex,e);this.writeUint8(s+0,t),this.writeUint8(s+1,a),this.writeUint8(s+2,r),this.writeUint8(s+3,n)}color4color(e,t){this.color4rgba8(e,255*t.r,255*t.g,255*t.b,255*t.a)}end(){const e=l(this.currentPrim),t=i.getTriangleIndexCountForTopologyIndexCount(e,this.currentPrimVertex+1);this.ensureIndexBufferData(this.currentIndex+t);const a=this.currentVertex-this.currentPrimVertex,r=this.currentPrimVertex+1;i.convertToTrianglesRange(this.indexData,this.currentIndex,e,a,r),this.currentIndex+=t}flushDeviceObjects(e,t){n.assert(null===this.inputState),this.createInputLayoutInternal(e,t),this.vertexBuffer=e.createBuffer(this.vertexData.byteLength+3>>>2,2,this.frequencyHint),this.indexBuffer=e.createBuffer(this.indexData.byteLength+3>>>2,1,this.frequencyHint);const a=[{buffer:this.vertexBuffer,byteOffset:0}],r={buffer:this.indexBuffer,byteOffset:0};this.inputState=e.createInputState(this.inputLayout,a,r)}setOnRenderInst(e){n.assert(null!==this.inputState),e.setInputLayoutAndState(this.inputLayout,this.inputState),e.drawIndexes(this.currentIndex)}endDraw(e,t){this.flushDeviceObjects(e,t);const a=e.createHostAccessPass();a.uploadBufferData(this.vertexBuffer,0,new Uint8Array(this.vertexData.buffer)),a.uploadBufferData(this.indexBuffer,0,new Uint8Array(this.indexData.buffer)),e.submitPass(a)}destroy(e){null!==this.inputState&&e.destroyInputState(this.inputState),null!==this.indexBuffer&&e.destroyBuffer(this.indexBuffer),null!==this.vertexBuffer&&e.destroyBuffer(this.vertexBuffer)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(20),n=a(6),s=a(17),i=a(32),o=a(13),l=a(4),c=a(1),h=a(14);class d extends r.DeviceProgram{constructor(){super(...arguments),this.both="\nprecision mediump float;\n\nlayout(row_major, std140) uniform ub_Params {\n    Mat4x4 u_Projection;\n    Mat4x3 u_ModelView;\n    vec4 u_GridColor;\n    vec4 u_Misc[1];\n};\n\n#define u_CellCount (u_Misc[0].x)\n#define u_LineWidth (u_Misc[0].y)\n",this.vert=`\nlayout(location = ${d.a_Position}) in vec3 a_Position;\n\nout vec2 v_SurfCoord;\n\nvoid main() {\n    v_SurfCoord = a_Position.xz * 0.5 + 0.5;\n\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_ModelView), vec4(a_Position, 1.0)));\n}\n`,this.frag="\nprecision highp float;\n\nin vec2 v_SurfCoord;\n\nfloat Saturate(float v) {\n    return clamp(v, 0.0, 1.0);\n}\n\n// 1 at t=0, 0 at t=N, 0 at t=1-N, 1 at t=1\nfloat Notch(float t, float N) {\n    float inv = 1.0/N;\n    return Saturate((t - (1.0 - N))*inv) + Saturate(1.0 - (t * inv));\n}\n\nvoid main() {\n    gl_FragColor = vec4(u_GridColor);\n\n    vec2 t_Thresh = fract(v_SurfCoord.xy * u_CellCount);\n\n    gl_FragColor.a = pow(Notch(t_Thresh.x, u_LineWidth), 0.4545) + pow(Notch(t_Thresh.y, u_LineWidth), 0.4545);\n    if (!gl_FrontFacing)\n        gl_FragColor.a *= 0.2;\n    gl_FragDepth = gl_FragCoord.z + 1e-6;\n}\n"}}d.a_Position=0,d.ub_SceneParams=0;const u=[{numSamplers:0,numUniformBuffers:1}],m=c.mat4.create();t.GridPlane=class{constructor(e){this.modelMatrix=c.mat4.create(),this.color=l.colorNewCopy(l.White),this.cellCount=4,this.lineWidth=4;const t=new d;this.gfxProgram=e.createProgram(t),this.setSize(500);const a=new Float32Array(12);a[0]=-1,a[1]=0,a[2]=-1,a[3]=-1,a[4]=0,a[5]=1,a[6]=1,a[7]=0,a[8]=-1,a[9]=1,a[10]=0,a[11]=1,this.posBuffer=s.makeStaticDataBuffer(e,2,a.buffer),this.idxBuffer=s.makeStaticDataBuffer(e,1,i.makeTriangleIndexBuffer(1,0,4).buffer);const r=[{location:d.a_Position,format:n.GfxFormat.F32_RGB,bufferByteOffset:0,bufferIndex:0}];this.inputLayout=e.createInputLayout({vertexAttributeDescriptors:r,vertexBufferDescriptors:[{byteStride:12,frequency:1}],indexBufferFormat:n.GfxFormat.U16_R});const o=[{buffer:this.posBuffer,byteOffset:0}];this.inputState=e.createInputState(this.inputLayout,o,{buffer:this.idxBuffer,byteOffset:0})}setSize(e){c.mat4.fromScaling(this.modelMatrix,[e,e,e])}prepareToRender(e,t,a){const r=t.pushRenderInst();r.setBindingLayouts(u),r.setGfxProgram(this.gfxProgram),r.setInputLayoutAndState(this.inputLayout,this.inputState);const s=r.setMegaStateFlags({depthWrite:!1});h.setAttachmentStateSimple(s,{blendMode:n.GfxBlendMode.ADD,blendDstFactor:n.GfxBlendFactor.ONE_MINUS_SRC_ALPHA,blendSrcFactor:n.GfxBlendFactor.SRC_ALPHA}),r.drawIndexes(6);let i=r.allocateUniformBuffer(d.a_Position,36);const l=r.mapUniformBufferF32(d.a_Position);i+=o.fillMatrix4x4(l,i,a.camera.projectionMatrix),c.mat4.mul(m,a.camera.viewMatrix,this.modelMatrix),i+=o.fillMatrix4x3(l,i,m),i+=o.fillColor(l,i,this.color),i+=o.fillVec4(l,i,this.cellCount,this.lineWidth/this.modelMatrix[0])}destroy(e){e.destroyProgram(this.gfxProgram),e.destroyBuffer(this.posBuffer),e.destroyBuffer(this.idxBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=new TextDecoder("sjis");function s(e,t){const a=e.createDataView(t);let r=0;for(;0!==a.getUint8(r);)r++;return n.decode(e.createTypedArray(Uint8Array,t,r))}function i(e){let t=0;for(let a=0;a<e.length;a++){t<<=8,t+=e.charCodeAt(a);const r=Math.floor(4993*t/4294967296);t-=33554393*((t-r)/2+r>>24)}return t}function o(e){let t=0;for(let a=0;a<e.length;a++)t=31*t+e.charCodeAt(a)>>>0;return t}t.bcsvHashLM=i,t.bcsvHashSMG=o;const l=new Map;function c(e){const t=l.get(e);return void 0!==t?t:`Unk$${e}`}function h(e,t){return e.fields.findIndex(e=>e.nameHash===t)}function d(e,t){const a=h(e,o(t));if(a>=0)return a;const r=h(e,i(t));return r>=0?r:-1}function u(e,t,a){const r=d(e,a);return-1===r?null:t[r]}["pos_x","pos_y","pos_z","dir_x","dir_y","dir_z","scale_x","scale_y","scale_z","pnt0_x","pnt0_y","pnt0_z","furniture_x","furniture_y","furniture_z","name","dmd_name","path_name","create_name","character_name","access_name","CodeName","arg0","arg1","arg2","arg3","arg4","arg5","arg6","arg7","arg8","room_no","GalaxyName","ZoneName","ScenarioNo","ScenarioName","PowerStarId","AppearPowerStarObj","Comet","LuigiModeTimer","IsHidden","Hidden","WorldNo","SceneNo","MarioNo","PlanetName","LowFlag","MiddleFlag","BloomFlag","WaterFlag","WaterFlag","IndirectFlag","Obj_arg0","Obj_arg1","Obj_arg2","Obj_arg3","Obj_arg4","Obj_arg5","Obj_arg6","Obj_arg7","CommonPath_ID","RotateSpeed","RotateAngle","RotateAxis","RotateAccelType","RotateStopTime","RotateType","type","no","l_id","closed","path_arg0","parg_arg1","id","pnt0_x","pnt0_y","pnt0_z","pnt1_x","pnt1_y","pnt1_z","pnt2_x","pnt2_y","pnt2_z","LightID","AreaLightName","Interpolate","Fix","PlayerLight0PosX","PlayerLight0PosY","PlayerLight0PosZ","PlayerLight0ColorR","PlayerLight0ColorG","PlayerLight0ColorB","PlayerLight0ColorA","PlayerLight0FollowCamera","PlayerLight1PosX","PlayerLight1PosY","PlayerLight1PosZ","PlayerLight1ColorR","PlayerLight1ColorG","PlayerLight1ColorB","PlayerLight1ColorA","PlayerLight1FollowCamera","PlayerAmbientR","PlayerAmbientG","PlayerAmbientB","PlayerAmbientA","PlayerAlpha2","StrongLight0PosX","StrongLight0PosY","StrongLight0PosZ","StrongLight0ColorR","StrongLight0ColorG","StrongLight0ColorB","StrongLight0ColorA","StrongLight0FollowCamera","StrongLight1PosX","StrongLight1PosY","StrongLight1PosZ","StrongLight1ColorR","StrongLight1ColorG","StrongLight1ColorB","StrongLight1ColorA","StrongLight1FollowCamera","StrongAmbientR","StrongAmbientG","StrongAmbientB","StrongAmbientA","StrongAlpha2","WeakLight0PosX","WeakLight0PosY","WeakLight0PosZ","WeakLight0ColorR","WeakLight0ColorG","WeakLight0ColorB","WeakLight0ColorA","WeakLight0FollowCamera","WeakLight1PosX","WeakLight1PosY","WeakLight1PosZ","WeakLight1ColorR","WeakLight1ColorG","WeakLight1ColorB","WeakLight1ColorA","WeakLight1FollowCamera","WeakAmbientR","WeakAmbientG","WeakAmbientB","WeakAmbientA","WeakAlpha2","PlanetLight0PosX","PlanetLight0PosY","PlanetLight0PosZ","PlanetLight0ColorR","PlanetLight0ColorG","PlanetLight0ColorB","PlanetLight0ColorA","PlanetLight0FollowCamera","PlanetLight1PosX","PlanetLight1PosY","PlanetLight1PosZ","PlanetLight1ColorR","PlanetLight1ColorG","PlanetLight1ColorB","PlanetLight1ColorA","PlanetLight1FollowCamera","PlanetAmbientR","PlanetAmbientG","PlanetAmbientB","PlanetAmbientA","PlanetAlpha2","attribute"].forEach(e=>{l.set(i(e),e),l.set(o(e),e)}),t.parse=function(e,t=!1){const a=e.createDataView(),n=a.getUint32(0,t),i=a.getUint32(4,t),o=a.getUint32(8,t),l=a.getUint32(12,t),h=o+n*l;let d=16;const u=[];for(let e=0;e<i;e++){const e=a.getUint32(d+0,t),r=c(e),n=a.getUint32(d+4,t),s=a.getUint16(d+8,t),i=a.getInt8(d+10),o=a.getUint8(d+11);u.push({nameHash:e,debugName:r,bitmask:n,recordOffset:s,shift:i,type:o}),d+=12}let m=o;const p=[];for(let i=0;i<n;i++){const n=[];for(let i=0;i<u.length;i++){const o=u[i],l=m+o.recordOffset;let c;switch(o.type){case 0:c=(a.getInt32(l,t)&o.bitmask)>>o.shift;break;case 1:c=r.readString(e,l,32,!0);break;case 2:c=a.getFloat32(l,t);break;case 4:c=(a.getInt16(l,t)&o.bitmask)>>o.shift;break;case 5:c=(a.getInt8(l)&o.bitmask)>>o.shift;break;case 6:c=s(e,h+a.getUint32(l,t));break;default:throw new Error(`Unknown field type ${o.type}`)}n.push(c)}p.push(n),m+=l}return{fields:u,records:p}},t.getFieldIndexFromHash=h,t.getFieldIndexFromName=d,t.getEntriesWithField=function(e,t,a){return{fields:e.fields,records:e.records.filter(r=>u(e,r,t)==a)}},t.getField=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(2);t.isFirstStep=function(e){return 0===e.spine.getNerveStep()},t.isGreaterStep=function(e,t){return e.spine.getNerveStep()>t},t.isGreaterEqualStep=function(e,t){return e.spine.getNerveStep()>=t},t.isLessStep=function(e,t){return e.spine.getNerveStep()<t},t.calcNerveRate=function(e,t){return e.spine.getNerveStep()/t},t.calcNerveValue=function(e,t,a,n){const s=t>0?e.spine.getNerveStep()/t:1;return r.lerp(a,n,s)},t.getStep=function(e){return e.spine.getNerveStep()};t.Spine=class{constructor(){this.nextNerve=null,this.tick=0}setNerve(e){this.nextNerve=e,this.tick=-1}getNerveStep(){return this.tick}changeNerve(){null!==this.nextNerve&&(this.currentNerve=this.nextNerve,this.nextNerve=null,this.tick=0)}updateTick(e){0===this.tick&&e<.01?this.tick=.01:this.tick+=e,this.changeNerve()}getCurrentNerve(){return this.currentNerve}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(40),s=a(222),i=a(53),o=a(0),l=a(2),c=a(43);class h{constructor(){this.collisionParts=null,this.prismIdx=null,this.hitSensor=null,this.pos0=r.vec3.create(),this.pos1=r.vec3.create(),this.pos2=r.vec3.create(),this.faceNormal=r.vec3.create()}getAttributes(){return null!==this.prismIdx?this.collisionParts.collisionServer.getAttributes(this.prismIdx):null}copy(e){this.collisionParts=e.collisionParts,this.prismIdx=e.prismIdx,this.hitSensor=e.hitSensor,r.vec3.copy(this.pos0,e.pos0),r.vec3.copy(this.pos1,e.pos1),r.vec3.copy(this.pos2,e.pos2),r.vec3.copy(this.faceNormal,e.faceNormal)}fillData(e,t,a){this.collisionParts=e,this.prismIdx=t,this.hitSensor=a;const r=e.collisionServer,n=r.getPrismData(t);r.getPos(this.pos0,n,0),l.transformVec3Mat4w1(this.pos0,e.worldMtx,this.pos0),r.getPos(this.pos1,n,1),l.transformVec3Mat4w1(this.pos1,e.worldMtx,this.pos1),r.getPos(this.pos2,n,2),l.transformVec3Mat4w1(this.pos2,e.worldMtx,this.pos2),r.getFaceNormal(this.faceNormal,n),l.transformVec3Mat4w0(this.faceNormal,e.worldMtx,this.faceNormal)}}t.Triangle=h;class d extends h{constructor(){super(...arguments),this.strikeLoc=r.vec3.create(),this.distance=-1}}t.HitInfo=d;t.TriangleFilterBase=class{isInvalidTriangle(e){return!1}};t.CollisionPartsFilterBase=class{isInvalidParts(e){return!1}};const u=r.vec3.create(),m=r.vec3.create();class p{constructor(e,t,a,n,i,l,c,h){this.hitSensor=n,this.keeperIdx=c,this.scaleType=h,this.validated=!1,this.hostMtx=null,this.invWorldMtx=r.mat4.create(),this.worldMtx=r.mat4.create(),this.checkArrowResult=new s.CheckArrowResult,this.collisionServer=new s.KCollisionServer(i,l),e.create(1);const d=o.assertExists(e.collisionDirector);this.collisionZone=d.keepers[c].getZone(t.zoneId),this.resetAllMtx(a)}updateMtx(){}addToBelongZone(e){e.collisionDirector.keepers[this.keeperIdx].addToZone(this,this.collisionZone.zoneId)}removeFromBelongZone(e){e.collisionDirector.keepers[this.keeperIdx].removeFromZone(this,this.collisionZone.zoneId)}makeEqualScale(e){if(2===this.scaleType)return;r.mat4.getScaling(u,e);const t=u[0]-u[1],a=u[2]-u[0],n=u[1]-u[2];if(l.isNearZero(t,.001)&&l.isNearZero(a,.001)&&l.isNearZero(n,.001))return;let s;if(1===this.scaleType)s=1;else{if(0!==this.scaleType)throw"whoops";s=(u[0]+u[1]+u[2])/3}r.vec3.set(u,s/u[0],s/u[1],s/u[2]),c.preScaleMtx(e,u)}resetAllMtxPrivate(e){r.mat4.copy(this.worldMtx,e),r.mat4.invert(this.invWorldMtx,e)}resetAllMtx(e){this.resetAllMtxPrivate(e)}resetAllMtxFromHost(){r.mat4.copy(b,o.assertExists(this.hostMtx)),this.makeEqualScale(b),this.resetAllMtxPrivate(b)}checkStrikeLine(e,t,a,n,s){l.transformVec3Mat4w1(u,this.invWorldMtx,a),l.transformVec3Mat4w0(m,this.invWorldMtx,n),this.checkArrowResult.reset(),this.collisionServer.checkArrow(this.checkArrowResult,e.length,u,m);const i=t;for(let a=0;a<e.length;a++){const n=this.checkArrowResult.prisms[a];if(null===n)break;const i=this.collisionServer.toIndex(n);if(e[t].fillData(this,i,this.hitSensor),null!==s&&s.isInvalidTriangle(e[t]))continue;const o=this.checkArrowResult.distances[a];r.vec3.scaleAndAdd(e[t].strikeLoc,u,m,o),l.transformVec3Mat4w1(e[t].strikeLoc,this.worldMtx,e[t].strikeLoc),e[t].distance=o,t++}return t-i}}t.CollisionParts=p;class f{constructor(e){this.zoneId=e,this.boundingSphereCenter=null,this.boundingSphereRadius=null,this.parts=[]}addParts(e){this.parts.push(e),null!==this.boundingSphereCenter&&this.calcMinAndMaxRadius()}eraseParts(e){o.arrayRemoveIfExist(this.parts,e)}calcMinAndMaxRadius(){}}class A{constructor(e){this.keeperIdx=e,this.strikeInfoCount=0,this.strikeInfo=o.nArray(32,()=>new d),this.zones=[]}movement(e){for(let e=0;e<this.zones.length;e++){const t=this.zones[e];if(void 0!==t)for(let e=0;e<t.parts.length;e++){const a=t.parts[e];a.validated&&(this.keeperIdx===a.keeperIdx&&a.updateMtx())}}}addToZone(e,t){this.getZone(t).addParts(e)}removeFromZone(e,t){const a=this.zones[t];void 0!==a&&a.eraseParts(e)}getStrikeInfo(e){return this.strikeInfo[e]}checkStrikeLine(e,t,a,r,n=this.strikeInfo.length){let s=0;e:for(let n=0;n<this.zones.length;n++){const i=this.zones[n];if(void 0!==i){i.boundingSphereCenter;for(let n=0;n<i.parts.length;n++){const o=i.parts[n];if(o.validated&&((null===a||!a.isInvalidParts(o))&&(s+=o.checkStrikeLine(this.strikeInfo,s,e,t,r),s>=this.strikeInfo.length)))break e}}}return this.strikeInfoCount=s,s}getZone(e){return void 0===this.zones[e]&&(this.zones[e]=new f(e)),this.zones[e]}}class g extends n.NameObj{constructor(e){super(e,"CollisionDirector"),this.keepers=[];for(let e=0;e<4;e++)this.keepers[e]=new A(e);c.connectToScene(e,this,32,-1,-1,-1)}movement(e,t){super.movement(e,t);for(let t=0;t<this.keepers.length;t++)this.keepers[t].movement(e)}}t.CollisionDirector=g;const _=r.vec3.create();o.nArray(32,()=>new d);function S(e,t,a,n,s,i,l,c){const h=e.collisionDirector;if(null===h)return!1;const d=h.keepers[c],u=d.checkStrikeLine(n,s,l,null);if(0===u)return!1;let m=1/0,p=-1;for(let e=0;e<u;e++){const t=d.getStrikeInfo(e);null!==i&&i.isInvalidTriangle(t)||t.distance<m&&(m=t.distance,p=e)}o.assert(p>=0);const f=d.getStrikeInfo(p);return null!==t&&r.vec3.copy(t,f.strikeLoc),null!==a&&a.copy(f),!0}t.Binder=class{constructor(e,t,a,r,n,s){this.baseMtxRef=e,this.translationRef=t,this.gravityRef=a,this.centerY=r,this.radius=n,this.hitInfoCapacity=s,this.triangleFilter=null,this.offsetVec=null,this.hitInfos=o.nArray(s,()=>new d),this.clear()}bind(e,t){if(r.vec3.copy(_,this.translationRef),null!==this.offsetVec)throw"whoops";null!==this.baseMtxRef?(_[0]+=this.baseMtxRef[4]*this.centerY,_[1]+=this.baseMtxRef[5]*this.centerY,_[2]+=this.baseMtxRef[6]*this.centerY):_[1]+=this.centerY}clear(){this.hitInfoCount=0,this.floorHitDist=-99999,this.wallHitDist=-99999,this.roofHitDist=-99999}setTriangleFilter(e){this.triangleFilter=e}},t.getFirstPolyOnLineCategory=S,t.getFirstPolyOnLineToMap=function(e,t,a,r,n){return S(e,t,a,r,n,null,null,0)},t.calcMapGround=function(e,t,a,n){return r.vec3.set(_,0,-n,0),S(e,t,null,a,_,null,null,0)},t.validateCollisionParts=function(e,t){t.addToBelongZone(e),t.validated=!0},t.invalidateCollisionParts=function(e,t){t.removeFromBelongZone(e),t.validated=!1};const b=r.mat4.create();t.createCollisionPartsFromLiveActor=function(e,t,a,r,n,s){let l;null!==n?l=n:(i.makeMtxTRSFromActor(b,t),l=b);const c=function(e,t,a,r,n,s,i,l){const c=o.assertExists(a.arc.findFileData(`${r}.kcl`)),h=a.arc.findFileData(`${r}.pa`);return new p(e,t,s,n,c,h,l,i)}(e,t.zoneAndLayer,t.resourceHolder,a,r,b,s,0);return null!==n&&(c.hostMtx=n),c}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.parse=function(e){const t=e.createDataView();r.assert("NARC"===r.readString(e,0,6)),r.assert(256===t.getUint16(6,!0)),t.getUint32(8,!0),r.assert(16===t.getUint16(12,!0)),r.assert(3===t.getUint16(14,!0)),r.assert("BTAF"===r.readString(e,16,4));const a=t.getUint32(20,!0),n=e.subarray(24,a-8),s=16+a;r.assert("BTNF"===r.readString(e,s+0,4));const i=t.getUint32(s+4,!0),o=e.subarray(s+8,i-8),l=s+i;r.assert("GMIF"===r.readString(e,l+0,4));const c=t.getUint32(l+4,!0);return function(e,t,a){const n=e.createDataView(),s=t.createDataView(),i=[];function o(e){const t=4+8*e,r=n.getUint32(t+0,!0),s=n.getUint32(t+4,!0);return a.slice(r,s)}if(t.byteLength>0&&function e(a,n){let l=s.getUint32(a+0,!0),c=s.getUint16(a+4,!0);for(;;){const a=s.getUint8(l+0);if(l+=1,0===a)break;const h=!!(128&a),d=127&a,u=`${n}/${r.readString(t,l,d,!1)}`;if(l+=d,h){const t=s.getUint16(l,!0);l+=2,e(8*(4095&t),u)}else{const e=o(c);i.push({path:u,fileId:c,buffer:e}),c++}}}(0,""),0===i.length){const e=n.getUint32(0,!0);for(let t=0;t<e-1;t++){const e=o(t);i.push({path:null,fileId:t,buffer:e})}}return{files:i}}(n,o,e.subarray(l+8,c-8))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(2);function n(e,t){if(!e.hasAnimation)return e.values[0];e.interpolate&&(t*=.5);const a=e.values[0|t],n=e.values[(t+1|0)%(e.values.length-1)];return r.lerp(a,n,t-(0|t))}function s(e,t){if(!e.hasAnimation)return e.values[0];if(e.interpolate&&(t*=.5),t>=e.values.length-1)return e.values[e.values.length-1];const a=e.values[0|t],n=e.values[(t+1|0)%(e.values.length-1)];return r.lerpAngle(a,n,t-(0|t),1)}t.parse=function(e){const t=e.createDataView(),a=t.getUint16(0,!0),r=t.getUint16(2,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0),o=t.getUint32(16,!0);function l(e,a){const n=!!t.getUint8(e+0),s=!!t.getUint8(e+1),i=t.getUint16(e+2,!0),o=s?n?r/2+1:r:1,l=new Float32Array(o);let c=a+2*i;for(let e=0;e<o;e++)l[e]=t.getInt16(c+0,!0)/2048,c+=2;return{interpolate:n,hasAnimation:s,values:l}}function c(e,a){const n=!!t.getUint8(e+0),s=!!t.getUint8(e+1),i=t.getUint16(e+2,!0),o=s?n?r/2+1:r:1,l=new Float32Array(o);let c=a+4*i;for(let e=0;e<o;e++)l[e]=t.getInt32(c+0,!0)/4096,c+=4;return{interpolate:n,hasAnimation:s,values:l}}const h=[];let d=t.getUint32(20,!0);for(let e=0;e<a;e++){const e=c(d+0,s),t=c(d+4,s),a=c(d+8,s),r=l(d+12,i),n=l(d+16,i),u=l(d+20,i),m=c(d+24,o),p=c(d+28,o),f=c(d+32,o);h.push({scaleX:e,scaleY:t,scaleZ:a,rotationX:r,rotationY:n,rotationZ:u,translationX:m,translationY:p,translationZ:f}),d+=36}return{duration:r,loopMode:n,jointAnimationEntries:h}};class i{constructor(e,t){this.animationController=e,this.bca=t}calcJointMatrix(e,t){const a=this.bca.jointAnimationEntries[t];if(!a)return!1;const i=this.animationController.getTimeInFrames(),o=function(e,t){const a=e.duration-1;if(0===e.loopMode)return t>a&&(t=a),t;if(1===e.loopMode){for(;t>a;)t-=a;return t}throw"whoops"}(this.bca,i),l=n(a.scaleX,o),c=n(a.scaleY,o),h=n(a.scaleZ,o),d=s(a.rotationX,o)*Math.PI,u=s(a.rotationY,o)*Math.PI,m=s(a.rotationZ,o)*Math.PI,p=n(a.translationX,o),f=n(a.translationY,o),A=n(a.translationZ,o);return r.computeModelMatrixSRT(e,l,c,h,d,u,m,p,f,A),!0}}t.BCAAnimator=i,t.bindBCAAnimator=function(e,t){return new i(e,t)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(48)),s=a(76),i=a(0),o=a(6),l=a(14),c=a(1);class h{constructor(){this.x=0,this.y=0,this.z=0,this.tx=0,this.ty=0,this.c0=0,this.c1=0,this.c2=0,this.a=0}copy(e){this.x=e.x,this.y=e.y,this.z=e.z,this.tx=e.tx,this.ty=e.ty,this.c0=e.c0,this.c1=e.c1,this.c2=e.c2,this.a=e.a}}t.Vertex=h;class d extends h{constructor(){super(...arguments),this.outputIndex=-1}setFromView(e,t){this.outputIndex=-1,this.x=e.getInt16(t+0),this.y=e.getInt16(t+2),this.z=e.getInt16(t+4),this.tx=e.getInt16(t+8)/32,this.ty=e.getInt16(t+10)/32,this.c0=e.getUint8(t+12)/255,this.c1=e.getUint8(t+13)/255,this.c2=e.getUint8(t+14)/255,this.a=e.getUint8(t+15)/255}}function u(e,t){if(0===e)return t===o.GfxBlendFactor.SRC_ALPHA?o.GfxBlendFactor.ONE_MINUS_SRC_ALPHA:t===o.GfxBlendFactor.ONE?o.GfxBlendFactor.ZERO:o.GfxBlendFactor.ONE;if(1===e)return o.GfxBlendFactor.DST_ALPHA;if(2===e)return o.GfxBlendFactor.ONE;if(3===e)return o.GfxBlendFactor.ZERO;throw"Unknown Blend Param B: "+e}t.translateBlendMode=function(e,t){const a={},r=t>>>28&3,n=t>>>24&3,s=t>>>16&3;if(!!(16384&t)&&1===(t>>>20&3)){let e;i.assert(0===r),e=3===n?o.GfxBlendFactor.ZERO:8192&t&&!(4096&t)?o.GfxBlendFactor.ONE:o.GfxBlendFactor.SRC_ALPHA,l.setAttachmentStateSimple(a,{blendSrcFactor:e,blendDstFactor:u(s,e),blendMode:o.GfxBlendMode.ADD})}else l.setAttachmentStateSimple(a,{blendSrcFactor:o.GfxBlendFactor.ONE,blendDstFactor:o.GfxBlendFactor.ZERO,blendMode:o.GfxBlendMode.ADD});if(a.cullMode=8192&e?4096&e?3:2:4096&e?1:0,16&t){const e=t>>>10&3;a.depthCompare=function(e){if(0===e)return o.GfxCompareMode.GREATER;if(1===e)return o.GfxCompareMode.GREATER;if(2===e)return o.GfxCompareMode.GREATER;if(3===e)return o.GfxCompareMode.GEQUAL;throw"Unknown Z mode: "+e}(e)}return 3===(t>>>10&3)&&(a.polygonOffset=!0),a.depthWrite=0!=(32&t),a};class m{constructor(){this.tile=-1,this.on=!1,this.level=0,this.scaleS=1,this.scaleT=1,this.uls=0,this.ult=0,this.lrs=0,this.lrt=0,this.fmt=0,this.siz=0,this.line=0,this.tmem=0,this.palette=0,this.cmS=0,this.maskS=0,this.shiftS=0,this.cmT=0,this.maskT=0,this.shiftT=0}clone(){const e=new m;return e.tile=this.tile,e.on=this.on,e.level=this.level,e.scaleS=this.scaleS,e.scaleT=this.scaleT,e.uls=this.uls,e.ult=this.ult,e.lrs=this.lrs,e.lrt=this.lrt,e.fmt=this.fmt,e.siz=this.siz,e.line=this.line,e.tmem=this.tmem,e.palette=this.palette,e.cmS=this.cmS,e.maskS=this.maskS,e.shiftS=this.shiftS,e.cmT=this.cmT,e.maskT=this.maskT,e.shiftT=this.shiftT,e}getWidth(){return 0!==this.maskS?1<<this.maskS:1+(this.lrs-this.uls>>>2)}getHeight(){return 0!==this.maskT?1<<this.maskT:1+(this.lrt-this.ult>>>2)}}class p{constructor(){this.SP_GeometryMode=0,this.DP_OtherModeL=0,this.DP_OtherModeH=0,this.textures=[],this.tileDescriptors=[],this.primColor=c.vec4.fromValues(1,1,1,1),this.envColor=c.vec4.fromValues(1,1,1,1),this.firstIndex=0,this.indexCount=0}usesTexture1(){return 1==v(this.DP_OtherModeH)&&n.combineParamsUsesT1(this.DP_Combine)}}t.DrawCall=p;class f{constructor(){this.drawCalls=[],this.currentDrawCall=new p}newDrawCall(e){return this.currentDrawCall=new p,this.currentDrawCall.firstIndex=e,this.drawCalls.push(this.currentDrawCall),this.currentDrawCall}}t.RSPOutput=f;class A{constructor(){this.fmt=0,this.siz=0,this.w=0,this.addr=0}set(e,t,a,r){this.fmt=e,this.siz=t,this.w=a,this.addr=r}}t.TextureImageState=A;class g{constructor(e,t,a,r){this.width=t,this.height=a,this.pixels=r,this.name="Unnamed",this.tile=e.clone()}}function _(e,t,a,r,n){s.parseTLUT(e,t,a,r,n)}t.Texture=g,t.getImageFormatString=function(e,t){return`${s.getImageFormatName(e)}${s.getImageSizeName(t)}`},t.getTextFiltFromOtherModeH=function(e){return e>>>12&3};const S=new Uint8Array(1024);function b(e,t,a){switch(t.fmt<<4|t.siz){case 2:return function(e,t){const a=t.getWidth(),r=t.getHeight(),n=new Uint8Array(a*r*4);return s.decodeTex_RGBA16(n,e,8*t.tmem,a,r),new g(t,a,r,n)}(e,t);case 3:return function(e,t){const a=t.getWidth(),r=t.getHeight(),n=new Uint8Array(a*r*4);return s.decodeTex_RGBA32(n,e,8*t.tmem,a,r),new g(t,a,r,n)}(e,t);case 32:return function(e,t,a){const r=256+(t.palette<<4);_(S,e,r,0,a);const n=t.getWidth(),i=t.getHeight(),o=2048+8*t.tmem,l=new Uint8Array(n*i*4);return s.decodeTex_CI4(l,e,o,n,i,S),new g(t,n,i,l)}(e,t,a);case 33:return function(e,t,a){const r=t.getWidth(),n=t.getHeight(),i=256+(t.palette<<4);_(S,e,i,1,a);const o=2048+8*t.tmem,l=new Uint8Array(r*n*4);return s.decodeTex_CI8(l,e,o,r,n,S),new g(t,r,n,l)}(e,t,a);case 48:return function(e,t){const a=t.getWidth(),r=t.getHeight(),n=new Uint8Array(a*r*4);return s.decodeTex_IA4(n,e,8*t.tmem,a,r),new g(t,a,r,n)}(e,t);case 49:return function(e,t){const a=t.getWidth(),r=t.getHeight(),n=new Uint8Array(a*r*4);return s.decodeTex_IA8(n,e,8*t.tmem,a,r),new g(t,a,r,n)}(e,t);case 50:return function(e,t){const a=t.getWidth(),r=t.getHeight(),n=new Uint8Array(a*r*4);return s.decodeTex_IA16(n,e,8*t.tmem,a,r),new g(t,a,r,n)}(e,t);case 64:return function(e,t){const a=t.getWidth(),r=t.getHeight(),n=new Uint8Array(a*r*4);return s.decodeTex_I4(n,e,8*t.tmem,a,r),new g(t,a,r,n)}(e,t);case 65:return function(e,t){const a=t.getWidth(),r=t.getHeight(),n=new Uint8Array(a*r*4);return s.decodeTex_I8(n,e,8*t.tmem,a,r),new g(t,a,r,n)}(e,t);default:console.warn(`Unknown image format ${t.fmt} / ${t.siz}`);const r=t.getWidth(),n=t.getHeight();return new g(t,r,n,new Uint8Array(r*n*4))}}function v(e){return e>>>20&3}t.RSPSharedOutput=class{constructor(){this.vertices=[],this.indices=[]}setVertexBufferFromData(e){const t=new d;for(let a=0;a<e.byteLength;a+=16)t.setFromView(e,a),this.loadVertex(t)}loadVertex(e){if(-1===e.outputIndex){const t=new h;t.copy(e),this.vertices.push(t),e.outputIndex=this.vertices.length-1}}},t.getCycleTypeFromOtherModeH=v;t.RSPState=class{constructor(e,t){this.rom=e,this.sharedOutput=t,this.output=new f,this.stateChanged=!1,this.vertexCache=i.nArray(64,()=>new d),this.SP_GeometryMode=516,this.DP_OtherModeL=0,this.DP_OtherModeH=1056768,this.DP_CombineL=0,this.DP_CombineH=0,this.DP_TextureImageState=new A,this.tileDescriptors=i.nArray(8,()=>new m),this.tileNum=0,this.tmem=new Uint8Array(4096),this.primColor=c.vec4.fromValues(1,1,1,1),this.envColor=c.vec4.fromValues(.5,.5,.5,.5),this.modelViewMats=i.nArray(32,()=>c.mat4.create()),this.modelViewIndex=0,this.projectionMat=c.mat4.create();for(let e=0;e<8;e++)this.tileDescriptors[e].tile=e}finish(){return 0===this.output.drawCalls.length?null:this.output}_usesTexture1(){const e=n.decodeCombineParams(this.DP_CombineH,this.DP_CombineL);return 1==v(this.DP_OtherModeH)&&n.combineParamsUsesT1(e)}_setGeometryMode(e){this.SP_GeometryMode!==e&&(this.stateChanged=!0,this.SP_GeometryMode=e)}gSPSetGeometryMode(e){this._setGeometryMode(this.SP_GeometryMode|e)}gSPClearGeometryMode(e){this._setGeometryMode(this.SP_GeometryMode&~e)}gSPMatrix(e,t,a){let r;try{r=e.lookupAddress(t)}catch(e){return void console.error(e)}const n=r.buffer.createDataView();let s=r.offs;const i=[];for(let e=0;e<16;e++)i.push(n.getUint32(s)),s+=4;function o(e){const t=new DataView(new ArrayBuffer(4));return t.setUint32(0,e),t.getInt32(0)}const l=c.mat4.create();for(let e=0;e<4;e++)for(let t=0;t<2;t++){const a=4294901760&i[0]|i[8]>>16&65535,r=i[0]<<16&4294901760|65535&i[8],n=o(a),s=o(r);l[4*e+(2*t+0)]=n/65536,l[4*e+(2*t+1)]=s/65536}4&a?2&a?c.mat4.copy(this.projectionMat,l):c.mat4.mul(this.projectionMat,l,this.projectionMat):(1&a&&this.modelViewIndex<32&&(c.mat4.copy(this.modelViewMats[this.modelViewIndex+1],this.modelViewMats[this.modelViewIndex]),this.modelViewIndex++),2&a?c.mat4.copy(this.modelViewMats[this.modelViewIndex],l):c.mat4.mul(this.modelViewMats[this.modelViewIndex],l,this.modelViewMats[this.modelViewIndex])),this.stateChanged=!0}gSPTexture(e,t,a,r,n){this.tileNum=t;const s=this.tileDescriptors[t];s.on=e,e&&(s.level=a,s.scaleS=r,s.scaleT=n),this.stateChanged=!0}gSPVertex(e,t,a,r){const n=e.lookupAddress(t),s=n.buffer.createDataView();let i=n.offs;for(let e=0;e<a;e++)this.vertexCache[r+e].setFromView(s,i),i+=16}_flushTextures(e){e.textures=[],e.tileDescriptors=[];const t=this.tileDescriptors[this.tileNum];if(t.on)if(!!(this.DP_OtherModeH>>>16&1))i.assert(!1);else{const a=v(this.DP_OtherModeH);i.assert(0===a||1===a);const r=this.DP_OtherModeH>>>14&3;if(e.textures[0]=b(new DataView(this.tmem.buffer),t,r),e.tileDescriptors[0]=t.clone(),this._usesTexture1()){const t=this.tileDescriptors[this.tileNum+1&7];e.textures[1]=b(new DataView(this.tmem.buffer),t,r),e.tileDescriptors[1]=t.clone()}}}_flushDrawCall(){if(this.stateChanged){this.stateChanged=!1;const e=this.output.newDrawCall(this.sharedOutput.indices.length);this._flushTextures(e),e.SP_GeometryMode=this.SP_GeometryMode,e.DP_Combine=n.decodeCombineParams(this.DP_CombineH,this.DP_CombineL),e.DP_OtherModeH=this.DP_OtherModeH,e.DP_OtherModeL=this.DP_OtherModeL,e.primColor=c.vec4.clone(this.primColor),e.envColor=c.vec4.clone(this.envColor)}}gSPTri(e,t,a){window.debug&&console.log("EXEC TRI"),this._flushDrawCall(),this.sharedOutput.loadVertex(this.vertexCache[e]),this.sharedOutput.loadVertex(this.vertexCache[t]),this.sharedOutput.loadVertex(this.vertexCache[a]),this.sharedOutput.indices.push(this.vertexCache[e].outputIndex,this.vertexCache[t].outputIndex,this.vertexCache[a].outputIndex),this.output.currentDrawCall.indexCount+=3}gDPSetTextureImage(e,t,a,r){this.DP_TextureImageState.set(e,t,a,r)}gDPSetTile(e,t,a,r,n,s,i,o,l,c,h,d){const u=this.tileDescriptors[n];u.fmt=e,u.siz=t,u.line=a,u.tmem=r,u.palette=s,u.cmT=i,u.maskT=o,u.shiftT=l,u.cmS=c,u.maskS=h,u.shiftS=d,this.stateChanged=!0}gDPLoadTLUT(e,t){try{const a=this.rom.lookupAddress(this.DP_TextureImageState.addr),r=a.buffer.createDataView(),n=256+(this.tileDescriptors[e].palette<<4);for(let e=0;e<4*(t+1);e++)this.tmem[n+e]=r.getUint8(a.offs+e)}catch(e){console.error(e)}this.stateChanged=!0}gDPLoadBlock(e,t,a,r,n){i.assert(0===t&&0===a),i.assert(7===e);try{const t=this.tileDescriptors[e],a=this.rom.lookupAddress(this.DP_TextureImageState.addr),n=a.buffer.createDataView(),s=2==this.DP_TextureImageState.fmt?2048:8*t.tmem,i=(function(e){switch(e){case 0:return 4;case 1:return 8;case 2:return 16;case 3:return 32}}(this.DP_TextureImageState.siz)*(r+1)+7)/8|0;for(let e=0;e<i;e++)this.tmem[s+e]=n.getUint8(a.offs+e)}catch(e){console.error(e)}this.stateChanged=!0}gDPSetTileSize(e,t,a,r,n){const s=this.tileDescriptors[e];s.uls=t,s.ult=a,s.lrs=r,s.lrt=n,this.stateChanged=!0}gDPSetOtherModeL(e,t,a){const r=(1<<t)-1<<e,n=this.DP_OtherModeL&~r|a&r;n!==this.DP_OtherModeL&&(this.DP_OtherModeL=n,this.stateChanged=!0)}gDPSetOtherModeH(e,t,a){const r=(1<<t)-1<<e,n=this.DP_OtherModeH&~r|a&r;n!==this.DP_OtherModeH&&(this.DP_OtherModeH=n,this.stateChanged=!0)}setPrimColor(e,t,a,r){this.primColor=c.vec4.fromValues(e,t,a,r),this.stateChanged=!0}setEnvColor(e,t,a,r){this.envColor=c.vec4.fromValues(e,t,a,r),this.stateChanged=!0}gDPSetCombine(e,t){this.DP_CombineH===e&&this.DP_CombineL===t||(this.DP_CombineH=e,this.DP_CombineL=t,this.stateChanged=!0)}},t.runDL_F3DZEX=function e(t,a,r){let n;try{n=a.lookupAddress(r)}catch(e){return void console.warn(e)}const s=n.buffer.createDataView();e:for(let r=n.offs;;r+=8){const n=s.getUint32(r+0),i=s.getUint32(r+4),o=n>>>24;switch(o){case 223:break e;case 222:e(t,a,i);break;case 3:break;case 217:t.gSPClearGeometryMode(16777215&n),t.gSPSetGeometryMode(i);break;case 1:{const e=n>>>12&255,r=(n>>>1&255)-e;t.gSPVertex(a,i,e,r)}break;case 218:{const e=255&n,r=i;t.gSPMatrix(a,r,1^e)}break;case 5:{const e=(n>>>16&255)/2,a=(n>>>8&255)/2,r=(n>>>0&255)/2;t.gSPTri(e,a,r)}break;case 6:{const e=(n>>>16&255)/2,a=(n>>>8&255)/2,r=(n>>>0&255)/2;t.gSPTri(e,a,r)}{const e=(i>>>16&255)/2,a=(i>>>8&255)/2,r=(i>>>0&255)/2;t.gSPTri(e,a,r)}break;case 215:{const e=n>>>11&7;let a=n>>>8&7;const r=!!(n>>>0&127),s=i>>>16&65535,o=i>>>0&65535;t.gSPTexture(r,a,e,s,o)}break;case 253:{const e=n>>>21&7,a=n>>>19&3,r=1+(4095&n);t.gDPSetTextureImage(e,a,r,i)}break;case 245:{const e=n>>>21&7,a=n>>>19&3,r=n>>>9&511,s=n>>>0&511,o=i>>>24&7,l=i>>>20&15,c=i>>>18&3,h=i>>>14&15,d=i>>>10&15,u=i>>>8&3,m=i>>>4&15,p=i>>>0&15;t.gDPSetTile(e,a,r,s,o,l,c,h,d,u,m,p)}break;case 242:{const e=n>>>12&4095,a=n>>>0&4095,r=i>>>24&7,s=i>>>12&4095,o=i>>>0&4095;t.gDPSetTileSize(r,e,a,s,o)}break;case 240:{const e=i>>>24&7,a=i>>>14&1023;t.gDPLoadTLUT(e,a)}break;case 243:{const e=n>>>12&4095,a=n>>>0&4095,r=i>>>24&7,s=i>>>12&4095,o=i>>>0&4095;t.gDPLoadBlock(r,e,a,s,o)}break;case 252:t.gDPSetCombine(16777215&n,i);break;case 227:{const e=1+(n>>>0&255),a=Math.max(0,32-(n>>>8&255)-e);t.gDPSetOtherModeH(a,e,i)}break;case 226:{const e=1+(n>>>0&255),a=Math.max(0,32-(n>>>8&255)-e);t.gDPSetOtherModeL(a,e,i)}break;case 250:{const e=(i>>>24&255)/255,a=(i>>>16&255)/255,r=(i>>>8&255)/255,n=(i>>>0&255)/255;t.setPrimColor(e,a,r,n)}break;case 251:{const e=(i>>>24&255)/255,a=(i>>>16&255)/255,r=(i>>>8&255)/255,n=(i>>>0&255)/255;t.setEnvColor(e,a,r,n)}break;case 233:case 232:case 231:case 230:break;default:console.error(`Unknown DL opcode: ${o.toString(16)}`)}}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(62)),s=r(a(67)),i=r(a(45)),o=r(a(80)),l=r(a(96)),c=r(a(11)),h=a(68),d=a(9),u=a(33),m=a(7),p=a(23),f=a(8);class A extends h.CtrTextureHolder{findTextureEntryIndex(e){let t=-1;return t=this.searchTextureEntryIndex(e),t>=0?t:(t=this.searchTextureEntryIndex(`${e.split("/")[2]}.ctxb`),t)}addCMB(e,t){this.addTextures(e,t.textures.filter(e=>e.levels.length>0))}addCTXB(e,t){this.addTextures(e,t.textures.map(e=>{const t=`${e.name.split("/")[2]}.ctxb`;return Object.assign(Object.assign({},e),{name:t})}))}}t.GrezzoTextureHolder=A;const g=[{numSamplers:3,numUniformBuffers:3}];t.MultiCmbScene=class{constructor(e,t){this.textureHolder=t,this.renderTarget=new d.BasicRenderTarget,this.cmbData=[],this.cmbRenderers=[],this.renderInstManager=new m.GfxRenderInstManager,this.cmab=[],this.csab=[],this.renderInstManager=new m.GfxRenderInstManager,this.uniformBuffer=new u.GfxRenderDynamicUniformBuffer(e)}prepareToRender(e,t,a){const r=this.renderInstManager.pushTemplateRenderInst();r.setUniformBuffer(this.uniformBuffer),r.setBindingLayouts(g),h.fillSceneParamsDataOnTemplate(r,a.camera);for(let r=0;r<this.cmbRenderers.length;r++)this.cmbRenderers[r].prepareToRender(e,this.renderInstManager,t,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,d.standardFullClearRenderPassDescriptor);return this.renderInstManager.drawOnPassRenderer(e,r),this.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderInstManager.destroy(e),this.uniformBuffer.destroy(e),this.renderTarget.destroy(e),this.textureHolder.destroy(e);for(let t=0;t<this.cmbRenderers.length;t++)this.cmbRenderers[t].destroy(e);for(let t=0;t<this.cmbData.length;t++)this.cmbData[t].destroy(e)}createPanels(){const e=new c.Panel;e.customHeaderBackgroundColor=c.COOL_BLUE_COLOR,e.setTitle(c.RENDER_HACKS_ICON,"Render Hacks");const t=new c.Checkbox("Enable Vertex Colors",!0);t.onchanged=()=>{for(let e=0;e<this.cmbRenderers.length;e++)this.cmbRenderers[e].setVertexColorsEnabled(t.checked)},e.contents.appendChild(t.elem);const a=new c.Checkbox("Enable Textures",!0);a.onchanged=()=>{for(let e=0;e<this.cmbRenderers.length;e++)this.cmbRenderers[e].setTexturesEnabled(a.checked)},e.contents.appendChild(a.elem);const r=new c.Checkbox("Grayscale Vertex Colors",!1);return r.onchanged=()=>{for(let e=0;e<this.cmbRenderers.length;e++)this.cmbRenderers[e].setMonochromeVertexColorsEnabled(r.checked)},e.contents.appendChild(r.elem),[e,new c.LayerPanel(this.cmbRenderers)]}};class _ extends c.ScrollSelect{constructor(){super(...arguments),this.itemIsOn=[]}itemFocused(e,t){this.onitemrequestselect(e,!this.itemIsOn[e])&&this.syncInternalFlairs()}syncInternalFlairs(){const e=[...this.flairs];for(let t=0;t<this.getNumItems();t++)if(this.itemIsOn[t]){const a=c.ensureFlairIndex(e,t);a.background=c.HIGHLIGHT_COLOR,a.fontWeight="bold"}this.setInternalFlairs(e)}setItemSelected(e,t){this.itemIsOn[e]=t,this.syncInternalFlairs()}}class S{constructor(e,t){this.device=e,this.archive=t,this.renderTarget=new d.BasicRenderTarget,this.textureHolder=new A,this.cmbData=[],this.cmbRenderers=[],this.clearRenderPassDescriptor=d.standardFullClearRenderPassDescriptor,this.renderHelper=new p.GfxRenderHelper(e)}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();r.setBindingLayouts(g),h.fillSceneParamsDataOnTemplate(r,a.camera);for(let r=0;r<this.cmbRenderers.length;r++)this.cmbRenderers[r].prepareToRender(e,this.renderHelper.renderInstManager,t,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,this.clearRenderPassDescriptor);return this.renderHelper.renderInstManager.drawOnPassRenderer(e,r),this.renderHelper.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e),this.textureHolder.destroy(e);for(let t=0;t<this.cmbRenderers.length;t++)this.cmbRenderers[t].destroy(e);for(let t=0;t<this.cmbData.length;t++)this.cmbData[t].destroy(e)}isFileSupported(e){return e.name.endsWith(".cmb")||e.name.endsWith(".cmab")||e.name.endsWith(".csab")}loadCMBFile(e){const t=this.device;for(let e=0;e<this.cmbRenderers.length;e++)this.cmbRenderers[e].destroy(t);for(let e=0;e<this.cmbData.length;e++)this.cmbData[e].destroy(t);this.cmbRenderers=[],this.cmbData=[];const a=i.parse(e.buffer),r=new h.CmbData(t,a);this.textureHolder.destroy(t),this.textureHolder.addTextures(t,a.textures),this.cmbData.push(r);const n=new h.CmbInstance(t,this.textureHolder,r,e.name);this.cmbRenderers.push(n)}createCameraController(){const e=new f.OrbitCameraController;return e.z-=4e3,e}createPanels(){const e=new c.Panel;e.setTitle(c.LAYER_ICON,"Archive Files");const t=new _;t.setTextSelectable(!0);const a=this.archive.files.map(e=>this.isFileSupported(e)?{type:0,name:e.name}:{type:1,html:e.name});t.setItems(a),t.onitemrequestselect=(e,a)=>{const r=this.archive.files[e];if(r.name.endsWith(".cmb")){if(!a)return!1;this.loadCMBFile(r);for(let a=0;a<this.archive.files.length;a++)t.itemIsOn[a]=e===a;return!0}if(r.name.endsWith(".cmab")){if(!a)return!1;const s=n.parse(this.archive.version,r.buffer);this.textureHolder.addTextures(this.device,s.textures);for(let e=0;e<this.cmbRenderers.length;e++)this.cmbRenderers[e].bindCMAB(s);for(let a=0;a<this.archive.files.length;a++)this.archive.files[a].name.endsWith(".cmab")&&(t.itemIsOn[a]=e===a);return!0}if(r.name.endsWith(".csab")){const a=s.parse(this.archive.version,r.buffer);for(let e=0;e<this.cmbRenderers.length;e++)this.cmbRenderers[e].bindCSAB(a);for(let a=0;a<this.archive.files.length;a++)this.archive.files[a].name.endsWith(".csab")&&(t.itemIsOn[a]=e===a);return!0}return!1},e.contents.appendChild(t.elem);for(let e=0;e<this.archive.files.length;e++){if(this.archive.files[e].name.endsWith(".cmb")){t.itemFocused(e,!0);break}}return[e]}}t.createSceneFromZARBuffer=function(e,t){return new S(e,o.parse(l.maybeDecompress(t)))}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(6),s=a(116),i=r(a(117)),o=r(a(81));s.WorldRenderer;class l{constructor(e,t=e){this.id=e,this.name=t}async createScene(e,t){const a=t.dataFetcher,[r,l,c]=await Promise.all([a.fetchData(`PaperMarioTTYD/m/${this.id}/d.blob`),a.fetchData(`PaperMarioTTYD/m/${this.id}/t.blob`),a.fetchData(`PaperMarioTTYD/b/${this.id}.tpl`,1)]),h=o.parse(r),d=new s.TPLTextureHolder,u=i.parse(l,h.textureNameTable);d.addTPLTextures(e,u);let m=null;if(c.byteLength>0){m=`bg_${this.id}`;const t=i.parse(c,[m]);d.addTPLTextures(e,t)}if(d.hasTexture("tou_k_dummy")){const t=e.createTexture(n.makeTextureDescriptor2D(n.GfxFormat.U8_RGBA_NORM,1,1,1)),a=e.createHostAccessPass();a.uploadTextureData(t,0,[new Uint8Array([0,255,0,255])]),e.submitPass(a),d.setTextureOverride("tou_k_dummy",{width:1,height:1,flipY:!1,gfxTexture:t})}return new s.WorldRenderer(e,h,d,m)}}t.createWorldRendererFromBuffers=function(e,t,a){const r=o.parse(t),n=new s.TPLTextureHolder,l=i.parse(a,r.textureNameTable);return n.addTPLTextures(e,l),new s.WorldRenderer(e,r,n,null)};const c=["Intro",new l("aaa_00","Mario's House"),"Rogueport",new l("gor_00","Harbor"),new l("gor_01","Main Square"),new l("gor_02","East Side"),new l("gor_03","West Side"),new l("gor_04","Station"),new l("gor_10","Arrival (Cutscene)"),new l("gor_11","Outside (Dusk)"),new l("gor_12","Outside (Dawn)"),"Rogueport Sewers",new l("tik_00","Underground Shop Area"),new l("tik_01","East Side Entrance"),new l("tik_02","Pipe To Petal Meadows"),new l("tik_03","Pipe To Boggly Woods"),new l("tik_04","Staircase Room"),new l("tik_05","Thousand-Year Door Room"),new l("tik_06","Entrance To The Pit Of 100 Trials"),new l("tik_07","West Side Entrance"),new l("tik_08","Pipe To Twilight Town"),new l("tik_11","Chet Rippo's House"),new l("tik_12","Merlee The Charmer's House"),new l("tik_13","Storage Room"),new l("tik_15","Garden-Variety Corridor"),new l("tik_16","Underground Corridor #1"),new l("tik_17","Underground Corridor #2"),new l("tik_18","Underground Corridor #3"),new l("tik_19","Black Chest Room"),new l("tik_20","Undiscovered Chamber"),new l("tik_21","Spike Trap Room"),"Chapter 1 - Petal Meadows",new l("hei_00","Pipe To Hooktail Castle"),new l("hei_01","River Bridge"),new l("nok_00","Petalburg: West Side"),new l("nok_01","Petalburg: East Side"),new l("hei_02","Path To Shhwonk Fortress #1"),new l("hei_03","Pedestal Room #1"),new l("hei_04","Path To Shhwonk Fortress #2"),new l("hei_05","Pedestal Room #2"),new l("hei_06","Path To Shhwonk Fortress #3"),new l("hei_07","Shwonk Fortress: Entrance"),new l("hei_08","Shwonk Fortress: Moon Stone Room"),new l("hei_09","Shwonk Fortress: Western Room"),new l("hei_10","Shwonk Fortress: Red Block Room"),new l("hei_11","Shwonk Fortress: Eastern Room"),new l("hei_12","Shwonk Fortress: Sun Stone Room"),new l("hei_13","Long Pipe Area"),"Chapter 1 - Hooktail Castle",new l("gon_00","Entrance"),new l("gon_01","Garden"),new l("gon_02","Corridor"),new l("gon_03","Red Bones' Room"),new l("gon_04","Great Hall"),new l("gon_05","Save Block Room"),new l("gon_06","Black Chest Room"),new l("gon_07","Spike Trap Room"),new l("gon_08","Green Block Room"),new l("gon_09","Yellow Block Room"),new l("gon_10","Tower"),new l("gon_11","Hooktail's Lair"),new l("gon_12","Treasure Room"),new l("gon_13","Hidden Room"),"Chapter 2 - Boggly Woods",new l("win_00","Western Field"),new l("win_01","Pipe To The Great Tree"),new l("win_02","Eastern Field"),new l("win_03","Pipe To Flurrie's House"),new l("win_04","Flurrie's House: Entrance"),new l("win_05","Flurrie's House: Bedroom"),new l("win_06","Pipe Entrance"),"Chapter 2 - The Great Boggly Tree",new l("mri_00","Base Of The Tree"),new l("mri_01","Entrance"),new l("mri_02","Punies Switch Room"),new l("mri_03","Red & Blue Cell Room"),new l("mri_04","Storage Room"),new l("mri_05","Bubble Room"),new l("mri_06","Red Block Room"),new l("mri_07","Hidden Shop"),new l("mri_08","Punies vs. 10 Jabbies"),new l("mri_09","Blue Key Room"),new l("mri_10","Big Treasure Chest Room"),new l("mri_11","Punies vs. 100 Jabbies"),new l("mri_12","Big Pedestal Room"),new l("mri_13","101 Punies Switch Room"),new l("mri_14","Lowest Chamber"),new l("mri_15","Control Panel Room"),new l("mri_16","Water Room"),new l("mri_17","Cage Room"),new l("mri_18","Passageway Room #1"),new l("mri_19","Plane Tile Room"),new l("mri_20","Passageway Room #2"),"Chapter 3 - Glitzville",new l("tou_00","Cutscene: Arrival at Glitzville"),new l("tou_01","Main Square"),new l("tou_02","Glitz Pit Lobby"),new l("tou_03","Glitz Pit"),new l("tou_04","Backstage Corridor"),new l("tou_05","Promoter's Room"),new l("tou_06","Glitz Pit Storage Room"),new l("tou_07","Champ's Room"),new l("tou_08","Major-League Locker Room"),new l("tou_09","Major-League Locker Room (Locked)"),new l("tou_10","Minor-League Locker Room"),new l("tou_11","Minor-League Locker Room (Locked)"),new l("tou_12","Glitz Pit Top Floor Storage Room"),new l("tou_13","Ventilation Duct"),new l("tou_20","Cutscene: Cheep Blimp"),"Chapter 4 - Twilight Town",new l("usu_00","West Side"),new l("usu_01","East Side"),"Chapter 4 - Twilight Trail",new l("gra_00","Shed Area"),new l("gra_01","Long Path"),new l("gra_02","Fallen Tree Area"),new l("gra_03","Twilight Woods"),new l("gra_04","Huge Tree Area"),new l("gra_05","Boulder Area"),new l("gra_06","Outside Creepy Steeple"),"Chapter 4 - Creepy Steeple",new l("jin_00","Entrance"),new l("jin_01","Northern Courtyard"),new l("jin_02","Southern Courtyard"),new l("jin_03","Staircase Room"),new l("jin_04","Belfry"),new l("jin_05","Storage Room"),new l("jin_06","Hidden Room"),new l("jin_07","Underground Corridor"),new l("jin_08","Underground Room"),new l("jin_09","Well's Bottom"),new l("jin_10","Buzzy Beetles Room"),new l("jin_11","Door-Shaped Object Room"),"Chapter 5 - Keelhaul Key",new l("muj_00","Entrance"),new l("muj_01","Shantytown"),new l("muj_02","Jungle Path"),new l("muj_03","Cliff Area"),new l("muj_04","Rope Bridge"),new l("muj_05","Mustache Statues"),new l("muj_21","Cutscene: Mario & Peach"),"Chapter 5 - Pirate's Grotto",new l("dou_00","Entrance"),new l("dou_01","Springboard Room"),new l("dou_02","Spike Trap Room #1"),new l("dou_03","Sluice Gate Room"),new l("dou_04","Black Key Room"),new l("dou_05","Save Block Room"),new l("dou_06","Parabuzzy Room"),new l("dou_07","Black Chest Room"),new l("dou_08","Sunken Ship"),new l("dou_09","Platform Room"),new l("dou_10","Spike Trap Room #2"),new l("dou_11","Exit"),new l("dou_12","Bill Blaster Bridge"),new l("dou_13","Long Corridor"),new l("muj_10","Deepest Part"),"Chapter 5 - Cortez's Ship",new l("muj_11","Entrance"),new l("muj_12","Captain's Cabin"),new l("muj_20","Outside (Cutscene)"),"Chapter 6 - Excess Express",new l("rsh_00_a","Right Engineer's Car (Day)"),new l("rsh_00_b","Right Engineer's Car (Dusk)"),new l("rsh_00_c","Right Engineer's Car (Night)"),new l("rsh_01_a","Cabins #1-2 (Day)"),new l("rsh_01_b","Cabins #1-2 (Dusk)"),new l("rsh_01_c","Cabins #1-2 (Night)"),new l("rsh_02_a","Cabins #3-5 (Day)"),new l("rsh_02_b","Cabins #3-5 (Dusk)"),new l("rsh_02_c","Cabins #3-5 (Night)"),new l("rsh_03_a","Dining Car (Day)"),new l("rsh_03_b","Dining Car (Dusk)"),new l("rsh_03_c","Dining Car (Night)"),new l("rsh_04_a","Cabins #6-8 (Day)"),new l("rsh_04_b","Cabins #6-8 (Dusk)"),new l("rsh_04_c","Cabins #6-8 (Night)"),new l("rsh_05_a","Left Freight Car"),new l("rsh_06_a","Train's Roof"),new l("rsh_07_a","Left Engineer's Car (Day)"),new l("rsh_07_b","Left Engineer's Car (Dusk)"),new l("rsh_07_c","Left Engineer's Car (Night)"),new l("rsh_08_a","Right Freight Car"),new l("hom_10","Cutscene: To Poshley Heights #1"),new l("hom_11","Cutscene: To Riverside Station"),new l("hom_12","Cutscene: To Poshley Heights #2"),"Chapter 6 - Riverside Station",new l("hom_00","Outside"),new l("eki_00","Entrance"),new l("eki_01","Wooden Gates Room"),new l("eki_02","Big Clock Room"),new l("eki_03","Outer Stairs"),new l("eki_04","Garbage Dump"),new l("eki_05","Office"),new l("eki_06","Records Room"),"Chapter 6 - Poshley Heights",new l("pik_00","Train Station"),new l("pik_04","Main Square"),new l("pik_01","Outside Poshley Sanctum"),new l("pik_02","Fake Poshley Sanctum"),new l("pik_03","Real Poshley Sanctum"),"Chapter 7 - Fahr Outpost",new l("bom_00","Pipe Entrance"),new l("bom_01","West Side"),new l("bom_02","East Side"),new l("bom_03","Field #1"),new l("bom_04","Field #2"),"Chapter 7 - The Moon",new l("moo_00","Save Block Area"),new l("moo_01","Moon Stage #1"),new l("moo_02","Pipe To X-Naut Fortress"),new l("moo_05","Moon Stage #2"),new l("moo_06","Moon Stage #3"),new l("moo_07","Moon Stage #4"),new l("moo_03","Cutscene #1"),new l("moo_04","Cutscene #2"),"Chapter 7 - The X-Naut Fortress",new l("aji_00","Entrance"),new l("aji_01","Elevator Corridor"),new l("aji_02","Electric Tile Room (Lvl 1)"),new l("aji_03","Storage Room"),new l("aji_04","Thwomp Statue Room"),new l("aji_05","Electric Tile Room (Lvl 2)"),new l("aji_06","Grodus's Lab"),new l("aji_07","Teleporter Room"),new l("aji_08","Genetic Lab"),new l("aji_09","Changing Room"),new l("aji_10","Control Room"),new l("aji_11","Office"),new l("aji_12","Electric Tile Room (Lvl 3)"),new l("aji_13","Factory"),new l("aji_14","Magnus Von Grapple's Room"),new l("aji_15","Shower Room"),new l("aji_16","Locker Room"),new l("aji_17","Computer Room"),new l("aji_18","Card Key Room"),new l("aji_19","Conveyor Belt"),"The Pit of 100 Trials",new l("jon_00","Regular Floor #1"),new l("jon_01","Regular Floor #2"),new l("jon_02","Regular Floor #3"),new l("jon_03","Intermediate Floor #1"),new l("jon_04","Intermediate Floor #2"),new l("jon_05","Intermediate Floor #3"),new l("jon_06","Lowest Floor"),"Bowser",new l("kpa_00","Bowser's Castle: Outside"),new l("kpa_01","Bowser's Castle: Hall"),new l("kpa_02","Super Koopa Bros.: World 1"),new l("kpa_03","Super Koopa Bros.: World 2 (Part 1)"),new l("kpa_04","Super Koopa Bros.: World 2 (Part 2)"),new l("kpa_05","Super Koopa Bros.: World 3 (Part 1)"),new l("kpa_06","Super Koopa Bros.: World 3 (Part 2)"),new l("kpa_07","Bowser's Castle: Mini-Gym"),"Chapter 8 - Palace of Shadow",new l("las_00","Entrance"),new l("las_01","Long Stairway"),new l("las_02","Long Corridor"),new l("las_03","Spike Trap Room"),new l("las_04","Large Bridge Room"),new l("las_05","Humongous Room"),new l("las_06","Long Hall"),new l("las_07","Red & Yellow Blocks Room"),new l("las_08","Staircase Room"),new l("las_09","Palace Garden"),new l("las_10","Tower Entrance"),new l("las_11","Riddle Room #1"),new l("las_12","Riddle Room #2"),new l("las_13","Riddle Room #3"),new l("las_14","Riddle Room #4"),new l("las_15","Riddle Room #5"),new l("las_16","Riddle Room #6"),new l("las_17","Riddle Room #7"),new l("las_18","Riddle Room #8"),new l("las_19","Corridor #1"),new l("las_20","Seven Stars Room (Part 1)"),new l("las_21","Corridor #2"),new l("las_22","Seven Stars Room (Part 2)"),new l("las_23","Corridor #3"),new l("las_24","Seven Stars Room (Part 3)"),new l("las_25","Corridor #4"),new l("las_26","Gloomtail's Room"),new l("las_27","Weird Room"),new l("las_28","Main Hall"),new l("las_29","Deepest Room"),new l("las_30","Long Staircase Room"),"Extra",new l("yuu_00","Pianta Parlor: Plane Game"),new l("yuu_01","Pianta Parlor: Boat Game"),new l("yuu_02","Pianta Parlor: Tube Game"),new l("yuu_03","Pianta Parlor: Paper Game"),new l("bti_01","Battle Stage: Rising Star"),new l("bti_02","Battle Stage: B-List Star"),new l("bti_03","Battle Stage: A-List Star"),new l("bti_04","Battle Stage: Superstar"),new l("stg_01","Battle Stage: Red (Unused)"),new l("stg_02","Battle Stage: Green (Unused)"),new l("stg_03","Battle Stage: Blue (Unused)"),new l("stg_04","Battle Stage: White (Unused)"),new l("tik_09","Pit of 100 Trials Intermediate Floor #1 (Unused)"),new l("tik_10","Pit of 100 Trials Intermediate Floor #2 (Unused)"),new l("tik_14","Pit of 100 Trials Lower Floor (Unused)"),new l("rsh_05_b"),new l("rsh_05_c"),new l("rsh_06_b"),new l("rsh_06_c"),"Battle Backgrounds",new l("stg_00_0"),new l("stg_00_1"),new l("stg_00_2"),new l("stg_00_3"),new l("stg_00_4"),new l("stg_01_0"),new l("stg_01_1"),new l("stg_01_2"),new l("stg_01_3"),new l("stg_01_4"),new l("stg_01_5"),new l("stg_01_6"),new l("stg_02_0"),new l("stg_02_1"),new l("stg_03_0"),new l("stg_04_0"),new l("stg_04_1"),new l("stg_04_2"),new l("stg_04_3"),new l("stg_04_4"),new l("stg_04_5"),new l("stg_04_6"),new l("stg_05_0"),new l("stg_05_1"),new l("stg_05_2"),new l("stg_05_3"),new l("stg_05_4"),new l("stg_05_5"),new l("stg_06_0"),new l("stg_06_1"),new l("stg_06_2"),new l("stg_06_3"),new l("stg_06_4"),new l("stg_07_0"),new l("stg_07_1"),new l("stg_07_2"),new l("stg_07_3"),new l("stg_07_4"),new l("stg_07_5"),new l("stg_07_6"),new l("stg_08_0"),new l("stg_08_1"),new l("stg_08_2"),new l("stg_08_3"),new l("stg_08_4"),new l("stg_08_5"),new l("stg_08_6"),new l("stg01_1")];t.sceneGroup={id:"ttyd",name:"Paper Mario: The Thousand Year Door",sceneDescs:c}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=a(5),i=a(5),o=a(81),l=a(1),c=a(0),h=r(a(18)),d=a(20),u=a(13),m=a(10),p=a(7),f=a(8),A=a(12),g=a(4),_=n(a(11)),S=a(147),b=a(22),v=a(34);class w extends s.GXTextureHolder{addTPLTextures(e,t){this.addTextures(e,t.textures)}}t.TPLTextureHolder=w;class x extends d.DeviceProgram{constructor(){super(...arguments),this.both="\nlayout(row_major, std140) uniform ub_Params {\n    vec4 u_ScaleOffset;\n};\n\nuniform sampler2D u_Texture;\n",this.vert=`\nout vec2 v_TexCoord;\n\nvoid main() {\n    vec2 p;\n    p.x = (gl_VertexID == 1) ? 2.0 : 0.0;\n    p.y = (gl_VertexID == 2) ? 2.0 : 0.0;\n    gl_Position.xy = p * vec2(2) - vec2(1);\n    gl_Position.zw = vec2(${b.reverseDepthForDepthOffset(1)}, 1);\n    v_TexCoord = p * u_ScaleOffset.xy + u_ScaleOffset.zw;\n}\n`,this.frag="\nin vec2 v_TexCoord;\n\nvoid main() {\n    vec4 color = texture(u_Texture, v_TexCoord);\n    gl_FragColor = vec4(color.rgb, 1.0);\n}\n"}}x.ub_Params=0;const T=[{numUniformBuffers:1,numSamplers:1}];class y{constructor(e,t,a){this.textureHolder=t,this.textureName=a,this.program=new x,this.textureMappings=c.nArray(1,()=>new m.TextureMapping),this.gfxProgram=e.createProgram(this.program),this.textureHolder.fillTextureMapping(this.textureMappings[0],this.textureName)}prepareToRender(e,t){const a=e.pushRenderInst();a.drawPrimitives(3),a.sortKey=p.makeSortKeyOpaque(0,this.gfxProgram.ResourceUniqueId),a.setInputLayoutAndState(null,null),a.setBindingLayouts(T),a.setGfxProgram(this.gfxProgram),a.setSamplerBindingsFromTextureMappings(this.textureMappings);let r=a.allocateUniformBuffer(x.ub_Params,4);const n=a.mapUniformBufferF32(x.ub_Params),s=t.camera.viewMatrix,i=Math.atan2(-s[2],s[0])/(2*Math.PI)*4,o=t.backbufferWidth/t.backbufferHeight;r+=u.fillVec4(n,r,o,-1,i,0)}destroy(e){e.destroyProgram(this.gfxProgram)}}const C=new s.MaterialParams;class M{constructor(e,t,a){this.material=a,this.materialAnimators=[],this.gfxSamplers=[],this.konst0=g.colorNewCopy(g.White),this.materialHelper=new i.GXMaterialHelperGfx(this.material.gxMaterial),this.materialHelper.megaStateFlags.cullMode=void 0,this.materialHelper.cacheProgram(e,t),this.gfxSamplers=this.material.samplers.map(a=>M.translateSampler(e,t,a)),this.isTranslucent=2===a.materialLayer,this.materialHelper.megaStateFlags.polygonOffset=1===a.materialLayer}setMaterialHacks(e){this.materialHelper.setMaterialHacks(e)}getRendererLayer(e){switch(e){case 0:return 32;case 3:return 33;case 1:return 16;case 4:return 17;case 2:return 128}}static translateSampler(e,t,a){return t.createSampler(e,{minFilter:1,magFilter:1,mipFilter:2,wrapS:s.translateWrapModeGfx(a.wrapS),wrapT:s.translateWrapModeGfx(a.wrapT),maxLOD:100,minLOD:0})}fillMaterialParams(e,t){for(let a=0;a<this.material.samplers.length;a++){const r=this.material.samplers[a],n=e.m_TextureMapping[a];t.fillTextureMapping(n,r.textureName),n.gfxSampler=this.gfxSamplers[a],this.materialAnimators[a]?this.materialAnimators[a].calcTexMtx(e.u_TexMtx[a]):l.mat4.copy(e.u_TexMtx[a],this.material.texMtx[a])}g.colorCopy(e.u_Color[s.ColorKind.MAT0],this.material.matColorReg),g.colorCopy(e.u_Color[s.ColorKind.K0],this.konst0)}stopAnimation(){for(let e=0;e<this.material.samplers.length;e++)delete this.materialAnimators[e]}playAnimation(e,t){let a=!1;for(let r=0;r<this.material.samplers.length;r++){const n=o.bindMaterialAnimator(e,t,this.material.name,r);n&&(this.materialAnimators[r]=n,a=!0)}return a}setOnRenderInst(e,t,a,r){this.materialHelper.setOnRenderInst(e,t,a);const n=this.materialHelper.allocateMaterialParams(a);this.fillMaterialParams(C,r),this.materialHelper.fillMaterialParamsDataOnInst(a,n,C),a.setSamplerBindingsFromTextureMappings(C.m_TextureMapping),a.setMegaStateFlags(this.materialHelper.megaStateFlags);const s=this.getRendererLayer(this.material.materialLayer);a.sortKey=p.makeSortKey(s,this.materialHelper.programKey)}}class U{constructor(e,t,a,r,n,o){this.materialInstance=a,this.nodeInstance=r,this.batch=n,this.coalescedBuffers=o,this.packetParams=new s.PacketParams,this.shapeHelper=new i.GXShapeHelperGfx(e,t,o,n.loadedVertexLayout,n.loadedVertexData)}computeModelView(e,t){f.computeViewMatrix(e,t),l.mat4.mul(e,e,this.nodeInstance.modelMatrix)}prepareToRender(e,t,a,r,n=null){const s=t.newRenderInst();this.shapeHelper.setOnRenderInst(s),(null!==n?n:this.materialInstance).setOnRenderInst(e,t.gfxRenderCache,s,r),this.computeModelView(this.packetParams.u_PosMtx[0],a.camera),this.shapeHelper.fillPacketParams(this.packetParams,s),t.submitRenderInst(s)}destroy(e){this.shapeHelper.destroy(e)}}const k=new s.SceneParams,D=new A.AABB;class I{constructor(e,t,a){this.node=e,this.childIndex=a,this.visible=!0,this.children=[],this.modelMatrix=l.mat4.create(),this.meshAnimator=null,this.batchInstances=[],this.showCollisionAttrib=!1,this.collisionMaterialInstance=null,this.namePath=`${t}/${e.nameStr}`,this.isDecal=!!(16&e.drawModeFlags),this.megaStateFlags=Object.assign({},this.node.renderFlags)}updateModelMatrix(e){null!==this.meshAnimator?(this.meshAnimator.calcModelMtx(this.modelMatrix),l.mat4.mul(this.modelMatrix,this.node.modelMatrix,this.modelMatrix),l.mat4.mul(this.modelMatrix,e,this.modelMatrix)):l.mat4.mul(this.modelMatrix,e,this.node.modelMatrix)}prepareToRender(e,t,a,r){if(!this.visible)return;D.transform(this.node.bbox,this.modelMatrix);const n=f.computeViewSpaceDepthFromWorldSpaceAABB(a.camera,D);for(let n=0;n<this.children.length;n++)this.children[n].updateModelMatrix(this.modelMatrix),this.children[n].prepareToRender(e,t,a,r);const i=t.pushTemplateRenderInst();if(i.sortKey=p.setSortKeyDepth(i.sortKey,n),i.setMegaStateFlags(this.megaStateFlags),this.isDecal){const e=.01*this.childIndex,t=a.camera.frustum,r=t.far,n=t.near,o=1+-2*e*r*n/((r+n)*(1+e));if(1!==o){let e=i.allocateUniformBuffer(s.ub_SceneParams,s.u_SceneParamsBufferSize);const t=i.mapUniformBufferF32(s.ub_SceneParams);s.fillSceneParams(k,a.camera,a.backbufferWidth,a.backbufferHeight),S.projectionMatrixD3DFromOpenGL(k.u_Projection),k.u_Projection[10]*=o,S.projectionMatrixOpenGLFromD3D(k.u_Projection),s.fillSceneParamsData(t,e,k)}}const o=this.getMaterialInstanceOverride(e,t.gfxRenderCache);for(let n=0;n<this.batchInstances.length;n++)this.batchInstances[n].prepareToRender(e,t,a,r,o);t.popTemplateRenderInst()}createCollisionMaterialInstance(e,t){const a=new v.GXMaterialBuilder("Collision");a.setBlendMode(1,4,5),a.setZMode(!0,1,!1),a.setTevOrder(0,255,255,7),a.setTevColorIn(0,15,15,15,14),a.setTevAlphaIn(0,7,7,7,6),a.setTevKColorSel(0,12),a.setTevKColorSel(0,28);const r={index:-1,samplers:[],texMtx:[],matColorReg:g.White,materialLayer:2,name:"Collision",gxMaterial:a.finish()};var n,s;this.collisionMaterialInstance=new M(e,t,r),this.collisionMaterialInstance.materialHelper.megaStateFlags.polygonOffset=!0,this.collisionMaterialInstance.materialHelper.megaStateFlags.cullMode=0,n=this.collisionMaterialInstance.konst0,256&(s=this.node.collisionFlags)?g.colorFromRGBA(n,0,0,1):1073741824&s?g.colorFromRGBA(n,0,1,0):2097152&s?g.colorFromRGBA(n,1,0,1):0!==s?g.colorFromRGBA(n,1,0,0):g.colorFromRGBA(n,1,1,1),n.a=.25}getMaterialInstanceOverride(e,t){return this.showCollisionAttrib?(null===this.collisionMaterialInstance&&this.createCollisionMaterialInstance(e,t),this.collisionMaterialInstance):null}stopAnimation(){this.meshAnimator=null;for(let e=0;e<this.children.length;e++)this.children[e].stopAnimation()}setVisible(e){this.visible=e;for(let t=0;t<this.children.length;t++)this.children[t].setVisible(e)}setShowCollisionAttrib(e){this.showCollisionAttrib=e;for(let t=0;t<this.children.length;t++)this.children[t].setShowCollisionAttrib(e)}playAnimation(e,t){const a=o.bindMeshAnimator(e,t,this.node.nameStr);a&&(this.meshAnimator=a);for(let a=0;a<this.children.length;a++)this.children[a].playAnimation(e,t)}destroy(e){for(let t=0;t<this.children.length;t++)this.children[t].destroy(e)}}class R extends i.BasicGXRendererHelper{constructor(e,t,a,r){super(e),this.d=t,this.textureHolder=a,this.batchInstances=[],this.materialInstances=[],this.rootMatrix=l.mat4.create(),this.backgroundRenderer=null,this.animationController=new h.default(60),this.translateModel(e,t);l.mat4.fromScaling(this.rootMatrix,[75,75,75]),this.animationNames=this.d.animations.map(e=>e.name),this.playAllAnimations(),null!==r&&(this.backgroundRenderer=new y(e,a,r))}playAllAnimations(){for(let e=0;e<this.d.animations.length;e++)this.playAnimation(this.d.animations[e])}playAnimation(e){if(null!==e.materialAnimation)for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].playAnimation(this.animationController,e);null!==e.meshAnimation&&this.rootNode.playAnimation(this.animationController,e)}playAnimationName(e){const t=this.d.animations.find(t=>t.name===e);return!!t&&(this.playAnimation(t),!0)}stopAllAnimations(){for(let e=0;e<this.materialInstances.length;e++)this.materialInstances[e].stopAnimation();this.rootNode.stopAnimation()}prepareToRender(e,t,a){a.camera.setClipPlanes(1,32768);const r=this.renderHelper.renderInstManager,n=this.renderHelper.pushTemplateRenderInst();this.animationController.setTimeInMilliseconds(a.time),null!==this.backgroundRenderer&&this.backgroundRenderer.prepareToRender(this.renderHelper.renderInstManager,a),s.fillSceneParamsDataOnTemplate(n,a),this.rootNode.updateModelMatrix(this.rootMatrix),this.rootNode.prepareToRender(e,this.renderHelper.renderInstManager,a,this.textureHolder),r.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}createPanels(){const e=new _.Panel;e.setTitle(_.RENDER_HACKS_ICON,"Render Hacks");const t=new _.Checkbox("Enable Vertex Colors",!0);t.onchanged=()=>{for(let e=0;e<this.materialInstances.length;e++)this.materialInstances[e].setMaterialHacks({disableVertexColors:!t.checked})},e.contents.appendChild(t.elem);const a=new _.Checkbox("Enable Textures",!0);a.onchanged=()=>{for(let e=0;e<this.materialInstances.length;e++)this.materialInstances[e].setMaterialHacks({disableTextures:!a.checked})},e.contents.appendChild(a.elem);const r=new _.Checkbox("Enable Collision",!1);r.onchanged=()=>{this.rootNode.children.find(e=>e.node.nameStr===this.d.information.aNodeStr).setVisible(r.checked)},e.contents.appendChild(r.elem);const n=new _.Checkbox("Show Collision Attributes",!1);n.onchanged=()=>{this.rootNode.children.find(e=>e.node.nameStr===this.d.information.aNodeStr).setShowCollisionAttrib(n.checked)},e.contents.appendChild(n.elem);const s=new _.Checkbox("Enable Render Root",!0);s.onchanged=()=>{this.rootNode.children.find(e=>e.node.nameStr===this.d.information.sNodeStr).setVisible(s.checked)},e.contents.appendChild(s.elem);const i=this.rootNode.children.filter(e=>e.node.nameStr!==this.d.information.aNodeStr&&e.node.nameStr!==this.d.information.sNodeStr);if(i.length>0){const t=new _.Checkbox("Enable Other Root Nodes",!1);t.onchanged=()=>{i.forEach(e=>e.setVisible(t.checked))},e.contents.appendChild(t.elem)}return[e]}destroy(e){super.destroy(e),this.bufferCoalescer.destroy(e),this.batchInstances.forEach(t=>t.destroy(e)),this.textureHolder.destroy(e),null!==this.backgroundRenderer&&this.backgroundRenderer.destroy(e),this.rootNode.destroy(e)}translatePart(e,t,a){const r=a.batch,n=this.batches.indexOf(r);c.assert(n>=0);const s=this.materialInstances[a.material.index],i=this.getCache(),o=new U(e,i,s,t,r,this.bufferCoalescer.coalescedBuffers[n]);t.batchInstances.push(o),this.batchInstances.push(o)}translateSceneGraph(e,t,a="",r=0){const n=new I(t,a,r);for(let a=0;a<t.parts.length;a++)this.translatePart(e,n,t.parts[a]);for(let a=0;a<t.children.length;a++){const r=this.translateSceneGraph(e,t.children[a],n.namePath,a);n.isDecal&&(r.isDecal=!0),n.children.push(r)}return n}collectBatches(e,t){for(const a of t.parts)e.push(a.batch);for(const a of t.children)this.collectBatches(e,a)}translateModel(e,t){this.materialInstances=t.materials.map(t=>new M(e,this.renderHelper.renderInstManager.gfxRenderCache,t));const a=t.rootNode;this.batches=[],this.collectBatches(this.batches,a),this.bufferCoalescer=s.loadedDataCoalescerComboGfx(e,this.batches.map(e=>e.loadedVertexData)),this.rootNode=this.translateSceneGraph(e,a);for(let e=0;e<this.rootNode.children.length;e++){const a=this.rootNode.children[e];a.node.nameStr!==t.information.sNodeStr&&a.setVisible(!1)}}}t.WorldRenderer=R},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(35)),s=a(0);t.parse=function(e,t){const a=e.createDataView();s.assert(2142e3===a.getUint32(0));const r=a.getUint32(4),i=a.getUint32(8);s.assert(12===i),void 0!==t&&s.assert(t.length===r);let o=i;const l=[];for(let i=0;i<r;i++){const r=a.getUint32(o+0),c=a.getUint32(o+4);o+=8,s.assert(0!==r);const h=a.getUint16(r+0),d=a.getUint16(r+2),u=a.getUint32(r+4),m=a.getUint32(r+8),p=a.getUint32(r+12),f=a.getUint32(r+16),A=a.getUint32(r+20),g=a.getUint32(r+24),_=a.getFloat32(r+28),S=a.getUint8(r+32),b=a.getUint8(r+33),v=a.getUint8(r+34),w=v-b+1,x=e.subarray(m);let T=void 0,y=void 0;if(0!==c){a.getUint16(c+0);y=a.getUint16(c+6);const t=a.getUint16(c+10),r=n.calcPaletteSize(u,y);T=e.subarray(t,r)}const C=void 0!==t?t[i]:`Texture${i}`;l.push({name:C,mipCount:w,data:x,width:d,height:h,format:u,wrapS:p,wrapT:f,minFilter:A,magFilter:g,lodBias:_,edgeLOD:S,minLOD:b,maxLOD:v,paletteFormat:y,paletteData:T})}return{textures:l}}},function(e,t,a){"use strict";function r(e,t,a){return e>>t&(1<<a-t+1)-1}Object.defineProperty(t,"__esModule",{value:!0}),t.getGSRegisterTEX0=function(e,t){return{tbp0:r(e,0,13),tbw:r(e,14,19),psm:r(e,20,25),tw:r(e,26,29),th:r(e,30,31)|r(t,0,1)<<2,tcc:r(t,2,2),tfx:r(t,3,4),cbp:r(t,5,18),cpsm:r(t,19,22),csm:r(t,23,23),csa:r(t,24,28),cld:r(t,29,31)}},t.getGSRegisterCLAMP=function(e,t){return{wms:r(e,0,1),wmt:r(e,2,3),minu:r(e,4,13),maxu:r(e,14,23),minv:r(e,24,31)|r(t,0,1)<<2,maxv:r(t,2,11)}},t.getGSRegisterBITBLTBUF=function(e,t){return{sbp:r(e,0,13),sbw:r(e,16,21),spsm:r(e,24,29),dbp:r(t,0,13),dbw:r(t,16,21),dpsm:r(t,24,29)}},t.getGSRegisterTRXPOS=function(e,t){return{ssax:r(e,0,10),ssay:r(e,16,26),dsax:r(t,0,10),dsay:r(t,16,26),dir:r(t,27,28)}},t.getGSRegisterTRXREG=function(e,t){return{rrw:r(e,0,11),rrh:r(t,0,11)}},t.gsMemoryMapNew=function(){return{data:new Uint8Array(4194304)}};const n=[0,1,4,5,16,17,20,21,2,3,6,7,18,19,22,23,8,9,12,13,24,25,28,29,10,11,14,15,26,27,30,31],s=[0,1,4,5,8,9,12,13,2,3,6,7,10,11,14,15],i=[0,1,4,5,16,17,20,21,2,3,6,7,18,19,22,23,8,9,12,13,24,25,28,29,10,11,14,15,26,27,30,31],o=[0,4,16,20,32,36,48,52,2,6,18,22,34,38,50,54,8,12,24,28,40,44,56,60,10,14,26,30,42,46,58,62,33,37,49,53,1,5,17,21,35,39,51,55,3,7,19,23,41,45,57,61,9,13,25,29,43,47,59,63,11,15,27,31,96,100,112,116,64,68,80,84,98,102,114,118,66,70,82,86,104,108,120,124,72,76,88,92,106,110,122,126,74,78,90,94,65,69,81,85,97,101,113,117,67,71,83,87,99,103,115,119,73,77,89,93,105,109,121,125,75,79,91,95,107,111,123,127,128,132,144,148,160,164,176,180,130,134,146,150,162,166,178,182,136,140,152,156,168,172,184,188,138,142,154,158,170,174,186,190,161,165,177,181,129,133,145,149,163,167,179,183,131,135,147,151,169,173,185,189,137,141,153,157,171,175,187,191,139,143,155,159,224,228,240,244,192,196,208,212,226,230,242,246,194,198,210,214,232,236,248,252,200,204,216,220,234,238,250,254,202,206,218,222,193,197,209,213,225,229,241,245,195,199,211,215,227,231,243,247,201,205,217,221,233,237,249,253,203,207,219,223,235,239,251,255],l=[0,2,8,10,1,3,9,11,4,6,12,14,5,7,13,15],c=[0,8,32,40,64,72,96,104,2,10,34,42,66,74,98,106,4,12,36,44,68,76,100,108,6,14,38,46,70,78,102,110,16,24,48,56,80,88,112,120,18,26,50,58,82,90,114,122,20,28,52,60,84,92,116,124,22,30,54,62,86,94,118,126,65,73,97,105,1,9,33,41,67,75,99,107,3,11,35,43,69,77,101,109,5,13,37,45,71,79,103,111,7,15,39,47,81,89,113,121,17,25,49,57,83,91,115,123,19,27,51,59,85,93,117,125,21,29,53,61,87,95,119,127,23,31,55,63,192,200,224,232,128,136,160,168,194,202,226,234,130,138,162,170,196,204,228,236,132,140,164,172,198,206,230,238,134,142,166,174,208,216,240,248,144,152,176,184,210,218,242,250,146,154,178,186,212,220,244,252,148,156,180,188,214,222,246,254,150,158,182,190,129,137,161,169,193,201,225,233,131,139,163,171,195,203,227,235,133,141,165,173,197,205,229,237,135,143,167,175,199,207,231,239,145,153,177,185,209,217,241,249,147,155,179,187,211,219,243,251,149,157,181,189,213,221,245,253,151,159,183,191,215,223,247,255,256,264,288,296,320,328,352,360,258,266,290,298,322,330,354,362,260,268,292,300,324,332,356,364,262,270,294,302,326,334,358,366,272,280,304,312,336,344,368,376,274,282,306,314,338,346,370,378,276,284,308,316,340,348,372,380,278,286,310,318,342,350,374,382,321,329,353,361,257,265,289,297,323,331,355,363,259,267,291,299,325,333,357,365,261,269,293,301,327,335,359,367,263,271,295,303,337,345,369,377,273,281,305,313,339,347,371,379,275,283,307,315,341,349,373,381,277,285,309,317,343,351,375,383,279,287,311,319,448,456,480,488,384,392,416,424,450,458,482,490,386,394,418,426,452,460,484,492,388,396,420,428,454,462,486,494,390,398,422,430,464,472,496,504,400,408,432,440,466,474,498,506,402,410,434,442,468,476,500,508,404,412,436,444,470,478,502,510,406,414,438,446,385,393,417,425,449,457,481,489,387,395,419,427,451,459,483,491,389,397,421,429,453,461,485,493,391,399,423,431,455,463,487,495,401,409,433,441,465,473,497,505,403,411,435,443,467,475,499,507,405,413,437,445,469,477,501,509,407,415,439,447,471,479,503,511];function h(e,t,a,r){const i=((r>>>1&3)<<4)+s[(1&r)<<3|7&a];return((e>>>5)+(r>>>5)*t+(a>>>6)<<11)+(function(e,t,a){return e+(t>>>1&-32)+n[(a>>>3&3)<<3|t>>>3&7]}(31&e,63&a,31&r)<<6)+i<<2&4194300}function d(e,t,a,r){const n=o[(15&r)<<4|15&a];return((e>>>5)+(r>>>6)*(t>>>1)+(a>>>7)<<13)+(function(e,t,a){return e+(t>>>2&-32)+i[(a>>>4&3)<<3|t>>>4&7]}(31&e,127&a,63&r)<<8)+n}function u(e,t,a,r){const n=c[(15&r)<<5|31&a];return((e>>>5)+(r>>>7)*(t>>>1)+(a>>>7)<<14)+(function(e,t,a){return e+(t>>>2&-32)+((a>>>6&1)<<4)+l[(a>>>4&3)<<2|t>>>5&3]}(31&e,127&a,127&r)<<9)+n}t.gsMemoryMapUploadImage=function(e,t,a,r,n,s,i,o,l){if(0===t)!function(e,t,a,r,n,s,i,o){const l=o.createDataView();let c=0;for(let o=n;o<n+i;o++)for(let n=r;n<r+s;n++){const r=h(t,a,n,o);e.data[r+0]=l.getUint8(c+0),e.data[r+1]=l.getUint8(c+1),e.data[r+2]=l.getUint8(c+2),e.data[r+3]=l.getUint8(c+3),c+=4}}(e,a,r,n,s,i,o,l);else if(19===t)!function(e,t,a,r,n,s,i,o){const l=o.createDataView();let c=0;for(let o=n;o<n+i;o++)for(let n=r;n<r+s;n++){const r=d(t,a,n,o);e.data[r]=l.getUint8(c),c++}}(e,a,r,n,s,i,o,l);else{if(20!==t)throw"whoops";!function(e,t,a,r,n,s,i,o){const l=o.createDataView();let c=0;for(let o=n;o<n+i;o++)for(let n=r;n<r+s;n++){const r=u(t,a,n,o),s=l.getUint8(c>>1)>>((1&c)<<2)&15;e.data[r>>1]=s<<((1&r)<<2)|e.data[r>>1]&240>>((1&r)<<2),c++}}(e,a,r,n,s,i,o,l)}},t.gsMemoryMapReadImagePSMT4_PSMCT32=function(e,t,a,r,n,s,i,o,l){let c=0;for(let d=0;d<s;d++)for(let s=0;s<n;s++){const n=u(a,r,s,d),m=t.data[n>>>1]>>((1&n)<<2)&15,p=h(i,1,(7&m)+((1&o)<<3),(m>>>3&1)+(14&o));e[c+0]=t.data[p+0],e[c+1]=t.data[p+1],e[c+2]=t.data[p+2];const f=-1==l?t.data[p+3]:l;e[c+3]=Math.min(255,2*f),c+=4}},t.gsMemoryMapReadImagePSMT8_PSMCT32=function(e,t,a,r,n,s,i,o){let l=0;for(let c=0;c<s;c++)for(let s=0;s<n;s++){const n=d(a,r,s,c),u=t.data[n];let m=(224&u)>>>4;8&u&&m++;let p=7&u;16&u&&(p+=8);const f=h(i,1,p,m);e[l+0]=t.data[f+0],e[l+1]=t.data[f+1],e[l+2]=t.data[f+2];const A=-1==o?t.data[f+3]:o;e[l+3]=Math.min(255,2*A),l+=4}},t.psmToString=function(e){switch(e){case 20:return"PSMT4";case 19:return"PSMT8";default:return"unknown"}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(11)),i=r(a(29)),o=r(a(49)),l=r(a(27)),c=a(0),h=a(1),d=a(41),u=n(a(18)),m=a(5),p=a(6),f=a(2),A=a(120);class g{constructor(){this.rresCache=new Map,this.modelCache=new Map}destroy(e){for(const t of this.modelCache.values())t.destroy(e)}ensureRRES(e,t,a,r){if(!this.rresCache.has(r)){const n=i.parse(a.findFileData(r));t.textureHolder.addRRESTextures(e,n),this.rresCache.set(r,n);const s=t.renderHelper.renderInstManager.gfxRenderCache;for(let t=0;t<n.mdl0.length;t++){const a=new d.MDL0Model(e,s,n.mdl0[t]);this.modelCache.set(n.mdl0[t].name,a)}}return this.rresCache.get(r)}}function _(e){if(e instanceof v)return e.modelInstance;if(e instanceof d.MDL0ModelInstance)return e;throw"Object's class does not have a known model instance."}class S extends m.BasicGXRendererHelper{constructor(){super(...arguments),this.textureHolder=new d.RRESTextureHolder,this.animationController=new u.default,this.eggLightManager=null,this.baseObjects=[],this.modelCache=new g}setMirrored(e){const t=h.mat4.create();f.computeModelMatrixS(t,-1,1,1);for(let a=0;a<this.baseObjects.length;a++){h.mat4.mul(this.baseObjects[a].modelMatrix,t,this.baseObjects[a].modelMatrix);for(let t=0;t<_(this.baseObjects[a]).materialInstances.length;t++)_(this.baseObjects[a]).materialInstances[t].materialHelper.megaStateFlags.frontFace=e?p.GfxFrontFaceMode.CCW:p.GfxFrontFaceMode.CW}}adjustCameraController(e){e.setSceneMoveSpeedMult(.4)}createPanels(){const e=new s.Panel;e.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,e.setTitle(s.RENDER_HACKS_ICON,"Render Hacks");const t=new s.Checkbox("Mirror Courses");t.onchanged=()=>{this.setMirrored(t.checked)},e.contents.appendChild(t.elem);const a=new s.Checkbox("Enable Vertex Colors",!0);a.onchanged=()=>{const e=a.checked;for(let t=0;t<this.baseObjects.length;t++)this.baseObjects[t].setVertexColorsEnabled(e)},e.contents.appendChild(a.elem);const r=new s.Checkbox("Enable Textures",!0);return r.onchanged=()=>{const e=r.checked;for(let t=0;t<this.baseObjects.length;t++)this.baseObjects[t].setTexturesEnabled(e)},e.contents.appendChild(r.elem),[e]}prepareToRender(e,t,a){if(this.animationController.setTimeInMilliseconds(a.time),null!==this.eggLightManager)for(let e=0;e<this.baseObjects.length;e++)this.baseObjects[e].bindLightSetting(this.eggLightManager.lightSetting);const r=this.renderHelper.pushTemplateRenderInst();m.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.baseObjects.length;t++)this.baseObjects[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}destroy(e){super.destroy(e),this.textureHolder.destroy(e);for(let t=0;t<this.baseObjects.length;t++)this.baseObjects[t].destroy(e);this.modelCache.destroy(e)}}const b=h.mat4.fromScaling(h.mat4.create(),[.1,.1,.1]);class v{constructor(e,t){this.modelInstance=e,this.gobj=t,this.modelMatrix=h.mat4.create(),f.computeModelMatrixSRT(this.modelMatrix,t.scaleX,t.scaleY,t.scaleZ,t.rotationX,t.rotationY,t.rotationZ,t.translationX,t.translationY,t.translationZ),h.mat4.mul(this.modelMatrix,b,this.modelMatrix)}setVertexColorsEnabled(e){this.modelInstance.setVertexColorsEnabled(e)}setTexturesEnabled(e){this.modelInstance.setTexturesEnabled(e)}bindLightSetting(e){this.modelInstance.bindLightSetting(e)}prepareToRender(e,t,a){h.mat4.copy(this.modelInstance.modelMatrix,this.modelMatrix),this.modelInstance.prepareToRender(e,t,a)}destroy(e){this.modelInstance.destroy(e)}}class w extends v{constructor(e,t){super(e,t),this.nodeIndices=[];for(let e=0;e<37;e++){const t="joint"+(e+2);this.nodeIndices.push(this.modelInstance.mdl0Model.mdl0.nodes.findIndex(e=>e.name===t))}}prepareToRender(e,t,a){const r=a.time/1e3*60;for(let e=0;e<this.nodeIndices.length;e++){const t=this.nodeIndices[e],a=this.modelInstance.mdl0Model.mdl0.nodes[t].modelMatrix,n=(r/60-30)/60,s=Math.min(1+n*n,4),i=2617.87480299578*e/15e3,o=Math.sin(6.283/255*(40.74366379*(i*s+Math.PI*r/50)));a[12]=416.66000366*(e+2),a[13]=i*o*80,a[14]=0}super.prepareToRender(e,t,a)}}class x{constructor(e,t){this.id=e,this.name=t}static createModelInstanceFromRRES(e,t,a){const r=e.modelCache,n=c.assertExists(r.modelCache.get(a)),s=new d.MDL0ModelInstance(e.textureHolder,n,a);return s.setSortKeyLayer(33),s.bindRRESAnimations(e.animationController,t,null),s}static spawnObjectFromKMP(e,t,a,r){const n=r=>{const n=`./${r}.brres`;return t.modelCache.ensureRRES(e,t,a,n),c.assertExists(t.modelCache.rresCache.get(n))},s=(e,a=e)=>this.createModelInstanceFromRRES(t,n(e),a),i=(e,a=e)=>{const n=s(e,a),i=new v(n,r);return t.baseObjects.push(i),i};function o(e){const t=new u.default;return t.setTimeInFrames(e),t}if(2===r.objectId){i("Psea","Psea1sand"),i("Psea","Psea2dark"),i("Psea","Psea3nami"),i("Psea","Psea4tex"),i("Psea","Psea5spc")}else if(3===r.objectId);else if(21===r.objectId);else if(210===r.objectId)i("skyship");else if(101===r.objectId){i("itembox").modelMatrix[13]+=20}else if(111===r.objectId)i("sun");else if(113===r.objectId)i("KmoonZ");else if(114===r.objectId)i("sunDS");else if(115===r.objectId){i("coin").modelMatrix[13]+=15}else if(202===r.objectId)i("MashBalloonGC");else if(203===r.objectId)i("WLwallGC");else if(204===r.objectId)i("CarA1");else if(205===r.objectId)i("basabasa");else if(206===r.objectId)i("HeyhoShipGBA");else if(210===r.objectId)i("skyship");else if(215===r.objectId)i("penguin_s");else if(216===r.objectId)i("penguin_m");else if(217===r.objectId)i("penguin_l");else if(218===r.objectId)i("castleballoon1");else if(219===r.objectId)i("dossun");else if(221===r.objectId)i("boble");else if(222===r.objectId)i("K_bomb_car");else if(227===r.objectId)i("seagull");else if(228===r.objectId)i("moray");else if(229===r.objectId)i("crab");else if(231===r.objectId)i("CarA2");else if(232===r.objectId)i("CarA3");else if(233===r.objectId){const e=i("wanwan");h.mat4.scale(e.modelMatrix,e.modelMatrix,[4,4,4]),e.modelMatrix[13]+=125}else if(235===r.objectId){i("Twanwan").modelMatrix[13]+=150}else if(236===r.objectId)i("cruiser");else if(237===r.objectId)i("bird");else if(302===r.objectId)i("dokan_sfc");else if(303===r.objectId)i("castletree1");else if(304===r.objectId)i("castletree1");else if(305===r.objectId)i("castletree2");else if(306===r.objectId)i("castleflower1");else if(307===r.objectId)i("mariotreeGC");else if(308===r.objectId)i("mariotreeGC");else if(309===r.objectId)i("donkytree1GC");else if(310===r.objectId)i("donkytree2GC");else if(311===r.objectId)i("peachtreeGC");else if(312===r.objectId)i("peachtreeGC");else if(316===r.objectId)i("obakeblockSFC");else if(317===r.objectId)i("WLarrowGC");else if(318===r.objectId)i("WLscreenGC");else if(319===r.objectId)i("WLdokanGC");else if(320===r.objectId)i("MarioGo64");else if(321===r.objectId)i("PeachHunsuiGC");else if(322===r.objectId)i("kinokoT1");else if(324===r.objectId){const e=i("pylon01"),t=n("pylon01");e.modelInstance.bindCLR0(o(r.objectArg0),c.assertExists(t.clr0.find(e=>"pylon01"===e.name)))}else if(325===r.objectId)i("PalmTree");else if(326===r.objectId)i("parasol");else if(327===r.objectId)i("cruiser");else if(328===r.objectId)i("K_sticklift00");else if(329===r.objectId)i("heyho2");else if(330===r.objectId)i("HeyhoTreeGBA");else if(332===r.objectId)i("truckChimSmk");else if(333===r.objectId);else if(334===r.objectId);else if(335===r.objectId);else if(336===r.objectId)i("gardentreeDS");else if(337===r.objectId)i("gardentreeDS");else if(338===r.objectId)i("FlagA1");else if(339===r.objectId)i("FlagA2");else if(340===r.objectId)i("FlagB1");else if(341===r.objectId)i("FlagB2");else if(342===r.objectId)i("FlagA3");else if(343===r.objectId)i("DKtreeA64");else if(344===r.objectId)i("DKtreeA64");else if(345===r.objectId)i("DKtreeB64");else if(346===r.objectId)i("DKtreeB64");else if(347===r.objectId)i("TownTreeDS");else if(348===r.objectId)i("Piston");else if(349===r.objectId)i("oilSFC");else if(352===r.objectId)i("mii_balloon");else if(353===r.objectId)i("windmill");else if(354===r.objectId)i("dossun");else if(355===r.objectId)i("TownTreeDS");else if(356===r.objectId)i("Ksticketc");else if(357===r.objectId)i("monte_a");else if(358===r.objectId)i("MiiStatueM1");else if(359===r.objectId)i("ShMiiObj01");else if(360===r.objectId)i("ShMiiObj02");else if(361===r.objectId)i("ShMiiObj03");else if(363===r.objectId)i("miiposter");else if(364===r.objectId)i("dk_miiobj00");else if(365===r.objectId)i("light_house");else if(366===r.objectId)i("r_parasol");else if(367===r.objectId)i("obakeblockSFC");else if(368===r.objectId)i("obakeblockSFC");else if(369===r.objectId)i("koopaFigure");else if(370===r.objectId)i("pukupuku");else if(374===r.objectId)i("karehayama");else if(375===r.objectId)i("EarthRing");else if(376===r.objectId)i("SpaceSun");else if(378===r.objectId)i("StarRing");else if(379===r.objectId)i("M_obj_kanban");else if(380===r.objectId)i("MiiStatueL1");else if(381===r.objectId)i("MiiStatueD1");else if(382===r.objectId)i("MiiSphinxY1");else if(383===r.objectId)i("MiiSphinxY2");else if(384===r.objectId)i("FlagA5");else if(385===r.objectId)i("CarB");else if(389===r.objectId)i("group_monte_a");else if(390===r.objectId)i("MiiStatueL2");else if(391===r.objectId)i("MiiStatueD2");else if(392===r.objectId)i("MiiStatueP1");else if(393===r.objectId)i("SentakuDS");else if(394===r.objectId)i("fks_screen_wii");else if(395===r.objectId)i("KoopaFigure64");else if(396===r.objectId)i("b_teresa");else if(398===r.objectId)i("MiiKanban");else if(399===r.objectId)i("BGteresaSFC");else if(401===r.objectId){const e=i("kuribo"),a=n("kuribo");e.modelInstance.bindCHR0(t.animationController,c.assertExists(a.chr0.find(e=>"walk_l"===e.name)))}else if(402===r.objectId)i("choropu");else if(403===r.objectId)i("cow");else if(404===r.objectId)i("pakkun_f");else if(405===r.objectId)i("WLfirebarGC");else if(406===r.objectId)i("wanwan");else if(407===r.objectId){i("poihana").modelMatrix[13]+=25}else if(408===r.objectId)i("DKrockGC");else if(409===r.objectId)i("sanbo");else if(410===r.objectId)i("choropu");else if(411===r.objectId)i("TruckWagon");else if(412===r.objectId)i("heyho");else if(413===r.objectId)i("Press");else if(417===r.objectId)i("WLfirebarGC");else if(418===r.objectId)i("pakkun_dokan");else if(420===r.objectId)i("FireSnake");else if(421===r.objectId)i("koopaFirebar");else if(422===r.objectId)i("Epropeller");else if(424===r.objectId)i("FireSnake");else if(426===r.objectId)i("puchi_pakkun");else if(502===r.objectId)if(0===r.objectArg0)i("kinoko","kinoko_kuki"),i("kinoko","kinoko_r");else{if(1!==r.objectArg0)throw"whoops";i("kinoko","kinoko_d_kuki"),i("kinoko","kinoko_d_r")}else if(503===r.objectId)i("VolcanoRock1");else if(504===r.objectId)i("bulldozer_left");else if(505===r.objectId)i("bulldozer_right");else if(506===r.objectId)if(0===r.objectArg0)i("kinoko","kinoko_kuki"),i("kinoko","kinoko_g");else{if(1!==r.objectArg0)throw"whoops";i("kinoko","kinoko_d_kuki"),i("kinoko","kinoko_d_g")}else if(507===r.objectId)i("Crane");else if(508===r.objectId)i("VolcanoPiece1",`VolcanoPiece${r.objectArg0}`);else if(509===r.objectId)i("FlamePole");else if(510===r.objectId)i("TwistedWay");else if(511===r.objectId)i("TownBridgeDS");else if(512===r.objectId)i("DKship64");else if(514===r.objectId)i("DKturibashiGC");else if(516===r.objectId){const e=new w(s("aurora"),r);t.baseObjects.push(e)}else if(517===r.objectId)i("venice_saku");else if(518===r.objectId)i("casino_roulette");else if(521===r.objectId)i("dc_sandcone");else if(522===r.objectId)i("venice_hasi");else if(523===r.objectId)i("bblock1");else if(526===r.objectId)i("ami");else if(529===r.objectId){const e=["RM_ring1","RM_ring2","RM_ring3"][r.objectArg0-1],a=i("RM_ring1",e),s=n("RM_ring1");a.modelInstance.bindRRESAnimations(t.animationController,s,e),a.modelInstance.bindCLR0(null,null)}else if(532===r.objectId)i("InsekiA");else if(533===r.objectId)i("InsekiB");else if(535===r.objectId)i("Mdush");else if(601===r.objectId)i("DonkyCannonGC");else if(602===r.objectId)i("BeltEasy");else if(603===r.objectId)i("BeltCrossing");else if(604===r.objectId)i("BeltCurveA");else if(606===r.objectId)i("escalator");else if(607===r.objectId)i("DonkyCannon_wii");else if(608===r.objectId){const e=i("escalator");h.mat4.translate(e.modelMatrix,e.modelMatrix,[-1450,250,-600]);const t=i("escalator");h.mat4.translate(t.modelMatrix,t.modelMatrix,[1450,250,-600])}else if(609===r.objectId)i("tree_cannon");else if(701===r.objectId)i("group_enemy_b");else if(702===r.objectId)i("group_enemy_c");else if(704===r.objectId)i("truckChimSmkW");else if(706===r.objectId)i("dkmonitor");else if(707===r.objectId)i("group_enemy_a");else if(708===r.objectId)i("FlagB3");else if(709===r.objectId)i("spot");else if(711===r.objectId)i("FlagB4");else if(712===r.objectId)i("group_enemy_e");else if(713===r.objectId)i("group_monte_a");else if(714===r.objectId)i("group_enemy_f");else if(719===r.objectId)i("ridgemii00");else if(720===r.objectId);else if(725===r.objectId){const e=i("MiiSignNoko"),t=n("MiiSignNoko");e.modelInstance.bindPAT0(o(0),t.pat0[0])}else if(726===r.objectId)i("UtsuboDokan");else if(727===r.objectId)i("Spot64");else if(735===r.objectId)i("MiiStatueM2");else if(736===r.objectId)i("RhMiiKanban");else if(737===r.objectId)i("MiiStatueL3");else if(738===r.objectId)i("MiiSignWario");else if(739===r.objectId)i("MiiStatueBL1");else if(740===r.objectId)i("MiiStatueBD1");else if(742===r.objectId)i("Crescent64");else if(743===r.objectId){const e=i("MiiSighKino"),t=n("MiiSighKino");e.modelInstance.bindPAT0(o(0),t.pat0[0])}else 744===r.objectId?i("MiiObjD01"):745===r.objectId?i("MiiObjD02"):746===r.objectId?i("MiiObjD03"):747===r.objectId?i("mare_a"):748===r.objectId?i("mare_b"):console.warn(`Unimplemented object ${c.hexzero(r.objectId,4)}`)}static createSceneFromU8Archive(e,t){const a=function(e){const t=e.createDataView();c.assert("RKMD"===c.readString(e,0,4));const a=t.getUint16(10)+t.getUint32(44);c.assert("GOBJ"===c.readString(e,a+0,4));const r=t.getUint16(a+4);let n=a+8;const s=[];for(let e=0;e<r;e++){const e=t.getUint16(n+0),a=t.getFloat32(n+4),r=t.getFloat32(n+8),i=t.getFloat32(n+12),o=.01745*t.getFloat32(n+16),l=.01745*t.getFloat32(n+20),c=.01745*t.getFloat32(n+24),h=t.getFloat32(n+28),d=t.getFloat32(n+32),u=t.getFloat32(n+36),m=t.getUint16(n+40),p=t.getUint16(n+42),f=t.getUint32(n+44),A=t.getUint32(n+62),g=t.getUint32(n+48),_=t.getUint16(n+50),S=t.getUint32(n+52),b=t.getUint32(n+54),v=t.getUint32(n+56),w=t.getUint32(n+58);s.push({objectId:e,routeId:m,objectArg0:p,objectArg1:f,objectArg2:A,objectArg3:g,objectArg4:_,objectArg5:S,objectArg6:b,objectArg7:v,presenceFlags:w,translationX:a,translationY:r,translationZ:i,rotationX:o,rotationY:l,rotationZ:c,scaleX:h,scaleY:d,scaleZ:u}),n+=60}return{gobj:s}}(c.assertExists(t.findFileData("./course.kmp")));console.log(t,a);const r=new S(e),n=r.modelCache,s=n.ensureRRES(e,r,t,"./course_model.brres"),i=this.createModelInstanceFromRRES(r,s,"course");r.baseObjects.push(i),i.setSortKeyLayer(32),h.mat4.copy(i.modelMatrix,b);const o=n.ensureRRES(e,r,t,"./vrcorn_model.brres"),l=this.createModelInstanceFromRRES(r,o,"vrcorn");r.baseObjects.push(l),l.setSortKeyLayer(0),h.mat4.copy(l.modelMatrix,b);for(let n=0;n<a.gobj.length;n++)this.spawnObjectFromKMP(e,r,t,a.gobj[n]);const d=t.findFileData("./posteffect/posteffect.blight");if(null!==d){const e=A.parseBLIGHT(d),t=new A.EggLightManager(e);r.eggLightManager=t}return r}async createScene(e,t){const a=t.dataFetcher,r=await a.fetchData(`mkwii/${this.id}.szs`),n=await l.decompress(r),s=o.parse(n);return x.createSceneFromU8Archive(e,s)}}t.createMarioKartWiiSceneFromU8Archive=function(e,t){return x.createSceneFromU8Archive(e,t)};const T=["Mushroom Cup",new x("beginner_course","Luigi Circuit"),new x("farm_course","Moo Moo Meadows"),new x("kinoko_course","Mushroom Gorge"),new x("factory_course","Toad's Factory"),"Flower Cup",new x("castle_course","Mario Circuit"),new x("shopping_course","Coconut Mall"),new x("boardcross_course","DK Summit"),new x("truck_course","Wario's Gold Mine"),"Star Cup",new x("senior_course","Daisy Circuit"),new x("water_course","Koopa Cape"),new x("treehouse_course","Maple Treeway"),new x("volcano_course","Grumble Volcano"),"Special Cup",new x("desert_course","Dry Dry Ruins"),new x("ridgehighway_course","Moonview Highway"),new x("koopa_course","Bowser's Castle"),new x("rainbow_course","Rainbow Road"),"Shell Cup",new x("old_peach_gc","GCN Peach Beach"),new x("old_falls_ds","DS Yoshi Falls"),new x("old_obake_sfc","SNES Ghost Valley 2"),new x("old_mario_64","N64 Mario Raceway"),"Banana Cup",new x("old_sherbet_64","N64 Sherbet Land"),new x("old_heyho_gba","GBA Shy Guy Beach"),new x("old_town_ds","DS Delfino Square"),new x("old_waluigi_gc","GCN Waluigi Stadium"),"Leaf Cup",new x("old_desert_ds","DS Desert Hills"),new x("old_koopa_gba","GBA Bowser's Castle 3"),new x("old_donkey_64","N64 DK's Jungle Parkway"),new x("old_mario_gc","GCN Mario Circuit"),"Lightning Cup",new x("old_mario_sfc","SNES Mario Circuit 3"),new x("old_garden_ds","DS Peach Gardens"),new x("old_donkey_gc","GCN DK Mountain"),new x("old_koopa_64","N64 Bowser's Castle"),"Battle Courses",new x("block_battle","Block Plaza"),new x("venice_battle","Delfino Pier"),new x("skate_battle","Funky Stadium"),new x("casino_battle","Chain Chomp Wheel"),new x("sand_battle","Thwomp Desert"),new x("old_battle4_sfc","SNES Battle Course 4"),new x("old_battle3_gba","GBA Battle Course 3"),new x("old_matenro_64","N64 Skyscraper"),new x("old_CookieLand_gc","GCN Cookie Land"),new x("old_House_ds","DS Twilight House"),"Extra",new x("ring_mission","Galaxy Colosseum"),new x("ending_demo","Luigi's Circuit (End Credits)")];t.sceneGroup={id:"mkwii",name:"Mario Kart Wii",sceneDescs:T}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(4),s=a(1),i=a(29),o=a(2);t.EggLightManager=class{constructor(e){this.res=e,this.lights=[],this.lightSetting=new i.LightSetting(this.res.lightObjects.length,this.res.lightObjects.length);let t=0;for(let e=0;e<this.res.lightObjects.length;e++){const a=new l;if(a.copy(this.res.lightObjects[e]),this.lights.push(a),a.initG3DLightObj(this.lightSetting.lightObj[e]),this.lightSetting.lightObj[e].isEnabled()){const a=this.lightSetting.lightSet[t++];a.lightObjIndexes[0]=e,a.ambLightObjIndex=this.res.lightObjects[e].ambientLightIndex}}for(let e=0;e<this.res.ambientLights.length;e++)n.colorCopy(this.lightSetting.ambLightObj[e],this.res.ambientLights[e])}};class l{constructor(){this.flags=0,this.color=n.colorNewCopy(n.White),this.lightType=1,this.pos=s.vec3.create(),this.aim=s.vec3.create(),this.spotCutoff=0,this.spotFunction=0,this.refDist=0,this.refBrightness=0,this.distAttnFunction=0}copy(e){this.flags=e.flags,n.colorCopy(this.color,e.color),this.lightType=e.lightType,s.vec3.copy(this.pos,e.pos),s.vec3.copy(this.aim,e.aim),this.spotCutoff=e.spotCutoff,this.spotFunction=e.spotFunction,this.refDist=e.refDist,this.refBrightness=e.refBrightness,this.distAttnFunction=e.distAttnFunction}initG3DLightObj(e){if(1&this.flags&&32&this.flags){if(e.enable(),0===this.lightType)s.vec3.copy(e.light.Position,this.pos),s.vec3.set(e.light.Direction,0,0,0);else if(1===this.lightType){const t=-1e10*(this.aim[0]-this.pos[0]),a=-1e10*(this.aim[1]-this.pos[1]),r=-1e10*(this.aim[2]-this.pos[2]);s.vec3.set(e.light.Position,t,a,r),s.vec3.set(e.light.Direction,0,0,0)}else 2===this.lightType&&(s.vec3.copy(e.light.Position,this.pos),s.vec3.copy(e.light.Direction,this.aim));512&this.flags&&e.enableColor(),1024&this.flags&&e.enableAlpha(),e.initLightColor(this.color),128&this.flags&&e.initLightSpot(this.spotCutoff,this.spotFunction),256&this.flags||e.initLightDistAttn(this.refDist,this.refBrightness,this.distAttnFunction)}else e.disable()}}t.EggBinaryLight=l,t.parseBLIGHT=function(e){const t=e.createDataView();r.assert("LGHT"===r.readString(e,0,4));const a=t.getUint8(8);r.assert(2===a);const i=t.getUint16(16),l=t.getUint16(18),c=[];let h=40;for(let e=0;e<i;e++){const e=t.getUint8(h+16),a=t.getUint8(h+17),r=t.getUint8(h+19),i=t.getUint16(h+20),l=t.getUint16(h+22),d=t.getFloat32(h+24),u=t.getFloat32(h+28),m=t.getFloat32(h+32),p=s.vec3.fromValues(d,u,m),f=t.getFloat32(h+36),A=t.getFloat32(h+40),g=t.getFloat32(h+44),_=s.vec3.fromValues(f,A,g),S=t.getFloat32(h+48),b=t.getUint8(h+52)/255,v=t.getUint8(h+53)/255,w=t.getUint8(h+54)/255,x=t.getUint8(h+55)/255,T=n.colorNewFromRGBA(o.clamp(S*b,0,1),o.clamp(S*v,0,1),o.clamp(S*w,0,1),x),y=n.colorNewFromRGBA8(t.getUint32(h+56)),C=t.getFloat32(h+60),M=t.getFloat32(h+64),U=t.getFloat32(h+68);c.push({spotFunction:e,distAttnFunction:a,lightType:r,ambientLightIndex:i,flags:l,pos:p,aim:_,color:T,specColor:y,spotCutoff:C,refDist:M,refBrightness:U}),h+=80}const d=[];let u=h;for(let e=0;e<l;e++)d.push(n.colorNewFromRGBA8(t.getUint32(u+0))),u+=8;return{lightObjects:c,ambientLights:d}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(54),s=a(1);class i{constructor(){this.registers=new Uint32Array(768)}run(e){const t=e.createDataView();this.registers.fill(0);for(let a=0;a<e.byteLength;){const e=t.getUint32(a+4,!0),r=4294967280|e>>>16&15,n=1+(e>>>20&2047),s=!!(2147483648&e);let i=65535&e;for(let e=0;e<n;e++){let n=t.getUint32(a+0,!0);a+=4,0===e&&(a+=4),this.registers[i]=this.registers[i]&~r|n&r,s&&i++}}}}function o(e){switch(e){case 0:return 0;case 1:return 1;case 2:case 3:return 2;case 4:case 5:case 6:case 7:case 8:return 3;case 9:case 10:case 11:case 12:case 13:return 4;default:throw"whoops"}}t.parse=function(e){const t=e.createDataView();r.assert("BCH\0"===r.readString(e,0,4,!1));const a=t.getUint8(4),l=t.getUint8(5);r.assert(33===a&&33===l),t.getUint16(6);const c=[];c[0]=t.getUint32(8,!0),c[1]=t.getUint32(12,!0),c[2]=t.getUint32(16,!0),c[3]=t.getUint32(20,!0),c[4]=t.getUint32(24,!0),c[5]=t.getUint32(28,!0);const h=[];h[0]=t.getUint32(32,!0),h[1]=t.getUint32(36,!0),h[2]=t.getUint32(40,!0),h[3]=t.getUint32(44,!0),h[4]=t.getUint32(48,!0),h[5]=t.getUint32(52,!0),h[6]=t.getUint32(56,!0),h[6]=t.getUint32(60,!0),t.getUint8(64),t.getUint16(66,!0);const d=c[5],u=h[5];for(let e=d;e<d+u;e+=4){const a=t.getUint32(e+0,!0),r=a>>>25&15;let n=a>>>0&33554431;1!==r&&(n*=4);const s=c[a>>>29&7]+n,i=t.getUint32(s+0,!0);t.setUint32(s+0,c[o(r)]+i,!0)}let m=c[0];function p(){const a=function(a){const n=[];let s=t.getUint32(a+0,!0);const i=t.getUint32(a+4,!0);let o=t.getUint32(a+8,!0);a+=12,o+=12;for(let a=0;a<i;a++){const a=t.getUint32(s+0,!0),i=t.getUint32(o+8,!0),l=r.readString(e,i,32);s+=4,o+=12,n.push({offs:a,name:l})}return n}(m);return m+=12,a}const f=p(),A=(p(),p(),p()),g=(p(),p(),p(),p(),p(),p(),p(),p(),p(),p(),p(),new i);for(let e=0;e<f.length;e++){const a=A[e].offs,r=(t.getUint8(a+0),t.getUint8(a+1),t.getUint16(a+2,!0),t.getFloat32(a+4,!0)),n=t.getFloat32(a+8,!0),i=t.getFloat32(a+12,!0),o=t.getFloat32(a+16,!0),l=t.getFloat32(a+20,!0),c=t.getFloat32(a+24,!0),h=t.getFloat32(a+28,!0),d=t.getFloat32(a+32,!0),u=t.getFloat32(a+36,!0),m=t.getFloat32(a+40,!0),p=t.getFloat32(a+44,!0),f=t.getFloat32(a+48,!0);s.mat4.fromValues(r,l,u,0,n,c,m,0,i,h,p,0,o,d,f,1)}const _=[];for(let a=0;a<A.length;a++){const s=A[a].offs,i=t.getUint32(s+0,!0),o=t.getUint32(s+4,!0),l=(t.getUint32(s+8,!0),t.getUint32(s+12,!0),t.getUint32(s+16,!0),t.getUint32(s+20,!0),t.getUint8(s+24)),c=t.getUint8(s+25),h=r.readString(e,t.getUint32(s+28,!0));r.assert(h===A[a].name),g.run(e.subarray(i,4*o));const d=g.registers[130],u=d>>>16,m=65535&d,p=g.registers[133],f=g.registers[142];r.assert(f===l);let S=p,b=u,v=m;const w=[];for(let t=0;t<c;t++){const t=n.computeTextureByteSize(l,b,v),a=n.decodeTexture(f,b,v,e.subarray(S,t));w.push({name:h,width:b,height:v,pixels:a}),S+=t,b/=2,v/=2}_.push({name:h,width:u,height:m,format:l,levels:w})}return{textures:_}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(0);t.makeTextureFromXNA_Texture2D=function(e,t){const a=e.createHostAccessPass();n.assert(0===t.format),n.assert(1===t.levelData.length);const s=e.createTexture(r.makeTextureDescriptor2D(r.GfxFormat.U8_RGBA_NORM,t.width,t.height,1));return a.uploadTextureData(s,0,[t.levelData[0].createTypedArray(Uint8Array)]),e.submitPass(a),s}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(48),s=a(2),i=a(30),o=a(0),l=a(124);class c{constructor(){this.op=0,this.start=0,this.len=1,this.p0=0,this.p1=0,this.v0=0,this.v1=0,this.path=null}compute(e){switch(this.op){case 0:return 0;case 1:return e-this.start>=this.len?this.p1:this.p0;case 2:return this.p0+(e-this.start)*this.v0;case 3:return i.getPointHermite(this.p0,this.p1,this.v0/this.len,this.v1/this.len,(e-this.start)*this.len)}}reset(){this.op=0,this.start=0,this.len=1,this.p0=0,this.p1=0,this.v0=0,this.v1=0}}class h{constructor(){this.op=0,this.start=0,this.len=1,this.c0=r.vec4.create(),this.c1=r.vec4.create()}compute(e,t){switch(this.op){case 1:r.vec4.copy(t,e-this.start>=this.len?this.c1:this.c0);break;case 2:r.vec4.lerp(t,this.c0,this.c1,s.clamp((e-this.start)*this.len,0,1))}}reset(){this.op=0,this.start=0,this.len=1,r.vec4.scale(this.c0,this.c0,0),r.vec4.scale(this.c1,this.c1,0)}}t.getPathPoint=function(e,t,a,n=!1){let o=0;for(;o+1<t.length&&a>t.times[o+1];)o++;const l=(a-t.times[o])/(t.times[o+1]-t.times[o]),c=o*(1===t.kind?9:3);switch(t.kind){case 0:for(let a=0;a<3;a++)e[a]=s.lerp(t.points[c+a],t.points[c+3+a],l);break;case 1:for(let a=0;a<3;a++)e[a]=i.getPointBezier(t.points[c+a],t.points[c+3+a],t.points[c+6+a],t.points[c+9+a],l);break;case 2:for(let a=0;a<3;a++)e[a]=i.getPointBasis(t.points[c+a],t.points[c+3+a],t.points[c+6+a],t.points[c+9+a],l);break;case 3:for(let a=0;a<3;a++)e[a]=i.getPointHermite(t.points[c+3+a],t.points[c+6+a],(t.points[c+6+a]-t.points[c+a])*t.segmentRate,(t.points[c+9+a]-t.points[c+3+a])*t.segmentRate,l)}n||r.vec3.scale(e,e,100)},t.getPathTangent=function(e,t,a){let r=0;for(;r+1<t.length&&a>t.times[r+1];)r++;const n=(a-t.times[r])/(t.times[r+1]-t.times[r]),s=r*(1===t.kind?9:3);switch(t.kind){case 0:for(let a=0;a<3;a++)e[a]=t.points[s+3+a]-t.points[s+a];break;case 1:for(let a=0;a<3;a++)e[a]=i.getDerivativeBezier(t.points[s+a],t.points[s+3+a],t.points[s+6+a],t.points[s+9+a],n);break;case 2:for(let a=0;a<3;a++)e[a]=i.getDerivativeBasis(t.points[s+a],t.points[s+3+a],t.points[s+6+a],t.points[s+9+a],n);break;case 3:for(let a=0;a<3;a++)e[a]=i.getDerivativeHermite(t.points[s+3+a],t.points[s+6+a],(t.points[s+6+a]-t.points[s+a])*t.segmentRate,(t.points[s+9+a]-t.points[s+3+a])*t.segmentRate,n)}};class d{constructor(e=!1){this.track=null,this.interpolators=o.nArray(10,()=>new c),this.colors=[],this.stateFlags=0,this.loopCount=0,this.forceLoop=!1,this.trackIndex=0,this.nextUpdate=0,e&&(this.colors=o.nArray(5,()=>new h))}setTrack(e){this.track=e,this.loopCount=0,this.reset()}reset(e=0){this.trackIndex=0,this.nextUpdate=e;for(let e=0;e<this.interpolators.length;e++)this.interpolators[e].reset();for(let e=0;e<this.colors.length;e++)this.colors[e].reset()}runUntilUpdate(){const e=this.trackIndex;return this.update(this.nextUpdate),this.trackIndex<=e||null===this.track}compute(e,t){return this.interpolators[e].compute(t)}update(e){if(null===this.track)return!1;const t=this.track.entries;for(;this.nextUpdate<=e;){if(this.trackIndex===t.length)if(this.loopCount++,this.track.loopStart>=0)this.trackIndex=this.track.loopStart;else{if(!this.forceLoop)return!1;this.trackIndex=0}const e=t[this.trackIndex++];let a=0;switch(e.kind){case 4:case 3:for(let t=0;t<10;t++)e.flags&1<<t&&(this.interpolators[t].op=2,this.interpolators[t].p0=this.interpolators[t].p1,this.interpolators[t].p1=e.data[a++],this.interpolators[t].v1=0,0!==e.increment&&(this.interpolators[t].v0=(this.interpolators[t].p1-this.interpolators[t].p0)/e.increment),this.interpolators[t].start=this.nextUpdate);break;case 6:case 5:for(let t=0;t<10;t++)e.flags&1<<t&&(this.interpolators[t].op=3,this.interpolators[t].p0=this.interpolators[t].p1,this.interpolators[t].p1=e.data[a++],this.interpolators[t].v0=this.interpolators[t].v1,this.interpolators[t].v1=e.data[a++],0!==e.increment&&(this.interpolators[t].len=1/e.increment),this.interpolators[t].start=this.nextUpdate);break;case 7:for(let t=0;t<10;t++)e.flags&1<<t&&(this.interpolators[t].v1=e.data[a++]);break;case 9:case 8:for(let t=0;t<10;t++)e.flags&1<<t&&(this.interpolators[t].op=3,this.interpolators[t].p0=this.interpolators[t].p1,this.interpolators[t].p1=e.data[a++],this.interpolators[t].v0=this.interpolators[t].v1,this.interpolators[t].v1=0,0!==e.increment&&(this.interpolators[t].len=1/e.increment),this.interpolators[t].start=this.nextUpdate);break;case 11:case 10:for(let t=0;t<10;t++)e.flags&1<<t&&(this.interpolators[t].op=1,this.interpolators[t].p0=this.interpolators[t].p1,this.interpolators[t].p1=e.data[a++],this.interpolators[t].v1=0,this.interpolators[t].len=e.increment,this.interpolators[t].start=this.nextUpdate);break;case 12:for(let t=0;t<10;t++)e.flags&1<<t&&(this.interpolators[t].start-=e.increment);break;case 15:this.stateFlags=e.flags;break;case 13:this.interpolators[3].path=e.path;break;case 19:case 18:for(let t=0;t<5;t++)e.flags&1<<t&&(this.colors[t].op=1,r.vec4.copy(this.colors[t].c0,this.colors[t].c1),r.vec4.copy(this.colors[t].c1,o.assertExists(e.colors[a++])),this.interpolators[t].len=e.increment,this.interpolators[t].start=this.nextUpdate);break;case 21:case 20:for(let t=0;t<5;t++)e.flags&1<<t&&(this.colors[t].op=2,r.vec4.copy(this.colors[t].c0,this.colors[t].c1),r.vec4.copy(this.colors[t].c1,o.assertExists(e.colors[a++])),0!==e.increment&&(this.interpolators[t].len=1/e.increment),this.interpolators[t].start=this.nextUpdate)}e.block&&(this.nextUpdate+=e.increment)}return!0}}t.Animator=d;t.Material=class{constructor(e,t){this.data=e,this.textures=t,this.animator=new d(!0)}forceLoop(){this.animator.forceLoop=!0}update(e){this.animator.update(e)&&(this.lastTime=e)}setTrack(e){this.animator.setTrack(e)}getColor(e,t){this.data.flags&1<<t+l.ColorFlagStart&&this.animator.colors[t].compute(this.lastTime,e)}getPrimLOD(){const e=this.animator.compute(8,this.lastTime);return e<0?1:e%1}xScale(){const e=this.animator.compute(3,this.lastTime);return 0===e?1:this.data.xScale/e}yScale(){const e=this.animator.compute(4,this.lastTime);return 0===e?1:this.data.yScale/e}getXShift(e){const t=this.animator.interpolators[1+5*e],a=this.animator.interpolators[3],r=0===t.op?this.data.tiles[e].xShift:t.compute(this.lastTime),n=0===a.op?this.data.xScale:a.compute(this.lastTime);return(r*this.data.tiles[e].width+this.data.shift)/n}getYShift(e){const t=this.animator.interpolators[2+5*e],a=this.animator.interpolators[4],r=0===t.op?this.data.tiles[e].yShift:t.compute(this.lastTime),n=0===a.op?this.data.yScale:a.compute(this.lastTime);return((1-r-n)*this.data.tiles[e].height+this.data.shift)/n}fillTextureMappings(e){if(!(23&this.data.flags))return;let t=-1;4&this.data.flags&&(t=this.animator.interpolators[9].compute(this.lastTime)>>>0);for(let a=0;a<e.length;a++){let r=-1;const n=0===a?1:2;if(16&this.data.flags)r=(this.animator.compute(8,this.lastTime)>>>0)+a;else if(this.data.flags&n)r=this.animator.compute(0===a?0:5,this.lastTime)>>>0;else if(-1===t)continue;for(let n=0;n<this.data.usedTextures.length;n++)if(this.data.usedTextures[n].pal===t&&this.data.usedTextures[n].tex===r){e[a].gfxTexture=this.textures[this.data.usedTextures[n].index];break}}}};const u=new d(!0),m=o.nArray(2,()=>new n.TileState);t.findNewTextures=function(e,t,a,r){var n;const s=a.materials[r];if(!(23&s.flags))return;const i=a.model,l=i.sharedOutput.textureCache,c=null===(n=i.rspOutput)||void 0===n?void 0:n.drawCalls.find(e=>e.materialIndex===r);if(void 0===c)throw"no corresponding draw call for material";if(null===t){if(s.optional)return;s.optional=!0}u.setTrack(t);const h=e.getRange(e.deref(s.textureStart));function d(t,a,r,n=0){if(s.usedTextures.find(e=>e.tex===t&&e.pal===a))return;const i=-1===a?n:e.deref(s.paletteStart+4*a)-h.start,o=-1===t?n:e.deref(s.textureStart+4*t)-h.start;let c=0;if(0<=o&&o<h.data.byteLength)c=l.translateTileTexture([h.data],o,i,r);else{const a=e.deref(s.textureStart+4*t),n=e.getRange(a);c=l.translateTileTexture([h.data,n.data],a-n.start|1<<24,i,r)}s.usedTextures.push({tex:t,pal:a,index:c})}for(let e=0;e<c.textureIndices.length;e++)m[e].copy(l.textures[c.textureIndices[e]].tile);let p=0;const f=!(19&s.flags);f?(p=l.textures[c.textureIndices[0]].dramAddr,o.assert(1===c.textureIndices.length||l.textures[c.textureIndices[0]].dramAddr===p)):4&s.flags||(p=l.textures[c.textureIndices[0]].dramPalAddr,o.assert(1===c.textureIndices.length||l.textures[c.textureIndices[0]].dramPalAddr===p));const A=u.interpolators[9];for(;;){const e=u.runUntilUpdate();let t=-1,a=-1;if(4&s.flags&&(t=A.p0>>>0,a=A.p1>>>0,o.assert(3!==A.op&&(2!==A.op||Math.abs(t-a)<=1))),f)for(let e=0;e<c.textureIndices.length;e++)d(-1,t,m[0],p),d(-1,a,m[0],p);else if(16&s.flags){const e=u.interpolators[8];let r=Math.min(e.p0)>>>0,n=Math.max(e.p1)>>>0;if(2===e.op||3===e.op){n<r&&([r,n]=[n,r]);for(let e=r;e<=n+1;e++)d(e,t,m[0],p),d(e,a,m[0],p)}else for(let e=0;e<2;e++)d(r+e,t,m[0],p),d(r+e,a,m[0],p),d(n+e,t,m[0],p),d(n+e,a,m[0],p)}else for(let e=0;e<c.textureIndices.length;e++){const r=0===e?1:2;if(!(s.flags&r))continue;const n=0===e?0:5,i=u.interpolators[n],l=i.p0>>>0,c=i.p1>>>0;o.assert(3!==i.op&&(2!==i.op||Math.abs(l-c)<=1)),d(l,t,m[e],p),d(l,a,m[e],p),d(c,t,m[e],p),d(c,a,m[e],p)}if(e)break}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(340)),s=r(a(48)),i=r(a(201)),o=a(58),l=a(1),c=a(0),h=a(123),d=a(202),u=a(2);t.isActor=function(e){return!!e.stateGraph};class m{constructor(e){this.ranges=e}getView(e){const t=this.getRange(e);return t.data.createDataView(e-t.start)}getRange(e){for(let t=0;t<this.ranges.length;t++){const a=e-this.ranges[t].start;if(0<=a&&a<this.ranges[t].data.byteLength)return this.ranges[t]}throw`no matching range for ${c.hexzero(e,8)}`}deref(e){return this.getView(e).getUint32(0)}}function p(e){switch(e){case 3550944:case 3550736:return 0;case 3550812:case 3550660:return 1}return 2}function f(e,t,a,r){const n=e.getView(a);c.assert(g.parseFromView(n)||2150543128===a,`bad parse for init function ${c.hexzero(a,8)}`);const s=e.getView(g.dataAddress),i=s.getUint32(0),h=s.getUint32(4),d=s.getUint32(8),u=s.getUint32(12),m=_(s,16),f=_(s,28),A=s.getFloat32(40)*m[1],S=s.getUint16(44);s.getUint32(46);l.vec3.div(f,f,m),l.vec3.scale(m,m,.1);const b=new o.RSPSharedOutput;try{const a=v(e,i,h,d,b),n=function(e,t,a){const r=e.deref(t),n=e.deref(t+4),s=[],i=[];0!==r&&i.push(r);W(e,n,s,i);const o=function(e,t,a){const r=[];for(let n=0;n<t.length;n++){const s=e.getView(t[n]);let i=30*s.getFloat32(0);0===i&&(i=30);const o=s.getFloat32(4),l=s.getUint32(8),c=s.getUint32(12),h=(s.getUint32(16),[]),d=e.getView(l);for(let t=0;t<a.length;t++){const a=d.getUint32(4*t);h.push(P(e,a))}r.push({fps:i,frames:o,tracks:h,materialTracks:E(e,c,a)})}0===r.length&&E(e,0,a);return r}(e,i,a);return{states:s,animations:o}}(e,u,a);r.push({id:t,flags:S,nodes:a,scale:m,center:f,radius:A,sharedOutput:b,spawn:p(g.spawnFunc),stateGraph:n,globalPointer:g.globalRef})}catch(e){console.warn("failed parse",t,e)}}t.DataMap=m,t.parseLevel=function(e){const t=e[0],a=new m([{data:t.Data,start:t.StartAddress},{data:t.Code,start:t.CodeStartAddress}]);for(let t=1;t<e.length;t++)a.ranges.push({data:e[t].Data,start:e[t].StartAddress},{data:e[t].Code,start:e[t].CodeStartAddress});const r=[],i=a.deref(t.Header),d=a.getView(i),p=d.getUint32(0),A=d.getUint32(4),g=d.getUint32(8),S=new s.TextureCache;let y=null;if(g>0){const e=a.getView(g),t=e.getUint32(0),r=e.getUint32(8),s=e.getUint32(12),i=0!==r?b(a,a.deref(r)):[],c=new n.RSPState(new o.RSPSharedOutput,a);x(c,!0);const d={billboard:0,model:T(a,t,[c],i),translation:l.vec3.create(),euler:l.vec3.create(),scale:l.vec3.clone(u.Vec3One),parent:-1,materials:i};let m=null;if(0!==s){const e=a.deref(s),t=[];for(let r=0;r<i.length;r++){const n=P(a,a.deref(e+4*r));h.findNewTextures(a,n,d,r),t.push(n)}m={fps:30,frames:0,tracks:[null],materialTracks:[t]}}y={node:d,objects:[],animation:m}}const C=a.getView(p);let M=0;for(;0!==C.getUint32(M);)r.push(w(a,C.getUint32(M),S)),M+=4;const U=a.getView(A);for(M=0;0!==U.getUint32(M);)r.push(w(a,U.getUint32(M),S)),M+=4;28===t.Name&&r[0].objects.push({id:151,behavior:1,pos:l.vec3.fromValues(0,100,500),euler:l.vec3.create(),scale:l.vec3.clone(u.Vec3One)},{id:1001,behavior:0,pos:l.vec3.fromValues(0,0,1e4),euler:l.vec3.fromValues(0,Math.PI,0),scale:l.vec3.clone(u.Vec3One)}),z.dataMap=a;const k=function(e,t){let a=0;switch(t){case 16:a=2150416388;break;case 18:a=2150555936;break;case 20:a=2150392680;break;case 22:a=2150508808;break;case 24:a=2150502052;break;case 26:a=2150443444}if(0===a)return[];const r=[],n=e.getView(a);let s=0,i=0;for(;;){const t=n.getInt8(s+0),a=n.getUint32(s+4);if(s+=8,t<0)break;if(i+=t,0===a){r.push({probability:t,id:0});break}z.parseFromView(e.getView(a)),c.assert(0!==z.data.id),r.push({probability:t,id:z.data.id})}22===t&&(i=100);for(let e=0;e<r.length;e++)r[e].probability/=i;return r}(a,t.Name),D=[];if(0!==t.Objects){const e=a.getView(t.Objects);for(M=0;0!==e.getInt32(M);){const t=e.getInt32(M+0),r=e.getUint32(M+4);M+=16,f(a,t,r,D)}}16===t.Name&&f(a,1006,2150415776,D);const I=a.deref(t.Header+4);if(0!==I){const e=a.getView(I);for(M=0;;){const t=e.getInt32(M+0);if(-1===t)break;const r=e.getUint32(M+4),s=e.getUint32(M+8);c.assert(2148413616===r,c.hexzero(r,8));const i=new o.RSPSharedOutput,h=[new n.RSPState(i,a)];x(h[0],!0);const d={model:T(a,s,h),billboard:0,parent:-1,translation:l.vec3.create(),euler:l.vec3.create(),scale:l.vec3.clone(u.Vec3One),materials:[]};D.push({id:t,node:d,sharedOutput:i}),M+=12}}const R=function(e,t){const a=new o.RSPSharedOutput,r=v(e,2151328304,2151274808,2148144816,a),n=function(e){switch(e){case 16:return[2148779392,2148781728];case 18:return[2148784416,2148787152];case 24:return[2148627680,2148631280];case 22:return[2148836960,2148840528];case 20:return[2148824384,2148828192];case 26:return[2148664608,2148668064];case 28:return[2148637408,2148641136]}throw"bad level ID"}(t),s=[];for(let t=0;t<r.length;t++){const a=e.deref(n[0]+4*t);s.push(P(e,a))}const i=[{fps:15,frames:0,tracks:s,materialTracks:E(e,n[1],r)}];return{nodes:r,sharedOutput:a,animations:i}}(a,t.Name),B=function(e){const t=[];{const a=new o.RSPSharedOutput,r=v(e,2148445904,2148445272,2148144600,a),n=[{fps:12,frames:0,tracks:[null,null],materialTracks:E(e,2148446048,r)}];t.push({nodes:r,sharedOutput:a,animations:n})}{const a=new o.RSPSharedOutput,r=v(e,2148438328,2148437688,2148144600,a),n=[{fps:12,frames:0,tracks:[null,null],materialTracks:E(e,2148438464,r)}];t.push({nodes:r,sharedOutput:a,animations:n})}{const a=new o.RSPSharedOutput,r=v(e,2148447280,2148447504,2148144648,a),n=[];for(let t=0;t<r.length;t++)n.push(P(e,e.deref(2148446128+4*t)));const s=[{fps:27,frames:0,tracks:n,materialTracks:E(e,2148446400,r)}];t.push({nodes:r,sharedOutput:a,animations:s})}{const a=new o.RSPSharedOutput,r=v(e,2148457136,2148457360,2148144648,a),n=[];for(let t=0;t<r.length;t++)n.push(P(e,e.deref(2148455856+4*t)));const s=[{fps:27,frames:0,tracks:n,materialTracks:E(e,2148456112,r)}];t.push({nodes:r,sharedOutput:a,animations:s})}return t}(a);let F=null;return 0!==t.Collision&&(F=function(e,t){const a=e.getView(t),r=a.getUint32(0),n=a.getUint32(4),s=e.getView(r);return function e(t,a,r,n){const s=28*n,i=_(t,s+0),o=t.getInt32(s+12),c=t.getInt32(s+16),h=t.getInt32(s+20),d=t.getInt32(s+24);function u(e){if(-1===e)return null;for(;r.length<e+1;){const e=20*r.length,t=a.getFloat32(e+0),n=a.getFloat32(e+4),s=a.getFloat32(e+8);r.push({normal:l.vec3.fromValues(t,s,n),offset:a.getFloat32(e+12),type:a.getUint32(e+16)>>>8})}return r[e]}const m=o>-1?e(t,a,r,o):null,p=c>-1?e(t,a,r,c):null,f=u(h),A=u(d);return{line:i,posSubtree:m,posPlane:f,negSubtree:p,negPlane:A}}(e.getView(n),s,[],0)}(a,t.Collision)),{rooms:r,skybox:y,sharedCache:S,objectInfo:D,collision:F,zeroOne:R,projectiles:B,fishTable:k}};class A extends i.NaiveInterpreter{constructor(){super(...arguments),this.spawnFunc=0,this.dataAddress=0,this.globalRef=0}reset(){super.reset(),this.spawnFunc=0,this.dataAddress=0,this.globalRef=0}handleFunction(e,t,a,r,n,s){return this.spawnFunc=e,this.dataAddress=c.assertExists(s[1]).value,0}handleStore(e,t,a,r){43===e&&3===t.lastOp&&(this.globalRef=a.value)}}const g=new A;function _(e,t){return l.vec3.fromValues(e.getFloat32(t+0),e.getFloat32(t+4),e.getFloat32(t+8))}function S(e,t){return l.vec4.fromValues(e.getUint8(t+0)/255,e.getUint8(t+1)/255,e.getUint8(t+2)/255,e.getUint8(t+3)/255)}function b(e,t){if(0===t)return[];const a=[],r=e.getRange(t),n=r.data.createDataView();let s=t-r.start;for(;;){const t=n.getUint32(s);if(0===t)break;s+=4;const r=e.getView(t),i=r.getUint16(48),o=r.getUint32(4),l=r.getUint32(44),c=r.getUint16(8),h=r.getUint16(10),d=r.getUint32(16),u=r.getFloat32(28),m=r.getFloat32(32),p=S(r,80),f=S(r,88),A=S(r,92),g=S(r,96),_=S(r,100),b=r.getUint8(84)/255,v=[];v.push({width:r.getUint16(12),height:r.getUint16(14),xShift:r.getFloat32(20),yShift:r.getFloat32(24)}),v.push({width:r.getUint16(56),height:r.getUint16(58),xShift:r.getFloat32(60),yShift:r.getFloat32(64)});const w=[];w.push({fmt:r.getUint8(2),siz:r.getUint8(3),width:0,height:0}),w.push({fmt:r.getUint8(50),siz:r.getUint8(51),width:r.getUint16(52),height:r.getUint16(54)}),a.push({flags:0===i?161:i,textureStart:o,paletteStart:l,tiles:v,textures:w,primLOD:b,halve:d,usedTextures:[],shift:h,scale:c,xScale:u,yScale:m,primColor:p,envColor:f,blendColor:A,diffuse:g,ambient:_,optional:!1})}return a}function v(e,t,a,r,s){const i=e.getView(t),o=[],l=[],h=c.nArray(2,()=>new n.RSPState(s,e)),d=function(e){switch(e){case 2147569560:case 2148144600:case 2150995164:return T;case 2150994988:case 2150995340:return y;case 2150490732:return C;case 2150995252:case 2148144648:case 2150496996:return M;case 2150995076:case 2148144816:return U;default:throw`unknown renderfunc ${c.hexzero(e,8)}`}}(r);x(h[0],!0),x(h[1],!1);let u=0,m=0;for(;;){const t=i.getUint8(m+2)>>>4,r=4095&i.getUint16(m+2);if(18===r)break;let n=i.getUint32(m+4);const s=_(i,m+8),p=_(i,m+20),f=_(i,m+32),A=0===r?-1:c.assertExists(l[r-1]);l[r]=u;const g={billboard:t,translation:s,euler:p,scale:f,parent:A,materials:[]};n>0&&(g.materials=0===a?[]:b(e,e.deref(a+4*u)),g.model=d(e,n,h,g.materials),h[0].clear(),h[1].clear()),o.push(g),m+=44,u++}return o}function w(e,t,a){const r=e.getView(t),s=r.getUint32(0),i=_(r,4),h=r.getFloat32(16);c.assert(0===h);const d=r.getUint32(24),m=r.getUint32(28);l.vec3.scale(i,i,100);const p=e.getView(s),f=p.getUint32(0),A=p.getUint32(4),g=p.getUint32(8),S=(p.getUint32(12),p.getUint32(16),p.getUint32(24),p.getUint32(28),new o.RSPSharedOutput);S.textureCache=a;const v=new n.RSPState(S,e);x(v,!0);const w=0!==A?b(e,e.deref(A)):[],y={model:T(e,f,[v],w),billboard:0,parent:-1,translation:i,euler:l.vec3.create(),scale:l.vec3.clone(u.Vec3One),materials:w};let C=null;0!==g&&(C={fps:30,frames:0,tracks:[null],materialTracks:E(e,g,[y])});const M=[];if(d>0){const t=e.getView(d);let a=0;for(;;){const e=t.getInt32(a+0);if(-1===e)break;const r=_(t,a+4);l.vec3.scale(r,r,100),l.vec3.add(r,r,i);const n=_(t,a+16),s=_(t,a+28);M.push({id:e,behavior:0,pos:r,euler:n,scale:s}),a+=40}}if(m>0){const t=e.getView(m);let a=0;for(;;){const r=t.getInt32(a+0);if(-1===r)break;const n=t.getInt32(a+4),s=_(t,a+8);l.vec3.scale(s,s,100),l.vec3.add(s,s,i);const o=_(t,a+20),c=_(t,a+32),h=t.getUint32(a+44),d={id:r,behavior:n,pos:s,euler:o,scale:c};0!==h&&(d.path=D(e,h)),M.push(d),a+=48}}return{node:y,objects:M,animation:C}}function x(e,t){e.gSPSetGeometryMode(4),t?(e.gDPSetOtherModeL(0,29,202973304),e.gSPSetGeometryMode(131072)):e.gDPSetOtherModeL(0,29,5261784),e.gDPSetOtherModeH(12,2,8192),e.gDPSetOtherModeH(20,2,1<<20),e.gDPSetTile(0,2,0,256,5,0,0,0,0,0,0,0)}function T(e,t,a,r=[]){const s=a[0];n.runDL_F3DEX2(s,t,k(r));const i=s.finish();return{sharedOutput:s.sharedOutput,rspState:s,rspOutput:i}}function y(e,t,a,r=[]){const s=e.getView(t),i=s.getUint32(0),o=s.getUint32(4),l=a[0];l.SP_MatrixIndex=1,0!==i&&n.runDL_F3DEX2(l,i,k(r)),l.SP_MatrixIndex=0,0!==o&&n.runDL_F3DEX2(l,o,k(r));const c=l.finish();return{sharedOutput:l.sharedOutput,rspState:l,rspOutput:c}}function C(e,t,a,r=[]){return y(e,t,a,r)}function M(e,t,a,r=[]){const s=e.getView(t),i=k(r);let o=0;for(;;){const e=s.getUint32(o+0),t=s.getUint32(o+4);if(4===e)break;n.runDL_F3DEX2(a[e],t,i),o+=8}let l=a[0].finish(),c=a[1].finish();return null===l?l=c:null!==c&&l.drawCalls.push(...c.drawCalls),{sharedOutput:a[0].sharedOutput,rspState:a[0],rspOutput:l}}function U(e,t,a,r=[]){const n=e.getView(t);let s=0;for(;;){const i=n.getUint32(s);if(4===i)break;y(e,t+s+4,[a[i]],r),s+=12}let i=a[0].finish(),o=a[1].finish();return null===i?i=o:null!==o&&i.drawCalls.push(...o.drawCalls),{sharedOutput:a[0].sharedOutput,rspState:a[0],rspOutput:i}}function k(e){return function(t,a){c.assert(a>>>24==14,`bad dl jump address ${c.hexzero(a,8)}`),t.materialIndex=a>>>3&255;const r=c.assertExists(e[a>>>3&255]);if(4&r.flags&&(t.gDPSetTextureImage(0,2,0,t.dataMap.deref(r.paletteStart)),3&r.flags&&(t.gDPSetTile(0,0,0,256,5,0,0,0,0,0,0,0),t.gDPLoadTLUT(5,1===r.textures[0].siz?256:16))),536&r.flags&&t.gSPSetPrimColor(r.primLOD,255*r.primColor[0],255*r.primColor[1],255*r.primColor[2],255*r.primColor[3]),18&r.flags){const e=3===r.textures[1].siz?3:2,a=0==(17&r.flags)?0:4;if(t.gDPSetTextureImage(r.textures[1].fmt,e,0,t.dataMap.deref(r.textureStart+a)),17&r.flags){let e=r.textures[1].width*r.textures[1].height;switch(r.textures[1].siz){case 0:e=e+4>>2;break;case 1:e=e+1>>1}const a=(1<<14-r.textures[1].siz)/r.textures[1].width;t.gDPLoadBlock(6,0,0,e,a)}}17&r.flags&&t.gDPSetTextureImage(r.textures[0].fmt,r.textures[0].siz,0,t.dataMap.deref(r.textureStart));const n=0===r.halve?r.xScale:r.xScale/2;if(32&r.flags){const e=(r.tiles[0].width*r.tiles[0].xShift+r.shift)/n,a=(r.tiles[0].height*(1-r.tiles[0].yShift)+r.shift)/r.yScale-r.tiles[0].height;t.gDPSetTileSize(0,e<<2,a<<2,r.tiles[0].width+e-1<<2,r.tiles[0].height+a-1<<2)}if(64&r.flags){const e=(r.tiles[1].width*r.tiles[1].xShift+r.shift)/n,a=(r.tiles[1].height*(1-r.tiles[1].yShift)+r.shift)/r.yScale-r.tiles[1].height;t.gDPSetTileSize(1,e<<2,a<<2,r.tiles[1].width+e-1<<2,r.tiles[1].height+a-1<<2)}128&r.flags&&t.gSPTexture(!0,0,0,(1<<21)/r.scale/n,(1<<21)/r.scale/r.yScale)}}function D(e,t){const a=e.getView(t),r=a.getUint8(0),n=a.getUint16(2),s=a.getFloat32(4),i=a.getUint32(8),o=a.getFloat32(12),l=a.getUint32(16),c=a.getUint32(20),h=e.getRange(l),d=h.data.createTypedArray(Float32Array,l-h.start,n,1);let u=3*(n+2);1===r&&(u=9*n),0===r&&(u=3*n);const m=e.getRange(i),p=m.data.createTypedArray(Float32Array,i-m.start,u,1);let f;if(0!==c){const t=e.getRange(c);f=t.data.createTypedArray(Float32Array,c-t.start,5*(n-1),1)}else f=new Float32Array(0);return{kind:r,length:n,segmentRate:s,duration:o,times:d,points:p,quartics:f}}function I(e){let t=0;for(e>>>=0;e>0;)1&e&&t++,e>>>=1;return t}function R(e,t){switch(e){case 0:case 1:case 2:case 12:case 13:case 14:case 15:case 16:return 0;case 6:case 5:return 2*t}return t}function B(e){switch(e){case 2:case 3:case 5:case 8:case 10:case 15:case 16:case 17:case 18:case 20:return!0}return!1}function P(e,t){if(0===t)return null;const a=e.getRange(t),r=a.data.createDataView(),n=[],s=[];let i=t-a.start;for(;;){n.push(i);const t=r.getUint8(i+0)>>>1,o=r.getUint32(i+0)>>>15&1023,l=32767&r.getUint16(i+2);if(i+=4,14===t){const e=r.getUint32(i),t=n.findIndex(t=>t+a.start===e);return c.assert(t>=0,`bad loop start address ${c.hexzero(t,8)}`),{entries:s,loopStart:t}}if(0===t)return{entries:s,loopStart:-1};const h=B(t);let d;const u=[],m=R(t,I(o));if(t>=18){for(let e=0;e<m;e++)u.push(S(r,i)),i+=4;d=new Float32Array(0)}else d=a.data.createTypedArray(Float32Array,i,m,1),i+=4*m;const p={kind:t,flags:o,increment:l,block:h,data:d,path:null,colors:u};13===t&&(p.path=D(e,r.getUint32(i)),i+=4),s.push(p)}}function E(e,t,a){const r=[];if(0!==t){const n=e.getView(t);for(let t=0;t<a.length;t++){const s=n.getUint32(4*t),i=[];for(let r=0;r<a[t].materials.length;r++){const n=0===s?null:P(e,e.deref(s+4*r));h.findNewTextures(e,n,a[t],r),i.push(n)}r.push(i)}}else for(let t=0;t<a.length;t++)for(let r=0;r<a[t].materials.length;r++)h.findNewTextures(e,null,a[t],r);return r}function F(e,t,a){return null===e?0:0===e.normal[1]?0:-100*(t*e.normal[0]/100+a*e.normal[2]/100+e.offset)/e.normal[1]}t.ColorFlagStart=9,t.findGroundHeight=function(e,t,a){return F(N(e,t,a),t,a)},t.computePlaneHeight=F;const V={normal:l.vec3.create(),type:0,offset:0},O={normal:l.vec3.clone(u.Vec3UnitY),type:-1,offset:0};function N(e,t,a){if(t/=100,a/=100,null===e)return O;for(;;){if(t*e.line[0]+a*e.line[1]+e.line[2]>0){if(e.posPlane)return e.posPlane;if(null===e.posSubtree)return V;e=e.posSubtree}else{if(e.negPlane)return e.negPlane;if(null===e.negSubtree)return V;e=e.negSubtree}}}function L(e){return-1===e.animation&&null===e.motion&&0===e.signals.length&&0===e.flagClear&&-1===e.auxAddress&&void 0===e.spawn&&0===e.flagSet&&void 0===e.ignoreGround&&void 0===e.eatApple&&void 0===e.forwardSpeed&&void 0===e.tangible&&void 0===e.splash}t.findGroundPlane=N;const G=new d.MotionParser,H=c.nArray(2,()=>({value:0,lastOp:0}));class j extends i.NaiveInterpreter{constructor(e,t,a,r){super(),this.dataMap=e,this.allStates=a,this.animationAddresses=r,this.trivial=!0,this.stateIndex=-1,this.recentRandom=0,this.loadAddress=0,this.state={startAddress:t,blocks:[],doCleanup:!1},this.trivial=!0,this.stateIndex=-1}parse(){return super.parseFromView(this.dataMap.getView(this.state.startAddress))}reset(){super.reset(),this.trivial=!0,this.recentRandom=0,this.loadAddress=0,this.stateIndex=-1,this.currWait={allowInteraction:!0,interactions:[],duration:0,durationRange:0,loopTarget:0,endCondition:0},this.currBlock={edges:[],animation:-1,force:!1,motion:null,auxAddress:-1,signals:[],flagSet:0,flagClear:0,wait:null}}markNontrivial(){this.trivial&&(c.assert(-1===this.stateIndex),this.trivial=!1,this.stateIndex=this.allStates.length,this.allStates.push(this.state))}handleFunction(e,t,a,r,n,s,i){var o;switch(3533912===e&&null===i||this.markNontrivial(),e){case 3533912:{const e=0===a.value?-1:W(this.dataMap,a.value,this.allStates,this.animationAddresses);if(-1===e)return c.assert(null===i,`bad transition to null ${c.hexzero(this.state.startAddress,8)} ${null===(o=i)||void 0===o?void 0:o.comparator}`),0;if(this.trivial&&null===i)return this.stateIndex=e,0;let t=59,r=0;if(null!==i)if(r=i.comparator.value,12===i.comparator.lastOp||292===i.comparator.lastOp)t=61,5!==i.op&&21!==i.op||(t=62),r=i.comparator.value;else if(9===i.comparator.lastOp)t=i.comparator.value<10?63:68;else if(35===i.comparator.lastOp)switch(i.comparator.value){case 136:t=63,4!==i.op&&20!==i.op||(t=64);break;case 112:t=65,4!==i.op&&20!==i.op||(t=66);break;case 100:t=67;break;default:this.valid=!1,t=69}else 13===i.comparator.lastOp?t=68:(this.valid=!1,t=69);this.addEdge({type:t,param:r,index:e,auxFunc:0})}break;case 3533996:{let e=a.value;a.value<2147483648&&(e=this.loadAddress);const t=this.dataMap.getView(e);let r=0,n=0;for(;;){const e=t.getInt32(r+0);if(0===e)break;n+=e,r+=8}for(c.assert(n>0,"empty random transition"),r=0;;){const e=t.getInt32(r+0);if(0===e)break;const a=t.getUint32(r+4),s=W(this.dataMap,a,this.allStates,this.animationAddresses);this.addEdge({type:60,index:s,param:e/n,auxFunc:0}),r+=8}this.done=!0}break;case 3535196:this.currBlock.force=!0;case 3535160:{if(9!==a.lastOp||a.value<2147483648){this.valid=!1;break}let e=this.animationAddresses.findIndex(e=>e==a.value);-1===e&&(e=this.animationAddresses.length,this.animationAddresses.push(a.value)),this.currBlock.animation=e}break;case 3534328:if(2150460180===a.value&&2150479016===this.state.startAddress)break;0!==a.value?(G.parse(this.dataMap,a.value,this.animationAddresses),this.currBlock.motion=G.blocks):this.currBlock.motion=[];break;case 3538004:this.currWait.allowInteraction=!1;case 3537904:this.currWait.endCondition=a.value,this.currBlock.wait=this.currWait,this.state.blocks.push(this.currBlock),this.currWait={allowInteraction:!0,interactions:[],duration:0,durationRange:0,loopTarget:0,endCondition:0},this.currBlock={edges:[],animation:-1,force:!1,motion:null,auxAddress:-1,signals:[],flagSet:0,flagClear:0,wait:null};break;case 2883904:H[0].lastOp=9,H[0].value=2150395232,H[1].lastOp=35,this.handleStore(43,H[0],H[1],172),H[0].lastOp=9,H[0].value=30,H[1].lastOp=35,this.handleStore(43,H[0],H[1],144),H[0].value=4,this.handleFunction(3537904,t,H[0],r,n,s,i);case 2888768:H[0].lastOp=35,this.handleStore(43,a,H[0],172),H[0].value=65536,this.handleFunction(3537904,t,H[0],r,n,s,i);break;case 48296:t.value>1&&(this.currBlock.wait={allowInteraction:!1,interactions:[],duration:t.value/30,durationRange:0,loopTarget:0,endCondition:4},this.state.blocks.push(this.currBlock),this.currBlock={edges:[],animation:-1,force:!1,motion:null,auxAddress:-1,signals:[],flagSet:0,flagClear:0,wait:null});break;case 47152:this.currBlock.signals.push({value:a.value,target:0,condition:59,conditionParam:0});break;case 46964:{const e=t.value>2147483648||112===t.value?t.value:0;this.currBlock.signals.push({value:a.value,target:e,condition:59,conditionParam:0})}break;case 35880:if(2147553424===a.value)break;z.parseFromView(this.dataMap.getView(a.value)),z.foundSpawn&&(c.assert(0!==z.data.id&&void 0===this.currBlock.spawn),this.currBlock.spawn=z.data);break;case 3534224:2150399860===a.value?(this.handleFunction(3533912,t,a,r,n,s,null),this.done=!0):this.currBlock.auxAddress=a.value;break;case 3534280:c.assert(-1===this.currBlock.auxAddress),this.currBlock.auxAddress=0;case 106004:return this.recentRandom=t.value,t.value;case 3538288:this.state.doCleanup=!0;break;case 3539212:this.currBlock.eatApple=!0;break;case 3531124:case 3531220:case 3531320:c.assert(void 0===this.currBlock.splash),this.currBlock.splash={kind:"splash",onImpact:!1,index:-1,scale:u.Vec3One};break;default:e>2097152&&e<3473920&&(z.parseFromView(this.dataMap.getView(2147483648+e)),z.foundSpawn&&(c.assert(0!==z.data.id&&void 0===this.currBlock.spawn),this.currBlock.spawn=z.data)),this.valid=!1}return 0}handleStore(e,t,a,r){if(this.markNontrivial(),43!==e||35!==a.lastOp&&0!==a.lastOp)57!==e||35!==a.lastOp&&0!==a.lastOp||152!==r?41!==e||35!==a.lastOp&&0!==a.lastOp?(43===e&&t.value>2147483648&&0===this.loadAddress&&(this.loadAddress=t.value),this.valid=!1):8===r&&(13===t.lastOp||293===t.lastOp?this.currBlock.flagSet|=524288*(t.value>>>9):(12===t.lastOp||292===t.lastOp)&&t.value>>>0>32768&&(this.currBlock.flagClear|=524288*(~t.value>>>9))):this.currBlock.forwardSpeed=u.bitsAsFloat32(t.value);else switch(r){case 172:{if(0===t.value)return;let e=t.value;(9!==t.lastOp||t.value<2147483648)&&(e=this.loadAddress);const a=this.dataMap.getView(e);let r=0;for(;;){const e=a.getInt32(r+0);if(58===e)break;const t=a.getUint32(r+4),n=a.getFloat32(r+8),s=a.getUint32(r+12);r+=16,this.currWait.interactions.push({type:e,param:n,index:t>0?W(this.dataMap,t,this.allStates,this.animationAddresses):-1,auxFunc:s})}}break;case 144:9!==t.lastOp&&(this.valid=!1),this.currWait.duration=t.value/30,this.recentRandom>30&&this.recentRandom<=t.value&&(this.currWait.duration-=this.recentRandom/30,this.currWait.durationRange=this.recentRandom/30,this.recentRandom=0);break;case 164:this.currWait.loopTarget=t.value;break;case 140:13===t.lastOp||293===t.lastOp?this.currBlock.flagSet|=t.value>>>0:(12===t.lastOp||292===t.lastOp)&&t.value<0?this.currBlock.flagClear|=~(t.value>>>0):console.warn("unknown flag op",t.lastOp,c.hexzero(t.value,8));break;case 80:13===t.lastOp||293===t.lastOp?this.currBlock.flagSet|=131072*t.value:(12===t.lastOp||292===t.lastOp)&&t.value<0?this.currBlock.flagClear|=131072*~t.value:0===t.lastOp&&0===t.value&&(this.currBlock.flagClear|=393216);break;case 16:this.currBlock.tangible=1===t.value;break;case 204:this.currBlock.ignoreGround=0!==t.value;break;case 168:case 100:case 176:case 192:break;default:this.valid=!1}}finish(){L(this.currBlock)||this.state.blocks.push(this.currBlock)}addEdge(e){L(this.currBlock)&&this.state.blocks.length>0?this.state.blocks[this.state.blocks.length-1].edges.push(e):(this.currBlock.edges.push(e),this.state.blocks.push(this.currBlock),this.currBlock={edges:[],animation:-1,force:!1,motion:null,auxAddress:-1,signals:[],flagSet:0,flagClear:0,wait:null})}}function W(e,a,r,n){const s=r.findIndex(e=>e.startAddress===a);if(s>=0)return s;const i=new j(e,a,r,n);return i.parse(),i.trivial||function(e,a){switch(e.startAddress){case 2150480800:e.blocks[0].edges[0].type=63,e.blocks[0].edges[1].type=63,e.blocks[0].edges[0].param=1,e.blocks[0].edges[1].param=2,e.blocks[0].edges[2].type=63,e.blocks[0].edges[2].param=3,e.blocks[0].edges[3].type=64;break;case 2150468536:e.blocks[0].edges[0].type=63,e.blocks[0].edges[0].param=3,e.blocks[0].edges[1].type=63,e.blocks[0].edges[1].param=4;break;case 2150488928:e.blocks[0].edges.push(e.blocks[1].edges[1]),e.blocks.splice(1);break;case 2150486936:e.blocks[0].edges=[];break;case 2150414780:case 2150415476:case 2150415732:e.blocks[0].auxAddress=0;break;case 2150399860:e.blocks[0].wait.allowInteraction=!0,e.blocks[0].wait.interactions.push({type:24,param:0,index:-1,auxFunc:t.fakeAux}),e.blocks[1].wait.allowInteraction=!0,e.blocks[1].wait.interactions.push({type:24,param:0,index:-1,auxFunc:t.fakeAux});break;case 2150471608:e.blocks[1].signals[0].condition=63,e.blocks[1].signals[0].conditionParam=1,e.blocks[1].signals[1].condition=63,e.blocks[1].signals[1].conditionParam=2,e.blocks[1].signals[1].value=40;break;case 2150365332:e.blocks[2].signals[0].condition=68;break;case 2150366772:c.assert(3===e.blocks.length),e.blocks.splice(0,1);break;case 2150483184:case 2150483344:e.blocks[1].signals.push({target:0,value:28,condition:68,conditionParam:0});break;case 2150408224:c.assertExists(e.blocks[0].splash).scale=l.vec3.fromValues(15,15,10);break;case 2150361892:c.assert(e.doCleanup),e.blocks[0].edges=[];break;case 2150420664:{const t=a.indexOf(2150447112);c.assert(t>=0),e.blocks.push({animation:t,force:!1,edges:e.blocks[0].edges,motion:null,auxAddress:-1,wait:null,flagClear:0,flagSet:0,signals:[]})}break;case 2150421748:e.blocks[1].signals[0].condition=69,e.blocks[1].signals[1].condition=69,e.blocks[1].signals[2].condition=69}}(r[i.stateIndex],n),i.stateIndex}t.fakeAux=1193046;class Z extends i.NaiveInterpreter{constructor(){super(...arguments),this.foundSpawn=!1}reset(){super.reset(),this.data={id:0,behavior:-1,scale:l.vec3.clone(u.Vec3One),yaw:2},this.foundSpawn=!1}handleFunction(e,t,a,r,n,s){return 3554376===e?(c.assert(0!==this.data.id),this.data.behavior=0,this.foundSpawn=!0):3538468===e&&(this.data.id=a.value,this.foundSpawn=!0),0}handleStore(e,t,a,r){if(43===e&&0===r&&9===a.lastOp&&0===this.data.id&&(this.data.id=t.value),this.foundSpawn)if(43===e&&35===a.lastOp&&136===r)this.data.behavior=t.value;else if(57===e&&35===a.lastOp&&76===a.value&&770===t.lastOp)switch(r){case 44:case 48:case 52:this.data.scale[r-44>>>2]=t.value}else if(57===e&&35===a.lastOp&&76===a.value&&768===t.lastOp)switch(r){case 44:case 48:case 52:this.data.scale[r-44>>>2]=2;break;case 32:this.data.yaw=1}else 57===e&&35===a.lastOp&&76===a.value&&49===t.lastOp&&32===r&&32===t.value&&(this.data.yaw=0)}finish(){if(this.foundSpawn){this.data.id>2147483648&&(this.data.id=this.dataMap.deref(this.data.id));for(let e=0;e<3;e++){let t=this.data.scale[e];1!==t&&(t>2147483648&&(t=this.dataMap.deref(t)),this.data.scale[e]=u.bitsAsFloat32(t))}}}}const z=new Z},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(15)),i=a(0),o=n(a(27)),l=n(a(47)),c=n(a(114)),h=n(a(153)),d=n(a(78)),u=n(a(121)),m=n(a(82)),p=n(a(115)),f=n(a(92));function A(e){const t=i.readString(e,0,4);return"Yaz0"===t?o.decompress(e):16===t.charCodeAt(0)||17===t.charCodeAt(0)?Promise.resolve(l.decompress(e)):Promise.resolve(e)}async function g(e,t){const a=e.device;t.sort((e,t)=>e.name.localeCompare(t.name));const r=t[0];if(r.name.endsWith(".zar")||r.name.endsWith(".gar")||r.name.endsWith(".gar.lzs"))return c.createSceneFromZARBuffer(a,r);if(r.name.endsWith(".arc")||r.name.endsWith(".carc")||r.name.endsWith(".szs"))return async function(e,t){const a=e.device;t=await A(t);const r=i.readString(t,0,4);if("RARC"===r||"J3D2"===r)return d.createSceneFromBuffer(e,t);if("U8-"===r)return m.createSceneFromU8Buffer(e,t);if("bres"===r)return m.createBasicRRESRendererFromBRRES(a,[t]);throw"whoops"}(e,r);if(r.name.endsWith(".jpc"))return f.createRendererFromBuffers(e,[r]);if(t.every(e=>e.name.endsWith(".jpa")))return f.createRendererFromBuffers(e,t);if(t.some(e=>e.name.endsWith(".brres")))return m.createBasicRRESRendererFromBRRES(a,t);if(r.name.endsWith(".rarc")||r.name.endsWith(".bmd")||r.name.endsWith(".bdl"))return d.createSceneFromBuffer(e,r);if(r.name.endsWith(".nsbmd"))return h.createBasicNSBMDRendererFromNSBMD(a,r);if(2===t.length&&"d"===t[0].name&&"t"===t[1].name)return p.createWorldRendererFromBuffers(a,t[0],t[1]);throw r.name.endsWith(".bch")&&u.parse(r),"whoops"}t.decompressArbitraryFile=A,t.createSceneFromFiles=g;async function _(e,t=""){if(e.isDirectory){const a=e.createReader();return async function(e,t){const a=await Promise.all(e.map(e=>_(e,t)));return i.flatten(a)}(await async function(e){function t(e){return new Promise((t,a)=>e.readEntries(t,a))}const a=[];for(;;){const r=await t(e);if(0===r.length)break;for(let e=0;e<r.length;e++)a.push(r[e])}return a}(a),`${t}/${e.name}`)}if(e.isFile){const a=e;return new Promise((e,r)=>{a.file(a=>{const r=a;r.path=t,e([r])},e=>{r(e)})})}throw"whoops"}t.DroppedFileSceneDesc=class{constructor(e){this.files=e;const t=e[0];this.id=t.name,this.name=t.name}async createScene(e,t){const a=t.dataFetcher;return g(t,await Promise.all([...this.files].map(e=>function(e,t){const a=t.progressMeter,r=new FileReader;return r.readAsArrayBuffer(e),new Promise((t,n)=>{r.onload=()=>{const a=r.result,n=new s.default(a);n.name=e.name,t(n)},r.onerror=()=>{n()},r.onprogress=e=>{e.lengthComputable&&a.setProgress(e.loaded/e.total)}})}(e,a))))}},t.traverseFileSystemDataTransfer=async function(e){const t=[].slice.call(e.items);if(0===t.length)return[];const a=await Promise.all(t.map(e=>_(e.webkitGetAsEntry())));return i.flatten(a)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return c}));var r=a(3),n=a(103),s=a(24),i=a(19),o=function(){function e(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._user={},this._tags={},this._extra={},this._context={}}return e.prototype.addScopeListener=function(e){this._scopeListeners.push(e)},e.prototype.addEventProcessor=function(e){return this._eventProcessors.push(e),this},e.prototype._notifyScopeListeners=function(){var e=this;this._notifyingListeners||(this._notifyingListeners=!0,setTimeout((function(){e._scopeListeners.forEach((function(t){t(e)})),e._notifyingListeners=!1})))},e.prototype._notifyEventProcessors=function(e,t,a,i){var o=this;return void 0===i&&(i=0),new n.a((function(n,l){var c=e[i];if(null===t||"function"!=typeof c)n(t);else{var h=c(r.a({},t),a);Object(s.m)(h)?h.then((function(t){return o._notifyEventProcessors(e,t,a,i+1).then(n)})).then(null,l):o._notifyEventProcessors(e,h,a,i+1).then(n).then(null,l)}}))},e.prototype.setUser=function(e){return this._user=e||{},this._notifyScopeListeners(),this},e.prototype.setTags=function(e){return this._tags=r.a({},this._tags,e),this._notifyScopeListeners(),this},e.prototype.setTag=function(e,t){var a;return this._tags=r.a({},this._tags,((a={})[e]=t,a)),this._notifyScopeListeners(),this},e.prototype.setExtras=function(e){return this._extra=r.a({},this._extra,e),this._notifyScopeListeners(),this},e.prototype.setExtra=function(e,t){var a;return this._extra=r.a({},this._extra,((a={})[e]=t,a)),this._notifyScopeListeners(),this},e.prototype.setFingerprint=function(e){return this._fingerprint=e,this._notifyScopeListeners(),this},e.prototype.setLevel=function(e){return this._level=e,this._notifyScopeListeners(),this},e.prototype.setTransaction=function(e){return this._transaction=e,this._span&&(this._span.transaction=e),this._notifyScopeListeners(),this},e.prototype.setContext=function(e,t){var a;return this._context=r.a({},this._context,((a={})[e]=t,a)),this._notifyScopeListeners(),this},e.prototype.setSpan=function(e){return this._span=e,this._notifyScopeListeners(),this},e.prototype.getSpan=function(){return this._span},e.clone=function(t){var a=new e;return t&&(a._breadcrumbs=r.d(t._breadcrumbs),a._tags=r.a({},t._tags),a._extra=r.a({},t._extra),a._context=r.a({},t._context),a._user=t._user,a._level=t._level,a._span=t._span,a._transaction=t._transaction,a._fingerprint=t._fingerprint,a._eventProcessors=r.d(t._eventProcessors)),a},e.prototype.clear=function(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._context={},this._level=void 0,this._transaction=void 0,this._fingerprint=void 0,this._span=void 0,this._notifyScopeListeners(),this},e.prototype.addBreadcrumb=function(e,t){var a=r.a({timestamp:Object(i.m)()},e);return this._breadcrumbs=void 0!==t&&t>=0?r.d(this._breadcrumbs,[a]).slice(-t):r.d(this._breadcrumbs,[a]),this._notifyScopeListeners(),this},e.prototype.clearBreadcrumbs=function(){return this._breadcrumbs=[],this._notifyScopeListeners(),this},e.prototype._applyFingerprint=function(e){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint},e.prototype.applyToEvent=function(e,t){return this._extra&&Object.keys(this._extra).length&&(e.extra=r.a({},this._extra,e.extra)),this._tags&&Object.keys(this._tags).length&&(e.tags=r.a({},this._tags,e.tags)),this._user&&Object.keys(this._user).length&&(e.user=r.a({},this._user,e.user)),this._context&&Object.keys(this._context).length&&(e.contexts=r.a({},this._context,e.contexts)),this._level&&(e.level=this._level),this._transaction&&(e.transaction=this._transaction),this._applyFingerprint(e),e.breadcrumbs=r.d(e.breadcrumbs||[],this._breadcrumbs),e.breadcrumbs=e.breadcrumbs.length>0?e.breadcrumbs:void 0,this._notifyEventProcessors(r.d(l(),this._eventProcessors),e,t)},e}();function l(){var e=Object(i.g)();return e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.globalEventProcessors=e.__SENTRY__.globalEventProcessors||[],e.__SENTRY__.globalEventProcessors}function c(e){l().push(e)}},function(e){e.exports=JSON.parse('{"SaveState_bk/01/1":"ZNCA8cD1HFqM_^8]k2WcWe,!oVdS?{YC;u^-x3WVTkf+@vt=tlz=c6poujh-EU{Kcx7;~3=","SaveState_bk/01/2":"ZNCA8x@PW-p6;5j*-OYXNx}&SIbNU0CrTdliJpD[Tf+K[S+h=p4FK5=_dF+_TK9b(_NSb{=","SaveState_bk/01/3":"ZNCA8RTq0}9iLRAx@oBdx!58{T{POohFFmF&|/9^-A[a^brj$_bElSoi=BS2eo]LRtLlaa=","SaveState_bk/02/1":"ZNCA82ts36nllmsbfu4H=fc;tm$jFv6I);F,s[a3:6yQ;&L,!=7QZr$zQAAo=]wli?BWHI=","SaveState_bk/02/2":"ZNCA8v24lKcVc^}Y:d~+Wai?)vH;z4PgKx0!lsfMZJ+FpC:C-qywl(X)+K$:s@vs+,K{cK=","SaveState_bk/02/3":"ZNCA826}=TVl;uP(l|=pK5ILhu]W65SFW_kq}^N/@^S$S,WSh(q1/^qe2YvPSh;2ukMnc?=","SaveState_bk/02/4":"ZNCA8j33a]A8-{OaCLQmjLp?o2Z{/D$9SdLbLe|oon*mNXEg$&v9sI}v86G!xm*;$}R,Sq=","SaveState_bk/05/1":"ZNCA8+9V}L)n+_hHjQ2Cj9Yh/h|$gQg!/W+bp!C,rQvq@mwq8?0s|u(GV:J+t|vRuhV^6L=","SaveState_bk/05/2":"ZNCA8j+ApTV5B={JUi5B_AN1*IE(28sNBtR$gUQ)]}+ze0V3Af;}yb42l4b3-Y-8b$l;?==","SaveState_bk/06/1":"ZNCA8/_){61K*!hIB2}IPHIi|CDiN3v_Dd4-yHGoV@6A$QnD]wfIm9x,SfqY/z1rOL3/;T=","SaveState_bk/07/1":"ZNCA8mtC{CHHuOJ&+|?NQPvRwk1(I[yby~T6q/|emHLkWc5_aIaite*I^3e9,/}3@OUMQY=","SaveState_bk/07/2":"ZNCA8n8_$QEFv3g4@cdn$QH48v-K+2Dt5)Jqi{*imr@IHv2/~]eyBYGz^{gOz06I/6bCga=","SaveState_bk/07/3":"ZNCA8o;rqn$?PK(v5-dZOkHn7fC!msK9WZc*cg4![gxO?P-SmGfE+:PUnz:0hu_NN=!d6N=","SaveState_bk/07/4":"ZNCA8ABMyV4512FuYRF/=EC/$HleBq9tQ-MC^_&P~m)so-E|?:y9[UI+9603=cSUcV:6A)=","SaveState_bk/0A/1":"ZNCA8fk)!IM$0,Z,!_P5)h{tZ7=3X;~6^,tPa}H5Ga9Wj:03Q+9|Qb0B_p;r[DQAg:^f/I=","SaveState_bk/0B/1":"ZNCA8Xe/qTkVHd5ct3F{kn5teap~[Qh8?^jr8a5_B=e$*8$^@n:0Nd,p)gQ{LVG/eRKGWd=","SaveState_bk/0B/2":"ZNCA879~gHEu}Yr;rtF9_Tojw5afWVt_W[aMxb|EU8rxGb}nkN&+L&Y*y]:kaoH([ArH$q=","SaveState_bk/0C/1":"ZNCA8gbro)6Dv}s~xAt3Sn(9TLGvQ^GcB&^?5FG[?7wiL;fo1LiSu)ay*n}ur$taAbg]G4=","SaveState_bk/0C/2":"ZNCA8Z)}|M]De3N3_JN4pAByTM_8/x{CIwe+*O(&w]YerKXDod3j[rCC5^?)aMeoyGP?3o=","SaveState_bk/0D/1":"ZNCA8nHVn3$J-_G?;7c;G6Q7-]C/xXLp~q|hF;B^c-nI!a33!68GBx3(=_Kvn]XPW0JxB9=","SaveState_bk/0D/2":"ZNCA8gTFBgDiEFkfL8IcDLh@S(ql;kp?tnmv@g=zpi=EQ;e+UJN+q[a_bd]b[46+ek)duD=","SaveState_bk/0D/3":"ZNCA8/!}2;_n:_yl}b?ofX*Y94,xr_X7mz[/G{t{FJ9X7MF2J^q~3YdhV=O&4zGTqpFW?{=","SaveState_bk/0E/1":"ZNCA8!Hj[-fqsDj(0w02ql4cu6DM*koaO@[fhT[g5ge!fvQw}J/gyf@K?m^+D-T|icfkGy=","SaveState_bk/10/1":"ZNCA8UUD$K$2aU?6(jtx-3&QfZt~irR:H7,yRLl0pyfvZyos_[D[0!JmUba)1tcmXL35tc=","SaveState_bk/11/1":"ZNCA8XH9)X&p!O0C)GKQ2wJ[Pqr_Wj71C)oQPO!?NYIq(a_knllGow:VCsecYXD!@CF1g^=","SaveState_bk/12/1":"ZNCA8Xk^]dTdZyY[op)ReWbyF5t^PE~^9SqWJP3ajv{Bq[lDl[uKLFSTH2YiVi+xtJwD5E=","SaveState_bk/12/2":"ZNCA8DI3l/bL$rx0?*2{l]vQ(M+BKI,ir9,jGle!L4GxwIW4m[feCqmswFmmNcDmMnxz@F=","SaveState_bk/13/1":"ZNCA8N~!pb0$jJnofV&l5pXLb&46h*C$]1aTL;Cf04txo8DQfmszO(YpSVMS/]&!3=gN8;=","SaveState_bk/14/1":"ZNCA8ywj977)MsJDHH,3ZR+j$W5$?!PT24dP,dcF!4hAyX![R_B~SyRjWQT(kU3&H[4bsG=","SaveState_bk/14/2":"ZNCA8qX!/D6uTv5xADsVCYc{EN9C7/x5TfEOJIHh~LLy&/ERBL)Hy8X/N1MF+W{fv*A|(S=","SaveState_bk/15/1":"ZNCA830H)^+a;_Wj4T)9YV/Z}]R=5aX$-XM$^120iprS6P~&g+ACm-v6pCOXs7O@EMgn27=","SaveState_bk/16/1":"ZNCA84ikzkqG7AEZ|[&C?$rY+0+O*6dvbZ*1D+nSlGA,xM|R0TmuSg+Nx77q+B2F~I3/&q=","SaveState_bk/1A/1":"ZNCA8p&+m7[ZF&iqALsl{=]!:C1n4LZ6J7f,H81t_rn*=~fAR3rZs:^QiIR;K|^M$H?&wc=","SaveState_bk/1B/1":"ZNCA8s;~-$THSB@Q]_W{rMR*Obe]N,?j-[L8?b8Z(@DwzMLyE|4,dZq*}^75/8H|v,)]n$=","SaveState_bk/1B/2":"ZNCA8mO*G=C6JDqYZjw/WmjqerKi+fF,wWlfmU8,x_TtE{v,{pNA/GuUgo0d8b:Iw7qs}S=","SaveState_bk/1B/3":"ZNCA8=?0EXq}ms5F1]Qn_/[tG9~Tcw6y/UUBGy;@0c~~Z(yBLt=b}rnNQ!n!;:T!S1[4Es=","SaveState_bk/1B/4":"ZNCA8/8vL59Qzp@Dh4@ULp@{*)a4!1JEnqkd-h7CsPIz4TvE1g!DB;*m+V]o623v&ZSmHI=","SaveState_bk/1C/1":"ZNCA82h7h({{6iNO@!j7[MZmrSSyJJBEhg{!d*jcmrvpUm|V95j:p6h[6{,*$dL/p4t9/R=","SaveState_bk/1D/1":"ZNCA8bCk4oJ:=YAUQ$VzA]lEY3gFl1auiK7o9ls~WJ5GEMLmuMbFeFb~9F/15(bZ*&UcuB=","SaveState_bk/1D/2":"ZNCA8Us]lvDc9~_I:dFRri7I=6q;AlHL&l+VEKIkW07slRT&vr4AD3ZV:?C4WO]]UM8(}^=","SaveState_bk/21/1":"ZNCA8)LTY[orQIQm?vpob{&{M)NiB0pi$Zldx5DlyoenD:_XdBQCOk,3dQmwK5}+4iIoa{=","SaveState_bk/22/1":"ZNCA85*/[}bl)vhW+C^@r&!qVM),|T{}vdt[?i[,,:=f:xq((9T5vC1Z5Ry&7Nk}tuIDEQ=","SaveState_bk/22/2":"ZNCA8O![btPE{+NxWV@=lrtg2dzTsp-c)8Dz@FrWX&ZTu-1jGqekCP-83XmaaLYq$uk$~(=","SaveState_bk/23/1":"ZNCA861$z:p:D1bKW!RcP8s)!c@:95+f:5[@owEJY:i{oe:H^LLY:GBr5Gie[U0I3c?QSj=","SaveState_bk/24/1":"ZNCA8gviSaj9o5+DDhMP6[,)QGPZ~_cZe9_B~MSHQKp?4$=w;hLE[j]-k+p=ZFDw6;Bi)G=","SaveState_bk/25/1":"ZNCA8FwM+ir:yHH4M(eXHTgM1[fM_IFp162{el2&xLPOy7u/rGQgCwth_Bc7kS3/zg!=7W=","SaveState_bk/26/1":"ZNCA8miEpI)YgY*aOHY/9KNy*AxdHfSG6$M-D|pgQgs1px?~Y|FznZWkmU5!R=vjVl;6@==","SaveState_bk/27/1":"ZNCA8/ch&NY!l!U,UEM4e1$^fMY&YkU-tqn0bWWY//yU;r,v^W6*{~ia}+DNA]v(&RA^jy=","SaveState_bk/27/2":"ZNCA8{PaB/3_8@ddmG?Z{YK3Jso,kq9Ud[kudaOovgJnr@I,MEc;!2(OV3WSqY8Q{&gOoC=","SaveState_bk/28/1":"ZNCA8Ji;ZlfaXpC0xNPM={oA!Ug7!~N,H6@6uey?zNhx|BL&t&m(x+;2v!8~D?e&yulbk9=","SaveState_bk/29/1":"ZNCA8QNGX3]T6V$trDew3jp7Z2dZu9&CX$=/yPJ7-]/+9oUvE$R){p1mD3Ed$NA_Vb+YR1=","SaveState_bk/2A/1":"ZNCA8(2!;WZ^9;I@_fi11l|d9tQ7=[pdShJ{$!q9;Ev{qT/;S0ma=}mH&!F_=zVXo3rK~@=","SaveState_bk/2B/1":"ZNCA8elyYw/gvUevS6w6JZ-Ml+HVRZkW;J(]12mRvAFvGaq~AKO-koF$u:CGV3J+4e4i5v=","SaveState_bk/2C/1":"ZNCA8I3U3f07wr1/lv1GX&)lvLbbdFIt[Ek:2)cLnRkQ1gL9QP5nvjlUxPFMjT2d(t{!~N=","SaveState_bk/2D/1":"ZNCA8Dr5dVf{{CgHF=q&hz!Q0YxOh8tvw0c@Q|LjUDcNW5Wd~e~H2W7Z/@q7GWG-llOKo3=","SaveState_bk/2E/1":"ZNCA8mATdnMAtp{E!NPrU[]YK3Gj6hAFUl}4h|cz0JnV&L-m(MdD[]m@n&)ZoS/6V:B0Ne=","SaveState_bk/2F/1":"ZNCA8A--jqp-nHkYG~FSgH1oPdu5Eb4i&]eYXEcs07rzp94T(d2|VWXZgztJeYrw/0ZMGA=","SaveState_bk/30/1":"ZNCA88|a!~WOsn^c0gc(0=1^;)BTu0]ORftpxb$@E$nF~sk8AmS/{or9,xze;!$v~TW2mf=","SaveState_bk/31/1":"ZNCA8!ENs5z5ZUCCu4vz/x;Ctc!f{ugw$gVED4q@;,}g+*hi&~Hfsg]6U4aG{nr]|Japv+=","SaveState_bk/31/2":"ZNCA8gb_;d)AAPk)PW6U/W?@aXLckA]?68n9:==ZQgs1ph;QKd*^/kh1jla}DyH?=Ry_8^=","SaveState_bk/34/1":"ZNCA8Aj1khg-2/bW,eym414,TTcFhj9:G4P!_EHAXJx8tCHEEwwa6?AbYY!c=EKw}A+oov=","SaveState_bk/35/1":"ZNCA8*VX]smLX;X+r{9?9BQwkw;bl^r^]j}tRr15Bo,p2PEv7j&/kY3O!OEvC/^/d31w04=","SaveState_bk/36/1":"ZNCA8_JQ$32[Gukon!vtWPNghd9,9$q!sQdVefbWC=crGu(;!1G[GDc6k]Q+@T{g^,[NH,=","SaveState_bk/37/1":"ZNCA84!Atx1|bq(ATmgRz92-9X_Jz-mvx]:E(6uV[Cpfw401|M&i;^AFAH}AK*e~uW,m5R=","SaveState_bk/38/1":"ZNCA8AhPNUC;BM0*bS3pD~9+fdL*8$6-W5E_iT@HeO^p5Q/p$Ik+L!a@?d@{TmM|zP{z^p=","SaveState_bk/39/1":"ZNCA8QabAk1NgEcZgew3oLpuBtfi@)44@1P+KzLd)r5,1r@S[cY:};@38?lSPyW1WIMC[~=","SaveState_bk/3A/1":"ZNCA8lRD)Rhlu$ySxlh8CfQ1B_3N6_n8bYy+|pujUyize0Z&ePX],*BJtsJSTY_7|U$I&7=","SaveState_bk/3B/1":"ZNCA8kNofp(P!CR;i-^cT4W]hgMZWos]lL$i}NL?8wD4Pojm*v@jiyC+V@X}rN}!}KNe|U=","SaveState_bk/3C/1":"ZNCA8JZtd~WMxW2Acaf9?NWgZv$$zNK6&2CLn,FuPJE_R)K^@dHX[Sba*53-Pw~x(S*msw=","SaveState_bk/3D/1":"ZNCA8Ct|ypGa:hnmb{xq_P{fXFK*shXee4=5xiX;33]GMkb-tvgr()30:i^$sNgRFb|N?@=","SaveState_bk/3E/1":"ZNCA8JYVw7+9e_l/WO1:,}g|EXgw~kNR_wPxj]saV{^hTD40sp;}y&eFQD9MlIbLY1e,mI=","SaveState_bk/3F/1":"ZNCA8eD5DUFCr}jrxh+2:mD9}${Q+VoVX[S:^~LkXzOnONAp(=b7Mb}5sv~4/~,b)o~0Gp=","SaveState_bk/40/1":"ZNCA8jl}r$J4SmOo$oA{~eqR;xoY$/jXjieU9:^jV3=RisS[VtQOAz]+BGkpP|jac8W[L8=","SaveState_bk/41/1":"ZNCA8N=5oAXhnGeiU2pU96evWQ7KBEBtw?T/W]A6=$@j6T55jLl~P,Hlidh~uKRZZ7;@nY=","SaveState_bk/43/1":"ZNCA8)YKS+1eW}0c[!kT)j^l85p/}XM{^mXp,q:z:F-bT~+6k$FHlK-**vWZ74h*zmwu6O=","SaveState_bk/44/1":"ZNCA8$NQAkxm8oMB2I/J?)cUlPtuqN@RmQFL?M,|jUTS}f$?gLEx[6^(|K8|5P=xn1]*G8=","SaveState_bk/45/1":"ZNCA83f[i9F+pLc;I^hp?J}zij$UOcTL9+0Zz&_FRZOY,;6wj-G(49qai@3NpMV1EiuKj|=","SaveState_bk/46/1":"ZNCA830vRCxCS{d7-SRM=9?ogT+/GoRO=X{)Mt],{9JCZW?L|}_4/KOc9LU}$;;~y*/cC-=","SaveState_bk/47/1":"ZNCA8N*2J5,F$qe9Lmxi8v1rqCKvN^m7NTX$Oaj^6?O+z44Ue]IO]hJ;+HA:6eC~Esw,@j=","SaveState_bk/48/1":"ZNCA8[yy5osZoIe&*]hswdfS|eywPN=Y@^J{1*fSOm$NZ2Gr40x124thg~j~r3/!c~vQNq=","SaveState_bk/4A/1":"ZNCA8,--AnN;E)v1;]7]BRaKyFY8;lfxiTEO!$n:JkXVYlPbRixUseV:&U~;g@EXW7Y7Gf=","SaveState_bk/4B/1":"ZNCA8B8_0*qg*gl8jmg,KGgN|w^W4((=jsHO2_kmr)Cij26tz/NHzC=tP2D4:{q&E-pW,+=","SaveState_bk/4C/1":"ZNCA84-dj+W~N6BnZu+@paw81e3Z[cT3wv^!HJX~7A|$7pBaw,kQPRM_J00fRuzB4-*]jT=","SaveState_bk/4D/1":"ZNCA8U[?^bMQniqc}UEtu*_U_ezvp3KKv2cf1HAwtzqVWN]/wqzOlA/fl}xGy!rUHHIefL=","SaveState_bk/53/1":"ZNCA8u&J~[TKgRVDvvLLa[~n$9FBV:m?]Hc!c)s~DqB^tJ6&{)CfQAaa,3EY*_A1o6T:OB=","SaveState_bk/5A/1":"ZNCA8@8:LC_7jg;X]+R&s2X[&(ryy@vZSl_@F4^Yp9=ueSi_@&gx8]o2fn2Xmt}eYfBT*d=","SaveState_bk/5B/1":"ZNCA8eoF3k{@{+dF@t1oivF[0Oq5hO8B9w,xHNzPlJU7[z*JL]/r$@L*/wa&bq+U-Rt-u^=","SaveState_bk/5C/1":"ZNCA8~_][=QNDWt40gG,YF3k}Re+]x4/rYdv3/P;J31S}p4Tj5${kLKNk/@;fDv*CaAKtf=","SaveState_bk/5E/1":"ZNCA87o7]XWd3!K*qs)E0V,jJ;mF-0*:)ah!rYG==MUqtxih|A_x|xxufaEf1[};c(r&xc=","SaveState_bk/5F/1":"ZNCA8M9BxH_-[hRYmtTjFb4y4wa!aszxbwefrx5r1D&aLSL@Pt2|-Xu)NCvJMr|7Spdbte=","SaveState_bk/60/1":"ZNCA81A;i3k-twmxERs:x$dDNDXY!mzEY-iRU@9=Kp]2wv)]/i$Ny6~uikHfKQ^Foep^U5=","SaveState_bk/61/1":"ZNCA8Ys@)_Oy&,4C78p:]ATbTa!(5PF@n$(Hk;L]ZGsyB@6&n)du*yxNeKsl@[!dZg4PU{=","SaveState_bk/62/1":"ZNCA8O9BX?=2(TFZ=xLRi]n(TrAE=5FISrLhje]c-1C03++Hrp?l74suoeA5y}[XYR)k9b=","SaveState_bk/63/1":"ZNCA8ftLpiZ(D~s;K+!,~^u(iEyDtaBY+L}VEKIkV|Faj53AwAw5}eS8|UO{7,_1[lK{3g=","SaveState_bk/64/1":"ZNCA8Lk=TF]=lY+4eI(S1o9cx{AatHB:ff?Wbb2ZD8Y/J}AmJeD[0!J713+N9ZMz}~SOdm=","SaveState_bk/65/1":"ZNCA8*+;3t+N,gGWQXDZ+_*y@,G&:wnrJI,g/R0;WWzG{:oTvSGC4*3apDVr,B80QqVp+S=","SaveState_bk/66/1":"ZNCA8VJZj-lJg()TXGiv;~WF!t//]GuDhLbr)13{dIUxPEMQv4jL}B/Q+Yy^3fcrCYtjV==","SaveState_bk/67/1":"ZNCA8{6pNlDAOweLcI,EZAC2Wst8D^&IbQ51&Nfhk=@r~]H2S)a^p)lDysW~Po7mX]jL,H=","SaveState_bk/68/1":"ZNCA8DI&OE2@Zp5!m!9-QP!klhW9nN5)6se;]c]tt:$t8Wg|=HO+?]fl-&CZk7q3fdfYVz=","SaveState_bk/69/1":"ZNCA8Dc*rzQt,Is&M_m$N?3Lhf1!c~uWaUXYhr9/fYj3HDvX)|ww:7dm!4GRh]]i(E+Tg==","SaveState_bk/6A/1":"ZNCA8_75GKPc-_fX]Tc7)R?B=n&9v^ismkIqP}[obr&;L[Lkb}+$ZTlv(b2Yz4J83456v,=","SaveState_bk/6B/1":"ZNCA8MK[LMJNq*Tt8*djO+s/h5Mm)O(gh3I@yy;VdQh0:=H7,sf}q~j)zFrDwo&L7m[mX9=","SaveState_bk/6B/2":"ZNCA8{A*:5U-1a77^0wrot*@Mgda}[eD;9?t5SHIEV9NjkcQa_5f^3sw}96&HGA6X6RNT4=","SaveState_bk/6C/1":"ZNCA8lyKn97N(AN,*xaBi@d-GchE{S+?FI^jAMEMap/dYU-0&KV=TSy)VmJ61Ets;I(}w^=","SaveState_bk/6D/1":"ZNCA8eQD,meMuSthjEwxAp-f=J_Cj(Mms$v;Jahnoua8]8pIVSfZ=N|z0zeF)J07g[*OfD=","SaveState_bk/6E/1":"ZNCA8Y/W^ZwLyIWm=p)?YKb@)5w3pO-~S5gV(826rIzyl1D~u1PSZN|Nt;F@g:Jql8C9oR=","SaveState_bk/6F/1":"ZNCA8Ur8J&e;JYT1v5ufKi(JAl~V;OiF,g8FfDumPw0Cx]}q}&D*T*{bPA+Z{sfqoK/n}j=","SaveState_bk/6F/2":"ZNCA8MKtsa9b?e(}JZVr9W42$9E][7~TFCeHBwyx@*JAEUX@OG]:xTF6sX&5o85/cem,_T=","SaveState_bk/70/1":"ZNCA8DDmnGh^s;@oDedA6l6O^h!M/a,;u6caRzz+i?W=wr/,,f~;@_Hd7m1DWD~m?5Tacu=","SaveState_bk/71/1":"ZNCA8YO!PNawmWRxMU1y=~;4R?)_-*]3$a+Qci1YYs2ud_aPv)_jct4SjEKuNBe4Pi?UT~=","SaveState_bk/72/1":"ZNCA8m[7S+hYJ2?K/2o4-Jil){C8B55ZK:puX]s]C8bS|GD?$$ITKU,XpHA}d:@RM~J@Rb=","SaveState_bk/74/1":"ZNCA8t~S9I&5~1~/I@]5*XWgeL-iy+=gpa-XGL}dl~P-xutl$^EpB|+Pa5W$9*fAZ{]r5t=","SaveState_bk/75/1":"ZNCA8M/0o|-KMN-N,R;@/=pHSFc5S5J,oO{C4zjL(]R(MvFDivw5@QAz3,]h,QS3Ivkr$i=","SaveState_bk/75/2":"ZNCA8cn=js_WI(_g}FT[]{f4@3ImC2ll8wQTc4jZ(K:(9*s,zX5nM9(XSM)/UD!g*uz[gX=","SaveState_bk/76/1":"ZNCA8?d:up+@rxHlE}pWf)4aSO|aco(!frmlUW8^;3YI*nh=dZD~QdZX!69+mKg@FyFY|q=","SaveState_bk/77/1":"ZNCA811jUl@i|MkkQ84WWVk?BQ_~IDkfzk!X8,PflOuuvy;FK)vlmE1TGk[hNz:5z@P~O0=","SaveState_bk/78/1":"ZNCA8DoFwiFfbqhUZe[vU-Dl3wJ{4eG*Qv*~Z$63_/:E-T$8EVLt}t[*hkCx$warxUX!Wk=","SaveState_bk/78/2":"ZNCA8lz17axSuouAU&!uzJD{Xsb-+EK_yqExrcrMlgBjxE:cV~9Bvk6/vUuaOW0c|?0CMb=","SaveState_bk/79/1":"ZNCA8i7:)CkluiS,cT:zE1T7WjQuu8tE?GToE4}xhK&wV=t_*D[TW{Tq}B2ik}D$K6z_^X=","SaveState_bk/7A/1":"ZNCA8_I5-A*-B-1ZF}=m01?a]p-812/7?0Z8M{K$xTo*&QSS9?G)A2I!G9Xb+u4NBtDS)i=","SaveState_bk/7F/1":"ZNCA8T*tMVW75S8$QilHR1kp$ZBm,uR|h5{NML_e-15J=fiB81$:|^&ceFhHgG0cuM7z{W=","SaveState_bk/7F/2":"ZNCA8(2=]Z-SNp|ImFrhu]BVqG^fcmJ_bytWOsn^b/!kc7E+8KO9l?[W@,Rt?zF3Rh9cje=","SaveState_bk/7F/3":"ZNCA8=t-*_S+aZ*:/LCA1qI)1*bM7zMQxt8jGsjTvn^wBx|5@]axE{fC-Kv?cJ4Sc(PyuL=","SaveState_bk/80/1":"ZNCA8qWA&{/wQfNtxYR?:63=QaAPR(7tfUyx6FT-G]-D;EHQ9zmkwuvvJ=HPkR1xLFg?&)=","SaveState_bk/8B/1":"ZNCA8_d6Q~B6sf;oPFGXrg|6n6Y464S&P,040l{_4ZqYOuhNGGt?0D^JJVtR9VEw$G0Pkv=","SaveState_bk/8C/1":"ZNCA8(O@U?P,&bpLen8,]w)t(M0^|Qanq?u8sAzYAmc_=xo4I6eZXz(hVhsG(xc2]1XpUO=","SaveState_bk/8D/1":"ZNCA8a,9@O-j=PWTiaQHum!r]2RHK*DopC@5lvMiF2*!Um5{V2=&3OCRCXx=wKx)pt&?]{=","SaveState_bk/8E/1":"ZNCA83Hs8QAb:uPY,eO3arKmdh3khPKG=yX$9::QW]qbis$|tQirSU?WuO|~~Fi6V!&{~v=","SaveState_bk/8E/2":"ZNCA8drS3pNNhcU@4M/}/z+]XAnXi_[$zk+kgRO$VX,&r3:DZ+a*Ab+wC=JwCL}O/oZ=^N=","SaveState_bk/8F/1":"ZNCA8$Dh?Ks1tgdEW@br]Yv(w4n[F=C7_b_C{ahgppIbyJMt,BZxD3q!v[)en(//9NnT!K=","SaveState_bk/90/1":"ZNCA8VK6l*vX;0N{K-k/EE2skbfC]3?6[HNZz&_FP6w-9XDP=^B6Ob/1|,*AI/L-2Csv4Y=","SaveState_bk/92/1":"ZNCA8cZ12NQm1gUHLuBkW^782T}jQcRW2])g:]Iv1D&aLiG7GTz!sk&G{9r+G9&eFJ=yql=","SaveState_bk/93/1":"ZNCA8PD}_&Lb:D66d;ew;D3ybH{hr)4FSlNl;lTqu*1K-T2uF7W?/gY]B9:C5[?a8PO1,4=","SaveState_bk/93/2":"ZNCA87w8ROOrvyxSrA-8[$uy,MmbuB&e}fiJokO^Zm-r-0~-k6l{xb$a6]]UCr:yJesL$c=","SaveState_oot3d/bdan/1":"ZNCA8*8vC!B@yO;Sr3}CbX&Aj6/yz[48^4hztVsKuXE]D]ayVd;Ev|AQhe0uV&}Gx,@eio=","SaveState_oot3d/bdan_dd/1":"ZNCA8*8vC!B@yO;Sr3}CbX&Aj6/yz[48^4hztVsKuXE]D]ayVd;Ev|AQhe0uV&}Gx,@eio=","SaveState_oot3d/bdan_boss/1":"ZNCA8xQ(P+vBP},c49ip*oX;yg95bA[c~2xzQ]=A!|s/BKi9}PONH92px|MQj]d=X~bcxO=","SaveState_oot3d/bmori1/1":"ZNCA8l(1+bi-RaS/:biE-kp-@+N@R+H_p:&G9h$LaL+}N?rw1Vwk*$v:6{@ezjZzVtjSJ_=","SaveState_oot3d/bmori1_dd/1":"ZNCA8l(1+bi-RaS/:biE-kp-@+N@R+H_p:&G9h$LaL+}N?rw1Vwk*$v:6{@ezjZzVtjSJ_=","SaveState_oot3d/bowling/1":"ZNCA8o?a2uG;h?5[V{kHz2+dPU^:5}G6LfZv;+,Ukft;Nb!90)hF!(0@(f:2[bz(3eL]be=","SaveState_oot3d/daiyousei_izumi/1":"ZNCA8tOpDV-MG3@mHXX6Ni(rjEl:D^hLtvRUEF7Dsq1^=rlmIpg|hKd=B@am[@ps47TBVv=","SaveState_oot3d/ddan/1":"ZNCA8+zhp9HxE,9[^x$M-[T=xi3cZ(vs3,!K0{=9?qtP~O-p5?Nt~aa/rR|xqa+uPlqIAC=","SaveState_oot3d/ddan_dd/1":"ZNCA8+zhp9HxE,9[^x$M-[T=xi3cZ(vs3,!K0{=9?qtP~O-p5?Nt~aa/rR|xqa+uPlqIAC=","SaveState_oot3d/ddan_boss/1":"ZNCA8zkJII$4cGh66$VMcS{V3P^9taC9M~-0w)P]PTD;JJcpZxb@P2&Kj1nt-4,U{yWMw5=","SaveState_oot3d/entra_day/1":"ZNCA8VlbWwRYvS^l$H+pS9}f?6]yI@(9EX;Otl4TVNXu$-sh(JANyqixIw9Ei&Mk|FDC&G=","SaveState_oot3d/entra_night/1":"ZNCA82N+zrlTI4zEB(V3Oy-0,*zmCcWK}[PK8z3r=PJ1zvYjyo&lOsHVf(mLyEfZ;Muq(j=","SaveState_oot3d/entra_ruins/1":"ZNCA84SS|^lJygT8DsAw&_lDZ6qcf-PL&x4D/h5YE~yKm,,oB!XChPq,SRSvg@ru:+1UR9=","SaveState_oot3d/fire_bs/1":"ZNCA8MGX}WTTcXmML1zH$&n!^2gpXKlzb3gjrV6(z!]Y|T59UiH9}4VfSlR,a5w$U/N=A(=","SaveState_oot3d/ganon/1":"ZNCA8EgO1uRXk(]T6mEd[/N*zqfxQ&-8F$MP^;8MYIiLED~z5I}RkfA/h7?Uj[Xb(+!kC[=","SaveState_oot3d/ganon_boss/1":"ZNCA8@b|sJ=AYBDWo?mQsKy5CcCO9uh!8PZoqK:8u*bX3U;:c;,0(Gd~G^0Abb!U+R{KM)=","SaveState_oot3d/ganon_demo/1":"ZNCA8J9U[7&8Yf}f-io1cSu[TXx9NahcXNE(x?MpyF+q!R6fv)0DnfK02A-M!EoY)Ts}1K=","SaveState_oot3d/ganon_final/1":"ZNCA8I=3S1f*iJxpoI3{1o&ulc@Iemm3K@1):PG;{h,(Y2?vje4[3{5KFOMZNH-r-!tE&&=","SaveState_oot3d/ganon_sonogo/1":"ZNCA8I1rSj!RJbv/2TYnKx09jqQ!aW33c9,bSrZKRZOY,Ld@uQ(-t:&A]w2LH^V61~qF^s=","SaveState_oot3d/ganon_tou/1":"ZNCA8q|tTU@v8!)gD!dA15DnzEk:IY?6b?)2A6,VpwoYV_dK]DeT$fwebIjawuE?CA+EL^=","SaveState_oot3d/ganontika/1":"ZNCA8-l~Na:vC2JXN-x[;*q13nDu0E11CPM&Zv9lxI,P[Qm49&{YP^@f7PWL]k@kE7E4/Q=","SaveState_oot3d/ganontika_dd/1":"ZNCA8-l~Na:vC2JXN-x[;*q13nDu0E11CPM&Zv9lxI,P[Qm49&{YP^@f7PWL]k@kE7E4/Q=","SaveState_oot3d/ganontikasonogo/1":"ZNCA84v}Xp@+878M3+4h&VOutIEq+ZtYC9p3lCBwz:MM$7rJsNqh5ov96SoVWlaQu+fL@u=","SaveState_oot3d/gerudoway/1":"ZNCA8hofK3wH3xPbKwgC*!{=MeChCp,t9$WF3MM3Mw[}_2yLDy;oMo=o[iCyT:rx8KDk~m=","SaveState_oot3d/hairal_niwa/1":"ZNCA83MCpW&3+oBFtJZ}8_SE-H*r|8$SsDwfL!g(diIa&qfiwF]8334Ix=Iq[rRU7VW75{=","SaveState_oot3d/hairal_niwa_n/1":"ZNCA8VTfJ?vPXdd4W6|smCz4qKs:vYB|cNdp6h?[c]fZZX0b!(_qjMjf9VYxr@G&bcTXG0=","SaveState_oot3d/hakaana_ouke/1":"ZNCA8(=/lo/}4]5w4i!9DeYMShUNDLLe|0P!9a!6z!nO3peJkwSPWu+7Dnl0xl96~ZfE}r=","SaveState_oot3d/hakadan/1":"ZNCA8=!8^L+]0CNiW&(|20-VM*B/Kep8Ya}zlL)NmeYR1j2ID!JauCMC(=T)!U(SH1t}w:=","SaveState_oot3d/hakadan_dd/1":"ZNCA8=!8^L+]0CNiW&(|20-VM*B/Kep8Ya}zlL)NmeYR1j2ID!JauCMC(=T)!U(SH1t}w:=","SaveState_oot3d/hakadan_boss/1":"ZNCA8;$HKIgZfr$4fU|*S@tG?yyk]nhFbY;W[t)hrOQC^oWD6}fItv[ZAc4iv1t8+{P4BT=","SaveState_oot3d/hakadan_ch/1":"ZNCA8GAlp]sU2}Plq]^h*-?_!6TU[2]D1^=82ntl+MO(-pd{!h(H3YfYE](!jKM!3{3oNe=","SaveState_oot3d/hakadan_ch_dd/1":"ZNCA8GAlp]sU2}Plq]^h*-?_!6TU[2]D1^=82ntl+MO(-pd{!h(H3YfYE](!jKM!3{3oNe=","SaveState_oot3d/hakasitarelay/1":"ZNCA8t&hu:CX7cjy/hW3sun,kE^pno!FHhxK@Qn*ksq3B&4/l*tSC5ZKHpS+JYo?|l@j:i=","SaveState_oot3d/hakasitarelay/2":"ZNCA8*:d:92VO$ea6P!|G5W,Dz{hCCc=|SNz5jfh$*w[KBo=Qz:ZHG5S-eBJIiX{5IBiw&=","SaveState_oot3d/hidan/1":"ZNCA8VWkxdj8}b?l4B{yhHQlZCHN6=hx/fi4/W78yqX*bXAPePq)$+Pw7,5*jfr7vqWYr9=","SaveState_oot3d/hidan_dd/1":"ZNCA8VWkxdj8}b?l4B{yhHQlZCHN6=hx/fi4/W78yqX*bXAPePq)$+Pw7,5*jfr7vqWYr9=","SaveState_oot3d/hut/1":"ZNCA8h?u05~_GZ5Q/ZFmVij(Pp]r$GB]X+2p6h?[U/h3A+O4eAen$02VPzTrrbUl??[74[=","SaveState_oot3d/hylia_labo/1":"ZNCA8(;t-h&4nQq{*|2:*6V3&5z[i{OL5^=oOFKy-qdsLQ~kD(J$yGKApL:WG1dW;tqFz4=","SaveState_oot3d/ice_doukutu/1":"ZNCA8!T!22XfMhDP7k1i@hr=KJw33Z(K1b94RT0!rnbTVv/B4lE|;5Tr)x{Rd/0sz3T$FR=","SaveState_oot3d/ice_doukutu_dd/1":"ZNCA8!T!22XfMhDP7k1i@hr=KJw33Z(K1b94RT0!rnbTVv/B4lE|;5Tr)x{Rd/0sz3T$FR=","SaveState_oot3d/jyasinzou/1":"ZNCA8@~B[dQH;K+NhgGV?iEOjM2u?o@}:e79ok2YO_)IkD3z+|mj@i&]!Dh20Wv]5LjqI-=","SaveState_oot3d/jyasinzou_dd/1":"ZNCA8@~B[dQH;K+NhgGV?iEOjM2u?o@}:e79ok2YO_)IkD3z+|mj@i&]!Dh20Wv]5LjqI-=","SaveState_oot3d/jyasinzou_boss/1":"ZNCA8DoiQ$tAxb_*br4;@1e:X{MCCL-CdqxJ4Ak6;z4T8+$rfs*Vl?u6@]**e7C]yy6hB}=","SaveState_oot3d/kakariko/1":"ZNCA8o&*6/Fk^RdJ&iXG!@sJZQE542HQy6lwLyIWRMR;EF1fXyHF~!D_J2ioA&zc)ec4~4=","SaveState_oot3d/kakariko_impa/1":"ZNCA8j8w?/@[I&Uf^bN3LRnM8!z,079}Jhj-fHdcPV9p8@e44,cq|{hk^3d1y8?ZF/tA{)=","SaveState_oot3d/kakusiana/1":"ZNCA8+f?p!{?AZ2MItQ1)]kQ3pui]FzO[EbGktXd/99CgY6zjA=mL5iOT@5S8*gH-UA?4K=","SaveState_oot3d/kinsuta/1":"ZNCA8D/wIP,5lZ(m;dE6W?*MBogRpUJ/UY8/&qS8-ur18/Qgp)FX:u&*8L]ywybpl,$7^==","SaveState_oot3d/kokiri/1":"ZNCA8LcKK2t&F1j6M}agVbu^Xf/M*[:^rr+m[A)W1fSv[/1zxr0RQqK)7B6EBrt4iYFUf!=","SaveState_oot3d/labo/1":"ZNCA8ZJE&1=Y0+(tb??=5hmFpWX-Bs2Y2Z(VNQSnfXc-H=k&2$jyL;6=0q&f)^m9lAxM!|=","SaveState_oot3d/link/1":"ZNCA8k$$De6NFx6Xs^s]9PBZmc8([Si,B/fPqh|WU/{l!IP(/8$LUJQ{Usm*E@&]Xa34HT=","SaveState_oot3d/mahouya/1":"ZNCA8;9AIjpHXP{yA_gScevUBWoxViX~edY/5]UvoS^z[v@QIJkD}dw3ipYjpjK0BhKkVz=","SaveState_oot3d/market_alley/1":"ZNCA8I:I,GA^MJ}k*jKrkN/=*,+HFDqhR&-VHJS;wY~Hly|qr4wNOa~*0~QcS]S@kt55vV=","SaveState_oot3d/market_alley/2":"ZNCA8!Ic+z)-HlIXP]@e59$}1k^BR9YG$2yECzuA/WSZqzyECn1Ac?]i2/~+h}bGDZbZTb=","SaveState_oot3d/market_alley_n/1":"ZNCA8$$Wu0?:i[nk?+asp08R-cwzPh:84$etw5~Y?zoMLRjEY+t?yD~1/YrrOQ!W-Rj[~q=","SaveState_oot3d/market_alley_n/2":"ZNCA8l^rHJJ3$sTm}:MjK-b[ounqi2RkSyA[{Ke@{3~Wlgx:d5hxPt?L&9Y!CWd))9yFdO=","SaveState_oot3d/market_day/1":"ZNCA8wKVbzGM/:oL8-4+&Bz!|:1[9W]YpiVP[[,/JI{K_(:fZZnsovJ-_vd4g20N845IGB=","SaveState_oot3d/market_night/1":"ZNCA8I}Mz8$;h/ohkGFZtRV!{Y75m9vC03ARnma!LeP][B2,L6+^0VQD5iWFdgfRGu!xMi=","SaveState_oot3d/market_ruins/1":"ZNCA8SIF}Y(F]ilIS1$B]Dtivx^[{xG*fJXJSu,0,-nsQn8|6CC-K-i~f+}&DjZ,@M425t=","SaveState_oot3d/men/1":"ZNCA8$*dY-!s5R}tt@oz([Z5n1zrFp&O!e^&}TR4XV{y:QthDzg;dM3-GU)_*[!B=-ClR]=","SaveState_oot3d/men_dd/1":"ZNCA8$*dY-!s5R}tt@oz([Z5n1zrFp&O!e^&}TR4XV{y:QthDzg;dM3-GU)_*[!B=-ClR]=","SaveState_oot3d/miharigoya/1":"ZNCA8R7!S8M;JJB!,|FkVh&r-?Rd}=jd6RUUio!iVBI^gQTg]+jvub|/9L/u:eytTfHrak=","SaveState_oot3d/mizusin/1":"ZNCA8ComcdL)4nW0JtrpTCywwgLL-_Px@8PA3J3QiP$L/wOvXE79{xt2L4?unYk{n@vL53=","SaveState_oot3d/mizusin_dd/1":"ZNCA8ComcdL)4nW0JtrpTCywwgLL-_Px@8PA3J3QiP$L/wOvXE79{xt2L4?unYk{n@vL53=","SaveState_oot3d/mizusin_boss/1":"ZNCA8cKRR9jszhA:4p)3Imt0-[9dx][7ME@s5W^;C8bS|F8gYqqOwYXo/^Z/m7yS+*pM$X=","SaveState_oot3d/moriboss/1":"ZNCA8nve[5+cR5=XR:b36uwX7aM-U]kj/A),W-SF&=5~UaiOmT/DcKD-~?fD&2NmBx/Awm=","SaveState_oot3d/nakaniwa/1":"ZNCA8q4,_f&(_lK_)b&Wi86uB[Ki?Uz@2WXaN4LdbF!n$OLjl}_!*N+?{1p=3J_WcN?yQZ=","SaveState_oot3d/nakaniwa/2":"ZNCA8/l?_90;R$}y7),KV0-j3Y)l|8&u4v@J0ydfx6Q&IXnsEh5a3N0vd5,]t8&9wF9E=G=","SaveState_oot3d/shop/1":"ZNCA8C^JwyywZRHTH6?gb:]Rlr@r~J]Sadi:AZKJt{Kj@uI8*gj4te3[DA8,aZP;18:~TU=","SaveState_oot3d/shop_alley/1":"ZNCA8Zj=:}z-nDOe8a@V_cD_hEX4gb*tMo:J0ydfx6Q!yHTkaun2v3PAojp$fpmER-],XZ=","SaveState_oot3d/shop_drag/1":"ZNCA82d_+KmUMps9[tI69i0hOA[(b~R*+r]twDeRCf__aujP*m:F$g+dPl*ApFDl{[_!+F=","SaveState_oot3d/shop_face/1":"ZNCA87mndAJ:=YA-F?Z+K*eGY~zY/-4x:|hRYHLQNOvs3sB![(c4*w@@--PYKD|edWG=Tp=","SaveState_oot3d/shop_golon/1":"ZNCA8ngR7}O]-?p9F$,XZO@{gBQ!-(lFPYolUjiR5]6FsQ8k7L&zFdMkFNm0rJZ?Ly,2|C=","SaveState_oot3d/shop_night/1":"ZNCA8@[I|g;(5EA-n-qv*A3aN[(D&I)FN8e_z?0Ej&[RUzMZfHE{oni86[-?3;h[Dp]Uj,=","SaveState_oot3d/shrine/1":"ZNCA8TD}Aei@}O|):=ndOdLpoqQK5,Eo*B9nRI;v:F$g+-HlG$r,N:/YTlv21-sx]UR=e1=","SaveState_oot3d/shrine_n/1":"ZNCA8zO$Dmba6r{EI-3Ph?H;Q?,f,_6x?(Ej/w:)yzx!l6Zw3QKsZnV6av;GR&q+~AZw,E=","SaveState_oot3d/shrine_r/1":"ZNCA8~Lc==XqPMjBBP+x*JED3c1y@iqKH9S,~()j6pOQ=P0T)@o&{Y&gZ(@HvWO)Jo=&XA=","SaveState_oot3d/souko/1":"ZNCA8KxGjNEadcny8sHBW;rJFbUpWlRTq07I9Gv&a6KKGNq(kRl-66+Q5],9U:P3]6Ep*;=","SaveState_oot3d/spot00/1":"ZNCA8BEOysHfbLL4-|-KIdw=:Nq@j&X5?mW6k]T_u{_,Q$Cs5lzV]Ok(^4T;nsFTg_2k-S=","SaveState_oot3d/spot01/1":"ZNCA8DWRbY)HBR/$),1;BmQuK=nPvo~s/?WedvDyj3N[|@8@5m::jGcjA}-IGtH&)o_xEy=","SaveState_oot3d/spot02/1":"ZNCA8/$|MQaaywgs)enMeS4g=jI+WN(;PQo1B8fG3Z0BncCn}kSc9A$Tb*anr4O]*JP0o$=","SaveState_oot3d/spot03/1":"ZNCA8r==k-y8ySEh@4ur&}}9V$Xtg[$,q7Z~8:!s+4avhn:orW7e9DaObr66DK:nL7[sbN=","SaveState_oot3d/spot04/1":"ZNCA847)cPC7|$H:+;-h1|2P,v;y2_b!HqW5KUDhAq[QEzhc2]06HMO3sn+29oqt=DsK?o=","SaveState_oot3d/spot05/1":"ZNCA8u&m4kqcDK$x/LK=Tm5h/2:L~K7!@F}A26-X{x3N:1tnM@as6=yhNog}s$x}^J@jCU=","SaveState_oot3d/spot06/1":"ZNCA8U={Vg7Q*uODEkNiU(76)pf!tV[H2ZbDS4qYjM[m]Z&9+FX;iRs]eyg9M4n1|)L([w=","SaveState_oot3d/spot07/1":"ZNCA8+yJVnRE-l_O+5tG383rlE6Z=}9}F5RSVDmTigzskkne_Cj[bv~kqaDuTUloThL,th=","SaveState_oot3d/spot08/1":"ZNCA8L!T{f1Q^x)jRu~n4~r@B1ds]+ZdavrK]dA!0K[JDsunT;zG*K$S?LN!TOPA&4{WDo=","SaveState_oot3d/spot09/1":"ZNCA80il@MFW;Rj(~P2q1=T$*wFGpAf8sF,;[,@){:dmkVPf2HKC_nPfXL5kLIEOygxUFq=","SaveState_oot3d/spot10/1":"ZNCA8FyO6qKPq2qQ[rNhDNUUKw:o=6Qkzror)*o]@CWxPku0S8R5z1;xBZZS*dT;?J:P@c=","SaveState_oot3d/spot11/1":"ZNCA8Cey,VEN|Nm/:0gbOAS-)T{pMI4rE}MKURSO~qYuI2FOz-lq;84m-vA=7IN+RzmV;S=","SaveState_oot3d/spot12/1":"ZNCA8wrj$:[9v{iBN:Q[K)z:Y9b?4xd,T@9[?i[,~D|J@Cfr+G_LfA4A13y|A/Ll1;+kWJ=","SaveState_oot3d/spot13/1":"ZNCA806,wBx/YG6SJ[C~YTZx6d*]+{+q1{-&AW!1ZP@T]BqaU:GXP2J-d^X(mErXOOO}uZ=","SaveState_oot3d/spot13/2":"ZNCA8;QzDbDP-YRNGO,r!6P}h@|Ft1DQ@WHR/8TFYTDQUt(r)j:tik9iusv=X@re&Y&ysl=","SaveState_oot3d/spot13/3":"ZNCA8g8kB;pfpwimb**Y2{bj@66P~4PrIvhe4@Mzr6LrXP]j2W2_[V7~6~wJkPuV_&OaIf=","SaveState_oot3d/spot15/1":"ZNCA8j4?]y5M6|_dgjA:nKT-J4n))e6mm3wN,_|g9+;PMSl(P4Y0$E_b{S*Eo9uv~9:-Cn=","SaveState_oot3d/spot15/2":"ZNCA8c?{w5nl^9SV_@&Bc3_WxZ1R50qT;/u@kG:sk++{_Wr;5umD5eLU]2WBPgp8zAq{3V=","SaveState_oot3d/spot16/1":"ZNCA8x}=$7mHBV$K^uWBuamrhca[TAJ$QYU8+$WjbW2Y18Xu$D{CJHP__L~,o3U!{B6lpI=","SaveState_oot3d/spot17/1":"ZNCA8eZk6g$(2F(zZSlLECmGt;**KOxMn2YDT8!}Z-$Ljj&$v,-Tswspq}dgG~NCpauBkH=","SaveState_oot3d/spot18/1":"ZNCA81INBCU!}OUc/)nKk-P|1ub4~WHcc8/yApT9xCw*:klIiN5_pJLiiS7p=CHe{ib/8_=","SaveState_oot3d/spot20/1":"ZNCA8i+Ls}+S84:,kJ1rq_W(6NepEMvJI9{-)[?_Qe@^Jnr;$cY9nhIvK~Gh&4r8r9HKv[=","SaveState_oot3d/spot99/1":"ZNCA8SajwKi|8H3:8V8~F?D$oB42_gGhJ!W;)R-PrFVn_Oz[lNH&K0h98Bvw7}Ac+$HGd/=","SaveState_oot3d/stable/1":"ZNCA8$5yd10s5}j(O-x^rV!]j12FZ3CQ1AyszHDOA_PUV?x8iopFDGcdQt:c_l42m~^BDS=","SaveState_oot3d/syatekijyou/1":"ZNCA8,[l*yOGr3te51X@*1[iMqfH92thFTasKbB5HHGf@y!3MGp-lfeTra8Vt_*hwXI+Go=","SaveState_oot3d/takaraya/1":"ZNCA8N,accO)C=QF1aF~(Lsa0m;^RwlI=gN*j=];-6N3kb*cS{s?_*P3,X05$wF!+2v1E]=","SaveState_oot3d/takaraya/2":"ZNCA8fo_rS/dTajrgs~u1ymWM2|rSKEp]vcm~|i|7zHdMTp8&+$f53MbDRr8h@X41R0+f~=","SaveState_oot3d/tent/1":"ZNCA8_|8qzZ?c[X{_-LnMFD^,6k]tiX-~CCz5+/r_PIB$A,/-}H&,rlro{2D1IAV5[~~b/=","SaveState_oot3d/tokinoma/1":"ZNCA8kfsO_p0skC(H6~A?b10X0&~FAXTAJ2vpj5Tu3=SDnP$iy(_@ez6l5,?c6oA]K+jq4=","SaveState_oot3d/turibori/1":"ZNCA8o+yzq_0oXfE6QS96CbdmsLmRNJ)]9*@Oj-UyFv3{T@p66mfqC_nf_=vrk9hmwmL-z=","SaveState_oot3d/turibori/2":"ZNCA8;vzNWt9&u+P,jNn@1jq~178(7UPsb2(LI}gfl1dfIunTmU$,*!+wY,t*oK;Zaww^/=","SaveState_oot3d/ydan/1":"ZNCA8y:*&(3VB3!C64OK)HY&7cH+f{Jc2YOv|MY~L$[|v5yyNcB=xLqs_[vB*jku+J+6UX=","SaveState_oot3d/ydan_dd/1":"ZNCA8y:*&(3VB3!C64OK)HY&7cH+f{Jc2YOv|MY~L$[|v5yyNcB=xLqs_[vB*jku+J+6UX=","SaveState_oot3d/ydan_boss/1":"ZNCA8{SApAoS{g;B{YCN;|1+A=3^5oMfjQX~hx~rqM&U(Q[k=d3qH$KB-6C45&,Cx$*jg8=","SaveState_oot3d/yousei_izumi_tate/1":"ZNCA8i8LgnLu/QoK:Nrdp:Ft(Gj~|[fti9~4;Cbqb=*upw~T~N_1,-[)N65+;^lS-7yeeJ=","SaveState_oot3d/yousei_izumi_yoko/1":"ZNCA8lfWzr)Mt],}P{Ji=l_qDO(6/2)i{0@OALSkr)Cg&m&quT{9JD;DLc:A{y*(+Qb:4x=","SaveState_mkdd/BabyLuigi.arc/1":"ZNCA8USu:(Oz[76zy!HrWgB,/DkP/]K7|;Z+KzLd*:{R5rm;D5!Yz/TwxtIDh/cR+]j@j$=","SaveState_mkdd/BabyLuigi.arc/2":"ZNCA8?8T0nso|J}DlTmRFLh7rUXYM|Zp&iEXGL}dm,MG0E{+7gNBd|{ChyRHflI*2x(BwF=","SaveState_mkdd/BabyLuigi.arc/3":"ZNCA8sqZ9p0[erul@w92$&duv*Zm7~K(hz]SZ8$QG9VX*+d|MZzbRb9]!a6@f5~V0,KzK1=","SaveState_mkdd/Daisy.arc/1":"ZNCA8,o$4b&!~S8Xt~3OuoU:1Q1]9km1SfN{fIyp=vzjyB1(q0W7q^sa;[Lh{HPrlwT4~f=","SaveState_mkdd/Daisy.arc/2":"ZNCA82J@Mock!@@mAk9yzC2koB{PJ~cW//j;c*f0?0s{}wJ3c2QsOazY/w*Xp7uPO:ud~A=","SaveState_mkdd/Daisy.arc/3":"ZNCA8qOE)qB-?5SlIoOzs99poUPWIBPO9Le{D,po=UYaxvn:4psq?pFcr2zeJh4WzQwy~6=","SaveState_mkdd/Daisy.arc/4":"ZNCA8SfGRp2cTP~/,Ze3f54=os!;7xZTKB_5Svvaqxy&k[YZ4d-_LHMaLbJTl5322:ztsZ=","SaveState_mkdd/Daisy.arc/5":"ZNCA8e3yr3STpSap1~-2wC)qsGG4yAOrU$D[dfFOxlpYCGw{jH3DrU6V(wQCnO;Jw](;]1=","SaveState_mkdd/Daisy.arc/6":"ZNCA8S!,&l1PN}WcIpTKvzvc/G^nICwx?Xv?Xu;L0a:iDu-CspOVoh:)LJ-tXseTdQouL[=","SaveState_mkdd/Daisy.arc/7":"ZNCA8uwH},G?0lBdwQ7ay^2?*,:2T]k]w=dW*^k{P]3qZpF5c)gfujP$0to_]~hzd*fv}S=","SaveState_mkdd/Daisy.arc/8":"ZNCA82}BRrnp/*tN4IK(2dxUD4ewJa?dpSm@yy;ViBPQnj8QhBuP/kE4[rXnEwMiVaTy*C=","SaveState_mkdd/Daisy.arc/9":"ZNCA8pr!0qDPTzfX&=c7F9jEyV4}1OH4Q{M?[**ggcijBXwy+3=ZB;+PdA0,gf-=_yly}X=","SaveState_mkdd/Desert.arc/1":"ZNCA8A)=DgeqVO$8+~fz1;0{sfzY?1ejT)V&*Q)nwnL}/]^AqXcJ~&f;o&3@~+qOk+ZZIJ=","SaveState_mkdd/Desert.arc/2":"ZNCA8=F)c2tF@:[M_0w_WFEGFKg^eSUVYZ?k-twm$;T$?k,tV@SINf0=ch0mzQI@}DI]PP=","SaveState_mkdd/Desert.arc/3":"ZNCA8nsY=|DkF}AL{a3Zr-Mr{3((jM2}T;j*XfRY~@W2zt(r)l1$/~=Fw$Nbi!cE9hwDZN=","SaveState_mkdd/Diddy.arc/1":"ZNCA8~k~m~EpT9Ka|:eLRC[;HmxW4lkyIb~_;gS-F0GTAzquU=]4[0h_M:FdYpQGk[?D;D=","SaveState_mkdd/Diddy.arc/2":"ZNCA8ooUAli,:J7&Om^vZU&0HD6svZW58d68oXT&xu;E(m}I}Ud|Tc}KKAtgbK/z&b,kJA=","SaveState_mkdd/Diddy.arc/3":"ZNCA8qk(x[3Q2EOIBQ_k+DN1bp5[;MNp*O]74=3}+gSLY*m{Ra4O~gTqhaWPB[]K|*7dj:=","SaveState_mkdd/Diddy.arc/4":"ZNCA8KAFn)GEHuQz/ld)8TV{Z&m8nMoj_Apu*9Ik*Plv08q2X=7Yd+wWgQ_;JyI$4@VF{p=","SaveState_mkdd/Diddy.arc/5":"ZNCA86dkD|lyp2)$xY5RerX~qsGh3vN~doX/=6_HLIg,yJITrjizj*r5q2xn]fPOU4Y@+~=","SaveState_mkdd/Donkey.arc/1":"ZNCA874wwGcmaU?X4zhtB=OYj8(W5_M6*KShERI]t:B]kx(?6eOYwYvx/=3~9/INr?i+g?=","SaveState_mkdd/Donkey.arc/2":"ZNCA8;dq8mJIZ)}(e),H{OslyU&f4q)eV{7:n5PloS^1e*A-CLr_ho1c|fQ|&R!DTt6d!Z=","SaveState_mkdd/Donkey.arc/3":"ZNCA8iI3tv4N@6,/9A}mbw5tCaWlV4igAYYaDhqzGC!B3-LK@L0~/s4gebcJ+qB;x7Z4R5=","SaveState_mkdd/Donkey.arc/4":"ZNCA86Z5$dEv*gI8iAdnFr3@p5Z,5Z?lh=WE8Q]ic4I3AoEHrVo538nsd&7+va}j&wfAv]=","SaveState_mkdd/Donkey.arc/5":"ZNCA88UdFr5eg:xl4)&p+a_j2g:y985apSYdzVfDECCz-5RD:25y{^fYI&klEl,qW+(0Ae=","SaveState_mkdd/Koopa.arc/1":"ZNCA8k9;Xlk*@Cn!+3jdc&Jf&tNoh,!$RpU3VB3!E2mHzIamt~&;I|2+Dbu*ooRUi;Q7:Q=","SaveState_mkdd/Koopa.arc/2":"ZNCA8JJ/=6zIA@C-+_{3$1nO@_H-B;gpT9gmz?X*p31aLjN=,YliX6$P):y3VU|LUFYS7A=","SaveState_mkdd/Koopa.arc/3":"ZNCA8yOYoh*9w?z?=s=ce5/1MW0Rqvs?)!MiHLszxQHC^st&YUV}mBELCO(~qsn4yXTP5D=","SaveState_mkdd/Koopa.arc/4":"ZNCA8BL|v|_hExYi+@v-Z@5M/fA^E)n*^C&nag5pa;1c3XhakU:yEOXW)?GY?P{&r~j=B(=","SaveState_mkdd/Koopa.arc/5":"ZNCA8gjUiEe}_H!PBy)V+JYsY:z}:6x,p@EE@sGv{x0/OyTEt[+WtQu=5i9X]O[-IWR$-m=","SaveState_mkdd/Koopa.arc/6":"ZNCA8*J{;H(;tFuU0?,NABk3L~c2^78(}LXq}^N/[j5EK,w@7j=wtdapzgT+wak]7gouj_=","SaveState_mkdd/Luigi.arc/1":"ZNCA8n]i5+cfUpfIaG+4m,+8ls5:k2jTr+==C=12Kn|Xbiz!d4SJ$!le(T0!&D@La[f?(W=","SaveState_mkdd/Luigi.arc/2":"ZNCA82U(^t(,fJ|a{cK5Jkjm[(UxL_?iNIT!*HRgu,)Uc!/[|FW-*$9!-,d*b~~EClU~6O=","SaveState_mkdd/Luigi.arc/3":"ZNCA828*x}hW2r:mQ}g/4qfG-zjqLa8-^yo9|+]w=t)HduY6]Zt(IDl$i1QbB=^AH,?o!a=","SaveState_mkdd/Luigi.arc/4":"ZNCA8[IH3?yuV3mBJ!/[&G==CMFjtdx@q}7}U_/}/4vB161e-u*d@&Liy=R/v_O6ya++ql=","SaveState_mkdd/Mario.arc/1":"ZNCA84:XKZFMNS)8/qK~zV6~2xY|AyB|00}GyZ/AGDd1,nLGps0A/aRVMu9dyZ5TI[DFwp=","SaveState_mkdd/Mario.arc/2":"ZNCA8g-}yNMoJEWik0j1pnN)r_gLLat8&y@G31iX_xk1|u&z;-mPk{tjEsK5X3YQ;bf;+u=","SaveState_mkdd/Mario.arc/3":"ZNCA8@Ak{2tuAf_J]o5a2ScDDb*g]u(lkx6Wwd[8otE=d/qo{w;M-KM0e)-sJ|bAs8^:Aa=","SaveState_mkdd/Mario.arc/4":"ZNCA8/vP2bZ&a|^jr(6bME,i,bQcN+EBAGD!^5C~GkO+RRK7hr14?-yUVavVr0q!fG0/C8=","SaveState_mkdd/Mario.arc/5":"ZNCA8Co;4jUp+57=a6k+9N9ort)W&O[mYue5gtM1,HKF+[E2?wYqd@9O9kngQ5a5z6e&pk=","SaveState_mkdd/Mario.arc/6":"ZNCA8:/ZH;;53J6ZcV;?~A)qA:o/dxyecPj*r=,vz5cC*Q0DKU4RCIv3$[HALq3x+I],xy=","SaveState_mkdd/Nokonoko.arc/1":"ZNCA8ynJB/xq&oO@]TA;Q:U~!!{(kcD;j1/XzzFdD8Y/JY]4Z|y)dtk79ejs43]NJH()sG=","SaveState_mkdd/Nokonoko.arc/2":"ZNCA8J)fAG;@|}Dsl@?D1N}iFP?Qc*tqUJ,&zPNjfluM|YFDcVE=[H&k0w[dwOH/!V~vg[=","SaveState_mkdd/Nokonoko.arc/3":"ZNCA8pb3vXWHl-Rz{JbG?!y=sM5bdRGztxLhSYNb_;iIfrM&}Qr(JiDPvc@OFMb|cP(]Ke=","SaveState_mkdd/Nokonoko.arc/4":"ZNCA8[p1adhEP6hA@[~!SZe^WN$j{9fiS)LC&ZwT{Fti&aLkwps!NSF:U&vnRIfk7Fu@+r=","SaveState_mkdd/Patapata.arc/1":"ZNCA8AYG+l9iWyXoN5O2ki-Gj?Alm|9v6=tr;+mk5gE0Nx@LZjkB$Tze|9|FsRW![FUu~l=","SaveState_mkdd/Patapata.arc/2":"ZNCA8pvR@SUfLIc)q~3dx$sjXEt34Ckd+PstZ+n80;=]Siqo[REx44O(zx=:(IztcKk/Kf=","SaveState_mkdd/Patapata.arc/3":"ZNCA8EXk,$/hVSkYH?X4pc9cZ[tSy5S8GTP;Mrr~UdjIddwcc-df?n9)0BD,pwZiasT|@2=","SaveState_mkdd/Peach.arc/1":"ZNCA8jfE69fJS[RGPyqfWC-QedZG7nB/r5z,e3&Ht1;a]*rk^+T$@Y&c@E}_o&B;B_@oQZ=","SaveState_mkdd/Peach.arc/2":"ZNCA8,7A5b*;rog~1L3_YU:,&q]^WkIKD4lz51EW/P{C,Q=[@[a!BDdZM^?Sz4B,B&HLSh=","SaveState_mkdd/Peach.arc/3":"ZNCA8E&XJgOw_eyMC8yi6:u:h+*=gwreCD-N85!exEuZet0k[Y~Z-t0C~}_kjfN[MbOzyw=","SaveState_mkdd/Peach.arc/4":"ZNCA8]8A/GQi:]N+k*)BgBaL-CCHrzqLG;PkD~A33O__zkljlNet/A_y[UN=aBD[~mA??e=","SaveState_mkdd/Rainbow.arc/1":"ZNCA8Q*aHL6IDN_0[LMyr!i,Yf@S16B3O62TA8IYFYRpr4T!9E6tUDIF6_f|RXALM9J_Fj=","SaveState_mkdd/Rainbow.arc/2":"ZNCA8Kl[JYdQ7Xc(;I9{I+r5(j;Cz9C^ESup9EW7~3aIt$lIgS5(;$+*TpD4S[,d}aEld6=","SaveState_mkdd/Rainbow.arc/3":"ZNCA8_*N9hZm-6/vzq^!9-PSBa+w|nh5+OpQ+s=S6:,KaBl0FXWD8(A3_!4=p/9f3e3S+G=","SaveState_mkdd/Rainbow.arc/4":"ZNCA8*aiWG_T@k?5plB(kXB)cojxV|V4P}~WcO8TIoi^4+w@x5)_6l-JQ~:Y&f6rc?Bh4{=","SaveState_mkdd/Rainbow.arc/5":"ZNCA8M_gjQ~KH;l*H/m+Watd{4t+hiNLXs$U9:^j2-yMKl+fNSj3W?odcz,A_4Z{Afit:Z=","SaveState_mkdd/Rainbow.arc/6":"ZNCA8F!W:=[W9//h67Pd!c0?{0eIvpOlfKLMSFMwXA;{(_Xm*FJ&?uoDArhjoGU*FB_@m)=","SaveState_mkdd/Snow.arc/1":"ZNCA8x[N4:Ixw&Yb4b+iG?*,kio-F|];x?]wZ_-x9x}ioG8kB7I,/!gcQqh:=L*_bk=6Mp=","SaveState_mkdd/Snow.arc/2":"ZNCA8n8}$[74br}-(/P2q9pJd[t{J(xYT+[5KCAiMe[!9:zhTT(gF@BF7QhlQ=Yu+=Y|eN=","SaveState_mkdd/Snow.arc/3":"ZNCA8kEERonH!Me+U46i_uocEQw6oTe(b~}4LUp?=|;4dqe[rmOaV;+4pDca3}3eZjQP$v=","SaveState_mkdd/Snow.arc/4":"ZNCA8hT:8KIGBKe{5cP-L5S9aBN1OZtInYGUe?|?_Px/:jek}O]+TkvV|uH{t/--^DeR[7=","SaveState_mkdd/Snow.arc/5":"ZNCA8,F7m~+zKs^WR*[T-(SmpQx1wc;Ov+rSB8-;lm(Gf/p$(Yc6c$59R8:539JOYhj?P;=","SaveState_mkdd/Waluigi.arc/1":"ZNCA8TbGmzxZ643WbulCwmv3n,9J[,x=}V,44hHDnE{u;ON:gE/5Q~bzjI71mF7gVB@zA4=","SaveState_mkdd/Waluigi.arc/2":"ZNCA83qx:4eT-k1TAxaQG4;hotX|TU~ZFjbV34TIp)HM3):Md}*C@5u)]FI;(n)=z_k*CF=","SaveState_mkdd/Waluigi.arc/3":"ZNCA8W&g?XBL6^Rh@-*bOlCQO5o7k9[CvN[0c2}f!51Utrlp26p+S37wzY/_-T0:VQ6(K^=","SaveState_mkdd/Waluigi.arc/4":"ZNCA83~Wr0~9d,xT8GpcK$tR)+n;ODS_4N@6TwC013kRFaJQrf[jToN2W+;oHP$bhb6$u2=","SaveState_mkdd/Waluigi.arc/5":"ZNCA8Os[1+wNT_1hydXLQaMU&q0:_Y(B3B:G}H_Lmx-oTX{S3d0aQdI=]X$=)pX-!q8^=R=","SaveState_mkdd/Waluigi.arc/6":"ZNCA8-tq~do{puzqo2B{vrFdy_*5c[12M-jyfIq-EGh;A8k(GakC~Q^pGD,,xn,-{45Hh;=","SaveState_mkdd/Waluigi.arc/7":"ZNCA8lAV[fjEppaSGtb-+16ZZI5!|3{1{_CPHBMwWfQ}Jd*Jt1Z6rJ0(c/D&bAK&]UCv(7=","SaveState_mkdd/Waluigi.arc/8":"ZNCA8j[Y{x/M~cUqh+s8fr+?f2xb5jRJFWxnqztab,I_cuByfdbz2)bQ{I^Fnu3NiFm-BO=","SaveState_mkdd/Wario.arc/1":"ZNCA8F$[Th2rdJo{gbN]$eF3Nwb)bJ16}ejbPiVmX/4ASQQ*r*16^V7ssFbC7v=-q4$C:B=","SaveState_mkdd/Wario.arc/2":"ZNCA8a(!0i$wvV|I~U6foNm?ED-BG8TWvaYsxx6!$XqbW&V20(:k/8Vaj-N$AC8E1yOWWJ=","SaveState_mkdd/Wario.arc/3":"ZNCA8$2!qaEEq3qMyAsM]7!R)S8SvqYet$TAB1x-v@5f,zgp-Cm^d|xB?]wh7UlLMwIhWH=","SaveState_mkdd/Wario.arc/4":"ZNCA8IKsdSn[s3Qp*AiLP(Xc=1A6mZXlKoIrR9Y6k^_qsA6NpSA/NPRzhGkk1y~/0n$C39=","SaveState_mkdd/Wario.arc/5":"ZNCA8D,Y7t}U6N(6Ul;)f*|P]M_tsrlt|I}eAZF?9Z@Zmru6(lC1MjBA_1P]UcoPccYA!@=","SaveState_mkdd/Yoshi.arc/1":"ZNCA82@LVFHXLsOlOG}j0F?fPWqt+TwMiTF5Wz8xyJ(C)W~+QRrS9q}j9k2g~)LzF~r;Q)=","SaveState_mkdd/Yoshi.arc/2":"ZNCA8iLI;8w(HY{@9H){Bi4o^:e@sXJe+fagQaHy@1*w:QJ?SYa|vNm5bx-tO-&w7oNf_a=","SaveState_mkdd/Yoshi.arc/3":"ZNCA8e)?E~jul2!Y4/RSo{LYv~pPdjSIv@)llglAmGNf6;MYpxi|~POHikuj]0_h0wG;TV=","SaveState_mkdd/Yoshi.arc/4":"ZNCA8/)}x5Qwe/|![Nj21ySds@@K-f0&KCRWJP3akRyTsg5z8aAi$y+/3)}c1;0f?v37!}=","SaveState_mkdd/Yoshi.arc/5":"ZNCA8z*y48wWef4l5qhUjO7zD6Jfj{fB,=5H8y4ijS(^f9$y|MSX-RcTuf*Oda~6BmIsIj=","SaveState_mkdd/Mini1.arc/1":"ShareData=AC4UQ9yDJbUR)^[9h]~?=5WVl4(]rEUsib,UBQd4Wr4U4UrJz^T8~(R9m0~t=2","SaveState_mkdd/Mini2.arc/1":"ShareData=AHMe]UbeyNUKJdU9F_?q=5qL@QC;lVUgVsGT{$@]WWd&,T{;/u9Q*0;Uan,aWq","SaveState_mkdd/Mini3.arc/1":"ShareData=AHw]XUa+Pj8Pv$TTr*Oe=EatEQ4bfiUeig9UZ+u~WwD2F86GBw93}GAUW4aAWq","SaveState_mkdd/Mini5.arc/1":"ShareData=AY=)FUe,aSTw2eH8v-Jw=BH$|P,3+dUerc*T)Z0HWx4_DTY6:~9F?jvUdESgWq","SaveState_mkdd/Mini7.arc/1":"ShareData=AQ-g}Ul2Ns9YozSUr8:2W65,~Qz3a[Uh19_URg&fWr@I19t=9V9Gm?wT{WPdWq","SaveState_mkdd/Mini8.arc/1":"ShareData=ANA}qUZrBvUE0i[9ahqe=v!FkQeBoVUgVsGUE++=W+XYJUEa9i9NoY~Uh[FtWq","SaveState_mkwii/beginner_course/1":"ZNCA8Vxd,G;]c]teow&0fqa&R[-{gUrg$(DfvSM)XeOlph?XB,xBHy/aIK[5:a-1Bd!xa+=","SaveState_mkwii/beginner_course/2":"ZNCA8b+&kdkRFAA;]wR*sa[V-$/Nf5HVnpdTY8-[?amN(l-!7l{KHBY]otdWlVEy6vm)39=","SaveState_mkwii/beginner_course/3":"ZNCA8f@k$W_NaC{:]2py@U-]Tv-Ai7L,|!ZFQs([rt,!_II@*]N4oYJ-Q}(GzYtz*sXVF3=","SaveState_mkwii/beginner_course/4":"ZNCA87ma3_w}BKah21Yq8_p9zL=IDNJ_6@(&]Wl+&]X-N{q(bM6:1;8bC054PcB!^VDdW2=","SaveState_mkwii/beginner_course/5":"ZNCA8o,gZYk4sFOg8}6N/*|Ln;n&i3Tj&x98?b8Z[-|vg889dGJue?vFf=x@V|7&vaHEv{=","SaveState_mkwii/block_battle/1":"ZNCA8xrn[DIE)lja|kU~Nsrm^iqXFY)Z$:-rEzNkr3}:X*i0R_a~Z}Y$zoGVU+1^^${QSy=","SaveState_mkwii/boardcross_course/1":"ZNCA8@aV]k}O^WT{[ku@A}]c[oUmerp+PYi-W-}nL&:9t0L0W9U&gkO4@h&YN82e4@(_v(=","SaveState_mkwii/boardcross_course/2":"ZNCA8r!5TgQ75iV(jUQiERcczlsM}N+Q5Lr}WZZ{&?^^u6prpE*o4p)1H&oxwq{1LOW{Pz=","SaveState_mkwii/boardcross_course/3":"ZNCA88F:z|f(4yIMB56S3Yy3ay=NHn(xK7VJo/EUfAuo@rd7u[e8MxEbf&UY@BL,!v&J-8=","SaveState_mkwii/boardcross_course/4":"ZNCA8T^6Qp9&Do^GA=c/Fz/=S&|&=hOJ1U9W;PXbSc,{@4~)AVL7Idc$wR/6i4tfT&w{E7=","SaveState_mkwii/boardcross_course/5":"ZNCA8)Z@bVa4EBz)6OcE3oRrg75gZ?nx9D!OXgGoWlR2R87X~h?N0,h@gk[I2r8LWs_UD5=","SaveState_mkwii/casino_battle/1":"ZNCA8N{a$@w83Xhv^R1Z+@71jle@$z9J;kX8xBt8aSW|l-suJNIN@1bJfnXA)P8p;DH5l8=","SaveState_mkwii/castle_course/1":"ZNCA8lBO;VQdxZgO?9OX@|b}Am{a()hVA^MhjD-cneLSSQB}{fz[S&-2BdJH-S(bA2IPn9=","SaveState_mkwii/castle_course/2":"ZNCA8L:8rEKr|E361ic1]8R^NN,jI5dF9BZ0-/Kj;kUEe,4UWIG89bB*IvPU2/4!8P_A@l=","SaveState_mkwii/castle_course/3":"ZNCA8M;HQqF+(}$a)wj}7{Wo];Ag{7&Uw8^23b^XjnjVsI}}i~-ItMWp7}^g1Suk+y8ttx=","SaveState_mkwii/castle_course/4":"ZNCA81,v^vKzn0rs1gpEnHFe5D=rgrD*b])Z;|Z6=A^(WP^rN9hZBeZ4rkq_~0LzE&8i1{=","SaveState_mkwii/desert_course/1":"ZNCA8iU7DiOxAP5$1n!KJEWv*DQJd=(Vn(89(+{p,22i(/]1Kq]xg}O,AbGb]6J[rH)}ML=","SaveState_mkwii/desert_course/2":"ZNCA8+&1NF$WsqXhO@tLp0}JC2J4hsNPf/rK0{=9?PSG;7dm(:AdH4+l=HFe8Zk[y1{aBD=","SaveState_mkwii/desert_course/3":"ZNCA8l0cEBrp{5ZD02Bq{h~xNu_jx551Qn1$M(Y_?~[e[[Px@e?(@X|MuA-czsh-n~vdH~=","SaveState_mkwii/desert_course/4":"ZNCA8IKGbz[U9BJuYDSSE_VZ|;^jY4qE!FX:A/iMjbIP]$8joZE@birLOTm^:)WF6T5ax(=","SaveState_mkwii/desert_course/5":"ZNCA8r!xn;az7F_86,R5j})H4weFe7zot@)v_ILk5pLik!;*@Uv+by9FP@{HC[{^?}VSMk=","SaveState_mkwii/ending_demo/1":"ZNCA8Vxd,G;]c]teow&0fqa&R[-{gUrg$(DfvSM)XeOlph?XB,xBHy/aIK[5:a-1Bd!xa+=","SaveState_mkwii/ending_demo/2":"ZNCA8b+&kdkRFAA;]wR*sa[V-$/Nf5HVnpdTY8-[?amN(l-!7l{KHBY]otdWlVEy6vm)39=","SaveState_mkwii/ending_demo/3":"ZNCA8f@k$W_NaC{:]2py@U-]Tv-Ai7L,|!ZFQs([rt,!_II@*]N4oYJ-Q}(GzYtz*sXVF3=","SaveState_mkwii/ending_demo/4":"ZNCA87ma3_w}BKah21Yq8_p9zL=IDNJ_6@(&]Wl+&]X-N{q(bM6:1;8bC054PcB!^VDdW2=","SaveState_mkwii/ending_demo/5":"ZNCA8o,gZYk4sFOg8}6N/*|Ln;n&i3Tj&x98?b8Z[-|vg889dGJue?vFf=x@V|7&vaHEv{=","SaveState_mkwii/factory_course/1":"ZNCA8MP$[~BvXF:zg=lHV_28aDi22;yxLCm?4{A?fEB*)Kly{R,K3bkN;Qh~/cZ0Y3pa[W=","SaveState_mkwii/factory_course/2":"ZNCA8847avIW/jjAOt}IZkB4{qWa0($ENVUvoL/HF{X*cU^,2LCgFbp]sY5_VF^0gYin2W=","SaveState_mkwii/factory_course/3":"ZNCA8+o:61Dz[Nc2pxYRdwIuzHkPmkEYDW93VB3!)Rby~{NmpnZ9B)I0D-}J2;|kG6qz)z=","SaveState_mkwii/factory_course/4":"ZNCA8ZzX;V4e|D?&iASN/W&]ZihC}J3^UF@7{G^9:EGg_&Ov_F7)dQM/klXk4FVP+F(q/C=","SaveState_mkwii/factory_course/5":"ZNCA8TA~mqRkLIP-9D:bF=ajNicblLpjF0RxN|p9qA[k4CQx!,P}rL7}A|N-tl!Dv)r[jv=","SaveState_mkwii/farm_course/1":"ZNCA84[9iIQ2l(OsZfw|hlwoztoN,*cVY0/]:/[_=QLWd,?ilMV[Oio1pl7)hTwn0Mei{8=","SaveState_mkwii/farm_course/2":"ZNCA8,7~dIs:5l{j}SjACgV*Az4go-7oXY/$|U0ky8f8&CaPHmfPrCw+$0$0jHB+_jxd*w=","SaveState_mkwii/farm_course/3":"ZNCA8Rcgx1;U)T{tASAe*5d,@cW6{8WN(i@v5kU|s4nb|,G/$,{M6t/i0ssv6K8DIn9,jE=","SaveState_mkwii/farm_course/4":"ZNCA8tFzV1yP/,@-Z&|lUr/9~zt|:e(12b1?}_&0:27|71]0isc;Dw^FQYGj@ExQo{2=|v=","SaveState_mkwii/kinoko_course/1":"ZNCA8X]{gi!+y|&!R[i}a05(J!TIVRg=Qz=,Dc;GgLi]f_lB4_,$9XIxWI1dnw:,D(;SKP=","SaveState_mkwii/kinoko_course/2":"ZNCA8BxC;zMt7^,_qY?B@U&xn3*BR*=EZ:diT~7y{k83!/CJ!d)LNGO}McCKK*yVpe92bR=","SaveState_mkwii/kinoko_course/3":"ZNCA8cEkt:W*b0y/xl7n6uBBBJRD[6V$tOl1olfKrU-FWf8GnBE8{fbVWDyW9Q7H$:=bkn=","SaveState_mkwii/kinoko_course/4":"ZNCA8R17:UOU4nhSHy~/dnQ!gkh~U|RbPT![~pWnfy2Wx7*G^wiC=+/g{D60FOJ-Scjy-g=","SaveState_mkwii/kinoko_course/5":"ZNCA8uNM&0Qs+E{fh;E];IVqz$A$;4dZi,EP-Ry9;IWI;lRnw|Qv*9aW8[X{R8^8},|snN=","SaveState_mkwii/koopa_course/1":"ZNCA8=VlqbFZX:?&H|(iZImkjvytBhNA(j3r3/!co{C;SP7*3zVy)WK=-(=lR,T{;91J~d=","SaveState_mkwii/koopa_course/2":"ZNCA8joOwB1}[255TNs9x3FfLN[KTV7V,G~!H{_!_ZK=DL|t10~w*LjspXUZ?Bq3da/@c3=","SaveState_mkwii/koopa_course/3":"ZNCA8=M:;g[,zx9QZOg@tu?)B*Y$TBwgimxt2Ta?AnHo$l&~^l@sYGCVva/uNDX4;CQ:OC=","SaveState_mkwii/koopa_course/4":"ZNCA8qd-An3};==xXxLA4:A99Gn!pzL7MoD@F4^YgHPfAOb,^BQ_XWTc^mStksE1ibp4~;=","SaveState_mkwii/koopa_course/5":"ZNCA87msr+0JgKD2[bY;q9SY,gEbEZki-@CSx2ffbjro*[Lvp5GI!wO+wK@j7rd*fzRj/8=","SaveState_mkwii/old_CookieLand_gc/1":"ZNCA8WS(5fNt(}BXmO9@pY]Ha[kKX!_,5L(z(JvqT/[6DJ24x*N:~:fNO&@UiFy=P$=a4D=","SaveState_mkwii/old_House_ds/1":"ZNCA82W;)3IpA1p/e/EoqQAO+VE}h^BKW?;l9p!p(Hrb!]=m,YZ:[j?VBWugWBpkHl88Lh=","SaveState_mkwii/old_battle3_gba/1":"ZNCA8=r3+Xlu3Ov;3Hdev?5@,cfbXQLF2ll]:/[_=/_of5Q7m@lp~-Yz/v^{SS!flH,S)X=","SaveState_mkwii/old_battle4_sfc/1":"ZNCA86Tg}=xu2FZB1,G!,H[qn~[4QfVwX1Dt7,Ip:~QHn1LQj_;I&{[A5*,=WEW/xFtkGl=","SaveState_mkwii/old_desert_ds/1":"ZNCA8p}25U_06]DnjIW]rKpVn-E3B8JNv-3)U]7;MOg|&}Dg@Zo4Jt$x2p;q8fZ$:0fONt=","SaveState_mkwii/old_desert_ds/2":"ZNCA86oHN[,9X/?8$*W?z4w[LtK}aC6mRwwqcDE@NJ=I9~1kiwkC4MMY34A:pyPCbTGfz9=","SaveState_mkwii/old_desert_ds/3":"ZNCA8-}A^8lFf!6pbNu7@6W]-bN+vn&,GwVKi(WvY/$I;d}Tqg/_uF~mmb$K4Vhpf+&@dC=","SaveState_mkwii/old_donkey_64/1":"ZNCA8Kb;D+uqRq|x}!b]Zl9wwfa[md6)P;IN,_|g,@$[/TA3||L{h*+0y;a5Glo$z{Tj**=","SaveState_mkwii/old_donkey_64/2":"ZNCA87(K~mzFgJ9P5hh$E[;?cdd}DcEf$?6SAlc;[y9x}YnVU-?Y(^u1(O*1+-IcM4pHB0=","SaveState_mkwii/old_donkey_64/3":"ZNCA8Tv6UWmHch&ykDb16IY3hh(Mi/mp7y5h$4N]6{@1U)a2l:CU^nxzt39}oZ$Q2PdF,G=","SaveState_mkwii/old_donkey_64/4":"ZNCA8hrO}}8vbw$E@o/}[h+tryz|8V!jM)IlP)e6drArbFFnQuL9BWk-H!3MGntYALX6Bf=","SaveState_mkwii/old_donkey_gc/1":"ZNCA8*s1]0F9d_?{{NxTy87(WRQ!nOJmEHUU~yZbc(P++Wil)cu&5[NXsIm0u,|U4f]7zt=","SaveState_mkwii/old_donkey_gc/2":"ZNCA8~7J,LNJMG:WBF{ZS~)y6G@|dAPKu_9W]+RBTEh~m&--x:)94?buEYd;uVg?&(;7A_=","SaveState_mkwii/old_donkey_gc/3":"ZNCA8LyWr4r30=aPNkxLMDqat5SOtiMd-G)9eFn8;_8yYBgp+8yFL{yPhbgwEId|PJJ;l@=","SaveState_mkwii/old_donkey_gc/4":"ZNCA8lexPLhtOw1q7^raFil[r}NSo-&3Z^VM&g6[[GxPEDu@qvL-]N};05ob{VyApv9PnC=","SaveState_mkwii/old_falls_ds/1":"ZNCA8gK!8]dUAmQ!uiUS$Hykf2$NJw)[Z4_@uuJ;Q3{P9LM6aBr{vi:NJ;0CR3L80h{!e$=","SaveState_mkwii/old_falls_ds/2":"ZNCA8fT&hq9zhbLcG7V4Z!oGh7I[2a3[c@1XYX{cDF30HhMTqq3hfmmD6mGF_vb9HEhGnr=","SaveState_mkwii/old_falls_ds/3":"ZNCA89?~[d?a{)}JbQ,K4-y@Su;z,96n79Z~P3}uy*AVi-ChgxA9iAz02y*ZM&z+5ZW;Km=","SaveState_mkwii/old_falls_ds/4":"ZNCA8jU]fH4(DmIwFpIkmp-1r)-M@otfqK2xFc$~*uKqsYM|(wcGnSsUL-x2]9i4jNZwor=","SaveState_mkwii/old_garden_ds/1":"ZNCA8Q-~_I0!F@t@,*4R5F:J$[z-hP:[8s=2uoNaKk*V3f?NA1R$*Fon=)O3f-guq6FC5r=","SaveState_mkwii/old_garden_ds/2":"ZNCA8e}ZDSxhDnz,iQl]-k)x)XG^K@-J;Knk)69N8+O)DV1yl;qikFO9|sO[?]-cGROR0A=","SaveState_mkwii/old_garden_ds/3":"ZNCA8[P9^mDgk{jZr09)6RWnN~s4NLpL1m=SloN|pYl)1iUZ&c20OgFm{;&/uV*RLyA|IQ=","SaveState_mkwii/old_heyho_gba/1":"ZNCA8l]xJ6=*BET,@ZGKUWu?7w8+yhA1$4b0VG-;O?7yY&_i:IUGA}ipe)VPvo_w)*iQm$=","SaveState_mkwii/old_heyho_gba/2":"ZNCA8nsTcQ6(UC{-w$nvhutv4DeX40(AnN_Po?MN(_lL=dJz:[W7+{3UqfE&6{S7PytE_R=","SaveState_mkwii/old_koopa_64/1":"ZNCA8zR=h(sWWx@FH|0O*ru?($zo[x0;:]gx@~czq@2|dGW|b(@^S&9Kr3jnbDVMkv{E?{=","SaveState_mkwii/old_koopa_64/2":"ZNCA8s+?|aS&BOlHo;yh1Qs[W_KOg|J1lvPiim10zla,GAjx5HJ|Rj?1/K:{JIw-uybzOx=","SaveState_mkwii/old_koopa_64/3":"ZNCA8A~Kh6~;vmByMLZ*oS)QGwiIgz[$6(9X_n66Wmnz8v~r6PAW}Gh@4:)WZ]laC-M[&)=","SaveState_mkwii/old_koopa_64/4":"ZNCA8Q2xKB9|^3:44rB/c9|^LrS~Qxqo:+dpv0jwcjS]845$X4D}Nd8TRPW4BaN|H[?8BR=","SaveState_mkwii/old_koopa_gba/1":"ZNCA8RX5x[r(UR1?mgEEy;7c]n+R~2~*aB&W(Kr}Lb:7i:jU{xA?MZK3T&[TovUvF{[Ne-=","SaveState_mkwii/old_koopa_gba/2":"ZNCA8z8tiskZNv2y}zrgXKJ?B5I*DlOTSv))ToeryhEz$6z!k$(hJ@wMxLJlx4mQ-{Ux]Z=","SaveState_mkwii/old_koopa_gba/3":"ZNCA8/E*)l9&k$JZpNGdo:pF/t&(DCsTy8gf]||x*=AyBi$$Kpq_d|EYo5(HQCBK@&aa_X=","SaveState_mkwii/old_mario_64/1":"ZNCA8IrXUwMNn!^n65/l-:PB!mVPjYC@R$[]=d!XfluM|kBjjIjUTUoo|VB8qS{u8*k*Im=","SaveState_mkwii/old_mario_64/2":"ZNCA8L:TKb!jTmjQAUOUqaIa5dV7yJy/v:c(/S-_*JrqUemyt~L/q66mWUgGBxv+j/R{H~=","SaveState_mkwii/old_mario_64/3":"ZNCA8NNuSM~r;^zvs@!h-[|j9wj!(VcGh1^phtWG3=WGAh&ViznNSvid)*G-1EMRVDfPJq=","SaveState_mkwii/old_mario_64/4":"ZNCA8dyb^Mnm|5xb/||6*SC&,/8cqkB5O;J5l4tsZPh7h,n2/,_rr:tIYdbQ4_V,,U[co;=","SaveState_mkwii/old_mario_gc/1":"ZNCA8{KtnPYKL5FT{iJN$::;s:;AkJY(u23Y))p*ZoOvz$ubPjn)B$va7kMkfhTYQLBQh2=","SaveState_mkwii/old_mario_gc/2":"ZNCA8Dh*??ML=b/[8zncIc7vNfOV2:xA}GQ*tL;=iOQJ5[dJ1Jwv0:52DeKhEK$_4E6i1k=","SaveState_mkwii/old_mario_gc/3":"ZNCA8TT9,RK?9T2Fy_(gE,OOde0jSdq1,QUgq4*1kodCzdpaxz9lr2*hkuCx({P]-&wQ{i=","SaveState_mkwii/old_mario_sfc/1":"ZNCA8t6+jOG!E?zl9vJ5xwn$Cagd|mi~i4k;=?wpA1@OL!^Bfg_BN(V[j6*T$(Th&[d1+==","SaveState_mkwii/old_mario_sfc/2":"ZNCA8f5W=~ShW)flHHB@--ei?]uLD;0[}iJry(I0{P-8uaS}WQVNXu$=RDRiUzHH}x}{ln=","SaveState_mkwii/old_matenro_64/1":"ZNCA8-=4e]!a=P*{Uh&(CbmET)|:+&fGods-fHdcN}mF4x/d!5X3R21W5HM4gD)mjoK{}Y=","SaveState_mkwii/old_obake_sfc/1":"ZNCA8+d/eH=9mLa*gDJky$|;_YH]/z@mNC[xio8QmhsK$HYcO}Kk)(D2(aBS5tvvbC$]Re=","SaveState_mkwii/old_obake_sfc/2":"ZNCA8)+)CEUj=VE&+&isqQ5e+[u+u|qRdI&Q{J~[{v:Lo5pA1&,T0:zuwATxPtQRCeJ_+j=","SaveState_mkwii/old_peach_gc/1":"ZNCA8$o$Xn:{89},1i$7?CAP}+NgIV-,f(K=8OnTEfJvq)+/yPE{onig,;iV_M,c0s8]hV=","SaveState_mkwii/old_peach_gc/2":"ZNCA8nck3gadT*h_!q0-7siE{oZ]*kyRf)-=ltig{vyQ[gX*~hNI=_9)y$KX}KcQ=1wdA7=","SaveState_mkwii/old_sherbet_64/1":"ZNCA8,K/Rr[pIvf0x9y8JxzlE]~j,2dcQ7RiQ1[4qhaO2,@fe:2?vJ5BF:}/[aEr6Jc5Kc=","SaveState_mkwii/old_sherbet_64/2":"ZNCA8YL-:ECB9*![ym7f[THRseLXpcjN{^I*C^ENk,U;4LtzyLA,(*3yc*wAgQGct_cJHU=","SaveState_mkwii/old_town_ds/1":"ZNCA8CNHcE;|xx2MFBH:G@f4X6pI=D$QKtqg?pw|bta~2y1$@j?)[HpnWLnCO9(ISng)5p=","SaveState_mkwii/old_town_ds/2":"ZNCA8kW*V=m;3ys]~S7!X^vpA[ZQ-IQ3mJ,r)*o]!1]JU[YVH;4YxKUdT2{v}Nqw6h2je1=","SaveState_mkwii/old_town_ds/3":"ZNCA8h;^;9~fBPjae4MJT(ukzSHMaKo@]3E[)+T3:}CH8X6g](SODt60IMV9hU1E]&&]l0=","SaveState_mkwii/old_town_ds/4":"ZNCA8XW;?(KCTe@A&+?UQ1MQi@]QxuiUMSG!F9AuiOQJ5/mTBgpRiVe8P&J9-tu(yx7}:;=","SaveState_mkwii/old_waluigi_gc/1":"ZNCA884ZlcG9h$Lb@J-&(r-z}+0;hnxzVBV0E-EDtc9+If@AWEYR/dyyH=aG&+&61B/T]&=","SaveState_mkwii/old_waluigi_gc/2":"ZNCA8uxqUh=27B6P6MJEuGA?*x^uNQV=jMTAc=9L(O4m;vDsDz;G9Z!qfnKAI!c5f0H4g9=","SaveState_mkwii/old_waluigi_gc/3":"ZNCA8n(W^|VAwJN$BP{JU0N]l)RVw!GfS&~a15NyNUgc{+zu2D3,mq2bwq0FtqCRpi=oZ7=","SaveState_mkwii/rainbow_course/1":"ZNCA8Gzp_3XCX&&o0FWGt^2p7U!u)Jr|W@m:xFlpx|D&]nxm]+!NHIkPZ:ds&M{HJY3N}j=","SaveState_mkwii/rainbow_course/2":"ZNCA8KRlug5?q@s?JU3cK7/W{ar@l4{Z@3&kkZfqj_c_OvAm9PjBtSg3Vmy0(;!sKJy3,Z=","SaveState_mkwii/rainbow_course/3":"ZNCA8LTH})13X2iUJOL)3&wvjy~i/Aw|H7EcoKW|w5wH/J!V,Flz!7ol~yOAX^,}on2ie[=","SaveState_mkwii/rainbow_course/4":"ZNCA8Jn;FpP&BuYh**wbi|t?$kN|:cX7wkILDqBu;-zf^~uI=?fy*8[4KRbEi4]E*,4nT&=","SaveState_mkwii/rainbow_course/5":"ZNCA8[P)eSArm$+kk0C[R2@5Zi-mx?:GFn-J_&+eu@/iPmd,Hhpsy)&=1x;hIGP/U=R/I7=","SaveState_mkwii/rainbow_course/6":"ZNCA877l?QsY9i8,F8,0YT003Xe:=,[qVm8sK1gk4l]8Y5=/^P]vuc4:v~~ii0:,;c@~l_=","SaveState_mkwii/ridgehighway_course/1":"ZNCA8{tjUxs(iMP-0lPflB@5^Vf9cpNhO^mtUP)M=62~NGeDXJJ_JTHT76=mj?=9J7Wj]T=","SaveState_mkwii/ridgehighway_course/2":"ZNCA85r-IqfFe-_{2=!{x?nfpsh7Ms;JHdpvL26]hT^esBPAII*myH$(]0jIk[1;}mc|2p=","SaveState_mkwii/ridgehighway_course/3":"ZNCA843lukXt~+8{a$G_t6^D9;[B6e(]]y^+lO8WYV3nDeKhv)4,FrJgo/Zzpe1s3Hl/2p=","SaveState_mkwii/ridgehighway_course/4":"ZNCA8nedSeq9KGE,As?6y3N3XW6V*g?tKCOwKRYM7YVB4q{bA5v_np;@6+&CULSygTB8__=","SaveState_mkwii/ridgehighway_course/5":"ZNCA8p=a++j7fEy;f(mK*AB_g23cRh3jA)JJNJF|ldvlQge,gMO@kH3i~13!IzDd0YWJ)T=","SaveState_mkwii/ring_mission/1":"ZNCA8cMQS[WQacjX],zho@a*7vf6UEtlj-/1P:Xp2Df!|pk=9)N7XQ0:5XK1A$2y:bJRu1=","SaveState_mkwii/sand_battle/1":"ZNCA8tT!&}$C5bx?1V_|M@1mF_EZ,kI|NumA]MeI3b@jf2,d-fjLMmS6LgQFAb,)|[M}nr=","SaveState_mkwii/senior_course/1":"ZNCA80XtSMr6rD=Zh+,wpt&SezXeDJwW-re&EJ$RZlEOqaQt]3Lf^FU&;J6]Wu3J2o8~FK=","SaveState_mkwii/senior_course/2":"ZNCA8_Z7DS+MM*J20s!RB]/a_[[5H{He,I8-6imdL9SbxOlZ7sb@jxCv(y1&@Eu~6Ai83r=","SaveState_mkwii/senior_course/3":"ZNCA8Wb}Ls0oFAlghQDC1R8hM;PJ|&z(YlZ*|B@&!y_T{Ne:o(dC~!UR}d?Ki_Xck11K;==","SaveState_mkwii/senior_course/4":"ZNCA8czSvaB/0*c-1iFxY&uMkYLgxZF*rMf_V2v8X@(Wo7f$X2m,al$5f0W=8Lcg4YS*{$=","SaveState_mkwii/senior_course/5":"ZNCA8V0^j(B/0*cLt&9Tjr2Y=YV9*Xkv?^Zd-h7CuJBU+zf-wemm^c!&J11/-gCchtK{v,=","SaveState_mkwii/shopping_course/1":"ZNCA8?zPN^df[QnKn?X~-JPCo=2u5M&Bf{77jj6Av{,9(V~X;qXSFQ-x4glbEyQ*Rdce_I=","SaveState_mkwii/shopping_course/2":"ZNCA8JOE~(]}_lanODaCh7&(:mG=~AgiUVq*73~of-*mgv?b[ehu:U[j[03LrpR;y5e:FC=","SaveState_mkwii/shopping_course/3":"ZNCA8w1Q]8m$JMfb;pcyx7bt!1,=!WC_vw7]9[G?~=h?@dcpw5-P8jhdDlY1$x|:bD)9O^=","SaveState_mkwii/shopping_course/4":"ZNCA8bf?8x4Wuv)a^tC{dvkCB1~[LQta!oIyp^5XD0G*h~G1=[p|EID7k;rze2({=(^P+m=","SaveState_mkwii/shopping_course/5":"ZNCA8qa2Yw0Ea}Tlq]i7U|8jYsMfazCJu]A!f}ro3N@RPXrSr;EX@1cZ10-Q5(*]TLmr9n=","SaveState_mkwii/shopping_course/6":"ZNCA8Npfcll}*xrgipNv7xHAHjcmdO,*hbwNNj9tq~MUBL{_(&[Kf6L]ywFg{dY-&3n}ub=","SaveState_mkwii/shopping_course/7":"ZNCA8f(n^S4Y3W,CrGe_QIbmmJFwdZiK}!~k!+^6sFKbAYezT8FTP0Yo9I:W_fP|0mf,_E=","SaveState_mkwii/skate_battle/1":"ZNCA8AAq^Mc-AE)@zJZP$QQfI$0^7@,^80r&]Wl+)n@YSS-Y[}lSwLpR~=tkK;)|7W9d^9=","SaveState_mkwii/treehouse_course/1":"ZNCA8kk&a!XhVJhi7A=w&Hp&^o_&$OFbq3hu6]]_UWM9e43lEQs|E{yzKQIAiH^B5skjM+=","SaveState_mkwii/treehouse_course/2":"ZNCA85$ZqCC7@b&BGFcW&xK-raJ/7?BDW;-l2@{&m--cs{R)(KUFk}M_a01Ov$XIdrc8S[=","SaveState_mkwii/treehouse_course/3":"ZNCA8A,-F?d@kq6S4z{yQN;=Vc=0$~GbL&J~waWCFzJ3([Nue-G9JAdHc;rQTkv76Z^6A&=","SaveState_mkwii/treehouse_course/4":"ZNCA8M9(!-lte_9(@Y=LqX34Tq$J}j?DQ;wA*9u^$v9u^eWgbS~]hJfE~iGI:g8Kd?Qi1z=","SaveState_mkwii/treehouse_course/5":"ZNCA8R1]S9oe7*eT|xa5LlIi*GMj[)0^{TjoK?x_[]8i87)CO=d26vu{4m]z?)mQ=FMKZt=","SaveState_mkwii/treehouse_course/6":"ZNCA8nuUxEhq/kC7Qc;}UJIuHd2&[sNzn)VeBpTkGaP|g,Yxx8R,V2[uZ^!w8,*Oz8:l2U=","SaveState_mkwii/truck_course/1":"ZNCA8En*yB~:?UQ]V0e]$4w,-]?yxpP[AyQeiC&En^{TrXwr-al_Ux::Z!Q:hjVfPtN3?&=","SaveState_mkwii/truck_course/2":"ZNCA8[NCwX:y})lvriuYOUcD{J4:4wcl6JtUDs@/=w^Z+gWiY8Z(ItG2WN(=52ZP$O-h$_=","SaveState_mkwii/truck_course/3":"ZNCA8CI6W[al!IpYcU:G?!9vI&YVkvT]BXeV{OQ)NxClpYBYuh@$jL/VlFBGcq!*+yk?hb=","SaveState_mkwii/truck_course/4":"ZNCA8(j2zAvMI9acB;rKWbkGIH0dy7-vw5{R!r)_Lm~{z,LVdliJ$,S9LuK{aJa1Mf@)CT=","SaveState_mkwii/truck_course/5":"ZNCA8D|A$k1El7SgPRa*Z2,P!U+nHIq1C~7wugQJtH4{]-3IxM=)ecT(0u3qjU7cZ,RQ$a=","SaveState_mkwii/venice_battle/1":"ZNCA87{cY(5{(C{*czbw(D8V1hvFayjBbK8dYo!rk:4L0@xcKvo{:8:n_]7,IR85xkanwv=","SaveState_mkwii/volcano_course/1":"ZNCA8{=dBs3L*8&fHl&E+CdzitMA6]cli/~@LAm[;P^7MTO0c@M&,}9k0@b~Fur_Mycm9Q=","SaveState_mkwii/volcano_course/2":"ZNCA81?h|Cz=J_SPX4emSMgqfL:p5VcX4-|/lWXPlHZi|cc,iA+IC6~xN0n&dH4b?TBp(s=","SaveState_mkwii/volcano_course/3":"ZNCA8vPp&2hW2r:h7M51KSCOTyNGy4-wEhpc2?5pk:4L01D;7dqgx@ao:2B0S9v]gE$fk]=","SaveState_mkwii/volcano_course/4":"ZNCA8poxwQ:*2y81i(k$$RcOTMZ$O9gR(Zq6iZkmL9S57ddMsW$xCfYd-E${ZY7T$n71s/=","SaveState_mkwii/water_course/1":"ZNCA80B3(;ocU^|UItx3JB~8)=iYoa[j)Tcu^Est_v{e!K[+X_&;(CF~a~bjD~4*:v@4Ch=","SaveState_mkwii/water_course/2":"ZNCA8V*j,Akn=8&t{}7]kjO+-1Mn48Z(i5y]xx:_!oRtf9C7Pfk=vwh0bDW**;:8ky_]Xi=","SaveState_mkwii/water_course/3":"ZNCA8*x*dsg[@o1Y1{DMh1}(zsTOB(l$s-0+yQN2G$d3E*$7$6ZNl=:l-O)Qbck^-mdVkF=","SaveState_mkwii/water_course/4":"ZNCA8MC&kL:!xo!kKx([HSb=*2N*zml!{^-mvnyt;5p$Ys=3:HIkH&:;2@2|{guxa(w&FY=","SaveState_mkwii/water_course/5":"ZNCA8OSggyG=(]q~c)qTLOgr?aq2QS09sF)v3/P;HHGhgBq&i,rR*611N^v=2yp}:j4oQC=","SaveState_mm3d/z2_00keikoku/1":"ZNCA8;*b,[/Itum5p2/cNQC^cir1Sto_o2GrX63M$;f?~=2R{KHPs!})2[klY&TMn!rj?9=","SaveState_mm3d/z2_01keikoku/1":"ZNCA8~K7DwMBk8VVT/~j@_+8u!R&x:g?B8yv!Ug9W2efRcTwpEuNicK/N+o4?TY[*~ka6w=","SaveState_mm3d/z2_02keikoku/1":"ZNCA8:qGRZtqGp$5DD+(mfJ9ED+D^7{A=@XKhjSD,OhrHDFi~W*SL$W{EQEl4N~YoI*gr/=","SaveState_mm3d/z2_10yukiyamanomura/1":"ZNCA8@9AK^~RR^gfp2j024&/uBP8FrM=1/H:eO(iAnR/bu)k0Ksqs(=J4px/*7PqH~Kb3H=","SaveState_mm3d/z2_10yukiyamanomura2/1":"ZNCA8J6*E6v*48$p8t$XMM6s{MEY!ESJ?;Ge|l:un~-dE!]U)iF9szW/jxZ6Gi;r0oATBM=","SaveState_mm3d/z2_11goronnosato/1":"ZNCA8NzMWcGh/Hjx2Ucf=!QOLyxR0]7*g{)yQXXb~8roi4FHBHR!ht~k,^Z=w}9MUi(f~9=","SaveState_mm3d/z2_11goronnosato2/1":"ZNCA8+kN,]]YQMBqKxT6))TM/+(j}sY@0VLl9Fbd,V[Ajwh7TV@^2IjWF~$&Eb!ssDr?PX=","SaveState_mm3d/z2_12hakuginmae/1":"ZNCA8qLKs7t@/MO9M{Tb{A@n)LeC[J-ZUoO3n;L}KiWTlv^|u=iKaFGOshWta,;bQHtxv_=","SaveState_mm3d/z2_13hubukinomiti/1":"ZNCA82w|5c_yk5TU:X|1*rpC^GhgTiw}[i/YKS}pMH54v_yoktwWTC$4kYBGgu$l^cK8fA=","SaveState_mm3d/z2_14yukidamanomiti/1":"ZNCA8hb1sRZ920xM4110fQ5}VDoH|MY?pn!EHGvP=}?I())M__-fr~*fB(AD)),LiLBb&n=","SaveState_mm3d/z2_16goron_house/1":"ZNCA8fYk&OJb{]-sso4WA4O9ITxx|$Vl6QxPS2h7[)=-MebY=:V;eW@+VkF_,e,pHcF4G*=","SaveState_mm3d/z2_17setugen/1":"ZNCA8J@+@vw-q}7q_)L]@dP*^kt|J=,Mks|PQ~ILiwF~?=p|A/Dk-zpIal?^!=tDNY~SIi=","SaveState_mm3d/z2_17setugen2/1":"ZNCA8EL?u,OYS}dnlZZo1MBUhr0c_UcKhn?L7/fkw;=DVD;?uoXmBd*h;;Cr_5m^v:1CWg=","SaveState_mm3d/z2_20sichitai/1":"ZNCA8[EB?C$GO-?pp5w)}MS!I-xyhQ+fu]kQZ9Hi+V4Bj!+V3U/bQ}Qk{c^98WQ6T{Se}y=","SaveState_mm3d/z2_20sichitai2/1":"ZNCA8cv}SvBAZ$_i/}RHx9q[iGd/z-kgu-u9t=EOBOxgP;Lcm4xPkouD!(}lz*b-puPHZ4=","SaveState_mm3d/z2_21miturinmae/1":"ZNCA8fD0]:h:MyhiGPWJXLR-fz_LHOK&Q6sX&*=^Q/z~c{uPcKZN!CQB18Q*Co,,5)U0N9=","SaveState_mm3d/z2_22dekucity/1":"ZNCA8zQ8a51WsNf6xFdG--!r:x=y3p0g}*]8xmX&e~177R2,jzHq[]=2T=7zI=[iS(0;~m=","SaveState_mm3d/z2_24kemonomiti/1":"ZNCA8rw?}WrUVgznOgJ0Bs5vGE)+^rY:1_wmrzpyjUyBRyLG[~GImt@pYNssS+y;w78F+6=","SaveState_mm3d/z2_26sarunomori/1":"ZNCA8h37TcN*}C:0og1KD!y4CdCY8Z:{XFa:SE}j(Qtr11p~oG_@w7FsL$2?9L4WZ;Gk*c=","SaveState_mm3d/z2_30gyoson/1":"ZNCA8kzfk^YZ6Pdb:YUQ@{Q-[I]qyzItUJQTY8-[?1_W)K{eCF?Gm1LVU2t+&I4dBHU}aG=","SaveState_mm3d/z2_31misaki/1":"ZNCA8QR6o!Y|Rx,B6qBs)k?tMZ}fmN_$$bA4i/lu-P31:yaPe^Aml_=sAG$-$PKbfXAcN{=","SaveState_mm3d/z2_33zoracity/1":"ZNCA8a?vwuMdnxmuK;wZ@i]a4uEaEkeWIXpq]zb(O]dc5;fGe-yIBnZ(HD+T6,ZfvZN7Op=","SaveState_mm3d/z2_35taki/1":"ZNCA8GNTX9PbXjju?5qS]b{z(lXV2][6_sju0mg3*rOwSaMil|w+TQdllka,q&+,0KB_Kj=","SaveState_mm3d/z2_8itemshop/1":"ZNCA8tDO)N+iq9$J!2}^o6w1bDjA/K1fpY_YZZX(,)aUKN|CVDO+eiyfF6di3SCkol5riM=","SaveState_mm3d/z2_alley/1":"ZNCA8z0@]rR_:O-,-}=v12gbFk_4~|9IQbU!xoMjcGrCXvHe_ENaPg5eEm9V]U[&pF(T]f=","SaveState_mm3d/z2_ayashiishop/1":"ZNCA8[n!mWmUMmr4[U$tJk}j*xc@:8zablR@TA37:}CH8)Mm,n_x|)64?SM&14_uD)Ka0^=","SaveState_mm3d/z2_backtown/1":"ZNCA8ydCii5w3,8=iV8cVe6GM1Ph/k=!GF1n[yNt+!z*Ga)v*g7m92:GUly8Te:6ozK{n;=","SaveState_mm3d/z2_bandroom/1":"ZNCA8=N8KEudjarOUsLYS:?R{GRw[?Cbn[3cz2K^Z2?!_xALO@;LrR|:w5/MTmWMMBHSSd=","SaveState_mm3d/z2_bomya/1":"ZNCA8qQe&xI7EJ3!J-A&H^&06f|z7LA}WiUllglApz4t~sz4Gp;z4VSqMTxYXDxLB*diZ8=","SaveState_mm3d/z2_boti/1":"ZNCA8O!k891{=T?Ca8U]trbP^jo}@0uGV@WcHwyeG*/QiJ&)[:AL|zleSCv]]JCnMjOwfg=","SaveState_mm3d/z2_bowling/1":"ZNCA8w5A}bFJ4(XqBxI2cPuCYxzrH/,q)Pbpb|EYP[wN24lKtf~L^{,[qPFU{:VE2n,o-L=","SaveState_mm3d/z2_castle/1":"ZNCA8P7Nfciv3F}]8Fnpjy7Mjil@f81mz}]xl,BW[nlPjvEGaZt8Gk$C+f{qi,=N!9hVZQ=","SaveState_mm3d/z2_clocktower/1":"ZNCA8h94l+jQ,B1c^3fT3bEoNzD$)S~*goE7^/bj8txh7aiV[6BijdorDq?)OHWt=35EN:=","SaveState_mm3d/z2_danpei/1":"ZNCA8exfD]9Q/FD1Ci*d{RHqAtZpL7dBRHbmic-DhVf,rx(afYIzS~V10$wZJJ|(*Fq3mR=","SaveState_mm3d/z2_danpei2test/1":"ZNCA8Bs,YzhUF+3][2u{OX6TNh,v*{z&L^(koj9?)jrvKsero2e=5wNLE@^RBXS5^U+QZt=","SaveState_mm3d/z2_deku_king/1":"ZNCA8s{!e4G17ufyGlxcAbtq]n1b{|;)$;K-x3WVRqnI;g$ARiJ32o&L++lmFxf!fDDeM==","SaveState_mm3d/z2_dekutes/1":"ZNCA8,sX?6-@z~5WnyA!FS/Z9t!,qUB+j;7ofB+VPtVE1I1z6O9)cw:ZbhenB(Qpr+9WGK=","SaveState_mm3d/z2_doujou/1":"ZNCA8]1(9h@+{Pru5z@9Od3Tq*j/C$YuN&M5{*~gb0)_:JkQ(=r:R((R$RiNuI6_KmF~Zy=","SaveState_mm3d/z2_f01/1":"ZNCA8&4x$QGym]bW6mlXeeGZY_]$j07*C6h7C@Ag~SQWBi5]aZGQVVjoyD=1F0b1JG^VRI=","SaveState_mm3d/z2_f01_b/1":"ZNCA86VVSY[09P:W8s~?{;8y|O/]=dzZE7(n^j|qqgD~B-8S$6TVV99)I{([kAyaX-=3)2=","SaveState_mm3d/z2_f01c/1":"ZNCA83:+Qe7/q|9L-{ZN=~?Tx4nT1e(l;ZRyyR*KsLr=lToe6p!vHuM)PAdbF!Z0GJgMk!=","SaveState_mm3d/z2_f40/1":"ZNCA84,GnvmP2kcggT:E)bA{8sMdssE0{M;DyU3rBUAhUM*lySkCP[,XI+Q{gij|!6Q*H4=","SaveState_mm3d/z2_f41/1":"ZNCA8PD5ipuJK3f,$07UdU7x/uiKmlS+YzT(mkGhj0_=C~}gl8_8uJH2Q~h~dMsOkUM]i@=","SaveState_mm3d/z2_fisherman/1":"ZNCA8UX^30455hc&(3hVE_jTz$BLdyZ{@F[gb*uKobXcsXV?AbZEg*Rk+PGfhI6Acf+=le=","SaveState_mm3d/z2_goron_haka/1":"ZNCA8t9d]CORh2NZ;rd$q*GateNT-CWCA?P0w)P]INCn[Dx$v&1~lF|KAjT6]t/JKp1)ah=","SaveState_mm3d/z2_goronrace/1":"ZNCA8/CB&-fJg1,am^U+MC5EUc)4fDlNgTkRVQEpyBq0hWkziWcDY]HBd_q]8KS,U4Jt4b=","SaveState_mm3d/z2_goronshop/1":"ZNCA8sEj]ih==,qUL$/Pzon&yp1h[Yzf!]!T0C]]/^LE&)CRGD/FXVev2v_1kCAf2M@;}Y=","SaveState_mm3d/z2_hakashita/1":"ZNCA8Q3pe4W67=]k8=XiP@-H]Xq!pqsySI{P{&1lu;avXN$YQ:q/hYUPqzMm,17BUn$O@,=","SaveState_mm3d/z2_hakugin/1":"ZNCA8GYZoSc-bc^Wo;]f,cn^eDq8,IM$uD$gX]|EMQ[hmxYB{NF0v@dkP0KR4!CUCk?AjG=","SaveState_mm3d/z2_hakugin_bs/1":"ZNCA8Lc0Gw!uQpgs)-R@cl_JsH6M{q:LtOD+wgOr9qt8+5CzmH8&QKYiA?[Ea){Z!os1K_=","SaveState_mm3d/z2_ichiba/1":"ZNCA8sP&&;l(V-HAAc],4s0z~XY@h3wA]w*!f}ro2Q&!MBN!d1P&Z-:;BjZ1o|s}6Ng2tw=","SaveState_mm3d/z2_ikana/1":"ZNCA8g{X[m(zTp,3iI]3iYo@Kpw(noY6zwbxDs&6xd$E;O+VZ2M~CSl;[&(Hn)R3ZqLZWt=","SaveState_mm3d/z2_ikanamae/1":"ZNCA8/=p$06utAJX{vZX6)sP7VCOdnGgPx(H/hJ;aoaBexd{i4YRY(sE9cCaMugmdnpRGR=","SaveState_mm3d/z2_ikninside/1":"ZNCA8CV:r~c5485n@}Bu-oeIhs(|q0u?+WN2!~Jg~ua~-5s=5qyCh]9bjvjW-0w_Vkm5::=","SaveState_mm3d/z2_inisie_n/1":"ZNCA8Guz=?xvqTyf@|]T!rfUJ=Dnh]*NZyt]abdQzqtDUVBL)juH?E}?tNbhyU-_^t6Tq?=","SaveState_mm3d/z2_inisie_r/1":"ZNCA8sgK{emUMpsLhed/6rju:mYfCzcrhgJ2VO$e?M&d~~qphU,=xX9Q}uBxKWJ8KNnGv6=","SaveState_mm3d/z2_insidetower/1":"ZNCA86=+MT6vacMg:YRaR7|O9VeL(gKvtS~U:LO!PfV38qnITIbByW2N}:rlEbCc++?WM]=","SaveState_mm3d/z2_kaizoku/1":"ZNCA8X+w6Li88Itr$=&OuM3(u&|2,-bFFdnD=UuffT3qIQ7r(d8=CQs(U5&LCv~{YmNo(o=","SaveState_mm3d/z2_kajiya/1":"ZNCA8fR?:Q4o8SpR~TU6BpW_c,9nqFp&LVhihg^s~Ia)b6|&Dtoz7;nGfA@}emQ;vuZgS2=","SaveState_mm3d/z2_kindan2/1":"ZNCA8SBFguCt:0Fmj3Lr7U31Y!1oBbXZA1LGE0Xu$TgkIft=23:me|B:v&pmR,0y2?}vvx=","SaveState_mm3d/z2_kinsta1/1":"ZNCA8sXj|5_ltSOdNqrH7d^{By5HfSX[|gHF?w-f/Z7l[N~45BM|aRs:GJ&$thhJ=vR9lq=","SaveState_mm3d/z2_koeponarace/1":"ZNCA8@fEN4AW^2=x0zuX]mto]N/P*S$ds:,q8$IV6|SD$uV1P9=T,g/1WK/:c&MI/Yfyy+=","SaveState_mm3d/z2_koeponarace/2":"ZNCA8O7@Ny*JqP~Pzkbq2GDq9U{sAn6r3B1igAGf5^1gicNm9n{Gn~Xt]BiH_{h~Pq;@xH=","SaveState_mm3d/z2_konpeki_ent/1":"ZNCA8xolGmSSng^CbDjTP4$elr[oSAjF=ECxHxC*0a^HxqhN&4M{9p;eKWlPMaV;gv[8-C=","SaveState_mm3d/z2_kyojinnoma/1":"ZNCA8bLmwK0IFV&o@W4Tc8jqYTvNk;XYhmaHT*DCI)Szh[iGIEJ[5UH6LwpnTor5U*=~?y=","SaveState_mm3d/z2_labo/1":"ZNCA8ahO7OjNA0=s+qZ~m8w7m[:UtQ&}yuh)V/E~yzP=zzl+g}_A(uqpg=Y/2(J($z&2z:=","SaveState_mm3d/z2_last_bs/1":"ZNCA8We6BOocU^|Xu7enVwAY{Ax:F}y=q$0Pg0|dsm!m|cbcjN*gn!4oJA@vI!ENT@sZds=","SaveState_mm3d/z2_last_deku/1":"ZNCA82M:8A[i{C]+-erruE-C|nrxwh5Ng1GEiHTjT=-i+VYHU|RFh$[i@8QNiZ[H8E*H0c=","SaveState_mm3d/z2_last_goron/1":"ZNCA8DD@,L+?k1Hvq82TYgBXrdlAcq]Fn}tFVA3W[CpfwXID}Q/uc3;n,Ip/J=fIiVTuTc=","SaveState_mm3d/z2_last_link/1":"ZNCA86t}$IQVB$]sF9PhYWx0cgDI9^VqWm/lxb)P+c_nI+E+j~xCtJCJpPw]xw{^B0q82k=","SaveState_mm3d/z2_last_zora/1":"ZNCA8I2/V0N~P~h;IfO~cZEZNG5/:ExV[y9t{S21{e82t(hwnnkjPW)yDMpcwR+Bvb+l~N=","SaveState_mm3d/z2_lost_woods/1":"ZNCA8kV*^_kUI=kefqcn3TPptsv$g]~a4Kgqfu0AkD}cF,r4lS7PmGdgWqj?C4@Q6-s~v*=","SaveState_mm3d/z2_map_shop/1":"ZNCA8p9fr@uZLX2-+IM^ftUdRrnZX5Y^19~VefbWECz)KU,PGA*/p6+7pO&)7jrQqOfUHb=","SaveState_mm3d/z2_milk_bar/1":"ZNCA8p@GAZL$yUCgq:fF-I(gYpy=wo~wCVgzz}]/L6t1|u,IE=(9)Y[3vLV[e?&bqEdKp)=","SaveState_mm3d/z2_miturin/1":"ZNCA8l1AH*e,5|n61E^!f:HLS=r~nWurz,*ZsuYEN0j-S;nAH{nUc9/IBw4B!:Oe]*K3Zn=","SaveState_mm3d/z2_miturin_bs/1":"ZNCA8aERLrGKx[GKQo1B=dGKvx1?::~gp&qj1~@M+6n375cf5ab6;,^DSy/f;lniB)(@zG=","SaveState_mm3d/z2_musichouse/1":"ZNCA8r_kBJQrTdE2q[bGJ-Xnz9si3EE3sXT/&qS8-ur184Pbz1?Vn(h!&f!!tjk~(]hT$/=","SaveState_mm3d/z2_okujou/1":"ZNCA8mzP)7Vg7wH~XiVzcKi,lDdcSi&mjVB0G,MPn2v15[b9j],u)(KT9Z:}2AL/4WumYK=","SaveState_mm3d/z2_omoya/1":"ZNCA8aU67!?}vCddb5EtEKSUSZO;:haHVu[v-m(k[GMw$A-gL9l}eDSV@W_8Y*|blu9-OX=","SaveState_mm3d/z2_openingdan/1":"ZNCA8lw$KHyRLl00*K$:OTH9p~YSNEkG^E36nQrz:plOU]{?[XoaIM-=_@})J&TNxmXh-a=","SaveState_mm3d/z2_pirate/1":"ZNCA8b&}!p++w|7qN4aReso)iEi8z8q4]DP+8ks1JrB{Y?(eV{,]4K+]]j$ozvOm8uebJw=","SaveState_mm3d/z2_posthouse/1":"ZNCA8&V8w*MM0k)gS$l+m?gZ*tHsWQ(EqRQ&b&j=z!nO3?Ppz41+l2ICku+0}U6!4n0U@i=","SaveState_mm3d/z2_random/1":"ZNCA8(K__M@+cZm![(7/tGYA7Ie9ZU04dd(CL3Bafu}zJecuuX3;rk8ly6[OUs:;w2|$=_=","SaveState_mm3d/z2_redead/1":"ZNCA8X{$u0XqPMj$rDV=TGA~l:/nC@3xR/~wiILm/MT)/NMhdxp@&z*Ny!4soDCQO0uqNP=","SaveState_mm3d/z2_romanymae/1":"ZNCA83W/M|xc]7ZDeDh/uDvw:{e46:3~(HY;mR3BIt!NKfnW?,lhI@:dgGA7-RCJ}?_Fy[=","SaveState_mm3d/z2_sea/1":"ZNCA8amU_Y4fabT,B69E_67KmS+5pdLLvuraaeExORc3^NB6Hcy2HsDdXTJuO{}WEQ@)zt=","SaveState_mm3d/z2_sea_bs/1":"ZNCA8BUaxFFk4SEDc:UwJbOL,3POz&Mt,JL6Pr@dpZbpgbe4NK8{KYUaH35d{NeByAx$VC=","SaveState_mm3d/z2_secom/1":"ZNCA80S0qm:[~;|b(/n^+IlRX(bubiU@BW|RgGu,k~X]dV49QCIRr?^X3LNoGk7@QIoPEJ=","SaveState_mm3d/z2_sinkai/1":"ZNCA8gynY5=7tZ+Zex/I_ojeFt==}TN&}Aq!)d;4{h,(YxX^1$-ZJX2BrBo8k}$tT,Ai*A=","SaveState_mm3d/z2_sonchonoie/1":"ZNCA8+pln?8f1G~[A$hU6;!r2Az];2(MPcD[&78fWYv$d)Z(^8w]YgBVknP7K7VYRGvcWQ=","SaveState_mm3d/z2_sonchonoie/2":"ZNCA8=wkk|fOQLj!$r~LG1EJnHTGwOu&0o+iFQ}}qPhqHg9,tG)W_3GkS|8]4@of{3[j+z=","SaveState_mm3d/z2_sougen/1":"ZNCA8B3=UCcm?d~2/xe5:ppCrVTaNN1^ezq_=xhdaO9b_2Pvbcj;THJGXP}7a8/Vqj1_T5=","SaveState_mm3d/z2_syateki_mizu/1":"ZNCA8vNd]QQMDQY]xeygV/xW1N[{nicMTkK,x3PGmi@,aRH(FAVoy3&+FT2WDBTnR1Tm/|=","SaveState_mm3d/z2_syateki_mori/1":"ZNCA8KS(WK;lD]SXNoQVotx3_&+k!0OZJcQ1ae4,x!7dpfNq0sn$W5Yq8~jrK$=8G:A4Zr=","SaveState_mm3d/z2_takarakuji/1":"ZNCA8ljwf|/Dz*np$xtvPmU2*N![atr]{;,j8+@g$!sNnu(RNl+a&LDa&GSrvcUxb/w01-=","SaveState_mm3d/z2_takaraya/1":"ZNCA8Fe9rz4VL(9[)[gr5oQ8},/0)F4SzO$/a6*&G2g!Tv;Ej(E_KB=1,x*G3X=]p?^Gu$=","SaveState_mm3d/z2_tenmon_dai/1":"ZNCA8(^,^B=HZQ^M_$rSLkK{xP]|__+lu6RgQaHy(~H**{@a(R&!O,Ln(d^42g3VQb2D=G=","SaveState_mm3d/z2_toride/1":"ZNCA8SH75&NxXxAzreo2ZD5eIz]i0Xdqx-a@kq:okQT6Nm^*-qiZOWsyZ;:jxL[OA9_g9I=","SaveState_mm3d/z2_tougites/1":"ZNCA8xY|yc,Jqs}+kS]&Sh&tqs$l2{0)U,6(}FP)IPBK[K|3t|~=AmZQqY)5KLRZQuZhkE=","SaveState_mm3d/z2_town/1":"ZNCA8~Kouk66spKD!&@Dm7//F0FHww)N4u[rY^f&SV?:&b=3bPgz?woc9*2r~t[7,m(XSu=","SaveState_mm3d/z2_witch_shop/1":"ZNCA83{{n@8TddWg)?Ar$3TnZi]sX9d)7&$WBGjnTHQea=UNJ(AVBl!]-y7$FX42Z0@z)4=","SaveState_mm3d/z2_yadoya/1":"ZNCA8eYA9T)MzUF?!c,S3xXUYIwD@P[n,T&lh=Sc_)s$iBlI0/E-pK[xRrzeqQm3r]~$Tu=","SaveState_mm3d/z2_yousei_izumi/1":"ZNCA8w-jte[!McQ7!@DKeE?bFBcL~!7l!Zlh+@]{qPhqHr7R[6yFv5ntc^qQ)i)9(;!!,1=","SaveState_smg/AstroGalaxy/1":"AAZFwy91DNh8,cMVT^mS[WlYp-4:5DPUpXzeT?v&BV(;PL9KRE)T_5EO9q(E/=2e","SaveState_smg/DayInTheLifeOfALuma/1":"AALFjrUk-{:9O-C0UZZ5kWgza!QT$;[Ut|CRUF[t$WG,p792L&j9RmaLUakRE=bD","SaveState_smg/BattleShipGalaxy/1":"ZNCA8y~4cTGy||,Dv0PYr3Zr_*k=Ab7]o!D/DTCtsG~@^YyJudxL{~9k0CCXkqGH&=lq[zAA=","SaveState_smg/BattleShipGalaxy/2":"ZNCA8tGl:jGG9NlD(}^(Q8G}Tc~_f/69VC[Wln2royx/k&Ei|0sBKb1pH7Y(3^:bS!]-bgAb=","SaveState_smg/BattleShipGalaxy/3":"ZNCA8e/|t}!e!~A=|AOyKgxP{vVa(lq(Wtaza:GBe|-0l(GD8z_K3arKPggv~pMg?:?W:SBY=","SaveState_smg/BeltConveyerExGalaxy/1":"ZNCA8ErGlYnN!W+I5_:4IVlZ8MzUpx!}nOX[46LOwYc|Kr5@A@?$-H5Rj[:(tG/wO(BnsfAA=","SaveState_smg/BeltConveyerExGalaxy/2":"ZNCA8,W!?Er-kM;PB/iRn!wgJ1w;^ox1OGj[UrKOxIzc({1]5D-)aYa[{Byl[}Cqp$/8kcAA=","SaveState_smg/BeltConveyerExGalaxy/3":"ZNCA8UG];T*OS}86PpPl73WJmFLs4+}I8gbQdxZgqs}~&s[m*q+;}b04XR}3V29*W8/U^kAA=","SaveState_smg/BreakDownPlanetGalaxy/1":"ZNCA87(UFs8Kp/i!+*!~Xz{E:C/L+L9*IXJ09jeRl82^z=@uI()14Ma;4Dz[(4vJFMgBPmAA=","SaveState_smg/CannonFleetGalaxy/1":"ZNCA8)kfuqjYu,sWK+!R9|Zn3ITNUfnQNVM8Q6qXB+0Q:3zU|Fys[j@=Mj1vcmFYg{mJB,AA=","SaveState_smg/CannonFleetGalaxy/2":"ZNCA80THDxrKl][k~j,;Jf]MW2/,imw@Z1^@wwU{o2GG;g,A!lUDrT,;gbW]WBw,CoR82XAb=","SaveState_smg/CannonFleetGalaxy/3":"ZNCA8ylKb/k&uiJi]_GwDI1I)XX;3sR!uJ/-NV:KPu]DJ$W|p;Rq]j8Xw2s;&,sH[:QR|@BY=","SaveState_smg/CocoonExGalaxy/1":"ZNCA8a9g@lNB5&TP(LG25mmFHXzWD-:bT_P5KUDhBn;rHU8hkX)*45pZ{yTH4Bb_CxU^AsAA=","SaveState_smg/CocoonExGalaxy/2":"ZNCA8=mR&z]_C;TFG~)j20Z8[-F4a!37TrKws_p9BBIRz;[Fu1Zd:yYBX7eppGPr6J=yhjAA=","SaveState_smg/CosmosGardenGalaxy/1":"ZNCA87vHHaCA_)p@b|@HIocR(?N02j,PH*NB@yO;_pBJi{VOLO5+7oFlwsF:tNu+~dkOCcAA=","SaveState_smg/CosmosGardenGalaxy/2":"ZNCA8N898-c:lf^d2ijAAS~XURm(VA$9{E)EK~&!-sE:f(~88uj~;[eXKVv&JoR!(i*!bJAA=","SaveState_smg/CosmosGardenGalaxy/3":"ZNCA8q*569qS,j5@,}LRRQFMVq0Ju}ldqX?Ya^a=XY-+]mo_}~rRZ5]HpM-G_d4qKfHJX4Ab=","SaveState_smg/CubeBubbleExLv1Galaxy/1":"ZNCA8_OsZ@@XX7UDx+zQ3Zc|~G{mGv7}b=PAp;SrKo6R+YJ75]n:(KP7gkIor^U9KNu~49AA=","SaveState_smg/CubeBubbleExLv2Galaxy/1":"ZNCA8lREGW5qUQwYhfk+0w@@)A^!0LRGRE:{)|Q*&s5@CbucOj_@?2Px|VTK=t2JE?Jj^rAA=","SaveState_smg/EggStarGalaxy/1":"ZNCA82DF5jwzhBpdzJ32CtP_[(Zx)OR^^}+*00G584TsTri,I3:pXEEs7Cw)]CZ:bq0LkxAA=","SaveState_smg/EggStarGalaxy/2":"ZNCA8DCoTmO+3C9Deq)*R-1:yh&0N?L||;xQoefu[,X=}}QF=8Abf4_vB7GsVAe(h*wHHlAb=","SaveState_smg/EggStarGalaxy/3":"ZNCA8vUR99]s!BCsv^E/J{k9:?wo0U(__nrI/,{}WUwm2+syYRJ[w*dx35b@y1Z,h}DoNUBY=","SaveState_smg/EggStarGalaxy/4":"ZNCA8y7[DSJHkVM=0OX?sWN$^-FNbI8(d9@mU$E1a7Txi2?f@7Dl_tBuzyGUe*Ag)1e:$1AA=","SaveState_smg/FactoryGalaxy/1":"ZNCA8f}w:C;^J0yn]sibxu3x:mifB?y)(*O5{*~ge?K/&kEoUgA@u8SgX+$]wVQMS;p}eUAA=","SaveState_smg/FactoryGalaxy/2":"ZNCA8oP;yBsq2I:X*EBNXXOfk0rh;WBzpLBHT*DC[!w0S0g^kKpC[(eBotVGGKf^Miye0JAb=","SaveState_smg/FactoryGalaxy/3":"ZNCA8z=2|f-$Z(s_h;(1pUE:=S9irB1G7uW4su9$inhV()f(i$!vjf!mDh/ZDw+R]MAnRnBY=","SaveState_smg/FishTunnelGalaxy/1":"ZNCA80SK$2_jGH+t?)_5v|*+DOX^zp)nzB?$2S?giBIAG;m?6CbfE^Z=9:+0c5qsoWMz&IAA=","SaveState_smg/FishTunnelGalaxy/2":"ZNCA86hgBuy_Kb)b-x9pA0Iy5g@Et)K3XRY2U}Sp$1V=JzxCS5!1/FU==KE(jjbjD0=MTEAA=","SaveState_smg/FlipPanelExGalaxy/1":"ZNCA8WbL@QyWIVN13ZZ*0Wc|ia6Uz3O7(]@ET5S59af5ru&^02e]P(vzQaENzg~Bp~FJ9tAA=","SaveState_smg/FloaterOtaKingGalaxy/1":"ZNCA8/p,)CC5m;Of(5le}VwWd3$K&Wil^G8Irn[{YOpH8?p7=q~,V2^z6vD|=1uraYp3KnAA=","SaveState_smg/HeavenlyBeachGalaxy/1":"ZNCA8t*Y|2+M1Wq=fwjrokx-Z2p!/I/v2Xem_hutppRbvL_,@4)F0d]f,9vEJAZcpu{[-yAA=","SaveState_smg/HeavenlyBeachGalaxy/2":"ZNCA8Y!W3a1}FN,gr]K7Zlj7}]CSop&p}XZhhusHX(XqQNGU:IX41($_*bse/KWFIq*&0:Ab=","SaveState_smg/HeavenlyBeachGalaxy/3":"ZNCA8Ce&!WWh0L_zKQAn0&e&,0q5h[icK,eGyZ/A(5ask!4CGex?mAs00l0kR-Q+Yz8?E|BY=","SaveState_smg/HeavensDoorGalaxy/1":"ZNCA84px7d~gg)P]cWU(o6?5pHG0S|20sQb)33-2@;WRVLx^5tHh5CAUX?12?I6]Z~&S0AAb=","SaveState_smg/HeavensDoorGalaxy/2":"ZNCA8=8/?GYnnfSo@H}!y=jSVFQ8nyDCWxYgA1lJkMK{f(d3q(k~IjT_;B,2znVLN00yr~AA=","SaveState_smg/HellProminenceGalaxy/1":"ZNCA8/EKhB3R(ts3T7hH0qIQ*a/8!6?Nxk1}QSyhd)r34+hnMw!|0uyE^1riM+CViIz|hXAA=","SaveState_smg/HellProminenceGalaxy/2":"ZNCA8eIe/4v@)z3Jn:5SRJv+c{_=(ryz]RCI!NudUZ2UbIXuCLI76gOgD2s00cmTZM6cT7AA=","SaveState_smg/HoneyBeeExGalaxy/1":"ZNCA8ok)aVkG;1QgY?&FEKQyO0vjEw9sdrN+VFFq6(|]2KZ4IXc_bY64w!*|VWV7YjCx}WAA=","SaveState_smg/HoneyBeeKingdomGalaxy/1":"ZNCA8]gADy=T/f4uUD}FkAjha8CD7tOdAz6+Iw)O&bhvNiBU@*De?o(wyc[fqI8)2@/idbAA=","SaveState_smg/HoneyBeeKingdomGalaxy/3":"ZNCA8C-1@]$$fHdK61cJbIMZziBGZzOQmjdg+sL/zf/FJPJ$Vqwg~K-=7g$0_5-xD(of_^AA=","SaveState_smg/HoneyBeeKingdomGalaxy/4":"ZNCA8qw--*&p[JFNbHh+o6dQg_q,S?OFSU8&}u1_0[jp6B{ZYPpm]^TxgQ|bM0yUGY*(miA2=","SaveState_smg/HoneyBeeKingdomGalaxy/5":"ZNCA8jdQmQRq^0jo7yRwhY6Rn)j?X&z-ElBl2^R|V*X}*]CuOPEv+!:crtze&DzrY9fi3QAb=","SaveState_smg/IceVolcanoGalaxy/1":"ZNCA86*uF5GLtm?X*4Ck:WnTQw9SJfMzLe/p6h?[a)m4Tm26=s4uKUTH?)-^Hux{Epwq83AA=","SaveState_smg/IceVolcanoGalaxy/2":"ZNCA8otM0JX1z3p&acz:~WB)4;ho71[4xmL&{yX-I1@?Y7_kRlL&aQ_Z;GJt{ss^}8:1/3Ab=","SaveState_smg/IceVolcanoGalaxy/3":"ZNCA8,kLd-u;gNLRyFH,uEul2?Knn!]^g&;5$9g~_*FnsAny!h[}z|j@yT~l/@RB4q]IEMAA=","SaveState_smg/KoopaBattleVs1Galaxy/1":"ZNCA8*)kFqosV[/dNF:!$B95:L@xM:+_tGkI7EJ3?~[Y/~&/dQT&|Uzc{rawu92O$3P:rpAA=","SaveState_smg/KoopaBattleVs2Galaxy/1":"ZNCA8snypE3zi8DxjT4ipC3|+7_7jM;BiyUg^/gl7aXsl*=ekA9wG?5vO]DI:qs;q]r_[dAA=","SaveState_smg/KoopaBattleVs2Galaxy/2":"ZNCA8;{yexyds8bhC/VE$[L{zh5tJvb1H^DE(6uV?g[NuV(Yk=Wv~MtsC4SF$/dTgd37q4AA=","SaveState_smg/KoopaBattleVs3Galaxy/1":"ZNCA8u2]G=u+:7J&ci(d4RP(N5xWf),mFw^rB)[YYY_Tm@x?:w*pD}VLiAaHpruBEN7K}3AA=","SaveState_smg/KoopaBattleVs3Galaxy/2":"ZNCA8)]+3F3{2[$N^mbOe9U=p2sQ|W$x$EI7m0?f8fpR?g^nCKlM*FV=m;Lz9ItjF)]bJUAA=","SaveState_smg/KoopaJrShipLv1Galaxy/1":"ZNCA8vhTkP8sy+(ar-jW(IJy(*)DSuZ4t/&JbQQnk/sskYDWeLI}+);3)UYn/Skq3OsFP~AA=","SaveState_smg/OceanFloaterLandGalaxy/1":"ZNCA8f_7$)!mntWA&{oj;u)nb=*8:M5NukNVYGk4wU8Y12vJxmo&/z]pZv3F7vL!X1kDwyAA=","SaveState_smg/OceanFloaterLandGalaxy/2":"ZNCA8ShUFup?E}NY@mn8EV-an=[K?_A4Z?0Wn40yZiz{8,FW[1Uob**1gYJkGLppr+j$bdAA=","SaveState_smg/OceanPhantomCaveGalaxy/1":"ZNCA8?|U(C*IwfL+H)/P/9f{UMDFx{g/[P_R,_j$KF&l;)c9Sq_,Cdhi)[Q=nKZ=J6wQ4VAA=","SaveState_smg/OceanPhantomCaveGalaxy/2":"ZNCA8p3di?a}~Eq,/M80yf,Xj0:QP-gBu7*SCxGM?N(sksX1dgm4^HY?Sim&7:t[A2hM{|Ab=","SaveState_smg/OceanRingGalaxy/1":"ZNCA8X7b4p(7wBr(|{j{lKy-GbfPN-RZ$&){8CY[8rBXX?HYKJ7]?Q-({+Qz*]k;-H$K_:AA=","SaveState_smg/OceanRingGalaxy/2":"ZNCA8x,2S)xP2]4wSa!zo1Rvi]70@IxB+GY(q$3-)n@YSKwz-*BmiD)c/hA7h:koa,@yVHBY=","SaveState_smg/PeachCastleFinalGalaxy/1":"ZNCA83QNu[e55zcY2v@e5=M|[soxp$iZ9-0[,hwUkWb=Nx+j=[~H2W79Rf{H7c3D@!U9oKAA=","SaveState_smg/PeachCastleGardenGalaxy/1":"ZNCA8GMu1xL7f[2Kk~^+?gF:s(PS6xJVXoh_I*PbgzIkq1RobE7XmG1pXUyL!VoPQ([R1(AA=","SaveState_smg/PhantomGalaxy/1":"ZNCA8160lW=Pdv97!/s{0c{}bV:_mjXySYHWchsoW*B1mK|4N9pju;s$58-{$Ttu{9R5&YAA=","SaveState_smg/PhantomGalaxy/2":"ZNCA8/HjT)DDQKDQL&y=tM*XS&h[C!,:tEx=06*STkf+@y97c&8oP9i+K/]!d4;?j@s-1HA{=","SaveState_smg/PhantomGalaxy/3":"ZNCA8f-{Z~C;+noqB{RZ~_:C[kd1b/oayrPwyt&vpyfw;XJbK2]R]7x&*6MK3O6ZLX_TC&Ab=","SaveState_smg/ReverseKingdomGalaxy/1":"ZNCA8lDE{l-$}fWGmI7KvaquNc/I/VxllrNXR^F+ca)8$=1*QFU83Pkka77Nxx+V607!=VAA=","SaveState_smg/ReverseKingdomGalaxy/2":"ZNCA85+,Ul_TYoXyYEf~e)/J@:rvMwq),p3pHNc6jUyBR;o2e+T=6?!gz7b(dniT2$v56;A2=","SaveState_smg/ReverseKingdomGalaxy/3":"ZNCA8My-TlzLF^$!I,?2:~jk$nh5=lN5EYVdj:4[cHwsbAj|/j1?6ls8+JuV$r/&9&@mK+Bz=","SaveState_smg/ReverseKingdomGalaxy/4":"ZNCA8mO=GJ[v(6^@$n:]Df~zs[_QM;5yeTDB&5@C?IZ=:hU~GVIwZt;NDGmGjviwH!9LQtAb=","SaveState_smg/SandClockGalaxy/1":"ZNCA8+41+xyMP=&KegllRq2tl,8N|kLw?;;-ow$LOWx0F!_&kl0cBnz:UMz@/k6K?M4]&*AA=","SaveState_smg/SandClockGalaxy/2":"ZNCA8_h*=RDX]+KQ-ZlTz7jQ,{mIlHtHWz~wy3Ey:~QI}[bFX=~e^o[B&rUMII]hZk*bfFA2=","SaveState_smg/SandClockGalaxy/3":"ZNCA8U}]D$K{XD5}UiTmE_419QqC}oZcEW!5prD)v2n0&0M0Po_tJqykvI!n7[x4@__2MlAA=","SaveState_smg/SkullSharkGalaxy/1":"ZNCA8zL^=5m9cvp4~Q~qMw;U6Gu]1vJ9KLeYZZX(gS],[C?__ZztV*Vur;66wv3?6RtuqsAA=","SaveState_smg/SkullSharkGalaxy/2":"ZNCA8:(_e}{,r*BU9d8Q;FR;9M3*=|nwz!IPAYT5ReYrYg;n0+(3U0uW-,&FZ{v-,jnK1kAA=","SaveState_smg/SnowCapsuleGalaxy/1":"ZNCA8AzJJV7-?U_5;E,T2@/3OtD{X15mR&-q70=Xa]bFDtXb1-HVZ3jGmbX;l@f|y0_:pcAA=","SaveState_smg/StarDustGalaxy/1":"ZNCA8L|_)kP:!Sr+DG@xmK2RMs5E5;w0I9^d7&/wYiAMw!?;=hsAgq_s^XTfm/dmX~TrZXAA=","SaveState_smg/StarDustGalaxy/2":"ZNCA8S)cZsWPUyY7t)dSdmAhP?&Dk/z7IwY0Qg0XHsC~*bzwY84N!xGe]fQ0H&=[w-wEt_Ab=","SaveState_smg/StarDustGalaxy/3":"ZNCA8cSpVqQl:nQul8|:kCUK6=KA,M?1rX^4q*y7yO{?aBi/MJA^fu&99Z}&,$Ak&_kNQ$A2=","SaveState_smg/StarDustGalaxy/4":"ZNCA8S$CMOkC)C-z1eLU}MeUfRY:fXuHY8hOwxe,8Ru&1ck[we/=O{DMpQO/Pcj[_3d&h!BY=","SaveState_smg/SurfingLv1Galaxy/1":"ZNCA8KvcW|BD!N,h/!m()!X0(SY&C()QIKp1D+nSnbUs4Rcp]7tQ}~naZTv[6N[x(r^!zlAA=","SaveState_smg/SurfingLv1Galaxy/2":"ZNCA8m+}EIC8K7Ag65[}T5XG5bIkP2u:-Z*llglAqw0[[yvH(9i*4+e9^Fh7:S[&p]f@wwAA=","SaveState_smg/SurfingLv2Galaxy/1":"ZNCA85$mPUIQtL5zx*)T~f4WR9G9kCPS~;4IeT@kofC6vwm1wrcvOLbzfl6?{:K{Wc?M{cAA=","SaveState_smg/TamakoroExLv1Galaxy/1":"ZNCA8{$&ss?m(Ac1k7Jk+KK/m-ersQQe{rMn6z,{)+/4LRc~!^JJ-NfKc-!_A}Sax6cKK0AA=","SaveState_smg/TamakoroExLv2Galaxy/1":"ZNCA83x_-t86o1QR}bnd=2p/|:smdg]9*imRiJwTWbJJL,rO|mm=|*b5MJmaNJ{xf6jSvoAA=","SaveState_smg/TearDropGalaxy/1":"ZNCA8QFX]9i8CM:Wg;6C2agJ6w;mDsZNQFm7I/91;mhpXigK_^GI_k;NHeDZ)J9G45{$rsAA=","SaveState_smg/TeresaMario2DGalaxy/1":"ZNCA8?eHO4:[7Pl8RTgqlIK/@Y^o)?:sSsFARu6CP;O+3clB)0A+:C;4b[^bF&iI/X7z/mAA=","SaveState_smg/TeresaMario2DGalaxy/2":"ZNCA80ECt=$rS_&xYghPopH|DoBUab8(}_pYT=bSARK}NnOc@NA8&}|t?ZTGjJ1p&b^;XPAA=","SaveState_smg/TransformationExGalaxy/1":"ZNCA8=*N*2KZ228SSQx!Q|m/jMi5oE~&@UV@&&@Vn)ES~RL_;[[MOh?!^j3Qajkj76,O{PAA=","SaveState_smg/TransformationExGalaxy/2":"ZNCA8;UK]!e9eBFK;VY5rIb=tM}DfXO(1[XztVsKcysChm*K;frtnjMnug[oByxHI9kC3PAA=","SaveState_smg/TransformationExGalaxy/3":"ZNCA8j$&l&z&ef64RG)4,sEx4wRog*8UXGVX((OeA~j@AFj-n2thf4WF~dWly2DZ3/9cjNAA=","SaveState_smg/TriLegLv1Galaxy/1":"ZNCA81_l=*2Z*kA?0eazqKQC5ec/c5t:QPCE{MRt-fs8TxUpLY99[*Bul8167^!(XuY$HBAA=","SaveState_smg2/AbekobeGalaxy/1":"ZNCA8cnZV]-X92xRj,s:v*vJ48,X=nAADuxnjC-v17beAOix5[K-5R7h_u:,N7sX0aEFWsAA=","SaveState_smg2/AbekobeGalaxy/2":"ZNCA82GXG];mKs3a_YD7l/U}rCE}:vAUuuaX,KAEtQJM}hm?itwKH;nVh}}uEpUMW32}SEAA=","SaveState_smg2/AbekobeGalaxy/3":"ZNCA8EQY}k*Cd?NA9bUY)H3BMJ{tQ6AAC|i;)R-PsCR,;cZs2K/p]4Gu(G-j8$UI!a=rKTAA=","SaveState_smg2/AbekobeGalaxy/4":"ZNCA8[O42mwYdX=Kw_{G,IT2MU5&YSAADwHi|J+)xbtBEqA:A{XLnwK$7OzFTfF?4{GG)lAA=","SaveState_smg2/AbekobeGalaxy/5":"ZNCA8kkP@p,RtR2$UV$_7tx]h{p+^eAAHJXWwd[8otE=d2@YkjvKhtwla-19EVF=C;bfZPAA=","SaveState_smg2/AbekobeGalaxy/6":"ZNCA8[Qo&54qZ;ATgf{vbmWZy6b/GaAACXOTcTC!Rl;Yh$tF^Q!y|[2?LTphGuujmmZAfQAA=","SaveState_smg2/AncientExcavationGalaxy/1":"ZNCA8:lhNNjszhA];8Eg$rIvB;}nq4AAHVZO1XlYN=G&GnR]|,sj;A[pACzDn95Aeh0om!AA=","SaveState_smg2/AncientExcavationGalaxy/2":"ZNCA83&StISwevUx)bXR0@9k+:t86sAAGP{BT*{,~|oyw~:cOoad1!2~Z2X76ER1PQ4-4HAA=","SaveState_smg2/AncientExcavationGalaxy/3":"ZNCA8v*A+m/mk1OgpOwa3DT*l{;uDSAAE)E/&qS8;94A]ajvO[,yb$Tgl~5St|C+:!/*oFAA=","SaveState_smg2/AncientExcavationGalaxy/4":"ZNCA8:lhNNjszhA];8Eg$rIvB;}nq4AAHVZO1XlYN=G&GnR]|,sj;A[pACzDn95Aeh0om!Ab=","SaveState_smg2/BigGalaxy/1":"ZNCA8OtbwAf~NAKh5H|IX6*uQ9VFPPAG?A/W~N6BEEYy}K[GrVKsZnVkz!xotaTUxRQjs$AA=","SaveState_smg2/BigGalaxy/2":"ZNCA8aNqp*{1a]jMu96G,6y/L7KEBAAAH5mVg7wH-1CYEhZB0|gl|fY)53f(If1A0KJK;3AA=","SaveState_smg2/BigTree2Galaxy/1":"ZNCA8pMvfTSJ/*}9JHLE?vr[pl4^nxAUqA/$7vZ*_)-{FR*1LAehv{Xx}DD]@$s~Eec/~dAA=","SaveState_smg2/BigTree2Galaxy/2":"ZNCA8~UrBp@}$gf;,w5DTSGYkcYmgcAAH;A0eM7,}IQu(-2|T9E|$D5B_M@iw:NH*5YZefAb=","SaveState_smg2/BigTree2Galaxy/3":"ZNCA8KX4c{Uo))R=_^sz9svTQN-n/cAAH3{ppZZT$2)hpr:4u?A5vhOP:b;_h:HfM&!Dm|Ab=","SaveState_smg2/BigWaterFallGalaxy/1":"ZNCA82U,*ur{l9JqV=LKV{^hT_|4kRAKV!&Abf3WKOq}-K__P6P[)hraw5B,v~W^V1OMhLAA=","SaveState_smg2/BigWaterFallGalaxy/2":"ZNCA8PzA*km;3ysYbuZco;wor{$8YTAAF~c&0@/mx=jh@$bdY(7q_PeP-z?x8hGI4:&i@HAA=","SaveState_smg2/ChallengeGliderGalaxy/1":"ZNCA8]T@jiQI4lG=@$miM~WArK7lczAN7$8rKocO[S~0raDCSZ&yZ4OT=EHRkqT]B@K:L]AA=","SaveState_smg2/ChallengeGliderGalaxy/2":"ZNCA8k-hvz!xoMj,y+(dfD@9&aQvJFAAG/M::?bfW{@&AD1qgnhSz+}zId7Hq)^-en5H[TAA=","SaveState_smg2/ChallengeGliderGalaxy/3":"ZNCA8P6QjLEL,E/4)*E=+@b0XA:k4iAAFKzJ4s}oeCqA$*?$*=gi;EsDhA5x9at^XwH&eBAA=","SaveState_smg2/ChallengeGliderGalaxy/4":"ZNCA84ny:X1(QLtRzCHA;y:qU]jIT*AX{6O!+y|&:]5yL[fMYoIb]X^DQe5=v9|aqmn?zpAA=","SaveState_smg2/ChaosGravityGalaxy/1":"ZNCA8S^X5JoM!$J{~S1-Jga&Lu8E2ZAG[6$6!g@EBoUzhoj,{gY+t|t}Pg/?i]*d0X&FwKAA=","SaveState_smg2/ChaosGravityGalaxy/2":"ZNCA8PoNkLoM!$J{~S1-Jga&LN^1sbAG[6$6!g@EBoUzhjGS,YY+t|t}Pg/?i]*d0++*z;AA=","SaveState_smg2/ChaosGravityGalaxy/3":"ZNCA8PRAGx&v=wFoDHFWHLrmI3sd^qAAI*@+Iw)O{~]Db_7TiwXLf+s+*h,J5j9]ao-V_cAA=","SaveState_smg2/ChildRoomGalaxy/1":"ZNCA8MR4Xm/tWxFOse_PJQ2JyuwUf~AAA@POALSkh2~^t9hVg8FX:wjBR=h|Mv04;~[4EbAA=","SaveState_smg2/CloudGardenGalaxy/1":"ZNCA8nc^7cPYi2oBpL+NYl~8bF[EmnAAE?q;uB-ssr1J4$/!V8kSf]LP*-^qH|b}^[GtX]AA=","SaveState_smg2/CloudGardenGalaxy/2":"ZNCA8KQi2QU1C^EbV/hUy{S[/w0jB|AAFi6@!C^*OpXO^sFjch8y$H6M3_:$nWa^8,0((9AA=","SaveState_smg2/CloudGardenGalaxy/3":"ZNCA8[}vYpL(q{v9AYOQ5_Mfy;6myBAUwNe~=Df_Nf&icS$zVjdN]^E-Y&(4J^pVof{T4IAb=","SaveState_smg2/DigMineGalaxy/1":"ZNCA8tMs)Kc+Yqz&znbk7567u8OgS6AAI3Y(=81JpX8acOinEcB~A{[cg9mP+/cED(ZkV2AA=","SaveState_smg2/DimensionBigCastleGalaxy/1":"ZNCA8]o61?z+G2}c}]gXO{[JP?B@FeAABU/XUl0|KDsXerysip)p3cg[[sTyPXQ=aiw]wkAA=","SaveState_smg2/DimensionBigCastleGalaxy/2":"ZNCA8PA^!{y&tEL@DBATKl0tOc(litAAEt&fD5KGr[,q3Du_!7w1|TztX6Nb;!55us]LRuAA=","SaveState_smg2/DimensionBigCastleGalaxy/3":"ZNCA8z^pYro;m~;m)P67VAd@z$,|GnAADKl]RnlRxj(l)2oaZ)9divMg+_UaN(&4)!EFE~AA=","SaveState_smg2/DimensionBigCastleGalaxy/4":"ZNCA8/c$~kW|_&olMaplT3$Fb[?:OzAAEjfK0{=9,5=y2$Gt~88jOM_-!!uW2(W_4_3;*1AA=","SaveState_smg2/DimensionBigCastleGalaxy/5":"ZNCA8R}1476b,:1W9EFBPe0hQG/wQ|AAAAgr7L)3w1zpFaO6U/hzzj82IUE4GAeEXH?HyLAA=","SaveState_smg2/DimensionBigCastleGalaxy/6":"ZNCA8NqQs-on4eOGOC4X_&glbR?Np]AAG;2Q4$ihpU7h]]^}Og,fupOXhtY&S6peEpFmKFAA=","SaveState_smg2/FlowerHighlandGalaxy/1":"ZNCA8w4_Ih6HJ57v;S?1Iv?U_qk_C~ADk0Vjedav/FXVej+ja=g{)$)Z$aCk9g|/4;g$[&AA=","SaveState_smg2/FlowerHighlandGalaxy/2":"ZNCA8u~:FHPNsDMJU{61{Z!@|w0YejAN75KZL$7;sFv&oLO*;*$?sq5$O^o=UiEVUIzzk3AA=","SaveState_smg2/FlowerHighlandGalaxy/3":"ZNCA8erePUuWxFBY6c({;!rV={aXDTAAEz)Xij{ui;?(SOt}aLGR:X&9&pE}&IN[&ynf($AA=","SaveState_smg2/GhostConveyorGalaxy/1":"ZNCA8//YsidK55}DvSDmALvW!hB|2fAAI3Xg:]Iv3),WUP0y_Ll[6W@Rg2$a!;JHcCpBXTAA=","SaveState_smg2/GhostConveyorGalaxy/2":"ZNCA84=pbnzO8aIF/0X:xb)Igh5o&2AACvUimHJDg^+0?ru:nWT(,;gDDZ0OcoIhe;)W+jAA=","SaveState_smg2/GhostConveyorGalaxy/3":"ZNCA8Ij/*1l[f5uza~MPRKofIxz0zrAAD}+tZ+n8yvsKL;sz8=slNVz$IiG6kGx1!Nf)~WA2=","SaveState_smg2/GhostConveyorGalaxy/4":"ZNCA8ofh+A[4Ln4Xuk*u:}l?yyj;JrAAAAjRmD?SkO4fiY8Xl5jjDWs/Jndy6ulA{$C6hBA2=","SaveState_smg2/GoroRockGalaxy/1":"ZNCA8vy*7a0?l6Ri?=rx;C)Fg*;L${AAEvj]*{yTfKaUeBdS?lrOvl&qb+I+t~7MiTh^j,AA=","SaveState_smg2/GoroRockGalaxy/2":"ZNCA8ZhX3ScW/}1_/]S:aBd-fFO8hKAADit-uhB48GBx3Bvy/x9^[OeS(CRA,q-Tp/06:UAA=","SaveState_smg2/HomeCenterGalaxy/1":"ZNCA8ibBZ:o[7]P]/PhrJ2F1}:P0/=AADQo[ygzeSk+1Ra/HF/;(K9K_LVWjPPzku1{@JtAA=","SaveState_smg2/HomeCenterGalaxy/2":"ZNCA8k!5V&f0jxc],DNu=[ZQnq8SsTAAH{ulT^F2/~Kk],dOyS7MubjYl8T52umU5R=vXZAA=","SaveState_smg2/HoneyBeeVillageGalaxy/1":"ZNCA8ODzu1/8*/+Z=Z^s*[nGaad)7;AUqCbvpj5TX?I47*tpn4ze+6m+u{e]LP4A[siet-AA=","SaveState_smg2/HoneyBeeVillageGalaxy/2":"ZNCA8Ls2=DW8@nP(0WA/[kY6J,!L?vAABTbr7L)3s_,R(G::([S{[&3BFCO|27kJ[;8{1TAA=","SaveState_smg2/IslandFleetGalaxy/1":"ZNCA8kZivUOMZX_pIi/so+vma(pJ||AAAPp=T/f4F)hcBJO&loRB/]8eAJMDd?J$6Jyu2XAA=","SaveState_smg2/IslandFleetGalaxy/2":"ZNCA8sIa*c0Mj6i+tL}K2ZZFK{;}6$AAAw0r)*o]@^S$SjY60swwewBG1h=:YD0J)v!lN@AA=","SaveState_smg2/IslandFleetGalaxy/3":"ZNCA8O4h-r[h!XT9f!OFqrPH8Fvi~|AUrtcIA5bPbI7YQl:G*_(YJ=t0z=eVDA^I)Q@(X0Ab=","SaveState_smg2/JungleGliderGalaxy/1":"ZNCA8TiMeLEiHTj=&^n+FakyZw~4OVAAI?[WdL7m0gQqo$4f~SWbaXcRt]=o$}p|Zg+m]OAA=","SaveState_smg2/JungleGliderGalaxy/2":"ZNCA8/}lmfmUMpsAi}zRtH]QUD_}FZAN=*DpKyHv1LF}Tjz?5f~bLK~4RaErNpW}t:Ai:jAA=","SaveState_smg2/JungleGliderGalaxy/3":"ZNCA8JAc49R(GL!*OzAdiRQTgFMw!bAABNX$,x|hAq$BbRR*rx{v:M|zRTf4{==I8&JfrGAA=","SaveState_smg2/KachikochiLavaGalaxy/1":"ZNCA8NTL-Ev-Vp26ACvW0dZxbv)[~yARL(OwR,N)JnBmTG,!RtuL7^6Y-S*^UqN1L;3[uJAA=","SaveState_smg2/KachikochiLavaGalaxy/2":"ZNCA8j=psIg/*Z0ePGjnz,R,ukrs&2ADo]4R9k5Uf2ePo@]D9a{Fb8tnLbo&0hvA?~nGZ}AA=","SaveState_smg2/KachikochiLavaGalaxy/3":"ZNCA84?P09(WsDo;F;Qk[c=AD5/r/+AAEz{j2,WOgXwVqsld&Sq^9O1UtME_Nls{*+U+B,AA=","SaveState_smg2/KachikochiLavaGalaxy/4":"ZNCA8)?QcV:$guq:Hx~bO_dj(9;@8-AAB^F&OM3dhES@kQsOCyy*AVim5i~3hS8$suOmSTAA=","SaveState_smg2/KingOfKingsGalaxy/1":"ZNCA8+b{lcwR,N)sX?|oioivHTO9~uAAE_r)J|auZq{PPnz!9jH[j(OC8_KF6(ESR6W=CdAA=","SaveState_smg2/KingOfKingsGalaxy/2":"ZNCA88Ib-kEg7FPWU/g&IXIetI&s25AUuL71zcAn]H=w|!0kM/VWyt[Ej^_@[v~0|b+Mi+AA=","SaveState_smg2/KingOfKingsGalaxy/3":"ZNCA8(m(Ip@vOg^5MdS@h:{d8qrC8PAN8]C6&0-IEQ9AVt/~$-@IhQDJ)~0_HVaXKQfF+*AA=","SaveState_smg2/KingOfKingsGalaxy/4":"ZNCA8ufQV_yLoK;tfYkh}P8_4{{w+BAAF-?JNJF|W!R44k[Y6ge5cBqigp$=J@^gw/68]VAA=","SaveState_smg2/KingOfKingsGalaxy/5":"ZNCA8=I;JzH8xg|0BF)ELIw[k[L|&:AAE;s]xfl5=nvzud]s7_t1lFr+siK-3X!A6ZdKZaAA=","SaveState_smg2/KoopaJrLv2Galaxy/1":"ZNCA8Z1nw{pvq8dY@alP,Wyf{]__pLAUqt^m_hutypLY!rzB&H1sTdBZpcP[3&,k]qGA;aAA=","SaveState_smg2/KoopaJrLv2Galaxy/2":"ZNCA8[5N;;qIQ7lDMfq11[!OZasbVUAG!xd:}VlMuXls!L1x1WIgfV3B=Yy/({uf@lXR8xAA=","SaveState_smg2/KoopaJrLv2Galaxy/3":"ZNCA8N)a9fwCFl)OOy[QseUi)5DD/tAAC[]1bJB~AL|x)8[AVovIsMQ=p|w)m;5IsVIt48AA=","SaveState_smg2/LongForCastleGalaxy/1":"ZNCA8e!G_zD6LVO{/6SK=48u2O4rVzAAF6;+BtTgfsVQVYyemW$9b|oyEl!|Hyus;u^=FDAA=","SaveState_smg2/LongForCastleGalaxy/2":"ZNCA8[_qqKIHXYlr6OROd[!lOF)S==AAA^-6R]MrDSo@Hd?4{gM|]g7DxaEwPAftI3EmJXAA=","SaveState_smg2/LongForCastleGalaxy/3":"ZNCA8S?xk_@VwtD])SepnV+!gFy{HqAAB7|XDe&}UQDU!w1A5XjmiIihybZ|PEc~HUwj2]A2=","SaveState_smg2/MadnessOnimasuGalaxy/1":"ZNCA82QT^Gsv}GQKUPkFbo4,qv2mKAAAA83Pt{q8[0k3LRq*gy$pE-a_coR^BXT!h2di//AA=","SaveState_smg2/MagicGalaxy/1":"ZNCA8-T1jIuyug]wf:fg3fe_=/EziBAN9ExZ5:M@,2qagVMz-JnA4G)(Rc6T[XYCqgCD|QAA=","SaveState_smg2/MagicGalaxy/2":"ZNCA8wrd_,u0mg3R&B,Q-6nbn97f*EAAA,5?T~b9+ZX!1-Im56{oK!VYZB|4-(|)T1At8wAA=","SaveState_smg2/MarioFaceShipGalaxy/1":"ZNCA8JdU;w=/*Z~pYUFPQVWOxGs4a]AAAB$l]CH*5CtqEpVU5aM3Igf[({!*F3$9y0|A[SAA=","SaveState_smg2/MarioFaceShipGalaxy/2":"ZNCA8}SyRnb=TkSNMHE+qivP?9M5}TAAE]C;JRen?|v3U[Eod=iF3fQ-Ht$-Sh1:0=GrK~AA=","SaveState_smg2/MarioFaceShipGalaxy/3":"ZNCA8=MOx8knRxy:R{z26(VM/O/(]uAAJDj@owEJZJ+G^k:d$oBZXFhqENT!e+E2]$mlP|Ab=","SaveState_smg2/MarioFaceShipGalaxy/4":"ZNCA8gR0?/OWSdQ0sG?k&f^ek*zY1(AAHZ?,/C}jl3l,W@d&Ges?pqE8G58W(SVKo[Kl);A2=","SaveState_smg2/MarioFaceShipGalaxy/5":"ZNCA8aVEI|![*]v{N2(/J/gi&q_+?rAG?;zhID-b=c-QzFw)Ih6h*+x9yR2QYlnM74Osb{A{=","SaveState_smg2/MarioOnMarioGalaxy/1":"ZNCA82=QGU1P-C&_t/[mV9HJ1eF_1^AADcsJ4Ak6_GNFx_q}S1&Vy]y1aROYr7ai{pRCk]AA=","SaveState_smg2/MarioOnMarioGalaxy/2":"ZNCA8@8yEf1P-C&_t/[mV9HJ1eF_1^AADcsJ4Ak6_GNFx_q}S1&Vy]y1aROYr7ai{pRCk]Ab=","SaveState_smg2/MarioOnMarioGalaxy/3":"ZNCA8a7)wrBOzpgx?+]XWe-9_eISW)AAAAArq5zC[R;=r!&;r21f2I4h_jtFj~n{XA2}W4Ab=","SaveState_smg2/MemoryRoadGalaxy/1":"ZNCA8W=!8jm/Xzd3fBrCh~$,34Q*ZgAAB_^1B8fG@x=gOF~Bya]e4N3SMNxELPSFW00UY,AA=","SaveState_smg2/MemoryRoadGalaxy/2":"ZNCA8O~d6Fn?jIa-ekyZRG9iQBtI=5AAEb[[(_+y!J932AUD5pqEgX906Ne8o/8)y&lG{NAA=","SaveState_smg2/MemoryRoadGalaxy/3":"ZNCA8O[Bmen?jIa-ekyZRG9iQBtI=5AAEb[[(_+y!J932AUD5pqEgX906Ne8o/8)y&lG{NAb=","SaveState_smg2/MokumokuValleyGalaxy/1":"ZNCA80MMH7n8AXZur_~8+l{0{q7e6tAAB3l$:_[!KTxFp7EcB0Pt5}@pkbtboA)nN8e2{ZAA=","SaveState_smg2/MokumokuValleyGalaxy/2":"ZNCA8cNM8&gv&ishaJX2!?dq,CN__&AAAB!zchdWnDNc(G@RRv/mS{;$SZqDAsUSU!FqHaAA=","SaveState_smg2/MokumokuValleyGalaxy/3":"ZNCA8GpoM!$&6WywPL*mV9f1-~d&c/AUp~VuP]iDg{F[b8s+q&TwMPE+!mYCl0?+hT[|ErAA=","SaveState_smg2/MokumokuValleyGalaxy/4":"ZNCA8sb18mmIp/ylvJ@Sf?h?p{3:8DAAFhRAq?:)Rap6Ib*fsI5G![t7ZbUmawI^pF5:mEAA=","SaveState_smg2/MokumokuValleyGalaxy/5":"ZNCA8@hTrRsIY8nil:6!xi8GI@0[imARIVmlB1{LVI)7i)*vH&GrOYyR9@nW2-/qhUr)u?AA=","SaveState_smg2/MysteryCandyGalaxy/1":"ZNCA82VCnfC39F0RN|rx!x_Z_)=Q1rAACY3,D@HJbYKtwM):oj(-3WEfN+I)E7B[7MK}ltAA=","SaveState_smg2/MysteryCandyGalaxy/2":"ZNCA82VCnfC39F0RN|rx!x_Z_)=Q1rAACY3,D@HJbYKtwM):oj(-3WEfN+I)E7B[7MK}ltAb=","SaveState_smg2/MysteryCandyGalaxy/3":"ZNCA8DsT-B@CA;ncnBSUYwkD0l}ybuAAEt$V34TIlJZvo5ow_Pj[V5@ajX+o@GFd]y9g{3AA=","SaveState_smg2/OmoteuLandGalaxy/1":"ZNCA83=c1cmsVE8zCefn9)uw_6MERHAWZM57ra&@0Kd&BLQA_;[uhZ7A$8DG_|*gHnK9iuAA=","SaveState_smg2/OmoteuLandGalaxy/2":"ZNCA8RT@Hm0;a:([&]~Dn-5g3v)LvWAN9f73L*8&L*/2P?vTEc&&Hk2,]&lYprjuGP!rj/AA=","SaveState_smg2/OmoteuLandGalaxy/3":"ZNCA8~{|5xZC~jg]:|q*2[nPX2Z_|:AAE-ALWy{=,ekp1Aj8DDl?&Rl1@^v[V:X0*IHS)DAA=","SaveState_smg2/OmoteuLandGalaxy/4":"ZNCA8u(Lj1;zqaHU9p750jNBqP:w7ZAAIfQZvb-wzH(GkNk/lUd6sRPI0OqCMBK_2Ny^oDA2=","SaveState_smg2/PeachCastleGalaxy/1":"ZNCA8Xs67mo*3b{A@M2e8,kDk1riafl[:f=L]/Hm*Sp{8hU~/^F?F5D0Jfu/45VPadc},iAA=","SaveState_smg2/PeachCastleGalaxy/2":"ZNCA85E(_6;|EWyAjF*o3P9OYFQO;{gYbcL,*g9sBH|AX$4[;/@lY^Wy!;biHEeqU/**wRAA=","SaveState_smg2/QuicksandGalaxy/1":"ZNCA8lY=lu&1w|xY-cXFgw2dIFb;&eAKZCmyLEu^2k]G|(b?YSAKGGpvR@c5+r*w{,vTicAA=","SaveState_smg2/QuicksandGalaxy/2":"ZNCA8FSQf{:68s_lxwko:*awi?a:dRAAFu-VytcfsrttNGFuz}@WH|Z1qTwMkQmqi(t:UgAA=","SaveState_smg2/QuicksandGalaxy/3":"ZNCA8DbExQBeiOQ7i+_Wkz_jLb_9NJAAAyJBPnnJ3Avae)PorUxcJ2CdvB-1!EI}u8h@Y!AA=","SaveState_smg2/QuicksandGalaxy/4":"ZNCA8n4S}-VHkk?phZ0BhFe~0Q+~HgAAFYOS6g^XW2kSM&&0*co:rx2myvCNG^vX7flkkcAb=","SaveState_smg2/QuicksandGalaxy/5":"ZNCA8cl0{1fesh]K/Md5Cq8f^X6wF^AAH{tEzflU]{iCMoCqiffP(=k,$*Qg;O8F-te+^yAA=","SaveState_smg2/RedBlueExGalaxy/1":"ZNCA8LKndd7WhCTVp&H!XHD;d6sm63AABL_P860m=48:83}cGZ$+;z5k|7|{AR}S/3;xTTAA=","SaveState_smg2/RedBlueExGalaxy/2":"ZNCA8/Z|h)7WhCTVp&H!XHD;d6sm63AABL_P860m=48:83}cGZ$+;z5k|7|{AR}S/3;xTTAb=","SaveState_smg2/SecretAthleticGalaxy/1":"ZNCA8=K)p/+xJSJMesg-MF=M)hM;q:AAFJI~N1OO)eXdZt;dFWmEaSBR[=9NQqoBQ9Ive:AA=","SaveState_smg2/SecretAthleticGalaxy/2":"ZNCA8irOL1+xJSJMesg-MF=M)hM;q:AAFJI~N1OO)eXdZt;dFWmEaSBR[=9NQqoBQ9Ive:Ab=","SaveState_smg2/StaffRollGalaxy/1":"ZNCA8k4v^zYfgXx~Sj=nRl_vn{S!L_AAI-b4^^qdh9^;s-P!ikZpy]gM0;4S{f2o9Xe9SJAA=","SaveState_smg2/StaffRollGalaxy/2":"ZNCA8z*g?;Rn@L,Z:P8q396|~~czoAAABm!koSA{x{*3&B4)bw/fQ(vu|zge]2pjIpKclnAA=","SaveState_smg2/StaffRollGalaxy/3":"ZNCA8C4jxA-9^OsVy1ktY*B)jf:8lsAABNXI?twH_~vX{?Q?/}ynR3G6t5b}9=lKw,OP]ZAA=","SaveState_smg2/StaffRollGalaxy/4":"ZNCA8/|~sUY]bQ9h~gm$p)a:6gMhmTAAB-oW~N6BX|OU83?z,-L9@OLXCFv_fz7R)o{-d-AA=","SaveState_smg2/StarCreekGalaxy/1":"ZNCA8m-n8pGO7Qv-m]W_2(x1xA|XM^AAH*CV@3,P7BfqtTdp?VY~MyAyR7fA--jfoRpO{MAA=","SaveState_smg2/StarCreekGalaxy/2":"ZNCA88K[x=ffk5rc@ohE*;IXPbTb/:AAB^FduW*lBG8[8Q9-8RLtt(Q[)I9@/mMtM7=/N=AA=","SaveState_smg2/StarCreekGalaxy/3":"ZNCA8RSnS24JcfrEEo_[ZDs||49sIhAAAT^?x:|{8KPh0e8U6~l=x}z{tHqTmf4]R(5!EMAA=","SaveState_smg2/StarCreekGalaxy/4":"ZNCA8AyCl~Fp:)vr&pSeJB3TLtYqSdAN5U~7m9@f&dbz1cibp)SuG4]J1|-4I_=,Z[5FYkA2=","SaveState_smg2/StarCreekGalaxy/5":"ZNCA8j-I8jYZ(hvr~YlA@up+[mP4dFAAAAiz00e(StShse+bB!k7x+9j[J&*TM2[S@AL==A2=","SaveState_smg2/SwitchMoveBlockGalaxy/1":"ZNCA8Wi]3X)@JwtG~V)(r&/(+o=*)-AAA_Pw0,q??e=rS*JojayF+q!4_P/:j2m+CFJdAHAA=","SaveState_smg2/SwitchMoveBlockGalaxy/2":"ZNCA8W-tauGM/:oSANj?Y3u=S0w&n@AUrQ9rAK:Lx{sN:dVxI3opk@MYw{UJA[O)++gNv[AA=","SaveState_smg2/TamakoroPlanetGalaxy/1":"ZNCA8M=V2QlWA/OEw?4i,4Y/uVI4NQAADL*kDYk[mllTr:AEDP;_My?)~j9yRw)61I5,/JAA=","SaveState_smg2/TamakoroPlanetGalaxy/2":"ZNCA8DwFyQg[R([OzZakM+R0A0WuM6AN-;~5l4tsoz7,{Qe=v(g8,d-vR5}W:O5sp9zA}pAA=","SaveState_smg2/TamakoroPlanetGalaxy/3":"ZNCA8tmpa8ew}@9G[Me&{23(a;eCE1AADcs,B+p~dfs;e48{$9jKec)U,O1Zs!r@=:IWVtAb=","SaveState_smg2/TamakoroSliderGalaxy/1":"ZNCA8P{wP;W|VAFZzKkPkLb^:K_]:vAAD,O)n[}:*JrqUYcg*RcM+0zxz^Tj/cHI2&Q:|=AA=","SaveState_smg2/TamakoroSliderGalaxy/2":"ZNCA8!-&VSW|VAFZzKkPkLb^:K_]:vAAD,O)n[}:*JrqUYcg*RcM+0zxz^Tj/cHI2&Q:|=Ab=","SaveState_smg2/TamakoroSliderGalaxy/3":"ZNCA8fI]e9p9L}-/mB=GumLOqo8pX(AAIs+1([:d;$5z+v33hm:[)~;CNPTtsZ]I~?3+crAA=","SaveState_smg2/TeresaLabyrinthGalaxy/1":"ZNCA8Fozcn0LiSP@9{W:yc3kO;H1ivAABX//eS!q]/mTyD6/R;/vq5P0U{OW,7q83(mzM}AA=","SaveState_smg2/TeresaLabyrinthGalaxy/2":"ZNCA8VxSid]q);5:e2c}]f*h(t{M:_AAE?qGn?~/aDo&Eb:3NCWX^K4WVhP,0zML_{JqYdAA=","SaveState_smg2/TeresaLabyrinthGalaxy/3":"ZNCA8L9P|{CW!A$2A]PrqNs}lH?F&GAAC1Yl&/gr;5p$Y$TXc3P?6seS-+1k9j?ZP+2;n|Ab=","SaveState_smg2/ThunderFleetGalaxy/1":"ZNCA83W:I|kzft$MLQe9EwWUBi2p=6AG?srus^wRanm@h=+(j|+yF{VNq6[M8zbo_5AvufAA=","SaveState_smg2/ThunderFleetGalaxy/2":"ZNCA8uay3GcJe?&-&xfBL48rp4~*uWAAIrUQX(i8Ng+y5g@tE@kw((nscS:l0mK+&kQ:GoAb=","SaveState_smg2/TimerSwitchingPlatformGalaxy/1":"ZNCA8O8xw3D2jKRkyu76-Rcl8dhWn{AAAyH{g8P?=9Rchz)o!P?FtEtRS~tF$9$iEAvq-pAA=","SaveState_smg2/TimerSwitchingPlatformGalaxy/2":"ZNCA8nZWxD)ZvVLxoXn,~W0tmZ~I6RAABNX8-F9lo|Agf6Gzz}XJx8trQ5Hv=n!F5uZiJ:AA=","SaveState_smg2/TimerSwitchingPlatformGalaxy/3":"ZNCA8nZWxD)ZvVLxoXn,~W0tmZ~I6RAABNX8-F9lo|Agf6Gzz}XJx8trQ5Hv=n!F5uZiJ:Ab=","SaveState_smg2/TropicalResortGalaxy/1":"ZNCA8!jK74;&qtnndMvlQot+L-~sa3AG[5hhN;5^Z(9YxZeg2nElex/UfZJoMHhW{fjtv*AA=","SaveState_smg2/TropicalResortGalaxy/2":"ZNCA8DL:JhQGzJ]4eI!Q@N3M{-;Mm[AB,GGiy^4nlwno_q;uJL)8S8m_R}Fken-=7uL@FmAA=","SaveState_smg2/TropicalResortGalaxy/3":"ZNCA82eIfc4LtfI:46dHJ41KPF^-uGAN6CH9ok2YQFRsozEhtDz~_^+UZ-Nz2bA(EPe|gGAb=","SaveState_smg2/TwisterTowerGalaxy/1":"ZNCA8@DzGBrk:h*!rE=,K!wdVQbi86AI0JqqkDk,DvyPI&3K&*m[au_(aAG9W]g0QPdIA?AA=","SaveState_smg2/TwisterTowerGalaxy/2":"ZNCA8Jop+|xrbc-gXiyk6As*]n4C=aAR^+cwRL&(c9m6vmT2}p$A8HENx55;Ie}jQ*Bn*!AA=","SaveState_smg2/TwisterTowerGalaxy/3":"ZNCA8{Qc]BUL=5[)zK[~3H:J^6@dLPAAEw)&a{F+N_|r}0$x)){sUAN:xcm0pUHOtII7gTAA=","SaveState_smg2/TwisterTowerGalaxy/4":"ZNCA82z@e([Wtx(Twosn=rH_9_It0kAACXN!-?oNU)x6c,VYTJ[UP7FL{$UVzu{4;1)IaVAb=","SaveState_smg2/UnderGroundDangeonGalaxy/1":"ZNCA8r&m_8iJf:,!9z5hW=Y)iIE8OGAAAB$KlgqCWv!v3e9YvbnihwEuhS6f=@MZ1l)uiHAA=","SaveState_smg2/UnderGroundDangeonGalaxy/2":"ZNCA8Nq9+_bcBC~NAqg~ra@NmN1YxaAAC^&3UXZ[ptiyPxuAuIYVsWbgL}dLg-T22eKA|4AA=","SaveState_smg2/VsKoopaGravityGalaxy/1":"ZNCA8yx{fINWWSD!-^Eai(jz&lj!hhAN5I_f*iJxzhUL}+S43B=F2MNBHF/1cw[:rzpu-OAA=","SaveState_smg2/VsKoopaGravityGalaxy/2":"ZNCA8lk;Y/RE+-8q@rzvhC53glHA&jAAGlD4NhJoyVW}a-]poHKyx51XK5}p]UR=OczEJ{AA=","SaveState_smg2/VsKoopaGravityGalaxy/3":"ZNCA8;au!Qo2K|)&UOI2)O_w_:PcCpAAG/MlXQOp;C[6WI[qgc=5guFggtrxboKXuacOw{AA=","SaveState_smg2/VsKoopaGravityGalaxy/4":"ZNCA8vPBRL=_q=+B*ilf29Z&&S2,XCAAFi5VOxQL]G+^E)&JQNcHVganU5zhBgcAyl-(,qAA=","SaveState_smg2/VsKoopaJrLv1Galaxy/1":"ZNCA8153@P?:)l_prSqi2!a*fdxa(rAAGvz34BPs2)720(ILeG_wVpT[!~dJRdP]R6{J{]AA=","SaveState_smg2/VsKoopaJrLv1Galaxy/2":"ZNCA8v3=y=kWpj9hsiJiXFlF*+?3C:AG$@Y5wS)p*d&U$$yAKd9~q?:qY[iq_UdNENK]yrAA=","SaveState_smg2/VsKoopaJrLv3Galaxy/1":"ZNCA8y/vfp7L5r&91o|IDZgF+p6Z1RAN6w_xzc!EaB}PZYiNlGp6X3}TXbrFD3Ah!6E0X,AA=","SaveState_smg2/VsKoopaJrLv3Galaxy/2":"ZNCA8(QP8@!KzV&JAmVVkCA6=:R~CuAN5$uf*iJxi531ei9V1FKqY+FX=MlNB:Q)7wd;nnAA=","SaveState_smg2/VsKoopaJrLv3Galaxy/3":"ZNCA87Vz*ka1N0KfT0^=]$$fzCe2B;AAAGlnRI;v82sU^w}xh(?12f/~b56W_=Xd6DE!10AA=","SaveState_smg2/VsKoopaLv1Galaxy/1":"ZNCA8yFJwm_-[hRY!!^e4Q+p!7S0t!AN=JW3?GAngw+L41mt)x=4fNf[Ku0xG]@zb7S$a,AA=","SaveState_smg2/VsKoopaLv1Galaxy/2":"ZNCA8O:z}Anz=DL+~CSTJ1+DoO?TnuAAFSMvj{cECb2/am8~hhW{H^ZvT^Hh_J?27sM(?$AA=","SaveState_smg2/VsKoopaLv1Galaxy/3":"ZNCA8Ipfv!bADy)u?@Y:gmKOQdAOvAAAD$8=-[rh)aeoX$C/G$e,*zn5zMzD_N/pS~N}_wAA=","SaveState_smg2/VsKoopaLv3Galaxy/1":"ZNCA8vLzq*lsgOob^si5P@cVp)vt~2AAAXB@NU*IiJ4C~scj?P8n9r$HB87G,Q*2PFRCtwAA=","SaveState_smg2/VsKoopaLv3Galaxy/2":"ZNCA8LRlaU,rI,cg)=2FFHb|90Lvt6AAE&t4DDPanr+7T_One788axoVi4n|Gr}SO+exdXAA=","SaveState_smg2/VsKoopaLv3Galaxy/3":"ZNCA8(jPsDJd@@gZja_u8UaqD!x$wyAAHATUbKJ11g;|~~9JH~{CPwdhma5H:,op$CMT=hAA=","SaveState_smg2/VsKoopaLv3Galaxy/4":"ZNCA8t^8eYft~*6y54R@ET3jFte8nUAAC[]c9J3m2RIfZc9f~goEC,G[94=bm1HoR@QU:ZAA=","SaveState_smg2/WanwanFactoryGalaxy/1":"ZNCA8:U*7NWuY2t9]}[{Su?L_c&1ZHAAI4,=:2dCfnW&9GSQ+(qYOR6Y?tWXzU^soUIa5{AA=","SaveState_smg2/WanwanFactoryGalaxy/2":"ZNCA8cnb;9~?:EQv46^XvTi(wEm0q(AAB3n2Q70yg8tYUR8]1eI^=Qbr5:A}@@he;Vc@d6AA=","SaveState_smg2/WanwanFactoryGalaxy/3":"ZNCA89^Cp!7/2B!Ufk;e-CKO:XT~v*AACXOLBWv1/aySr3:GfXuBY&Zgne$afw~=X1-tv,AA=","SaveState_smg2/WanwanFactoryGalaxy/4":"ZNCA8/[k[{61juCu_WoTBRp{!,m$eUAUs17YIJ&t:*A-Zp-l^LNJDgiQnsJ?_6$t+QSPjWA2=","SaveState_smg2/WhiteSnowGalaxy/1":"ZNCA8&-U)eEhJ/vMIrX|I}L&[y=j(xAN7!R4oy/f{~j*BhxBU6nz9ly07O6!fZJYyJnc[(AA=","SaveState_smg2/WhiteSnowGalaxy/2":"ZNCA8[Jd&nYd^K?(S:da(ISofg/8QtAAA~751v-OYXXe/mBbT-0r70VG-~95/rvSY3;=LcAA=","SaveState_smg2/WhiteSnowGalaxy/3":"ZNCA8e:yla7JJ4FBRTT~Z}=o9jGdncAN=!s]pEF;+)(I3x1}x$S(cWNKN7Stjt}|RZ}3FrAA=","SaveState_smg2/WhiteSnowGalaxy/4":"ZNCA8x8eDw-izAq0,^94UU-K^TWBMRAG?6EwsnB)~t{NEtjaI)=bB=MKF4!}E0=)V:JWJ7Ab=","SaveState_smg2/WorldMap01Galaxy/1":"ZNCA858j-@oM=BfzqpzJrIR;=6VqX=AAF6;4D^SSum*Kg,m_zO=9[w=Cm,04p*u@GG!H82AA=","SaveState_smg2/WorldMap02Galaxy/1":"ZNCA8Zgj;CdhAB*hcATyT*Xch&0K5=AAIHHx]{Oa;I&*d5@YPIJ1ZuekPe]MvlTV!P@G=kAA=","SaveState_smg2/WorldMap03Galaxy/1":"ZNCA8J}iN;WCtz7g?(qTF4r_@2bC{bAABrk5A*tVv=Suk&9?4plbJsOnDvH2$&|U!Qx@TQAA=","SaveState_smg2/WorldMap04Galaxy/1":"ZNCA8UUT&mL)4nWY;IF_YbGUu7eZgFAAAAiqY)fbQO!W3KFx7779{wCB2SeXLGmjB6y4rjAA=","SaveState_smg2/WorldMap05Galaxy/1":"ZNCA8nY1)Uv=XlFDmSF}n{h}3vItv-AN4XACA,VywGRvdS1+R*Be6p_9&Pm|rYI}@z3-7_AA=","SaveState_smg2/WorldMap06Galaxy/1":"ZNCA8c)!Sf;qWEfz6zR]R~~;sPJVugAAIv-fTd_v&[L1&moC]]]c+{ndcv6Msdp;~T9Xo;AA=","SaveState_smg2/WorldMap07Galaxy/1":"ZNCA8rM5&yzC4CAz-V[m0T1TXVNu(UAN8h@$&Dsju,)Ucc{lLJD?BS+L!oRnTf+Z(q&9WRAA=","SaveState_smg2/YosshiHomeGalaxy/1":"ZNCA8;8_n(rcr,b?zYhg0ZQ-^~!g[YAAC1Yr{l/MBHqdWxJUK?rsx3a7t&VrX3@O&v65QUAA=","SaveState_smg2/YosshiHomeGalaxy/2":"ZNCA8Fub~|u)OAv=i9ksDAH*NK^F{VAN8&tb,AQqkY;GA7d-:ih^T[HWq^a)Si0CU~98}DAA=","SaveState_smg2/YosshiHomeGalaxy/3":"ZNCA83A4dqjag$eGO=(0[0@xTEWYsvAAGoF~hWwn?xSprGvX67XD92N3t/L*9f,Jw~7fALAb=","SaveState_smo/Cap/1":"ZNCA81ihLrd7;fkM)?/_H|dVi(H_iZpFSA1xIujZWYaqUM7O[|+RmLGPW@]@eCBWgw)Hxg=","SaveState_smo/City/1":"ZNCA84:jLZwp-QKSbcZ:*y|?Xjggp1,=pGdgsOn}XeOlpxBFoRr?O?Yx:uVebI|k9,S|eJ=","SaveState_smo/Waterfall/1":"ZNCA8]qMA:S]Pa9h20NJ,02lqz)*DRzkd{_${t*hiBIAGzlI[RzD{RH4^,0]6j=@j[$BF==","SaveState_z_botw/MainField/1":"ZNCA8u6V,zV^UEu:~)5GWltyp0aElU1?$7(5G({Fit-Ru8hS={s8BE6C1$]icO&XlmbkVE=","SaveState_zss/D000/1":"ZNCA8}UYdZK/4(p6OU,)Gw?m7w8=qQ*C9(OBDH=&8rBXXCag(]fAq(PuPGvct89{cTqF;O=","SaveState_zss/D000/2":"ZNCA8cp+w5NlzGo7erH/V*rMbOOc@}9ID$34c}lQ6Z|}]El029N_64T_E20(o1hyTYng~G=","SaveState_zss/D100/1":"ZNCA8dlNhgi-BA;IMzV~[,P0_)^xfs8G!6xPg0|ds,Rv^PA]dCpcaP0r723bZk})l)Z8w0=","SaveState_zss/D100/2":"ZNCA8f;2U7Etf1}_+gk|T8Sr?:vmqG!Ji^K:bGr*GwF}{1&8eEPtq6btC^SZKDapnX:0n*=","SaveState_zss/D100/3":"ZNCA8j[Ni+w-q}7bAQDDukZ2e4:/on_wt:Mv~W^VWz1zV)$5;EFDeKDpc6:*D!{gU&[qf8=","SaveState_zss/D101/1":"ZNCA8xzHE$yhB;|S=XCwBY7n=GRGeWfsvi/)19^W[Kqg68NvS)GHU|bY[fi&1AHqZqsN1B=","SaveState_zss/D101/2":"ZNCA8yn9bO@8t~aOE{p2d6?GzZAXiU7~FF=3HC$Pt~Z&e5[QaCiDz_GSq-gKSsj&03133q=","SaveState_zss/D101/3":"ZNCA8=ML{;sHk3R=NfFU,v[]^HohDO$lxqK]abgRb&KPUdohED~b*4i{&}q==+)_exdjpi=","SaveState_zss/D200/1":"ZNCA85pR5zGbmvJf/I?jW/X8vH7!AbDin]4x;sZ{I7o8_jE)XjoQeB:,]KM)74tx}VYW;O=","SaveState_zss/D201/1":"ZNCA84=h;*BY=]S/*J*2cF|uAMTA@)Yu[=RZnS;~h,esICcM]NjM[m]!ma1{;@9euAKCJT=","SaveState_zss/D201_1/1":"ZNCA8[29~EeAIIR[{=5EYw6S}qePzuCOl8v1[5Y]ORFgW/3en|;f*{}HyIy7c2aVi[zcc9=","SaveState_zss/D300/1":"ZNCA8XNV@Zy+ElaV0n$o8?EJm@n6[ts~_-ovqyme;F{|AiN6Oo@hd/^dx*r8rX75pf?XSB=","SaveState_zss/D300_1/1":"ZNCA8*h6$~;Z*D?/7Wm05+f9[=Ps!gLaX-iu4+js:Ou@loHM]4bD+$:,)Wzj3BNQW-xF[j=","SaveState_zss/D301/1":"ZNCA8~XWoZfgn09{TIg9!b4Tepj?,&nU||trAK:L-Iu/aXBRaGp)XK}!t7=s?O^Zx[NJTl=","SaveState_zss/D301/2":"ZNCA8/f[!=/wm,Jv^bX^Xb3K[JR~Qi1ID,QrE)G7;^~AZJgJ+|cNzr42vWPDJyBZ2*t^T[=","SaveState_zss/D301/3":"ZNCA8ck@Ae{;}r_O4mag=UJJuUr4{~RcZxwGaz7VTBe:_}VL_ZjJzFz,/eAgIW=FpsH6nA=","SaveState_zss/F000/1":"ZNCA8m&I~I1zR@IcEUpd_,98yKZTcv?,:zmn6z,{&;(CFN$XsxF-([;Ux3S^;h/[wQ(jP6=","SaveState_zss/F000/2":"ZNCA8sYFc7l(SR&Z;mtae0$loBCR[IdglxDCV8PVg$08,lYmSIC!xhQ:k3xTD*?dsPH+5x=","SaveState_zss/F000/3":"ZNCA8EY!&Ic7PNbI+n&Qyn-Rt9Y~u9e2CQvWbb2ZCkBiF-dP79RQG-Y{BrIU*}3)Kol;7i=","SaveState_zss/F000/4":"ZNCA8!h49nmF/$G1C^B2u/S?NcNaMbecfPl5/Q}+X/}n^x+&g5Fzo~,wj{mAuP1G:wdg7G=","SaveState_zss/F001r/1":"ZNCA8L}nzlc5if-WYF8/B*,Fj3aK^O-7wnv5$9g~4*LqQnd&G*Q46O?EsN9WAo;(sF,}C@=","SaveState_zss/F001r/2":"ZNCA8A&2F*b)V_utVTirUe1:Z(;(3-=7EpAnn01A8U9vOa2IHx0MAb46N(2(w13+oKBt_|=","SaveState_zss/F001r/3":"ZNCA8fIf]&yvC^|T1h_b)2fn[-KkmgPB+2pr)13{as6+H}MZ1@A4zqa4cKEK2dj4sX]+)==","SaveState_zss/F001r/4":"ZNCA8Rt}Q$Y|LX6[7D_Vn2VE[]^31wAO8m-t_k(LJ6!*P?dGnJc~oo{{O,0*[e=284N=F|=","SaveState_zss/F001r/5":"ZNCA8Fc(H2HI3LZ/]sovF[cldSS/YZ7Xi6?okw*D7zHdMkiC0v{dq5e=d-8paTKZm~L*N+=","SaveState_zss/F002r/1":"ZNCA8@(gmqPDcd87FL7?z~,ri:FBwmyE0g1L=$odqAJ=?HQ~V/&zySvla;tB-);maj;eKc=","SaveState_zss/F004r/1":"ZNCA8BhcvzfPQ)i-j6w62Tqa^&^ges{6AtNn+d]w2c{wC!ij52,s_I+oU@qlW7_j}IQ_]2=","SaveState_zss/F004r/2":"ZNCA8Jv*CS&3R+3RW*sy_?:1PW36!}cK[{mOZ{cXK[R*}OUiu56(o:[VM!m@:}BJ!MSQRY=","SaveState_zss/F005r/1":"ZNCA8tO$h^By:p8N:OwpvKD-Qe@j{}-]@p;hn?//Si_;~oYaN[iST*~7]XFWu{g++]dRgJ=","SaveState_zss/F006r/1":"ZNCA8]x{QZhH93bLxgGlYYmcq4]o^q?SP*IvU~?$D5XuBS7oG$*~W!+1o=eUNN*$tPbtg==","SaveState_zss/F007r/1":"ZNCA89O|aI:u4iUOJ&r)h^-ff]Ybo?dIKT0y3Bu:OWHpGvJiX6[/lI;gdD1A8G8iO(X&uf=","SaveState_zss/F008r/1":"ZNCA8xOD_yp[},SAMpo5pgK,id6c6H0yq;F$io6PXrLtkfYkl)T+$)PJSM2-D3cYN,(L~Q=","SaveState_zss/F009r/1":"ZNCA8Lv*xWlB?g(_Y;-w+f]}yZ[vCxM6a!ANeqAiqAJ=?,[X|!WwFeFON(*YpIT$HMYpN$=","SaveState_zss/F010r/1":"ZNCA8kRb_QP;4fpaNG9k&2v9$Q[?@rfA3bLz@FrWN*i*P6$4BB6KxcuK29)GIBhZk$05s[=","SaveState_zss/F011r/1":"ZNCA8-b+V:![QjLN(KA{1=Xq2H0jr3gisP*?Sa+ef6_Q^yWNilL_PgAy^(H1X+6HzbY9*7=","SaveState_zss/F012r/1":"ZNCA8z2Xv({zfwwG7~K]iR{,MMggb-JYmIi&flASaiAptuE!PTJq/ANyv)GUv$i77LjsNl=","SaveState_zss/F013r/1":"ZNCA8_4~Dk7Y[XRR-p(1wnU~W${4FZ(yU6:AW^2=:Hz2nKdWyAQKzN-JoWtl${JP6U9lS==","SaveState_zss/F014r/1":"ZNCA8Ek8d0[C;rwwNOTYD6D_6(V}yJT0?[zzpi]4spUri[QnPB?JMdGjnH4?cc(|I3@]Ko=","SaveState_zss/F015r/1":"ZNCA88SC&g6?W^fp~L5k,IT(UCuWKUOD^8by:z)QsK82/hQ;NtPNrpnGSZ*$LFnp2AVklE=","SaveState_zss/F016r/1":"ZNCA8lRg?;1_OTAf=FU7-;Q)-j)dHm_,uZbJ:=YAb7^V?Tp;!g5{YhM5&Y|ko/fU+-P&SC=","SaveState_zss/F017r/1":"ZNCA8!rv^;8xBt87B(H^C?!ciz[&~@t5gt+e9eBFq!/P0W;BF3Yz5n!3sobcGT@{jWgk)v=","SaveState_zss/F018r/1":"ZNCA83N);Ou4kwkI]/9@lH~uM2iVk|T4SA0/W]A69325z3lmf6BO9JG9Fz!t9(]hlD8wHi=","SaveState_zss/F019r/1":"ZNCA8Oy!4GGWtM62n:y?w8bqO5d@zZ~+1*5V{OQ)L3J;jjpN2[5[*}knq_j&IXgXp9RO;o=","SaveState_zss/F100/1":"ZNCA8+5Y:NSf;U}oNEJsuoVRX8yg6dz,X8]dj:4[nBjK9;MH6^4j=+Dg?V,$MN,D5A705m=","SaveState_zss/F100/2":"ZNCA8-,fJJ[~pqC;}DmH3vW$TJ1_r6s!wpI{O,c@P7$NDS;}f{28LO;ty_EJ*+AMM&=H_S=","SaveState_zss/F100_1/1":"ZNCA8-~bPn*K]HZs2^sEpZhBT5tR/rqyORayCr2}apZLX4Kyhz?rfO$UzId@tZg_[Hmkk?=","SaveState_zss/F100_1/2":"ZNCA8y9I/2Wd3!KU3veSZ6}/:2{7oG49jb+0=PpEpeR)c[s3Eu:QxJ2FnBa^?2bky3aLsc=","SaveState_zss/F101/1":"ZNCA8K(fG:hY?ugvmSJS8F6J7xh|}iF_^QKqE|tVZ$e=A=g3UzIgV1{L)I2]jOf^@4pBWS=","SaveState_zss/F101/2":"ZNCA8LOF@I&{x{3j|7o[pNEzJrw:q7DHvIEiS|W@1PL9C@{6AzkII_V+^[2mkjHTW1$28}=","SaveState_zss/F102/1":"ZNCA8z+f&mLJrmcebnoKKFnkR!e;QxaGEXj1[B|q807WtQ4pS,(00nmK]2q/-WM=I5L&x;=","SaveState_zss/F102_1/1":"ZNCA80/@(mFge34r4l=D*1CljtZHnBJMR{uvU~?$CF6A{nv3E3b_U}57l^!W$48l1h)]u@=","SaveState_zss/F102_2/1":"ZNCA8}V]&|k(wqCSCr}kN=4{Sk@t_~lOGrIBvXF::Hz2nE/@A4~}B)sH)&nrzFg*qyx&7a=","SaveState_zss/F103/1":"ZNCA8t4W:t37k_A0}E8POw7[VsLd=@)SUxuHY16hS2v)ct11)PjsmiP3zc]H/bcE@yuEJ9=","SaveState_zss/F200/1":"ZNCA84*_nSJeNTMwK~EaZ7waFX5WXR+;j^waO*Hs$QmL;a9z)8T83FoWhF]gsw~YO{{3~g=","SaveState_zss/F200/2":"ZNCA8zGWc;dCmrb+;ty@Q-5k@7$4|Yurjjql(w*0vW=lOd}e&OtfE!kaQO6RFwO_nO]h!_=","SaveState_zss/F200/3":"ZNCA8blgJ+,I!c2Tt;$QGLb0iZhUtJS]~CjlpKKpZ+xK|nBeFJ-hi4?LDXA8-gWNoSzH3?=","SaveState_zss/F200/4":"ZNCA83*KqEenoi0Vg7L&qWyvZ-nDb[gWrSlqcDK$xCBOjiIr@3lOuwFBDO1OQ@Y:WLP_74=","SaveState_zss/F201_1/1":"ZNCA8ao~1&clAT|u*ww=V&({usg?ff7-GiFJokO^cd1n]c:k&$HTNii@jYRw(^(2_:b2Td=","SaveState_zss/F201_1/2":"ZNCA8o$0OI:pVb|ybJb00V!!-d_h!@+eX=Cysmu1t_r)mcsU?lI]RX2N~QM^2FM*M)wFto=","SaveState_zss/F201_3/1":"ZNCA8,Fj!|d8bK{G}dP8H4q^}zM_)yWTUuqp9(VWz@@hJGKVe5H7g(:_f8;ov43+Ta2Ti[=","SaveState_zss/F201_4/1":"ZNCA8V&mGED$gCGdCv0c7~j*4ql(|N0X?20CM[pcW21e?VCho;Jp4(zEo4fv[cgQbnOH1w=","SaveState_zss/F201_4/2":"ZNCA8Y!yqr5?yx0au_S5u@MRdWB/](ohg7,O!$n:S=saKiERn}u6U6I7HDcAq[=bPs3()}=","SaveState_zss/F202_1/1":"ZNCA8ghD2Bi(QC&7Uz5mxg/~=K10&k:g2=(Ih-m$bb-cIsNsJG&v9NZa~12nuE{mWu;N7H=","SaveState_zss/F210/1":"ZNCA8Yk7~{T=slzuQC2=v?)~Fh@9s,PGFAoqfvnYK=E~z][j4_tb]*}f/YXD8tVF:bJAdj=","SaveState_zss/F210/2":"ZNCA8,M/I&8?~[,GXV_KoGyL-,4xxd0nLUMH|}oHins|~Kk3h|]Tg6&$0bW68p*EpU($-P=","SaveState_zss/F221/1":"ZNCA8v=0j,)NXWqG^$F+)HW8|f{(/8Q::z=9:==ZQgs1p:TOw$u,)V?9,+jJD]hw(${@D:=","SaveState_zss/F221/2":"ZNCA8!+YmQxc;syxR|nxG/tLf[x|841bbAKeiC&Esqj856K*Gaueb|ZzAY&S(IjvDDw2b~=","SaveState_zss/F300/1":"ZNCA8iwZjmZZQG:XLC,$o];g+yW{fCKEtH7jbnNNa~MmZuiz;O=i-ltpgi5~)omGj/T~8A=","SaveState_zss/F300_1/1":"ZNCA8a6,j!GK8YDAnu;*$^bKZH9jArVHt8-$D1^7y(q[0jk]EpS+vm{+)}2Ngo{6$)N4Go=","SaveState_zss/F300_2/1":"ZNCA8t_YH|8TddWE:st1E:tikXh5AfNb{Vzicos&yYpcHm}6w6{vySeG4$Lt}Wqy7:+=f5=","SaveState_zss/F300_3/1":"ZNCA8N3J)k,QU:a9d]BhZF+c6gxO?W_Cw?hJ:=YAY~KZ+lN7QzT=6]haugtdg^YhO~FT?g=","SaveState_zss/F300_4/1":"ZNCA8?{WP|P6VJDnX0TZio[V0D+YC!UT|xGIeT@klM?1lGj@A+AXs26R0;k-j,R&Xhr$8&=","SaveState_zss/F300_5/1":"ZNCA8@pG&,/+C08tPvn^n9O1YG6@a*~RKZ4$E(H(;ra;NqzGvSen$2M8)/^kYp10gp-tDm=","SaveState_zss/F301/1":"ZNCA8*gcVjK|Xg+o]Iq/!6-R&kH&e!_ucX@TTXxhh?!zPNgBEavmkf:+nvgsd+;MrRWmGy=","SaveState_zss/F301_1/1":"ZNCA8qp7bvrxe93A86V)-Mq:@vKBgsb2uUnmuYVS8+O)D3o1xl!Qy,I{&;/SH~FQZ{:)pK=","SaveState_zss/F301_2/1":"ZNCA8,ZA/:lwb[)iu|89L_gBC?qz:z-tl,iJywAMz~=8mEZ41!_N0~[d3l]@u]cmCHX!8F=","SaveState_zss/F301_2/2":"ZNCA8{:)vON~jB_kQ$Jg+kP7fKnWcPv4ZuDV{OQ)KDsXe-o?{[[({pbnyu}E3=nG4mp;s@=","SaveState_zss/F301_3/1":"ZNCA8W6z{gYyJNKC(XnUUcglWY,rGCS?b/,QKoePAd+c!@H|Ss*;hnvq&94+wMX474{g6t=","SaveState_zss/F301_4/1":"ZNCA81Zs|j?}vCd8_l?;rRwDX~Sl?W[dHGD]12mRpt2=@(Kh7ku2{(Dja}k,U2=oe2ymP1=","SaveState_zss/F301_5/1":"ZNCA8fD6!_Wtmj!x4CqgP-FGFOqKC)nE|^l]:/[_yBE&]br)AyrbrR&aL]-TUv7Of-Db[}=","SaveState_zss/F301_7/1":"ZNCA8x]U]hz^0dD7[IPH70Tu)yMEb75XCSR_YsrDj&[RUscUitFlz=:{=_m}jfY2T](rtS=","SaveState_zss/F302/1":"ZNCA8lUT(O$_yoc=i/+JFD~Dna-UYf2=zgNW(Kr}L3J;jW[gq^kULcYR&e~cAxIAa[@PsI=","SaveState_zss/F303/1":"ZNCA8[jyI)Lw=5=,S=cenI4)tTOir}D@|B$g&ek0q81X3&I4n0*+=zTX+2xk,&G[V)B{4X=","SaveState_zss/F400/1":"ZNCA8GdL;:c_f$SSdA[L9i47J~q;^m-&K0p&[RB8:V8qsq98KV5MNs5rJ@+cRGlG0j$HDp=","SaveState_zss/F401/1":"ZNCA8)02KuMQniq)FB/F-6tM]mK3Hp[ceG}a66sNuDG$X)zv[R$@*p_My=Jkrg4)x0iE~L=","SaveState_zss/F402/1":"ZNCA8xwtzEn@G8E)5o!K8$p@zR^uDC(w@j62qaq!ZK$|42vgxI8);Nqy-xW1IC&A4)X&w?=","SaveState_zss/F403/1":"ZNCA8-kGrY_J?_UmlB^aG7nb^UMF&n-uQ6KbXaf0P;)Rv8*j!HFm8-A6R9:T{oJ1b]gR@*=","SaveState_zss/F404/1":"ZNCA8Q!_fGqIh2GC_~;8qXwt[b[x5bTx7T=hpK:Ah{6)@l;p?JaE(@gLot|Gd2MzZ)hr:[=","SaveState_zss/F406/1":"ZNCA8/PxehL&bRzr1=9ppW)ZklNZH,K,Znq82ntl_56H!&U~26$V=b;jR(C/RZKpC5If${=","SaveState_zss/F407/1":"ZNCA8aiUHOhyrSX3YuRbKtj$kiwY33r+?h&Gn?~/ZGsyB)p1F8=7C_JHF;vHBxYxUJ$_D5=","SaveState_zww/A_mori/1":"ZNCA8;zOI[WoI,(55ZQvGu^WBXnddsk|lmbAIEwD{-G@V//4+DB(SrPA9FPs[MV&c_2CrcA2=","SaveState_zww/A_mori/2":"ZNCA8HXFJN@xc)-8vS5*nr4o5mU7}elP?ieIDK;i[314mS=Qs^jE)&wuFvRy&E!K[BU)tHA2=","SaveState_zww/Abesso/1":"ZNCA8{^_MOfc9@9tLg6Qh*wvT/4{C}/*EOv0^,&;*;(K@Zn_NVn~DD9{ZZ$!r!@Ab;NEFpA2=","SaveState_zww/Abship/1":"ZNCA8HT&gVDtK|6qUJV1@e3qddGX3/HM!x/=idXeOLY!iDj/&iEq{YXICl_KvEOrn1ZDWCA2=","SaveState_zww/Adanmae/1":"ZNCA8wkxL0:yk2wnhp8s)pIudwGxDe7aJ6S=qd3W54}8(0t9,nRSX1cOV4YuGILLXmOMX5A2=","SaveState_zww/Adanmae/2":"ZNCA8Bd6Cqc;/oRVi(3c9!*_8WbQJB/an2dQI4lG+N^vI94Cdsr1e)Iyq/4cc?8RnK_mA3A2=","SaveState_zww/Asoko/1":"ZNCA8Y9I:wHZN@$m3m@E/GUTHw8e]coek|vwy3Ey~j,0sH:VXU?FcA@j+*@:/+]&hAU;K]A2=","SaveState_zww/Asoko/2":"ZNCA8A5R&p_Ul)}G$tFNGyWZc!14}lxUC1_=FtVR}MPMchi=}3rFR~x[4M-x=k^UEy,&TgA2=","SaveState_zww/Asoko/3":"ZNCA8FEb(2ca[xEtzevgoOC{@p)Z,$Vk,(_wlshNZ]G^l)z)Ovz94W9u=,ff4A-1uMhxl5A2=","SaveState_zww/Atorizk/1":"ZNCA8lsUZ2e:bzI5hP=Fr=2;W)Jrh[Xinwxxe=K=NZLODf!8JN;?},|rr2FFl~za$guI/HA2=","SaveState_zww/Atorizk/2":"ZNCA8ESkXzXRK]k$5~o?~/Sw]g|KYb,8,$VeBpor1{,^FBnM_3qWZ:G(o;1KelctT(J$l$A2=","SaveState_zww/Cave01/1":"ZNCA8mm0A_l@$)BsuLst9vLT&~;Wq;NtBZD1{=T?)s27/z5U@1;b{^)[p6egZAcgah2OBCA2=","SaveState_zww/Cave01/2":"ZNCA8-y)(,[o-gPD~l${)!w9-I}SavUC4GO3-dKxy/P/][xktqbX8TeF4J5D6]lCpdq6=BA2=","SaveState_zww/Cave02/1":"ZNCA8~](*REG$kL0J!+qCSibq5Ei9}~U2ip]$$$,hESz/zrUIVGi)zZnIh}[swBGqwb3|~A2=","SaveState_zww/Cave03/1":"ZNCA84l/+kGQT~lpEuR&lM&v(L?t}vvPQRZhKPRwzJ^5FDn4vD=?B?pv_V)pVVODs8v-~cA2=","SaveState_zww/Cave04/1":"ZNCA8ojsEarUhdGjSABLru76I2No/=5)02k]$6u69[}GpYVG_)P/B*[Jefs8C2C9s;x_NZA2=","SaveState_zww/Cave05/1":"ZNCA8$:DDM*=;Nnl41SJrk6Cc!kToSmXi$}W381pSlvMYGn5J^vkwdbt)W_DCh=}P*j|,oA2=","SaveState_zww/Cave06/1":"ZNCA8XyB&((]a^OqLh1S7TY~b]8*R]Tsco(CLnbIRi_W8[nKw2cJOHc*74-X?Lya1UPZ8QA2=","SaveState_zww/Cave07/1":"ZNCA8IDeJ)K;X)Gv/:r8bSQs+K-PafEa806~IiN=!G(2GQ{XSdo87C+sn-Bej@EK|4g@BcA2=","SaveState_zww/Cave08/1":"ZNCA8G^$/1TUkr&HN)}N0p19[s_g){Q?Ri|MW3HD&N?z6{:ryQ_)cfkdozD)m:Pr^Ud?IhA2=","SaveState_zww/Cave09/1":"ZNCA8{gr5oa2=n&S)EFaXTaNj-U[^SbFS4[XaIBp1dM~rvMKrnztrabL]aCa&XAFOqm+P:A2=","SaveState_zww/Cave10/1":"ZNCA8r|7@C?G$pRB-ArFv(v*Cz&tDzB3f_YxrcrMpvN:+j~sEPlHZi|w-gY2a:-zPJ67M6A2=","SaveState_zww/Cave11/1":"ZNCA876OdN_9u|IFHo1!z?L72eOzJ3E7OdNKAd|{aDo&Er:&iSgI&MVDgzmSIwE/lrO,?(A2=","SaveState_zww/Comori/1":"ZNCA8q50p[w(|p_@;&ixg29K6PE:h*DrDhvyoY/Pp@o$=b6Z]YV[QMGVuZH+*P=Q0+HhSXA2=","SaveState_zww/Ebesso/1":"ZNCA8Ya8e&k{9RkqmqMv;|qGL5dXX-vj4J}V6-amV|Faj(]tOW9(32u&QDYOfIV4jr={{]A2=","SaveState_zww/Edaichi/1":"ZNCA81;o_zoy@fI6N(P_mGo}[DQS]h1?v6Xq/0Fqa@XyJ!iZcSdUJY0w+qA(HdJwe1~,l;A2=","SaveState_zww/Ekaze/1":"ZNCA8Isrlp8@R,ObowBEln?4mqfuG]Ybbbge4@Mzl$hzFG+S|na5Rt;2q6{33TRuSex8fDA2=","SaveState_zww/Fairy01/1":"ZNCA82t{2|TlswfZjKRuB)M&tOno9{M+2HkWBGjnW07sldO*QhV3=S&{{mV{;NM6;okfg=A2=","SaveState_zww/Fairy02/1":"ZNCA8WBITP)Lol-VzKV&{Tcs(tHy(jzazVGW(Kr}K6Npg(v@$d_b:]m5km-!R]y7wrLB2yA2=","SaveState_zww/Fairy03/1":"ZNCA8pVO)mIGld!E&SCD:=AB:)zZm+p|?Av/eS!q[S[7tiO,bjaDo(vM0N3m{A;AaH|M!CA2=","SaveState_zww/Fairy04/1":"ZNCA8Kwz9|4lY=DuFm/Z~Q81;=m1S=lV}9o(X&g_N_|r}o5ts1kMd+zS=!9FR=!Tp/3SX&A2=","SaveState_zww/Fairy05/1":"ZNCA8fReKdv$+|H~$Cn/p-mS1mf_dwLqr81:2)cLs4?^/4cogXmB33JvvGodmjitPgHNXgA2=","SaveState_zww/Fairy06/1":"ZNCA86=^GqspNqH-P])c(@(3sM|h&z*TqL/geQOj4+93?WUjXbJ6!{6aEZ$,6sTPz}PNstA2=","SaveState_zww/GTower/1":"ZNCA8ai$U~T|Z1bytjsb5+k}xcC$brfHZ()koSA{yYW-(@HpNt*7d:bmRCxEl$t}PT?oNuA2=","SaveState_zww/GanonA/1":"ZNCA8CskPsx[enVL_H$pb&}JLv$Axjze;MFpxb$@SGth:?Op8qDY-[!9w}7?wElGgid@cjA2=","SaveState_zww/GanonB/1":"ZNCA8lH78qG$3cyJhP&PZKCA_EmTqlvL-XfxIujZV25YS5f7YN[*jtqedQ+BCof~Fl@QE]A2=","SaveState_zww/GanonC/1":"ZNCA8ptD*M,]UH_NGE&7F?uA)7Lc-&$YtC+l!E0T5TD/^tH[T^R_]VVbcX!gonwCiEX2n7A2=","SaveState_zww/GanonD/1":"ZNCA8m;:=5Th!4;cDo7bvrNDM!$_Z?D6[d;f8u{hz&*F4vaP0Y:-L7h(R{[hj8=:6,oqP/A2=","SaveState_zww/GanonE/1":"ZNCA8E_|v,u6]]_!;S7|e[GKvoNm(1X?cOsLTrHn&RWxXEn?&EJ31Uo1Cx-U,X0RZK5^+@A2=","SaveState_zww/GanonJ/1":"ZNCA8Cdp{I34@/n7!P&cKQMKHe&$m0H&8XRaN4LdZnY)?X6n=QCaZY,c415)uF9?n;bIR^A2=","SaveState_zww/GanonK/1":"ZNCA8XQXcn+C7p?C[*C5RA+pSlj$}i7Fr+cRg)]K]+ofsZ8bfhbm(Z6L1sRhVd/vwOxX|MA2=","SaveState_zww/GanonL/1":"ZNCA8[xa-axHNzP+5cQN/TxuR5?/W6X4:~c)U]7;M~CSlhsXo{j~}ZaAf7lf2H+yG/*g!]A2=","SaveState_zww/GanonL/2":"ZNCA8YqD{=pCW4Oaf|nifei5K5qsRGMYyJOEzflU[5Kxy(JbqN}H+}JAtRpvY,E~-;iT^qA2=","SaveState_zww/GanonM/1":"ZNCA8qjPr6QRra9aACQA4no6_F87AgaoeMF3r=$moYg5*6IPfff;PeOz]8T64Z]Vof~[m(A2=","SaveState_zww/GanonN/1":"ZNCA8Li3[NV(826bF2I_s&&/la)AGn61]jgo7aPzwvS5byo)5mp~cP$C=a?rf_nO(4g|zEA2=","SaveState_zww/GanonN/2":"ZNCA8WZrrUrn0EB_&1Y+LeDIK{1AsU-4V^H*MyjSfADDl$q-H;r4TZjM@Y,uf99k(qf}@1A2=","SaveState_zww/H_test/1":"ZNCA8P&:OQ[^AUP,l8$_k$ujg+7zHXK8HvQLHB8Ebg5M/ZvoQ=x!)s6er~p35G(^GG9f4nA2=","SaveState_zww/Hyroom/1":"ZNCA8[94W,]kC,W,qd}Jn]p3&$^ifW:*G]6$srlbfKaV]n;Vz9n:/(:z53X|T,3*zK@P6-A2=","SaveState_zww/Hyroom/2":"ZNCA8Z-EU4E9HX*y=G^e@EIhi6jR}=BDVH4Mo:AAlpm}E*DghWSTNA)Y4xy!V9j5JV)CgLA2=","SaveState_zww/Hyrule/1":"ZNCA8@]qt=6*np][4YxA23avZxPz;R:!$!c?79~LzPR)T31~vz0xK;gMEQ@bd44}oJPL@iA2=","SaveState_zww/Hyrule/2":"ZNCA8zAPXMAG|S7O{Cqv0$wFWCcwal{Qy$D?*=hcS-E+SVfm{v=L0F;H~5WGo$EECHGdj&A2=","SaveState_zww/Hyrule/3":"ZNCA8fBPc@uBdYXCo@*]N4u?YO55,3Ie&4nW!4{9u{k!H2Tn~=]rIDv[exgmRQquOMhY@DA2=","SaveState_zww/ITest63/1":"ZNCA8]vnK$=Ou)-9&ZUR)z~T9A,GXw&x8,{pj^FiG4S&rP1cx}Q3rvW_*3=Qg)}&o[w!}dA2=","SaveState_zww/KATA_HB/1":"ZNCA8XF=OU70WEWo48F5xvdxhie6~qhV*Q)@+cZm2Q&!M?wB:~8tC(,X5_;Fu?-fr$,NpdA2=","SaveState_zww/KATA_RM/1":"ZNCA8VtK1[Or@/Kx^/i4cX;6xN?FHc{Y0:k$7vZ*:]5yLH/itc(_lNV)doBJJ2G_dtKFyvA2=","SaveState_zww/Kaisen/1":"ZNCA874mq9i2rVzadpyt;oz@~rJTC&vh+KFymNr|8Khz2*{zZ(rjpKp8T,O{8|;goL;C-DA2=","SaveState_zww/LinkRM/1":"ZNCA8o:lcRW00uLNOwl*rj]QLNx)dx2bV5,-,1Gal=RK64ME0/vGP??[g4m=rf~-0Ww_JoA2=","SaveState_zww/LinkRM/2":"ZNCA8;XIh9]34rc8B(60QFV9fwCv_t)g~[tq;&Mg~Inrr?FLVepZ=+j5&[bN*q:So4pJW?A2=","SaveState_zww/LinkUG/1":"ZNCA8qqMdQB[4ikCJP,~b=VVa+WkNyMecEP!^x1enNQ7W~NI4k_EpEke8{]tC5dvITm^Y?A2=","SaveState_zww/M2ganon/1":"ZNCA8&1B?vPJKiHDTI+1$rZs3Yn8~$q(Mn|O1XlYIX4I@h=HB+C$1?hTgRz,,pr!uuTQ?9A2=","SaveState_zww/M2tower/1":"ZNCA8li9Q}P{&1l4g2d+BCq4_oQtjo,VDd)mHB3Cp(|2/n88$rw+TQdcn^i]15h)_/(UUPA2=","SaveState_zww/M2tower/2":"ZNCA8KPMpx:=rkQu|88{9+Q*Mn]Hh1I+YR/e9eBFx{?r@rDTQ4E2$N-EoZrYJ300_F/qz5A2=","SaveState_zww/M2tower/3":"ZNCA8I5a=~MIKdwBvuIly)2,ZVFyF^zZCWIB4MtY0R@Vbi$!@jJBAVgkrqh9k[_UVSK&I;A2=","SaveState_zww/M_Dai/1":"ZNCA8:?BVJ{[iAEfD5p5?9d[{u9!1yMik3iNm8dXu8KRFgs/Lq2DzA/o:Xp|[xIiI(-qCTA2=","SaveState_zww/M_Dai/2":"ZNCA8lCLxi@Pjrfg0hW|u5V69qCE=Tr8(){!F9AukII==yI*02WEf)z@Nr2Jb9vB(TI$|+A2=","SaveState_zww/M_Dai/3":"ZNCA8_cu5_Ou_9-X42zJ-Qnl3u&7B1Bm1(f]$EZ5bfUfg(WUhP(^RG/&b1sXIVO87{w!=3A2=","SaveState_zww/M_DaiB/1":"ZNCA834=KRO+f@x~x-v{z_sW14C/&L$dQ[^JDh4(Xn)E{-LpCJL;7B4z9np1G{y]8eDq$oA2=","SaveState_zww/M_DaiMB/1":"ZNCA8ZVW7S~UwFtsE4+Or@7]hlwQ=:$?CeD,w:)Hh|)wOy9d|0KDkx;?g2Qwh)]W8ATOMTA2=","SaveState_zww/M_Dra09/1":"ZNCA87AVIow_G-]*$ev]IzoSeLb;2Z,29WtFjIc);f!Frq0m*SA*Q1Gvob,?NTa4/)Wg(-A2=","SaveState_zww/M_Dra09/2":"ZNCA8me]eFJJ4t[8Y|bY(3nY=VwL0Z{PrUWV=dR&M=Ig3GN(CPh]2m1Fhe^q6!VSP;H[acA2=","SaveState_zww/M_DragB/1":"ZNCA8N:_70Lt)?)w6TgBhhlgEiO4:W!^[i_l2@{&l:;BpH/0[j,__Qnxgs{KQbQ!3PtENFA2=","SaveState_zww/M_NewD2/1":"ZNCA8[G^/Au6?im{3+nRpIj;f~YwmKft,!C~:?UQp*g*l1vO,U*w+[]QN@OFYp;qcvIN~NA2=","SaveState_zww/M_NewD2/2":"ZNCA8@d/|gU,g!@4DfiMd|z69p68NLox&H14c}lQ~vM7,Oya3-Cm!^X2n}9]4@[tMX?2yDA2=","SaveState_zww/M_NewD2/3":"ZNCA8}HGpor_v0b0Du|2cVuq,u+eZXl8bJPt{uj[FX@GGqembGEg&P7isOO7ZF)}DNwNzDA2=","SaveState_zww/MajyuE/1":"ZNCA8rVEn~SfSGZ]|X@9IW]f&g2gN2odyE7ixPYRxbRZ[l)@PX!j;v+8,uU~Tr{6Bey(g9A2=","SaveState_zww/MajyuE/2":"ZNCA8ThE|lNFh1uP^(CTF|uD2:rxb,$$}[fz)h]:y2Oo[yC2dy&G^+q{z6zsOq6k*V0DWjA2=","SaveState_zww/MajyuE/3":"ZNCA8(LB!L@fp*xv_zn:0r:{r)yKE!K-?=(pl&Qw=jXezoX1-/I6)fi3pNiTUGaB+m!j0CA2=","SaveState_zww/MiniHyo/1":"ZNCA8E^,~mMT8WxuswnRc$8jMJy3tSf:2=@&b&j=zU~{1yQ;_pYOZDhG9!I;Lmk^N;:3x0A2=","SaveState_zww/MiniKaz/1":"ZNCA8U|WUU6O]}0KK41A+~-yl/}Mssvw8s@2y2H/t8u}cts{ZUcIMgul5Mh,qIYO)Fl&X/A2=","SaveState_zww/MiniKaz/2":"ZNCA8*{J(VES]weE&PKI${2?d04BG_cI7V}0C/y_{LUT!*I(=:-K(L4U0bq),LXLmmh}!]A2=","SaveState_zww/Mjtower/1":"ZNCA8u{A}:&_]PYi!H_oxN4]gw~hd6:$iHdL:I188}9z|Y(],$v39G,?ln^*XG1/+wVzXmA2=","SaveState_zww/Mjtower/2":"ZNCA8,M5R0e;e)k=cB6])XX7ekm7nddX]8st89AAW_=UxgDEQrD;orJciSrgl!=*jbzy&wA2=","SaveState_zww/Mjtower/3":"ZNCA88S@sMVkCI$;3XY3:&B^FRIxJ2u6QgC0iRnVqQ;A-J,[1}Qy(3:,^0;w:KALD1K?weA2=","SaveState_zww/Msmoke/1":"ZNCA87RZ^$$]=wnRUm2U4Bk_AB8^TFF(Ui?YDIYgmm~}zfOqKzYS5_21p/-(u4?CgLG*xHA2=","SaveState_zww/Mukao/1":"ZNCA8Qzyd=PmN&8,)ugakB?E@O{v^+x}_C_x/30Ns_d[[wnS2JlLy|]?83O2g1Tm1&*bd^A2=","SaveState_zww/Nitiyou/1":"ZNCA82B_}}F;PNuCsa0Rv-Uc=Yq;kwTM,CWT3daaZR|FU$/T*e-kr[v7_q-sQq&[-&[=:YA2=","SaveState_zww/Nitiyou/2":"ZNCA8F/J[ci^3[{9ZV*v003v&K@m0dUCNi^TfTb3$2JCJWV!{E]PSBM(GvG$/&J8iYxxa;A2=","SaveState_zww/Obombh/1":"ZNCA8pJ-HHliO,o+D-3Uj*tcq)3K~WwfqL&JXU$L;tcTFh:Kk9(Hrb!7lz3S=8yAC@jH=5A2=","SaveState_zww/Obshop/1":"ZNCA8N7ap~ik6$:mm$}jr;tl_7:@2I5jMmWzz}]/K9xa*aRn4~loo(|qDnY/SXy6e~si$EA2=","SaveState_zww/Ocean/1":"ZNCA8eMMmkz_gLI-+]a1V2e8iC(Y/X~5FMeS9yJ1}Is/aalqmREKpK/hJ7-1jHwa=67OWgA2=","SaveState_zww/Ocmera/1":"ZNCA8q$iJ|vJ~8inOcZ?)cy6)r}9PL&&cKad7&/wl$hzF(xGQ}~qy=aWx:h!8RR$BFf9ExA2=","SaveState_zww/Ocmera/2":"ZNCA8=wm16nNop6Op|Gf*o/mxpcv2XMT2@2/W]A66KLrokrgrq4pi~VV_=}!+/M6l(bq$_A2=","SaveState_zww/Ocrogh/1":"ZNCA8w7k6zn6h5*e9Gn8:ZGim9V7]~[$7oj6U=4CEfJvqEYdp120fNMH;rBKKRs?5enIN{A2=","SaveState_zww/Ojhous/1":"ZNCA8?Vu0=iPUoeOOg2L2XBZXJH[W51Qmh{g5rXk3mmT:nrBA;~c&YA4lJXgV!P~L)AP-NA2=","SaveState_zww/Ojhous2/1":"ZNCA8Z[uhlhqmZ[F7~vy?4He!A@C*=69$5~P7*Heo(gY[-zL$dyd8}+)|?~PK_p9~7Zu&FA2=","SaveState_zww/Omasao/1":"ZNCA8hyJ!/p|kN6zLbJ$0huu6V&W]}(x?!x]vc(hTGf?TsC37nOb3Uvgbx!)JxKj)Tp@h8A2=","SaveState_zww/Omori/1":"ZNCA8g2BU&dj3qY,)Rn9&9s;p7o0I2K$q,o$qo!Ckm(73/mV=Y2w~*MrehWU7rgtSMe_&nA2=","SaveState_zww/Omori/2":"ZNCA8aTvw*0MX]|95TB7$~w20tiK0w+3Yr@oOFKy;C[6WTzI(9+x[)_;_l*=L*YOW,bFEvA2=","SaveState_zww/Onobuta/1":"ZNCA8O[HNT0}2cPeOtzVc^^]ux:o)4Lkfd68bMkk-89_[R0Cj&xBLi0eB@i)e$p,aVUGy!A2=","SaveState_zww/Onobuta/2":"ZNCA8h!r/4[z2pd$56(d&zVT)D-7G((3Q+zSCxGM;&6,dJYXIM77~}+kEIm-!0}Ww)rrmkA2=","SaveState_zww/Opub/1":"ZNCA8m+3BIA|x$:Fzvzr/lTU5E[txN[TOk-H-KU@W/Y?)y*a@~0gL[*n?$Gh-S$feqlx,lA2=","SaveState_zww/Orichh/1":"ZNCA80{QIfn:^x[Cpw;iZ8q5i1BuZmYy~O$e4K0raI)M]gN^9l7!yTTelr=_@_jqrAM1xWA2=","SaveState_zww/Orichh/2":"ZNCA8m_tRr~RwnqB,ypz&A+w:KXbDMs_^}pY[DNDJ9ROdRa-k9Y1/Kt(8fQN+|x+LEMkWSA2=","SaveState_zww/Otkura/1":"ZNCA8~96q++l~S]&i4Q9zn!Gv@}B~MrMklN?(QBNz5NQB2^mn=X^lXz(6S@K[de$0LWP}4A2=","SaveState_zww/PShip/1":"ZNCA8{=4Hp2K9JVuMw83@c=Di7|8$KUC/C:jbnNNZRu(U/[^zSs,M}}*2saC8d7mpI;L}YA2=","SaveState_zww/Pdrgsh/1":"ZNCA8oWRWr;QU8L~E5&Q1rTc:1AVC/BcKTKe?p&U8U]I|JMcyYn7NS]xkZnDy~{XgnEeg!A2=","SaveState_zww/Pfigure/1":"ZNCA87:L,a4:7$hxGwzub9rPMFjjDd[SY^D,D@HJf,yB+U4oXMJ:aD12leWrR_FA0hQ-iZA2=","SaveState_zww/Pjavdou/1":"ZNCA8RR~ci)?KGtY3O7Dzi*2:&l]nSHjuM5]Xln!K1c~cDad1Ru&7YM}TDS&IpSn&*G:=RA2=","SaveState_zww/Pnezumi/1":"ZNCA8Ie&_-9&CED4cp=NBuL//UhhH2jg(f1SJHs&MbMP!)}*U/Q?Lo4Goglmm$N_jGi|(:A2=","SaveState_zww/Pnezumi/2":"ZNCA8&=Fc),{c9jQqw8vg!fCe)WxoWTG;@@jo&X8onhtwms6TIa!E]0&4BWhu@}+XpKu9qA2=","SaveState_zww/Room11.arc/1":"ShareData=AEb_zUcT^j8x[*BT6;eo+nR=n5POheUkMz/UB,*rWN^Ty8_GAJ9H=_5Uhqu9-X","SaveState_zww/Room11.arc/2":"ShareData=AH/Ie8n}R/UC_A~96nwx=gaH042^kOUktK~UKtj[WX=bAUY|K$TlCI[88aEf-X","SaveState_zww/Room11.arc/3":"ShareData=ANH@-Ue8Rd82]SXT()neWRui+3|eC]UtD,^T9~oQWD[yt9aktf8/^BXUbV7u-X","SaveState_zww/Room11.arc/4":"ShareData=AbYr5UTdlGUKji49q$pt+@KbaQFvlKUox:9UP(3~WBV+CUu)7L8,@?wUT-_E-X","SaveState_zww/Room13.arc/1":"ShareData=AP:UNUAG=@T]&4C9lG64XQrIIP~ddpUu2kCT&vSyV}Xj@UmIyC89H8PUG+bb-X","SaveState_zww/Room13.arc/2":"ShareData=AM}tpUaL?48)n!8UHK?nXc6&FP~Se;Ua&MkUI}q;WAH+a9MohA9XaS5UjaD7-X","SaveState_zww/Room13.arc/3":"ShareData=AI8J_9wm_o9VWsh9zNR:XeOB|P*{s&Uv+Fk9P9^WWpywfUd:m_9X1H&9eQ@=-X","SaveState_zww/Room41.arc/1":"ShareData=AXQ4D9hjW]T$)Ef9Z;1;XSo_:5Qa)=Ug2K;UN9X6WMm;vUCGDHUES7}9ygaDXL","SaveState_zww/Room41.arc/2":"ShareData=ARw},T|3zh9gX$2UWj/eXe5@P4!)&qUY6]vUF[IFWgf;S94p&Y8]G35UTdrfXL","SaveState_zww/Room41.arc/3":"ShareData=ALnN/UQ)529QPqsUoDFbXYY$|5piZ8Uc[yCUH8,FWYCN?9wsF]9BvR5UOXiUXL","SaveState_zww/Room44.arc/1":"ShareData=AJ^oj9zw9N8$)=6UPC=q-YCmlQB)p@UwfqjUKgPmWgx?;9S)@4T{V_O9khaZXL","SaveState_zww/Room44.arc/2":"ShareData=AZFJT976NrTjws79qx]O-l_:M4[4pKUkbQiTgKeKV2wC0UijrhTw-/_9kXC*XL","SaveState_zww/Room44.arc/3":"ShareData=AZ)S7T^iJ99Ul$lUn!+G-acnM4ve];UqZf5UR1zsWe!1Z9rvsw9clQ3T)sH4XL","SaveState_zww/ShipD/1":"ZNCA8H$g!O2xC{1!DQE3/3!q[6,We14a-_SO7Kvd8AkXc*xe{FshS*z02lc;aHvcH2Aj!8A2=","SaveState_zww/Siren/1":"ZNCA87}So@d7&/wk{sYX)09{BD&)M|hg5we/C$,p&D2Y8u}5TMnP5D0B+o;r4DDJY6+@0HA2=","SaveState_zww/Siren/2":"ZNCA8Nec)PT3p,lbPSFFLup-t!RWal{4Ag5*cg4!$Uil|,q!hYGE076LnH94f:1nIn7{GpA2=","SaveState_zww/Siren/3":"ZNCA8N6i2aqFSN-+vOP;~bqV4Y;0*VjB|JaJokO^im6pHkb?~pN/9ZSlp[Juh2Nr:~1-=|A2=","SaveState_zww/Siren/4":"ZNCA8i9?ErO:MX7yQ0ytSg$G,74dYz}Gck,4NX9eF}W^VW_s5oM:;h}pr!j;E@1w8N*x74A2=","SaveState_zww/SirenB/1":"ZNCA87/yi;1zJKQ_!TVp$w~&^d19B85dVb@(p?T+~/Wd0x-96!3rEPJN;Bi@Sms*:T39yIA2=","SaveState_zww/SirenMB/1":"ZNCA8FU-hbiO~p&Vu&VDnKfyEL6spNO{i^QZtZ@q)HbGiAH0P5?kCcV*Rh*?nnikn=2hm-A2=","SaveState_zww/SubD42/1":"ZNCA8OPibvEQ)u&WKQ8];o^8Tt~;mEeu^mKA&1[_,K3bk+IZ]v-0{dx-i;TQT+RrlQ^772A2=","SaveState_zww/SubD42/2":"ZNCA8n,+9pO5V?LteSOz]pnhtayYLC2{9pqrM)OrZW6FEX,oHI)Xj=f~Jh;/WhcjgHB~yJA2=","SaveState_zww/SubD43/1":"ZNCA8JAs]HK?gWrdjv0OVwQh~CxWPhT!wj)r0au*lmtcp&QJ^{&$$OUw_sf?LkklCH9NANA2=","SaveState_zww/SubD44/1":"ZNCA8_deRsaEsY!n(Lbnh~0kF;NOqnolFq46D!XIiSlItt:Gmr3MpNqe!Drd(bVwz0Bs[tA2=","SaveState_zww/SubD51/1":"ZNCA8P?hd1sss;3Zmvy2_~[:mTuP~$c^cfKas(8=j;TFzw:&[AE~PLcrxFVQ;!=h*i)RcKA2=","SaveState_zww/SubD71/1":"ZNCA8jdq_(p3DoH5o&B}gR7?sdACe(~O&7]@F4^YkWb=NTUHnb{T6yj4)laC4;)5OAa}L?A2=","SaveState_zww/TF_01/1":"ZNCA8eJY_]IVHFN+us(YDhF8W{mE7a/=:/)hn?//Yr//DbZW:(nxk+{yLWznA)e$x~r,5hA2=","SaveState_zww/TF_02/1":"ZNCA89YuaEJM8=ik$:DUnZ119ud==rjptN0pGSNF2m|2{{bslu5uQmSi]{VkQ:hP|_K&)wA2=","SaveState_zww/TF_03/1":"ZNCA86Mca1TKBvFw_b+[O=iq69{4tw{G*?=+lg{bR^KNu5R}7;pyqG;,uA-~U+DZM;V3l?A2=","SaveState_zww/TF_04/1":"ZNCA8bD;dSg[Oj4jkHbxBguP10v+38Z)i8?nMZr^3I0[|mMNYEzw|^t2eXnOyd|a1{U(d=A2=","SaveState_zww/TF_05/1":"ZNCA8+vLHiFAq)1n-MrUyNU_bK${ltSfdnj6tPVs{{q_{*^QN*M$PG,39x9UZ2!M]2Wg)2A2=","SaveState_zww/TF_06/1":"ZNCA8&pN{&O,MLkntKcYf*75wm4u)uUS/SjJokO^cCae[s!RQ)m|+KCVs7lQjdc8LDn=AOA2=","SaveState_zww/TF_07/1":"ZNCA80R&cnWmi|5=7YFPhr6P6J$0r^z{*Q{wTFHIsmC=?5^-m42De0woDdoR70fs$b))}lA2=","SaveState_zww/TyuTyu/1":"ZNCA8&!?|=4I&BlMm/_Y!JAJRbsTH(v$H*4j/w:)z!]Y|5wwdZH{&;x/{[p2vY_c:m?C$VA2=","SaveState_zww/VrTest/1":"ZNCA8B[OCowugQJ:t/(~Vv1QZinWjiS;I5Uik6$:l:;Bpe+4UEp@o(VH!k}6LCkdl((eorA2=","SaveState_zww/WarpD/1":"ZNCA8{hNFt:s{?TzWp:9tL]S4DS^9S@eOpHqHuiyv|}XDmzeqm8U{h_QJ3*I]TK0wn]5Q2A2=","SaveState_zww/Xboss0/1":"ZNCA8akYT^Ub9BBcf30s)aaOehM6/w?n[tH&B@i{=6tR|ZiX]lUyy381Dc|FWwjcBin*EBA2=","SaveState_zww/Xboss1/1":"ZNCA8=0pirHkf@b/gp*F4gmHdpak479-^B8@_24@_0l[ECK@{_$1=^2g@3lU6kk]Q[PqadA2=","SaveState_zww/Xboss2/1":"ZNCA8s9J/l61C{9iZ-oPM?QPtpmx0Qn{Q~;H-KU@Zh?7C[$DEgSJ8tr9[!va?Z2HqDs^Y]A2=","SaveState_zww/Xboss3/1":"ZNCA8g{aTTr/J()t2PvxVyOv30n9Vo:nsxyp]3=nZW6FE5l*&6&loCv6?2TU~-Zt[g}AFRA2=","SaveState_zww/figureA/1":"ZNCA8:fExa::i3Qr@9v*n,K[Lgz}dJ43wHJ8[~_pXKoY1~R,[3nV1o_]HpvOWDH@hZmF+XA2=","SaveState_zww/figureB/1":"ZNCA8iAlH3F;77cM_^|B[G58!@2CaH!RpbBWchsoXx3?oAas0hV^sgJ9aIRS;o,Nw0W=1*A2=","SaveState_zww/figureC/1":"ZNCA8ZgRH;Eih4QKGBVT_EYz}KtG)fuOQ4;h-~jyzJ^5FdG^I$+6v7gXaEd-FN{gY8_1*8A2=","SaveState_zww/figureD/1":"ZNCA8q[dqw?Ay8aQ2vh:P&OKmsJW;Icj2[AhKPRwz-1!H*RrE)mY5N+!jmAGNXKLWP:1K5A2=","SaveState_zww/figureE/1":"ZNCA8lnlBHpuc2m5P}[?;)I:QXrhP51kit0Pg0|dqR38$2!~!6Y1D]t!Tm__,)1*dW:/[IA2=","SaveState_zww/figureF/1":"ZNCA84mOt^ZRTPD=us;4Fih^SRnngYhE3I~YRh*BKe?gfjxK)+S-sn&XIdF{K|:N,iE9TnA2=","SaveState_zww/figureG/1":"ZNCA8VBEa{wTFHIkfHr)uK(dv;iU/T9fX(!xrcrMrN-b:8?khToyRqRivlu2,V::CHg07hA2=","SaveState_zww/kaze/1":"ZNCA8oGL?NS}h3?V/B^&*{-;dWV]?@~^[w-Q@rPfAwAvyEkot|?amPkIWN8GS?QNxa-Tv2A2=","SaveState_zww/kaze/2":"ZNCA8Re^{p@Uh_j?xygHc-dIE?*n~CZ-sTN3;fWPvTZ7BSr_u~X3M1mCaymLzi-1pC,5@FA2=","SaveState_zww/kazeB/1":"ZNCA8+sH,22f?I=sl;y|thf4WML2Fbv&Z-Ya;ZOaHynikgN[YcC00RAzn6qESDH=MoC;hqA2=","SaveState_zww/kazeMB/1":"ZNCA8YR0iUl:5g}KH2fH2/A2t(DEpOp|7v_9zj[o_ee|@(F/PkkXHzSbh*4eMrl;|cq!3QA2=","SaveState_zww/kenroom/1":"ZNCA8PuVOB/eS!qw/{7eTSx3;)xX+Ruqqq0jrV6(yzx])g$nf)[S[9D_NZn-~Ud/|X-/,eA2=","SaveState_zww/kinBOSS/1":"ZNCA8VKw*_P7y*PI8ua]gIpwm&~24IiBWm+uR5wTMBc*4;}w1NjU;-kB{b3]fMh|$D_=67A2=","SaveState_zww/kinMB/1":"ZNCA8BP1;^@=~$p[Q):)7h[C0v1yQ_W)&FK-&iPpQ+xa8t~aHolNQB72^pHv9WzQJql-yfA2=","SaveState_zww/kindan/1":"ZNCA817X4&s4IV6yP-AHx|bo7ZD2Py56[r[2y2H/7R*j/N(7I?-gT7MK^M:k,;ApMNx;XlA2=","SaveState_zww/kindan/2":"ZNCA8~YwaJz}7C~KZEOkBKidZyo/bd[M(~G?}_&0*~,cPQk@NWG}W_0=I~HXn8jF[BJFE!A2=","SaveState_zww/ma2room/1":"ZNCA8dYnHC[5Ftj1QYg{N6|=q{KK@2$@gu+HJpC[Wq}+(jyNO97(2aWt+MbWw6zl4rD!,mA2=","SaveState_zww/ma2room/2":"ZNCA8r73OK:(ZDm;cwT$q09kH&wMX]:*5?Lf;mTXz!wd5v(dkmXCTw}~uq5qMaOFa/2_]rA2=","SaveState_zww/ma2room/3":"ZNCA8@e)yoN4bKV34Us&9i(XV:w3w|~btYBOkjQi-15J=cs)?CGCke:lcykn{K9xio[}M2A2=","SaveState_zww/ma2room/4":"ZNCA8(G(Eb/B&Rio6BFAA/^UZUhn^{MJvT!g_iua,5UU9o(+x|)x]9_tx9k5=x,yHiW=O4A2=","SaveState_zww/ma2room/5":"ZNCA89i[|L$kgRav|fGDdJhbNJHW(~uk-ZDI7w3lcIxf/lt_)|C2]B]dB!u!GF@99DHgYfA2=","SaveState_zww/ma2room/6":"ZNCA8)Z}M?D,^@$w/e=mUf2^&h8[]jkugbhwm&aa&xYsvbmxQyN^Jlz?r[InsV9xIqBZvhA2=","SaveState_zww/ma3room/1":"ZNCA8iC:nO}Nw-T)^XUWDOYg+yME*jf,@mPMQniq6UmdH]X/d@@tw)BV6&)k&}Vy*gy;|oA2=","SaveState_zww/ma3room/2":"ZNCA8iFwlscc:nZy+N+]+$Y~;,^(9-7SC9J?AGaw*c[iu,Ur/&COi6TQ~)*k$?(K[l!OYrA2=","SaveState_zww/ma3room/3":"ZNCA8HAdC}Xm6/C~gtBLU1eLCn}b0dhn{q@ihg^s_Up4PX9=7/dw&Vh-XJGz9FScj5h9k~A2=","SaveState_zww/ma3room/4":"ZNCA8+l{qua&k2KXCqQ}ON@,kTOAAsTbhXTGyZ/AA$U)yM[yY27)NL~H]w7K2L[vX](JDWA2=","SaveState_zww/ma3room/5":"ZNCA8~gdZxZm_gvI3$-ebv/L^@(E-_Y*HR^sV*-}e7?K=2vuDu[07k8A=q~nd!M;D-?mKCA2=","SaveState_zww/ma3room/6":"ZNCA8$x^pOLGxmP+G_m61;4?at:UY1:a7jJJe8_)c)d@4eyef:g?t:f=ERLL]xnt](X{MGA2=","SaveState_zww/majroom/1":"ZNCA8t!qHP:@3^?CqCZ51rF4W&EhixJWgF}Mk+?+NHa$=0C6N8BO!xgt|}YP)6IAm1jF8xA2=","SaveState_zww/majroom/2":"ZNCA89mJ^IW)CBdKv9=*dR3?jpN3AjK~)cE;2mdmDeG,kv4^n/:W(GycEH,y7lp[orEG/,A2=","SaveState_zww/majroom/3":"ZNCA8iU)7U2/Wz~1k_*7iy^k!7RL)P4oqK/86RM$]:xRvdyt7{kx~Z^Cb=9TMdoq=h/$@oA2=","SaveState_zww/majroom/4":"ZNCA8jM46=EgOLWMPM_$FQi9l=tEYxn[Bj75qVh}!CPS4)eE5O7b/uX/kqaI8yZ+}WN0=GA2=","SaveState_zww/majroom/5":"ZNCA8qSe^C{hl!N@]?h7{@^^jyJaK,M2v{M[0QUfo]S^bX8=gr0B&7hSFO5g*^z0M:$]v7A2=","SaveState_zww/majroom/6":"ZNCA86B63Ud1rGQz4norxxTspO09oW?Yqza39!,iX&ZVEI;tgjM+&a~:oO$JI2|?rBT;]cA2=","SaveState_zww/sea/1":"ZNCA8MW(}Gu/nlrW(?Kx2_|A_Zr,eIp,nVYj0=*{uJc*)Cm$Li25]/l7B}3BFft-}V&Bh$A2=","SaveState_zww/sea/2":"ZNCA8ViG{O!5H~mzZ(Wpx:|EIKUp*po{MX=:^~LkN{zX~pjhSx+L4IS2hXmc+Emw/D,UPsA2=","SaveState_zww/sea/3":"ZNCA81ll85m5L}Hl]|5r)gWMevjkcSmE{q+l4XONXC[coo5tdxYZpX++U)0AUq_f~,fW{oA2=","SaveState_zww/sea/4":"ZNCA85|TUprK6}eFwztL0&-5|V!jSP9H9!PkKup+t(~c_x^u$mlO@^^q:!I{IS(1W~Wp&DA2=","SaveState_zww/sea/5":"ZNCA8oTrlt*E&Ye}We:-~+)JPTde^3,SJ_*jOc1_s3H/az{oYkyaav1cI;4+xfFK8KWsgUA2=","SaveState_zww/sea/6":"ZNCA84(YbLw]oYZUJ87i[0i$FR?h/05(7inS6g^XjO]dzd[Ctt?TzD35:RnRk*k1thCk;EA2=","SaveState_zww/sea/7":"ZNCA8T2Q0|0,2[:d(3M=l+ddta|VY{T(TpB;ul}udUX]{E_*EwJYZ?p_w&~)_kxPWVX|wNA2=","SaveState_zww/sea/8":"ZNCA8qJ8K7L*uuQ/_2^+O&0&hwMnA!AQ=TM+WmK7{kRVmvJ4L{],wfvvN2![(hHq:/$ljqA2=","SaveState_zww/tincle/1":"ZNCA8e,G5uz5ZUCV{4*0eDwSPsxV10X&hhwtf8GV[S~0rTzRwwGHU|b-sJ?u*FbG&Tg+@gA2=","SaveState_dks/m10_00_00_00/1":"ZNCA86}m13)FPUES;QS$](NGsk$e-YhD-X2yT&j}&&llxZr{mGcKI&?FNc,ZZpnQCpK+4:=","SaveState_dks/m10_00_00_00/2":"ZNCA8T|}td52ock7=?/Szj[AN4Kw?JEnuwkkaT[m;C[6WzQ:+xpf(It~lJe*D{M!cZmcke=","SaveState_dks/m10_00_00_00/3":"ZNCA87t:7^m4T;*&V4_CrO=x,a;zSDF10^06TDp/n&T@wqw^|IFr{Zl,Z~Z!,!F2hy7J-}=","SaveState_dks/m10_00_00_00/4":"ZNCA8$DUQz_lu3K7LVW@*)7[_HHBITMWlb^([@5,q?svT+qUc~{-rfgV${0PN-R|oS:}AK=","SaveState_dks/m10_00_00_00/5":"ZNCA8kYK2G28}bj_{2G!St:4h}I2~9~j5BQg,:nnv!W)uN3InjY2ALCE1*Vee5g@J15f:1=","SaveState_dks/m10_01_00_00/1":"ZNCA8da]R,49QWwraxhSTg{ZlScW2TurU[4(38kWVxS$e00])wVhpi_T6Y&AgXC/kf5,7[=","SaveState_dks/m10_02_00_00/1":"ZNCA8M=3ih(vgGw{:G7[bHU!92K0~wscfZm7Gql:s8uDJC2g:Gl},hY@;:()xe1M)nYxY1=","SaveState_dks/m10_02_00_00/2":"ZNCA88}c&WGVFhW8dW9_*vuq7VYQC(?Qa[Z?X3W*C,v0HHA2+};07ZmeKEoSSmbPhNL!)s=","SaveState_dks/m10_02_00_00/3":"ZNCA8hv_Bnb{65-@AAtfB+[|N3&$SP/@lN8IxTzwP!)LyMRBBuGUbu[3=fSDek;-]U2yxM=","SaveState_dks/m11_00_00_00/1":"ZNCA8h;xH[KF5nQ/@?zXYpwZ0$oV}]Qy*By4/W782C:K{l30AxtIPZVYzYnk)UJDcowvye=","SaveState_dks/m11_00_00_00/2":"ZNCA8l9Rxtq0mH[ITW|p/9Uj&SvODzs,!93(zTp,L[F@$(umb^V+^Sm+3^b]-[DgMPw}=!=","SaveState_dks/m11_00_00_00/3":"ZNCA8w4KAHXp}Q{aDX6coy1[Y_ZTR($g^IpZU3Y7jo${ymp28Y0aO~yx_O^uGI}j*WJ+s}=","SaveState_dks/m11_00_00_00/4":"ZNCA8xN;b;v*]^Ly*B/kdt&O+,$axzv[[GEnlOI_V:d}DF{|fN@-Kf*p?l1|+vOz{&dr&N=","SaveState_dks/m12_00_00_00/1":"ZNCA8[TfJGNLpwC@o!j5HeJ|ReI|237hItg8/:kWQ7?+qr9zaRxVPVcN)SH]n|:K0FZY:S=","SaveState_dks/m12_00_00_00/2":"ZNCA8rRmNKAOU$Z6_;TBAR;rV~MN^sso&*JHz{VvAu@=,*$v4I]$Z-Xm+~A0410-i[4oP,=","SaveState_dks/m12_00_00_00/3":"ZNCA8Bni=ACeum7OU|qd}CREWwA{]*o3j*;wmf^Who4]v=yg@51oHkP](L5uoS?kq1M9rp=","SaveState_dks/m12_00_00_00/4":"ZNCA8oj}8M3wvG|n+-[w7el-uX^i]!v,d|WB(}Pb$]b8k7IICgxF(O2n@3x2!~2-9Z@p@[=","SaveState_dks/m12_00_00_01/1":"ZNCA8x;D4yDrtHF]mL51ltgfVy@i^8U+7D^j$4A4-_tXo8O|?~[cY,[=CQ;wyB@S$_^1A:=","SaveState_dks/m12_00_00_01/2":"ZNCA8l,!(CUVMP|cfHJg/;mNcdz|=cR3oGfjM*,2]5y4~M{ycOEjzY=$F!g9bliXe-OlWF=","SaveState_dks/m12_01_00_00/1":"ZNCA8lOr!~vCevdUrCw4{y1sK=io4+iS}w^F4}pTOQxRyK?6V+a22M;d85X{v5avWrafN,=","SaveState_dks/m12_01_00_00/2":"ZNCA88WRH^UmtpbftdFGfm^Te_GQ+iM2;w^mvnyt/(92fPkQu9HA*B,QFHqLy^w|q[OI7q=","SaveState_dks/m12_01_00_00/3":"ZNCA8YWXt;V}hKkdNn2L8j!LC3Qne!iKa,6ixPYRnebBpU(Gca85Bb(ZuG]!_2@m3]wJfS=","SaveState_dks/m12_01_00_00/4":"ZNCA8U|ApCKWz!1&Exm;eiKyzsmaBOH+;9Qpjv,efrteE/cC^eCNEWi?MwZMSy@Z8m]+E@=","SaveState_dks/m13_00_00_00/1":"ZNCA84Hg,NKely4I0vB~eomYKtKx054{du,*9w?zgV3ikSE5p}J]*2y6-X&0LPc2X2](PC=","SaveState_dks/m13_00_00_00/2":"ZNCA8q^L,ffkEE::&;36l}ZsTsjZ0d{[FU[Y~xy:m(nSY4h[KnNH}T2]UAvl6wbRMy-{oj=","SaveState_dks/m13_01_00_00/1":"ZNCA8!uL]pmXcfnI7/[Y[-=M0bnMTE1on-V3VB3!Gwe8Ot/eGvB*+GyWy_1smpNAfK1pw6=","SaveState_dks/m13_01_00_00/2":"ZNCA8!S~:pwT((z@WI=Dd!pqwoe4X9$l)uGdf[BiMH(!y1}/1Ipr4+J3NVAAX6c:qZv9-j=","SaveState_dks/m13_01_00_00/3":"ZNCA8Pq*z@T)!S!O(I{tGre@K/p{@*XRRS@Bei[(@b9/,aFfk*d]5:tu;}gZLjP_*/+=m^=","SaveState_dks/m13_02_00_00/1":"ZNCA8/DZ){5M6|_B4jui](!p+IGz*/Ic@4s?9t7Tg&NC/m]wG+I@W@7L4TMUr7^V4]_X$~=","SaveState_dks/m13_02_00_00/2":"ZNCA88AKr&hJJwo;FVTbRPnQaimr8YzGTaEa;Zdfg[1h0L{e:,!Rf*u+[nYRVCQ/Sl(/]o=","SaveState_dks/m14_00_00_00/1":"ZNCA8[rN42umlAGV:s4(NOMeqWEu^6=hDHY~YiIYiWbEHgxpDp[QlTb={p8l,!j3f~j~Xq=","SaveState_dks/m14_00_00_00/2":"ZNCA8S$v8ZAn10SvBHOdx=hgSuaHm5)p)6;3/{0dB:K0Iw8fkv5olPWU7l^pe}V1*C~ZKg=","SaveState_dks/m14_00_00_00/3":"ZNCA8ntaI4@!C^*nm9hL?&hNyKLoxAP8JOhk-ua7Qn)]+xLl945T$jxP/QzRde^+iyzpiS=","SaveState_dks/m14_00_00_00/4":"ZNCA8MRdpv8$oqM+|-Rjc-@MtR*EMT63rDboG;a:W-aYGC/)JC1T11d}MVUe2U,q-TV7Z,=","SaveState_dks/m14_00_00_00/5":"ZNCA8M56WB5jW]!tz/IrQ*f{|s+V:I?:=Z-[46LOzqtDUg5bL3+TL@~DRGH:1TE=z@gSx1=","SaveState_dks/m14_01_00_00/1":"ZNCA8uIPXao~mylKwE=V?~[&u:5aL9Kn;zbr4xFacMypHCG~}=/,Plf2S+}1P^O:+:n?!h=","SaveState_dks/m14_01_00_00/2":"ZNCA8cm+wCZA;cGT7~AdCs(z|gEW8gpv&J1z|CvYrt0/HPs[mG@jPZJe-;Je?s5,{lbG$e=","SaveState_dks/m15_00_00_00/1":"ZNCA8s[AV9[HOfTHp{{C@mcSv/|=Z1smjuHBq,wK5V:F*-,=|^1C5(nM+7F-RDN6QHk^-n=","SaveState_dks/m15_00_00_00/2":"ZNCA8+vj^6q7r/~3)(OOcq@nTD2670Tl419Ski1(EYOtyN(eEP_a2J4quP-GEU[on;W-_P=","SaveState_dks/m15_00_00_00/3":"ZNCA8z-VqoY*Mfg*!_wV+0}TrH!gcUAT0Z6KV&FWY[nuJ~wh+x7n:9sQgC=xO8?*m2[a):=","SaveState_dks/m15_00_00_00/4":"ZNCA8Yx1-[:4iQycDWJ4qrD,{EJ)GYzQzV$lTdpBp)Qw,Cl_27DY87Bo8_PWbxk^)~7,G,=","SaveState_dks/m15_00_00_00/5":"ZNCA8r17/d(K+ghnJ6u,{n*-TJD_6Lw|M~Xv16+v8j[3Q,{ihgb(:qB-;vZ~Fd(wje24DT=","SaveState_dks/m15_01_00_00/1":"ZNCA85W*aRp?WM[~NNo}WhH8BP0pVp1=pN[r|M^d61w1]tL3;ndQW(W/QV0Ubdv/Fd,eTi=","SaveState_dks/m15_01_00_00/2":"ZNCA8GyaeaahkV6/9sH=]4r:c+!Z7{b&ELzekXtd642aj:}KUrneJ{cN^c*wb7Z7$y6U)|=","SaveState_dks/m15_01_00_00/3":"ZNCA8XM_RpvT?Oz=0;L-kaKkb[mos$XQvu+=K]t8a:}{W3&5D/~@m~pW}oG3e0D2:)zuV5=","SaveState_dks/m15_01_00_00/4":"ZNCA8H[|-Q)Bptg[C;$7)2M[OF[1a77fS!!:MeGkn$5sdXAVdRusmjgYilZhCSK93da)$^=","SaveState_dks/m15_01_00_00/5":"ZNCA80{gk~s}:NsX/YXOk|tKtW*c0B!f8gp&,uCAjoOv@c~eZOM7ww0u*dI,26lNoCTPX|=","SaveState_dks/m15_01_00_00/6":"ZNCA8mx()OuzpQ[Y}^:]XmEG[~Eb}h(6lXzmT9Lm0;=]S{-(&WEM{Uyt!1+(ZAnRh-mN2F=","SaveState_dks/m15_01_00_00/7":"ZNCA8e1Dau{*QnqYE_/6*jSf7DYkKm=/$rjp75_BF?U=uT_gUyfbDvL{wV+I6HHZ&@^@*(=","SaveState_dks/m16_00_00_00/1":"ZNCA8D-m$~+7IWr[TWL{8}H*6;Qo$!;ATZm3F-6VmUHR=,BiK|Ri=SDiBMPnmIdr^*guMb=","SaveState_dks/m16_00_00_00/2":"ZNCA8(8jeP]017+ldKYex^ZVQ@C@3E5Up|VgyDVxakVV@MGtF+xe0:~$F$@SWts?Bg=]B8=","SaveState_dks/m16_00_00_00/3":"ZNCA8)KIgB@o+=^e;^@/xv:0sBggxP1~/c@y,cBCL8VQal]ciW,Ws6xfROip(}Cd^=]jTG=","SaveState_dks/m16_00_00_00/4":"ZNCA8Oe4TPoREHjantB&s+DvmN4/cPN?^k{*UFoG)-orwfslTP0u@XXy|6j$q^7mwY~JcA=","SaveState_dks/m16_00_00_00/5":"ZNCA8MoE[q6@F(g4K3Hy4Wa/hAsg~AU=!ZLBpg]8~@r:2AnbLB11]_zL*nX_RPqmjI=o(b=","SaveState_dks/m17_00_00_00/1":"ZNCA8Tv^s^_@l~mmOhz58;0k?5EziEeRwSM;n/0/SjqnX;mv*NU64pk8e7v9$0y^JettR2=","SaveState_dks/m17_00_00_00/2":"ZNCA8wWXT(jSx,PKX06y{r@C!_I|L!-Cr)[!5Wsdqfg_!$Vqj*EeaZe+[H&XiPBDix:JiU=","SaveState_dks/m17_00_00_00/3":"ZNCA8]mYV}?w8y,05]CZa1kS26pOc&c@uki[Mh~ZR5FH?P=R;4XQ!EB-8sUBaK3Y$5S3I&=","SaveState_dks/m17_00_00_00/4":"ZNCA8vQ5V{?w/Q}P{ilGiHr=;iZ}O3a^;oI[:waeYhVxnYem$29?]njs!!mRSrt]8EXr4N=","SaveState_dks/m18_00_00_00/1":"ZNCA8r^vTFv/RmL;XCF^t@$LN_E/l-mah{cart$1bKOAz-=T8Lltd^oj2sb@hw,muUAGMg=","SaveState_dks/m18_00_00_00/2":"ZNCA8T6U,XsRM{Dt:poxy?@TpaI;5^wz}5bB?;_aa}i|5zA7}mJm/Ue997rsRO:^39xX_I=","SaveState_dks/m18_00_00_00/3":"ZNCA8L-B(*1o;[FiPN=IzJO8dmRco-k;2dyyg~*gD4EQeLToXJB}Nde1(rv0Hp2{HV12RF=","SaveState_dks/m18_01_00_00/1":"ZNCA89Homcq6]t{KHLs]nJn3A?M7v{}QwBq0N/FD[mB2gu}DU=8R&cU5xr3huCinS&P]j;=","SaveState_dks/m18_01_00_00/2":"ZNCA8[kbVyW{ZhGSMpT-HiajFP~+dW?oyQgLP4J$0_pbFk:l~15*j^X3$h0+!d71)nOP0+=","SaveState_dks/m18_01_00_00/3":"ZNCA8s_9hn[F5gF6Mm0!fWV9C,7FU,Hk~LC9L00L]MVPAzG*;RBRrq@E[1GGN2/My!NIAZ=","SaveState_ztp/D_MN01/1":"ZNCA8[bB6H$3(rjL7A0=C,]-__SO$)(xN9_}EWtC$Y4GEsmAUGnL!&^_b/A4sJd5c-R[-B=","SaveState_ztp/D_MN01A/1":"ZNCA8QPYSE@sXseD2NgoiGCvidTZSW11!/KH+H:0+~(bq@^uu^CQ@MXj}g8V512$DUu$/x=","SaveState_ztp/D_MN01B/1":"ZNCA83;HmhbRGwRLPq}sR|)i/~wNdapno?,udjar,s&4j:0nqsYt@0-bs,Vrb7Kh//thNL=","SaveState_ztp/D_MN04/1":"ZNCA8h,}Ac/a6*&$Q:Kk+f}0nxe?mw:~pWOxFvb)bmVma8?OWfHYCJ-S6E*moOx1fs0Eaw=","SaveState_ztp/D_MN04/2":"ZNCA8$dozNM~T;,_U4Cn3nMopB?8u3elxUl&xDwKdhlrgLnWaGugqX^;aAH^RLJ-Nr$B8J=","SaveState_ztp/D_MN04/3":"ZNCA8*a&agcISWr6,pR,7Y6Io8+F;v+,6_7=ez]}q4ukpsUZ7tKe;-pq}$@!o5y|h*xpnF=","SaveState_ztp/D_MN04A/1":"ZNCA8Y08(!dLL^sRqi2a;l)g,D2g&C($5IN@yy_Uxw0iOG!j*|hts=NchTwpUs9N]rg)s2=","SaveState_ztp/D_MN04B/1":"ZNCA8U^2CB5ZM2X6-7b]oxwH3$he$,yVZyDy@u1^!|s;rmgy$BLqIlxMd!@|6Iu);;rI*a=","SaveState_ztp/D_MN05/1":"ZNCA8@A]_]xe[B7*^qWB7U7Uo06;BkH,GrjMp-CUv5GsIDszYjxCw}ZRS({Q=P|9RcN?DT=","SaveState_ztp/D_MN05/2":"ZNCA8Eck9^PcXLt&XrkvA!X2:srLqm[t)UGRF0-J&&0=5ERMeiM{|Wtx^bYdtF;QM{-|x:=","SaveState_ztp/D_MN05A/1":"ZNCA87bjsY*,:a[iuvn5XT=@oWsS)VtsN3xwRL&(&Vz5/FN$s9tH-a~YwSmUh[7pGY4}H-=","SaveState_ztp/D_MN05B/1":"ZNCA8xPFHV2FM!1Z,XsgC{Axb]X$wkK1RU[EiHTjR~?_4slSo(VH8m~m1ZKEnxsK&RO{8a=","SaveState_ztp/D_MN06/1":"ZNCA8_(cs@RZ-&I58-AILoO~Vm*YGZti}7,4/W78yqX*b=&4(OS&5Fq=Sy_&FZeux{S^:n=","SaveState_ztp/D_MN06/2":"ZNCA89jKx2aB-hiW3;~QxtLsmg,TA*)kc/~Z26~liX5ymNqVOTlha$X273T6uBGh4DR0;$=","SaveState_ztp/D_MN06/3":"ZNCA8Du3/jSpI5j/qra=b45GMwVP6JQ,p}thUj^7gk}:]]d!P:YXA;?N4XRl$Ndz/)rY8T=","SaveState_ztp/D_MN06A/1":"ZNCA8XQs1t!,}-[gU/kOq4?5g!Z{+lxY:*dd,2bb4jiu/!QW@hH9B_g*wN?F[o,e?M2K2|=","SaveState_ztp/D_MN07/1":"ZNCA8g7,p7yoP0KH^y!Y+ca&Zl,xRJ?^-?CWfg2[hP/I!@^rXhqSJqXGn);{HX!ff4WOPX=","SaveState_ztp/D_MN07A/1":"ZNCA86F1jiBoz=-TTA,Zn0*EAe8!A]EYY}jp?*/d/Fj/u=!H|plowWkdbFx)(-IG!T7UMT=","SaveState_ztp/D_MN07B/1":"ZNCA8KXJ^vr@pxcbh2);Jlz6o*GzMP/=cz&!@@TZlu6eyNfCGki5!sp7@N~iRYg1N-BR?7=","SaveState_ztp/D_MN08/1":"ZNCA8b~muBPYi2o![*U~IV1wHx8;P4C|PZ|/&qS8~D|J@!W=wV0z2VTQi-,Kg[dDDA)!9v=","SaveState_ztp/D_MN08A/1":"ZNCA8l6-@wvUPy!o~vOUO8sb=$Xb:o,(WKgNYZ)+JkXT,Cy7/4d6jAyjLemP_|[/x]?29!=","SaveState_ztp/D_MN08B/1":"ZNCA89??0(id2;@pcEQ;@W@)BHzS~!!~G@NUQT$kips~R+Q{0]pnJ3Gnp,Jih54AxAI&Y9=","SaveState_ztp/D_MN08C/1":"ZNCA8rS?qj[46LOA;ZgX4Mo,X(l:LC*65(ZZR|_p$QmKZl=],ww(|QMA4rQCUj}*y)@&I^=","SaveState_ztp/D_MN08D/1":"ZNCA8=/nD+@aAeNyN0$}mD7VWq~~=Tbsd?:$srlbbx;GTi[9Eyp/BWRiK1k4{uI|{f@-GW=","SaveState_ztp/D_MN09/1":"ZNCA8lN1+[1D+nS_/Zm)hf+R??bjrcyQM1J+;uk7e|Kd(*bpRvk=67Gt]Sr:=SlXmf{!25=","SaveState_ztp/D_MN09A/1":"ZNCA8P;a~:5-|2t?T_o!M22d$8DCl~=?by@XLo:Cd-;FijJ&*Hht6oRdErKW)0LqX[MeUP=","SaveState_ztp/D_MN09A/2":"ZNCA8(jN{qr2_ANB,i0b,:UbqX41+i)0:3-mvnyt_,0*PCa*=S3j)|qDV(j8rAl)Mkc|,R=","SaveState_ztp/D_MN09B/1":"ZNCA8lYjaPkxB@zid[QKZO@Z5cDOqU3h72NF1dq}S$I@V!+^rJlQ|+]HyQ(m0v8fhD/OD[=","SaveState_ztp/D_MN09C/1":"ZNCA83t0kRPfio|kT04WZH)p?[ez/got{m3+Iw)OE6k4r7f~3msxnh}{b@w|!AmF~EJ$FV=","SaveState_ztp/D_MN10/1":"ZNCA8~jQ4F1o4DbWz~-zOC|@p6lNT1i:zJ{bl)vhbhRw&eH[~ZQ?X$YouDd0tyXyfK[^zR=","SaveState_ztp/D_MN10/2":"ZNCA87Q-Nd*JvvIGq=@c2p}&hP]]x!_j-*JN4bKVG^g5/FR_wpDM!y:$TtefT=?EmR8&oL=","SaveState_ztp/D_MN10A/1":"ZNCA8);NIpQ4Ls[{~lYmaSjfF_2Y-+Z4lcIk1u(m:Qxn=),+RZV0aRn)w_!)f(VL/Q@$1u=","SaveState_ztp/D_MN10B/1":"ZNCA8ud=4DIel&j:CQPF;]C,]bSd63pUYF^Hk;L]bAlTHrR7XG]ZW!|zP3HGpTcqh71ol3=","SaveState_ztp/D_MN11/1":"ZNCA82s^l6_YsrDhA)TD,-q=WKK|K@;z$u;@]]S~P6^]6*Fo-qh|)x5g@O2O7OGw41!Vc4=","SaveState_ztp/D_MN11/2":"ZNCA8KtZkxl$sc2av=!}l~,^z=uO^dI$s8UQdxZgr~VU{@KO+jLFOxg1p!]0zD~+,=OD2m=","SaveState_ztp/D_MN11/3":"ZNCA8Pob@&v4=QR7p|}]X3bBVkBg$XEpR5,bl)vhZnY)?Xr5O3oBB[JaplYZRjU~6sb)1q=","SaveState_ztp/D_MN11A/1":"ZNCA8~vo^~lo5-xjOd!4fY2T,-Ea3:wwM;{zYKl_K|@bMsLdP5Ga@nZgew1P&b:r{7Z+bP=","SaveState_ztp/D_MN11B/1":"ZNCA8~j[nytif1otA1LsSs}@8sS8Rsubd3tPyT-bMLpgBsN=dmM;DRuZ5YoPqGD,S;*HmD=","SaveState_ztp/D_SB00/1":"ZNCA8J4pehL0f4B=rXS/upemvd:/?Gxgv1fOIdvZuFo^D{oM-)VeM;zK+[:n,U?D!)mh[2=","SaveState_ztp/D_SB01/1":"ZNCA81drb,u*e&hrW(}N]ux6F!aT=x,c=hn9YI=n@eY{R]7iyA-qhD~T7+^](Lw$1hH!0B=","SaveState_ztp/D_SB01/2":"ZNCA8]=)!A5[+m,H3bZsP8dlW0Wf){zZKH5{g8P?@Ai9_mCrMXG7C2akd6l&QX,OM-LMyQ=","SaveState_ztp/D_SB01/3":"ZNCA8A||=Nh0[plnu!EpQ_pa+LuZNx:cTq~gy,,5u$bwh,c*HW)&:4|YRUiq4edRn1L]|h=","SaveState_ztp/D_SB02/1":"ZNCA8(56pQK60wf{)kc?N10sA4mi$QSRXg-hH93baqf}=?:hXrb,h7JHOG;Fz~We=yU5Zx=","SaveState_ztp/D_SB02/2":"ZNCA8oS(H?Np!_FF}mifOXL9SaJi1!-6$-RA1il|@ap;&jbN[/0YdpByVZGs-iNjB8m)VL=","SaveState_ztp/D_SB03/1":"ZNCA8kUj,tJd{JnBzV@W93{sB5Yfh[gpft~jrV6(3kfnJ6G36cW+p]~/}E9]1MV*_0Bdm{=","SaveState_ztp/D_SB04/1":"ZNCA8v;EI!8xSfZKA?MI_y*q,2?{q6/]|n[n+d]w2|y,E~O[GT+m*v[pEfan=7ZEsulDGO=","SaveState_ztp/D_SB05/1":"ZNCA8O&CI5pSdvq~J,PGeb{ElOKP{Yl|qv*V9=k/43I?=T8(t~)**z{PG3l/e?5PYeTr]c=","SaveState_ztp/D_SB06/1":"ZNCA8kA,|lgW9SyiV9FLmvrTS0BfqIFm*J=+4OliUyix[-:;Xz0^/5CDQCEU,}aF-/d7?)=","SaveState_ztp/D_SB07/1":"ZNCA8BoYk~Lic~FWMTt+lYS$zEf5MdT=tgVoiKp/m+;-tUPE*YbFeFb031zi27g~_F)aI6=","SaveState_ztp/D_SB08/1":"ZNCA8J}R)jyasCln9~(KTu+ydACI&QSF;U^KKFhBa=C);ekoe}T/[7uVb@mi_Cj|aH|lrS=","SaveState_ztp/D_SB09/1":"ZNCA8&A342-+nF_h~^uRg[@MA}MM4xdN-a3][I3TyFv3{2Q&5Lciwq/yhH,mvAuW0ZCU?a=","SaveState_ztp/D_SB10/1":"ZNCA8k83yBb23-WWq)wfy^^,!/{H]XN{MwbtaNSxr0l{9FMI8BneKjp)W$OuNZTI5O4^GN=","SaveState_ztp/F_SP00/1":"ZNCA8(N[G!M)1tS=sR271^|Fx:UmElizsSy,5lZ(E2Nc!QF5X_Mgh=ONsfnrW6:9rIm(+c=","SaveState_ztp/F_SP102/1":"ZNCA8J^al23o?O7RaO*9o$L_zz(+5TO8vQwkoSA{y($}*;sluCQNBEZT1XX[vQjN^h1[X5=","SaveState_ztp/F_SP103/1":"ZNCA88j_,C7U]w=_|!UdxZp|J~:g+|][P?nqg*glQZ:Geo)n@4C9~YP7Or1)@A0PG![aL{=","SaveState_ztp/F_SP104/1":"ZNCA8@[fN+o-FmcBic9W-&Xc!lb]0srg-o)cLsU;kl]X1hWUyIx[mggGD9?pb/cJNZaQIz=","SaveState_ztp/F_SP104/2":"ZNCA8e;hn@9_0443(u)HsK[H22n;?b=lV4c=8OnT$DKLJOVBL~_$7/RH~NE!az-9MGEEqW=","SaveState_ztp/F_SP108/1":"ZNCA8E8n/LbudQ5YiFVVE*V8}r0Q/Z+eiTt9h~YwoXP5GvCQHH4mANITN]lH9K1!cA;]Z;=","SaveState_ztp/F_SP108/2":"ZNCA82_XOASkY504b0fnH/4~4RiX)yjmsx-?egP?km(73h/3KVH]K5rX4qN^P_Ny0pxdN@=","SaveState_ztp/F_SP108/3":"ZNCA8l^eh$9Blv&$m3}KMz-,SZ,o]+1(-7AIt8jT1wywWp$2T6M}O{GYkG-7SZyK0G[~i{=","SaveState_ztp/F_SP108/4":"ZNCA8&BV-xb*q59bGm[m0j]H):{9U926UM4hje$d!I@Bs=]!]wl2/9^=DcPw;sQa&]!8u7=","SaveState_ztp/F_SP109/1":"ZNCA8Dq(U{6/NHfQ8S|Oxb38z-]ixXISB|3fpLKWsqT(&U9x2gm9_3:=S_r:rg,V5]c&CR=","SaveState_ztp/F_SP110/1":"ZNCA8Maj5y_=xhdZTfO)pDt4A1r|&;J0]Z;Q(v0+Lm~|JBe[?xk,U;3XX2(gu5:&we/t_g=","SaveState_ztp/F_SP111/1":"ZNCA8x$m6|rv9NZ@J|+tolbuNqFsy1-tRnMtiyl9&:K1mW;+V|N^p?@o)H/j{(N^9kh7CF=","SaveState_ztp/F_SP111/2":"ZNCA86OXzqA1YOwt6B!)yw5tbxe-QP@iG1ez^+oi!B4SE?L~yH5DxJpk{gmf{bnB7{!RYT=","SaveState_ztp/F_SP112/1":"ZNCA86y8c7mAMrGT[7/S-Fd9o1KyvhEFlMUu(q+!)skp,f?Tj,ROeFx&DsX@BG!oFdVsKr=","SaveState_ztp/F_SP113/1":"ZNCA8R:VFqE1/Is@,6T-N*c!Ow{qOXvM0o66k]T_0=r6iyjqg{+KY}M)b}&&6Y:[aQi&7A=","SaveState_ztp/F_SP113/2":"ZNCA8SkwUu3/=xeZwV:Y{oE}X,}}Kj/xA~FX)^EtY])WsIMx@lF0N5|]qZv3WX7Q!Qv$P@=","SaveState_ztp/F_SP114/1":"ZNCA8O,U,j&ncsO[A2s^qZD3i?A,SDgggG^J4Ak68$A6kH7/b,~[tiTs:G5Hux$^:p]g1e=","SaveState_ztp/F_SP114/2":"ZNCA8{!UcZP{&1lLntEtwhsOPuWW@jEV}7k]WW6-fl1G_qZdwzlpFql]-2Zw9&T)|/,Pck=","SaveState_ztp/F_SP115/1":"ZNCA8SfvsR,Jqs}YLLzU5v@fOn=c=|0+[Onudjar+^iqYQ,y^U;Li$+-:+OC3;x)gJ8T)J=","SaveState_ztp/F_SP116/1":"ZNCA8A$Rz1;[o@Z*yz}Oya{^tJj-?{g*zMq&a*=1jLMk8r-9OOjVz2{Q2CS;7$X^V&8_{e=","SaveState_ztp/F_SP116/2":"ZNCA8siq[hZufx0a|=+&U&;[U{Yn6Xq(2Wer0au*VFW(!6oZl~5zS2ts8|xF(o@74&[w@e=","SaveState_ztp/F_SP117/1":"ZNCA8HU}ySjQM6(4W@jOjL3,zL{v1bC;k)c1fEwTlGA,x+pP5ulJRE3U]AWH[@GQ)rtdd!=","SaveState_ztp/F_SP118/1":"ZNCA8C01R{]pfU/]HjZvXPqZ&4]umbMSo78@]]S~H|dbili6iB;/1&Oaw!;L*S5u(8~v]0=","SaveState_ztp/F_SP121/1":"ZNCA8NcDaRK{u2sK~ANhjl][i,ckM59G+byy?_32o*+dX/q!)QXgLG?{TKX]K(CLGxHshq=","SaveState_ztp/F_SP122/1":"ZNCA89BsNQ,XC7]V[F[M](7v}N^T?5p(02g[0jK2;z4Z+($cado]E(4jo2Bnp_GEPn^_ed=","SaveState_ztp/F_SP123/1":"ZNCA8~r!hcgYXLhxj|34iA~s;r~lj)3f$){Iks;Dw*Kyqqu?Xy;K5)NhB/3n~wD}1G9Y9P=","SaveState_ztp/F_SP124/1":"ZNCA8&@*aY[W0Hy]H|/Q~5d:Ro{E*uw=Pd3]abdQqPX{$xq;$i:[G}0x;uOEQuZ^kjLKaJ=","SaveState_ztp/F_SP125/1":"ZNCA8}JDu{2SiV0K]L}RNBpdS!7w2sp6+X09:tqUOY_O5+jgj_9r}8UVh@IKMagY]y]ikZ=","SaveState_ztp/F_SP126/1":"ZNCA8@RE/-RWI6Vmr;{g+U0+zfd;0UVeh)}-D_UbMDtkyL&p$DVmV?$O;nKa_D-k}Y=b9V=","SaveState_ztp/F_SP127/1":"ZNCA8e}_!_SEJ{yqlGZ(f,?O_/B*nuLWlC{XLo:CAQwh?g^|a,u$Vm@bBeU{{59y]vU@vt=","SaveState_ztp/F_SP127/2":"ZNCA8VtGLeVb;tmJ;:1LWkQ(+/bu+Mpw{oZSVDmT{*7MNd}N-nL]r^Xo}=pHf]nMQu_Br@=","SaveState_ztp/F_SP128/1":"ZNCA8lblKm)UcWSQV*!Dc13[q&&qHSG~=XA6-Yr/)xbJ_6y^=-Hn_y5cE-g&1Myj9z//hq=","SaveState_ztp/F_SP128/2":"ZNCA8/oT;M5Cl*v{{M9{X}TgS1PSmdmBk}_G(oqJwitH7lWnjCO:Mg9{klPwSbBK:zfF7a=","SaveState_ztp/F_SP200/1":"ZNCA8pc/omtV3-yQMHkO32p@H6={iFcH&,$Q@rPfF8JXY;A^H5ijyb9VtA=k$8O2boH/B4=","SaveState_ztp/R_SP01/1":"ZNCA8H^d8(fj{9fh~{]~-e27c7T/ar2A-^2QT]}dFg:M_~AgQf8$2]kVzzjHlxz=H[)xNg=","SaveState_ztp/R_SP107/1":"ZNCA8MuQU0r-Jq{grP}+oH2Maz;kAL;3JFZW^ju0d7OEgL$VH)np*,Zj8~mE/C{[OF)}6r=","SaveState_ztp/R_SP107/2":"ZNCA8+oJ)o7wNc}(Ja|itszwbv$h8l!hy(,NIYu8$j6lYj9A*I6kbM}vAHt=C8:{AnfcL3=","SaveState_ztp/R_SP108/1":"ZNCA8d*e07=fUtY_7nZxb-}VYi@th~v[kkT5aU3NaRP^$WOmjCr/&[oHl3+{+,iP60BGB3=","SaveState_ztp/R_SP109/1":"ZNCA8W70y?Oe8v^or_FkmP-FtE)KbtwL3!s[zm1x~}0{mX:/pjx^ic8_M:e)ivSOS[003C=","SaveState_ztp/R_SP110/1":"ZNCA8I:]iwh]eDss;xg|452q]:Q_[=tnx=m97SKfRE$j9Wcy=U/9d4}XYjXw([ekHtOIxl=","SaveState_ztp/R_SP116/1":"ZNCA81j8U+)zL{RtD@4?Cs1ayB4)^_-:BXLvC:C{opa*/7PUT|tB7bb7:4Qjd=ZS^@z|ri=","SaveState_ztp/R_SP116/2":"ZNCA8FLM(UYN?+5U9LKszDYWP0r-jjeNyvsWCnTxnc+T+bxV!ox(*)dPLm&pcdaM;)0&j+=","SaveState_ztp/R_SP127/1":"ZNCA8_nI0ys[|yV!?v&fhrn=Fx{lMscqZBMcI[9y,Tv/)zZOIVqeXCmpg~ca2fvphwUyol=","SaveState_ztp/R_SP128/1":"ZNCA8yzCtefguxt_)YWD0S86DwWQ?Rcr/NgyEJ(Shw+t9VMksC]mM3pHy|;NG9ncllcq!C=","SaveState_ztp/R_SP160/1":"ZNCA8JAEGv$E(N*~{=DE3OuVJ7F-c&!gUt}RJ^xw&(gmNLc(EKv*/+COR*W1VQqN=A:er]=","SaveState_ztp/R_SP160/2":"ZNCA8ITIfY/q~E/v(&X-A}bA{1O4q-:o|}h_(0x=KM4Oa/uxZRn&~!6*-X2ha+Ibgh-$1u=","SaveState_ztp/R_SP160/3":"ZNCA83Bvv;YnN_S[w3xB3|o/6-cqh?8@]L$ZnS;~mX/AWZ~[DSXcNqUdg2MO_GW1_iQK?l=","SaveState_ztp/R_SP161/1":"ZNCA8fl^7)rIdUDru:YIgTz@a*1M+ih:{mxhu^22kYVNjYZc}QWFuSv]NUIfd+:v/3jQ$L=","SaveState_ztp/R_SP209/1":"ZNCA8jw4Mz[CD(MW-v0Lgc[vO+32R)7HzN=x(3^FsB/J{BIM68zqtDUW$L|p1qNFq{HSLf=","SaveState_ztp/R_SP209/2":"ZNCA8mTDvn8r=d$k:@iOXrx7JtK*ki?2SSh!ikg/,ibbn,;=St(s;^N]/pxQy2S&c0+T^$=","SaveState_ztp/R_SP300/1":"ZNCA8X30;*-iqn4SiuQ:k)Oej=l5FbaCcgA]12mRskr7|sWndq_THaFf,n][$5RnyYqskL=","SaveState_ztp/R_SP301/1":"ZNCA8YPco!qcd*;6!0ns1BrAZNvN?$OP*WCn}+f~NxF)LB;9tY]FaX3}V41JK}H?]G!9{1=","SaveState_mkds/MR_stage1/1":"ZNCA83})|x];WQcg!Roco~{_W2&Naegye;EYzBG5h@aktqe~AYCgoj0aEEsQ)Ki0IQwz+^=","SaveState_mkds/MR_stage1/2":"ZNCA8I}K|N@prST0YxUECO*Mb)Q|NKBaYMX+61I6NM6(^PPr0sn1vP~H4BuPn[M-0O~PL4=","SaveState_mkds/MR_stage1/3":"ZNCA8V9wo}Owb,08Yb6;-W{Q[w((hMho|1:tUP)MoTfH;lJYeN19_YwyH!:9!$}RhAoTGD=","SaveState_mkds/MR_stage1/4":"ZNCA8w1MZO+b!=;?5m^G)3^qMH{p]TUDgbACMaO{mWlg9$itz!$$K+E8+?qbL_OU1pGVXN=","SaveState_mkds/MR_stage1/5":"ZNCA8*dhmoD?ATg5&*[}2IyTQFzCn0_2a[P?4?)/8-@SMvH_?=-hA,IHTZCR*}SnOW=vq}=","SaveState_mkds/MR_stage1/6":"ZNCA8*6[P:zfD;Ku@b9py96?3ZR}izO1DCet]}uF8!?wTbwer1zx6URQ77BWG|6xTXL95r=","SaveState_mkds/MR_stage1/7":"ZNCA8KbiLm8KaXRG)D]MISPOQND):o/F3!F?TYA5)xh6mIv:3MN;E{F8XNQ=0+0S^v&pNI=","SaveState_mkds/MR_stage1/8":"ZNCA8yt5/esoIHvUZISCEW|=361b;CIlMM-mfL?-nYxjG8j*W:[(dRn-J]a;uY)81sL1L1=","SaveState_mkds/MR_stage1/9":"ZNCA81vug:FGR~HJqB^Fs~}z_bfCF$5Q3?mE5U-CeHeECgPs}8q9cQwSTMl8&W8@z,SyNF=","SaveState_mkds/MR_stage2/1":"ZNCA8dhsa_vk*E~+BhSf{@J=*8Od+[KtFNwUO{HZV[Og}c[{A49Ew*e5:r?kDe*c?kB*nu=","SaveState_mkds/MR_stage2/2":"ZNCA8]pBK**MyjS4e]hJ1tUSCjFTS7GKp;Uh)uGPweVAboy)XZjPPjy@$P}nPL;)}lr7gb=","SaveState_mkds/MR_stage2/3":"ZNCA81v^KbO=i{?]BpmXiv,)$+$1$C?y9jb&34K&_lfB)marBFNKtWs~}O[Y!7q,B+jG[_=","SaveState_mkds/MR_stage2/4":"ZNCA8S|uFZASM+|Hp^,|C)kLPmZIVWgTwlBm,MD0ePLDq-{2~ZM45j!3fI=)sqz6^5Q?}D=","SaveState_mkds/MR_stage2/5":"ZNCA8es,qr3T$4Z]sVHKDY?UAGAE*q0(mhdcDhgiCp@9t8~_ro~j/c_XXXHW7[7aBaAdD|=","SaveState_mkds/MR_stage2/6":"ZNCA8vS|RAD6-aYF,o/JOYk+==B?~QzGsJYWd^Hp7jT/TZBhmYsPseuKe|K_*/PV{Z}?Rd=","SaveState_mkds/MR_stage2/7":"ZNCA8G]So;y-+DgqABrz0T04G:ZUZMPM:3J+T[XflF|8i[Qag:X+_cs2bdqD9ykM[P{Ufq=","SaveState_mkds/MR_stage2/8":"ZNCA8)HYd2SMpbZs]=sZ562c}+:Ja9CHTf)8hKeGH[2M9Yz/+@-gbcQP*)LR]B}2p((ddK=","SaveState_mkds/MR_stage2/9":"ZNCA8uOK)Q{tyg|x;O0G{WJm_jpgC}rs^ByiR&+~{3]*A:sI0pNVGC{i7QAMjl^*H?emlp=","SaveState_mkds/MR_stage3/1":"ZNCA8oDE8K=06*ST/n|N@DCFyMy^qIjoL]?j{L|N)G+FZ$}d$eT=6]h7^vk,Z|Gdo;M(jo=","SaveState_mkds/MR_stage3/2":"ZNCA8J_Ovq;/oBsc*1r=x|})KgOJMy$CbRkSOrq}-Z8Nt-Tfr-S{-8kSP5XSqaS{4v!IN6=","SaveState_mkds/MR_stage3/3":"ZNCA8_3,RWL$Cv6fKPh_ffaTE20Fe3UtfXrwuW|Efzx^!cgybvm8pRnPq)$pQ1B_)rO[){=","SaveState_mkds/MR_stage3/4":"ZNCA8DmG;ef~?Mk-fR:=gLSm(TK=LwmJ:UIsda2,:z)l}Ob*;0:Oia-5Dq*i{*?NOx=dGb=","SaveState_mkds/MR_stage3/5":"ZNCA8fV;xA:JDBX:e:{|=Ot4cvHgMvh]Ku$nO-bb8|A-pf?z@u_LTNS@I&nSc/avw{ThRv=","SaveState_mkds/MR_stage3/6":"ZNCA8QIl-^i(Od[6J6m~_*?]yHWa3D+;}DfHdcWFpSTTw5MdV}Y[Tk*vpleV1tI;V7c~sU=","SaveState_mkds/MR_stage3/7":"ZNCA8&,Aj|Smh|3h)1iyxEnwLoEc8_aco}qVC?hc8l~*TzfKbeFor_atxh1{S}$ov(7~lR=","SaveState_mkds/MR_stage3/8":"ZNCA82Y7i(4s]^mst+:ZcFy,zZ]K(~j+[/|TeN:yaF7^b:X(-IKZ&Z7=azRcM!xwrgb|Jt=","SaveState_mkds/MR_stage3/9":"ZNCA8@Ws~M/NBJaUl8&7zC2o^YjrY7:AO*w9ok2YUv5A2;/]5~7CZ^l=sQ}oTgo[sjAJ/|=","SaveState_mkds/MR_stage4/1":"ZNCA8ZvUAJKhT{nFPb1]?H=^,3&Fj5VZeQI8|O73kkvi;1^u_I/R?cB3&!8&QKg/OZtzbB=","SaveState_mkds/MR_stage4/2":"ZNCA8Sag@TtaA!pr|$CV/[nf3X_u(OjK_?wV2y7DQ~z6vsJOBQ-zCOw5N/z/brTW8tz))f=","SaveState_mkds/MR_stage4/3":"ZNCA8RWF8h3n&30VR+~:I*~iAB8CQ?2bBAj={Hbt1*JJJpb8B7PFQ2_ItMR5{PR^t}NHu1=","SaveState_mkds/MR_stage4/4":"ZNCA8V2GckCQn*(oShMVR/dD7D:[AjT8iQfj4XqjvF,-q[PYn(fc;S~pJsvn8C;b([!mf$=","SaveState_mkds/MR_stage4/5":"ZNCA8;FN+p+,f+@3m{r4=Qq3:+Yv7h(Wc!,]VjH3nxeh/Mn];I(V3Mlb=2=(x86xjgzFD}=","SaveState_mkds/MR_stage4/6":"ZNCA8L!3kMunH3DRUjh4OX~]s&_p2$dXG5W0bgDt_PIB$O;Im8:7REw4?x1/Zs+d@LG8$D=","SaveState_mkds/MR_stage4/7":"ZNCA8c|,xf:Kk!+o36z{]0VZot]Wz+)u:E9[9OL5z${wlbkU14@;+uNzyg^ro}nx4btMh*=","SaveState_mkds/MR_stage4/8":"ZNCA8D1M)+jdj/pYxlwc)f1c^?trBdl7NW@uViWg8x;w{OK_p=aa,Huh,p|jFyqGn$CokD=","SaveState_mkds/MR_stage4/9":"ZNCA87)G(fUx?)EQl&:HXjp)U@tA-yfRNgBu9kzFjk-L)M|RoQb7zW!m29]nW2t5ZAXD/R=","SaveState_mkds/airship_course/1":"ZNCA8f^fk87ClZQDt94^T}:uA=F;{My9]F9WKMtqUdqOQR(DE)gmtxmnnSq3QwwkbrU_2f=","SaveState_mkds/airship_course/2":"ZNCA8wT/g&$yv3vaaPy=py6gSe&:&-Q!$;ztx=siXy~Gx:X+v+ga=r=j3Uk2~;_f}TsV!|=","SaveState_mkds/airship_course/3":"ZNCA8CDXPHg;qv2P{RT[+XC8291Vj5efD!vz5IWhP[)hrR?k@zAYk^d$NAB^G8cWD9)~Pe=","SaveState_mkds/airship_course/4":"ZNCA8:Zh32QE+dK{Nd]Cmc6Jm-vnFqh^k+CLY1jAfq$8VI4KvQ?Gow,((+?30H-f:)&cjD=","SaveState_mkds/airship_course/5":"ZNCA8HzT5Uef}kX,dgK(Qb4FPghpxyuH+hlrF52;$/|L=CkN+Tz5++|P,slscmE:RM^C3B=","SaveState_mkds/airship_course/6":"ZNCA84v@@Dyli|@Xzg/,wAOL@sf)!mwvq7OA7Xr6l9GR1OF+Psk07Q;n17|DvY4YX1[oo]=","SaveState_mkds/airship_course/7":"ZNCA8TF=x6EkJdF:@a&N6?UI&j!E]Cdwwr+G7f-|_pBK&Vs/BYao,VR/AGhMj$-zBlv=4P=","SaveState_mkds/airship_course/8":"ZNCA8))x1G,]R+pYW4y12u-3*&/1a!aL92GmUMmr[c6N)!B!UmUPv2j:|n/mDo0(qkFxoP=","SaveState_mkds/airship_course/9":"ZNCA8]36~T)Hrx$J3V]vmoIyP_R:,,gcG:RIsSnGcSd*ys54f{lc*!H5W~Z!p^s]Y5C5Ip=","SaveState_mkds/bank_course/1":"ZNCA8s^$b3oSEYQRCfgcatLJsgP;yDaGwF)4eeYbkZu30;u[Q|sA7,/Wwd{9EJfe[-(wVm=","SaveState_mkds/bank_course/2":"ZNCA8?,]j5jr)Aljd0B]pZ0{[MjS~n[b!{*0;v;$l_6MWAe}z(-wxhx9~H50F:wQ,h|nd&=","SaveState_mkds/bank_course/3":"ZNCA8EYM7Lb2oS0NgQJTg}zCv7dn$2IJ-i]v$+|Hq?lUYsz6;kkdLE6:@kX,ce/=cFif2A=","SaveState_mkds/bank_course/4":"ZNCA8wu$u}]E9Tuf7+EMD[S=XhFPVDNBULtpj^FiGBx5|JB@?SWsXz=x{TQ|Cb[__;/9HJ=","SaveState_mkds/bank_course/5":"ZNCA80}Sce]Mhv0lrsZ_07hLs&0~:?JGN}$?bPRt?$t0Cz/r_M3ZGpgadd6yXaV(xUQkwt=","SaveState_mkds/bank_course/6":"ZNCA8X*ZgiUIF:l5T|)HzAAo09JpVoiw0CCN5~JjkSf]L@[R|b7~VI+c8&4Xq,)MG$qyn_=","SaveState_mkds/bank_course/7":"ZNCA8[LJxNY+?I@-dLe8+wc?i_[PuP0e:o~typ7gbP2OEFYt|ELjWa1M+]rEQf6thPpq^z=","SaveState_mkds/bank_course/8":"ZNCA8P*[47e(ZG8zS1nRO{jLi?|{cCN=TRC1t!q$P]6BL)-0ConglO~1=UFpWpX90/vgsf=","SaveState_mkds/bank_course/9":"ZNCA8z3F5S20I!W0js(vVVo7@A=+XBp[L+oTta@Xmv=$x3Tq-NV*Ox?Fc29VD,LH$+/KrY=","SaveState_mkds/beach_course/1":"ZNCA8!c+&lx7IzIxFp^0ZN6NyRNTLZ{!RC$6;|1d)A@aB~YV&Zt+aF]9V7NpO4K$:+i)9T=","SaveState_mkds/beach_course/2":"ZNCA8Cm-Hog2i6&sA&LE;ysz1A(qV8e)vv8r3/!coahyQH+WJk6dseJR|xjd1o]-R7?}F|=","SaveState_mkds/beach_course/3":"ZNCA8clj*|_O|U5fuAw[~WxA:@,1LNAuT+@g5HChdSO+}A7m5,F9cW?ET0-NKot-Ik1UiS=","SaveState_mkds/beach_course/4":"ZNCA8S{9}N=!i_aP@Z*7tJNEUWYHssv{d;sF2RGF0$^w]e*{3qgc}~I$AH*SeB!|}8[*;9=","SaveState_mkds/beach_course/5":"ZNCA8Qpz=ApaU+@p5!]sF[s@;9&eqv$JAs0]y}8(4Wr:|5X[u,F[s]ZX|tZqp1v?!q|:R^=","SaveState_mkds/beach_course/6":"ZNCA8;8h0e=hW7myqqup&IAQ]:m/Y20u7bN5prD)oVLP2GRhwYL]BTGO&Q!)-C6+lP:MaQ=","SaveState_mkds/beach_course/7":"ZNCA8C]}qgd1h)N*},fFM5e}~U^1s;!sKd=abke$ebncEyGa6YJN^Uk/V)lF0IN37m:YsE=","SaveState_mkds/beach_course/8":"ZNCA8v07r+L|kIh=FV?$tYDLX&hsAv,ppnExHNzPhVjmSbl$6qavYQZ5~qB;or0h=rG,xF=","SaveState_mkds/beach_course/9":"ZNCA8f=)zDwjmCIFXVUrcv:F$(;B+U5K|f=i7bPgGw8oC(8[OcO-DK^5R4|P~0[y;Jli2!=","SaveState_mkds/clock_course/1":"ZNCA8GcDo;gBb8:7F8nDG;=7Hi]+4[XXOWVzlVMSf&y1!~^]c+fe3&6=kz[X?SW*IBTx=q=","SaveState_mkds/clock_course/2":"ZNCA8w;V/7GMiHY]5T1son+S0Z~yNofy5Y*99CDox30U66&i)Vz{g7[@0rU5K(T+(@af~5=","SaveState_mkds/clock_course/3":"ZNCA8_$8N*m6a}:wqPd0xi@p&i?ET|a+eK}7D)2ob:N|YXVWzY&VXBd82=V;Wtk)hEn9xM=","SaveState_mkds/clock_course/4":"ZNCA8k-KI;;+@O1QOr?RJqgf4DqD=5l@DtApmcu2}O!d,UW)Tt3^Bk/z,[4-LV??{SfDeA=","SaveState_mkds/clock_course/5":"ZNCA8;eBS&@I^93H??xWAMtYm?:Q7Ar8x}]cVc^}Ce)TuB/+~OO2l__vS=^o$BINs~HP5{=","SaveState_mkds/clock_course/6":"ZNCA8{Hs8W4(t]O47:$=FbjVHCW65tPND7JW67=]VZLVnBPTru!r8sd29L-55q1ew1M_wb=","SaveState_mkds/clock_course/7":"ZNCA8Obmn0iSku],fOxF-/ay&GocoU9uMG/=*l]m@&Qmcw*rQhV1W&y+fI-kU-|5:fzeL@=","SaveState_mkds/clock_course/8":"ZNCA8OQMAgtu9otGgTG=_WhDYw=2V;/b)RS+-8Fccy23)UMukifJA/9hTX+ejA=x+*24i1=","SaveState_mkds/clock_course/9":"ZNCA80d04{I1ySJp[_J~_eGAy;uo@xThbnN8jxNiGE&q!By@v1?nmVe[y_FHd?a^[F)oyq=","SaveState_mkds/cross_course/1":"ZNCA8w97l18bpvHs]yf**@EwZ;UJG9u!TRS7oJxmv^[ipcl??/3*@|fgjBHqv0=-^smF-$=","SaveState_mkds/cross_course/2":"ZNCA88Hw1K=0wCyJ4v^}Ch02(xbQj2ahl-rYo]WQ+[K[XyYv^gvrQ}nt3Jz/1Oome/e+V*=","SaveState_mkds/cross_course/3":"ZNCA8VSo[!]r(klKQ[34Ku&E~Y0b}$lDd+@VGMu62[@A~5Y)wd?a!X=Teiz|Rpe)g:anvW=","SaveState_mkds/cross_course/4":"ZNCA8q}sc+QrI[wRU4--VRbYCSvn7K]H}34qke2~}XhZal)r,QM=8FbT5f(Ipd4YdCThfo=","SaveState_mkds/cross_course/5":"ZNCA8Z|,rxa)^QeZCE(*Jw?dmR4mXTwqT9jeieZM;Sx556=+zbt51YYH9Y&DfEEt?gJNR/=","SaveState_mkds/cross_course/6":"ZNCA8E_IK=2?0u^x-arMkJm[o4E)gjqegpl5S^EktH4{]5|A~cLHJAoHs13aKeQYHV2/5==","SaveState_mkds/cross_course/7":"ZNCA8(Xldz,0YSn*rdLC,tejnt*+7zK,0bjB;rPM+TO*anW0$ggo0$?_ko$^x)ETI+(ivD=","SaveState_mkds/cross_course/8":"ZNCA8MMe!&BQTEuBUd*Dt]]OmYQCC_V8LAu1V@+ZZv+jEP-8A@}XxTK&{6H~Mg$:n76IhK=","SaveState_mkds/cross_course/9":"ZNCA8]BQ}airjE)GGCqm*MMpJ{trBzvSe|$tUC8-,w,r0IMovf)(+Q!L5obAQ_(Jn@JSP]=","SaveState_mkds/desert_course/1":"ZNCA8@(VV_;halbE4JK&:w51x5Rqspe$UnwE^v]D*uj8gxL5l6;CIJb]=@Ej!3cgdNFCt:=","SaveState_mkds/desert_course/2":"ZNCA8TNbwo~(:C=Kt+9aEs*^LV!a9/:hZ5|o,d[g/0w(c6?X0MK|!/NE8UTp-KT(cEd0Vb=","SaveState_mkds/desert_course/3":"ZNCA8+OoT8_g7qZEG{?*gIYuZ)2|k5NSWnxh:E6_l:;C^O&1l3-T}XDK8z~EcX2!r:g|j4=","SaveState_mkds/desert_course/4":"ZNCA882h6ya;7~;Vhxe!gK_O+7R-wNl|=q$fN~BVlI$oLO}@b798O0k*5Hbg[J8LeEm~2I=","SaveState_mkds/desert_course/5":"ZNCA88}7LYTUAZ!P/[,epc:2hBJ~xdSG6dm3t^X45!0iI_9qTx)vY9ENNEA^);KTj4SQ}Y=","SaveState_mkds/desert_course/6":"ZNCA8xsoCZ7IQeGB;HYO@EvEWH2k~DW^ewZ?d+}?jfe1O5:/J,;yLTvI8Wn&ty:$xpP[x8=","SaveState_mkds/desert_course/7":"ZNCA87IqjcG@~mc*aI{vhYT]+KsPUk,]?t6-D_Ub&YN@}aEvGiR@=I&bW+)sJ-0vX(~$wa=","SaveState_mkds/desert_course/8":"ZNCA8=I8kBI{SD5_JtqArvyKN?Xv,B~(@yy2u:xjnAAP!3T7l77Ec:~0eIUWttu;n1n:u^=","SaveState_mkds/desert_course/9":"ZNCA8lJ?r[g-{Ft;m?vi?/5_Uv}H}T6DLQOg=o&|SoV8rSE7eGb^kiC8gw,IM*nh=hG?zp=","SaveState_mkds/dokan_course/1":"ZNCA8M{MQE&PY1u1yZOYlzSa)a~4rsOvU=h@vOHh9hB9LbtoVRNI;RRjl*02ZDkb0L$D+O=","SaveState_mkds/dokan_course/2":"ZNCA8b9AkxWxf0Bjf*6~Y:=&I(,UJ$etyyNgsOn}ZYHIFNe|5as0_7fR{^)Q~5-!e8SJi|=","SaveState_mkds/dokan_course/3":"ZNCA8j{x=~D4t}V*EZ;TLQCv/*}Gk_bGAC(m_hutt|4;9[=yYQ:]lhk+:m$mQH&H8!5tW}=","SaveState_mkds/dokan_course/4":"ZNCA83mA2mZGxQu5}m/1Tyt)SR0?^trh~6@Xm:$DbQVSaQ*4;Z7_/mTPmgeYp,?qK@q7_B=","SaveState_mkds/dokan_course/5":"ZNCA8dFHMQXFO(zK{chklkv3b:jNpJ/z*yqKvsbP5YOr3?,R9KBM9_?[g/$DeHm,mzSz$_=","SaveState_mkds/dokan_course/6":"ZNCA8)b8$T;KHI-ls}pN!XcEJVCba_;STV)2H+7J!BwpowN&U:o,^UlE^O|GN{j{T!3t,Q=","SaveState_mkds/dokan_course/7":"ZNCA8;sTP|t,;uenx[7@7C(@qw+3EccI;lAO1XlYH{c^]6O13l,5qi0Fx{iY4Z]E&LMd;F=","SaveState_mkds/dokan_course/8":"ZNCA8FS:V/1{Al|/}KyZrN5vv_5mekxvpaKi?XF6vti!c2a$tA;9y=1@iJf$fOU:mG)$6&=","SaveState_mkds/dokan_course/9":"ZNCA8r@a/EXzkE/Z!,v4]Qh;JIrF?+KI0lB8e!D!Y0$GX6~n4DPG;CE-S~Tk$&jDdDSyd-=","SaveState_mkds/garden_course/1":"ZNCA8weZgj:p&9RLSFNGTT+n=L5e4bLSzu]CV8PVe}8ISWr?$1do1}eYub}|*5i^0,3]nE=","SaveState_mkds/garden_course/2":"ZNCA8BtXv2sTOvCq+vOwG2^1(m){}ZpDLo^,]UH_}EtiIlNL5??t[it(=-)AE+e7)C-dgO=","SaveState_mkds/garden_course/3":"ZNCA8(j$PODBRruMxTBFTnb-+7=(Ih6Anm@3FA&GhXRcN:I9R*u780y18_ng5vH+tjF6f7=","SaveState_mkds/garden_course/4":"ZNCA8!0YC]-gbs-@6cmG@tv[NP{kv@uHck44P+4+]:6XwBR(ct&:&9V)CSOb~;]j21_j?V=","SaveState_mkds/garden_course/5":"ZNCA8G3wH2Q/B=9nNTo4ZaJ4@M@n)NN4pOW]y-w$tdIo2XIEke/Z]zDl3V9&lhShm$[ZEs=","SaveState_mkds/garden_course/6":"ZNCA8o[,)N{cr|wI)(e+69N-HAoA;p~UtKie=Ohb?2W9B8v=V/,QJvxC}zYe/3W^kH(UUg=","SaveState_mkds/garden_course/7":"ZNCA8Fyzq+nag8qMa=+_0AOjNs)QdF4lgN[cqe$X!E$7r)!7[sdjgFBXdudeC$_5b2MuW/=","SaveState_mkds/garden_course/8":"ZNCA8(|y/lN8eQ3)NmjA}J(fPa)VPBcqCVJidumIREPzC~(YPHKOKAlwinlZ/!LHj6k|Fz=","SaveState_mkds/garden_course/9":"ZNCA8LV!r;Wd3inD&ygejiD0jpx]42Zc14YhgyLFPl7KoM_b;1Znq];(;35u:asi;1Q&Gt=","SaveState_mkds/koopa_course/1":"ZNCA8d0pF)y*Z=h)_pWCY-OrB8q1f(Tsh{U=i@vhH?5Tst*bhgnlZ[NTs{}c7r*s5kfOc;=","SaveState_mkds/koopa_course/2":"ZNCA83_LN}z1mxw[9Qp)93=4IgbF]$j[YwOyoY/Px&mwud!!kieRK9]EP$7U/pQ9TDo6]B=","SaveState_mkds/koopa_course/3":"ZNCA8Hg!~398SBu;@!,bN-aq/N[cfYGVM8AMVx+Da6KLxFDnoSjN6l*R3C=0ItJPRC7ymE=","SaveState_mkds/koopa_course/4":"ZNCA8Z|3s)W)hJQk!fbMrxphR1L((sQ*QKv&-r~/:28AR9z8f6y+BN9F?nL4m}CDe$}[9F=","SaveState_mkds/koopa_course/5":"ZNCA8U|h9F4!1P)C[lR*BRp?de6U*{@T4qGeqw=ES=|r1,N@VnOjK$053K_Zvum;fQs7_-=","SaveState_mkds/koopa_course/6":"ZNCA8a+6DBu[anMQmRG4G;URLA)C{!Q-}B@Ahmt!+Jz~?=dHP|v|M&rUA/48Y:u/k8dPGb=","SaveState_mkds/koopa_course/7":"ZNCA80Cc-AN0]@@NkKLMYSwxIj~c!N!8YKgPg0|dk=T)R,oU25tm-M4-Y1eBT;3U;kZ?5A=","SaveState_mkds/koopa_course/8":"ZNCA8OyuAUWwyBh&/tIE1|T:]8iTzl6w2E&YGQ0~meuC[kfuWi[A3pbwV:~?@Y$=F$]q-K=","SaveState_mkds/koopa_course/9":"ZNCA8@(FgtV[(=]TjB:8D^M|tZ|//{Lv{[iA]xFYHt2h:o)Yqvs1Yg@w]K1mY+0=,0VHrK=","SaveState_mkds/mansion_course/1":"ZNCA8wv)SGqkDk,p-y}~vg@?P$QEqTChJaf!hDJvi;/dRd]yf08_L&OGs-^4jSO]HQi~WQ=","SaveState_mkds/mansion_course/2":"ZNCA8RO=$*Tgw*8iQp|8Eo!@uY{rGgsdnme[ZIB1:bg$Q8,G:ZZ1hhXi,s+-G*eKJf?cZR=","SaveState_mkds/mansion_course/3":"ZNCA8Scnh[L*TNIYu/94jO=l~fd2R}m}{63hhusHVd93IDysMf9Sb9jPjhQ)]^oqo/sK)u=","SaveState_mkds/mansion_course/4":"ZNCA828?Q]u;IjVD9Z50eaT7d,853jIZBUo7usASO_)Ik!KQ3^;Cw;dFMXANj3oV=KrAkZ=","SaveState_mkds/mansion_course/5":"ZNCA8loJ;YU+CMW80T_(iau6r9(E5S:Y={7q35E~]7*oOfC5iAg{Q2kJ0rD(=$q$9?YxK8=","SaveState_mkds/mansion_course/6":"ZNCA8uId;L_oec[iPPr5)Cr1a9i;Hm16h=XZDM)[sMO@E6Rp9Kpm|D+/cFxFjvC8nLNFAF=","SaveState_mkds/mansion_course/7":"ZNCA8k5!g(R?4Lk_T,i5Y9=q1T-g@vtoJ{nCjNl[Uq7ia:{x^nOtKPzu/E7mDVSA5Cas9;=","SaveState_mkds/mansion_course/8":"ZNCA8N8ul6U:rQAGm{@(L9b7RStq$Ug[+&Ld,SGYsbN8B2}iZli{q-maZb=vJ-pqyh/s*@=","SaveState_mkds/mansion_course/9":"ZNCA8m7&n&,6zi/mfJ7s@6S+@rTj!+Ke8hvX5xaIrUcS[k9pgmeHrios?FbCdCp,&wKI}*=","SaveState_mkds/mario_course/1":"ZNCA8LpP)oo7fc~D4IN6q:PfM2(U-FIoW|skWhN|l-EQ1,pEFg9L~Q2N|ou7{DR=:nE22m=","SaveState_mkds/mario_course/2":"ZNCA8sH_(EM7r@uF]m+nU4mqrCH6);Z4c@,[!McQ-Ryc|I(gKUD*Brc{7O9+x{Nu1DR?,7=","SaveState_mkds/mario_course/3":"ZNCA8bvdmJt,Vv=Z4m*XSfYFZm@*+YD[nG@[!McQ85HO[7j-LrB9DO;-MA:hX-&TjijkNG=","SaveState_mkds/mario_course/4":"ZNCA8@wf&4&JUFQRCp$;_Zp5aANarrCli985:cQ:_-82,8t+$VCc]~/}Jmq(X7qX8KR8}I=","SaveState_mkds/mario_course/5":"ZNCA8J=YBRGQV@KBH9SBY{KNe(+e1p/eUYa=1K-lA|{KLw+1?(!)fLygdMSe;ucujV6;a[=","SaveState_mkds/mario_course/6":"ZNCA8MBcFsUxRId:Sf0U,^$p)S[3$w5psf9q]zb(kh8m}3{B[f)fwsgf|qen8U*=EruTw]=","SaveState_mkds/mario_course/7":"ZNCA8?$Pl3I($zkeoiI+*F_BAgO{1Ndo)2Y$7vZ*4)/|+P]@v8MD3(HGleVuk|J=W*GRi|=","SaveState_mkds/mario_course/8":"ZNCA8f|H3yGK&@fHftb4Z,brSnuMo:$)SqP!lsfMjG0feX|AT31;HMb,z[NLfSF!hsEL_c=","SaveState_mkds/mario_course/9":"ZNCA8+heJ0Ye[}e48w)Os3CU}~eP~Ks@IeHj54jwns|PU7~a@9*1MG0sFB,M!&4Gk~58m*=","SaveState_mkds/mini_block_64/1":"ZNCA8r9IM{JEk_5$q&;X]bC?,vXHok;ap/8~^f?$HYCIVvVVdHAy8r}t82E7Br81@1hSQ_=","SaveState_mkds/mini_block_64/2":"ZNCA8&bA[m]@R031WjQgITj?,bR69y/glcinrUwV=*e^NUfFvG;p9OLp(w07Q}ouX)e)M&=","SaveState_mkds/mini_block_64/3":"ZNCA8hd{Q/j=Y0d2W;4(2JQGGqB&z64XvY=,F^Y*kQxN{FASaswnsE^uHm^brJ6]IcVxN+=","SaveState_mkds/mini_block_64/4":"ZNCA8Bi+uLC]A@2uD/f[]Ph6[~@yF:1*{qC7CJl*-*-|gk9nJ8L0UT9BY!N{?yiOm$yP|J=","SaveState_mkds/mini_block_64/5":"ZNCA8SC[L)J@amcnui!4buCzdq{5ANUL(0Nz^jfiZPPmd{cPeLiN*;*?T1z|6|c,oy1AmD=","SaveState_mkds/mini_block_64/6":"ZNCA8j^Y~SLUqq|e414,{Bk/PT;T8H+_*m5K/Ma5:iI=9k|NB)AKPq0/Y$=?ZZpq9PR!L)=","SaveState_mkds/mini_block_64/7":"ZNCA8q-yR5tHc}xa6YV=zGg&9&8ia~B6i~^]!*W5Ep7lX4:BoFMR9dAWK$QI{8RF-N(|hh=","SaveState_mkds/mini_block_64/8":"ZNCA8wOtDgf_v~:$-~B+d8VtHV5}COrZcqkrP(k)V0Dv(]N5=n0|jz5Akc[~-6P^S6lVY~=","SaveState_mkds/mini_block_64/9":"ZNCA8rOXTrWBnxoryh_@k7h?*BgHg~MWU~r+|pujZH@GBlbQGis^L&Lx[^x7/3:2V23o(0=","SaveState_mkds/mini_block_course/1":"ZNCA8zsj99sHk3ROSmln7i5|541&g3YMyy_M/T[CgvR|:2dHK1,J-zYl_PE{M@YJcklT^B=","SaveState_mkds/mini_block_course/2":"ZNCA8g]]QCrzA-NqgkeZsT@*yH:z{mr,7A5{WVY7_;cSj1xdju&K6}c-1=ibFLOu3{1!Kt=","SaveState_mkds/mini_block_course/3":"ZNCA8fp&FWa6T;;DUJ!=*^p(kLME@Xkk8f|S:!edO&D|NY&kELP@Aa8G~,Q0c0Vi[o0{wA=","SaveState_mkds/mini_block_course/4":"ZNCA8f1b_w$Uw8TtY3OE9Mu2@)|E3oL^?YM_*A}Ej?b)SRtyRUjQTzS-b]IWdJZUoq7Din=","SaveState_mkds/mini_block_course/5":"ZNCA8XS@b/im7EY8p/e_/Hd)uK/t!h-wPw7DlK&gL8,-lltTdqEH&X47;m)(aM,EjDWeVt=","SaveState_mkds/mini_block_course/6":"ZNCA8O,-J:69X)}u6Y+*mLm-UPyDX&PnW77QzUr9Ga9WjA)zgmm6*kD[l^bK;9:g3S//il=","SaveState_mkds/mini_dokan_gc/1":"ZNCA8sxYw4;Tlg?7xE!]u?hKK14FFBCyBdqs{qTtmNoZ4gmbX*(D!KEBWT)3$u[T/e5;Sk=","SaveState_mkds/mini_dokan_gc/2":"ZNCA8MdGpx9[;G?IrftO3Oz_}R}K3cZ:T85-CpwUI]xFO3e=BbV}]5iFs-muB@H:9ZK]hD=","SaveState_mkds/mini_dokan_gc/3":"ZNCA8W0{7)5Blk453q8ib+wzPHGI_Cgmz{iN:+9sLKDV7BNm[sNY(*c$^0s8rP4ODIyrg==","SaveState_mkds/mini_dokan_gc/4":"ZNCA8jW6asyB|t^9/w8kyqH7ju8z=j(Ofcb/ucwXeqa0Q}LRQ@G/Cs7h}gNSW]trox!Q]o=","SaveState_mkds/mini_dokan_gc/5":"ZNCA8rq1X8~VH!i6R]=58LwEQg|$y~@WPKB3W*JNs7QyH3][@O/=*IOhn?l3gy^Z|9aPJw=","SaveState_mkds/mini_dokan_gc/6":"ZNCA8BLc2=0+4I~_FQ2uo8Ci)@q;8ou|YJ4{rE:$zwMHMH[@J(/{I9|cp&A[]MZr}J!9Ex=","SaveState_mkds/mini_dokan_gc/7":"ZNCA8ce-+{b?&h+ygZ!T;Ac07,[=j|46iCLk20+zsCl5&!;&iGH](}7r07UX@qap!Xzyc3=","SaveState_mkds/mini_dokan_gc/8":"ZNCA8(DmkqT&d:e1+gbcyozuE4@+gc~67~+;)=DSV~7=@v]vUV9?f8E@7brq3^23q1-1Q-=","SaveState_mkds/mini_dokan_gc/9":"ZNCA8]N]6;Ut6m6nbTnXG{h*whR?X:MxDlU$RQZZb8)R@rpT)eYSZU~fuH7Sczb;VR;YFK=","SaveState_mkds/mini_stage1/1":"ZNCA83;M4L2_]65+$7R8a3|ZS4yI{Wx=l_r7Y)*V+,W3eL|UTQ&2v9$66nA:Zb-gXh,a6(=","SaveState_mkds/mini_stage1/2":"ZNCA8J4~_?*/)r:7,j~mQ-kX[-Sg)AZoai!m1?klIXE3~9[M?x[_iq/nltr64f6+|FivC1=","SaveState_mkds/mini_stage1/3":"ZNCA8:FgM6l$s-,Wit0~rcV)wqtIV);B8X,mHB3CrSWF@liLFaA!m)fL~?$3$i4&wTo6(@=","SaveState_mkds/mini_stage1/4":"ZNCA8FQ(E|Q,~sc0[7[X?iCA7)pj@^0U+1|LzP[uaXAC*EvqmGl=mEMm^ucqj)+Viu2wCf=","SaveState_mkds/mini_stage1/5":"ZNCA8~(EBm+a!+GiH6]aoYgadF]yx^KF:|sdVXdBbw-s?GdeW@F/G1Nl77KVR_-~o2n$(B=","SaveState_mkds/mini_stage1/6":"ZNCA8&XYlh3(k!XsnARPok|3A6XzQy$Id@20-ZivK}H|&=iDr@zCls~;~hBsgrR9~wkK2X=","SaveState_mkds/mini_stage1/7":"ZNCA8cM,ww]v4svO)q9&$0nI1{E5m95GLrB~j9W-a@Q,~$&Jci-9_W8VE$Q/8FOAEPl^L@=","SaveState_mkds/mini_stage2/1":"ZNCA8I^kkG?TS6$hX!I:-)?${L1]v5vZ@f?[a7Y@ERF,zV5Wzl$QAy]JE4|/_lo,60r03q=","SaveState_mkds/mini_stage2/2":"ZNCA86V:++j=:oF2wvBr(hz-pz@jFLusoD-&2XO=M~CQ)Lg{2SO;13NEv2wA,QZXYhhF/L=","SaveState_mkds/mini_stage2/3":"ZNCA8NPA]tL;RL=2-DC}w]or!O~-5HTWk[;3uIm8XBZuS]_v{,$UOx$Udw1/{qUg?xyiJK=","SaveState_mkds/mini_stage2/4":"ZNCA8/VVLfWg?~wKjXM}b6RhkZXTwDdb;09ASrMG26URd(1X{_1+[;YfscRxSU:F0)5!_X=","SaveState_mkds/mini_stage2/5":"ZNCA8xYua{RC[W&GX,hmJm78]8GuHq7Q-&~hoxWvEaU5HEJeTu/Hy5)SfvMmA/WT7Yg*~^=","SaveState_mkds/mini_stage2/6":"ZNCA8AuVbQ8k+N*K0E$QTv06:R7[rVH}et}=iLCZHuF*k,,sXZ@3!92Bn_Wr7y|IH!/^;^=","SaveState_mkds/mini_stage2/7":"ZNCA8N4jmML~97Uuj)imt0?yVp@Hg6GDH=$d@tyR~U6AZ?r&2!VR,Y|(Q9;}C~63$(*A_v=","SaveState_mkds/mini_stage2/8":"ZNCA8-Rj9_AasF4[t{5}&YPa(@@{|A:U{Ir[1;V]u1W[Pj7LDA5eHr38KmN3&_Ein~[Z?:=","SaveState_mkds/mini_stage2/9":"ZNCA8=sohiPIY^8{xd]oqwi(@p~nI0&HXs-pL_A+SdfK3Ed&EuqUvpa{}]5i5sX(VRUr)y=","SaveState_mkds/mini_stage3/1":"ZNCA8fvbHC7co1Hrv@bN[PZPH*fS@u1pOuy_xqE:ab_XoPCAALB5bY&A}_9ZHZ;hqORi}L=","SaveState_mkds/mini_stage3/2":"ZNCA87I{DP}By};3h=eq[Mu{2AARF}DX16:rY^l)bp3EKW/_mp7go/sETTn0En[NH8YQqO=","SaveState_mkds/mini_stage3/3":"ZNCA8G(EMOrBY|vCYhM)/u3T1$OR32olE^AC@2QF@{LB)Sd7__fVg/B5m*@;Sx*nswWy~q=","SaveState_mkds/mini_stage3/4":"ZNCA8KDc}j[y6z^a~8Kz1e$[AN5!;8K-O{E7Gz0?}M]{]/hJ$Urk$pn:@Q3V/ZZJm)]^HK=","SaveState_mkds/mini_stage3/5":"ZNCA89EVyi[He?7Le{++umaF)r=Gub}PoCJ$6,M|$YRpVy=,UKl]*J[+^inYF*)&SXxo*J=","SaveState_mkds/mini_stage3/6":"ZNCA8Ygl&;&a~-|-X$xBK;)uEI6Qrz)DsGAE^v]DbQpJkueN*7/fV32[xY7pN!892U_ysG=","SaveState_mkds/mini_stage4/1":"ZNCA8,U&SF+|pujlJ,{6:BX-erFz){L_}LA7[dQHF}8JFnPHX4QH*I66oY7sWvqY0i75fn=","SaveState_mkds/mini_stage4/2":"ZNCA8Q_0Kno0fx?uW?V[36o?JMv7jz=rkTA2-8:OvIxd&v!=:QPq|wRZjHtOkV=U=fpE8Q=","SaveState_mkds/mini_stage4/3":"ZNCA87^6Or4@Rdbi{UJ&F+ee=b,@][!DFj|O/v9LTkUNC/ts]sLf9ZOMPN~__S=ho3]ro(=","SaveState_mkds/mini_stage4/4":"ZNCA8W&vHB0UHvduB;xa6$H_lQ8OJNxed5o!?lrl7L,|E&?(y^IQuvO6;o3F&gL$zTEG&H=","SaveState_mkds/mini_stage4/5":"ZNCA8Ad$N0&U]]AF4cS77?ZK|BPc[K*!*T^=k~:+*ejlVd]oyh9U$twcH55@AcU/fi,soS=","SaveState_mkds/mini_stage4/6":"ZNCA86gmYi/L}]rd@JaK@K&mO=/TICSLj;yFD9llYwuBj+!*kzMP*LXK@Ycu&J|5~M(H;g=","SaveState_mkds/nokonoko_course/1":"ZNCA8)debsS+kHQidB279,=xsG{_(_S7SW{s-{T7B03yP2H6x;M*dQe]3W=I8Ga$v]@__8=","SaveState_mkds/nokonoko_course/2":"ZNCA8pu0Lf22]|b?e5S2ZX)Sa{SDX&X11,D!xoMjeb+_eB(l[4V6+OUuxKfOJVz2$~8~4O=","SaveState_mkds/nokonoko_course/3":"ZNCA8Iu+QNXE0:*fr)m@-LdWNg5da]3piVrq5OiIF&X)l{/W:*{vS,)nca)^WK3kTZ-B^f=","SaveState_mkds/nokonoko_course/4":"ZNCA83FPoC=@7hVRG86(X$^-I?P2ah8Kho|=1|euBo:YfTGTTJgWhy(y:4q3&f|_+cvAp]=","SaveState_mkds/nokonoko_course/5":"ZNCA8t1cF2b4g|MP0Bl4zq:8:(QzGt;-;iAz3(1aZq8~&g-jDaNdI(7PX1IdP6}1}UQ1TF=","SaveState_mkds/nokonoko_course/6":"ZNCA8bn8MrR|*/Zu6KQwsjG8n[!0(U7E^9+8YNyMCF;f!kB2chgyV_Q{-)C7*Q}uXd7D[G=","SaveState_mkds/nokonoko_course/7":"ZNCA8Zj|hp(A(d{Wcr:@H|[!iRl+,MhaZ=|)OU{{;p|Rl5cz6|)/;;aJfb42,EVY:$C~Bs=","SaveState_mkds/old_baby_gc/1":"ZNCA8e6RSW&2fi|tdAM!tU--dPRKol)5cJT]abgRYf0C0iADbgC-TR8=B&~z6IMf/20H@p=","SaveState_mkds/old_baby_gc/2":"ZNCA8ISuy=k?}HJ&pSqYI~P$:h(iMu@8Ebfx^[B9HmfOsi@Iuz&i[hL/bD5+k$K_uRtzo4=","SaveState_mkds/old_baby_gc/3":"ZNCA8g($8b1W9257627jPf$}G*(~-h}B$YsawmWRyadvJ[mFb6g+l{Wtx||5y*Q6!,hi9:=","SaveState_mkds/old_baby_gc/4":"ZNCA8Rq;::&}Pvmrgk}kbgx-!ZYOnxk6H,jjvRpjl1gF(7e^eKFaTNs@SaQ(@6u!+Ma(H2=","SaveState_mkds/old_baby_gc/5":"ZNCA8+P!FsujSu_*[xI0P,BhY1Y=NPO({3Cc|4Z?VI)8&x8Vh2E_CCyKnV[jOEBJm*vobT=","SaveState_mkds/old_baby_gc/6":"ZNCA85qZ)yX*+Tr7UWqWWpSba2f/*UqTdnp5*m-Q&WmFEMUw_ws4t}7VVFArcZ8ZVEvjLM=","SaveState_mkds/old_baby_gc/7":"ZNCA81X=cGg=kCdK+MV[Y0hSwqgX~R!jKgVx&ya{?pFc[*RLmnfU+2QTmTIJBDv}Vm8oSR=","SaveState_mkds/old_baby_gc/8":"ZNCA8tHS_aRVZ!V7-u$4m~nNXcj8^_u)Ej9i}NL?3=WGA+FTN6g_1+OI[6Sq8A!x!nix-r=","SaveState_mkds/old_baby_gc/9":"ZNCA8uw,-a:!s^&MW1h{V^oc-(),$~N|m-om]pA:38^$8T?rgzzB/]6kzXEx@|]}:_&&/n=","SaveState_mkds/old_choco_64/1":"ZNCA8jV}-lA[P$E+H~Byv?ak/r;Yge4+MEU&Rv;65)nl6;f@5mJEos&yhtbj6/xNd;G5l4=","SaveState_mkds/old_choco_64/2":"ZNCA8l[l@=*qX9s9m4Taz6N1$el$Ix)-8tGk(sxUiZ3BB[xEA7m]heVb@qva/QD|(n}c7R=","SaveState_mkds/old_choco_64/3":"ZNCA8-YkLo,/;58[(5[mIG3s(]a~lU)h=zQ5(kvBD9odotjqBRsAPbFQ!9~+{Je|q45Ix7=","SaveState_mkds/old_choco_64/4":"ZNCA8GL+Yw&lAb]rCI@)kdbi1Ud-Lx7n35g;c*f0866gGS$T,{$XE=ZOyfI27Vd!mG$isV=","SaveState_mkds/old_choco_64/5":"ZNCA8)_SQt+[7GYuMu~r2L[UOTa!y:&LL)YYGQ0~b=&o{eGk!Nm+DNX7MY-9Ciq3/CAv4|=","SaveState_mkds/old_choco_64/6":"ZNCA87Ub=O?a3j3pkuy2Ky9I(A1HPooySY/,[Oj4g39wrbno;CcXe^G:,YBgFI{xT-,KCH=","SaveState_mkds/old_choco_64/7":"ZNCA8-kyQ~V4&*t6oVs}DI~d/Yv(712U9pmQ~~I]}FUL)fVRvA0IdomOQ@G?$n$FDrje:2=","SaveState_mkds/old_choco_64/8":"ZNCA8oe_ZX,ndqa_B8EuV/XFkQUPiPm|9--Kxu4iZxhA9Q=we7*4c0X_r71-vo9Djn-/}+=","SaveState_mkds/old_choco_64/9":"ZNCA8Tqg{_x(3^FfJX@?vd)-OST9t2yCpvKyT&j}E{Nl(EO9qE}W45[km?I0kRW&nitbJa=","SaveState_mkds/old_choco_sfc/1":"ZNCA8Zvq5408K)@fQ(H$I}d7-WG15??YD=(00@*dlhr9?T|eT$ten+WPv[Xwp7v@+9P9_K=","SaveState_mkds/old_choco_sfc/2":"ZNCA8y4M,!-(K/{4^6a1!L3:3YYcIR95,0!=}fL4R_]VV;|Tt9qjwzv!;Pf$+;{EQ-KBMO=","SaveState_mkds/old_choco_sfc/3":"ZNCA8C/3a6}OZGI-le8ilUj&]EW+lJ]GSn3f]VZ_S+H&//sF[dRELrPJen8ka4K!${/u@m=","SaveState_mkds/old_choco_sfc/4":"ZNCA8wjCJ~PCQtFkl0JI-K]/+tv/GR+3y/KjLUZcX&-guOnY=4b=(/lSsr36tVB=N+ew9w=","SaveState_mkds/old_choco_sfc/5":"ZNCA8$kMUb_b0w!Hg]hOY-$wJ6hP6FSo[XOB,f:(?TO2D]3Y9/YtWtlf,+9lRY0n=tuL!3=","SaveState_mkds/old_choco_sfc/6":"ZNCA8,q,YdevG{-z(TGLl-OiClPl/{GoBjtC=cJ{wHR|6v;zoufog267$j/KB?jc5=}Vep=","SaveState_mkds/old_choco_sfc/7":"ZNCA88k8YnfQWwq2IjAyqh3ZbI3YzLgmoJAN=w}FCwDCWxaJfFwTK+naeFI4X9[FuwHwd]=","SaveState_mkds/old_choco_sfc/8":"ZNCA834*B?6bu^EFKtu8e$V8MJ/;H?/!=6VEPZtW:/[GX=r1!yG2APgYwUG;ks_55nTpK:=","SaveState_mkds/old_choco_sfc/9":"ZNCA8Yxf0r8q5V0-!f=+UVk=KC0Z([/s6t2H=dN(f~?DhM4nWl)49vY_47IozxA;H1T@zd=","SaveState_mkds/old_donut_sfc/1":"ZNCA8(VV=}r)0;5Joj{$ME]/=RmYBpc5Eh0hUj^7k)lYC@1mN,NHE4@ucifns:rD6eH!/a=","SaveState_mkds/old_donut_sfc/2":"ZNCA8P0pjGO!-ZVbRPx6{y8{zH@G!ux:1HpBDH=&9n}ya)t:=m:i??Q~,hPaK!Kk4Q:Wam=","SaveState_mkds/old_donut_sfc/3":"ZNCA8Q:x$NLOE6I+icz6q@y9)8rfed$LJos0xDG~wg)+_~Kkh^xVzVY:Rxh*ysBb_!raD}=","SaveState_mkds/old_donut_sfc/4":"ZNCA8U(!:&HmDE7x,g|UxH,P2M@1XH@-nYhN-R{^z;tACRkU&qbYNC&5DyHZVc/h:G!Kir=","SaveState_mkds/old_donut_sfc/5":"ZNCA8j9IIt,~Dwh9j8$RlNdSy$m]0G1deqUtJ?GAnYxjGK+R8=c*k9O2*Fyg!Cpohh3tQ0=","SaveState_mkds/old_donut_sfc/6":"ZNCA89o_f*Y[DNDzM8];T^K5wadQ-gS3^Yp!^x1e3unKf4i]_7(~3&fF3sVY~5XgGfWL]?=","SaveState_mkds/old_donut_sfc/7":"ZNCA8TqLgxDaAf)xwY@CuTU4(dYD/V0FgwNiJpD[Pr$[8()1HT(v^tp(uW@,M^?X9Vw&7U=","SaveState_mkds/old_donut_sfc/8":"ZNCA8y5g&_apqzHS)w{TiAVQ=fro|Q+FWM{rQ!GDAf2]?ML),[EZO5@)7X/ikzru!n{foi=","SaveState_mkds/old_donut_sfc/9":"ZNCA8R7kI9F!Hgo+A57Z1&Yuw,KS&&NOdlB77ClX*At1{S_ini3(k!X]4X9K:wJEgx@9/M=","SaveState_mkds/old_frappe_64/1":"ZNCA8qhrYndwymCr/zy9;FHc+!M5c)u?/=nxpRQ*ERBVJ&2e0XVMgizs/F@|(+tF95LUw[=","SaveState_mkds/old_frappe_64/2":"ZNCA82E!0[:tSJ;]?qS0O?dj_oxpqtg*Q:zGW|8^Hb1GcM5+$pClA1CQkP}[Rw0x1d(S:_=","SaveState_mkds/old_frappe_64/3":"ZNCA80L0l]yk=@-aVwGjd,y2Io)J01+Rzz&p=aOjOf@m:(HwYzyEqtu{QH:d?)vYWmcj@3=","SaveState_mkds/old_frappe_64/4":"ZNCA8hs$Oq386Y@jU?5@f-6aEe{O(G${:je-}RiCk@;sX1)Y{=sqZ@(s/8LA,_?erC&3p+=","SaveState_mkds/old_frappe_64/5":"ZNCA8j?wyRQ}Y0pmAP;Lq!4vy&|-inz_}Zzq6@wZm7;D1F@xocfe(RGNFD(Od_!IqKD5/l=","SaveState_mkds/old_frappe_64/6":"ZNCA87*y3J$t!4=]VGYFb]h+P*Tu|Rp8TMW*00G5;Ev|AVOwJcVdBhyCR7}_A7N)A5c{U,=","SaveState_mkds/old_frappe_64/7":"ZNCA8tPs]-409Y^,/4QF}JF|M6yjB_M8mX_lpKKpl1gEj!giz[j*hpGF-qMvjBgQtM/)B==","SaveState_mkds/old_frappe_64/8":"ZNCA8gGJf)@NQEmk?$RNH}oi$F/xqo!fU=~TNQx+_Ah0v~(XS-MXrE_o(|g,VAJ1e&ovZ8=","SaveState_mkds/old_frappe_64/9":"ZNCA8p(hiX7Jir~/~6i:qg/qNnOPqPAo+TN/6qpw8Vfukdewvm:B5mwxl7Ek~W0o))3=FL=","SaveState_mkds/old_hyudoro_64/1":"ZNCA8{lV6a;d!ULlCN7{r94T;Vcq]9/b{vpIca(b=q&nz/[5:/A^s^!54L:]:EA=&D+_:T=","SaveState_mkds/old_hyudoro_64/2":"ZNCA8,7{8VF3K|WUddH??;B~SA]~rM2_K3yc&xXO7X$,*h7wkwrs~F,t]st&2p=s{0bOmV=","SaveState_mkds/old_hyudoro_64/3":"ZNCA8b?/rIO&F29-F[]W&cWIH]UT^pEbAWhGiiYV2P4f-ax;7y3O==)-04;$372?AVyPE!=","SaveState_mkds/old_hyudoro_64/4":"ZNCA8qDLAHjQC3GqHzHHn/!alMAN(u]_mGY:p&77hmQq6Acal~3$/1tTuR{}p)9@b]PqPV=","SaveState_mkds/old_hyudoro_64/5":"ZNCA8vR$nw76R$97;^V{xFb@og7]P[H:GYGr1yiHai3r:/A[@;Mp1vW_}~,aQVkJ99TDxS=","SaveState_mkds/old_hyudoro_64/6":"ZNCA8op3]y0|8|J}Es$&AwZpgtOweM4*fr8G99hW{/HrX,4nqpy9S,?Kft[y85mVPzJ*WP=","SaveState_mkds/old_hyudoro_64/7":"ZNCA81LOEFQ0uA$yU=sFF@e,w_;?!qYTIY:2TNEZJM4[JB}@t+$!Udvl$|uLG{NpZYvjQO=","SaveState_mkds/old_hyudoro_64/8":"ZNCA88y$+Dkw8SVfJ7HDrou*uJKq5DuhLfZ389GZfo_D)[E*YA/r-OkYvr6&ud6([?Z]e{=","SaveState_mkds/old_hyudoro_64/9":"ZNCA8q4ph|tFQ0t(F|q-{k{$lWO6[?sfv{2esO;T0[s48$GP78Qs0O5cX2:*J7xzPN4w&u=","SaveState_mkds/old_koopa_agb/1":"ZNCA8X3plNMSXAqNz),G)!kGuxMswM79s*S9gtol/cWkQI^PsGqYk$8{jTejJ2h&ed!{P;=","SaveState_mkds/old_koopa_agb/2":"ZNCA8xSr8=ONA:]s)(LqGMy_//:RQ=J*,*mAY:~zG)XLvYMNyS3iBSLEbXL1Gu?;glztxv=","SaveState_mkds/old_koopa_agb/3":"ZNCA8P2cIIQm(jEZyb!_g4[G_ipPrwwt@xZpL]xx9YBjBa8&N]_fKv/_6[8nrVjuBp4xjL=","SaveState_mkds/old_koopa_agb/4":"ZNCA8of8r!O|T(ZTUCjGg2f(^_fYlAwde(VzIkl?Xza6U0$]sYHoY9?!+z7Le]OJ{rc_;R=","SaveState_mkds/old_koopa_agb/5":"ZNCA8Pb-yRXL&,ZQUs6cxv74gWW$_x?xC;4A;_v3w,nG?cta3zmW(FUqshi^lN7fyn[GTA=","SaveState_mkds/old_koopa_agb/6":"ZNCA8/ZendkZ7wjmM)mkpwgD^JUrg^W7wJwEh3sT2Dy^bUM6HY&?n~swU$nrd_wEBu+-av=","SaveState_mkds/old_koopa_agb/7":"ZNCA8/@B=9{;[Y@@8*yei-Z/u-]xkT[B*~;jnr$i:i^1k*aJO8H9SI~/cY=pM_Zn,WDv14=","SaveState_mkds/old_koopa_agb/8":"ZNCA8;qKApag/!oSyH~K(28/5oC9CFM8LWZKqy)Wor5JZ$lh[32c*w9wgshtNm@_FVe[8H=","SaveState_mkds/old_koopa_agb/9":"ZNCA8(5ep!2k9u6-3u]Yl3g?M&J*F76Vo)Etk8]1:uKkn&NthFaMenI7jttW/^(P8H@R;Q=","SaveState_mkds/old_luigi_agb/1":"ZNCA8UD;])_4G!5@DPQm)DcYlp/y66Zy^y)NS}QGe5h@*_GjI}76lW32qy+(y$]nd;adz!=","SaveState_mkds/old_luigi_agb/2":"ZNCA8KL07Hlb{Q}B0f2T[3XO?EiR*u~kMtL_h7yE9FJj)=sHff/[d;oigYOdf-eX==S5??=","SaveState_mkds/old_luigi_agb/3":"ZNCA8T/^E}N*{&Y5)L=^+3upa{mIjv&Srq~57I]y8b/e3u|61d*rwTgrsB]{Q)G~&w!LsX=","SaveState_mkds/old_luigi_agb/4":"ZNCA8yJi15K,P?{XSz45=0*~}=f:Pd~}1A/qQigza6s]Iw[|wB0sy3pFx}by_UL6VNF!Ef=","SaveState_mkds/old_luigi_agb/5":"ZNCA80k9llA|MRXsWh!yHv4ollk23TAWpV5Ut6m6vDM&5kE8ZDSQbiwEBBA}ICmfc5[pqf=","SaveState_mkds/old_luigi_agb/6":"ZNCA8D2&GXN9k&0i@^,c2_&E,MGPJXKbTu[MF@s8rU:PazTGPaaGSt:GS!M-4&YI+G8QAD=","SaveState_mkds/old_luigi_agb/7":"ZNCA8xeXN0TjeVO@:oN^d|5;Wq88]VQ~LA(OZRE)JKER6EF3H(U]9;tj10U,&9&9joavwk=","SaveState_mkds/old_luigi_gc/1":"ZNCA84WU&ub}{*RF7/:^ZU,t(UE,VSMu77V~Z$63-ur18Pyhq{leoC{9&0*kaZ8vpD+@/U=","SaveState_mkds/old_luigi_gc/2":"ZNCA8faQY-EvZcbRSbiEj$QPlMXw{Zf9R[Y~GN5qzH/+}$4zN0$Hlfw2APPUpO+Mmc22+(=","SaveState_mkds/old_luigi_gc/3":"ZNCA8k?N?yC)+[E5,A,*4-M2t76h,EWDI^I=qd3WcI1{?]zo&buUaSp!TU9Wl]tkc8j(6,=","SaveState_mkds/old_luigi_gc/4":"ZNCA8Qrm~LZOQxqzAff~w1*PzwyfxeXNp*Q;Lu&9Z+b:@dkS7@51@Ol,$KHvUCH!aRQ:D!=","SaveState_mkds/old_luigi_gc/5":"ZNCA8CAfzR3Hu^bmLYZi[hgdp~{T@~7?$q(H658Z{PmZVgicfj2+Kgpm[_fK@C_P?*Mu8w=","SaveState_mkds/old_luigi_gc/6":"ZNCA8fZ4J-D$j5X:!qsF,s*[pN7e]+WYbw{oiKp/QUpc8p_t?m&uftUaomM[20e,su-3]6=","SaveState_mkds/old_luigi_gc/7":"ZNCA81,Fchm?Ng5_K6mA4bSc4QAd1mu/nZayAgc_GTJ/,?n/r2Q{P:ahq&3j:1uYl6CeQ|=","SaveState_mkds/old_luigi_gc/8":"ZNCA8M/n9=vI2TD-@tWm2F_-P)!ZAmNpUD&?ds/~I7kPW7ZPYF*kCq3Nc~$5-_{&4t37f(=","SaveState_mkds/old_luigi_gc/9":"ZNCA8TzioVJW4sUT9Yms6_-[*jWCz}7MCTKxL{24{_@nj,+;eiO~&B2VCds&lzj!_zf-5i=","SaveState_mkds/old_mario_gc/1":"ZNCA8jH61Yl2mFNCtmA5S_xt~0P|HgJ/s1/l(w*0VvdD=NP*o$8T9Q/A?uOcCYfh]dS+)B=","SaveState_mkds/old_mario_gc/2":"ZNCA8acMRS9*[F)v,S511hrkGHPnrV0PA7;f1HAwtzqVWWw)(h~3!1|t1~yWwGuk&ykp,^=","SaveState_mkds/old_mario_gc/3":"ZNCA8Fw/|=@J9e1NlzyK~il*,Vrseu*8+PN4eeYbhHeyqwHX:72nBDVadr7_QHyl]c^}*|=","SaveState_mkds/old_mario_gc/4":"ZNCA8ZhbrpHJpC[CcrX3?d7b0msDQ[t!;zTd@tyR7X$,*G8nX-hJqV~RY1L)0jXRgI{&|M=","SaveState_mkds/old_mario_gc/5":"ZNCA8x}fK~2M=ys,nM$XcZ*L/88b!|Ljt7Up=aOjLN6gOcw_kL3b3ct)0PW^z]s@JcNiA&=","SaveState_mkds/old_mario_gc/6":"ZNCA8aH_HISf;U}W3![Cpi38_hzmgnNAI~EE(6uV/=R*s8cT&Q8(SSRb{Nw_mgY!a@*t/[=","SaveState_mkds/old_mario_gc/7":"ZNCA8TeU8A7fPy)_B=+_R*[BR+98[pSs{968jxNiB@l&7FSh;3Qdw86Q/4_*Uog1p?(Q+}=","SaveState_mkds/old_mario_gc/8":"ZNCA8{,HZ}GePEnGek0J8}IDSf!feKrNgRpoE4}x3*vJy_J-4mN/hyBSPaK!~v~[_~9c$f=","SaveState_mkds/old_mario_gc/9":"ZNCA8Ii&br6XExxc-9,j*@$GD9~g7AEF759ik;M]Si_;~p3xPdg8EULhHcaT?5TsM{vB5b=","SaveState_mkds/old_mario_sfc/1":"ZNCA8Rx1iTQ8E_q*oEHuDr9;0p(}uunc}:(w{75Cb1v8e,}z$hlgLzo4?T2ht3MT89h[r7=","SaveState_mkds/old_mario_sfc/2":"ZNCA8KyT4_24xOCSO6Zd]h|LXOuLVVd5E8QtVe8Xz57wi{:]{Vx|]Ogd2QgBeQzy8ut[V&=","SaveState_mkds/old_mario_sfc/3":"ZNCA8694n@ZgxI~3u39gaIGzYSfcWWlkBT_~4{XGr{q2+qMbYj,ky(_F,YxRdC:5A,74!l=","SaveState_mkds/old_mario_sfc/4":"ZNCA8mqF{e0f3a1@z~-+lf/|}/t9=2vZ*2*lwN:W5KPn?nnK5K8Twu2OU^/XTVIWT+:ZLn=","SaveState_mkds/old_mario_sfc/5":"ZNCA8E?XFB$rs+CETXpm{Al6=bn/$tNH+9r@=iS2Hdzh+G2{Mbs]@|1$+:3d1H|hvMDiPk=","SaveState_mkds/old_mario_sfc/6":"ZNCA8xv]_ONeyNJjM1=21jxgplW,Gh&/!a}1,;lTac4d=rfXpakrU~uO[J0jpRZ4Ac5}+$=","SaveState_mkds/old_mario_sfc/7":"ZNCA8fqVV{DVr!_j{n}kDK=O9JxH&P_Ai^!sx7KBv8_S=[BvSdFeW?Lxr@heV)tc/{QNDQ=","SaveState_mkds/old_mario_sfc/8":"ZNCA8Mf5B;yAc^Jq9C7xzlni,H3tC|{,0,Z+D|!4cxADF[i6Vf_!bO25yUo@4S:Qei)NS_=","SaveState_mkds/old_mario_sfc/9":"ZNCA8deqYjV@u64gmrR4pgEfVlUMYHY|1-2gBF!tLSS~PYee,)A0|qtlhJMgFhrPujp*ds=","SaveState_mkds/old_momo_64/1":"ZNCA8I(JH3ldZmh![2J3h$KfNm!p(JWB36MR,_j$IL^/UO[[O=c*@]ciWt*?zA5LjwIP7==","SaveState_mkds/old_momo_64/2":"ZNCA8v/0Zb&0Kht(ufrKwgiEJq$)uC7Udv}r^t&q)ZP;NoFV)TI!gJrlU4byj;I&9&li_g=","SaveState_mkds/old_momo_64/3":"ZNCA86Q]nr/D&xn6nmth(ja&PkG=1z0,+_-$a$+ficjKySFRxj3F{:)kJnd0D6sY1XN^Pl=","SaveState_mkds/old_momo_64/4":"ZNCA8Pmvq|-6K/^NMUUL-GABcQsvtR~!0O|0gGNE:r+FjBxNG|huvs~?TAkZrncdL:Q2~y=","SaveState_mkds/old_momo_64/5":"ZNCA8Uw[JA/3d-4f8/UIR;DO5}TpU3r6~(Bv~&vf8^*4V_bwjFVGLq?!*A6Pv_f7Uc/[zk=","SaveState_mkds/old_momo_64/6":"ZNCA8fb=@,E)HRkdNZK:4uBpbmGvKo-v90V/5-RvuyfXa2A{4$ad[+(/df[ulf6[lIzNgB=","SaveState_mkds/old_momo_64/7":"ZNCA83xohI)L@{SgB4LR59[HCB5|_=I9(]VY!44o,@RFn:kSW&RdE}HmgG^dXh-3[Qzw]Q=","SaveState_mkds/old_momo_64/8":"ZNCA8zKbUd@bO5IOMZoYg=OGwZ:H^CpIyarnR[f4V@vG=O&2)L{&{X]32$]LLAd,,J|a~C=","SaveState_mkds/old_momo_64/9":"ZNCA8gi{aEV=k||izpueYvXwVsDX]2ux|c-4/W78znUX]Iv5H0UjlrA_k2Tjn]t2=&nRXB=","SaveState_mkds/old_noko_sfc/1":"ZNCA8)Qc+KhRYKHY)8&Vi,dV1jc/:{HhBr)Ptt5~ZO$keg-j2rLqAk(XuK5ZKx8@K~G5Xt=","SaveState_mkds/old_noko_sfc/2":"ZNCA8Ci$T0aIE8M&v0)uc4}st-8C6;Wj8V_qcDK$571BT4wdH^oAO(TPkX7|*bNkWf_+9a=","SaveState_mkds/old_noko_sfc/3":"ZNCA8gANV&,W/q3DE=a&u*iM|k0OZ}c{WL$RziUR/E$UT17(7LExJbm~PyPHGKeLCRQw$[=","SaveState_mkds/old_noko_sfc/4":"ZNCA8PAv/3QIG,GS1m:FYbJjIf5ed-i*9DNrY^l)&Z}klQ_X1)QE~|PxuwW/6oA|N~R~Bg=","SaveState_mkds/old_noko_sfc/5":"ZNCA8bVv_jFE/66?O^:+TfcmPRQ?}r&w!16=9mLaWb+~}j]eImjCy(q7!wmyb]icd,]{^h=","SaveState_mkds/old_noko_sfc/6":"ZNCA8$,vAuqj8oqkjusYeVxaEb:G2&P@Z;t-jL{-k-]U1Ouu_tC06+4-*pZAyn=0?QRANn=","SaveState_mkds/old_noko_sfc/7":"ZNCA8zIF]/?[/WbAVY0v3-42SV+FY~v|RkgzjJ?B/i8GCJ!~$D!f}3s$vNG]ItoB*R8t(N=","SaveState_mkds/old_noko_sfc/8":"ZNCA8NRJN=bn~=xC+YvB@}EuBtT,d+Q/Hysrd$7o@NQNoE{A0=dC&CJ$k*tbe|Zwp]dRw5=","SaveState_mkds/old_noko_sfc/9":"ZNCA89,I8*OaOENzCcxg5c7jn2I2)/NI5~0NAyJj1LFiEkcEW:pmd&x0WJHZq;LUqM}}Up=","SaveState_mkds/old_peach_agb/1":"ZNCA8mT&3EuqAo?BOdDgU|!d=8RmW/O()M7qg*gl?$[e!-9mqjdgOI!tt17S}LaQ;oiX)[=","SaveState_mkds/old_peach_agb/2":"ZNCA8:&{|VCzBlk$X-=7GxkjZayQ,FJ6G-xygY1ci-*Yz@|91UuqaJ[KFHhtyKEc7IkKIH=","SaveState_mkds/old_peach_agb/3":"ZNCA8K&;!LV|~8a;jT(xHFE*|=TF/:vt*RVQ@rPfKRw+*X$k8REj{o:}ND4=qoG9Ws/t)!=","SaveState_mkds/old_peach_agb/4":"ZNCA8*CTa,XJmeXzT(BwS+ZUx(jb/v-Yr;Tkz+xRa~MmZk=}&6Qz*@V!7qff12j}XWRd0Y=","SaveState_mkds/old_peach_agb/5":"ZNCA8p)/,&I(46?=2zTGU)6O4;lp3c$c3tK_T9YqUyix[c&}EJbvYCP=WQIY-w!6aE~DU{=","SaveState_mkds/old_peach_agb/6":"ZNCA8Dn!:p-00P$k}EK5IkPr~Q-rfUIH|V7?}L4zm)9P;C_/!3Fm&Zq$r_O:_BcqzR[l1G=","SaveState_mkds/old_peach_agb/7":"ZNCA8Z,{U5N{(1(@JPI=$ND^aQ$dBP0Ft!x&dQr}:TDgJQ^0CydZ,;/)ao^_$x1T6h4(8}=","SaveState_mkds/old_peach_agb/8":"ZNCA8(0GX+]&t}+rsu5b)VZW)kZ0_SpX[5Zk{9Rk9(31Drybe/I2,}$N:b;j+[pl)W9Z,b=","SaveState_mkds/old_peach_agb/9":"ZNCA8z]syLUmbh~]TW)M+KNFQ?O!MIoavf2-?j$9G$d3EDG)!lbstgyw^;UCGZS5FCHa[1=","SaveState_mkds/old_sky_agb/1":"ZNCA8]bCTSp+4kUcWLwe8&1b1a*x$We]D~@Yhr9/8[-g4LFefPYY_R*JEh918dp;1YAb~-=","SaveState_mkds/old_sky_agb/2":"ZNCA8HnJKGpX7iu1fk)m3M-g85{n,~seQ6sE^v]D]NHVzWDfiWomLQmBuz!0yopu+D1sLu=","SaveState_mkds/old_sky_agb/3":"ZNCA8(t{mNMDuO[DZkeK(Awhr-y*)wQD}wosN?hGN@Dbc=]T_*)lTDk?RM5*US!^qoWI)6=","SaveState_mkds/old_sky_agb/4":"ZNCA8$k^?k)1/qHmP&s}HP9ro[?=)A?Z&75eItPZreRg|&VdnuH)t:ARFyn/s/Oy&=6HQk=","SaveState_mkds/old_sky_agb/5":"ZNCA8+&6J9K)+ocYpkJwXX5uVb?kHI$[X?!+]-T9*&]lcRIy8OucHHjT^2_9?EaXH2{ZTS=","SaveState_mkds/old_sky_agb/6":"ZNCA8vw+)|-00P$v*@e+RTwsb!6$+02,~ER:AZKJuXls!?@g}{F,Tirox,kS]~9rJl?G&O=","SaveState_mkds/old_sky_agb/7":"ZNCA8&Z?~xg;qIpjpZ:,GsLcd+:Qpy!Dg:w?d+}?]*f?4j!ROzP?ghP_]_daY_smQFfY1s=","SaveState_mkds/old_sky_agb/8":"ZNCA8vl=3_3g}QG]m~IPDlfMHn-h4d75+axXLo:C+]2|0cc[g^dNQ[w10NYWYRz0!-x]KV=","SaveState_mkds/old_sky_agb/9":"ZNCA8ZbTamIeUQtT-=14~8A333:hX51OJQ~xlrQ5yE{zB5Zyl&&k6FX:+hgN9cREI]{A;7=","SaveState_mkds/old_yoshi_gc/1":"ZNCA8:mC0UPQNSxNx0Xr/+=WeWBB^El;7SMZeoD]tJLQH_=oejDW&k1E^w-;K4@tSZt7Ax=","SaveState_mkds/old_yoshi_gc/2":"ZNCA8Cx*_nt9fRdxM5,kt,36Gr7aN*3AECdK$]_jAQQ3Ze4-)0T_=d/Ry5f1/K:FD4p1jt=","SaveState_mkds/old_yoshi_gc/3":"ZNCA85x6B/:+]k*AJlPvGBs+@AK8[=pq-z[yK?i}O;t=qR1AHg7E!8h=@0E,(c2lVlB,[p=","SaveState_mkds/old_yoshi_gc/4":"ZNCA88R~&ke|sU6g]PGypcglRYbTL$M28{ngK_cYrtXyf_pXq(C_}Wga0pZw[-KnKnmA=1=","SaveState_mkds/old_yoshi_gc/5":"ZNCA8*WEjaE,x(RHa{?45Yt,vDgZ3+qR*ViKPrI3Ei8Dk9e/OW,F:ebK86rU/)frHeY[4v=","SaveState_mkds/old_yoshi_gc/6":"ZNCA81Oojp~uOcKJO?J_yLjLL1^+8h&/AmJJt]!1Ofyb:O3i{1D0[$:U{*AcK{c@Ku,xO(=","SaveState_mkds/old_yoshi_gc/7":"ZNCA8y3rz$qj1NvfkK)F?5f]=}P@S8]$QxI,Vo/Gw_znSO24Ah3uscK/sdDmVey:Sod]09=","SaveState_mkds/old_yoshi_gc/8":"ZNCA8AVDAvm]NSE0-B_77s;-^)Z(bsYFW-|fZ-$v6L)g9mf_@_2VPpE[Iw1:9*+&iq];o6=","SaveState_mkds/old_yoshi_gc/9":"ZNCA8&9;/z)Et{CimOlleo)BKSnZJpU4Ner9b6z6GM0KX005o1m$zA=2d7un}R!Mh9f57e=","SaveState_mkds/pinball_course/1":"ZNCA8OWU?1&JcinziK7t,nUx[rHyR[n[K7,~IiN=!9d8GBX@gvA$iG}FaNInC]4&=uZThj=","SaveState_mkds/pinball_course/2":"ZNCA827=A$iFknlRQ(P{sT^KzFROzGpr+&rU$aY&/4;}inpHLjpk&4}2y3rY*5Q+Eidq6)=","SaveState_mkds/pinball_course/3":"ZNCA8W7X0Q(tdP4?ZRn~(6J|P+!;++kKhk=)P2IPV5,|zp-JvRfA=e|YGFbEyiidAP*Xz]=","SaveState_mkds/pinball_course/4":"ZNCA8w228onx3Y0(pFD+GiX8TDX8AJ3Pp54FfDumZ[~j{Wf}{2b,RFHtTapj8+w5-9-qeJ=","SaveState_mkds/pinball_course/5":"ZNCA8+Uw{{UZG-wIB;nyo8Ih&8b=ypX}$d{GUj1x~r1g&Y[aJ={SC4Jcxr!L)6?sD_yyNX=","SaveState_mkds/pinball_course/6":"ZNCA8P9FcHFEd@P8}g!{R+BTP_6;bGi4iUhZUA3vwREL/DeBk=mht/oEF8KrhImu@5r@!r=","SaveState_mkds/pinball_course/7":"ZNCA8$*R;*Ev+;Wt*oIAZOy)iH2_isOo+yUudjar7,Sm563s/2UG@QS8?~Jta@NxZgLUf3=","SaveState_mkds/pinball_course/8":"ZNCA8,dJ72UvGf?Vjh3zJqw=G1hVNSHiFyqRJ^xw/tECh,ubJNpGKknw4QB{GO@LCmBvl|=","SaveState_mkds/pinball_course/9":"ZNCA8KC3n|SEd84m^[k045KkU-of*E,EwAs[a7Y@w!C(;q6[WzB87d+CRCdIX?H0@b^@6b=","SaveState_mkds/rainbow_course/1":"ZNCA8ZC@XKx4w-Ui~PKx?1=/}Q!)CF)@}/Q${t*hbx8@?d9PfdC8K^zZ!@MN(2]Z:PYV!a=","SaveState_mkds/rainbow_course/2":"ZNCA8FpuaAgnI&q-Px4a)&a^pIJjJgL~e/]P7*He4CfY&hb?&Vh|p:3EkwkA@PKBi9|L42=","SaveState_mkds/rainbow_course/3":"ZNCA8tO5$@n1yGX_S)3]8@!qbH0wx^yEu,;$e15zblI^mV+|C1x|9O!DWakPXgE&:j^+6+=","SaveState_mkds/rainbow_course/4":"ZNCA8l0:sKVNh|]43S?FaxI1G3nc^DanAE[f6acIi[[tbhfI8N/gxrIPWwp0qbO|J-N)7(=","SaveState_mkds/rainbow_course/5":"ZNCA8ef?nXV5B={oK;+a8$*~uvF&DBma?)*y}c3;Xxcw(AYMNQ;3XS3,QIBv2ip_59oQGB=","SaveState_mkds/rainbow_course/6":"ZNCA8HdN|mBD@LkWBddC]P-dC?_ZrpX/DiI?Cj]/{dv]tJQFJi}P6b]zTQ9O2Gp1f@$[@k=","SaveState_mkds/rainbow_course/7":"ZNCA8!Sw,rC$ayds1sL&2LB9-Xc9}j2K7U|sN?hGi-_TzLQqBrBwIv7v9mat81M2Y@FS:5=","SaveState_mkds/rainbow_course/8":"ZNCA8Yp^YRyT6jM5fXYK&eNCt,4](k;5r*?_{iRa9w_ex[7usEMeTa*(y;?&7}e)g{ABDK=","SaveState_mkds/rainbow_course/9":"ZNCA8[Mc8+9h:i*CE6+nIl_67PM]YQJ{N=tr2_AN[,N8L[t3*F)]uXqc8n1OmTpD,Oi*oF=","SaveState_mkds/ridge_course/1":"ZNCA8NCS}2V~z};_oGonu$u/Z9Fn6EDD/&ws-s7wbQy81(yD0e~MkWcn}7(^77h97coQlI=","SaveState_mkds/ridge_course/2":"ZNCA8;GufuZ[v?:{MY|6M(mb*,9I0eDMTvtRg)]K~@3J!8t(+swg8T;91NPfzFX,{z^UOj=","SaveState_mkds/ridge_course/3":"ZNCA84ZnCT,IsTaFPBCDA;-eVZUfi?Vd&+ZPM@/MV^:B1gs;V$oVHhioyG5JP8JQDdylS2=","SaveState_mkds/ridge_course/4":"ZNCA8R4A4Y//*?o7f]Ktm*+knihmjh*oH3I-6imdL9SdHmcLpDo5DvMA4CxvRVXBZB-U3c=","SaveState_mkds/ridge_course/5":"ZNCA8=q:j(Ku}$_{teC7A!]l~zAvJMOH]vsh:E6_krsz*TjhBN8MM33B?XdSQhr=k:]6fn=","SaveState_mkds/ridge_course/6":"ZNCA88cvEWP)_-E+Wapb5J|K0EqN&nY&hL*B8qpL;p|S*deUYG)gv6?tG{W8t8Gh!rw*yv=","SaveState_mkds/ridge_course/7":"ZNCA861a$YBn6POgD@+/wi,*}QFn]oY~Ambik6$:mllVB:9A94AsFa:sSR7[/&7R[qx^LD=","SaveState_mkds/ridge_course/8":"ZNCA8[D@)F?HuF//Pa89F!AHH_!7J/k@2_wO*yuZMLphs(I@-1N86b^QeD~|aW*K~xlv+W=","SaveState_mkds/ridge_course/9":"ZNCA8*3Q99r*7+6q&2a:30YFTkZ+(I(N/&U-6imdQS5/V$hsNP$5RvKwpwX~R!1vmpOYmB=","SaveState_mkds/snow_course/1":"ZNCA8s=p:qNNQvOK0d;mB*q[7gDEqIk~+mCDJ;;fY!]KkBNPq_L!D=e,~fCqthHbP&@$yA=","SaveState_mkds/snow_course/2":"ZNCA86FZ{YSVal[0X0a],w:+s0h:9X=3l66w3@mMV4Fq}D~|j26h|enODD{3iO4cCkZTYJ=","SaveState_mkds/snow_course/3":"ZNCA8CeX^e$u~+q?jVK_H?nBpM2_9_GFTb6mU!@wBI98kf=/X@42@wfQ?n+u!s+@[iPp$C=","SaveState_mkds/snow_course/4":"ZNCA8k)Q@gB$)~y{/FG{WxvDzLt7X75ZCw:wF)g3NvkP=Jzrw}=X7+p?hld8D7Aqb!T1]]=","SaveState_mkds/snow_course/5":"ZNCA8&:AzWzI}s2P[Ig&WErz{Qhx;r:ZAda~|Iv*ZlEQAzU~wx*2_is&*FHB[T}8ybq]~O=","SaveState_mkds/snow_course/6":"ZNCA8fh7Mu?,TiJP!nw)$sBD+:O,vv~a(nbJJNvxN(++muk6G7EE^DTK7flEK?slF9X9CO=","SaveState_mkds/snow_course/7":"ZNCA8y!KDP*0hqAu!,&9ctx44dT^F:V|yURnL4T}GTzE{C(;N4C_yT+_+ArfRVi~SE~)N4=","SaveState_mkds/snow_course/8":"ZNCA8Q/XoEs1SA-Cg|q(1yF,[KdY88XD@JOp@HXy$q[Ri{AKYSP7{4f(G4h^zO/!JPVq~y=","SaveState_mkds/snow_course/9":"ZNCA8M9=u3=^PH,Dh&:4vmk(nG/VaC2dpF6dLw]WxL*ZQoD;IK03l[61QINvhCp]2D$t&-=","SaveState_mkds/stadium_course/1":"ZNCA8k!,D/-,cbxJwcuTXMSM+&+e/2@R+SD&0@/mt!yMUL?]sRTi2Mg1n3LY8!Qn*dxEhA=","SaveState_mkds/stadium_course/2":"ZNCA8Ulqs=Qo33l5?4K)4h+pPq!,Z&ezk+joE4}x6Q,?OO,1gP@:s$GTR=rP+CMrUcNk+~=","SaveState_mkds/stadium_course/3":"ZNCA8f@Cm]v;nAc}Q4Fb[c8XMFddwSa}(Qg8xBt8XbiD?y_$&I{bM9}LYx$/ote$D7}~5/=","SaveState_mkds/stadium_course/4":"ZNCA8!-_FN;Hn5kq9z3dmZLBMk[KtNs+g|x_3e_gMe[vJZ1A^GprAB,kvSXyUpO:ZkxdQ==","SaveState_mkds/stadium_course/5":"ZNCA8sgueKHd=AIC1sNtUJ!-j98GXTM{2xe:/Qi;bjkkzo&;{@,=&B*TOQK,8PPGL_v?9,=","SaveState_mkds/stadium_course/6":"ZNCA8bJ:xa+-:4e20HaSzrGTIm?UD}vKB;k~$OGSn[FkNJo]?vhYAt~1+?s?MpaaSp}6u}=","SaveState_mkds/stadium_course/7":"ZNCA8{sfyMr=DhRr55^nr$RI3Xl!d]3{z/Vsa]Brh4A:^yIyVv=[2kO6BS8?ZiWYeJV(P:=","SaveState_mkds/stadium_course/8":"ZNCA8)DGu[e?7+Nr?V7CMLdWA0I?x^g0]=_r5S;pjx(lFZjGY/w:ZkC8-]mhELU*[b!n$_=","SaveState_mkds/stadium_course/9":"ZNCA8BPPoXJrFGb7|3)i5YSQ$PdW[+~z/Jz5lvMi{O,=qHuP08n31bZ]ZcQTU6d6Bc!HX?=","SaveState_mkds/test_circle/1":"ZNCA85[L4sKh){$=}2/BqJ]E!Cz/[tNIMVo73o;Nkn4?0;54MHe}_sC(SSz1ks_55sI29p=","SaveState_mkds/test_circle/2":"ZNCA8d&a!_]@2ac4VagqMYbgYL(-h9)jio{:3n0OhhPu:NZULHAW{rRy^ZZJZ7M!;p-pGM=","SaveState_mkds/test_circle/3":"ZNCA8hb$u/k}Ibxb|YKSP-+A}nUM4G+kdH38ckIrDh9MN]Y*UfxSL:C{zcdpduQ/&jTv9,=","SaveState_mkds/test_circle/4":"ZNCA8!u8TsZ2im~eCK)y@Gs2!CCAc7w0*nb=pF?J/uc2ZK_UUWo:jvq&xPiBMiR=-]vzI:=","SaveState_mkds/test_circle/5":"ZNCA8!o?o(aW:kI00ob?t:uHKAUp80f+UHWs2;+b8&K5}0_):&6bvyV?3v0BKoSM)rsJ?5=","SaveState_mkds/town_course/1":"ZNCA81ol-g_xy|-BWNxD0EQ8ag01vZQ+8C0kQ?7l_W;P)5o4xWj=)4JMM(61L:j465(UM2=","SaveState_mkds/town_course/2":"ZNCA8=wS/LmydY,piIwwx;ssB6{GKG],-g+Ica(bOcKTZ?5]~=uziStW+nloW~:~^xnWI7=","SaveState_mkds/town_course/3":"ZNCA8e*eImr?jizmGy6F[vY2u*$&X}v!}W0V^:8f,Tv/)CJYJ59;O~X~}5~D2C9wJ?vg,h=","SaveState_mkds/town_course/4":"ZNCA8WE~eN!Z:Ot(!)+0T@|K&Xu7~8SiALe[O[fuLs=:h,NjFlqpx:Y~@IOYf;4_(cu-@B=","SaveState_mkds/town_course/5":"ZNCA8RB!+|rV6UFV)l*/NO+5PNiLoSM!AtGfLeg|,]0C[TNcFz_y7*)1,J5QQ]BR8s0(|[=","SaveState_mkds/town_course/6":"ZNCA8w0n6Fc{1o{ESH=^)Ah-GE,bBP;]0l8Qx2+22GvBNDvOf~{|12r-Vw/e4o77~&FCL$=","SaveState_mkds/town_course/7":"ZNCA8N,DE08E9bDe?PO~dl^S:KAQ?59/:yy,[Fd3~_BbqU;}D7iW@$pnS2Q;BUV?@!mjTh=","SaveState_mkds/town_course/8":"ZNCA8_idrjPzY]UPlsxLz3?;t(}YtkG0Be4vrK;jY0$GXqMU_V4RD=z7WeNVW00G|g}[[$=","SaveState_mkds/town_course/9":"ZNCA8HRO+CU-lKcxu$?/x@,^/DgXlr07)Z5mPdgB,MEel-qG_3o(&+mZ7[|9J,=}r2Tz[V=","SaveState_mkds/wario_course/1":"ZNCA82L~lerDwl:WWl}z&B}UvmpNvKk{^&Mk-twm&l@LfYFH97r*ozd:kkngG8eKMND~zz=","SaveState_mkds/wario_course/2":"ZNCA8O-h(c;=0|~t/UrXWMP^x~POkbVQ/Y&IEi$1]JK+gpx2o-~adVJMY_Xe?Jv|&w558y=","SaveState_mkds/wario_course/3":"ZNCA8{)NP~BCAP5f/Af1gbW*qdeORvNaZ6(UloA,-6GruOW=S3@/QmZn3p1hJ(hnE@sn4Y=","SaveState_mkds/wario_course/4":"ZNCA8lvKU|S6XYEx8[D]Bv+yiy?l,{n~KAe)Lol-;t|*G+*HLgp~bkNd}PU$LN+XqnDM4:=","SaveState_mkds/wario_course/5":"ZNCA83-&I1!g$&?-k0N~)rv/c7jvkn69xsZfnRp)a/un~,$pbu~u!*xI~yt,2iXuKbIiT*=","SaveState_mkds/wario_course/6":"ZNCA8aA^E?$uk^0Lk$]myAE1wtpFE:78iuC373KIegchvPgGv^)en?Yh[9k7c*MGo8sRRf=","SaveState_mkds/wario_course/7":"ZNCA8GdaNv1(3H}T/GI({q*!kCs*p7dzTJ2BFA!G(Sw8KsZi[5NhpE=(SneB);!Hm+0iDy=","SaveState_mkds/wario_course/8":"ZNCA8AIHNB=(,4vDw]F)VkBgN1)lXd[G7h;07hWFdyR1DG{ND94nsjB)$ZyV&jbu{eFh9&=","SaveState_mkds/wario_course/9":"ZNCA81B++|OV9$(,!n)_58y@WITA+Q:w2y(2*1AMx?QSWI;4J|Zxv~5:F^kf:y;),6d9&s=","SaveState_mkds/kiosk_ridge_course/1":"ZNCA8)AIX=F:a=O[(!bV!N|-ft!r1MAAEde+lg{bN;}:$4RApz5^CT*$c@9Lp|VWUn5=f3=","SaveState_mkds/luigi_course/6":"ZNCA8,MEUDfqQ?!2w;/TW)N98X:~iuAAEt&ST/Z|tGq!|ir@Np1;sUyEWAkp~BJAce!5ld=","SaveState_mkds/kiosk_snow_course/1":"ZNCA8Y(El(RMCv^dN@4VF?N^/_?HhVAN4jE6k}i~dl54mDVJ;s0qRwwzuhYSr,9s4G(qAP=","SaveState_mkds/kiosk_desert_course/1":"ZNCA8qU{|j8o&tln)eqAqlsGpJaUN1AS~o^]y-w$UXBF7u4_54SBqPKK{ZUg7r=GgB0k/t=","SaveState_mkds/kiosk_donkey_course/8":"ZNCA8yAHGs,K[WE]c{cEC5B@&wn@TyAACdQ_c:Qn*Na^3IkMab9T)TVNRO?}OcCG0)|nzy=","SaveState_mkds/test1_course/1":"ZNCA8Y)r[SABOaRgsu53msMba*$3s+AN+|9OkjQi8LR1xy[IP[59LC-rRSIbs8H^|gY$kM=","SaveState_mkds/kiosk_donkey_course/2":"ZNCA8Z-AFZ8QBygSoAD~4L-T][Wl**AAAXBz^+oi&&tP4x|D;&OF3XOg_EbWy/,e3t]0GB=","SaveState_mkds/kiosk_donkey_course/5":"ZNCA8huW^a,y)S,:Wjz}lm1gOG5@_!AAEvix9nY+Dk-x|da,ot_U-^l{6f|WoFG,29z1H,=","SaveState_mkds/kiosk_mini_stage1/4":"ZNCA8JEXh@MX$M-*P[!b4Z[a4lt^16AAI4_4o8Sp-80+?n@_ZF,38lN7|79223P{,4l![x=","SaveState_mkds/kiosk_mini_stage1/6":"ZNCA83EG5&?sPkgXa/XMLOW3F{PAX+AAGIl5G({FobqJ-&pBd5BoS6,dZ6Z^2+QqAb||G]=","SaveState_mkds/StaffRoll/1":"ZNCA8EqoITA+6,FH2~6@pxpuhX{E04AAAaBNk+~3&zyREuE(]p)PtD4o_6(a:7:ENGY&jj=","SaveState_mkds/kiosk_garden_course/1":"ZNCA8sq$kbvo|q!f95qy5w&Y[g-wINAUvYw;S73ro|J*t$IJfFz^5AGRHKe{IgV3nOe/?o=","SaveState_mkds/kiosk_koopa_course/1":"ZNCA8YjV;JU1xBchRnYIYB?^GHu-DYAAG;4b~RL:l+L9PL8t{0p04yv6*hOVgUV8COG4K==","SaveState_mkds/kiosk_old_mario_sfc/1":"ZNCA8NoZ+cZUa@WfvqTjjoJqR6awxkAADiuHRf*0=HVW5x}6c:~ACu}6U{~u~DxO0vu-=E=","SaveState_mkds/donkey_course/4":"ZNCA8![n5pa4AunMF4a3qzVxMVpY:zAADeDX6AK^O90nQcF!6|X;R,xm/aHNIO+,JLp(BB=","SaveState_mkds/kiosk_town_course/1":"ZNCA8Qp]{dlo:n:?vQASfDv^uz;m{zAAAB@n;}VZtA(;uAtU(_*$i5U,|I(U2:y)EPExvu=","SaveState_mkds/kiosk_MR_stage1/1":"ZNCA8XY1xaIr]+Rarlpb?y0uEp$L[1AAB,AkVI,4rjpI|(l6Gue6Thfq_8~,zpyI9n9ata=","SaveState_mkds/donkey_course/2":"ZNCA8r;:?bdUt;VP/;6oYDGVOq]Oo-AAE|wi-BA;krsz*YY1UE,Gi-6Bou$L]a=gNKC+aR=","SaveState_mkds/luigi_course/1":"ZNCA8)9ElEeOD4[$9hlXHO^@sh-:A@AAI;/3_)0w-:?26q[rqPzI?b(I55XdediScMF}(x=","SaveState_mkds/kiosk_MR_stage1/3":"ZNCA8[Q6_0?JB1BfhF[8Ma4WbpuX,$AABL,l-plA2MIEwA!d6eEcy^JPEsxaX7W47(q@5O=","SaveState_mkds/kiosk_donkey_course/6":"ZNCA8ec/kX)6[}skARN9e9:N]LQvj,AAA82iDP+JUg_cF]bZD9=!unN&$5tD2&+]V&gta_=","SaveState_mkds/kiosk_donkey_course/3":"ZNCA8cc96s!o;M82wmi4$,!icN+pXeAAGuHz@FrWV4Fq}VG2k4/+*&S2?9B:asoE&E9/(L=","SaveState_mkds/kiosk_old_choco_sfc/1":"ZNCA8&e2-B?Cj]/;t0I{,_xqQiZ6GzAAEb],!4sa?+MkiZKApd7NFuE~;T;?+8sMN/s6P==","SaveState_mkds/kiosk_beach_course/1":"ZNCA8lI~^J]47S{D7}RjPftjJ]k!]HAN-6X]WW6-*0aTvpr}Cwc@^vS[j[3,wW3X)4CCLb=","SaveState_mkds/kiosk_mini_stage1/3":"ZNCA8mzlf/HJuxQkw4-wiH-VJK8yyTAN450aAJV!)~nx[&t_m?)-O+sPOFP)3Z5d_ZK4gh=","SaveState_mkds/kiosk_old_mario_sfc/3":"ZNCA8ZgYYPeg2lSN@7~z$b6;0e&X+IAAEh@-!XZjcy6IH$cmcM-^fy5-82EZpm@FUQbh3a=","SaveState_mkds/kiosk_mini_stage1/5":"ZNCA8EVsM(E;|u/n]vaXWPxe,:qC5vAUura*r2hjb/pUBXKe}1/tN@2b~14(y0UE=lz7&:=","SaveState_mkds/Award/1":"ZNCA8Cu=M(dq[V(MH^|0MaFY$-[+=kAAA22QdxZgpwBq@a7l$zqq}5kHoQ$SMd;[NrmvL9=","SaveState_mkds/luigi_course/8":"ZNCA8!/!d$cPt[Ta)+;9)/!*PR~u1$AACvUWnzH-Pt$ssnT_J_]JcJ4+*rRWH&=DZpQ0:@=","SaveState_mkds/luigi_course/3":"ZNCA8*4sEB@k81$2eJ@PLm]D1B0&9KAAD[Q?t1?fg|D1D0Ce|7YU2|NS)ApMm5Nsz9ai^R=","SaveState_mkds/kiosk_MR_stage1/6":"ZNCA8(}*7M}Xxy=q3;pBIdRr[_!=p=AN7Nmpc*h1l*7O)9InnNm/u^DNsnKDp|x1NtXjB8=","SaveState_mkds/kiosk_mansion_course/1":"ZNCA8e,Aop8,||eKWwypDtT3F;&Lc6AWZya;m-*9CK20&_o^&FLU^X],/j^c8MU7bZQ@M3=","SaveState_mkds/kiosk_old_donut_sfc/1":"ZNCA8jI^nF]~V({]j5gNIsayX2gJUqAAAB$sc,M5yvsKLH*XJ_W@yod[vH7$qP&Gu-rm;s=","SaveState_mkds/luigi_course/5":"ZNCA81AO)!:GN}=!|Rz}/P{Qb*ciC$AAAAi8bMkk~[/puE9+Y,&++1zl+Jz|OW-F@&!1|9=","SaveState_mkds/donkey_course/5":"ZNCA8c+NQ{*4^F6O&A|z(Rt:!4[sf&AAB:s=@nx6GxCuDNf8h;$7pTfE}lA|7gAKCop:)C=","SaveState_mkds/donkey_course/1":"ZNCA8Gd]kU3~VvPYUhFe-!ERG!kCgEAAI+~YVCmm]ZxP7R}=Z/uH=0q?+q/oAe5vtDXSF9=","SaveState_mkds/kiosk_mario_course/1":"ZNCA8;:6QEQdU-hsE||T&ElARS7?3hAAASqpWA:]M)k9JcPg_*]he!k_^Op$I,z?uxKN5*=","SaveState_mkds/luigi_course/7":"ZNCA8p:2_(Au]j]OnM/LihV0=m|lNXAAE1lR:/*{iSkzfjm4}yB7H?&Z8?H?dx+)$KQw1,=","SaveState_mkds/kiosk_cross_course/1":"ZNCA8;5PGrfq{a,MetDoX&=K2e=civ{N:z&TA(Xb-qFnMc0~Wa5RXzLg9nHid9s~D2[pSr=","SaveState_mkds/donkey_course/7":"ZNCA8BESO8Y=YnJ/Mv2^;rNPId;&c)AAAAin9_iMP0U6G!MqqE6b=zt&{:E/*S+0zGxnJX=","SaveState_mkds/luigi_course/9":"ZNCA8W7/v:)WcAG2WO/u!9p/MOcFDQAAHT;zb1k88!KYiubyuR!bVOS4iTWDLUI9XAWTyT=","SaveState_mkds/kiosk_MR_stage1/2":"ZNCA8;ANoa0:xNGv;*)_(F?9elFs;tAAE@tV/MUa?yu_LJ[zqY+5LLC!Td&:2=8UPTKi|8=","SaveState_mkds/luigi_course/4":"ZNCA8_FgQ?&_o6reFMaOcF?:xwiS,tAABlhti$;o7c+4hh{IgQWh)QSkrv,qIKgOv*ai|,=","SaveState_mkds/kiosk_mini_dokan_gc/1":"ZNCA8m*j^~-qBX-i/_g^-$Abs=1v*dAAE5*]I85Vj06u2zzC9XoXBSZZf0?alf|u1OzgIW=","SaveState_mkds/kiosk_bank_course/1":"ZNCA8)8q_s,ql^XEz;?MovwEQt8t0|AACY3l7:MkcH$-7g{*BD7j+*vk={{XQvmROid2NS=","SaveState_mkds/kiosk_mini_block_64/1":"ZNCA8LD5V+VV2h&K7u/3p]ung2|$w8AN4pFUv())1TG~_NS(n&)oYOa}IAhsGn3acoGG;k=","SaveState_mkds/kiosk_old_mario_sfc/2":"ZNCA8IFEA7zx6G3dV32Sx9^5;,Aoe:AAC*h*R/B?Kv:m[5(xpeDo[c*LjaHeh/[DZPd3P}=","SaveState_mkds/test1_course/2":"ZNCA8oyU1]vEV9eG1A-?7J3d=/qd0~AAF-/A4W:,v@5f,w9zt{U2)6UpsDbHV)*7w3X}+c=","SaveState_mkds/kiosk_MR_stage1/5":"ZNCA8q2s:4N;^@GN=RjHfBRekVPe=,AAG;40a)mEHfsg]KL)c]pC;HVQg(_Z6i7N1Ja7|?=","SaveState_mkds/donkey_course/6":"ZNCA8hl|LUq?!9GM0XGw-ZUO=YCgJ1ADlvFfF&=fvjozAHzukFVr?Gdbq4UUh_CJ}wQ;~3=","SaveState_mkds/kiosk_mini_stage1/7":"ZNCA8]h(p@5hV=vQ|abW1/Ix=/W|u-AAI)fF5~dHkcs=3@hIn}Jwbr$s*_RiT~YKP+o+^r=","SaveState_mkds/kiosk_old_baby_gc/1":"ZNCA8p:FOnJ]PtpNFP1tKzgJA{nRj=AFM-W8jxNiU?WOh}Vh4xR^(+~BFq{rCns!PTl:Ql=","SaveState_mkds/kiosk_donkey_course/9":"ZNCA8=Nve/OEvTV~8Nc&&4elyo@V3rAAFKzNEr5NrYU@/aCxl-MXrE_rvdVR@Gj1gFq!5&=","SaveState_mkds/luigi_course/2":"ZNCA8-_/9FNi[LZM(N7+B;es*Mj5L6AAI@]I*(:K4bSSK/2b|)9)c(&EG&+v[rSmI-YRnR=","SaveState_mkds/kiosk_donkey_course/1":"ZNCA87PgTu_Q((6/JkWwCDIUq9t,A9AN=9}$C526L[F@$7Od!o-/RrhmZR3/OjS!_p~4i@=","SaveState_mkds/kiosk_stadium_course/1":"ZNCA8em-8xh@1nsn=Tk;AXuva7^_XYAAAB(l2@{&nihuuA+/b{x;S;|rfPhEKagqxcw70S=","SaveState_mkds/kiosk_old_choco_64/1":"ZNCA8?+4rOhs4RSZ~({{h!yp-H:b?*AADkEX)^EtX$}*prl476@TcIabgpduS~Pbbu31V;=","SaveState_mkds/kiosk_mini_stage1/1":"ZNCA8jfS}pM3yNVz;[l2OEfeA[=jcTAAEt(-bCE6J/dFZNBxZlt9eNq/|Whmbt6Hu3d_-s=","SaveState_mkds/kiosk_mini_stage1/2":"ZNCA83Z{Pbymx~t-qG}Jc3d/,3]99{AAAYqb5!emmiV45yR}mWHfld^hV/-mQkZgqk!}w-=","SaveState_mkds/donkey_course/3":"ZNCA8{=YN$4b^v4&J{E(B[v6t)mWx&AACY2tvrDNd0?yj&lM,y)g(zzTz!8:(J;@~5bNNo=","SaveState_mkds/kiosk_donkey_course/4":"ZNCA8:XD^ehvF6L!QCDi?+GTdi-Ye2AAH3*?vLk+;ic(ei^ps,=;O5x3~F1ed?iia4ZN2V=","SaveState_mkds/kiosk_donkey_course/7":"ZNCA8Zs$iQhFg^[=y:tJY;Y$fW&R,SAAF6,tf8GV~3W_jQXN8Z0OnJp3Z{[g$~7=:J!zJ~=","SaveState_nsmbds/1/1":"ZNCA83z46)pnHJ=kuU:O6wE:OM4457~r5PCNn@FEi;l9@aZkhrosNX)]EYY_6MH95X/ogH=","SaveState_nsmbds/1/2":"ZNCA81mc(}~=Df_uuDn5m$ic7CiUL$~r5PCKa&kqY4iq!Nv8WZpBKgb4o]*uI8R/k9a3sq=","SaveState_nsmbds/1/3":"ZNCA8H=9/@~=Df_uuDn5m$ic72l9,u~r5PCKa&kqY4iq!Nv8WZpBKgb4o]*uI8R/k00cwA=","SaveState_nsmbds/1/4":"ZNCA8&rc,WDZEeta56o&e}-y9ar@r6S(S0:zeIWg!4ZkGzs*-08*!tPdi8Fy3=D=)PSuC|=","SaveState_nsmbds/2/1":"ZNCA8fw!CM7LZ+eBd-)2ARZci,lM{)[By?[nD}w)*7,|OoK5E^mQo$Cw!Aepj/nZ,_kV0O=","SaveState_nsmbds/2/2":"ZNCA8XB1OB7LZ+eBd-)2ARZci;:mCZ[By?[nD}w)*7,|OoK5E^mQo$Cw!Aepj/nZ,r=0pF=","SaveState_nsmbds/2/3":"ZNCA8ZCft&7LZ+eBd-)2ARZciyq-E8[By?[nD}w)*7,|OoK5E^mQo$Cw!Aepj/nZ,A*iQ}=","SaveState_nsmbds/2/4":"ZNCA8wRbcMD@eI^D$~rrSQ9m@&=ySYq8k5qUaV&bsQSkMBRh05Z-$Lj4i2f7S*v3Df[4*m=","SaveState_nsmbds/3/1":"ZNCA8@2RTI@!C^*03S3XO/Pp!@L*7DIPO+R+TdNEK+Gl)PqM6UT*6{6W04U[]M}0kd]K/q=","SaveState_nsmbds/3/2":"ZNCA8nT2_f@!C^*03S3XO/Pp!j2msBIPO+R+TdNEK+Gl)PqM6UT*6{6W04U[]M}0kW!S|O=","SaveState_nsmbds/3/3":"ZNCA8yGBs|@!C^*03S3XO/Pp!S0^C*IPO+R+TdNEK+Gl)PqM6UT*6{6W04U[]M}0k0D_8k=","SaveState_nsmbds/3/4":"ZNCA8u{xi@s!YPR?(R=9,MMcJtbqlG!wfeJm?wN9~3sdyxxwQG&K6*/I@Lw{o7N^volg}C=","SaveState_nsmbds/4/1":"ZNCA8*hYVaXkvi:)@IHAqW?o9=F_!z7{?2r64FP1,JwW]QqsT2nbhX@oEhMNu+;1(XRl0f=","SaveState_nsmbds/4/2":"ZNCA8hA5LfXkvi:)@IHAqW?o9eF]pH7{?2r64FP1,JwW]QqsT2nbhX@oEhMNu+;1(K5uQH=","SaveState_nsmbds/4/3":"ZNCA8=g+b^b^3/|z[$of3;U}W_/woNUsWw!n}ZFk-b)fdkcp]WGXWd?pC)g^G$12Cup[u0=","SaveState_nsmbds/5/1":"ZNCA8UsG$mesO;T,r?8QW9Eez:M+Z5~gj(rQs/j+fo]T3qr5vf62Ww(BxL5*&xd[[Y*nd$=","SaveState_nsmbds/5/2":"ZNCA8x6;0&esO;T,r?8QW9Eezlzt$3~gj(rQs/j+fo]T3qr5vf62Ww(BxL5*&xd[[v23H1=","SaveState_nsmbds/5/3":"ZNCA8hyr@IesO;T,r?8QW9EezEEBr$~gj(rQs/j+fo]T3qr5vf62Ww(BxL5*&xd[[KWcgg=","SaveState_nsmbds/5/4":"ZNCA8nwNtL=XBY0;TVU}ny@MHJ|6_1B|2mGTE2fXiwF~?/FrRF-PwZf-DhKMvsW8yTag8E=","SaveState_nsmbds/6/1":"ZNCA8Z{&p-RYHLQ0Y/Tr6[MP^)|+07b3H5f6Zb,TNy7*;;!RzYL!YIz/jzE,$@XVZGZAI{=","SaveState_nsmbds/6/2":"ZNCA8_-KO3RYHLQ0Y/Tr6[MP^7]/lFb3H5f6Zb,TNy7*;;!RzYL!YIz/jzE,$@XVZ;Ga{D=","SaveState_nsmbds/6/3":"ZNCA88@tq|CZ-xzk2NbA*x[)(0(kPbbpkr/yf[m^02aQy;!RzY=@(uJUGmR_mp6ekwL:zL=","SaveState_nsmbds/6/4":"ZNCA8Rj0i,CcIDq=P5kn8]Z(3Bn?z6!88{Ino5o?7U*^7tNXSF4mkEBM(7(zpFA}Lv*-rv=","SaveState_nsmbds/7/1":"ZNCA8ms7{+nR[f4ibT):fZcI:0hpSn{-!b?O7!G_)avhh5JQhA@WtdNsX:[01XD+OeTOXu=","SaveState_nsmbds/7/2":"ZNCA8-p_;GnR[f4ibT):fZcI:s1)Jz{-!b?O7!G_)avhh5JQhA@WtdNsX:[01XD+OP,?!V=","SaveState_nsmbds/7/3":"ZNCA8S!Er8nR[f4ibT):fZcI:L|lo&{-!b?O7!G_)avhh5JQhA@WtdNsX:[01XD+OOeZb[=","SaveState_nsmbds/7/4":"ZNCA8KX{DLA-X7]n!EtDd-@I)mZ0RgA@cWlFsNYxAXEGR2bsGlyHyGSzIoMvz0yFNo{D2H=","SaveState_nsmbds/8/1":"ZNCA8S_p}*,[Oj4T)=-u-Y8EThTCX/2{xKi57I]y_:VN[4oaaXXcxwP=]ToX1Qtaj)]CT)=","SaveState_nsmbds/8/2":"ZNCA8o?SO=]Xln!ABScAVTbN!*yZ5ry*H$:57I]y_:VN[4oaaXJB[eY*w7&@:3,A)~5w5t=","SaveState_nsmbds/8/3":"ZNCA8YSIz{]Xln!ABScAVTbN!O[Sm(y*H$:57I]y_:VN[4oaaXJB[eY*w7&@:3,A)EO[6-=","SaveState_nsmbds/8/4":"ZNCA8?TLDq]Xln!ABScAVTbN!PAf8Ty*H$:57I]y_:VN[4oaaXJB[eY*w7&@:3,A)fxk-0=","SaveState_nsmbds/8/5":"ZNCA8LtYXLfY4quH+KvsDt?b9yNVx4+Y6UO1VuF,8!KYi5FYs?3;6$e@c21JLk{)M/x~ev=","SaveState_sm64ds/0/1":"ZNCA8+L*-tWfC3h?Q]H::!7xVRbm[op@V4SQ?)F0zgY!dbx1Bcozy1l!Qj_z/C=}+sWT1o=","SaveState_sm64ds/0/2":"ZNCA8T^TYwR]dC@vUUJ@Rc=B2;}tdwNV5edVhKzE0!ee47pY^]55(b8IW:Nc:tN4~6$H*x=","SaveState_sm64ds/0/3":"ZNCA8?u@^=Vf3oA6eK~61W3ozRyB];qYw9ABG~H*v4aMiswFP{0$Y_A:dN~~?ES~JH*?|A=","SaveState_sm64ds/0/4":"ZNCA8yZs?0hj$Dce;p+^K0SPz+t)~+etZ!^pip]Oyz;lI736*UtfGK/p0HgSc)F;P*iuD==","SaveState_sm64ds/0/5":"ZNCA8poAm!sb5etR!nxZL3Bl3ooVp!v}DnsBqDwR&P(5|;WYH3vPngOy8(yn,K|y/D1Km[=","SaveState_sm64ds/0/6":"ZNCA8-&e(tLqJJ;t(jZ*Vv/@P(/,@~1@^EEv!nT|A4rFnpcJ[V0IK{;dk+=h;gl;@Z_k-M=","SaveState_sm64ds/0/7":"ZNCA89$,5i9XA0Dwkx?+Y$$&(Ov30R(+fzI2cI()C+I|g]^8sPt--;OJ|m|pcETQk3z~h2=","SaveState_sm64ds/0/8":"ZNCA8=m:Q}(=Gk05+|ThDn,HHNsx{6YVXSQijw?SNlst;tq,r&P{[0SI*FE2XOjMaVph8E=","SaveState_sm64ds/0/9":"ZNCA8&]|YF6vJkscs1$dCA!+Up7Yru3XcaDNe&xS:q6{6LXVLLie~|Lr!G_oc?~P)5M/FB=","SaveState_sm64ds/1/1":"ZNCA809v:lYV4;qJzpz9w*x?C7!8![~/N$N$d^kygvyzK*)EI~,lTbpEJ|RFU)9vYio89f=","SaveState_sm64ds/1/2":"ZNCA8rhRS+Qhs*/Htf79(=D+8w}P6T(5a*lr|M^dC8QUbv?Rt*6R?H~T}Qntk&m+GiK0p{=","SaveState_sm64ds/1/3":"ZNCA88gES)CD}A^AR$Q;$u0eT)qV|GtvY(^[CD(M-^(p+D2DT5E52vVpD!cei9{LUn$Q3f=","SaveState_sm64ds/1/4":"ZNCA84[~}}c)X@P;62DCf@BqiZ=X))ih;nM[;j4g6E=NYy@w9=QHr1Hsc^FJ4W@yVO3?U5=","SaveState_sm64ds/1/5":"ZNCA8IEi]+U;FR18|fx=;XxkTqAY?*A2~Fu;zd)^HtCY^QVZV6EaXFh&az0*(5&4)mO}:J=","SaveState_sm64ds/1/6":"ZNCA8VakFFw];uPk7~9d39VGU:;oVd:IC8ZX04*sZ/!zFrLBtuST}ospl,C?zX7Q9TL-4b=","SaveState_sm64ds/1/7":"ZNCA8r-:$n~IiN=v24po[s-ux?guiD3,Re}3!3]&ChScBO*TiCiyX13/sz5^tYCZr8(OKj=","SaveState_sm64ds/1/8":"ZNCA8lY$o[[PXEhw(2/Tgm]Gxzby6gl(*|J+e4Vqo|Ah@uibC)fEK|}B[m)0TiRs9l19/!=","SaveState_sm64ds/1/9":"ZNCA8hN7:NWUOuhii=1izMQWBCj,Ch5;,JnaOPqGR:wLfIn1Lvv99z,YRKh6bBIv;@Hi,l=","SaveState_sm64ds/10/1":"ZNCA8bVl{LkGC@]z&@OS1)WDS*1Vpa?0BA=!tsv^g(jvCVl*jQ&hAxwHn-E4CDkx&_&,7,=","SaveState_sm64ds/10/2":"ZNCA82I=3_46OjY*X:P7oXbh^0sZPKSS-TIfpLKW+~i{GOag)q=kL0l4k+F5GSndf71f3==","SaveState_sm64ds/10/3":"ZNCA8+aB~3=me:V)S!t{uWTHFAs37z;JXY:@|TtSL*iDDKh|uNsD^/ag_A!KQu(peRXIj{=","SaveState_sm64ds/10/4":"ZNCA8$itS;AAmJ$bq~HAC,()qow]g$aqLueKL4vT&3u-X/Nb-Rdwe9|b@)VApDi,j;VZ+p=","SaveState_sm64ds/10/5":"ZNCA8Vub5+]0@kz+&:CC3RhMm+U6!T+Pg46w&}Nz:p]|m5O}Gk6|F;d~Imn2gg+UMRh6DO=","SaveState_sm64ds/10/6":"ZNCA8PoV8@yApT9474fi,^|X6A^efILl1wawNZfqi?}_pg$olY3,XPD~=Rs*7y5ryB2[f;=","SaveState_sm64ds/10/7":"ZNCA8r@v@EMsgl(8uP49G00X+5^uxVTAyikX/6sEVZ1vtOqI9rQ:Bg)dM_c*aE]Cm{jcPn=","SaveState_sm64ds/10/8":"ZNCA8-d}g)PSSq,3HYWUEv&77x$b{gL9KcZddq2RMY-C*!XV2Ey!MVY7y}F+dMkSYnaK5W=","SaveState_sm64ds/10/9":"ZNCA8*6bJ?6Ko(VUf)7JxcLbINSTQUC00W!jQ,B1Bijb}QHw{mA@8y?cf08v5^Wn5hf2sg=","SaveState_sm64ds/11/1":"ZNCA8-1|cyHpbZiD|sK0m3L{2wU0cyEi6Z9V[Re|59uYk:Dv&k+J?}D2kwNQC4JkPVp+-+=","SaveState_sm64ds/11/2":"ZNCA8S&clK5HIednGT~V4d:&yUEmuC)29Ht{D,po6+~/jwl^zxlxR{fe07G7xP}RUlLh+S=","SaveState_sm64ds/11/3":"ZNCA8]6(7qOtwyea3Tf|7JBs@xoL:qL-K*N7]0]OLGxJvOz^4Uk-Pt|=(gxUydy!!4dlF(=","SaveState_sm64ds/11/4":"ZNCA8Ss5/t]X+vST^AuRynP*rQk&sgwDHJvFNt*s=,@2tiY|,lZ46V7BB_&W=McoQ_iSZL=","SaveState_sm64ds/11/5":"ZNCA8E[UlhXS=w2m0Ad0[hrFuo3++(8!g&W&t0Idv=!mc83eGxRhM-FOnM|6;DTpb@dE/f=","SaveState_sm64ds/11/6":"ZNCA8TKfnLOhJJG1xpT@s1GZdZGstyjk$z&O^2|4Hy^6nWgyRo0]-(OcLRffY!mUe&kVW4=","SaveState_sm64ds/11/7":"ZNCA8wLA1}D[CSYas&KOeQ[t1ywVkjQ-yFXxnX=5@7]J3ldtlIGlhZv6*yrr:mYKU_AS0O=","SaveState_sm64ds/11/8":"ZNCA8q7:CMsN5@HuOyQI6|$]l*ry:/?/[spVJmX$Q3tIWXMzTZ:m;kmwj^lqA=&}Mru)@$=","SaveState_sm64ds/11/9":"ZNCA8T2}{CSIh-!4?G!P()yhX7qh/C?:?yr]6{JOJf[P*l6R[(0c|EQTKlB/U&?14(yZbF=","SaveState_sm64ds/12/1":"ZNCA8iwy{{]Q8*K4-C9Sa*Q{=wgNAN4Iw3fH8y4inG-YBrcdyLlokl^BjkqwP6_FM0w!Y3=","SaveState_sm64ds/12/2":"ZNCA8;KJ~aY@w,LPNRZ-ZF!T|,PD(vv$rai[PXEhdltm&]uc2MR&ZbtTtbxqz3^|(sTec/=","SaveState_sm64ds/12/3":"ZNCA8-uQj~RmNWd-d$q?peyQtC-n6yZ/o[!~u7767,rvry=8bMeKG+|@dO;J(kf,snm}p_=","SaveState_sm64ds/12/4":"ZNCA8/Ns!oRTDvhr/@{^DLN@G&Q6as:5dYsKWTvh9$R[C-oxthmqsfAg~:M^ECoS=D@z;==","SaveState_sm64ds/12/5":"ZNCA8gM=5a~w0nTBQ]x3Us|4bkp&Rhm:|I_Sf;U}1s@-kRyEBAha^UEMz)qyMjknVV5k92=","SaveState_sm64ds/12/6":"ZNCA8;py![9r;;LALv0|B&c)(VfnHJl4~/osN?hG-b^$Ot3N)do*Q(RSxhwl/8y*b*UsH*=","SaveState_sm64ds/12/7":"ZNCA8A&&R3WN^J)xGD5zIm,fJ417ZH++h[sn~htd83xv{P,-GOtJ*2M7DLpa0Bl[5,|=Rg=","SaveState_sm64ds/12/8":"ZNCA8V&X/fg/b@73{YiW2Q7R{C:I(s!|$MYV[Re|xe)bH;~WnHDj?/4;vQDlah1ukaVRr[=","SaveState_sm64ds/12/9":"ZNCA8AN4anlY+gDEk_z+]]6J@XW3?vLGsUXTnKLgxLCjdrQ7N/xrt8eHETC(vg~mkw=q3l=","SaveState_sm64ds/13/1":"ZNCA8qDKk!Hw)QR:ZAIebYDM1a_(S?iE[^QW(Kr}JGv{b**nM6awa^nW]$hRC)9[9bB9~w=","SaveState_sm64ds/13/2":"ZNCA84BzM(?*i/[xw8~n6QA_-7oYo|&L}:~7vEYV(@DyJ*OfMcPfi1C)^bg4:rg[V~r4Y*=","SaveState_sm64ds/13/3":"ZNCA8:N:(dkf,)6djA0GMt7jIA-J3_p0ZkwJDh4(Z9N~u6R1N*x=hyY,,6tm!+qYrJ-9ye=","SaveState_sm64ds/13/4":"ZNCA8+y!]yynb5iqekNYs8GHdNhs6t+i?kX@sZUkVAYoZtbrbfH@~9?LBWgw]/OlRmuK4X=","SaveState_sm64ds/13/5":"ZNCA8t?n?wqfFKQurPmr$aES:S@gM0FVODvF1dq}H2*PdhNaPm;JRen$OCM@_gCn/mswZ/=","SaveState_sm64ds/13/6":"ZNCA8=dX|0c1{rCn$_rrC$=bDpy[Q]F&rj,rf(Wlrc36WP4kbT5,|/D=&VCPj)F}S(mAPu=","SaveState_sm64ds/13/7":"ZNCA8Wq]X(Yv6+k0BqJD9pCArk@x8KBFgpjwRL&(/Pydwr,zH_Wy]l1GJit+,3/Q$_i-!y=","SaveState_sm64ds/13/8":"ZNCA8;y^P&GXW0kDol7&-,p|1L(23rCxLqPN;E)vJ8Zca3=i1+BN+({UEyVZC96=Pdpj8N=","SaveState_sm64ds/13/9":"ZNCA8YN08p/95CFQzfea,bj0P0Iwt[P:+JC1X:BP6GzA7xHp}OI*:UYCpDsg5+73Kjur[C=","SaveState_sm64ds/14/1":"ZNCA8o^K&TNdhJTzTGx]wp-}gDlpD{Jh4d^PM@/Ma~wz;pXg/_=ef2V&@0F,7~j&3245-n=","SaveState_sm64ds/14/2":"ZNCA8*{y1,j^vUtjz?Hu2Y2An[cMp~o:gia!E3in3N@S68ChW/3go;Y~*lA8c_1F-,50xG=","SaveState_sm64ds/14/3":"ZNCA8lwueRWxqxN1BK}3;qeLEsMfp5{D2$pnjC-vzK_sj,2UP1J-0LLN3=-OA{dXqjF2xn=","SaveState_sm64ds/14/4":"ZNCA8yc9z[Lyl(3X~E,ne2K]L~0+JhHz(;z-)[?_P9U,H*u[EC997a|j=ckH_aJ[|:~P_m=","SaveState_sm64ds/14/5":"ZNCA8rD~-rLBnqWV@z1,:}y)kEd{f|,XyYs-0t+-Ok}eDS$A605XPS5=3gwzx*epDx)3!b=","SaveState_sm64ds/14/6":"ZNCA8nMxWAB{gclXrhUK~1jFFhpjsZf+T{+&pn-ed?C~a7Fw57tky(/G~~WLaReU2;GhTL=","SaveState_sm64ds/14/7":"ZNCA8eVG*1mG!OS/Bt*^b,)WVA6lv7IR]1Uky,QP8J&:IHFh0v{p2w|1Y,8_yx-zhC6uqB=","SaveState_sm64ds/14/8":"ZNCA8PX0zd+?+NH0&]|xYCiRV?!foPqv^(Miknmc&R?WoZ]9s1iun$8ySeZH+9xKtx!54r=","SaveState_sm64ds/14/9":"ZNCA8*MT1Kv~Mh5s$,poNlp]jYh*+7iWK^0S$&3Jtuj7qO)_MA*Cd?NVs[Wj9[g/G2v9}c=","SaveState_sm64ds/15/1":"ZNCA8=t0Wwul?WTlf]5?(of+!E44yXPv1wTS[oV;G2Dg)kWt{XqcO,-as~Yz9}^)58TSk8=","SaveState_sm64ds/15/2":"ZNCA8S}w8}&5gwqo/+C)Ro*bvs)?HTdcQt4a~xZuKaPm$s){pP!rqk?;D5Y/cFm+ze[utw=","SaveState_sm64ds/15/3":"ZNCA8xxN{,NX@YFvnMO{6)@6~*e;ta@pF]5:3n0OYhVy}C9p}O94|w(j:t:-T$$cI-2{fz=","SaveState_sm64ds/15/4":"ZNCA8AO?:/KmTs*-S9G-Z/)|B_vIW78w}Z1S^thPBj/x!l@pAN4V?|3I6OWY*4By;H*i@6=","SaveState_sm64ds/15/5":"ZNCA84sG)~nFBrm6ec&RdC(:7:ZDE(:-NV=80lKQd8}1@o1j&w4KrFJo|qKS8D2nCR$H8s=","SaveState_sm64ds/15/6":"ZNCA89r7h2YOH[6=CbxMjm}[yyXVA5rAz!yGh0!R~7y9IgWJ?yuVkbDio0hs*L~TUnSrW,=","SaveState_sm64ds/15/7":"ZNCA8Q~dd:{TkB&61&ZiD0!uP(5?yp6hna54_bxSz9_PPQvkyUCUk18LWaSAh*so[d@Cgj=","SaveState_sm64ds/15/8":"ZNCA81{Ox~6+XSlc/4VjERtpcPVHO-Y}E1y)$L?+huN^Op:8x;o9uWSc!E]{r0AC1$8Zl}=","SaveState_sm64ds/15/9":"ZNCA8F:GEkkl~=}*iUeLFPqJOSe]9I3_vkS&8ip~lAeF|~8KOlFECUAVbT39P;OM*;hOi]=","SaveState_sm64ds/16/1":"ZNCA8N?Af?dlsDl~l,?C*nyG07Y/=-hLEfBhT5t1m[;ArD423QN,_4X*hMP58*i~3rY?:~=","SaveState_sm64ds/16/2":"ZNCA8pPnQP9W!{cC!avGAh{?W3Cjo}4[GC)lUjiR)9fXbJkIm*dDBFJ@-psV]m4ks+Y}g(=","SaveState_sm64ds/16/3":"ZNCA81v|_SpHNc6UO2d!z)eb06-cdMk0YuJrCxynur3}m$m5g4g5DP0PUOpeYB7B,Wb@?D=","SaveState_sm64ds/16/4":"ZNCA8Lz&cHbm3[=2LOGcR4OhTfWX:aGz,1IuET3=RfX,-573nJt4}eS)pgH2v0Fi1d?}q?=","SaveState_sm64ds/16/5":"ZNCA8Du7Tv9~=aIp*HUh?617SK[@D7fOu3!!UT|WthoCBEmTJaqVGL?embiE[A?Yw~*(|U=","SaveState_sm64ds/16/6":"ZNCA8/MM~zg2*14FgSYt&whe_Z~W&lPoK)&uvmBjcMyqyI{!YTe,e~(+,?[P7za{OAPE!Y=","SaveState_sm64ds/16/7":"ZNCA8K95w/2=rzUZH{6vh,g@iE$iYcxlEdKB?;_abY+H6lT2PYk&{^lK[p5eb=rLH~(/Rf=","SaveState_sm64ds/16/8":"ZNCA80b_O4=V}MBrj7{QaF)r;P(7JQSr{QY8BSg0u8-;PQ9B6-D*jM|T5mxaf5d@E*Z?VI=","SaveState_sm64ds/16/9":"ZNCA8XDA?JGh*sgM32Hu*)nwtORJLzu&dsITlZ-KUD!~HsgDi~DR^z$Ybl7|6lez?A0wQi=","SaveState_sm64ds/17/1":"ZNCA8s::{H[G0/XFx^XVqkZ9Ok+PpH0{DH;h8lUBclMBg{kP+BWQPEN@7CJGcKBBTH15yS=","SaveState_sm64ds/17/2":"ZNCA8;Jpdv93M/9;d(f2bh&O7qHendfwEckp|xz3@yEU_zMxeGB_}+I4e]{Z)SQfb@dj31=","SaveState_sm64ds/17/3":"ZNCA8IlCwfxdcM&):jG)9e5el]jHWIYeqozFyUVTQ!INn:W7/xy24e_s,x74SlcM^)?v]3=","SaveState_sm64ds/17/4":"ZNCA8v_qq}yXkEK_]E&-B2CT(6hW_ipKd^=*4_&N7;dPNv7L|kuanCF7:&XhyXR&I{,v{&=","SaveState_sm64ds/17/5":"ZNCA8Z~~CZ10VS)BlEC9opVlsQ6XI84]@fhWDI]9Z)On-YSUT-ubWT9!fTd|lXDn_t!}~O=","SaveState_sm64ds/17/6":"ZNCA8v!tTIre@J/EC3}noh!+_{s93w+cN-;e1-!]?fY5wYfIb7h^_b6(2F&k]jqqSi*K/6=","SaveState_sm64ds/17/7":"ZNCA83k,S:r0*^sy3N)fImH[Q0XEks(I7_kcLh:c]*Xc!u2Sit&0k6W@[{:lU^Zl&*[V[3=","SaveState_sm64ds/17/8":"ZNCA8Sd3LZEmke|$5w7kqAorG+mAn/WY7T},M0{Ilo-fVxi?i*YEeFc?89l7H*sW+JnD7u=","SaveState_sm64ds/17/9":"ZNCA8$Y?gXXZ^Nuy*[?A4$4Y68:0*clk445SSoY:hkT;@8HR^gi4A1!5zl_$EfH8&vn~+4=","SaveState_sm64ds/18/1":"ZNCA8d|xKr(2=$Qkpv]vMj3ChUScZ=GYA*;dJ-pApYT5FTZj($hFL}e2FNfX]ETv8wyF+Z=","SaveState_sm64ds/18/2":"ZNCA8l~om(YMq!]6X|ZQIka,vQ1a/cP2v3bekXtd8&@C^W]14V)]WGnU/qmj]7jfQ[b0C-=","SaveState_sm64ds/18/3":"ZNCA8J=@h)_L@Sq$4|0bjfGr8fg}zGs,;]@FJ;fGZ~j]MOND;)/JrO!nS]KJj4[7UzTSfe=","SaveState_sm64ds/18/4":"ZNCA8&?2fBRaatxEW@gBb)(thl{Aya7txXx/jmhHn)EUb2DUvZ!mI^JSY(URb7o/)e^)gM=","SaveState_sm64ds/18/5":"ZNCA8X&G&z@mb1!G[&S*21}T~~(O$BW&F_B4_@7]=4pw?ovUq0~pQ/~PEY;=Cih8eu$o,]=","SaveState_sm64ds/18/6":"ZNCA8m]$]/qeF13&}}Cq~_~TxgB0K{MesKDoE4}xeve9N8N(s~PV?|RNET3M0$Vym)=5Z|=","SaveState_sm64ds/18/7":"ZNCA8e{hS8$&n(}B^!f@QjdTE4/H4XxRe!A!UT|Ws=/;^[W[l(W~E1re+d_MQ1DwAnNY!E=","SaveState_sm64ds/18/8":"ZNCA8[}N?g0XZHcGLrNFF_4vJQT[kjANXbU2nY)7/VBY3WCB2OI&oo+}O5rfPt7tj4zgD3=","SaveState_sm64ds/18/9":"ZNCA8?R]!([mg&VLKubsU}885exk1NTdQpKr:wgtg4Br/3:)jB4v[},O&@/M;E^WCji*0D=","SaveState_sm64ds/19/1":"ZNCA8veZTlpzaX,Peb,rzC37$:fQ1X6$EuS=94gfSalYFgP?NhC$]ym6o9W4-VuQA;^6u&=","SaveState_sm64ds/19/2":"ZNCA8xhzHudj5Sg2aOCN_,affSbxy{Nu{Ye2H+7J)?eINXeR+5,u)(KsabgcoN/hD1:Stm=","SaveState_sm64ds/19/3":"ZNCA88rLK6/nyr^v2RKm[vYyC67n1;PN,Z!u(q+!CF6A{);a[Aog1dJvsWc*OsY97k67eW=","SaveState_sm64ds/19/4":"ZNCA8*zshC1o1?yD_YgG$3ehl&x/o&3XBSuJbiTm?feV&2AB|nW$OkbugY62Y^~EyH+]$L=","SaveState_sm64ds/19/5":"ZNCA8FTzL8,Wi1U!z5eE;XWW8z];CgA8JbvjU1@pW,:0+nyV$bgDN]2(a{z~NNg[xa(N^$=","SaveState_sm64ds/19/6":"ZNCA8RyIfs,NLvF1T(1L5~5mmiP*H+@/BEuzJ)DRuE1X$BfCfkjX)!:OQjL&4Lc&KB]T4r=","SaveState_sm64ds/19/7":"ZNCA8KWs=!-/nc2A~5@YBg]2+Y|t-QQuk(j7P^;]6u+CVs05DF?kekxV)G;r+b!gPKqiR,=","SaveState_sm64ds/19/8":"ZNCA8sDn0kUdCSmYV+xhO!j6VGVCD9_eWhh+Iw)OH$0=L[|gx_f95Yu~93;8)WUmw58/yg=","SaveState_sm64ds/19/9":"ZNCA8h}h{{F]&8kBz]3}0i7yUzp$txY=][dhC&9uppwn&dsP^,:6[LL/uUcCNKY4Q$Q0fL=","SaveState_sm64ds/2/1":"ZNCA8bo9GDZU}=~g]i)6=:?:ZV[B:fFJysq2TfHY{qI[r0/[627]):H?,Cc)LB$IjI9DZ$=","SaveState_sm64ds/2/2":"ZNCA8_ST)4cA&n!w_@9m1Q1zO8J]@h-_S$H/6qpw+~(jCd@o@65F{FD:U/]TH3tqGk6Gy+=","SaveState_sm64ds/2/3":"ZNCA8F+kQaUhHD*r+^R:du*UnM|h1vaA0Jnr_]nj?^cn0m[]qicNO2&*|rbNesx&!Is98A=","SaveState_sm64ds/2/4":"ZNCA8LT9}[UY]~JC0o12_y(GnsL(LlQFlXh[{}8$km(73H|5X_o[fJKP]&E{5:{sqji,:n=","SaveState_sm64ds/2/5":"ZNCA8A1R$zm{D*+ra&4zqxyk,5e-;_WtM7P}KL4-6I$-Pirgj0o~K66s[YG*y+@$OWFM/C=","SaveState_sm64ds/2/6":"ZNCA8vb4$X9X]$@~U)F;PUji?R=L}EGr}$+sS2kvN0mXEU,bNCG,W&I=[G5;vZO}:_]dyw=","SaveState_sm64ds/2/7":"ZNCA8]O8HrQ3ijTA)o^&ekC[}:JG;yt:Q2RWaxhZm]d(I,,6yDEde,JPX)izsKR_z(4tnG=","SaveState_sm64ds/2/8":"ZNCA8&]hkq(Q}5}&3pipjZ17C*irETDsv0p[${th3Q;+tRr&)^jv/m^(^:gBjIVkDVT58L=","SaveState_sm64ds/2/9":"ZNCA87Ke3!_xwq)F!Rc;$BNHOFeA,fKaVYSEz7GjR,v^HY[6,wNOv?,2_CCe;Aa/zg[s8~=","SaveState_sm64ds/20/1":"ZNCA88x=lhf;mTXe-I3xZqSte2jXcau5}EIu[{Uc]SF67!x_i[dGC&eTtOuN)*1gj3:BzP=","SaveState_sm64ds/20/2":"ZNCA8rwc?*9MKw$f~~~owrVE=oTD3Yj8@qHD{+TS;p|RlI-8zxjSnz;?&2&?hIBJ*mr7r/=","SaveState_sm64ds/20/3":"ZNCA8Wo{(dM&WD~A~0Xml:Ks&BBU&ij:)ENFXnau9:}?1rwNM4{x}N(:]pM5jEXIRaOE=G=","SaveState_sm64ds/20/4":"ZNCA8$yVRi6FNK&nNTeNn{(]vt$f3hUvT_LrKocO~b*4iz3~*p,UDik]~c26s0UP-/UEQn=","SaveState_sm64ds/20/5":"ZNCA8=SIuDLYia45645+Cau$*D1/](lYs1A_ltYQ6Q*c4BmR1Ds6(V]GaSNzz)OUXOvEJz=","SaveState_sm64ds/20/6":"ZNCA8fxSo0eB@E//z{!xsVYo,7j*;u68sFY3ockApYmmZ,IzZROj}a/+&,p[?U*ZH!=kDU=","SaveState_sm64ds/20/7":"ZNCA8T!g;EO,0a_L;~/R+x4SL$4ji!w4(?6=Ren)0FGWGcx&ie]?$2t*4d207B^*-I@xTC=","SaveState_sm64ds/21/1":"ZNCA8Bd^DN46yCJ}QwqaFOoj&3j(/7s,]7^L)Ds6o?H|9R/iSoIgeO:ejtSaR5tsX)t={R=","SaveState_sm64ds/21/2":"ZNCA8?RfK9IhiT]Rg]Z(x43P$NM$z{uRn00mUMps]~yz|[Z$rllZ9-wqJFCX/2H3J,*9Qt=","SaveState_sm64ds/21/3":"ZNCA8sz9[q~ti:QU(CA,ag8|6v_FMApjX47_^gigZXncv]TrB&Ba[Qk!I99lqyaerO~DSR=","SaveState_sm64ds/21/4":"ZNCA8k{r&~&[}H;5qpD|JH]+0(+3($egENfsv@j3Ar/QJ6!Hn6h^@Y4eEsKt]cM7W)R,mZ=","SaveState_sm64ds/21/5":"ZNCA8w^7G1u^wMBh,Jp0IFTEH2_ME,XEX,P]vdUqR3Zo5qo~&;dD=KSA:2S2}KlAOA&r3m=","SaveState_sm64ds/21/6":"ZNCA8;hk;hETegWFU@:IVeE2hsAX{|s9(fl9g[6oapgJvUJWmYVC+u!*^gqV;/d00YQq5W=","SaveState_sm64ds/21/7":"ZNCA8=eQBQRzgmJ()C_li?cvrBDzfn=n,:XT;NA:Txnx]L!1!HVjdfTNi+Tpk,|M@v@Ng==","SaveState_sm64ds/21/8":"ZNCA8xc9d?ns=SLyDFM]8/BOTi!S&-aga]RNiS_xck{Ex/,wK:YoI]X=,zk/Dk&S5=pg5z=","SaveState_sm64ds/21/9":"ZNCA8PoRzr-jA,u&(WKT4(|m4mnn~$y[3S+2KiJYbx6G(5vY=WX!EExHzQZ|Nf=VPd$LL,=","SaveState_sm64ds/22/1":"ZNCA8{nTg|97sjI@BoOZQlHm-Kl=&B4,=y=37k6|Jc~8*Y!N&[C!AijC^fn+1GzLK13wJJ=","SaveState_sm64ds/22/2":"ZNCA8h3cKAB9lU0rj$t=fejM:$MBKSRP{bOrZHOqB/OGk,=A&=x@DCHN&:{oBVQu?{NunK=","SaveState_sm64ds/22/3":"ZNCA8AZnWo+9UzFv+-(z1Dz}+-[:Zmdz?i^]e:{w)n@Z9ME1nFEQMTwsvIJK{{bCT&NHR!=","SaveState_sm64ds/22/4":"ZNCA8OSYT!Evrd;bDVmB@Dg=:]aEIu{}cr:Qmk2Pl-?Z&q:Y}i&h=a$wI0PX@pzb(5*ivg=","SaveState_sm64ds/22/5":"ZNCA88AE1{aY/zI&;na8DDE{c:7]l]*-pJDFDh*aO,+57]n}R@r[@}oM?/50?edEZ0F]I?=","SaveState_sm64ds/22/6":"ZNCA8iQk~L1:v_G$Bp4KpLuqHx,K(q3;89Yo;;o3bJ-F|aRBRv1C|]I5rShMJlT(jmy050=","SaveState_sm64ds/22/7":"ZNCA8csQQ}P(B)1Syo(zRNiF6d7@Yo&m9P2*ruL7u[=CW0)TC]T]$[zApYroq_t8W=yK^(=","SaveState_sm64ds/22/8":"ZNCA81GRlFN20vTGB;YO8q9$QN1}^RHm^-5c!K2$Nr,q&@[,RcW*D&94Qucpj:7y//fn[U=","SaveState_sm64ds/22/9":"ZNCA8@[&6R&8!V@j:r6u&41X5UKq9UyiT{G2M2joRSdBJUSE7$1x[D1rC8G)lXGW75Y@4T=","SaveState_sm64ds/23/1":"ZNCA8lQxbF=GlF7=fSeCucKlCVd+2s]B23DW~N6B(Y{H6t?j_O4*GT}LSVlAS9ANCejSzw=","SaveState_sm64ds/23/2":"ZNCA8uyu{Pw;1}U55i~V(GzNXv||Bgq19eM2oF7tw$XQ:(TuT0=mOm/Oh8z4&MF|6eM:Et=","SaveState_sm64ds/23/3":"ZNCA8~RW2EBAYM6;bW&:bay6e~lZ|veDMl4n-pR,O9c1,y*z6HA[;d}o[U[RfC!]G]/*Au=","SaveState_sm64ds/23/4":"ZNCA8?~u{vDn(pU5k6zoqNjTSmfjwQ/g),qHHmxy8$A6kqyRYx{40NBV*bnx:=;0vU}3Y)=","SaveState_sm64ds/23/5":"ZNCA8BN@zn4d$*yzP&NigasM~/^/2YOF+W/t{b=3UhK1K{[DX)dGsfN!Bwq^I7l&@]x:u+=","SaveState_sm64ds/23/6":"ZNCA8ENqet4~2pB(6?XrZE2@qXr&[D*T5Dav:!PLf2~$3fq5J~4{6gAmLLCprFx2KT?m0u=","SaveState_sm64ds/23/7":"ZNCA8fFqL5ay@o3O]JqI(YBcUNWu*caI$}of-(5~pz@n_ihdh&_NkM~VS76od3ZXR{FIuV=","SaveState_sm64ds/23/8":"ZNCA8=BE{FmD@k_joV}aqjP]6eQRU@XSK}ssda2,?n]:K@t&42~IZJUSLE2~RMrJ)vo!3]=","SaveState_sm64ds/23/9":"ZNCA8P+9=FbwopeFv2_rM;t64Xl|nur+&:ra~D@nnq^M11/|j5-9Yh51Npj(OHn@^M$|B(=","SaveState_sm64ds/24/1":"ZNCA8[eJyh2aG=WkO!vUM/rl[_Ms)yFG36sL@MZpK^w-e4TL3+rgiy3,IfRm-$JVpsW(8u=","SaveState_sm64ds/24/2":"ZNCA8V2;@R5,Br88tIFnFj(nS?ElG=pUesKufu--RfX_VRHyZZW[};LY46cXauO*BI[,9j=","SaveState_sm64ds/24/3":"ZNCA8_luO0KellJHeRrPt*Y5$VSD7^dR=fVECzuAx6;tViM:h?o&M*RWB(RX$=zqT$Y0~F=","SaveState_sm64ds/24/4":"ZNCA8t1N~(Wg[g_{u+m6O~eEuz{8^/+BNqOt}/dBsmC=?mn2NNgES}vyR)]bZ0JD}EYvQD=","SaveState_sm64ds/24/5":"ZNCA8AI;geSv7*Xj)*5pBRl@B,:]rVRZz-x,qz/iNpseIkjrI+I1K!E4h6x[BPm@j(g^i6=","SaveState_sm64ds/24/6":"ZNCA8mr*iblq7;RjF6YH@+YcLb{zq*zD?4_JN[2HUOnCa77qr6QO7i$URJz8TIf|+CGy(&=","SaveState_sm64ds/24/7":"ZNCA8)+FPtaP|}t7IEE|1VD),D71dkAuRfH53}?WtbI)g=Vgz3yVD5kifAYS@o8{!]!RMY=","SaveState_sm64ds/24/8":"ZNCA8bJK5j4f{lCIZ4+BwZw7hXMih84MioDw6b:br-OsJBbJSaWs0?kIYOU8+b5M1q?GB^=","SaveState_sm64ds/24/9":"ZNCA8lRbnCcLF|IWW!F()O?iRvVW5D_a6ai01~s_@j/=tEcKEILN~V~F*z7?v;Ev&uMw&b=","SaveState_sm64ds/25/1":"ZNCA8x3Pz4+BtTg2$$[1gF^M${kATh;?CbJVHJS;3e/lRv:2P9h_o)cQqW$pkPLtUvg+cM=","SaveState_sm64ds/25/2":"ZNCA8f,kCT1C/aHbH6RIMcQI){GAz?NuMQhtWkjhf1,9@n9igif4XFw_,V5X$_ESnwZAF?=","SaveState_sm64ds/25/3":"ZNCA8?)WAqgC@Fir4^ruGbYe@NX):m{l-{]oiKj;R0Rzhjk9@W??82hS^gU;&WD,Pt}?Hc=","SaveState_sm64ds/25/4":"ZNCA8ntg]&N}ukmq@U~^u_c^kerTEp)*-}HtU9VQ)rRN1Ar&IoxyvVk6~j/5F{X@czMqE4=","SaveState_sm64ds/25/5":"ZNCA8aKVTSdQ_ifNFw9uh?/8x+J!:fjut6h2O^h@POB7Z]h2|pGgCf8A!k&52;tBbBZ|Ki=","SaveState_sm64ds/25/6":"ZNCA8ct!r!N($@Nvq@1]PX_Mggvf*q!Qm/}Q{_CPc(P9TvgQH:WIuj;:SEHHqOBx-73gm*=","SaveState_sm64ds/25/7":"ZNCA8I4p?2&TnXZoLT=-~iq&l?*7VB=i1d7oJV?C4FxQs5Sh7-L1G*tl,EdKORq950v+nN=","SaveState_sm64ds/25/8":"ZNCA80JUZ-fa&4BOww2BYsVykgGLyK/;0yq=Z;3kN?8gJcBq&PLT$Gj$o!tF:7hR)ddZ1z=","SaveState_sm64ds/25/9":"ZNCA8d3uYcL9?NLa?Z[Q)x=|tOzzHyZxnEJQH;K+mIvYh}UU@Jd@/qod=K~7$Um&ojCjZg=","SaveState_sm64ds/26/1":"ZNCA8a1DT~OSNHv7YJ!|=mb5R:M*}!0/183yFE!_9VYY{JAH/=nj)6HGwA&YFr8tu[]J9l=","SaveState_sm64ds/26/2":"ZNCA8zMg70G9WmcSO(3s;~5?W?}1$7(QOd1AAEuVQ/99BIx{3U:[9t+z6DT:E:d~WZBi:+=","SaveState_sm64ds/26/3":"ZNCA8+r$XO~ZGl;9,tEfnf(M7D08~/[9qkjrs)M1omLO*f!p]Jt(vzGxHMJ4Tc:CZX[n~a=","SaveState_sm64ds/26/4":"ZNCA8AO,T|Q;/[9]:ziZOMDA@~x_n?I3mFep-oac6o*P{NUJ1qOym;9tofV52N$3xhf7=z=","SaveState_sm64ds/26/5":"ZNCA8S)Q{-c:9RiLOiPeY+*inxPJ$;dg3jl]VaE3!?p^hVwv|]*Dz$R9Wh;;A~yFTw90hS=","SaveState_sm64ds/27/1":"ZNCA8S8H+n-bwQAxJr,Jy+Y,D+*2lGuwD)OJ|bt7-JQ=uBA|o{csr,oIyYQ;FR&;^9HbK[=","SaveState_sm64ds/27/2":"ZNCA8=Ir4ojF]vPL[E0|l(}M26)PpUX@g1PR;!UzWlR2R2V2C&47e;mHw_/-Xw_{JI):Gw=","SaveState_sm64ds/27/3":"ZNCA8cG8~bYfRaHzeU_s)=A?6&jwBcOIH$*?NZT=-X|D5Iv=^(Kn*WcQ&5~@e@9m@f[(|==","SaveState_sm64ds/27/4":"ZNCA83Vcu*Q=)Rgr=7)}_OR$}X9Y9!]-ba^mD;^q$Ny6~MZ9=^P-:k-BWbq6&na4Fe$D,W=","SaveState_sm64ds/27/5":"ZNCA84pB}qbh;a-]HN$pRXs!Avylgfq_:GRG/m@:~5]3_ErP$f!+;v=5v!tuN2+otEGz?F=","SaveState_sm64ds/27/6":"ZNCA8p1yac9R6a]RkqP^Bj4FFDtF$v,giiS3El3E6y(x4[9|Z9gqH!?P^dXEg{oLTXc9TO=","SaveState_sm64ds/27/7":"ZNCA8mVa*5un+l=Thcp20b3wa_4:)|K--1vqasrN3XWbQdm]@4Q/R(y[qL_N;b04NO@TiN=","SaveState_sm64ds/27/8":"ZNCA8J(+YVeOpm$Ryd1lsjK*hhzW0RULi@L7I/91~+4&ba?M4&k_5cxmr@vUIGZwolNp!c=","SaveState_sm64ds/27/9":"ZNCA8PSAG:Y5sc@4_Dn7V!ahKht:oXy@he(_/?;cR[j/&)zdKp,W3(ZBQI/4D+kY]n6n6r=","SaveState_sm64ds/28/1":"ZNCA8Br+[Um3@&Dc$*M6tD6,GZM,XLkf_82EZ{/PP(L?kSP?gBcG!Q}6T9O}lVm7s=p|$L=","SaveState_sm64ds/28/2":"ZNCA8MfYa{Bzrjl!BF9YyQvHTAu}xpc}0lPt@f?mi/pZBRXH,-PI:zejdJM15:(0t&nQ0a=","SaveState_sm64ds/28/3":"ZNCA8xVLBw&,KIGTV&$;Zw?M29D3&BnnAYoL)W1Cn]QnvD*7kKDYKmXk3Aj*Fq!q:zd*uU=","SaveState_sm64ds/28/4":"ZNCA8V[Qo~rbsFQ2jbMB:qIt{sN(TkFK$c:(chbVsGubPCKzRgO)hx*m)sBzsvsx=uc@VY=","SaveState_sm64ds/28/5":"ZNCA87EeYl,-gXaKM}R);RF6dztQUl(V:a/8y9R=7BI=|-{RXb&H9Wi52wsL-EP9z8@nbh=","SaveState_sm64ds/28/6":"ZNCA84Jk5$Kl,fX3$qx7CuA@1G73-AC:3H3iK_AC?U6UULm?RIc-a+:N:Q58IAk&iyFEJv=","SaveState_sm64ds/28/7":"ZNCA8ldfwF!jET[a6]J|YXE:5:r^{KkHq/7M;-FW2F@iC)tt5LKPG?JFofoOHvv=BX9fQu=","SaveState_sm64ds/28/8":"ZNCA8K^-WOxpjc}4uQ0X!zy$$rIE7nm@RjDqFQ^g~lW)mg)HTk[JP_zxrPOQEK)E(-)=/d=","SaveState_sm64ds/28/9":"ZNCA8LP-])6bJYt,vZf9QhP+1KF)XBOzau+&+pZuiq5(:0s9kNoMcV/)9g}$QbZH$XjGvH=","SaveState_sm64ds/29/1":"ZNCA8wqIrpHV0HQ68~7jYk6uj,1mDelmE3[H]/2)WUwm2[e(rTbR{S^7HPeq@AQW3rY(iq=","SaveState_sm64ds/29/2":"ZNCA8w6JNWDJEus=-1YqAU=?hoSuva?DQ?xP,dcF;&6,dyu-a8Nd=d_2eb{5W&oKFg{6Ub=","SaveState_sm64ds/29/3":"ZNCA8@7KxCyvBclf4C]?Jr$1xJx$h(Mv=3Z+&rW3DDsf&,)v{kg2ot?r6/e~PM|7y(;Uuo=","SaveState_sm64ds/29/4":"ZNCA8JUeI3wQq)oPjU6:rVd1FX7EI0+X+P-;;aNsb+Jt8c(H84_EeNb,Ufh7Q:m!]z,s,y=","SaveState_sm64ds/29/5":"ZNCA8pn(/60Z-I+Lf2v)~x])xx)FH**hI-&[&78fRn,aOkZ8HLLChWj;1&c4qGv8;kvE(U=","SaveState_sm64ds/29/6":"ZNCA8j;Akv7]c@Q+({1Imv_{YK3ZU7dHuWehID-b8_RdrP_c~UuQ8Of/3*K@7f9Pw&d!VC=","SaveState_sm64ds/29/7":"ZNCA8(AkEE:]|rVvyc1hXNxQW$b!DHzeTR]Oz]nmxt-Bgw7Fs5&b$x}EZC7$]/[cj5;^gV=","SaveState_sm64ds/29/8":"ZNCA8Afsvw&_fU@?0&+/5fyBrx?M06Q+BBu0pMOE_gAaKmu=R9O=?}0WA@GPv|5b_J8BxD=","SaveState_sm64ds/29/9":"ZNCA8jn)9kNAKJK;uzCfuuez+8=LqS*yg$8EmB=p@*JAE]9b9QwgYK~S(lg5P)~rYlZP!(=","SaveState_sm64ds/3/1":"ZNCA8?9Ns4N$x[VxVeV;?0Gn6=^ck_/7|OM];6d?]A,YbjXin_K_;SJ2DI|@&?Kwd6eE38=","SaveState_sm64ds/3/2":"ZNCA817y4!~6mU+-{;lSMPncU?w?^LS)x2~J6C@*jDi@gvm_ttMKK!PJDnK9H8g2([K^zY=","SaveState_sm64ds/3/3":"ZNCA8v;^!7U=nR;A)6^$S,N?74{w}iQxi_d7P^;]l|bWAaTsp@MRQky+TDK!pau=rjU7R/=","SaveState_sm64ds/3/4":"ZNCA84tUQkC0IzCW3jA)=N8oD~=+3rkyPGu$p1tA-0;w;lgy{HKLaL1g+K)-kefyULVMJP=","SaveState_sm64ds/3/5":"ZNCA8nmqFhfka5~ohNaC?S6he&Q;o$KUE]j1(kTR1xLuDO}Wb&/M,DMvmeTUVF;Wn?osp9=","SaveState_sm64ds/3/6":"ZNCA8x/g02+/6IBGiJPg,E)ZDeqPrEmc?^$m93n(CYHPaQLYRJcME$lAvm|2J3MlmxCglg=","SaveState_sm64ds/3/7":"ZNCA8Q8xIctBf73$K1+Oi1Y78jQ6cMLMj&e]}IwkPC8?XS2LoZtx)PzYy=3SLc*idCDNCN=","SaveState_sm64ds/30/1":"ZNCA8mK=OV5Ht?:S_gTw,cD)!A7~Xmm+xAe]ogW*b9OVE,Ss4ST8}-O0mafHy)rrwNh7bh=","SaveState_sm64ds/30/2":"ZNCA8sBc*l_~=oe~E?Z5m+fGu{WvO]vOgzv,4f7?e3;U&@J-VNwZ[g,GL}RCdt;cZo(i@:=","SaveState_sm64ds/30/3":"ZNCA8LLp3c+CPw7fU4lIIc2M]f:=gk3o$&mO_BVygs)]M,^jl!*^aNQj2hmPwq37}w,U~a=","SaveState_sm64ds/30/4":"ZNCA8&J}]5,~$J|KZ@5[~LU?^6K_-wUSWiEt(TdQ!?P-RL;2k5R^m7tRS-*D-CT$uaM2*Y=","SaveState_sm64ds/31/1":"ZNCA8gG7ZsFD3w|[/zA&TFp1_0yikC&k&L|isoPekN;Jwx,UIv!N)CaW7bxhL/AxQe81jP=","SaveState_sm64ds/31/2":"ZNCA8J;68?oCJY;vOmCnvY-7vP:47((pRGIVXSTexcbL?w1F-n:$;ukbDqa*(4mc3rycEv=","SaveState_sm64ds/31/3":"ZNCA8nb3zmvmBfN)7_f9Wpqn?BN?5*rUdqL;jJ|;7e,8Q,9UmZ;M/f+dlWB1R|IU6FtJbv=","SaveState_sm64ds/31/4":"ZNCA8XnR$:X@z96j=0?SS9@KGHj@JN]J=_[@-l+AYczp:mCrPX4hb,N-AIG5;Lo{8O]SzP=","SaveState_sm64ds/32/1":"ZNCA8HqBcMjebReQF4qjZ9N(yxkwO7A6a(*Mo:AAk?~-CW?nOAkW^0FLcxXr/[mk?-a_zM=","SaveState_sm64ds/32/2":"ZNCA8yZ-}Zw[Gr@63XAaMq+smia0vDX]$lBi!8O$H$;L_{6xsN5I&)Ox-ASk+dJSMN/A{V=","SaveState_sm64ds/32/3":"ZNCA80HHY^h9SL!OZU,M9+r8t4UH2M!kHZn!^x1er}|Z*LX@)q8yZccbHXI*@qZZ^kxBIj=","SaveState_sm64ds/32/4":"ZNCA8-KWj:4;[YR$*Kcdi:P]i:LafuBMYYV2LTo3(zsFl!sfS$kvoBbg}bRKl5qza8w04t=","SaveState_sm64ds/32/5":"ZNCA8zgJug8)2_Fd:+7:d(0d/*+G@nI+)LGspNqHV&A^LIa8@9Yy)aj3q$ieo//S5]YL[4=","SaveState_sm64ds/32/6":"ZNCA8Uw@Z=)NVL:NK+gRcA0Xs9RDGy!6@~,bl)gcI@+?|u_wnnq-ZiaN7x@n$ttePxFOVs=","SaveState_sm64ds/32/7":"ZNCA8VZ@hxPaq}6GjTZp]V7*i86tASggu5?y5M[^S_2x^j{[2euk]L1NZ]0XB@l@9eaz;G=","SaveState_sm64ds/32/8":"ZNCA82)-N-w(]~uTxyqqzQa$mw6WTuszgro)Toert!yK+e&iOESB~8XcFrLH,H]ZTjx7JV=","SaveState_sm64ds/32/9":"ZNCA86HGfUqPjr-]L-?:2H7uFu}l3OqmEGYGo;d$nDbizGnnNEcc^Ibn59un~gy_z{gq]O=","SaveState_sm64ds/33/1":"ZNCA8qH=OYp5kQ$dPB|EuPJ8h8B,+Uomqu7/DJ^t?|v3U?DDXXN=Vt{VPm?@AQWPN~$kgO=","SaveState_sm64ds/33/2":"ZNCA8ex(LqtgUx]i~M7WVOo:c_ek{jcx)-haqWQt@x[z=tU8/IcdU*FVcLU1?!H4SBSby$=","SaveState_sm64ds/33/3":"ZNCA8ume?N?bhjxa^e/Sl}|smN5z+QiRp/SHGOpf?65e(m$U,:b1vAJ$O2?jDQI6}*0E^I=","SaveState_sm64ds/33/4":"ZNCA808}]!@-~QnKQ|H1$7u/YpmoA^PSZQ?h2Ddkoncmg&38|xvUF(5MJ{|Dc9pxDB3GFq=","SaveState_sm64ds/33/5":"ZNCA8P(qHI;z!3OG6fNt3fDU0@cxG/CO6-v*kpEmybla)W,a56gLi@@&TlDvLrYizO@JW/=","SaveState_sm64ds/33/6":"ZNCA88/!M{dR}=[??K*YfcA}pOlY04m4bQ_AAEuVHg:lI-w:sNd9jj(SKK*0a{=A_whPLK=","SaveState_sm64ds/34/1":"ZNCA8[^?v^AJa80bcme7e0B(+1XZIc,(en1EGS~ClZpF6Z*/4+wA42pOk-!Vl)8!;gTV4@=","SaveState_sm64ds/34/2":"ZNCA8=lbEj4;{$([MrY)L&/}LlP}{lp3|lp_ltYQ8mPIVXHv{G$5Fp01q~EGp-mS2JgMdf=","SaveState_sm64ds/34/3":"ZNCA8rJ0B{C(k_O0wsi;aWPGSLOIxnuiiZKAf?*t9{A&D[2edvN,3+|lIKSNwPExC6]MX/=","SaveState_sm64ds/34/4":"ZNCA8Nhe8m3f2i0G^)?qQR1hw7eer-Y^=dtc+{rtk0KPB=Jax}5?(OX8/E3!J{,KD*sO+F=","SaveState_sm64ds/34/5":"ZNCA8ii-8iZxvsGvWO$H[27&;Z^zoU8u$8?WGiy)OiZc5WKDJl[6@M)_ztGTM(l!ZSI{&{=","SaveState_sm64ds/34/6":"ZNCA89JoI4u?:_18WT{;Q]]Fw&Z^yWc[*WQPa}H5JRySs*v=Zem6_73CR,a@FW1W*JX~fZ=","SaveState_sm64ds/35/1":"ZNCA8*f!*Egew_SWQQ{,UJ0wS=9j=I2hyUJ01sfjn&D|:ByEd~4QE@_[d0SL7**Q,{c:Nc=","SaveState_sm64ds/35/2":"ZNCA8Ofpvtetv9gI@=RG,5^=3LL^al9+CIF0FzlGJL7dS4(4WR[{MS}o7(5s(=~+LH3k/,=","SaveState_sm64ds/35/3":"ZNCA8iPTsO6_u;mJjTlZlJ;e7wc~fAV9mM,5]1Wmt+aQhr7?K@=]VR]*M-|D(z[bbdn__P=","SaveState_sm64ds/35/4":"ZNCA8Nv@M^:(C3AF7Jn2V?3ym(^eTWP]GrhAX+~9X$Nl&g&-{1B[|L;(CsUGZ|Kv];o0H{=","SaveState_sm64ds/35/5":"ZNCA8B$8U9sB{3a+i6~SWa|eG25HtqV{hFuQvQJfi2+F/BuD]W7hoDA8$RN!Hy[3|gdKl]=","SaveState_sm64ds/35/6":"ZNCA8v4_oyypI8EhF1YD?ZCSX*/PZDjM=iS*4^EPWs5H~c=3rPKTuKuJP!!Ev&u[{v?C@H=","SaveState_sm64ds/35/7":"ZNCA8qCr?-/B$,UJ]$VJZbyNE[4WOYO47AJ:pyp4p9!A3zfDN|9b1S$u:A}qQCJ/U!1f$0=","SaveState_sm64ds/35/8":"ZNCA8Z9G^(Paji3Wo?+bEX?s~fV-=617u^$BO9nQ_0l]vd=umJM=147LAwcli5ycItm8=x=","SaveState_sm64ds/35/9":"ZNCA8dOTGOwsnB)X7J((CQnEH0gEM*Q31O;PGnyJm4XAB-}^/pHrr-:D*QMPyIx9bR~u-m=","SaveState_sm64ds/36/1":"ZNCA8o(YDVJzsNyAHgN}yrPtVekOB-yBLz{F?ohyFH/4gnO!K|Pa_3RAb+9wrCL+hoWClF=","SaveState_sm64ds/36/2":"ZNCA8}T9ZftcLD-$6pfTeFS|)BOy96pBAd!G(oqJL_YGf40VCRZ8d]44D/Vrr&b*k5s$q==","SaveState_sm64ds/36/3":"ZNCA84)kQbukCVyxpNZ1b$x*+AL5)oYEYl~!HJX~]:3-+Xv5Puk!LBjek?oUAD^w^[PPdg=","SaveState_sm64ds/36/4":"ZNCA8)xmCupxb$@jT5dg1q;B9EqRs6Y)*mJSG*$z@FvQsxS01LE$nF~nOtfB&|/x*kXTg7=","SaveState_sm64ds/37/1":"ZNCA8[F@cb@&7w2167Xe!Q87hEW[1D{JQ:Nm!tW3/+CPCI&O19j4y8m(FvS4@&yq1K3;Ok=","SaveState_sm64ds/37/2":"ZNCA8i!+$)v@~;&]:?}x6c{OHFz:LGwro0H-)[?_TxGF+rxZAc)/Em&3U)nogoA8rzB/2Q=","SaveState_sm64ds/37/3":"ZNCA8s:z$-fI@Wg)q)24]njC2fv-ngpl}uQCV8PVmfDtp+{OdqGpaLz$Tsmx6l$Wq&S:]z=","SaveState_sm64ds/37/4":"ZNCA8B3$_t,Slyc?!v7oj:,:U&H14ofB]c]nOcDXgop5HbGDWS{M+++HoJ;[J*~;F_nRfl=","SaveState_sm64ds/37/5":"ZNCA8AVy7gn[pWwzWHW-@~f-NRgqGL{ZfUASD=,Va~wyZ-wu-X*p97(8NEWGnA|40$cA1x=","SaveState_sm64ds/37/6":"ZNCA8RmfuuIn_GjI~Lxan,ZnqON?z*h8?6;@v)C{hK@gOdG:de8ChK+rHfB?Qq+98GAf[!=","SaveState_sm64ds/37/7":"ZNCA8du!R):OOa2({qg^U20?:8$ce70QPZ@y_6_BDA*R0VFJ8yL}3kEuGVJ2q+Y/5gJF_e=","SaveState_sm64ds/37/8":"ZNCA8xF}/[h/mCAf:@szEkjTMEkPd2/,!EsF3X;rTsU=BWGVp30G2Y=p:3sEQK$f1xj5pt=","SaveState_sm64ds/37/9":"ZNCA8h/Lk;7m0?fy4(Khbu}M9n-KcHy/@fNF!2]Y/j!?r={v$GVNxXi/Iez|(?z2&/9zJP=","SaveState_sm64ds/38/1":"ZNCA8!6Ia|OCB$,G3{4LYbY)Vb?Lii7}oT/8i)7bSdO?_FV6:1Q?y46n9zqA)CyB)8AfX==","SaveState_sm64ds/38/2":"ZNCA8qI&7cnNJphVsV|=L}UCcwVd4X23qT[IA^~aB::PeAcDpOs_e!R}L))JqC;4fdGC?l=","SaveState_sm64ds/38/3":"ZNCA8&RlGV+QL=zt)fE:vYh1ViaI]sv&C~PS,~oODg}+zAcDpOCDsA@6+Mthskl$G3d)mx=","SaveState_sm64ds/38/4":"ZNCA8_wZuSi3!1G6Sw_0QuhV?f_QDZLP^kMzQ]=A]H3]&cVXxRWmE-3nCgRnOSoKti@JP;=","SaveState_sm64ds/38/5":"ZNCA8_jzH;T{,j(CyN?bNB(ltOkpH*rtMPnAfyTb&8c!|rh]abqG4e5(yBLnd-kNc!1;vb=","SaveState_sm64ds/39/1":"ZNCA8p*D5]/DTp58(du{S6y]87Ml&R;wehbIV&qvVed{ZsH6a}lD3|V!_:P)DS5RrB~|k:=","SaveState_sm64ds/39/2":"ZNCA8S08]bhMHw|}Oc)dVNUIUOpvw6T1JqLItGCO$D{R8WqpN7}DC:U4SO*t,lEL{;n08m=","SaveState_sm64ds/39/3":"ZNCA8=ik]A+DHeVSNT8b)DCid2I3J$50;];IQ$eFNJe}DW_eaRea-_aSw1=jl?7jt3CQiJ=","SaveState_sm64ds/39/4":"ZNCA8UME0yE={Q)/~v)~W&?:xQy45GCuUXj()Ps7Z/rl!;^u|vDFW?RH2=TTiMv7TJw|yH=","SaveState_sm64ds/39/5":"ZNCA8gR$u7v;tA/2R/Pa8Ou[nkv+/|bE9}E{O,c@O+)[r~P(419wSvF*t1!Ql=SIsYbX(p=","SaveState_sm64ds/39/6":"ZNCA8N7~}XKSy=d=:Ut:iyLNv0f+13mP}4vJK2?rdBDo{(n2b=t?9?=Bq8fD?ia)opV:(q=","SaveState_sm64ds/39/7":"ZNCA8!W^fSqZ6E}Y73ak:7uE6GSSX*7,x/mSVDmTZ7^4Jh(YX:PDro9wjv~/M|$yWaHrRY=","SaveState_sm64ds/39/8":"ZNCA8*Wqw}]X3z&MkW7X@Xcf=zaY|HoTf(lAbf3Wp6tQ|fVK^[q_crBsPD{^[{cq$7b(K!=","SaveState_sm64ds/39/9":"ZNCA8w(&Ub;;0+d?xzC;$/HHD~X_Cjd[2,LXtaO=qm}gj4}jRzw$]U({~c4HRWd&aQa6k/=","SaveState_sm64ds/4/1":"ZNCA8DEPb0TwN+xNe!e*Y&CcgA{_A)PLHN;taW{~nb@J)wYRf[E|:IRd{kt9*1Ss-EvbhG=","SaveState_sm64ds/4/2":"ZNCA87loTG:^!a{Kt2E)Cn{2!N=F3T]cwc*;=?wp]yNN:bET,-KtX/)W2}@y&*FoLgvvDs=","SaveState_sm64ds/4/3":"ZNCA8]xY,xp|ohyEM8/,sH+AJ22mI|JIbeXF*4z|C/NyO*m_XqCI@5N6bD015$P(9:;;X2=","SaveState_sm64ds/4/4":"ZNCA8eXzj/S:=A=zf1Wr-WI3W99P1u[w~Jei^P4K9G@JLik/QIIfqLD@3RHLdgCB!CU_fb=","SaveState_sm64ds/4/5":"ZNCA8sCK&4rcBv,!&s|=&?|-Mj=HM0{q4Cs3:3tBbn+!:HE4vnE6ReK3sjz=7&~-M21Oz*=","SaveState_sm64ds/4/6":"ZNCA8_|wCn]|]q6PrbbWYNc+$*uDyak-6+O3a^QiCVsvEMz@alQ7!p-L=a][?;F&Ev~C^O=","SaveState_sm64ds/4/7":"ZNCA8yrswsQ8h@4a@a2Kf^~([uKywjlwbvQS2+kN6+li4-}E|nd&E{g9iiqUdY][{5DR1z=","SaveState_sm64ds/4/8":"ZNCA8y_0a^G|g7L~@K]P~/mq}qOcH1iBZLL)iH+B(p|v~)y8KtOW8EC6yUWYw?|fOh87+t=","SaveState_sm64ds/4/9":"ZNCA8S0_M+=}_3K&L$9ktW(O-)EapLe8uDrra;0K?oTrc$/fEvZxkE_Ff;d*AdXD[GBJXO=","SaveState_sm64ds/40/1":"ZNCA8;3~hJbQYZeW0qu~*IC@C1Usdv2j=m)TrbJ$FaK-+G^ATNLSS~PeWH=o]XOfQrx6h&=","SaveState_sm64ds/40/2":"ZNCA8zIjXxlA5936__cySDbPIQLOd/MxS[f(]a^OeDG+&FB@KWb;UmOqDgyyVh6Ia-?)e8=","SaveState_sm64ds/40/3":"ZNCA86$2@83?Xp_9}gqTA?WGfI@r^;oYXILJSu,0@:lOpnO^aAhE_D_Zp3LZ$aw$1_wv~E=","SaveState_sm64ds/40/4":"ZNCA8YHLjlqIM+LL+3x5&wfRGn$Qj:,C@@qAsku5:*zNw{TV2Rx6Mf1{@_/E~4o)PX,Bf==","SaveState_sm64ds/41/1":"ZNCA8!rea*ntOo5L;rqmnJ?+K}KCcReUO-R_TYoXTJE1]0MGd=8_L!4?p(]XX_M:-6h:LN=","SaveState_sm64ds/42/1":"ZNCA8j~$-K@l$ieW9f{_rg-(8~(,RAFurMXI$TSmN~,e4Ev_KwedJvKb!i=n~s!&K89!no=","SaveState_sm64ds/42/2":"ZNCA8335H^73Utk2fpSb78JHT$g20)sK~aEM2jMu1imOEO!)Q_7,3qpqIec|Hv1MbV(aXc=","SaveState_sm64ds/42/3":"ZNCA8:yRs[E4COL7zJw@U+I7m!oHlKmnyn7!UUBXuu0b(;(YXPC3IDrO,7fH~+nO)&ox|I=","SaveState_sm64ds/42/4":"ZNCA8O+I]xuBtJC1OA*T9*+CKeA5-V}HY2=voTu3Fe5TEO8oGkuqZqM?LZ-n6;98w;6h;i=","SaveState_sm64ds/42/5":"ZNCA8dfz=;adc1XBixDpMJDa*kdM;?p_/?Es*JagK=E?JxpSEXk$-V~PA|_(q6udkRefKF=","SaveState_sm64ds/42/6":"ZNCA8Er4k!C7UXnuinb*ne09tIx4fd?FF&&t3qF0CHn_eUDG-UFbPBfS8}r3&Vwy?8^Uo]=","SaveState_sm64ds/42/7":"ZNCA8c[AV&;&WMQ2g-{i/8~a(;+B;OD~|M[r0au*-mSP}hTc@OsI:MEG@7KgA7,,Ee0hnX=","SaveState_sm64ds/42/8":"ZNCA8-vg/p8zzGywGXHN~yBVOt4xleYjnwU;ofA$MP+1nO4;B;Fy,fDSf]IuD?)j6$TV)5=","SaveState_sm64ds/42/9":"ZNCA8i,u0s&80)iVQPVaNRGgM?g&3kcojT1E?,0?dun^JW_8H0+^mUD*[QyYmJvDnI2kFQ=","SaveState_sm64ds/43/1":"ZNCA89Z!:Ggf,Y,XD^]eGNR*28|X$XQ:[6{[dfCN289J]{L)EoQC*r9cQV*^LWN?(wr|0I=","SaveState_sm64ds/43/2":"ZNCA8tG~/E5zJmA+wun9F}8GETdb1sRPIG[gyDbz1{:AwH6Y/kEfJvqu^IO9j@jmh!4f*b=","SaveState_sm64ds/43/3":"ZNCA8P=TNMYg5)a7;wCl7Nkrg_hJ@1~VGY+6JuK-7O!/MuV|i=YKm)0s2gLMP{sSc;k|Qh=","SaveState_sm64ds/43/4":"ZNCA8GdDsEl=QUjx+JWnjF-FCCXA^0hD*oChbMpm;1sy,wB7(dtyT@LS3[Lx[=F[fKyj3D=","SaveState_sm64ds/43/5":"ZNCA8I-e17FoLy0:I8Vt(wmO~WV)3;)F|5KZWVy{a-l|3aXF7!YEx^mbIzguS@?(V3{B9?=","SaveState_sm64ds/43/6":"ZNCA8ti!tPLfUu3xicXD]qcdG0!sE_qZn177VTUkrfv|@TkhKh180[ROXm74mrZo{JMl~@=","SaveState_sm64ds/43/7":"ZNCA8J1j,!o~=Y27*r|-91B@2Clqb}4k_^]7Gz0?xELLO+ssL2S)1KL:=+e{PgzWW[?Sb]=","SaveState_sm64ds/43/8":"ZNCA8Z_UEMPFg(5&kK2Fk)Bf07QkUCgIrW]X+;RpUah69iDC3~(kVrJP~c&xcTO{][+$Pv=","SaveState_sm64ds/43/9":"ZNCA8WhzDt3(4DKL*(gWMs/pEqtws?t4f@:VW5RG3LoYpog9Zcn[N}BQ-3pS=obnxL-7yu=","SaveState_sm64ds/44/1":"ZNCA8*Z7sWDSJ$~2Es$rzOxc{R/5Ey:u]nVgC@Fi+?,5F{hHSvpK}xdWL4L5a}D*gQ0)x2=","SaveState_sm64ds/44/2":"ZNCA8PS*Zk,nfkny:):(~^MZ&V;iyg7pJ9w=*l]mNshXI!3N1Bu,=G}lbCFOK}yan~o}D/=","SaveState_sm64ds/44/3":"ZNCA8ZC;{e*ok@{B9~^}Td5!qzb^InfE!QMIHh@{w5!znj+Fr[Lj5c-$r+wlJk5kNR/lI*=","SaveState_sm64ds/44/4":"ZNCA8u}S6(mqc)foK)[|y04!qK=?G70-efGZFhkIP0_h!*]xBiNB![6CpkU8*XWe?qwZ~{=","SaveState_sm64ds/44/5":"ZNCA8F?M3rGCCIlx7C_3k(qgra,+NS{h~P$b32?QnYg5C0T4S]GapfbuGm=BFi1Bu)Z?aR=","SaveState_sm64ds/44/6":"ZNCA8}PLe$3~cvA40H&,q[qpW@q^AG~NWN+U,g!@K~P=xjg0|)AZ1rG2^cU;dG{YjKDFC&=","SaveState_sm64ds/44/7":"ZNCA8L5:!Y;o$Ri+,ih+M3PsUWE7b-2YTceLVI/tjS(^fyJ[9Wt|UoO9]Qv{Zo~kdc+IJ==","SaveState_sm64ds/44/8":"ZNCA8BA05Yi~a6*8Tf|1=TNk-vvL14=!|yfzf63c!eaLsSGhy|To76vy0ey-45Ifv/Mwr&=","SaveState_sm64ds/44/9":"ZNCA8@cgSa=&3q2gy0h!V5YAcD|2190*FW_86Eh4Ih?]e1o($A83FLUFA&,7P?REHQJ+2l=","SaveState_sm64ds/45/1":"ZNCA87WghM!xxmAJmP99=iqrTs0!o5G8|8Y}TRz++&nWaoyTPd0qfHtFh@Ue;n0kY;Y1pg=","SaveState_sm64ds/45/2":"ZNCA8Vrx8h1]7$mdv&~fHd*w)[,=IzwJ2pJu?,nR3BC}dGz]UCy;KZy1VhG)~v{Qu-eC-M=","SaveState_sm64ds/45/3":"ZNCA84-;w+U0He,38Y3Q+^Q0[cFXpM_kX*+=255UIJ1N;61djHt/d@$YK3!=_aYcYFE&00=","SaveState_sm64ds/45/4":"ZNCA86E/s@dFp~H*{&Y}z55T17bk:4@9EaJ3gBKN54d-?(njim;yJ}0N36ulC;4zCSXx^7=","SaveState_sm64ds/46/1":"ZNCA8bQ$I7zT&D-A@FsD=U^YA8JwM?AC|y-6JuK-2eJSnDY8i|0!(Hrw?6I-X@(BiBonR3=","SaveState_sm64ds/46/2":"ZNCA8H]O+q*mPQa8SDEXt:ki&J&t?rVi|5@wsnB)5b?JIQG{Q$[obokcuy4QU4lQG]Huwi=","SaveState_sm64ds/46/3":"ZNCA8G;SMy?ISvidegOk4~):*W}Nw*/X}*uWKMtqdCJCr6H@^*Z^nEvF^,}Yk9W{Wpu_rW=","SaveState_sm64ds/46/4":"ZNCA8f;Ss]J/Xej~FIl^1;&f2mUlk!jI;{O;,HE+ofpOZ(4?mQo{WS6U0RL|RSq95_X6Z}=","SaveState_sm64ds/46/5":"ZNCA8ikw4sxO+4C;eA9u7xGLWDcmIp67s~;/t;YUuy-3i/o6L;@[n5&vUh?(l-XoDwwUpU=","SaveState_sm64ds/46/6":"ZNCA8LJU?|dx-K:*g|dxfes?ru}QeIAB$&[g5rXk575}@~w&eE,4l-[]KlCbT)upe-R/(&=","SaveState_sm64ds/46/7":"ZNCA8m[s/}80-v;wijrA831GLjJ8fXgq,2Pd7OKjG*/QiZyo&5puJ72x{J:ghk[6*aZ/qf=","SaveState_sm64ds/46/8":"ZNCA8BI+QTcV-8/0aFnoS[pr8YwsHfQ4i5!4_@7]=4pvc=h!/48*ay(F~G(syfsk6v;iXe=","SaveState_sm64ds/46/9":"ZNCA86iYTPVc?$:XB/Crnce([~seK^$CSM)zVI@x/!3q51}gl(tPVN_PlEpdQ*AK$yWV^~=","SaveState_sm64ds/47/1":"ZNCA8ohnKUo$@yni|mEb-RY:r30xaPew[35vv(X8ZtTba*OCW+HK?}d3bI~Hnf,&}UYP4]=","SaveState_sm64ds/47/2":"ZNCA8uc-G}hF:oa2Hy3IoY_L+JT3sY+baqZ~5E+!A[2^stQYC|[91&fN-dMQMjTdwrfdp~=","SaveState_sm64ds/47/3":"ZNCA8bdgOAKThC4I^]OKY(KaVDq|oNiO)huo7aPzFpysV?EjRJ5~,/FfAGQleEQ4iezJ@7=","SaveState_sm64ds/47/4":"ZNCA8Y:JRFKZ+TTxpxqNz6TW_JrK0+KPblZbOv(_Y@go8KjSd)U0:lT,4!baEO{/+r[U9r=","SaveState_sm64ds/47/5":"ZNCA8NC)|&lezu-tWT}&[)sW6LCQG,ydbOe_xqE:!~_u,BbKiP?ak:|fYB$fM{P4EM_?SA=","SaveState_sm64ds/48/1":"ZNCA8f25MwCjo2gtu=JGW;BO09O@pL&szs,N1{n1c&agvu9C-$=)jn&e7E(Xj8{nE2Dp-[=","SaveState_sm64ds/48/2":"ZNCA8FkfZ&mxo,@m_5hluz|2*yqMaB6:jh{As]:DQ_LE6AS=2kTu-k}c{R{3~vcfAWVF{c=","SaveState_sm64ds/48/3":"ZNCA8@|_@+OGQqB-:|(Uq0Jqe@jZ{=UD|bl]$$$,eo4=TI^buwf7Kov-Zb?_5K=(nw;@kz=","SaveState_sm64ds/48/4":"ZNCA8,:!5BOJx-TiOm_w(O~,U(75JLYO}ZVAAEuVH=N^=Cv9J(),jb;wuQ+[OJx-T1@50q=","SaveState_sm64ds/48/5":"ZNCA8ezIu?P!aGphO3,$;&)uU8c{Isg1jM6gd-(gsbN9s+C9}+V+qx0Q=hGDWs)Y+?5X]N=","SaveState_sm64ds/48/6":"ZNCA8uRv6Gs35G4!N^brU@F|90NL]Z{sxT8~=Ml,0ixm/2ET:_hHQC5C8z)2mTY{kKli3~=","SaveState_sm64ds/48/7":"ZNCA8@l!z9f;]o|R_*i1,64L!/_hv=Gg$}/4}=&FFY?Rd)w*)pAV}](B0xkMq8nkG9TRdY=","SaveState_sm64ds/48/8":"ZNCA8R8elGmU_ZvDxBDWJ1x~ibX;dLDx(-kXV6[VvmiME3&NPVAiEcV6vy9=Nn*j4eOuD|=","SaveState_sm64ds/48/9":"ZNCA8s@|O7y0?A6BE^nz*z-wHC|U(zm3f=v}Ql07u]XFU$]E$G*)XpQM+rnHl8~-Ax-6IS=","SaveState_sm64ds/49/1":"ZNCA83}xNfoxC1v1NS)|-!_c!RzdZLGc;QsJ$g6[1jKtHAmTm+_M-R&&Te={u]LZc9JaL}=","SaveState_sm64ds/49/2":"ZNCA88?[MPvcGYG{cXIHf/(~6=I5&Kl*^NI]xx:_-]6C|@rNre+E]ihrI!7)i,eZoXV(bX=","SaveState_sm64ds/49/3":"ZNCA8&}3C622mhAB]@zOfDkJIeM-8-!+}GvgNS!t4xjoW{7@^?~X+g{T|d73/3OJ|2F^5u=","SaveState_sm64ds/49/4":"ZNCA8(-|7KtRD;mL?bQWZi;:ZxwJd|NEjM7o+XMWkJ-7v{/yBAs2;GzqRF1_RM;]A5@i7x=","SaveState_sm64ds/5/1":"ZNCA84h7j,uI8MxY}Nv7&C=+KAbH{{H2E5MgLHlY-1C03KkKdrk!LBjYXcPkLltj=!BCE3=","SaveState_sm64ds/5/2":"ZNCA8UTxC!uz$cCwn}2_q!8m$7r/Q~_cfm)[01o+Tu/Nc3uD,SbNM*)vtd|Q;_)}9D_Zd|=","SaveState_sm64ds/5/3":"ZNCA8UVzmL*Y2{$O!=2qdgQ!a]V[lJB]Z;/Ica(b_k/I5DdhzR=MPCS8gG-KvN|?p&WE]J=","SaveState_sm64ds/5/4":"ZNCA8qAAq&!Fd]QhOCr84p@(yT@dbyKWTJxdT$gP4hC/?{z]+2YD[BDH|(@dh&^)1R=!nK=","SaveState_sm64ds/5/5":"ZNCA8k/@2v0@kA~R~mwz~kjd@}P7N8o4/sA6;|1d6-,z_J)BmS09D{,x[=IE@HM:vf_FMQ=","SaveState_sm64ds/5/6":"ZNCA8vT:uCToYpfV8+iUpY9zp(yi,R(nNyqqvU]BTBMDCWWx4w!]JJ*B6xX([BYh9b67h*=","SaveState_sm64ds/5/7":"ZNCA8XuRMH{Ski;iZM$v-/DK00_[(2)0_-2cM;N}n52Kqc?0c(0IFV&rpb,fG_EGIIR0HZ=","SaveState_sm64ds/5/8":"ZNCA8IoII]4Ru])rX_dcl:*?96z60;?P}3ywh!74xd$Gak~!;5-so4-c-,L]uk!BVvP8zX=","SaveState_sm64ds/5/9":"ZNCA8HJ{DV{GUk[:3PRD[h2BO+0~ufNyKk99N[qPF;ataVD=2FC]$uVMr7Zzc59Q5bgmYN=","SaveState_sm64ds/50/1":"ZNCA8$GrpAzVI@xF43+c:K)Q:TtTz(,?WEa@k9DtZP@T]IP5Sv?[z~8/|$l$8ixiWidZX2=","SaveState_sm64ds/50/2":"ZNCA8FZOH=0k|ZufzwcbUPN{+o?0rFt}i=uh2DdkJz9XV-BtthK}H|&Z0J_5wMu+eD[@K+=","SaveState_sm64ds/50/3":"ZNCA8J$pr&8v2M+d!0CCO46$RXPuD+h/689Qtx+H*?9SkpAeS:)ZnLj@{u7,wqkbyHZ8fi=","SaveState_sm64ds/50/4":"ZNCA84&r|nVz7KOAD0KP,_0cQ7:lP7S|Wf4zBYjYXVpG/,}[vVQ6U5cF[Zo?A}af-s+1Ss=","SaveState_sm64ds/50/5":"ZNCA8i7?$e2i[fa2*Ic:!kCnr,s4ZiYZ1PtM2498BhZy^L1K-eiPC/qodT9+J)p?tBHq$D=","SaveState_sm64ds/50/6":"ZNCA8[deqJvb+X*L8/--$9Ko48-J}([mB]/6}[=[g=uc_Bovkg_EJE~8ria+5BeG96[u7u=","SaveState_sm64ds/50/7":"ZNCA8:3,fPD$AFm2(Uw&PVQ&(F7FYc17R*VxHf,SYSlh]rdWjr5k;d9oLY,j1bv52p3of(=","SaveState_sm64ds/6/1":"ZNCA8J,5:F-@p9b=tIjfal[fx{(|8oM]VAk,x3PGl_Ux:RAE_JU0;qx_o0UNqEaydBoQVE=","SaveState_sm64ds/6/2":"ZNCA8r&~(BBW9vAbT/ZX//^TH]1H2+b9qV70^Dv_rMAL=5EGp0m!knSNa,04&Hj?pR6i-B=","SaveState_sm64ds/6/3":"ZNCA8K+M:N1Y-tx19tH?Op(shOezQlX{f4)1uj,)eDY+!a&Oj;vYH!RMjc/R+re4$Xwkj!=","SaveState_sm64ds/6/4":"ZNCA8-wX$9rsnbhQ{LjfXOUNdX[y!urFt6Ob=]eK_;iIfsYEdc3z=O^)~y=xf8OSrrbDd==","SaveState_sm64ds/6/5":"ZNCA86!G:q!mx0JfJKyl8ZeF/Ploh[ormCabrN**p(]]xMtUs-:*eCD(otjkSubn_@N92O=","SaveState_sm64ds/6/6":"ZNCA8IM-BPa8t|ijp9(cq=}4IlqyUJGN_SPsE[Mb&z!8s9Z@}-/e3WGnTd7igiM2Ik^kkl=","SaveState_sm64ds/6/7":"ZNCA8eJ/vE}Hi(Z-$GcAe=$9BQS[W13p]9z1)h=z2C:K{atoaYmib(Wbqtz8EZ;@fsH:U(=","SaveState_sm64ds/6/8":"ZNCA8xCO}11U[wdq]-uZ;n7l0cCed-@c)tU*Ti_x_E+RnQ&|}4n*7JYLLYQ$Vj?u9:QHN,=","SaveState_sm64ds/6/9":"ZNCA8w$Ea2WNm-@Q1(CT5[]EWyJgIVaaav,IXV?sHy-_]OIpqd!E!nHND$=km:yXtWD]MM=","SaveState_sm64ds/7/1":"ZNCA8;ZWY,$VKeSl:6[),$YX/fTH7Z2c$nQgW9Syj{)EiM)A;_FpLy[9gmu04uCHs]f/T1=","SaveState_sm64ds/7/2":"ZNCA8C&w{Ja6m7G=md:&tbi0&JFf/?*e,fe2YFc[$am28$&-V3K+[rg-]Q_;leRr^fVLTk=","SaveState_sm64ds/7/3":"ZNCA8pjiI)f;dF+KkzJniWnIHpfQLCil0+~U8+JU}K^0}@,q4PWcVL[CSZyH3l|5P$5C5U=","SaveState_sm64ds/7/4":"ZNCA8[GokY]?Cx^A5Bq(lqzm(:Uo(fzDA876}QRG}N?CL0phtSZ$x1X3:/qpv*|h-jD/+g=","SaveState_sm64ds/7/5":"ZNCA8SJVRxI7Lt0Gw24HnqL}5*1W:=C~8x(WOsn^ixoxw*;?=?bYdL-::pLaZiY_P6-b3l=","SaveState_sm64ds/7/6":"ZNCA8(=_o[2~d{t9rFhwr_bOudw_;8Tf*Q875rSi9PSz9_p_;}23{,L:(tXMQ{pK+N(3fI=","SaveState_sm64ds/7/7":"ZNCA8hGGN;r]G[x91uw}iljsV~SFXnhyJYclFM)iZsd&zNh/hwR@k318+cPl!rCjE2ezA(=","SaveState_sm64ds/7/8":"ZNCA8GwKBlx2-Q*x54;K/}9g4$vR$x!1j[P3HC$PtO48?PhiLgehz|ICZEQD7j*gdf=V/W=","SaveState_sm64ds/7/9":"ZNCA8YcSOdFpW!Ig]{8UvaIv@aFj4[T;thhkx6[skRucUBD8]1lQ[WE)vgZvkJu&3yf]Uc=","SaveState_sm64ds/8/1":"ZNCA8Uj6!9w62IvnZLn7x,l0:l[4neY(w(&pKyHvx&@(0N@rb7=bnwSOokkQ[}(LI)7:7E=","SaveState_sm64ds/8/2":"ZNCA8I3!Yr!j@f3s,COgCp@s}hEJ$DFv1L/hMjo=k/?8{@M|l77ad1^wObVbaX25GGiLk+=","SaveState_sm64ds/8/3":"ZNCA8+Yr4I_X|f9Kc]E}+Z6IpveW(0ID075VEKIkVckJ$aHtpuEe(WIufi[:VSi:=Vo:;6=","SaveState_sm64ds/8/4":"ZNCA8Uv]OL1(kTRAA*ikze;baPqFm]kRIrC5*oX6/=irtpj8vO7DvdUUFlf,I4zf4@nRk:=","SaveState_sm64ds/8/5":"ZNCA8j6B^?0SEXaEB~IIMmkG:M;K?4,SD&qu0nvDm4Y]L+1t?+mSj0-(9/2}+gJ@uT}o3N=","SaveState_sm64ds/8/6":"ZNCA8nU40Sx5zykO?~^Tk044nRmK2vEq~4XPSSw;QqYwDpx?}GGT{^Va~v,BPLn0+JnSrp=","SaveState_sm64ds/8/7":"ZNCA8yLsUYeibi6kMkY_vR&7?OtcLJChJ;ug5HChWnor9(eQ$~zM51W;w[-BZrLw;ofq=l=","SaveState_sm64ds/8/8":"ZNCA88lk]!)ARIue/xjpO3iAUeJw];?m|2E?(QBNwm}Mic1hKsPZ59]&~1fH7KXASr+X8Z=","SaveState_sm64ds/8/9":"ZNCA89{LRHQ8~M]thEFIIlx8hxjegwG+bPoXUkmy=A^(W!Si[?kL)c]xZ2yX3ODc@~1w43=","SaveState_sm64ds/9/1":"ZNCA8i0SpEf(LjIq5?B@aq3jFkDGIbxZBm|Vgh&w!u3u[y3]6;bCxUtk=r0vz!{zVqIfEX=","SaveState_sm64ds/9/2":"ZNCA8O9J2z+2_6of_|^:P=7:q!{8VW2ph-(B+*KGVa;PJEj&)4bBEt{i!E(D_|0ud*x?M&=","SaveState_sm64ds/9/3":"ZNCA8-oj5]+2_6of_|^:P=7:q!{8VW2ph-(B+*KGVa;PJEj&)4bBEt{i!E(D_|0ud*x?M&=","SaveState_sm64ds/9/4":"ZNCA8ZHe;:n@+F)6ykdzJ3y/5Cr|&GjVD?*}H,$kcpzu$p~CE~&0WtFolIwdhXQ3*SK&xn=","SaveState_WiiSportsResort/WuhuIsland/1":"ZNCA861n-vXV8)*Q-E:]-oh*Niy14UAAC&g1x?Wgztuhee?RVJ=w^bUPaZIT]{OIDnZft{=","SaveState_WiiSportsResort/WuhuIsland/2":"ZNCA8YO6_8[!a,|[R{Y4v]=z1=Hbz]AAA^=],lxqiOQJ5,|)S6G/oL8X;As/B{f;V={ckJ=","SaveState_WiiSportsResort/WuhuIsland/3":"ZNCA8AIl7NE+[na7Rovz$O/E|4I8e|AAFhQZsB=WFB&vcNLDTe)lqbO5_:b/gm52}W}7DD=","SaveState_WiiSportsResort/WuhuIsland/4":"ZNCA8fMg+Ia00B41Mol@h?C|w;[[JUAAJB$2kl3VhHew^M6kM/GRnpOKfw)2{f2o9U+t~d=","SaveState_WiiSportsResort/WuhuIsland/5":"ZNCA85*[Ce/-@7IbaV:Vqc2h(rlsPDAN5m$A]xFYPw0CxRqrqcQobyKUuPTu!XZ5bd=JR-=","SaveState_WiiSportsResort/WuhuIsland/6":"ZNCA8X2_p(:nRT5*N]1KYsOG)?!&noAACM1klTR6Lb?OuB~R!C_~=-mQClhhI[LYkik=4*=","SaveState_mp1/mp1/Metroid1.pak/1":"ZNCA8f7k[)jDP6r)N=H7CTCxPaBI8nAAH*C]NQ2=2rsiC*-6ysvzuV}ne2QqawPkJ!pnM[pL~wr=","SaveState_mp1/mp1/Metroid1.pak/2":"ZNCA8Q&m:7f18F6$gy9uix_1(-1XIpAACM0r8a5_{_4T]=NON6V1&MI?QD@a-dn(R3,Miq*^e8}=","SaveState_mp1/mp1/Metroid1.pak/3":"ZNCA8vFkev7+F3u4:0Wcg:QQ4Lh/ADAG(b-]I85Vg9~xC0j3?TdY,Lhc|!oPdqFaR6rRu@svG*r=","SaveState_mp1/mp1/Metroid1.pak/4":"ZNCA8Y/?{vw_g2|,qdV$s(PysQn^WVAAEvim:s!=MoI!7D[9WksBv]yTXh)7isX)m8eIk~pQiA1=","SaveState_mp1/mp1/Metroid1.pak/5":"ZNCA8xD0(n9AsXj]fH]:N0cBLWmY9/AG!TTMACr6$XqSSkesJ)Ks(G74a?+O&q{_CJ])F1pQiA1=","SaveState_mp1/mp1/Metroid1.pak/6":"ZNCA8[*evoJ{xeq7UQ1~W:[2Mpu=9MAABNZ,+d?v3TWvfuvn|z:i?(9g_bZgK-UN*uj+t)pQiA1=","SaveState_mp1/mp1/Metroid1.pak/7":"ZNCA87Q1s~=HCM?2UpUdnbIu67LEreAUp,VsfT;{d4e@Z?BmS(dxI$*?wp0}AKiL;C1FjUpQiA1=","SaveState_mp1/mp1/Metroid1.pak/8":"ZNCA8]fc@)m6E4]c=;QZtZsk9ET{p,ARG[osda2,FWhH9zN{Te!sL?irNE[qanZSd0!pY/([RyH=","SaveState_mp1/mp1/Metroid1.pak/9":"ZNCA8];65F,k=_rrImkw/b_ZUE^0nzAACAvDE:3@pGAKE/gAyij__;}a;RNzSmT4@]()fx([RyH=","SaveState_mp1/mp1/Metroid2.pak/1":"ZNCA8oso^ZmIi=U:~HTq}I,{M?GPq^AADhE+BtTgT*_f/Ert4RW)BjM1eunh-l7?Ilj8,A)8HY(AAAAA=","SaveState_mp1/mp1/Metroid2.pak/2":"ZNCA8(z|+T_I0-S[jDra+jv!b~GzvJAZ0{GJ0ydfJ/-~Mh$q&p1-_R7]N}nFkobD{s|E=w)8HY(AAAAA=","SaveState_mp1/mp1/Metroid2.pak/3":"ZNCA8:7JxRLSR~?G~LXf)kc[oX?=[xAN9Z3n~htd@M|C{$O_$J&[?hWK5:*Raz[MJHE&T_XS$f[AAAAA=","SaveState_mp1/mp1/Metroid2.pak/4":"ZNCA8dW;jbPC?IPf,JD0_rDj1dM}|]AADfu@QT{l&Ep(/y:[;MS0$V;RbS65/Ds&1MXH(2Uw?2;GkgKU=","SaveState_mp1/mp1/Metroid2.pak/5":"ZNCA84;:|jMtbe*tFnjxc72e[EcB-aAUqh{tjK/:q@5$;8kTS91b?6K)KDvWw{{8cIU,eOUw?2;GkgKU=","SaveState_mp1/mp1/Metroid2.pak/6":"ZNCA8{3M_cAFqFbuufzCl9d?oI5iZYAN=@BtXhBpTDHP]slf_Zy:eTo[5m&pK1~idqZ;WfUwi,-AAbRY=","SaveState_mp1/mp1/Metroid2.pak/7":"ZNCA8UYgAdL;pnc]2(O_s,*cc4(nH^AUp2RJWhZCGs,z66Pz7|6RrXxb$Xi&n8=5[q!7E|Uwi,-AAbRY=","SaveState_mp1/mp1/Metroid2.pak/8":"ZNCA8oxIr1-uvF]$d+))D*&zHJ$9GYAROXmrdogj3^-e8n:6)eQ_e78OOmsHxkqdPE$=vBUwi?lhkOCT=","SaveState_mp1/mp1/Metroid2.pak/9":"ZNCA8XXDxnwA;a]o7L,ZKDo_Qp=dJkAN-TMuY8*&mimtX*xWUKPwUixzj-ayRK?WfeQ22_Uwi?lhkOCT=","SaveState_mp1/mp1/Metroid3.pak/1":"ZNCA8mpkJNUUk?)5SI]l@lVLAc^]3eAAFo9sxW]|t;/H:A{VH:Y8Pvpmky[YY4F;dt!J@k&Ltl/AAAA=","SaveState_mp1/mp1/Metroid3.pak/2":"ZNCA85Ms,Ov-IpanHtD?aRYt=Tsx(VAAAB$uR5wTbKb)SPWK$P$+TK-[GZXy?}r7TbJ*cn&bJ_uAAAA=","SaveState_mp1/mp1/Metroid3.pak/3":"ZNCA8*eV9~NwI6[;RXHKkRs-Qbe*-_AAIU2IDK;i(-655bps__2)8ieW:,$TmdSH!U;s*f0:z+UAAAA=","SaveState_mp1/mp1/Metroid3.pak/4":"ZNCA8xyk~x,Vve=9jnoysl(w;qqb|~AAD}9W(Kr}aJnw*_tI7[yjnDYEL)*j[ok,B,o&3x0:z+UAAAA=","SaveState_mp1/mp1/Metroid3.pak/5":"ZNCA8~hSbP5j)HFu9!e&homfl~yITtAAEvh7VTUk1BLM9)u7m$AZ1rGyE:wcK/-dmQLq+VpL~y1AAAA=","SaveState_mp1/mp1/Metroid3.pak/6":"ZNCA8SX@he7-rDiBpmjBEV:=0lB!Q7AAB0nrcr,bis-+p@0{O~T9?cIxE/hc{Wal&RLn_QpL~xg:O3N=","SaveState_mp1/mp1/Metroid3.pak/7":"ZNCA8b$IEnUBXX8O_i$UA~x}7?DVP8AN_Diz?q{Cf11U$7N5|uN;-:)Q3)mNg64ZoRS1SSpL~xg:O3N=","SaveState_mp1/mp1/Metroid3.pak/8":"ZNCA8Fj&V*w(XY,4gB&b(V/stIKCYPAN4dB?-R~2:A*tpggi~H!X7,LXLf}Gg}MnWw)x[gpL~wrAK3c=","SaveState_mp1/mp1/Metroid3.pak/9":"ZNCA8ujCmF5FSD09dAk:vOMZ*mt;,~AAA+NrgVP8*!z(+h:WEw1@ADYraj{-$9^}$5O*tkpL~wrAK3c=","SaveState_mp1/mp1/Metroid4.pak/1":"ZNCA8cS?}7[Un0A~6IW_QK,A7I[)2OAADWrNr/7/[npq[)Zj{&XJ2-9[SJY|IjI-[NqnY9{1^(^AAA=","SaveState_mp1/mp1/Metroid4.pak/2":"ZNCA8Vk1mGoDT!tSo/4Uu,3^0auw:;AS;THu!i]zuQl)m_[|*d;^-gX@w![G;0&Qhi9n{0{1^(^AAA=","SaveState_mp1/mp1/Metroid4.pak/3":"ZNCA8;OH4ptQk)Tqs{~GgTM+/jR@oRAAF$@cJFurE5VMM;WcwzFA:9eX~*55Bq|q=M~{8eAB-47AAA=","SaveState_mp1/mp1/Metroid4.pak/4":"ZNCA8hF5n0xVc|iq|}kmS0C*m4LWF]AAHf?iQ1,2b8s5(J+FZ4Ez2J-:gf7&=3^tg?@^R*AAAAAAe+=","SaveState_mp1/mp1/Metroid4.pak/5":"ZNCA8YAja~A[nibyW!&KcR(rBof][=AAI:c4qQ{w~vUi[[c,0Y14^AOu~gokkTwW:iFWUWAOuLk?^k=","SaveState_mp1/mp1/Metroid4.pak/6":"ZNCA8?M]m4FClP4zf[8}~2s=^@A@,0AACY2;/C5O{T8G!0oY3r0pge=E04+?7HdqS5vW2DAOuLk?^k=","SaveState_mp1/mp1/Metroid5.pak/1":"ZNCA8?~JD}T4k*vGdZ&ak~T$D+Q]$YAAAwv:~K+7-:rI5l84B|y{f3GcLoS(gQ_BA~XDhi*^e8}AAA=","SaveState_mp1/mp1/Metroid5.pak/2":"ZNCA8Zl/Aqz;P*hvJ4Nf_{BDY$,AN!AUw)0aO*HsFph]9R;y6oPAS-djeT$&btq/|XPys7{1^(^AAA=","SaveState_mp1/mp1/Metroid5.pak/3":"ZNCA8BuZ-y:A0LxIf*!@IY,3JY(pXvAABL,-CpwURuP$|s4^lAWBX,S5E75Q6HZr}-g|xjKn^]KAAA=","SaveState_mp1/mp1/Metroid5.pak/4":"ZNCA8=IZyonQSzG+a8-xrw:GrdjW1)AAEt@L+isQ1zubsHAWbPxQl76;WHM)A/|/3J2AMPKYRh]KYR=","SaveState_mp1/mp1/Metroid5.pak/5":"ZNCA8oM^CoZ}3yzVmontj7Y{u1tIjOAAAVp79U/]$fUK4-v:YdC2q=YfnXeeVH[5@1Pmn{KYRh]KYR=","SaveState_mp1/mp1/Metroid5.pak/6":"ZNCA8,nihG8b/z+LFZHeDkWfnaI$ZnAAFJIR9k5UmhEi9wmWWwXGUfLfxgv2iwNNWU0vNCKYY-/AAA=","SaveState_mp1/mp1/Metroid5.pak/7":"ZNCA8b,{04WXA/AslC&N4[O7q5x1LIAAAyJ;n/0/tH}WVqm(w8bPHT|fL!!Fb9:OKR2_H4KYY-/AAA=","SaveState_mp1/mp1/Metroid6.pak/1":"ZNCA869Qq1joyHP/mG0O[)L0b@RXmeAAB9o$?/ucgix4i3j~rv{]?Lx7E7@J-J=bsN5B|4{1^(^=","SaveState_mp1/mp1/Metroid6.pak/2":"ZNCA8N;pV=;9zF+DDH&,n3]@IL2JJrAAAaBqi]rzvCA{AIle?3&Ys(W0]l)9DM$@Sw}zoF{1^(^=","SaveState_mp1/mp1/Metroid6.pak/3":"ZNCA8s[=q9c|mqj2x6jBw]W~r1637VAAA&S7tCHG&}C_PH?vt?zC5Bco=OSpe,EzTM(1a}{1^(^=","SaveState_mp1/mp1/Metroid6.pak/4":"ZNCA85ky)w0S:8@etSm2(IjmAu7xv}AAG40Ed(3B_KJzabgRJw&w&}z7U-LH~OTg5,g2I|p0xyA=","SaveState_mp1/mp1/Metroid6.pak/5":"ZNCA8?|+]{QA{;Se!X^Ng@AtsDBnQ;AG!a-mK-crt|4;9(g/SkL9)o$IrA^CzyDEzG&8rxp0xyA=","SaveState_mp1/mp1/Metroid6.pak/6":"ZNCA8/OJj(v-=Elvb0,,N;w5xP0vA]AAEV/i]0o$1PL9CTper1N6cEA:7d$aOce,N=H5Z7p0xyA=","SaveState_mp1/mp1/Metroid6.pak/7":"ZNCA8:8pM(PHcezy!Q{9aI@)lPjB6BAZ8W|AAEuVw:n$Q~V8aeXtTC?!-s41J*T4j3@qQQp0xyA=","SaveState_mp1/mp1/Metroid6.pak/8":"ZNCA87mZ;sGuZm*gZiC8*JYk(Pw4{XAN-/c;uB-spZlEuoB2_SDtdu[-l4UdAR8nvOaxT$AASJB=","SaveState_mp1/mp1/Metroid6.pak/9":"ZNCA8[apfE!LoyzQt-RfS(x+XHX~@yAG?D[2Xa|~qqe&S2~Ehyq374Og2J[2IyP_B)@b5zAAAF)=","SaveState_mp1/mp1/Metroid7.pak/1":"ZNCA8,(6K2f&GCH5/ff^9SQp7T,34uAAEt$xUPKxqvb@c=pdrCobVxm8Uy5v1sEfv22T?g}V)=","SaveState_mp1/mp1/Metroid7.pak/2":"ZNCA8r^A*7QTMy{VHhp[hxTlN[_4]YAAHf?vp*!UV25YSDx6s$tLAU)={+EP2_O+HDiZ(=}V)=","SaveState_mp1/mp1/Metroid7.pak/3":"ZNCA8:_8$yPIG@Quv:KsvUG+&&BRG{AACpThN;5^g5jr/kyT1-GUJGT+vk*[x]kxAd(7j+}V)=","SaveState_mp1/mp1/Metroid7.pak/4":"ZNCA8wycf]RQ02rI@D:@$q6]q6b]lfAG?;z@p+]V3[ZwO@M0-nNvL-ME;HNlWW2XB)A)5g}V)=","SaveState_mp1/mp1/Metroid7.pak/5":"ZNCA8sQ9-5I8S^~*zenUdxIK6aXABoAAHT~jB{hh;o[!:ycXhvo_dzFd4U}rc2ItsiP;+k}V)=","SaveState_mp1/mp1/Metroid7.pak/6":"ZNCA8a$aSw3GiJbQ_j_fLp[pIqF[kaAAGmvw*Iz[LWS-CD/t&!H~PdN~yFyHG2VciEasyH}V)=","SaveState_mp1/mp1/Metroid7.pak/7":"ZNCA8!NZ@:ElmsnG0qi**5aL5WKuMQAAC?e7VTUkjBXSFwbA*DFdu4bDcPZZPTdOth,*H1}V)=","SaveState_mp1/mp1/Metroid7.pak/8":"ZNCA8dH1=KnHhR)NIV29gtK1iCGYeDAUp],SYUnu,vx=~VcNEZe&wu_/u0XLz0Y!ZUVCW+}Sr=","SaveState_mp2/M01_SidehopperStation/1":"ZNCA8u6GTlfba~eU,+x85=NAehZ:m:AACV4@g^IZh6_$FJHQhI/EywT6{MSA5HjZ:a8=dUpL=","SaveState_mp2/M02_Spires/1":"ZNCA8i)uidHsVi10~a&N:oW};K[O(sAAAB&N5~Jjnkv$=,[_Zxhe1R2NLH::)njY,OGPz_pL=","SaveState_mp2/M03_CrossfireChaos/1":"ZNCA8wVetKIuBI-5=,P^*VHa&!P4^nAAEvh8p|iJ}MPMcVpE*}MVt!WqF+q}hiX49E-4sppL=","SaveState_mp2/M04_Pipeline/1":"ZNCA85G@&[1kvZCJn!8@CZ{^!1ECbAAAGvxQ~~I]IL^;+NgR7:90$zTaZMfnUSI}=7x/ADpL=","SaveState_mp2/M05_SpiderComplex/1":"ZNCA8o=j3_kV1nqfWI+R[SJmu-~SSkAAAGl]$$$,(fGpo@6F0E@M_zRsg?fWfId^P6p2AtpL=","SaveState_mp2/M06_ShootingGallery/1":"ZNCA8Mv,&4k-twmKWra-Q9IF;0;D1VAAFYNUQT$kf&}}Jz:T1j(+Mvj8}|j9P?5Tl3LLi(pL=","SaveState_mp2/mp2/Metroid1.pak/1":"ZNCA8ci2}ziwT!qiT;GD-/^kJ$)53gAAFhRnQ5mpiOV8tdZiGA$eaz0N@mFf$QU6sL5M({1kCQ~AAAAA=","SaveState_mp2/mp2/Metroid1.pak/2":"ZNCA87[Tc)EH)/rO]@8TsSI9fl4OydAAAVqqsV@6+N~VAg+D*BFSc]mOq0K?4WU+fISQYJAAAGGBbeE(=","SaveState_mp2/mp2/Metroid1.pak/3":"ZNCA8q5;rPXcc{!m0^yC0nkLDfLRWMAO0Sfkac^piP@p-BBKL:)n[lyhI5cG,82,h@HVHeAAAAAAAAEK=","SaveState_mp2/mp2/Metroid1.pak/4":"ZNCA8G~H&iX],,me=cR$*1wsSoC&5vAAI4,a$9}aSxN$(v4kBS{d/Rqlf4zNk+8+CF@dFuAAAAIH@s+|=","SaveState_mp2/mp2/Metroid2.pak/1":"ZNCA8:opLmFXSQt-CiQ_]7gZ6=yty!AAJAh${t*h,M|zV4ZDJ8jQ_diDO/,0;Xnk&a&*Dw}V)=","SaveState_mp2/mp2/Metroid2.pak/2":"ZNCA8dej?Y0w&aTNetQlY2=zzF?BHGAAD/5PyT-bls5=*EYJpn5Vu87HoUEVvgt=vBPcrr}V)=","SaveState_mp2/mp2/Metroid2.pak/3":"ZNCA8yBQw@fbungZ!R4k2^3HT=[BrKAAIfPnsj&wAS5g:RgskgKMXhlVCS?]ABHq{E@$te}V)=","SaveState_mp2/mp2/Metroid2.pak/4":"ZNCA8:mduNTwnMAv&gxQ8bm42]=AqEAAD/5TGD?*sL86EKXS[jbirZ6zmgDthP5Ixb&+)~AL*=","SaveState_mp2/mp2/Metroid3.pak/1":"ZNCA8Z4fA,_&Z~L/f3a:0S~1rlHSsUAN9YN]N9{:{$+edsP:hRHQ)eLlR|BbGb[Q,,jXJdULA5QAAAAAAA=","SaveState_mp2/mp2/Metroid3.pak/2":"ZNCA8zRe&L8ZHB6tgLVU498DzQgzOSAN54{?k!81[NET5S;bHF-Zr-Hx;zhYL0Bmp{eQg@ULA5QAAAAAAA=","SaveState_mp2/mp2/Metroid3.pak/3":"ZNCA895$KaK*1hCuzl65[pRUVtahV,AX&dT@&&@V*I&oY={7~ojmdC=l2=yJlPI):)|TebULA5QAAAAAAA=","SaveState_mp2/mp2/Metroid3.pak/4":"ZNCA8ao+EmMh/Rr1Eh!jan4*iDC@HJAG$4RtX~cukT49IBRhzLx{QQBS_vsKx}$K2T$a}-ULA5QAAAAAAA=","SaveState_mp2/mp2/Metroid3.pak/5":"ZNCA8iuW:NtBmq$piMS;WKm9Q~N8byAAHbdIw&wyw-83u80[?G6tO?!OLxHj?y7~{m8g3NAAAAAA4e5=8I=","SaveState_mp2/mp2/Metroid3.pak/6":"ZNCA8@N=5jUUf!ZL3oInyY4}:!Kd@fAN81lN4bKVh4[o;5(ntCi/o^jv;-tZzC3p/;chC*AAAAAA4e5=8I=","SaveState_mp2/mp2/Metroid3.pak/7":"ZNCA8yLmMXa:@Fb87[5s3;xa4kVCHpAN+mux6FT-W0gUgIEv6$XA|@@yDT{~DS|~efNcf;AAAAAA4e5=8I=","SaveState_mp2/mp2/Metroid3.pak/8":"ZNCA8HhMV_k[a{EIE[Qpmc2PM(W(DZAAIU1/aypI+X56if/@o,]Kx^3C]0b7/}O;9vvn8lAAAA:seA11AA=","SaveState_mp2/mp2/Metroid3.pak/9":"ZNCA8H|/!fXE0B7+~3k!Uv:98VhF|EAAELX,+d?v[$;hBxe9bOphrdlP)(TOQnVy&kfyl-AAAA:seA11AA=","SaveState_mp2/mp2/Metroid4.pak/1":"ZNCA8N7j*}4EppU5cmd}sX}$K)_UhOAAEz)NA)dKhOjFDKbju[8rEE8u-@e+7wqyPM{D]R{GSr4AAAAAAA=","SaveState_mp2/mp2/Metroid4.pak/2":"ZNCA8*sQdM0/0O,r|}BVc+*^]55~q/AACpU(*:EC!$3Uk&u&iAFA?SB?[Q/w@0bd$n/H^L{GSr4AAAAAAA=","SaveState_mp2/mp2/Metroid4.pak/3":"ZNCA8r^_cF?!hL50HWp$@=:WJQhQf!AAAwykrH(X55qFN]r1q7lZ(!-jFch56dWF9W/@XhAAyk2t{zN6AA=","SaveState_mp2/mp2/Metroid4.pak/4":"ZNCA8c=)nQ?B@z}gI2CFk;bO92B77:AAERa;ul}ue?@iBuL;AhG9Kib*0d6TjRa8ZslTj8AAyk2t{zN6AA=","SaveState_mp2/mp2/Metroid4.pak/5":"ZNCA8xJjoA(HNd*Sl=[Zdw)26hGz]!AAB7{-A,iDBdGTOK{UL-Go~z,fSmV16tG=7:LjX{AAyk2t{zN6AA=","SaveState_mp2/mp2/Metroid4.pak/6":"ZNCA8@ktjnNbhs(LY6l3+~an,bs[)YAAITKXAFP-$hUIIjB^g&zS7V1ud_f}_XLH9zfN$sAAAAAAAALgKY=","SaveState_mp2/mp2/Metroid4.pak/7":"ZNCA8hLpMsrU/L:4SoxuD*Ee_DT:([AAG;2:S}nNJ7e|o-y,K1KMS;i;&-gQrBG|y1cIC=AAAAAAAALgKY=","SaveState_mp2/mp2/Metroid4.pak/8":"ZNCA8bpy}&hA]OHux9zO]a)kp{;WI+AN9Hy!i{7@)A]iUG}UM_3@^Z1LA24E5!9:Tf(Lb0AAAAAAD2}xcY=","SaveState_mp2/mp2/Metroid4.pak/9":"ZNCA8*?JP,}A*mf(t}BP8+IDV-L=A&AAG}S*FBzm_QJozo;S23&HNdA1(|fc9QHjUm],mYAAAAAAD2}xcY=","SaveState_mp2/mp2/Metroid5.pak/1":"ZNCA8+Yq*],RE5P~U1*o1iUmO0:Fw6AN64Z1Swh!Iodw]U)oC6Zem5&m1D|sfgS([LUrN-{1^(^AAAAAAA=","SaveState_mp2/mp2/Metroid5.pak/2":"ZNCA8!-_LOCV&uBQ,B@?88O;E$b80XAAECVLjHjP_~vX{-z=V$n}57VJ5XW}R]:(Y6PRBo{1^(^AAAAAAA=","SaveState_mp2/mp2/Metroid5.pak/3":"ZNCA8[FqZ5x?&06=&n1d2rvDkS_/naAAEvhvBP},AcgM1$+xg?b]JzPV*K5BP49Hgz&Sk_{1^(^AAAAAAA=","SaveState_mp2/mp2/Metroid5.pak/4":"ZNCA8slU^;kmyVSDixJ@];Jv2p+of*AAGV|dbEG{jF1*M1x{mX9)_a^Cm(OpP-HGT;1WjpAAAAACw(48Uw=","SaveState_mp2/mp2/Metroid5.pak/5":"ZNCA8Na&DWJV/JCsvkJ({jCU_H$h5[AACAwDW/e,eb+_esf/GN)GS5jXdNwp&X/Dix7C@=AAAAACw(48Uw=","SaveState_mp2/mp2/Metroid5.pak/6":"ZNCA8ww|5_Q~}2d2sBnAlPOn2dx;~@AAIs9m[t)Rf3cE^Nb;sDE3RUjWqS;QbkX2y*mk9AAAAAAAG[iZzk=","SaveState_mp2/mp2/Metroid5.pak/7":"ZNCA8HjeHK~2}?2VWl!3d=bBHi@(+[AG]LuRV?n!TJKQ8eHTOp=Gx{^?5Haw&h9WRH{diwAAAAAAG[iZzk=","SaveState_mp2/mp2/Metroid5.pak/8":"ZNCA87gxzGAq);y8|/48xi{R1=UXDRAAAB&K^|DX=GwKfB;W1dw|!nRKZ~fHw)@Wk:TAa3AAAAAAG[iZzk=","SaveState_mp2/mp2/Metroid5.pak/9":"ZNCA8?VC$T8WAm?M~dsAX,GNX5DM$qAADWp7Cl0Ze|-0l2xT_8pUoKowa)cZ6^}Z}ZdQ^sAAAAAAG[iZzk=","SaveState_mp3/01a_GFShip_#SERIAL#/1":"ZNCA8qK8N{7a7J_;RKCY]v|Ffv4r1+AAFi7Uw5lBwRyDvyYVS{b$v2|+lKxfHBG533[LMkQPW-n=","SaveState_mp3/01a_GFShip_#SERIAL#/2":"ZNCA8r_8^iL)BamY8Td9]_wZcNvxBFAADKlb]6YdLrMw4)^)Rit+s{LOw8Ib/y5TPWe+HkQPW-n=","SaveState_mp3/01a_GFShip_#SERIAL#/3":"ZNCA81F0uqJuJun=ok_NPp&V&y,*-HAAAkvd7p0u&/hd48z{Ew;8tdJdwAJ_l5onIWR^T$QPW-n=","SaveState_mp3/01a_GFShip_#SERIAL#/4":"ZNCA87M}wxaR9j}:bl*e({ks0aUwQ~AAH&De*U5Q$q[Ri;gy},RNsLCm$-+;8Y7icsB3GqQWIU/=","SaveState_mp3/01a_GFShip_#SERIAL#/5":"ZNCA8BXA3LQwI}8KIR?QjI5,J2F0b_AAHf]{(Xg]24,/g1SMh}9o[)?,H13P?&PzYS)dRRQPW-n=","SaveState_mp3/01a_GFShip_#SERIAL#/6":"ZNCA87~=c!3s(bnbEnw+f7(KAryGTZAAB_^p+@[eakjz1Rw_hilf1h0?[CB368-:aWd+C7QyW&)=","SaveState_mp3/01a_GFShip_#SERIAL#/7":"ZNCA8l1nX}KYxXQ1oLsB?YZEL/Lb!;AUvdHn1g(x54d-?jU|,kIre1h145=jEF78@6anfdQXAdk=","SaveState_mp3/01a_GFShip_#SERIAL#/8":"ZNCA8S{ilAG)s*a/tcC]29e5^8KU8lAAEvhq?!@1SOSdz-;h{*Zx?suR:HF+sJ|Z2SB3btAAAGC=","SaveState_mp3/01a_GFShip_#SERIAL#/9":"ZNCA82;{bAD)@c:S^=JEZ~iMHoTA=ZAAFtUQ5t0hRrZho]EacBa0XhNEq6z=9*/Qcnz!laAAAGC=","SaveState_mp3/01b_GFPlanet_#SERIAL#/1":"ZNCA878mHqj]RS0W*c2(ZEi+a)/kauAAE?rQNDWt(!c_Q/=@VX:yJbq)B)Shx3U],~^Z_kpL~w=","SaveState_mp3/01b_GFPlanet_#SERIAL#/2":"ZNCA8AzBO0JR$j+:m6CoC(a3ZE02ayAN9r+vNU}Jp)CZC++IA4j=$Om{r0m72o&8*)?,[)ooTt=","SaveState_mp3/01b_GFPlanet_#SERIAL#/3":"ZNCA8b-^sP~,r_~N/$bQ@w^5EP]s8XAABm$c*C/j16usNZ+Ax*ns{eNZV1[!hw-@p&DwtcooTt=","SaveState_mp3/01b_GFPlanet_#SERIAL#/4":"ZNCA8$W6)7u0DsF)A9nW?oQzh6JB1CAAD$81ae4,ySBmq!TcB_xAk$eibKYJk,5/{Jh$eZooTt=","SaveState_mp3/01b_GFPlanet_#SERIAL#/5":"ZNCA86Y}mY8*nl7?^N8R(F[yOVyC07AAC2:,)kTnzx2l(0385czWGdnXT4)MCaNBR)iw(TooTt=","SaveState_mp3/01b_GFPlanet_#SERIAL#/6":"ZNCA8Ex9;A8U*!I-N*pHa{K8h-B*ppAAEjgFy,jv,0-k;dhrSd4BwfewN1G6O^=e*qZF3zAASM=","SaveState_mp3/01b_GFPlanet_#SERIAL#/7":"ZNCA8N?{x;lAyAHf?suC2VF;?rEvR3AAG;2H+H:0[MOh?1c_G839eDSw[2uZw]/HQ&I4JpAACW=","SaveState_mp3/01b_GFPlanet_#SERIAL#/8":"ZNCA8E_IB8c)pMj&Smv~Ny)j,lK-8-AAI-bxvqTytK@9k3I&sUhGz:/f-wp,=a25riQAckAB8L=","SaveState_mp3/01b_GFPlanet_#SERIAL#/9":"ZNCA8KZFwun]J&hS;KenwOsV|a&AWxAAGjur7L)30;=]S:Af[iDM2H2wj@*dh$3Irp58P(AAAS=","SaveState_mp3/01c_Abandoned_#SERIAL#/1":"ZNCA8dQtZam_o6ho8vVZut1}_bfy+tADnt8t@/MOvZgkF,:N5/_xF17G;/JPzUxYWob_Vo(WM~=","SaveState_mp3/01c_Abandoned_#SERIAL#/2":"ZNCA87zouZGx2{)tAytMhX?cI/p3|ZAG&U!YGQ0~;!+En@w6k]F^rO&U&9^kUE:)PCCvQ+(WM~=","SaveState_mp3/01c_Abandoned_#SERIAL#/3":"ZNCA853AkBcNql3b7{(Ek[tY2iq$/yAAE1m-[O5$u[fy?{}_]fe9B741t,|uUGxL&_9WWjUwb|=","SaveState_mp3/01c_Abandoned_#SERIAL#/4":"ZNCA8vlRdfbnj5_R4Q[sRfp,=x1,c{AACAx=(?_W,-k$cD7/!RY+6/Ybi5QX$e1Q*O8SJJKYKy=","SaveState_mp3/01c_Abandoned_#SERIAL#/5":"ZNCA8nCt-0O-Ir-ud=AP@nPN}mydgdAABNXljMN/{Dxi,BiUQ{VZeZaF!Fpean[nthMvv:KYKy=","SaveState_mp3/01c_Abandoned_#SERIAL#/6":"ZNCA86_*M3pgBze82kV;nR&$qe*b(LAAD(QeR(ich_d|5j[3^;+5Q3]:^oXZB?:v&!js!&KYKy=","SaveState_mp3/01c_Abandoned_#SERIAL#/7":"ZNCA8oGSwiaS/YMF[28vDeho~6I~g:AAG;2HJ&O[Rqbr{[9$(v1[_rymW=Ya_f~=}Sj_imKYKy=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/1":"ZNCA86(mT1=$ygS9+TBa+GXAzFjzMQAAH~q0mfP7kmW]JPaCfUO*[owPAe(!+s?]Zm9=bHulxbRAA=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/2":"ZNCA8/K|w3H=7BdD0R={cck:yN9+tOAAFu=h0S}Om85;nI-8~1yyW:80emhZ8c=iGbFlz!ulxbRAA=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/3":"ZNCA8Sx8~2l-wS-Z_qL/&m4EI8xTb4AAIy-]wi*0,lJ:bN:{Y9pX:S2o*^+7}W7o;c^}TSulxbRAA=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/4":"ZNCA84*7cTE0kaxRNzc$RoDdq5fyGHAAG$QUrvAlHp+&S&CjEM]&g@!gtDpskJem6b]$u{[3nZ{AA=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/5":"ZNCA8lY3]B?QrIdLXBVl_@bJ![/vb=AADitZ)T@GL/=pxk/*7p7WD:r_HnyJHsNpq1x^2e[3nZ{AA=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/6":"ZNCA88+Bb4kmX3!9M7&-K299B~NyZWAAG;24I&C*B|*d~Y!AyhF=2}3Z;jV9/[!!XQNlBX[3nZ{AA=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/7":"ZNCA8:jE|d)xu9,ez-6/S239)jt(HzAAA^+4|z3Sk_0@GoX!4EmM!_V]Mlfe2|f_Un:FyOEV}$&BY=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/8":"ZNCA8{8Sgb]:XkslcDhci[QnSkMtacAAH*D1X6:mD2~dv[2SEm3}_y7P0{yYF$:[bYzek}EV}$&BY=","SaveState_mp3/03a_Bryyo_Reptilicus_#SERIAL#/9":"ZNCA8IBG);obe1{nS(J_oE-GlA:kk:AAC,?k7a[KO5vxO@SxMI6$=?v12HW9/65isAU6FsAAE5HAA=","SaveState_mp3/03c_Bryyo_Ice_#SERIAL#/1":"ZNCA8x$ncRgc5qQLVIKX5e$gEQ0mbgAAG*93@&r@g[:9]049g-k6jy;C)!GH;Dj,=!SuGB)8=","SaveState_mp3/03c_Bryyo_Ice_#SERIAL#/2":"ZNCA8CO~-^k~VvwjA}+y13X[o0[_yTAABj]s$x}^D8ERV-2=8R~OyWkr7^XKNY{qNK03wC)8=","SaveState_mp3/03d_Bryyo_Seed_#SERIAL#/1":"ZNCA89$$&:SSWRYK~q{zZV?V85167~AN9Z4jP)x&zVTG{7}FU!jdPv-@3pMM47yM@_VM[$&L=","SaveState_mp3/03d_Bryyo_Seed_#SERIAL#/2":"ZNCA8;z]+3oca@)Z~4~yWok(X5X=$!AAA[7,t&|-N(C|J{x,IJLIhHQ[)j(hyVex]GiucX&L=","SaveState_mp3/03d_Bryyo_Seed_#SERIAL#/3":"ZNCA8yu!rnEWA5wBv79ksuCFinhfy8AUrMQZ5:M@bkyelr=C:C6FByx!LrVmbEi9N4y{;j&L=","SaveState_mp3/04a_Skytown_Main_#SERIAL#/1":"ZNCA8Q=|$vhO+_V[&9Ve9X}ExT6nJ:AAF5Xe4K6t]U(d_BhtYHr}Ew/a)?gxu*hzZOQ;nv98TeWAA=","SaveState_mp3/04a_Skytown_Main_#SERIAL#/2":"ZNCA8UU3vX-Vo~9$^Q-cwv@/|O,[R)AAHN_H)Xewy61Y01IM6?{iR~R81&T8E7N61/BbQe98TeWAA=","SaveState_mp3/04a_Skytown_Main_#SERIAL#/3":"ZNCA8{?8M1PQ51/9U15}i7Hi~jog:qAAFl92kl3VqHYub:Y(cNtD1nbjryhkphypaxN1){9kV;+AA=","SaveState_mp3/04a_Skytown_Main_#SERIAL#/4":"ZNCA8d{jxvL+D-|Rw_bcEG{s[B6PhUAAF}!/5t^rKr+jY)^~::AJ{WTO9G-Aw(wGr7&^qIAAABbpL=","SaveState_mp3/04a_Skytown_Main_#SERIAL#/5":"ZNCA8qcjT6:x:^-9b$_Qv]Nb(2*TvHAAEvh+h3u)OgyOntg/v^TrKH=eG//dvH:j7*uabdAAAAoAA=","SaveState_mp3/04a_Skytown_Main_#SERIAL#/6":"ZNCA8-m/xBg9|k3[;tx3*iZHQq-K/CAAA|UF0y$[zpyI8DV9e0uA[0k]^3n)0y1q,9~MK3AABLgAA=","SaveState_mp3/04a_Skytown_Main_#SERIAL#/7":"ZNCA8HO4tUVsC8gCA+~hoj11?p??X+AN+aqQci1YAj/2}SWN-(E3-)S8P}yC78GDT*$zLWAAAACAA=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/1":"ZNCA8MOhOJaq_a[mUsvMixVn-&ok/7AAITJHz{VvCo:g[ZYKQ1jz}x((8oKJ9,TyjPpFjx98TeW=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/2":"ZNCA8jR~VEEvQ}um$YM?m8=+)+s&8WAAF6,$d^=7R{K$KPwSKeDpULb?uTFs])4t6O7gLtn[uMn=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/3":"ZNCA8ZjcxZI$;(*C7DMWmGoZ24e{*sAAA*TLWy{=!DDd*wRZ1rQ*:gUqeIPqMycumpHiWOA22SC=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/4":"ZNCA8@hEvU@{y~MUXi/(=1Jwu0XVgzAG!&{Qw6Fsq}GF@oQp=9EwW237Q0]{kV7akK+fW+A2kGA=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/5":"ZNCA8HBA$@G&W4}fBN2ORPsM|hMENgAAAAg5:TB=6R)pzJbwoS)|W@{Rn&4ktllXB1wg:)A2kGA=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/6":"ZNCA8,M61JIXiR1,(D@oc;RN^T:axJAAA[84og:gaPwmTPGvoV)$x)f$I[dhD:JYsOv~7eFMa+P=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/7":"ZNCA8K2?@BcPnLqZ]4BSj4[w7Pkm8sAG/2SXij{u9N^0PqN]KbiHhui+uNp?(*m)QBB@PwFMRgG=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/8":"ZNCA8j$/~8@2afC=K}^/aNi28b45SVAN-Iy$fg7]HyF^bT6m8KUb9Lw-{:u)xS_h/=rjwpFMRgG=","SaveState_mp3/04b_Skytown_Pod_#SERIAL#/9":"ZNCA8fkY5,SDl@20~DV;rABiB{q(8XAADkCY~xy:?Fd~npXlU8ANX@Fz9ShK/GcPT))MIsAAAAg=","SaveState_mp3/04c_Skytown_Seed_#SERIAL#/1":"ZNCA8*,vHVS9xd@bg_[Rb(kWLiK/m@AUvw5(_=Pic@GqX&@)QcEivtY5FK[RG$TACB-t+3&L=","SaveState_mp3/04c_Skytown_Seed_#SERIAL#/2":"ZNCA8n[UV9?L;QFU^PrHdCKGfVCB7SAG$LDh2nyn-mgS1-@Kgl*rEda!oAR14Y$;)~WgH8&L=","SaveState_mp3/04c_Skytown_Seed_#SERIAL#/3":"ZNCA8S$YAjr7b_&xdMUzgq[_gJ0^RMAX{_7[)H|2l}-]_E$gEt3Udt(MdgcsG;jiQHw(mA&L=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/1":"ZNCA8Cx|DQh!;fQ2SaNi5A]JX-|;Z7AAHf?+TC3Vmhxo6?!+$zQPP^QF!a6(ciL]5fH&IM9/D=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/2":"ZNCA88=j7YO7^S;L9vvX=h*s2mN/NLAN7Zr2!YbrdDA9pE[:ok65Xh!;C@QWZ48yoM$fz;9/D=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/3":"ZNCA8/k9nHG+lBh7[,ei=Yqf|I(515AKZp0lO}-y;aRoW_C)QRoL:Wvy1I}YL$^c[lqg[;9/D=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/4":"ZNCA8{x,5$4)QKC9nA~M?ufVyDe:QvAN+]Op^cI+/d^Y}kwh^yC[;2j3)|c!RBIV*]l|B4M8E=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/5":"ZNCA8?H}6z_C=O?~XKeNg*qA0]m@{9AABm$)asmk=U2AlXxRpZ63fKAg0uCRHPvN9iFOl4M8E=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/6":"ZNCA8CtZdMY&!GtwV/u-m6Io3iudybAAEt&&kvn;_Y]@_E&$*6P_Lpjvg!0nge;sZZO@GKM8E=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/7":"ZNCA81/cK[0{Jju]K|~e8N$lFnI_TcAABEW3fo+HiG]X]n(sjrEF:a&@=iGw(7Pv-u?A2@M8E=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/8":"ZNCA8mB6,,S3~3,amT3XsPEYTT3[~;AAD^TPo+bT8$A0iQlm{WtM-Y&aluA~JwsywSTQB|Cwu=","SaveState_mp3/05a_Pirate_Research_#SERIAL#/9":"ZNCA8i=;9P-=HT(jsjQzLbDKom9Q[MAX{D{,plBW+I~f)a2FRJe;d[wy*2;B,fg]N?/9FfAAS=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/1":"ZNCA8zLTf{&X*m]IQCwD45?[LM$3d7AAITL?bqmxvZA*JqbU}LEO*A1]=$PKXb,@V&Z13{,[dRc=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/2":"ZNCA84lsr9KlFitGj=RDG*G5;zsZn-AAE5}?@mt=;94A]swXOh2V/O6Q!s,JNtk!u[zd-O,[dRc=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/3":"ZNCA8Z5FSk)QNm&C_5/9KLY?7=ceB~AWRqL[{Ke@sEq?v2B:{vNCW!bj$FJSG@ZtVfGjC*,[dRc=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/4":"ZNCA8giN1xXvBDdM&]oe@Ve]4aARbJAAH*BtTccDZSl,jqwcK6z|MHl=SxbkUx?@t?|_&@M[_he=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/5":"ZNCA8m^?flKyFd&:{r:Z9C)E&rj*LqADq:,~IZH+_&ZL@d&M)GA0QYT-Xlorjcif:!}boyM[_he=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/6":"ZNCA8qC|4}N398^;w*eD,h[)&~lY]4AAE2*vC:C{VRPyKxKscHQ:Vfw,QB]^vuW_tU1YT3CtV;0=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/7":"ZNCA8+ts,Mq:)?EDJi@x=L]D--cBX7AN-9ZL}!!g_F1R67Tn~]zGBdT0v2A_,[Wqd;m5I4CtadK=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/8":"ZNCA89A3?@*ylie5~a,-gH3L+s-ZbOAAGV}w|QvNH?d({&EU@!eB^?&V|5II=&ai|0zZo=ABe3i=","SaveState_mp3/05b_Pirate_Command_#SERIAL#/9":"ZNCA8cgM+LCEG46(4ZC8cmjKYWA:bpAAIxV/jmhHZMgdXJtjQ/y&JQT*k+:LY9_RP-0_WYABe3i=","SaveState_mp3/05c_Pirate_Mines_#SERIAL#/1":"ZNCA8_w^=]GHD8HKgAM4U21gAZ-7o)AAHtiOj44atIs5A-zjnM0uLyoDy9yx@e~O$02X@f}Q;=","SaveState_mp3/05c_Pirate_Mines_#SERIAL#/2":"ZNCA8VCdNkE~pxz&!es[B/bP,$6=98AABs(G:N(?c0C-M+riHvDgJ0?+m~uNMpQlkGXV{-}Q;=","SaveState_mp3/05c_Pirate_Mines_#SERIAL#/3":"ZNCA8wrAP)vZ;Tol!9|Ug7)-p5Z@OUAAEV~IaYxI@bGLXyw5tdNLxbz?1Unt[dA+I{LSSW}Q;=","SaveState_mp3/05c_Pirate_Mines_#SERIAL#/4":"ZNCA8i:$Fr[0pXP@:!$d*+)/0d_Gk+AADov1*^@;s=y3Z05T?7ijPDAp68*/Ua-;F[jd1F}Q;=","SaveState_mp3/05d_Pirate_Seed_#SERIAL#/1":"ZNCA8-6VyQQwdA@~{??pnNt|r?KXrCAAAAAtgm^o;,MiqiSpHhwFw_pXl!R9bka3z-4Cpc&L=","SaveState_mp3/05d_Pirate_Seed_#SERIAL#/2":"ZNCA86GiYXE:CAC0Ort)$XndYV9~C9AABL,gLHlY_&aD7E4XAG7ds-PR9DU0opB-p7@xkX&L=","SaveState_mp3/05d_Pirate_Seed_#SERIAL#/3":"ZNCA8@-{y8pZRbBOc2=x$I,;Ei$!+aAAFKx,F$qeZtHIUi|T5-{dkR7]c}{x;pbD;H[5c/&L=","SaveState_GrandTheftAuto3/0/1":"AANt=gUozw=UA+;O969u/=a~&ELur&gUmSB3T{a20WKx,BUqhnr9S5c=Ufl{eV[","SaveState_GrandTheftAutoViceCity/0/1":"AAC~m,Uq}*eT})W@9t10z=a~$c0tP91Uu7b]T{jrPWHWFOUm3[@9bI[uUVZ*VV[","SaveState_GrandTheftAutoViceCity/1/1":"AAS0sl9WedT8[J8@Uc3sD+^va@L+=0xUbM)(UHyg?VC4r=94uxAT7ofI9d;8-Vt","SaveState_GrandTheftAutoViceCity/2/1":"AANjFw88,C=8*^$DUdSiS+^tE~0?snRUcanmT-xTmU|in)9uDrpS87l:8v?s|+5","SaveState_GrandTheftAutoViceCity/3/1":"AAKc|xUn@^5T)GWy9xZN;+5US80=A84Ue9o}UOEVDU{TzvUkw+o9g]AhUr(KN+^","SaveState_GrandTheftAutoViceCity/4/1":"AAFyQS8?NL|UNHbZ97_-HV[6Ui0wWS5UrGSjUDBYdVF=}YUh;A+TN+588&_H9Vt","SaveState_GrandTheftAutoViceCity/5/1":"AAKG5&9Z4+FUG8XB91w&4+^q;o0fh93Uf6(kUTg_uU|db}UcRD/T39ez9ai@zVS","SaveState_GrandTheftAutoViceCity/6/1":"AAQ@;C9L{jOUIRHL9y3~M+^q;f06d3eUd20sUKA-JU&@+5UuD}=T:g@B9O}yLVt","SaveState_GrandTheftAutoViceCity/7/1":"AABx,6T/I+Q9O[/OUj8f2+^vdF006:4Ub}lDUI*xFVFMIE9p]x084?FoT$-dy+^","SaveState_GrandTheftAutoViceCity/8/1":"AAF?KcS^*~}T}lq=9j86(V[+_;0&1inUc~btUK^4?VEO=9Unw(j8A7,{TRPw=+^","SaveState_GrandTheftAutoViceCity/9/1":"AASmAGUs$!+9YTN=Uj0smV[6R^Li;(]Upa2|T^WsxVMite9kE^_9Qv+NUY|Xx+^","SaveState_GrandTheftAutoViceCity/10/1":"AAUL6ZUnYFu9azEdUk*@QV[6Sf0zocXUe2=AUTFsrVC)qp9sG=79M~sIUhMGZ+^","SaveState_GrandTheftAutoViceCity/11/a/1":"AAad$79gB}b9Od&uUmi{s+^q:$LnH{(Uf:[jUTQTdU*R*h9mgr6T2BZ*9U2AHU!","SaveState_GrandTheftAutoViceCity/11/b/1":"AAP;Zl8w~9@8@Jr4Ueu$OV[+,KLusEtUmcx{T3wx)VEp=69hJkfS!~A587nb^+^","SaveState_GrandTheftAutoViceCity/12/a/1":"AAEbRgUnf=58p=dNUDCI4+5P8S0$:w*UV|x4UT)QTU^qt/9ZjMh9Nzy&Ut2)JVt","SaveState_GrandTheftAutoViceCity/12/b/1":"AAYsQpUW,vdTnJdl9L=CIVtfLE0Z}JlUa2JrUUE+{VHm*AUG-Wj9Y;tBUj3U{+^","SaveState_GrandTheftAutoViceCity/14/1":"AAC[vCUtUC=TGRjd8(J=cV[6TKLkcxNUrGSjURGCLVxtA}T9e1z9Qn?9Uj;/B+^","SaveState_GrandTheftAutoViceCity/15/1":"AAN3A3UXIhJ8VbnLTifzFV[6TqLE)H=Ud,YYT}8AjV+Q-684oh+9ZacQUb,hg+^","SaveState_GrandTheftAutoViceCity/16/1":"AASu7AUqutB8Qf_&T[RJKV[6Ta0X10rUb[6kUS1n&V9ZK38-D@[9JUu=UWhMU+^","SaveState_GrandTheftAutoViceCity/17/1":"AADd=;Uv1h?T5,e39Pzbp+d]y(LrH6,UiIbBUTy+0U^G?[UJhi39TM(TUmQTTVt","SaveState_GrandTheftAutoViceCity/18/1":"AALh_6UrD_RT26F}9jh;O+5P7T0z)XUUkG_*UJf6TVPLn7UaY[Z9LGpDUljjF+^","SaveState_GrandTheftAutoSanAndreas/0/1":"AAUnnJUnmqzUB-n497V$;+^q;406^MXUdQWyT|AvtVz!svUhHN_9di}{Uuq-uWP","SaveState_GrandTheftAutoSanAndreas/1/abatoir/1":"AAIn]?SbPD5AbbHqUc]bOWPAa~AAABrUVH5=AS4rTWPAZZ9g&VVAIn]?Se8U5V[","SaveState_GrandTheftAutoSanAndreas/1/ammun1/1":"AAY=l17,a9QAZq!Z944N^+d]wYAAABrUVH5=pj!hSWNQIIUVH5=AY=l17;U6aVt","SaveState_GrandTheftAutoSanAndreas/1/carmod1/1":"AAAABrUVH5=AAAAAAI/eK9g&VVAAABrUVH5=ADU8|V[6R;AAAAAAAABrUdm5KV[","SaveState_GrandTheftAutoSanAndreas/1/fdrest1/1":"AAAABrUVH5=AAAAAAA:pJ+CunXAAABrUVH5=AZK2tV[6R;AAAAAAAABrUo=(ZVt","SaveState_GrandTheftAutoSanAndreas/1/gf1/1":"AAbI*o9g&VVAIn[cS81@7VtfI:pL~yBUVH5=AG/NEV{NFL7,a9QAbI*o9t]uXVt","SaveState_GrandTheftAutoSanAndreas/1/jetint/1":"AAAABrUVH5=AAAAAAYN7*VSD^,AAABrUVH5=AK!+LV[6R;AAAAAAAABrUW3gHUw","SaveState_GrandTheftAutoSanAndreas/1/jump1/1":"AAbI*o9g&VVAIn[cS~;cHV[6R;pL~yBUVH5=AFpLfV{NFL7,a9QAbI*o9yogOWP","SaveState_GrandTheftAutoSanAndreas/1/jump2/1":"AAbI*o9g&VVAIn[cS!eh&V[6R;pL~yBUVH5=AFpLfV{NFL7,a9QAbI*o9uIo6WP","SaveState_GrandTheftAutoSanAndreas/1/lacs1/1":"AAIn]?SbPD5AbbHq9m^Ay+d]wYAAABrUVH5=AQhWDWPAZZUVH5=AIn]?Sf[MiVt","SaveState_GrandTheftAutoSanAndreas/1/lahs1b/1":"AAIn]?SbPD5AbbHq9p5pxV[6R;AAABrUVH5=AQe^lWPAZZUVH5=AIn]?SilV9Vt","SaveState_GrandTheftAutoSanAndreas/1/mafcas/1":"AAIn]?SbPD5AbbHqUe^/]V[6R;AAABrUVH5=AZPPFWPAZZ9g&VVAIn]?Sqq-dWP","SaveState_GrandTheftAutoSanAndreas/1/mafcas2/1":"AAbI*o9g&VVAIn[cS[IX[V[6R;pL~yBUVH5=APbyHV{NFL7,a9QAbI*o93)3bWP","SaveState_GrandTheftAutoSanAndreas/1/smashtv/1":"AALF1iUVH5=ABYtjUY7aT9g&VVAAABrUVH5=ABbc+V]}=S9g&VVALF1iUiX3AV[","SaveState_GrandTheftAutoSanAndreas/1/svvgho1/1":"AAAABrUVH5=AAAAAAH+}D+^q,aAAABrUVH5=AW|+UV[6R;AAAAAAAABrUm3IhWP","SaveState_GrandTheftAutoSanAndreas/1/sweets/1":"AAUWni9g&VVAACoy88E@|+^q,aAAABrUVH5=pW8BWV[86hTYLe8AUWni9q~*hWP","SaveState_GrandTheftAutoSanAndreas/1/tsdiner/1":"AAIn]?SbPD5AbbHqUeJ]J+5P5ZAAABrUVH5=ALJx|+d]u_9g&VVAIn]?SmIyoV[","SaveState_GrandTheftAutoSanAndreas/1/wuzibet/1":"AAV,cjTYLe8AP$OKUg}lhV[6R;AAABrUVH5=ABLetWDxf(9g&VVAV,cjTmkIJ=a","SaveState_GrandTheftAutoSanAndreas/2/barbers/1":"AAIn]?SbPD5AbbHq9r?7]+CunXAAABrUVH5=AQhWDWPAZZUVH5=AIn]?Se,_(Vt","SaveState_GrandTheftAutoSanAndreas/2/bdups1/1":"AAIn]?SbPD5AbbHq95;Yx+d]wYAAABrUVH5=AS2;2WPAZZUVH5=AIn]?Sj}?QV[","SaveState_GrandTheftAutoSanAndreas/2/carmod2/1":"AAAABrUVH5=AAAAAAH=~q+d]wYAAABrUVH5=AIGUXV[6R;AAAAAAAABrUYRq|V[","SaveState_GrandTheftAutoSanAndreas/2/carter/1":"AAbI*o9g&VVAIn[cS6}8*+^q,apL~yBUVH5=AL}~mV{NFL7,a9QAbI*o9wXTTWP","SaveState_GrandTheftAutoSanAndreas/2/gf2/1":"AAG=E)UVH5=AIZ=&Utv+PVtfI:AAABrUVH5=AHV3OV*|{89g&VVAG=E)Uc@cBVt","SaveState_GrandTheftAutoSanAndreas/2/lahs1a/1":"AAAABrUVH5=AAAAAAAAB/V[6R;AAABrUVH5=AADL1V[6R;AAAAAAAABrUq/!uVt","SaveState_GrandTheftAutoSanAndreas/2/lastrip/1":"AAIn]?SbPD5AbbHq9vng@+CunXAAABrUVH5=AEj=QWPAZZUVH5=AIn]?S0kPBV[","SaveState_GrandTheftAutoSanAndreas/2/ryders/1":"AAXVQ3UVH5=AL]?BT2:7x+^q,aAAABrUVH5=ABKrPV^vD~8=XDTAXVQ3Up$reWP","SaveState_GrandTheftAutoSanAndreas/2/svvgho2/1":"AAIn]?SbPD5AbbHq93*T)+^q,aAAABrUVH5=AL}~pWPAZZUVH5=AIn]?Snb96WP","SaveState_GrandTheftAutoSanAndreas/2/vghsb1/1":"AAC9nq8j*)SAJ(Uo9jEP8V[6R;AAABrUVH5=pOBzQV}zmXUVH5=AC9nq8mPU6Vt","SaveState_GrandTheftAutoSanAndreas/2/vghsb3/1":"AAIn]?SbPD5AbbHq9zqU&V[6R;AAABrUVH5=ACMqPWPAZZUVH5=AIn]?SxafRVt","SaveState_GrandTheftAutoSanAndreas/3/barber2/1":"AAIn]?SbPD5AbbHq9w+V_+d]wYAAABrUVH5=AXA^!WPAZZUVH5=AIn]?SrS0@Vt","SaveState_GrandTheftAutoSanAndreas/3/bdups/1":"AAIn]?SbPD5AbbHq9lH={+CunXAAABrUVH5=AS2;2WPAZZUVH5=AIn]?SlH-8V[","SaveState_GrandTheftAutoSanAndreas/3/bikesch/1":"AAMp2+7,a9QAa54k9laBWV[6R;AAABrUVH5=pZB*_WOe@TUVH5=AMp2+8CR;HV[","SaveState_GrandTheftAutoSanAndreas/3/brothl1/1":"AAIn]?SbPD5AbbHq9qH[C+CunXAAABrUVH5=AZK2tWPAZZUVH5=AIn]?SbjY3V[","SaveState_GrandTheftAutoSanAndreas/3/brothl2/1":"AAAABrUVH5=AAAAAAL)Z_+d]wYAAABrUVH5=AZK2tV[6R;AAAAAAAABrUsVV7V[","SaveState_GrandTheftAutoSanAndreas/3/carls/1":"AAMp2+7,a9QAa54kUp}Ff+^q,apL~yBUVH5=AK}~QWOe@T9g&VVAMp2+8DQS)WP","SaveState_GrandTheftAutoSanAndreas/3/carmod3/1":"AAAABrUVH5=AAAAAAKHAn+d]wYAAABrUVH5=ACRa0V[6R;AAAAAAAABrUdq2kV[","SaveState_GrandTheftAutoSanAndreas/3/cssprt/1":"AAIn]?SbPD5AbbHq9jK}C+5P5ZAAABrUVH5=ASwwxWPAZZUVH5=AIn]?Sda}AVt","SaveState_GrandTheftAutoSanAndreas/3/drives/1":"AAIn]?SbPD5AbbHq93TW!+d]wYAAABrUVH5=ARu]]WPAZZUVH5=AIn]?ScbW(+^","SaveState_GrandTheftAutoSanAndreas/3/drives2/1":"AAH-0}UVH5=AT9d~UoKyi+d]wYAAABrUVH5=AW^xqWHiv09g&VVAH-0}UhRLs+^","SaveState_GrandTheftAutoSanAndreas/3/genotb/1":"AAAABrUVH5=AAAAAAHHI7Uwi,-AAABrUVH5=AZIf:V[6R;AAAAAAAABrUgmZZV[","SaveState_GrandTheftAutoSanAndreas/3/gf3/1":"AAAABrUVH5=AAAAAAC4)OVtfI:AAABrUVH5=AI[bSV[6R;AAAAAAAABrUbUuEVt","SaveState_GrandTheftAutoSanAndreas/3/lahsb4/1":"AAIn]?SbPD5AbbHq9yphHV[6R;AAABrUVH5=ACMqPWPAZZUVH5=AIn]?Sz?d}Vt","SaveState_GrandTheftAutoSanAndreas/3/oglocs/1":"AAIn]?SbPD5AbbHq9l7qB+CunXAAABrUVH5=AW^]rWPAZZUVH5=AIn]?Skw](V[","SaveState_GrandTheftAutoSanAndreas/3/paper/1":"AAAABrUVH5=AAAAAACS9QVtfI:AAABrUVH5=AJ?-YV[6R;AAAAAAAABrUl^~QVt","SaveState_GrandTheftAutoSanAndreas/3/pdomes/1":"AAIn]?SbPD5AbbHqUn--_V[6R;AAABrUVH5=Aa^4IWPAZZ9g&VVAIn]?Sfx,u=a","SaveState_GrandTheftAutoSanAndreas/3/pdomes2/1":"AAIn]?SbPD5AbbHq9ldjtV[6R;AAABrUVH5=ATq:yWPAZZUVH5=AIn]?Sg8XT=a","SaveState_GrandTheftAutoSanAndreas/3/police3/1":"AAIn]?SbPD5AbbHq94a$eVtfI:AAABrUVH5=AZPPEWPAZZUVH5=AIn]?SovW{Vt","SaveState_GrandTheftAutoSanAndreas/3/police4/1":"AAIn]?SbPD5AbbHq9pmfqVtfI:AAABrUVH5=AQkH|WPAZZUVH5=AIn]?SoNzgVt","SaveState_GrandTheftAutoSanAndreas/3/s1test/1":"AAIn]?SbPD5AbbHq9t[KWV[6R;AAABrUVH5=AU-OiWPAZZUVH5=AIn]?SgCWx+5","SaveState_GrandTheftAutoSanAndreas/3/sexshop/1":"AAIn]?SbPD5AbbHq9mQvw+CunXAAABrUVH5=AYWHJWPAZZUVH5=AIn]?S0Jk9+d","SaveState_GrandTheftAutoSanAndreas/3/strip2/1":"AAMp2+7,a9QAa54kUV]}l+CunXpL~yBUVH5=AEj=QWOe@T9g&VVAMp2+7|]@iV[","SaveState_GrandTheftAutoSanAndreas/3/studio/1":"AAIn]?SbPD5AbbHq9y/hn9g&VVAAABrUVH5=AEj=QWPAZZUVH5=AIn]?SkBTzV[","SaveState_GrandTheftAutoSanAndreas/3/tatto3/1":"AAIn]?SbPD5AbbHq9ld6J+d]wYAAABrUVH5=AQihjWPAZZUVH5=AIn]?Ss90~+5","SaveState_GrandTheftAutoSanAndreas/4/ammun2/1":"AAY=l17,a9QAZq!Z9rE?2+d]wYAAABrUVH5=pmB+kWNQIIUVH5=AY=l17*~lNVt","SaveState_GrandTheftAutoSanAndreas/4/diner1/1":"AAAABrUVH5=AAAAAAK-[/+d]wYAAABrUVH5=AF4WTV[6R;AAAAAAAABrUq}2AVt","SaveState_GrandTheftAutoSanAndreas/4/dirbike/1":"AAQbT0UVH5=AEgn;UhkRM+^q,aAAABrUVH5=AJ~_+V&F5z9g&VVAQbT0UXUPX+^","SaveState_GrandTheftAutoSanAndreas/4/gf4/1":"AAIn]?SbPD5AbbHq9v,e+VtfI:AAABrUVH5=AG/NEWPAZZUVH5=AIn]?Sf_(TVt","SaveState_GrandTheftAutoSanAndreas/4/lahs2a/1":"AAIn]?SbPD5AbbHq9xkwiV[6R;AAABrUVH5=AV!rcWPAZZUVH5=AIn]?S1W=uVt","SaveState_GrandTheftAutoSanAndreas/4/lahss6/1":"AAIn]?SbPD5AbbHq9uLcMV[6R;AAABrUVH5=AaZI8WPAZZUVH5=AIn]?Sv?+DVt","SaveState_GrandTheftAutoSanAndreas/4/sfhsm2/1":"AAAABrUVH5=AAAAAAW*$$V[6R;AAABrUVH5=AQhuYV[6R;AAAAAAAABrUW0je+5","SaveState_GrandTheftAutoSanAndreas/4/x711s2/1":"AAIn]?SbPD5AbbHq9vT=U+CunXAAABrUVH5=AQcNeWPAZZUVH5=AIn]?SrdVr+C","SaveState_GrandTheftAutoSanAndreas/5/csdesgn/1":"AAAABrUVH5=AAAAAAC3Fr98TeWAAABrUVH5=ABMR8V[6R;AAAAAAAABrUcgNxVt","SaveState_GrandTheftAutoSanAndreas/5/diner2/1":"AAIn]?SbPD5AbbHq91+*-+d]wYAAABrUVH5=AJ0H+WPAZZUVH5=AIn]?S03AQVt","SaveState_GrandTheftAutoSanAndreas/5/fdpiza/1":"AAY=l17,a9QAZq!Z9y&BS+5P5ZAAABrUVH5=pRa?HWNQIIUVH5=AY=l17:/cGVt","SaveState_GrandTheftAutoSanAndreas/5/gang/1":"AAAABrUVH5=AAAAAAV*$W+^q,aAAABrUVH5=AFq/?V[6R;AAAAAAAABrUhU,|WP","SaveState_GrandTheftAutoSanAndreas/5/gf5/1":"AAIn]?SbPD5AbbHq91R*AVtfI:AAABrUVH5=AG/NEWPAZZUVH5=AIn]?SkxO$Vt","SaveState_GrandTheftAutoSanAndreas/5/gym1/1":"AAIn]?SbPD5AbbHq9uHz498TeWAAABrUVH5=AL_77WPAZZUVH5=AIn]?Sf_dCV[","SaveState_GrandTheftAutoSanAndreas/5/lacrak/1":"AAIn]?SbPD5AbbHq901ZgV[6R;AAABrUVH5=APbZ^WPAZZUVH5=AIn]?Sj{jeVt","SaveState_GrandTheftAutoSanAndreas/5/lahsb3/1":"AAbI*o9g&VVAIn[cS:3v4V[6R;pL~yBUVH5=AHzFIV{NFL7,a9QAbI*o9jll]Vt","SaveState_GrandTheftAutoSanAndreas/5/maddogs/1":"AACU[]9g&VVAPquu8^uFd+^q,aAAABrUVH5=pk{dxWDP-dTzmn9ACU[]9wWhlV[","SaveState_GrandTheftAutoSanAndreas/5/mddogs/1":"AARRE09FyMUAEJjp9viJH+^q,aAAABrUVH5=pQV+bV$:1YUVH5=ARRE09U!=|V[","SaveState_GrandTheftAutoSanAndreas/5/sfhsb1/1":"AAIn]?SbPD5AbbHq9q+@8V[6R;AAABrUVH5=AGwrCWPAZZUVH5=AIn]?Sf:zNVt","SaveState_GrandTheftAutoSanAndreas/5/svhot1/1":"AAIn]?SbPD5AbbHq9vKQ{+^q,aAAABrUVH5=AI:,/WPAZZUVH5=AIn]?SxKGEWP","SaveState_GrandTheftAutoSanAndreas/5/vghsm2/1":"AAIn]?SbPD5AbbHq90z!cV[6R;AAABrUVH5=AQhuYWPAZZUVH5=AIn]?S1djfU!","SaveState_GrandTheftAutoSanAndreas/6/ammun3/1":"AAY=l17,a9QAZq!Z94rP!+d]wYAAABrUVH5=pj!hSWNQIIUVH5=AY=l18CO5zVt","SaveState_GrandTheftAutoSanAndreas/6/ammun5/1":"AAY=l17,a9QAZq!Z98Hy/+5P5ZAAABrUVH5=pg=BlWNQIIUVH5=AY=l17?,9lVt","SaveState_GrandTheftAutoSanAndreas/6/brothel/1":"AAbQR18j*)SAJF,j9tD5~V[6R;AAABrUVH5=pj(:sV{=^SUVH5=AbQR184v:wV[","SaveState_GrandTheftAutoSanAndreas/6/gf6/1":"AAbI*o9g&VVAIn[cS81@7VtfI:pL~yBUVH5=AG/NEV{NFL7,a9QAbI*o9kW0BVt","SaveState_GrandTheftAutoSanAndreas/6/gym2/1":"AAIn]?SbPD5AbbHq9uScy+d]wYAAABrUVH5=AL_77WPAZZUVH5=AIn]?SuT2QV[","SaveState_GrandTheftAutoSanAndreas/6/lahsb1/1":"AAIn]?SbPD5AbbHq9lZN1V[6R;AAABrUVH5=ADf_;WPAZZUVH5=AIn]?SwjshVt","SaveState_GrandTheftAutoSanAndreas/6/police1/1":"AAIn]?SbPD5AbbHq92{V}VSD^,AAABrUVH5=AJ/E8WPAZZUVH5=AIn]?Sun@tVt","SaveState_GrandTheftAutoSanAndreas/6/rcplay/1":"AAL?~r9g&VVAXS5X9rNSnVtfI:AAABrUVH5=pdf9nWK$!GUVH5=AL?~r9kbW5=a","SaveState_GrandTheftAutoSanAndreas/6/rest2/1":"AAIn]?SbPD5AbbHqUZ|?]+d]wYAAABrUVH5=ANv2MWPAZZ9g&VVAIn]?SuX1cVt","SaveState_GrandTheftAutoSanAndreas/6/sfhsb2/1":"AAIn]?SbPD5AbbHq9vJeEV[6R;AAABrUVH5=AZL,FWPAZZUVH5=AIn]?SvD=lVS","SaveState_GrandTheftAutoSanAndreas/6/sfhss2/1":"AAIn]?SbPD5AbbHq9h^2&V[6R;AAABrUVH5=AEg&iWPAZZUVH5=AIn]?SrC?,+d","SaveState_GrandTheftAutoSanAndreas/6/svcunt/1":"AAIn]?SbPD5AbbHq9mhgy+^q,aAAABrUVH5=ANMvzWPAZZUVH5=AIn]?SwGU1WP","SaveState_GrandTheftAutoSanAndreas/6/svsfbg/1":"AAAABrUVH5=AAAAAAFqvA+^q,aAAABrUVH5=AV$ewV[6R;AAAAAAAABrUmz?ZWP","SaveState_GrandTheftAutoSanAndreas/6/svsfsm/1":"AAIn]?SbPD5AbbHq9lbky+^q,aAAABrUVH5=AEh-2WPAZZUVH5=AIn]?Ss8c6WP","SaveState_GrandTheftAutoSanAndreas/6/x7_11s/1":"AAIn]?SbPD5AbbHq9izKK+d]wYAAABrUVH5=AQcNeWPAZZUVH5=AIn]?SmKI|+C","SaveState_GrandTheftAutoSanAndreas/7/8track/1":"AAQbT0UVH5=AEgn;UW/*A+5P5ZAAABrUVH5=AU9EXV&F5z9g&VVAQbT0UtLsS+^","SaveState_GrandTheftAutoSanAndreas/7/ammun4/1":"AAY=l17,a9QAZq!Z9xO$q+5P5ZAAABrUVH5=pg=BlWNQIIUVH5=AY=l17;]1EVt","SaveState_GrandTheftAutoSanAndreas/7/gym3/1":"AAIn]?SbPD5AbbHq9u&XP+d]wYAAABrUVH5=AL_77WPAZZUVH5=AIn]?Ses~^V[","SaveState_GrandTheftAutoSanAndreas/7/lahsb2/1":"AAIn]?SbPD5AbbHq90z@_V[6R;AAABrUVH5=AMBS4WPAZZUVH5=AIn]?Sp]mbVt","SaveState_GrandTheftAutoSanAndreas/7/oftest/1":"AAIn]?SbPD5AbbHq9t5XaV[6R;AAABrUVH5=AMAflWPAZZUVH5=AIn]?SxHV5+d","SaveState_GrandTheftAutoSanAndreas/8/burhous/1":"AAIn]?SbPD5AbbHq92?N?+^q,aAAABrUVH5=AU+PzWPAZZUVH5=AIn]?S0jCkWP","SaveState_GrandTheftAutoSanAndreas/8/sfhss1/1":"AAIn]?SbPD5AbbHq9vI,(V[6R;AAABrUVH5=AQhuYWPAZZUVH5=AIn]?S15tF+d","SaveState_GrandTheftAutoSanAndreas/8/svlamd/1":"AAIn]?SbPD5AbbHq9tC/H+^q,aAAABrUVH5=AI:,/WPAZZUVH5=AIn]?SxME;WP","SaveState_GrandTheftAutoSanAndreas/9/fdchick/1":"AAY=l17,a9QAZq!Z9oR,:+CunXAAABrUVH5=pOBzDWNQIIUVH5=AY=l17/d*YVt","SaveState_GrandTheftAutoSanAndreas/9/lahs2b/1":"AAJewa8=XDTAVAtd9p=loV[6R;AAABrUVH5=paGppWI6=MUVH5=AJewa8)A7$Vt","SaveState_GrandTheftAutoSanAndreas/9/sfhsb3/1":"AAGvwv9g&VVAOI)!9jI9IV[6R;AAABrUVH5=pel{/WB:M6UVH5=AGvwv9z@CeVS","SaveState_GrandTheftAutoSanAndreas/9/svgnmt1/1":"AAAABrUVH5=AAAAAAYFt[+^q,aAAABrUVH5=AAD7_V[6R;AAAAAAAABrUb6lGWP","SaveState_GrandTheftAutoSanAndreas/9/svvgmd/1":"AAIn]?SbPD5AbbHq9g(KD+^q,aAAABrUVH5=AZJ:eWPAZZUVH5=AIn]?SexF/WP","SaveState_GrandTheftAutoSanAndreas/10/fdburg/1":"AALirt9g&VVALt^c9o(^e+d]wYAAABrUVH5=pcRWeV^TRLUVH5=ALirt94wYIVt","SaveState_GrandTheftAutoSanAndreas/10/police2/1":"AAIn]?SbPD5AbbHq96^}NVSD^,AAABrUVH5=AI[zbWPAZZUVH5=AIn]?SiWK}Vt","SaveState_GrandTheftAutoSanAndreas/10/svgnmt2/1":"AAbI*o9g&VVAIn[cS4+xw+^q,apL~yBUVH5=ASz};V{NFL7,a9QAbI*o9r/r0WP","SaveState_GrandTheftAutoSanAndreas/10/svsfmd/1":"AAAABrUVH5=AAAAAAK&^$+^q,aAAABrUVH5=AL{J(V[6R;AAAAAAAABrUb6A*WP","SaveState_GrandTheftAutoSanAndreas/10/tricas/1":"AAAABrUVH5=AAAAAAU?VyV[6R;AAABrUVH5=AXQ7HV[6R;AAAAAAAABrUgGe7V[","SaveState_GrandTheftAutoSanAndreas/10/vghsm3/1":"AAMk~l9g&VVAPh(Z92[xvV[6R;AAABrUVH5=pcSJ:WDHLIUVH5=AMk~l91)=ZU!","SaveState_GrandTheftAutoSanAndreas/10/x711s3/1":"AAIn]?SbPD5AbbHq94QWH+CunXAAABrUVH5=AQcNeWPAZZUVH5=AIn]?S1IovUw","SaveState_GrandTheftAutoSanAndreas/11/bar2/1":"AAIn]?SbPD5AbbHqUt_9|+d]wYAAABrUVH5=AXC|tWPAZZ9g&VVAIn]?Sq-ZZVt","SaveState_GrandTheftAutoSanAndreas/11/svlasm/1":"AAIn]?SbPD5AbbHq9o0*1+^q,aAAABrUVH5=AI:,/WPAZZUVH5=AIn]?SqrbwWP","SaveState_GrandTheftAutoSanAndreas/12/barber3/1":"AAIn]?SbPD5AbbHq9us4r+d]wYAAABrUVH5=AXA^!WPAZZUVH5=AIn]?Sxo(xVt","SaveState_GrandTheftAutoSanAndreas/12/casino2/1":"AAIn]?SbPD5AbbHq9n]f~+CunXAAABrUVH5=AK(X3WPAZZUVH5=AIn]?Sh-J{V[","SaveState_GrandTheftAutoSanAndreas/12/moroom/1":"AAbI*o9g&VVAIn[cS&ZRNVtfI:pL~yBUVH5=AH1z:V{NFL7,a9QAbI*o91SsDVt","SaveState_GrandTheftAutoSanAndreas/12/svlabig/1":"AAIn]?SbPD5AbbHq9o2fJ+^q,aAAABrUVH5=AGvHrWPAZZUVH5=AIn]?Su?t]WP","SaveState_GrandTheftAutoSanAndreas/14/csexl/1":"AAIn]?SbPD5AbbHq96OSv+5P5ZAAABrUVH5=AMi@6WPAZZUVH5=AIn]?Sh)saVt","SaveState_GrandTheftAutoSanAndreas/15/cschp/1":"AAIn]?SbPD5AbbHq9nj*3+d]wYAAABrUVH5=AS0t$WPAZZUVH5=AIn]?S03u0Vt","SaveState_GrandTheftAutoSanAndreas/15/motel1/1":"AAbI*o9g&VVAIn[c7!M&Y+^q,aAAABrUVH5=ph9,bV{NFLS2qM6AbI*o9tB{WWP","SaveState_GrandTheftAutoSanAndreas/15/sfhsm1/1":"AAAABrUVH5=AAAAAAJ&k]V[6R;AAABrUVH5=AQhuYV[6R;AAAAAAAABrUc24w+5","SaveState_GrandTheftAutoSanAndreas/15/vghss1/1":"AAIn]?SbPD5AbbHq9iA,nV[6R;AAABrUVH5=AW{ntWPAZZUVH5=AIn]?Sw$vqVt","SaveState_GrandTheftAutoSanAndreas/15/vgshm2/1":"AAAABrUVH5=AAAAAARzjAV[6R;AAABrUVH5=AZHs3V[6R;AAAAAAAABrUuEcmVt","SaveState_GrandTheftAutoSanAndreas/15/vgshm3/1":"AAAABrUVH5=AAAAAARsDpV[6R;AAABrUVH5=AI,HaV[6R;AAAAAAAABrUgrLNVt","SaveState_GrandTheftAutoSanAndreas/15/vgshs2/1":"AAIn]?SbPD5AbbHq94(/YV[6R;AAABrUVH5=AQhuYWPAZZUVH5=AIn]?ShqoDVt","SaveState_GrandTheftAutoSanAndreas/16/tattoo/1":"AAIn]?SbPD5AbbHq922dB+CunXAAABrUVH5=AQihjWPAZZUVH5=AIn]?Ss90~+5","SaveState_GrandTheftAutoSanAndreas/16/x7_11c/1":"AAIn]?SbPD5AbbHq9lG0D+5P5ZAAABrUVH5=AQcNeWPAZZUVH5=AIn]?Sq3[(+C","SaveState_GrandTheftAutoSanAndreas/17/bar1/1":"AAIn]?SbPD5AbbHq9o^40+CunXAAABrUVH5=AKFwrWPAZZUVH5=AIn]?SctT;Vt","SaveState_GrandTheftAutoSanAndreas/17/fddonut/1":"AAY=l17,a9QAZq!Z9ym/V+5P5ZAAABrUVH5=pczp9WNQIIUVH5=AY=l17^9@GVt","SaveState_GrandTheftAutoSanAndreas/17/tatto2/1":"AAIn]?SbPD5AbbHq9uHyb+CunXAAABrUVH5=AQihjWPAZZUVH5=AIn]?Ss90~+5","SaveState_GrandTheftAutoSanAndreas/17/x7_11d/1":"AAIn]?SbPD5AbbHq9t7t)+5P5ZAAABrUVH5=AQcNeWPAZZUVH5=AIn]?Sn5B8+C","SaveState_GrandTheftAutoSanAndreas/18/atriume/1":"AAIn]?SbPD5AbbHqUd[2q+^q,aAAABrUVH5=AXM;bVSD|W9g&VVAIn]?SwF?~V[","SaveState_GrandTheftAutoSanAndreas/18/atriumx/1":"AAbI*o9g&VVAIn[cS-f=$+^q,apL~yBUVH5=AJUL2U^Q=I7,a9QAbI*o9hBF4V[","SaveState_GrandTheftAutoSanAndreas/18/clothgp/1":"AAIn]?SbPD5AbbHq9nNu!+d]wYAAABrUVH5=AGw,}WPAZZUVH5=AIn]?Sd!etVt","SaveState_GrandTheftAutoSanAndreas/18/genwrhs/1":"AALF1iUVH5=ABYtjUY7aT9g&VVAAABrUVH5=ABbc+V]}=S9g&VVALF1iUm55CV[","SaveState_GrandTheftAutoSanAndreas/18/x7_11b/1":"AAIn]?SbPD5AbbHq9kCae+d]wYAAABrUVH5=AQcNeWPAZZUVH5=AIn]?SyPm/+C","SaveState_Pilotwings64/0:0/1":"ZNCA8z{Xj@f8u{h[-Q!8A3fBWVQm:7AN+G(ncIN:Sh[q;1l8tRwFJ~Cp0=8&4xd&kc}sJ3=","SaveState_Pilotwings64/0:0/2":"ZNCA8)F^oMPEC;l9_m]xn)+|[wwm7ZAAFKz/1&yJz^oZC5,-}[&We=L[;yp,f5ViT&pE&c=","SaveState_Pilotwings64/0:0/3":"ZNCA8(+q_F6L!jkXb1Q6cbATUVYCE:AACXM5DrfxYz5mgF_eqEM$@SiG+gT:5uin7?Kd[Q=","SaveState_Pilotwings64/0:1/1":"ZNCA8z{Xj@f8u{h[-Q!8A3fBWVQm:7AN+G(ncIN:Sh[q;1l8tRwFJ~Cp0=8&4xd&kc}sJ3=","SaveState_Pilotwings64/0:1/2":"ZNCA8)F^oMPEC;l9_m]xn)+|[wwm7ZAAFKz/1&yJz^oZC5,-}[&We=L[;yp,f5ViT&pE&c=","SaveState_Pilotwings64/0:1/3":"ZNCA8(+q_F6L!jkXb1Q6cbATUVYCE:AACXM5DrfxYz5mgF_eqEM$@SiG+gT:5uin7?Kd[Q=","SaveState_Pilotwings64/0:2/1":"ZNCA8z{Xj@f8u{h[-Q!8A3fBWVQm:7AN+G(ncIN:Sh[q;1l8tRwFJ~Cp0=8&4xd&kc}sJ3=","SaveState_Pilotwings64/0:2/2":"ZNCA8)F^oMPEC;l9_m]xn)+|[wwm7ZAAFKz/1&yJz^oZC5,-}[&We=L[;yp,f5ViT&pE&c=","SaveState_Pilotwings64/0:2/3":"ZNCA8(+q_F6L!jkXb1Q6cbATUVYCE:AACXM5DrfxYz5mgF_eqEM$@SiG+gT:5uin7?Kd[Q=","SaveState_Pilotwings64/0:4/1":"ZNCA8z{Xj@f8u{h[-Q!8A3fBWVQm:7AN+G(ncIN:Sh[q;1l8tRwFJ~Cp0=8&4xd&kc}sJ3=","SaveState_Pilotwings64/0:4/2":"ZNCA8)F^oMPEC;l9_m]xn)+|[wwm7ZAAFKz/1&yJz^oZC5,-}[&We=L[;yp,f5ViT&pE&c=","SaveState_Pilotwings64/0:4/3":"ZNCA8(+q_F6L!jkXb1Q6cbATUVYCE:AACXM5DrfxYz5mgF_eqEM$@SiG+gT:5uin7?Kd[Q=","SaveState_Pilotwings64/0:5/1":"ZNCA8z{Xj@f8u{h[-Q!8A3fBWVQm:7AN+G(ncIN:Sh[q;1l8tRwFJ~Cp0=8&4xd&kc}sJ3=","SaveState_Pilotwings64/0:5/2":"ZNCA8)F^oMPEC;l9_m]xn)+|[wwm7ZAAFKz/1&yJz^oZC5,-}[&We=L[;yp,f5ViT&pE&c=","SaveState_Pilotwings64/0:5/3":"ZNCA8(+q_F6L!jkXb1Q6cbATUVYCE:AACXM5DrfxYz5mgF_eqEM$@SiG+gT:5uin7?Kd[Q=","SaveState_Pilotwings64/1:0/1":"ZNCA8)Ndq5VT$~(MPw0b2yd;V8G9PtAABNX9I+I0BYwUBE]q3*g{myRnsTau3X5J=+CW_U=","SaveState_Pilotwings64/1:0/2":"ZNCA8F:zTi:xem:M^eTwkJ-$K}D3PUAN=(ts$x$}Q}wf][X^9+8FK!B1SPGZVFo!@V[J[x=","SaveState_Pilotwings64/1:0/3":"ZNCA8kv=@[Ux/cs}HsY!V[7WhhJwd)ADqADMJj+95J$c?-VB3ZyRIJr{O{UZ1)E9}a7ZN$=","SaveState_Pilotwings64/1:0/4":"ZNCA8I~:tDq*?s4OUIpmOKE:sTf,XcAG(z]~/ZPwjr7McV,mw-OeTSWrX8v+S3gz{pd!y/=","SaveState_Pilotwings64/1:1/1":"ZNCA8)Ndq5VT$~(MPw0b2yd;V8G9PtAABNX9I+I0BYwUBE]q3*g{myRnsTau3X5J=+CW_U=","SaveState_Pilotwings64/1:1/2":"ZNCA8F:zTi:xem:M^eTwkJ-$K}D3PUAN=(ts$x$}Q}wf][X^9+8FK!B1SPGZVFo!@V[J[x=","SaveState_Pilotwings64/1:1/3":"ZNCA8kv=@[Ux/cs}HsY!V[7WhhJwd)ADqADMJj+95J$c?-VB3ZyRIJr{O{UZ1)E9}a7ZN$=","SaveState_Pilotwings64/1:1/4":"ZNCA8I~:tDq*?s4OUIpmOKE:sTf,XcAG(z]~/ZPwjr7McV,mw-OeTSWrX8v+S3gz{pd!y/=","SaveState_Pilotwings64/1:2/1":"ZNCA8)Ndq5VT$~(MPw0b2yd;V8G9PtAABNX9I+I0BYwUBE]q3*g{myRnsTau3X5J=+CW_U=","SaveState_Pilotwings64/1:2/2":"ZNCA8F:zTi:xem:M^eTwkJ-$K}D3PUAN=(ts$x$}Q}wf][X^9+8FK!B1SPGZVFo!@V[J[x=","SaveState_Pilotwings64/1:2/3":"ZNCA8kv=@[Ux/cs}HsY!V[7WhhJwd)ADqADMJj+95J$c?-VB3ZyRIJr{O{UZ1)E9}a7ZN$=","SaveState_Pilotwings64/1:2/4":"ZNCA8I~:tDq*?s4OUIpmOKE:sTf,XcAG(z]~/ZPwjr7McV,mw-OeTSWrX8v+S3gz{pd!y/=","SaveState_Pilotwings64/1:3/1":"ZNCA8)Ndq5VT$~(MPw0b2yd;V8G9PtAABNX9I+I0BYwUBE]q3*g{myRnsTau3X5J=+CW_U=","SaveState_Pilotwings64/1:3/2":"ZNCA8F:zTi:xem:M^eTwkJ-$K}D3PUAN=(ts$x$}Q}wf][X^9+8FK!B1SPGZVFo!@V[J[x=","SaveState_Pilotwings64/1:3/3":"ZNCA8kv=@[Ux/cs}HsY!V[7WhhJwd)ADqADMJj+95J$c?-VB3ZyRIJr{O{UZ1)E9}a7ZN$=","SaveState_Pilotwings64/1:3/4":"ZNCA8I~:tDq*?s4OUIpmOKE:sTf,XcAG(z]~/ZPwjr7McV,mw-OeTSWrX8v+S3gz{pd!y/=","SaveState_Pilotwings64/1:5/1":"ZNCA8)Ndq5VT$~(MPw0b2yd;V8G9PtAABNX9I+I0BYwUBE]q3*g{myRnsTau3X5J=+CW_U=","SaveState_Pilotwings64/1:5/2":"ZNCA8F:zTi:xem:M^eTwkJ-$K}D3PUAN=(ts$x$}Q}wf][X^9+8FK!B1SPGZVFo!@V[J[x=","SaveState_Pilotwings64/1:5/3":"ZNCA8kv=@[Ux/cs}HsY!V[7WhhJwd)ADqADMJj+95J$c?-VB3ZyRIJr{O{UZ1)E9}a7ZN$=","SaveState_Pilotwings64/1:5/4":"ZNCA8I~:tDq*?s4OUIpmOKE:sTf,XcAG(z]~/ZPwjr7McV,mw-OeTSWrX8v+S3gz{pd!y/=","SaveState_Pilotwings64/2:0/1":"ZNCA8-{[wTV|fZv~QPv/3b)vH?MOtFAAEt@Owxe,H~579fn-65G2@Ah-(uc9uXq}S98FI]=","SaveState_Pilotwings64/2:0/2":"ZNCA8(r1+oxP97(,6VP,uZC-ajZ/7:AAFJIFq!q:WP31&qT!2E)z;0BTc4G4{&B*r&@/m^=","SaveState_Pilotwings64/2:0/3":"ZNCA8*|bkqwn(~t*B@!gP{pCYN]0sEAAIg6vxj@GoW!f6rLe7Xfqh2na=*,2q}?PBQkbHN=","SaveState_Pilotwings64/2:1/1":"ZNCA8-{[wTV|fZv~QPv/3b)vH?MOtFAAEt@Owxe,H~579fn-65G2@Ah-(uc9uXq}S98FI]=","SaveState_Pilotwings64/2:1/2":"ZNCA8(r1+oxP97(,6VP,uZC-ajZ/7:AAFJIFq!q:WP31&qT!2E)z;0BTc4G4{&B*r&@/m^=","SaveState_Pilotwings64/2:1/3":"ZNCA8*|bkqwn(~t*B@!gP{pCYN]0sEAAIg6vxj@GoW!f6rLe7Xfqh2na=*,2q}?PBQkbHN=","SaveState_Pilotwings64/2:2/1":"ZNCA8-{[wTV|fZv~QPv/3b)vH?MOtFAAEt@Owxe,H~579fn-65G2@Ah-(uc9uXq}S98FI]=","SaveState_Pilotwings64/2:2/2":"ZNCA8(r1+oxP97(,6VP,uZC-ajZ/7:AAFJIFq!q:WP31&qT!2E)z;0BTc4G4{&B*r&@/m^=","SaveState_Pilotwings64/2:2/3":"ZNCA8*|bkqwn(~t*B@!gP{pCYN]0sEAAIg6vxj@GoW!f6rLe7Xfqh2na=*,2q}?PBQkbHN=","SaveState_Pilotwings64/2:3/1":"ZNCA8-{[wTV|fZv~QPv/3b)vH?MOtFAAEt@Owxe,H~579fn-65G2@Ah-(uc9uXq}S98FI]=","SaveState_Pilotwings64/2:3/2":"ZNCA8(r1+oxP97(,6VP,uZC-ajZ/7:AAFJIFq!q:WP31&qT!2E)z;0BTc4G4{&B*r&@/m^=","SaveState_Pilotwings64/2:3/3":"ZNCA8*|bkqwn(~t*B@!gP{pCYN]0sEAAIg6vxj@GoW!f6rLe7Xfqh2na=*,2q}?PBQkbHN=","SaveState_Pilotwings64/2:4/1":"ZNCA8-{[wTV|fZv~QPv/3b)vH?MOtFAAEt@Owxe,H~579fn-65G2@Ah-(uc9uXq}S98FI]=","SaveState_Pilotwings64/2:4/2":"ZNCA8(r1+oxP97(,6VP,uZC-ajZ/7:AAFJIFq!q:WP31&qT!2E)z;0BTc4G4{&B*r&@/m^=","SaveState_Pilotwings64/2:4/3":"ZNCA8*|bkqwn(~t*B@!gP{pCYN]0sEAAIg6vxj@GoW!f6rLe7Xfqh2na=*,2q}?PBQkbHN=","SaveState_Pilotwings64/2:5/1":"ZNCA8-{[wTV|fZv~QPv/3b)vH?MOtFAAEt@Owxe,H~579fn-65G2@Ah-(uc9uXq}S98FI]=","SaveState_Pilotwings64/2:5/2":"ZNCA8(r1+oxP97(,6VP,uZC-ajZ/7:AAFJIFq!q:WP31&qT!2E)z;0BTc4G4{&B*r&@/m^=","SaveState_Pilotwings64/2:5/3":"ZNCA8*|bkqwn(~t*B@!gP{pCYN]0sEAAIg6vxj@GoW!f6rLe7Xfqh2na=*,2q}?PBQkbHN=","SaveState_Pilotwings64/2:6/1":"ZNCA8-{[wTV|fZv~QPv/3b)vH?MOtFAAEt@Owxe,H~579fn-65G2@Ah-(uc9uXq}S98FI]=","SaveState_Pilotwings64/2:6/2":"ZNCA8(r1+oxP97(,6VP,uZC-ajZ/7:AAFJIFq!q:WP31&qT!2E)z;0BTc4G4{&B*r&@/m^=","SaveState_Pilotwings64/2:6/3":"ZNCA8*|bkqwn(~t*B@!gP{pCYN]0sEAAIg6vxj@GoW!f6rLe7Xfqh2na=*,2q}?PBQkbHN=","SaveState_Pilotwings64/3:0/1":"ZNCA8MPn0mm^[SyUIy4?$ae0vC8IwhAN87olyrXq_L|+N7kEh&i;gmLm8Vn!=S65u/,_yz=","SaveState_Pilotwings64/3:0/2":"ZNCA8(bq^djUpm]OgIpL]10hsf4&1,AACyYOIdvZozFP?g*}17Y[Tk*6spA/{3h)=YmS2Q=","SaveState_Pilotwings64/3:0/3":"ZNCA80j^M9KJEem)sx01u^DeM50)=2AAB[DNDO$hrYhO!kMwQ~-IvjB,CV-^I~^Di6rGtX=","SaveState_Pilotwings64/3:1/1":"ZNCA8MPn0mm^[SyUIy4?$ae0vC8IwhAN87olyrXq_L|+N7kEh&i;gmLm8Vn!=S65u/,_yz=","SaveState_Pilotwings64/3:1/2":"ZNCA8(bq^djUpm]OgIpL]10hsf4&1,AACyYOIdvZozFP?g*}17Y[Tk*6spA/{3h)=YmS2Q=","SaveState_Pilotwings64/3:1/3":"ZNCA80j^M9KJEem)sx01u^DeM50)=2AAB[DNDO$hrYhO!kMwQ~-IvjB,CV-^I~^Di6rGtX=","SaveState_Pilotwings64/3:2/1":"ZNCA8MPn0mm^[SyUIy4?$ae0vC8IwhAN87olyrXq_L|+N7kEh&i;gmLm8Vn!=S65u/,_yz=","SaveState_Pilotwings64/3:2/2":"ZNCA8(bq^djUpm]OgIpL]10hsf4&1,AACyYOIdvZozFP?g*}17Y[Tk*6spA/{3h)=YmS2Q=","SaveState_Pilotwings64/3:2/3":"ZNCA80j^M9KJEem)sx01u^DeM50)=2AAB[DNDO$hrYhO!kMwQ~-IvjB,CV-^I~^Di6rGtX=","SaveState_Pilotwings64/3:4/1":"ZNCA8MPn0mm^[SyUIy4?$ae0vC8IwhAN87olyrXq_L|+N7kEh&i;gmLm8Vn!=S65u/,_yz=","SaveState_Pilotwings64/3:4/2":"ZNCA8(bq^djUpm]OgIpL]10hsf4&1,AACyYOIdvZozFP?g*}17Y[Tk*6spA/{3h)=YmS2Q=","SaveState_Pilotwings64/3:4/3":"ZNCA80j^M9KJEem)sx01u^DeM50)=2AAB[DNDO$hrYhO!kMwQ~-IvjB,CV-^I~^Di6rGtX=","SaveState_Fez/abandoned_a/1":"AAQt+UUiPC:S$uoQ8rXNzVtfLyLEkVzUeK43T/Lc}WDsB?Te~3a9FYcNUafCvV[","SaveState_Fez/abandoned_b/1":"AANT=*UVc|P70KHGTJEH+VtfJ(z3tS}Ub_y1T2MmIV,z/!8jpGZ8:?h4Uwd1;V[","SaveState_Fez/abandoned_c/1":"AAL~QCS^={iT0pnk92h0G+5P5wLj230Ubu=[T;48UV7mg~UatCV7q!TvTRE!fVt","SaveState_Fez/ancient_walls/1":"AAXETBUr&/T8Cr+;TO&oiV[6UFzy/9aUV_zbT1qsOWGkI^8LT||8@CGQUVh0tWP","SaveState_Fez/arch/1":"AAbSBpUsW2wQT=nbP:CsHVtfLUzrmX^UkXDfT[[_8WJXo^58Wc+8~?:UUbP|_V[","SaveState_Fez/bell_tower/1":"AAYJq^Uaz^C7,qxfTkpF4V[6SoLg,T:UpWoMT0ug?V^/+u89L;H8[{/UUbJZEWP","SaveState_Fez/big_owl/1":"AAYk9CUVK8$8FfsDTw2arV[6R;zWHG{UaCM7T+p72V||Om86~AE8@/y{Ulg|{WP","SaveState_Fez/big_tower/1":"AACn}QS_8*x8|{^+UhUHmWPAc!K@U;KUi|U)T_rikWnTd}9w(tv7o*V2S+hxMV[","SaveState_Fez/boileroom/1":"AAY3VPUr5Zw7pBMNTym,eVtfLsKbNpUUvsz6T6eToVyF[v8r(yJ8=dM=Ucn2[V[","SaveState_Fez/cabin_interior_a/1":"AALnPgS^m8P9C)v/UaK}-V[6SVLqQ$2UfjWHT~a]XV!^d295O!s7,pF]TPP92Vt","SaveState_Fez/cabin_interior_b/1":"AAGcbQ8M()09D+UZUjx:yV[6TjLc7ItUj10ZT$Yk|WGVnb92ssoSiA_*8hu0)Vt","SaveState_Fez/clock/1":"AAFvM1TaEU[UQWqB9x]$s=Ay4wP4Lj0UnBU5T}r1JWPtraUjA;D7~u:eTelE;V[","SaveState_Fez/cmy_b/1":"AATk4/80!|kUEaVy9qVAz+^q:~KwHN:UlGT$USB3+WaaunUj)8~TAb]T84}xtV[","SaveState_Fez/cmy_fork/1":"AATKqs8nujzT$2kG9z,57+^q,mLrNt=Uh}{fT/ImpVvXiOUW_opTD:qn877zDVt","SaveState_Fez/cmy/1":"AAa^i_8c*9)T4TxD9w@,J=a~$mK,-t]UW?alT~4*YWhDVYUei}+Sd?Y+8Y?CHV[","SaveState_Fez/code_machine/1":"AAAI|o9u9}JS+O[98yEzMV[6Tq0A}e}Uc7nnT]v_xWJ$gGTenQVT]cN59t+a9+^","SaveState_Fez/crypt/1":"AAQk4TUwhho7*1_nTZX;7V[6T@z]c9pUnq6~T@:LEWL*z_8x4389FT6zUvjMMWP","SaveState_Fez/drum/1":"AAOh,/9paPlS{&h?8p:LkV[6R/06qErUg&^uT&jvzWLTq=TZF}MT,Yj!9nWI6+^","SaveState_Fez/elders/1":"AABp9w9idc:S82Tr8u{JWV[6SKLuwi^Ugy,rT10MaWHNU~TZ~,cT(U;e9pv?{+^","SaveState_Fez/extractor_a/1":"AASC$n93OOBSoVRF8ZSm@V[6UVK7$DLUs:AMT(w{mWCr8,TA_p(T&[!k96:*i+^","SaveState_Fez/five_towers_cave/1":"AAX6b|9l?}_S/,;J83_AFVtfKBz]qlEUcszoT3[w+Wo+f5TtuZ$T7D,o9mMu[+^","SaveState_Fez/five_towers/1":"AAN4C^Ug*Z{72z9dTV:}JV[6SB0lZ+iUY6@^T=|OOWLOnN8b(hO8*h*JUZc5zWP","SaveState_Fez/fox/1":"AAFWWxT=[PWT8--*97-r++^q;wLH-PuUco_}T&H)dWklXVUmi]~8L97uT597KV[","SaveState_Fez/fractal/1":"AAS_-p856suTu+{T9nxS_+^wn}LjK)IUYNVLTis/4V*:VGUwTBzS/yw68xIX3V[","SaveState_Fez/geezer_house_2d/1":"AAaEYiTqqJnTW2U^9rM+A+5P62z!)h_UcMAXTMV,WV6Fk3UmR:J7RLMZTu2$VV[","SaveState_Fez/geezer_house/1":"AATL?NTqjc]TixwJ9k-Qy+5QWuLkjyrUd_=^TkIvPV;Z:2UcH:K74SDGThtiRV[","SaveState_Fez/globe_int/1":"AAbGQ5TG_{tT3x9?9h*ju+^q,yK/p1NUj2nIT[AeTV6Xz6Uj;G/71vl,TW=P-Vt","SaveState_Fez/globe/1":"AAIzu[Th^2bT=wlQ9qRde+^q;Gz^{roUeR2cT;puzWFY6OUc~,77,vwFTwZw*V[","SaveState_Fez/gomez_house_2d/1":"AAMZl_TMm(pTvhHt9ukIx+5P7jzn=,wUp=5HTjI?JV_[4tUgf2:7fcizTL9MrV[","SaveState_Fez/gomez_house_end_32/1":"AAJ{e]8zQTRTu2gg9rTxq+5P7R0CUk]Ua0~-TbC:YV/3j(UmjeGSu+pq80VCUV[","SaveState_Fez/gomez_house_end_64/1":"AASK}STzgy{84-d@9pm|5+5Wq?LJ?|xUgBUU8ptupVyXT,Ue2o2Sn]TTTsO^wV[","SaveState_Fez/gomez_house/1":"AAQj;BThx^?S}CUN9614r+5P7t0A=]?UwNH[TPP9!Vy;x?Uq+hO7c++VTfsrmV[","SaveState_Fez/grave_cabin/1":"AARf[D8QObU8!(V9Ut/A_WPAdwz_kbUUr,SmT!y@XV}Yvd9r:W^S0a5,8iO-^V[","SaveState_Fez/grave_ghost/1":"AANAnFTAsc&T/X:w9w0/A+^tG@L~37tUa9DOT&;gRWMBa}UepD{75+mFTQGC~V[","SaveState_Fez/grave_lesser_gate/1":"AAD7,KTI)FFT@5~=9oSjR+5P510P-$rUn8/?T?;0ZWBLF-UjJ=O7}7tUTODNUV[","SaveState_Fez/grave_treasure_a/1":"AAPD8fTssWkUUBX[9x|H9+^q;C0r3HnUsMy?UPFM^Wa+6nUaa3]8Z9oaTwZf]Vt","SaveState_Fez/graveyard_a/1":"AAZd}hTnCHYT6^,M9i4+n+^vc7LoL0lUgVwKT4y[aWens4UdK7X7]rGETaj)bV[","SaveState_Fez/graveyard_gate/1":"AAY}tU9oHcxScOuN7]_ayV[+-S0wf^)UX]]*T;tUNWLUwHS4[E?T-8_q9tFqe=a","SaveState_Fez/indust_abandoned_a/1":"AAZq!Z943@]6]O=Y8BxN@VtirCLQVidUmu9:8VqRAV6^^BS~Ykl8dKd)9qyhE+5","SaveState_Fez/industrial_city/1":"AAOBPu8qG6dT@;US9j=iI+^q:@LI3)CUk8/{T0|9eWXb2NUrQ4uSiLYB8yBF!Vt","SaveState_Fez/industrial_hub/1":"AAa!_l90mNMS1c^U8JdG?V[6TSz?--BUldxWTn!,}Wbr{KTNGKRTfyf89qqfP+^","SaveState_Fez/industrial_superspin/1":"AAandd9h7_W8GddqTsKw3V[6UaLS/B)Ug7[sT]4,GWUNUI8kn2+T$SwO9wIml+^","SaveState_Fez/kitchen_2d/1":"AAT=uI8R4Wc8=5zQUhqX(V[6UtK/hciUc*f-T(6OdV*$zP9iv/zSlHsN8gZHNV[","SaveState_Fez/kitchen/1":"AAVTg-8w,fiT=7(A9npq-+5P5}LY@[@UnD6vT5zCQV1xSGUcFA8S*r}986KgDV[","SaveState_Fez/lava_fork/1":"AAa,vg9ne337)+E6Tc{]CV[6UlK;?46Ut!/pT!K{5WKKu|89hh^T;UI$9n={O+^","SaveState_Fez/lava_skull/1":"AAG9ZPUqF3}7{xl@Tb(][V[6TkLLo|+UukPuT$}CzV!?-_8nQ9v9EK6iUrV&lWP","SaveState_Fez/lava/1":"AAHw]XUv7!p7qn(CTd,17V[8o+0kqF0Uqm9?Ti;MPV}eGp8v(3U8wSc~UYmy~WP","SaveState_Fez/library_interior/1":"AAABFuTuKo[TZZ_R9ko9j+5P7|z0|&MUwaZoTjHCVV5{e2Uk*Yj7xee;TkIz6V[","SaveState_Fez/lighthouse_house_a/1":"AAbajk8ul,DT&^WR9u3g9+5P6E0zZ|0Uh/V$T[VtYV1fGEUj=8hS3Jw+81I$rVt","SaveState_Fez/lighthouse_spin/1":"AABp9w9v9J;S3K7*8udJ]VtfK]zsqw2UtkkST3|E1WovgqTq8MqT8^qq95:;~+^","SaveState_Fez/lighthouse/1":"AAL7(?9wf98TNdOD8*?z&V[6TzLJiF^UsKHGT?~BKV(vtoT6CO2T1kJ@9uLWE+^","SaveState_Fez/mausoleum/1":"AACiS;8V&rUT&Bp99jGX,+^q,}0A~GwUd,eYT+JL:V$ay6Uo[RVSt@qj8L0{*V[","SaveState_Fez/memory_core/1":"AARCxVTf+jiT0xZC92;w:+^q:~zrLF{Uk&nlT(dA_Wj;_pUuthS7@50?Tcl[xV[","SaveState_Fez/mine_a/1":"AADe3jTe$?zT8}Z_9o&!=+^q;oK@F,MUj|C7T5*9XWcunsUfol&8OXY{TihN}V[","SaveState_Fez/mine_bomb_pillar/1":"AAZfOsTSE$WTGRkRUfd55WPAcn0d!SFUe76E8VR]/WcdI-9optdR!]WfTMrRSV[","SaveState_Fez/mine_wrap/1":"AAPTZ,89mhi8_|0XUY|jZWPAda0clucUjg^:T]Z7lWV)h$9j}?[S3g=~8+6f0V[","SaveState_Fez/nature_hub/1":"AAZq5T97i3NS31t,8oYHXV[6SP0v$JeUWQ!fT]H20WHz3PTd/k,T,fHH9v)TJ+^","SaveState_Fez/nuzu_abandoned_a/1":"AAZq!Z9w^&wS1[P]8H)iTVtfK]zu&WzUrzsZT]&+kV?o&XS!1GHT8?,X93uQ/+5","SaveState_Fez/nuzu_abandoned_b/1":"AAQz[+TeuKK8q!Ea9t$VQ+5P5bK;OT0UwRTn8x!&8V+uZJUrDVPSc+54Tv1]VVt","SaveState_Fez/nuzu_boilerroom/1":"AAL2IP8O5YAT(Jhw9sS}5+5P510Ya]$UeKM!T@VaMV*obLUf7{ASnS)h8QIkWV[","SaveState_Fez/nuzu_dorm/1":"AAXgvKTpL7aT3o0~9s21l+5P6;z}RK3Uiw=|T=!0OV67[9Uq]v,7x4fkTuWV2Vt","SaveState_Fez/nuzu_school/1":"AAawvi9j6ArS0wim8MQkuVtj3;LP5QAUd,eYT]833V18|2TGwzdT[kmS937^C+^","SaveState_Fez/observatory/1":"AAUOU5UVNwN8ERh1Tn;9FV[6U+LP|u-Ui[2+T[[nYWGmO:872iX8&9,7UW-(]WP","SaveState_Fez/octoheahedron/1":"AAJmcF8bo-hTM(@*Ub$8zWPAc*KuP&XUaFmj8g-/[WKaP,9tf4b6{xhn8Q!}qWP","SaveState_Fez/oldschool_ruins/1":"AACL@N8bQ)8T3USD9yulb+^q:]0cBWYUj(d[T7(0=V16wPUk*I{ScH,U8Wh&FVt","SaveState_Fez/oldschool/1":"AAXjTNTt7{hT:NEb91:[P+^q,az3VK{UnMQKT-WNjV:@-5UtA}x7{}KUTY4=QVt","SaveState_Fez/orrery_b/1":"AAALjlTHO;NT58V,92J/^+5P8OK-q=QUmp!|T6O51WjO4sUkpFs7yjQHS}BafV[","SaveState_Fez/orrery/1":"AAF3sD9qzU97@PUjTtZ/tV[6TyK-8!SUkw0_T(q$6Wm;p?821,sT/ZeH92V]@+^","SaveState_Fez/owl/1":"AAZ:mwS^A)uT5dbr9yfOa+^q;WLN($_UwM?cT?r2WWBLF-UhUG38Hwb-TA}CXV[","SaveState_Fez/parlor_2d/1":"AAQuLX7ow,Q8_L]mUetk@V[6T3K{L85UXsi[T4TZGVtoQa94jI}R_PT37sfhHVt","SaveState_Fez/parlor/1":"AAQ]BZ97;!|S982I88~1aV[6Sp0M4R}Uj*/cT0r;iVv8CvTqi11T@wAq9r{00+^","SaveState_Fez/pivot_one/1":"AAOYAx91xhZTA:8X8$Nj4V[6SdLOeP~UV6ckT6/CbWg$}VT27}hT9p4q90M*^+^","SaveState_Fez/pivot_three_cave/1":"AAHxP[8k!jB9EO]:Uf=wGWPE]PLlMnEUuVqaT3h5xWZm_Z93Pj?S[+OY82y{ZV[","SaveState_Fez/pivot_three/1":"AAFKXB9pdt4Sr_is8qfm)V[+_10I+$ZUjRMLT/UpjWSW-qToOCYT8/S-9sSRn+^","SaveState_Fez/pivot_two/1":"AAXxV}9k1T2S3)1C83B1]V[6SNLRRcRUiK5?T_Vg{WEUP3TY,&eT[nYM9o8L|+^","SaveState_Fez/pivot_watertower/1":"AAQ?~)Td5JqTbR?B9y5p_=a@kiLs+uUUd?QITZn&^V)q),UaOV27@ZC)TmjL)V[","SaveState_Fez/purple_lodge_ruin/1":"AAG!$MTcd9LT4tu49kS1I+^q;zLEEiBUnYu:T~CP?V,g7pUt]nv7^-;lTpgf6Vt","SaveState_Fez/purple_lodge/1":"AASm}=Tp9SET+mTx9mdxZ+^q,4Lt~&&Ug;(tT@I-OV5IolUZAv67![$bTd!wqVt","SaveState_Fez/pyramid/1":"AAU7Fv9zRWS8bsWo8k/Y+V[6SD0ZxoxUprg=9aEsBWmZCiTlG3+9cFq|9rw;A=a","SaveState_Fez/quantum/1":"AALsQ09r9BfTD(0T8sO;kWPAdz0e7Z^UoxGRT0;1FWaWQiTf|6_T+9EM9v~Z/+^","SaveState_Fez/rails/1":"AAZ8~V9i7FQS+G(@888{gV[6S&0zfNcUruXTT,k]VWH89QTe:gjT;K^@97TI)+^","SaveState_Fez/ritual/1":"AAVldwUl{]h8ca_VTcg:&VtfK3LfdXXUh^qJUJ3@+Wel1M85O_c9Q9p(UrL45V[","SaveState_Fez/school_2d/1":"AAE2qvTqps_T&n6i9kpl@+^q;wKk5o[Un|1AT3|O~V6f$lUtzf97$p@BTb-,UVt","SaveState_Fez/school/1":"AAADSFTn-MdT_!Tt9wjg6+^q:70Xr7WUu2bwT+_/_V;i]3Uc)Zl7^Bj,Tvgc6Vt","SaveState_Fez/sewer_fork/1":"AAAIV38n{PE8(]Z=UYX+-WPAc=z|2rYUVoQiT9L71WJTja93-;vTWKh[8l_g$V[","SaveState_Fez/sewer_geyser/1":"AAUbAw897aK9CV+0Us!t7WPAcH0M$f3UgA6OT7W9FWESx(9lL=-TPBWp8vMePV[","SaveState_Fez/sewer_hub/1":"AABf1S9uocwTIemy8!,7uV[6TazfVL1Uj]{6T:tOEWNwnnT1?_DT&z?l9o)5T+^","SaveState_Fez/sewer_lesser_gate_b/1":"AAN{:u9y|}ATLoOx8-*1GV[6R;z{HsUUt^$qTz1E^WJ[68T+Nk1T53/a9reKW+^","SaveState_Fez/sewer_pillars/1":"AABg3v9jCFQS95&{8mF7jV[6UB0YANBUjsaXT4,wwV}c79Tmm8NT?(w}9y|tF+^","SaveState_Fez/sewer_pivot/1":"AAXxV}9rwA^TA57k8oa-AV[6T}K+LITUkc]:T4zfkV}/)*TlU~jT7(ZR9iT1|+5","SaveState_Fez/sewer_qr/1":"AAOW,YTDnh2T?X)/9i+Lr+^q:rLAKODUfxiKT_m{7WB4j~Ui//I8GDJrTG2WjV[","SaveState_Fez/sewer_start/1":"AAUVS^96:|WTQA,^9ACqvV[6R[K$q&(Ug7[sT$XI!WKDqdT;;}2T!@cm9t*Q$+^","SaveState_Fez/sewer_to_lava/1":"AAD^[fTB+QvT(H+B93jiQ+^vbf0tbI3UlbJ[T=eK&WAy=8UXW6a7vCmkTDuCyV[","SaveState_Fez/sewer_treasure_one/1":"AAC_,,93AbQS2zPx8U@*ZV[6Sb0Q5JNUeu*7T&f,!V^/nmS^@U)T_CCT94Z*t+^","SaveState_Fez/sewer_treasure_two/1":"AAGQHOUr/,IS[!Op8f7|[V[6S3LQ[waUp_@2T}MIFV(s{xTF-5Z9H6U?UY8OBWP","SaveState_Fez/showers/1":"AAP$sU9xWKjSg:}y8jRk)VtfLM0Cw^cUlu+QT:_nFV+goYTCF@&T=?t[9jn;U+5","SaveState_Fez/skull_b/1":"AALBOc80J5+8-1a|UtuQPWPAa?0xg2fUhsE!T99qqV^{Sz9ktSHS+bxJ8uL|}V[","SaveState_Fez/skull/1":"AAWHx&UjFvQ7)bv3TEzJ/V[+=n06(cvUgg2pT7po3WOtu&8Y0]m8|vaTUtxapWP","SaveState_Fez/spinning_plates/1":"AAB7]y9n{QrS{Hi28xTYDV[6Snz)JAXUhH_?T++myWTAIKTa[H8T~mzV96-E=+^","SaveState_Fez/stargate_ruins/1":"AAAI|o9nzBKS34n^8+TVuV[+P}L8~!UUghT4T/zMJWVtNgTsz!zT=$qr95G,6+^","SaveState_Fez/stargate/1":"AAAtWs9z!QlSj0vV8m2M&VtfKcLCfetUiMm&Ta/^8WAZECTzOZgTgT9-9jk@,+^","SaveState_Fez/superspin_cave/1":"AAT*5r9nu9KS@8EM80N[aVtfI:0Xi1VUukPuT62]PWC9DMTwY_XT+6GO9pQeb+^","SaveState_Fez/telescope/1":"AADsX]96R:0S_;^{8YFcoV[+=3LpC]-UVWEgT?p*kV(kS=TS}K+T!FCm9qb)M+^","SaveState_Fez/temple_of_love/1":"AAMgP[UV|Fh76hvRTV3kwVtfKX0OU[5UtbeRT3dE,V]KJy8awb}8^|gkUmf,VV[","SaveState_Fez/throne/1":"AAPHx,TH2!Q9Eu9fUnQ(cWPAcF03*?9Uj|C7T5cWlV!5Lz9y!m)7:|&aTADa-V[","SaveState_Fez/tree_crumble/1":"AAQZ:n8yB!o9S]9kUl7DOWPAcTLqmW8Uf=--UNd^HWc}!09r$61TWHgV88(1(V[","SaveState_Fez/tree_of_death/1":"AAZ0YvT;F7I82dr[UWeanWPAd+Kv5NQUvBw^TlL^0V-1C,95O==8S4J;T(3KZWP","SaveState_Fez/tree_roots/1":"AAa!_l9sfG;S*wr98Y)X6V[6U5z)tYbUgdX-T;?v{V}{h@TNQSWT:krJ9hM}k+^","SaveState_Fez/tree_sky/1":"AAZi)^8~T}i8(Hz&UVY*OWPAcD0Za1CUn,0QT,i$YWXrWd9hse_TSK2)9Fd^GV[","SaveState_Fez/tree/1":"AAQt;W9zLszS-h8~8z1DbV[6SP0C/ekUii{bT!wPJWYF4aTnW7lT_NoB9ljx,+^","SaveState_Fez/triple_pivot_cave/1":"AAP!a?95-oN7w5kk8]=h|V[=!cLuCI0Uc^r[8wz-IWEi9?T=rkF8x7-:9yXDd+^","SaveState_Fez/two_walls/1":"AAE(:$TVud0T0ke+97Pi[+^q:~0bc:RUg;PUT4Uf6V)0:EUe:h|7x?pITD_p^V[","SaveState_Fez/villageville_2d/1":"AABXxu91A+MS-Q~}81b^MV[6S)0C)klUhLJPT8GU8WKefOTk7$KTz8mq9lb0*=a","SaveState_Fez/villageville_3d_end_32/1":"AAQk@Z91EXYSyRv]8i:!DV[6TazQH+/UiuufT+d2DV*RYVS^(WPT@j2g97by$+^","SaveState_Fez/villageville_3d_end_64/1":"AAE0L)ThS-,T3f6[9s!=[+^q~R0VtniUh;yVT,@,/WD$;CUZdi&7/N7pTpVFdV[","SaveState_Fez/villageville_3d/1":"AAWZ-*96W)=7-bSVTGGj1V[6TE0cas5Uj-!5T/aesV^)J-8UkK~T;mF]9q7$?+^","SaveState_Fez/visitor/1":"AAaqZ&T_B{hT8--*9qy6q+^q;Qz&DrBUa@8:Tzx6+WI&CSUusU88JXGXT7Y6!V[","SaveState_Fez/wall_hole/1":"AAGUJK8w5yu9EWvdUhVk{WPAcO0Nr,FUj?-bT_rdJWHkRl9w/pmSx/E*819raV[","SaveState_Fez/wall_interior_a/1":"AAU|9RTuC@(T[L2|9pjo{+5P5a0JFJcUoJh5T0=jRV+uZJUX-)@78z7ITYwwbV[","SaveState_Fez/wall_interior_b/1":"AAZS]/TnnwYTg}649h,8q+5USvLjdGKUXZ6DTt5cwV;Q91UqOM|8B9+WTh~JNV[","SaveState_Fez/wall_interior_hole/1":"AAUG_uTBiAyTa$iU92}S$+5P7vKvnBOUrhOyTsy5AV0HuBUtqw77x,;vTE9OCV[","SaveState_Fez/wall_kitchen/1":"AASr]w8eDiNTiyIY9tP=c+5P7hKf,V3UhkX8To!VYVwU^yUqtjoSXzN_8U9)-V[","SaveState_Fez/wall_school/1":"AAJMd8TJjS/TW{qD9u+!!+5P7SK--VcUd1^lTQHflV6(C-Uv|~p7J9q3TDTL&V[","SaveState_Fez/wall_village/1":"AAC|(;9jMx5SvP&b8ZM:yV[6TaLISoyUek4OT-ITcWGBqJTV*1?T;X$N98POJ+^","SaveState_Fez/water_pyramid/1":"AAPMX&91&[zS4w@~8o8JdV[6SvKq2*dUdEl_T!cNIWF!}NTe&!mT6w,Q9z9@n+^","SaveState_Fez/water_tower/1":"AAASEp9r$UgS&HLq8ul^KV[6UfLUWQoUZvi}UJUciWZNp-Tlv{$UT-_99ko92+^","SaveState_Fez/water_wheel_b/1":"AAR}Lr8QsT[8!coQUmecIWPAbuLPifkUa+2NT8$+DWFh$T94WnxS7Dee8iTP5V[","SaveState_Fez/water_wheel/1":"AAZP5W94&dDSNB!17(MmNV[6SHK18t3UW4?-T99VgWM+mSS*rogTzrH=92Mfd+^","SaveState_Fez/waterfall_alt/1":"AASVAo9wM&c7NnW4Tfn!fV[6SjLJs_uUe*tKTlRoHWEH-*8tOYqTf~M*9w2ze+^","SaveState_Fez/waterfall/1":"AAZGzV9tyAQSgi!~8F-tjV[+==02-}TUh3=cT7&XKWJ[w&S-Yf}T/5m=96u?A+^","SaveState_Fez/watertower_secret/1":"AAP$sU96;l@SOIA78SsnHVtfKt0C48&Ubfa?TnP}OV_ERwTXfZBTln9r97rYb+^","SaveState_Fez/weightswitch_temple/1":"AAY-hS95hjlSs5m}7|X@!V[6S~0b-Y^Ub;dXT4^qjWNpHdS6S/!T/_=q9q&AR+^","SaveState_Fez/well_2/1":"AAP:mT94Rq}S+@^y8U03*V[6TiK4R2DUrQO/UPY(KWBGO$TL3)|UO!wP90~y@+^","SaveState_Fez/windmill_cave/1":"AASd$+Tr$jST&1-G94}/Z+5P7nz&MxCUa4w_T&*UsWbE$qUn:?=7;HV}TlqcGV[","SaveState_Fez/windmill_int/1":"AATiTH9zn^NTXwkH9Bmk+Vtj4+LG((SUl[n&T]VfHV1:N?T,y,TT5:7V95)W:+^","SaveState_Fez/zu_4_side/1":"AAHS17Tl(kKT80P-9oeOD+5P7rK/h/vUj?saT$9w@WE-cJUodV|8HJZLTqGUfV[","SaveState_Fez/zu_bridge/1":"AAMpM/9vH547^T:gTm*@bV[6U1Kxh*)Ug7[sT@RB^WZ+AB8lbU?T9p@w9xRSb+^","SaveState_Fez/zu_city_ruins/1":"AALju=9p-527yAozTChpJV[6T20b(DvUe[FiT9$i1WeROl8cj~{T4R+l9kNl2+^","SaveState_Fez/zu_city/1":"AAFugA96jTI8Im,,Tm[1QWPAb8K_OrDUaGsdTwWftWM;nd82plRTrS3[9htLX+^","SaveState_Fez/zu_code_loop/1":"AADaL?9676CS&GF98VcMqVtfL0Koz=/UhQ?[T]uO9WI6WiTWocXT?pNu9qt_[+^","SaveState_Fez/zu_fork/1":"AAE^PcTiZ|o8t3PgUnr;bWPE[~LC6wwUj{4JTy_Q@WO5;O9nk*J7_[czTmqT&V[","SaveState_Fez/zu_heads/1":"AAbbHq9of7S6@F8wSkNhnVtfJ|0cCJwUej,eT@QGMWaplj7u/91T]O|a9yIBO+^","SaveState_Fez/zu_house_empty_b/1":"AADsX]9nu];S=;bY8SJ4NVtfLj0U2,XUXChFT=LRXV+Ib(S^heGT~j|h9j;/1+^","SaveState_Fez/zu_house_empty/1":"AAASNt9so]S7ifLBSw4xzVtfJj0zSQBUi@!RT&fBAV3!IK71SI6T~NB-9hs|V+^","SaveState_Fez/zu_house_qr/1":"AAJvZD8Z+W(9EG:JUp0/aV[6UBz:FSeUphU~T:E6~V:m9897q$[ST3ay8g-xXVt","SaveState_Fez/zu_house_ruin_gate/1":"AAaDCY9igSUSiPDc8+7IqVtj5PLIUJLUu^d2Tb/RzV8&26TdlRXTlL+S90O1w+^","SaveState_Fez/zu_house_ruin_visitors/1":"AAQSyT9t8xmSzg/280OYRVtj)(L?1fRUXuEjTeXf=V8/+ATg41ATkYpT9nV27+^","SaveState_Fez/zu_house_scaffolding/1":"AAHw]XUb97@S8y^-8q&uMVtfKlLQ0}/Ukm7&T,TkxV3C)nTa6/l8,jVlUW+4UV[","SaveState_Fez/zu_library/1":"AAXe5S8x/A[8*3ONUYr*{WPAcbLO-LGUb~:]T6[;_WIE2P9o&a2TQKOk8nB?tV[","SaveState_Fez/zu_switch_b/1":"AAK!Q69l7{P7-H~NTRFfMV[6UFzekfnUdeGUT2FT*WEE?v8c=C^T4a;m9pEY;+5","SaveState_Fez/zu_switch/1":"AAN_F^9m*C8S7u9&8K5?|V[6UxK]1h+Ug&VVT6{29V|WE[TI1:QT8bvy94b0:+5","SaveState_Fez/zu_tetris/1":"AAGbnC87~&:8[Q_2UZgCyV[6T@zm|E=Uum$wT/d5RV&&f_95{ZOS~_CQ85H$cV[","SaveState_Fez/zu_throne_ruins/1":"AAP6gS9xo+:Syde;8T|6BVtl&,LinOVUn_=KT!9}2V2XIhTGACCT0&GV9vNZ2+^","SaveState_Fez/zu_unfold/1":"AAa54kUwLtt7agpAS+!z|VtfKNLPifkUaISHT7svSWX:b47/5/n8|@OMUnL:wV[","SaveState_Fez/zu_zuish/1":"AAPCn3UdAd4TB@:]8(k]tV[6UFz1LdWUf]tvT@u0dWhrgdT:uo48@zJoUd7fKWP","SaveState_bfbb/mnu3/1":"AAEZ;~UasE[9a]@w9z9T~VSEAVLD&[IUW]qe9W1ikUnndKUZ4CHUR^48UvRTNUw","SaveState_bfbb/hb00/1":"AAPn$P9Sj1x8+&-f9q9!q+5P7dK:a4sUXu(-891y-U={b=Ura]58Q*+r9IM7@V[","SaveState_bfbb/hb00/2":"AACNQAUr@x(TdyP79tAP{Vtj4*LQd+JUc|1ATm?DIVFxxAUeG]_83zV^UuhTnVt","SaveState_bfbb/hb00/3":"AAamR!Uh?IG8wz(_UCUdkU!9(A0UIV~UswvST-u3kUynaB9T/f_9A7t2Uhci?U!","SaveState_bfbb/hb00/4":"AAZnZ~UaErLTZu:Z9Mn*b+5P7=KZ$}@UqCi,TxU*3U;G_rT}S@B83}LWUZ6t,WP","SaveState_bfbb/hb00/5":"AASs72UsalfUJP:/9qjna+Cuo}K]XyWUZK+&UpMiEU[3QaUmkp:9Z3${UgeQo98","SaveState_bfbb/hb01/1":"AAM4C_Ustn;TH}}_8*v:;VSEAD0&QIJUZV:IT+E-wU-2S]T;O_i8*u4bUeT4cU!","SaveState_bfbb/hb02/1":"AATf989Y~HAUNqMo9vY&CU!9&V0qH!wUgtXPT{FI@U8w0KUVcDoT4V6O9H0KDUV","SaveState_bfbb/hb02/2":"AAHI;}UeR^u8+hPJUbx~N+Cun=z9+tEUq+qtTl+d8U?S|f9tG2=8zW]|Uv=S;98","SaveState_bfbb/hb02/3":"AAH!F~8z5~oUCM!39l4sv+CuoQ0q[7DUj}I*UE|]@U]&wBUt^j/TN(T=8wcXRU!","SaveState_bfbb/hb03/1":"AAGK-O94}/38_7)/UeHUI+Cupdz*COTUe:/lT!Ju4U4bjB92dd?T5fY(9s7I-UV","SaveState_bfbb/hb04/1":"AAXsrJUIK1g8$1IsUuJu;U!,m2LmI8CUiB+XT4udPUcX?H94f5]8t6ZLUPJ$UU!","SaveState_bfbb/hb05/1":"AAUD{r94Z$?9L6L4UaWeaU!9&f0EIqXUetCeUS:ReU{S}c9voB-UL$xG95!qF9g","SaveState_bfbb/hb06/1":"AAF)VP9ZeZk8}68+Ue5rlU!-OBLX5U;Uq~xdT?6U]UgmH+9nYo*TjM[i9P-CuU!","SaveState_bfbb/hb07/1":"AAQi5AUY1skTL~caUYkytU!9$q0Ds5LUa]L18+8UZUqX$E9nYM4TUo4oUrxG9+C","SaveState_bfbb/hb08/1":"AAXSsq94OfCTmvW7UjVkuU!9$oLf9c*UoCV$89cFSUY1629jw^B84hic9olEEUw","SaveState_bfbb/hb09/1":"AAGvA|9iZ8u8Udi]Uf8UdUwi:^0A2:/Uv9_:S|^2yU0TOv96A4vTGnYA9jVwh+C","SaveState_bfbb/hb10/1":"AATa5xUgrbFS*X$/ThDE=8=XFFz,0f:UuU-u8)U!cU+6~W8s^WST]0M3Uhfr{Uw","SaveState_bfbb/jf01/1":"AAL+r5UWO+Z8YNBSUSgrUU!9(N0HtALUjfWNT;bu/U[Fxi9HgdS8)J@!Uhu,@VS","SaveState_bfbb/jf02/1":"AASVMnUs{x/9BV]^T}67f98TgQ0MJ]tUd4,wT*VYcU^9h69LvQX9esFNUpxZGVt","SaveState_bfbb/jf03/1":"AAYGp|UocbU7^H*mT5*q~UwpyB0c8h(Udx~~TBbaZU:n$O8-PvV8b&I2Uo!$JVS","SaveState_bfbb/jf04/1":"AAM22B9y]7~8qat59yNpg+d(JCK|R{QUW(,68qgMcVa3u2UW^WY8vah|90P3]+5","SaveState_bfbb/bb01/1":"AAF9E-UU{&WUH8Xa9x4T_+d]ya0aYboUZ^6lUL-GXU~-$6Un1*f8[g)]T)g)?UV","SaveState_bfbb/bb02/1":"AAPKraUW@GD8z/06T+T_fVSEBCLX?*1Ui:{7T)EQfU7UI98!$/:9J{U]UutzKVS","SaveState_bfbb/bb03/1":"AAB:02UdFY}TC(XT9pWf+98bbV0Sn2;Ug+G:TAt9MVhA!YUl07X8alByUqTR(Uw","SaveState_bfbb/bb04/1":"AAThZ8Uq]th8v0guUPEFr98Tg0KrhlkUZ{hkT$43*9l-4b9X(h$8&RI:Uge+JUw","SaveState_bfbb/gl01/1":"AAV9]39l7&?8+:r8UABn{VtfKa0TDh^Ub+X!T(B)1Uxx^|9f}3nT/@YW9p=*Z+C","SaveState_bfbb/gl02/1":"AAXc*MT~pRq8^~&)Uut6eVSK~701OHIUq@4tT$jq}U-8=k9p[cm8bD!VT/d)nUw","SaveState_bfbb/gl03/1":"AAMjzx9ytc49a8UXUs[rDU!9$40U9}2Ur~8qUAtCYVPQxc9w5A{T:B?P92Le[+d","SaveState_bfbb/b101/1":"AABH~G9k,OvUDPmu9ecY~+Cun30R9PwUqP+JULQFhU*tU9UDc&2USM=[9u_Im+d","SaveState_bfbb/rb01/1":"AAXp71UQ8nVT;F0D9p*$o+d!?LK}v=]Uo2=+T~?NaU?-7VUp8|U8ZF$+UP8d{U!","SaveState_bfbb/rb02/1":"AAH5)YUp|prTGDU_8kp2&9FyO$0LZ7wUmaBWUK+JlVL8S6Td8@&9TK98UWZ4AVS","SaveState_bfbb/rb03/1":"AAZjr=UT(2v8;EzzUhWMBVtfI:Km[0aUWW;_T7O35Ups1@9kbEL8trFTUBf3eVt","SaveState_bfbb/bc01/1":"AAXu_V9UMK/T,*Kb9mz4-+d]y+Ku?V2Ulu+QT[DpFU0w;-UlQ~gTzFda9R[=}Uw","SaveState_bfbb/bc02/1":"AAFjOOUaf$p8z4koUgu$2+d@740!@pFUaMgzTb5L7U=&bE9sS~88pxIeUovi]U!","SaveState_bfbb/bc03/1":"AANI1d9cx~}9E$1Q9vj5W+d]y!LIbuzUhRqo8},dOUqaU}UtD,+8vA:]9VS1a+C","SaveState_bfbb/bc04/1":"AAZ/EV9vfKRTc,3=9jh2o+d]w90TilZUW!D=T&&-$U3=WvUwI?0TbthI9pl|S+d","SaveState_bfbb/bc05/1":"AAWQ3(Uq^$KSG[@q8Q-liTzo-30T[d!Ut5Y=Te153UtOGrS}O~C8u9;;Ui-fnVS","SaveState_bfbb/sm01/1":"AAPhA_Uv^LM8wdRPUR@e^U!9$DLnzTcUj/rJUH2N*U/8tn9W;-w9Kz&fUvA4|VS","SaveState_bfbb/sm02/1":"AAG+epUfISL8~&RZUNBe&+5P6;K/gsCUVV&FUGhXtU))pc9W4Bt9OvIwUclWb98","SaveState_bfbb/sm03/1":"AAZz6_Ul-=5UIbMX9x5$w+5P5ZLsWJ7UXE/*T{0W,Vdz&RUd/&_9d(*JUEwU{V[","SaveState_bfbb/sm04/1":"AAJuI3UujMwT60Y_9Xzr?+5P6;zkfSEUqL{hUGC;@U~OmzUI(W99VNC_UtENGVt","SaveState_bfbb/b201/1":"AAWi:*Ued}:7:SR[TV*j?T(_x1K^N(CUjkI*T}l;)VEdhh8bvV$9F:CYUsD@~VS","SaveState_bfbb/kf01/1":"AAN&([9j}Kw8tDk+908^a+d(i703yo2Uf-na84_z!U=fwEUu+);8u|Xs9iEyq+d","SaveState_bfbb/kf02/1":"AAFjGVUY{Gp8+Y=UT~2x?98Tf]LS/4FUYcD0T)ATuVLz[[8(t@y9R{i6UbO$GVS","SaveState_bfbb/kf04/1":"AAa5UYUXI=(7;LxmTlki,+Cup1K=C*-Umy7[T0WOiUt}v:8u*kt8!jpsUd-=bU!","SaveState_bfbb/kf05/1":"AAE]NnUXvAV8:]O*UF58VVtfJSLhXM2UmJHPUCF^aVh/Sc9Y$SJ9a|@bUt|I+U!","SaveState_bfbb/gy01/1":"AAAn@cUVTJG9E+TAT*K)=U!9(u0dT)6UtYJwUEmt(U{BO*96I=*8?|FAUfclhVS","SaveState_bfbb/gy02/1":"AAZ3efUv6;!T]byO9dvinU!,mT0tEqJUaCm7UEZQ3VB_ZvUL@_a9g]6lUfLR*U!","SaveState_bfbb/gy03/1":"AAU]rhUi7aD8$((fUch^+VSEAJ0kDl:UWT@&T_hEZ9*?{!9zvk78~~KhUg3@+VS","SaveState_bfbb/gy04/1":"AAHzsKUaxv=Tk;6)9LkN0+CuqM0D[?oUk&aKT9fd*U_XtdT|kO{8;3RmUl@huU!","SaveState_bfbb/db01/1":"AAT;]+9mmm58,OQuUlUAxVSD^*0oNB[Ug?jPT/~?U+O]Gg95dt^T:GLO9iW7t+d","SaveState_bfbb/db02/1":"AAP@YqUco=?TU*CR8_fTV9FyMcLE1QRUm;[NT)8v:VEZffT5?:k9Y!NTUku?BVS","SaveState_bfbb/db03/1":"AALA=;Us-aw89o2z9dZwY+d]w$0xGIwUsBBF9AEqQUzcgXUCbuXT$[LvUXuKLVS","SaveState_bfbb/db04/1":"AAYB,jUV=[{8y^),T4QUlUwi~1LHV?nUbxS}UM@(4VGcgK9CoMc9Z{AgUiZS_VS","SaveState_bfbb/db05/1":"AAQGA8UspCm8}XETUH~T;VSD^,0BeC;UqaT7ULB3jU[T,&9fGCV9D0d3Ur&u}VS","SaveState_bfbb/db06/1":"AAC[PyUPy9DUIS2(9hweX+Cup&zpLgxUrQO/UTQhxU9:]IUgMr!8wb8yUEri;UV","SaveState_bfbb/b301/1":"AAJ(RnUrea]8DKJZTbYnkT(_w}LIuq$UvtdmT05pcU@g^58nB$X9EqP]UuI7(VS","SaveState_bfbb/b302/1":"AAH6AaUgZ&}S_4tL8uYEK9FyMsLliVUUhiuMUS(H]VMBh?Tgqt39d0+!UavXgVS","SaveState_bfbb/b303/1":"AALL,jT{xh,8!wItUvSM{VSGW]LX$4VUs27fT7MvrVe;GD9oZdl8uAB[UQA3N98","SaveState_bfbb/pg12/1":"AAI[O78L!1G9KA~GUhajqVSEB[0RKrsUh?_4UB5kiVlV8g90Jr2S4nY~8VygAU!","SaveState_snap/18/1":"ShareData=Aa&7+Ua/I}8yE4UUh$iY+3+6?Q?VSNUfy7|Te^*oV}jem9jsyn8n~PdUf7yJWP","SaveState_snap/16/1":"ShareData=ADhboUqz3PT3G1r94NVP+o+TU6m{JxUp^AuT@+U]VyTnsUfH]t9FF-UUoEhHVS","SaveState_snap/1C/1":"ShareData=AKrKZUaTXj8^J1$96D-_=IXboRd(r9Urs@u9NI!+V4l3!UaiE3UEHAmUWUI2V[","SaveState_snap/1A/1":"ShareData=AM|X79n$i:T]R!f9LFwC=Per6RRt!HUv+9~T|?o6WZOVeUDv@AUNmVb9kngFVt","SaveState_snap/14/1":"ShareData=AC^r9UdQ+-T:^:19r470=gsr_6Fi,[UZpPfT63=y=N9hwUY,kb88XX?UZ_qhWq","SaveState_snap/10/1":"ShareData=AQ?jYUibs}9U9sgUXUd@VzV0QQ{Be0UgDB7UGn}PV]C:-9r)hL9bKm~UpsFTWP","SaveState_snap/12/1":"ShareData=AW~WZ91$BxT/pDz94+9WWRw(K53WY$UjXN5T7R/$WD}JJUkr*/T?Oqz9jEUrWP","SaveState_okami/r102/6":"ShareData=AQ7MqUkkz28Lq$LUsRUeWCiG{RPg@pUZed6TFBUW+~T/U95DWy8R]B@Uho_JV[","SaveState_okami/r101/2":"ShareData=AB[iZUoVZzUKw/AUasKvWf]|Q5ZR!5UiPU39buD*V=p=k9j1O}UUzB]UjM&r=a","SaveState_okami/r102/8":"ShareData=AC1Ry9v)BwS}eLk9ALU]WJ$Rj6P*@gUfP*HT_}kn+;]dhT;B!9T?kB?9j?suWP","SaveState_okami/r102/4":"ShareData=AMMRNUrO06UJjT)T+qY}VW9klRB:~0UIHmG9oG?kV9j9:9Wo{SUgh7(UJjK6+^","SaveState_okami/r100/7":"ShareData=AHcLRUlCu+UBJL8UUE(FVSVuqQ$7I0Ub}RM9TaVV=yOsg9GR,!T*WS]Un_S?WP","SaveState_okami/r122/7":"ShareData=ABf;U9z{XW8[K+lT^|HqV6Lu354ZyLUdfzCT{OJ6V(((g9e|8pT^lfF95:4)=a","SaveState_okami/r103/9":"ShareData=ATg*0UZ6J9UUgZHT;:JF=hc(4RQ?aJUcQ2Y9i[TfV&+_K9ca/xUvWUoUbqc+=a","SaveState_okami/r101/4":"ShareData=AIKc8Um+OG9d@+eUlm;_V)YrZQ?b;PUa/~:UEZiVWD)_W9v!YF9LRSBUiI1,=a","SaveState_okami/r101/3":"ShareData=AHxSUUd-rr8!8EJURl-FWTd!T52Z3_UcEZ6UDXxtWNPAQ9ZR^i9f&HWUYoap=a","SaveState_okami/r103/2":"ShareData=AD!hI9mVo:Tap[~9Wz8x+kkm2QT[@+UZ(G6T@KIiVC0x!URrZZT(bzr9nGPj+d","SaveState_okami/r122/5":"ShareData=AUOU5UXgm!TBuUs81gr3VGY=45{Hi4UW}wfT^zlaV8z7gThN(I9K2{dUeciP=a","SaveState_okami/r102/9":"ShareData=AW:w_9lyGt8!1BtT*AIjV|]v4RBo|=Usw7PT(?8*V(@=x9O6CqUU}vq9o[c)Vt","SaveState_okami/r103/4":"ShareData=AGIfwUR9!59Q)75Us3_fV]|$K5$:msUr]}7T^?d!WKygv938b/8}*l&UPIFk+^","SaveState_okami/r122/4":"ShareData=AL(=cUE5t59cU4]9l^p:V$mB[RA|t$Ug4Wz9TPCGV;*b0UpV,pT=:^!UT{aO=a","SaveState_okami/r102/2":"ShareData=ALr|cUiUqRT]NwpUTK4LV}L[O5bXd)Ui8L09G*@~V-DJ)9ceaPT^hnyUXh^+Vt","SaveState_okami/r122/8":"ShareData=AOS5$Uly{yT$dV!9q=3C=iS+8Q]2s4UdKRDT[ByMWI^7)UszoT8]O{cUu~iSWP","SaveState_okami/r103/5":"ShareData=AYm_1UQTsK9Vr/AUbdC$=Y!nWQ(,]_Uo,8PUBXerV@Ain96_q78)8fpT|(4a=a","SaveState_okami/r100/1":"ShareData=AFJCz92J)tTdrQQ8j*)SAMDy|Qvh9sUg+jmUVH5=AS@1)T&F99Uj=Pc9g&VVAA","SaveState_okami/r102/1":"ShareData=AJ_Zo9howPUFbE;9p41g=b~qp6Sqq)UflG3T{L1lWUD+qUq2PHUC7fO97X}]=a","SaveState_okami/r101/5":"ShareData=AW)6[Uj:!+TVs$MTrj/;U8NUo6U8Z2Ug0tg9GW=JV(z6}88X{MT^A6^UhBQm=2","SaveState_okami/r103/6":"ShareData=APPJ3T}kLH8a@3t9ub5-=BOX,Rbl/;Ut(I_8hbeDWF/ALUnK9&S]9&_UMm7{=a","SaveState_okami/r100/2":"ShareData=AC]kl9rdYiUP45L9u;{7=KPSP43ZJ7UkZSSUPpLQ=tsGzUZ+djUIx{c9rcT*WP","SaveState_okami/r102/3":"ShareData=AN{QcUrOH(8yh;TT0;q3VCsSf5}ow}UbgJgT}Z!BV-QBe8$s/u9HSIqUfY7P+^","SaveState_okami/r101/6":"ShareData=ATHEFUn1bk8N{Q38;?}6U/L[r6hzZsUusbI9TKK)WC-4wT_milT{+x[UZOwU=2","SaveState_okami/r103/7":"ShareData=AI$F|UpI$*UEXlfUpa:S=Nk,SQ$w]dUelII9Mq$1WHY!k909xxT)9lkUYo1A=a","SaveState_okami/r100/3":"ShareData=ALIKZUXruu8t=LZT*91JV!MooQ-RfbUpF;6TuAC3=1:}n9dn{F8t],SUwMp&WP","SaveState_okami/r122/1":"ShareData=AOS5$Uly{yT$dV!9q=3C=iS+8Q]2s4UdKRDT[ByMWI^7)UszoT8]O{cUu~iSWP","SaveState_okami/r102/7":"ShareData=ACr{P9z!XPT@xfT9Y-mkV@i,^6T4]UUr|A3UAMbk+*_9@T|6-YUD-];9ohBIV[","SaveState_okami/r101/8":"ShareData=AO8,_9jAU_T&@[Y8@~p-+{,~ORVgSVUaqaRUL;,OWP@EcUDl{0T}b0L94jHi=2","SaveState_okami/r103/8":"ShareData=APT]kUmdaaTrzs~T2=Lu=X3;HRGsWOUjI$-9H_^RWEd;_8*5Y@UHPs1UY9SC=a","SaveState_okami/r100/4":"ShareData=AHluEUoqTHTkjAaUc=|XWBxqJQ^o@xUb$4$88ep?=uw]@94IxVToks3UfM|YWP","SaveState_okami/r101/7":"ShareData=AZWlTUoNUVUP*n3UHDkpV8&1~6oni2Ub}5R94$CJV}_8F9a|}RUvF1wUaCUj=2","SaveState_okami/r101/9":"ShareData=ADNWz8/4t@UCKEi92d5L=ZTy^6f?XfUVVnYUQx-3Waz*$Uv}nfTm+U|8/f+t=a","SaveState_okami/r122/9":"ShareData=AX41hUi,WJ89n9h9c~oR9^^YDQV(f^UeI:r8&@9kVjsuIUDmLST8xF7Ugt+[Vt","SaveState_okami/r103/1":"ShareData=AN,fLUeD+i9Q+BIUm&]dWh8Az5}$,jUkn]GUsg8WWbNY-94![O9HXeqT|(fsV[","SaveState_okami/r100/5":"ShareData=AIo~;UXHnBTn2FhUFBJcVpz~uQqpceUh5YG9W_f]=vzH)9NAj6UAyc4Ub)oGWP","SaveState_okami/r122/3":"ShareData=AO7HTUjVpc8pZ5;T[-f)VtL]N6J?(~Uc?z^T*vF,V1SIE8_@gP9GUM+Uq)K9+^","SaveState_okami/r102/5":"ShareData=AZ2[PUta]UTc8s+Uf/-PWMoWzRFv+QUWk)|8k8YLV-ngx9ndLVTYN?)Uj|O(V[","SaveState_okami/r101/1":"ShareData=AU}RFUu$V38LDiPT(?G3Wkg1LQo*c!UpAWtTxYY=WXqCq9SDvb8sJq~Ujc=aV[","SaveState_okami/r103/3":"ShareData=AG0YXUn-Y_9gS3cUbInKV-l,7Q3u=(UqA~DUNumIV;RR*94Rl@9M)xDUVk9g+5","SaveState_okami/r122/6":"ShareData=AT93DUWgMaT:GtuUMr!QVXhpr5!;KtUh)J,9OP!AV+|D99U?gNUDfR?UV)&Q=a","SaveState_okami/r100/6":"ShareData=AHLc~UbCwl8YIZ;T6EF&U~}bAQnb/SUgS/QT=,Qi=e/529A7xv8}-*[Um;$~WP","SaveState_okami/r122/2":"ShareData=AaoD(Uikq39B@l:UngfGVzl$j6C=QzUsz7/T+[DOVhH6996PZY8$r+~UsC/f+5","SaveState_klonoa/s000/1":"ShareData=AbUC!9iSVuT~qfo9Vs,D+6Fd45,e/JUd^DXT*bl|+u,OLT|ZUxT*Z7G95/Bj+^","SaveState_klonoa/s001/1":"ShareData=ACG[gUth]+T}wBX9wvW{+(O$uQf)zrUhPm_UMp(ZV2&6?UvU:*9V?ReUa&_QVt","SaveState_klonoa/s010/1":"ShareData=ASc|JUml]K8sr{NT[o|$VS3OBQWXs|Ui,h+UPf:9V7xyZ9Cu1^9Z=!6Urh-oV[","SaveState_klonoa/s020/1":"ShareData=ACzV9Uo[&?8,-v}UStN[V?~)sQRC,)Uc(9QT)RkAV2nu{9e6Kt9ZkGQUgnEqVt","SaveState_klonoa/s030/1":"ShareData=AWRQIUm+-0To&QO8/G26+h*T)5MNzkUfku9UU]M]VYlmXT5Dly9f6mUUeAYWVt","SaveState_klonoa/s040/1":"ShareData=AQ&Y/UizxrUG+qQ9j=$e+81DsP^njJUY@gxUFnHWV~A@+UiJ4w9I+OmUW$G]V[","SaveState_klonoa/s043/1":"ShareData=Aap&8UV|s@T4[QJ9wl-3=G$K!Qzqa7Uiv5OT8_x[VhxTTUjL0(9Ed&YUD9x3Vt","SaveState_klonoa/s050/1":"ShareData=APUVvUeXhBTNPB@8_07]+Hm6o56~kRUc-AIUKAIlVKB~6T6^9+9Ufm?UVku,VS","SaveState_klonoa/s110/1":"ShareData=AB@JbUg14uTcSxd8,41FV77Ki5/t)GUZUQ)UMd|mV=w5AT4JDR9Ju_oUX}QZV[","SaveState_klonoa/s111/1":"ShareData=AP_z0UbQ4{8bB6tT$,TR+swmTQ1m_|UV$omT,A7|V=pVx8@?;+8@$&EUZ,9mVt","SaveState_klonoa/s112/1":"ShareData=AFH2T9y}W?T$Qbx9sHbSV4y!}QvO|=Ug=zlT7_n}+n81@Uj7F=T[Pte9mk_@+5","SaveState_klonoa/s113/1":"ShareData=AT8N3UhP7s9EV_NUMinzVgx:vP(WnDUuL42UQv+1Vme1_9cZqM9Ps3(Ue,QsVt","SaveState_klonoa/s120/1":"ShareData=AM+T8UXI@/TionZ9GX}E+@T?C5,umgUh3=cT[b[UU5jk6UDv-(8@=BaUa]3)Vt","SaveState_klonoa/s121/1":"ShareData=AOD{UUNT[fUJb/G9yX[k+:}OnQy9E5UZ7hWUEvzSV/B[AUiI{(8@[6*UKI!f+5","SaveState_klonoa/s122/1":"ShareData=Aa?(NT?!M/9B_,AUcg2?V|os06MKAOUpbwYT&vn5+ewz79r2S08nZ|cT~V};Vt","SaveState_klonoa/s123/1":"ShareData=AISYdUnsG;S5FI/86!+v+nASHQDdh7Uq_qEUPohBVl[uwTtX8(9L{DYUeVDSVt","SaveState_klonoa/s124/1":"ShareData=ARf_/Ukv,vTFFA88-ZD-Vk}aGQ{=BUUbp5zT{5i1U/8DhT=qP]9F8A|UcZ4HVt","SaveState_klonoa/s125/1":"ShareData=AO&/lUg!eA8~7w[T=n]jVKK0}5UfK~Udl1/UH4/QV?BuJ8_cL89fKiGUXEabVt","SaveState_klonoa/s126/1":"ShareData=AYPU5UpGf,T,Nl|9e@D@+H^/_5JZ8+UYT{1UB@7HU7!?KUTs!y9Vn2rUaZ|;VS","SaveState_klonoa/s127/1":"ShareData=AR-sJUPD8]T6~8^94t|E=P$UyQ{IICUV:ilT_S|MVY2gPUdVrp8qUjwUP~AGV[","SaveState_klonoa/s210/1":"ShareData=AH:y9UqBSG9C(mnUk92^V9Od,QRgH8Ub+x!UAm,IVw?}u9j,gc9TE:|Unjx9V[","SaveState_klonoa/s211/1":"ShareData=AM4C_Ur2cF8gaNjT~+BCVv$f&QQT)nUh^qJT|QTJVg,l98@3*:9a)_SUlXVi+5","SaveState_klonoa/s212/1":"ShareData=AS+C;UfdTq8^!1*UE:y;+^r796NztOUZUQ)UPU(CV,^-!9P;Fg8{vEgUnJD:V[","SaveState_klonoa/s213/1":"ShareData=ALYqaUMvIuUO[H!95K=r+{z;tQWh|lUjb~eUQ;DY+0qqnUn3S78|BPKUQ)*[+^","SaveState_klonoa/s220/1":"ShareData=AD@d6UW4q$T5YJLUfw7&WG3{$QzBbGUf3P{9bcK~+:/gv9pF6yTz1~KUo?a5V[","SaveState_klonoa/s221/1":"ShareData=AG?hW9rYLIT!)jP9PyzR+*kpTQ4mJkUj|C7T:VlY+[vR2UB40PT?|!n9hj|E+^","SaveState_klonoa/s222/1":"ShareData=AOXifUq1@E8iX+dT;^=DV=m?dQkCyPUZa~YTs5ThVwPlz8@]u+85fiMUb,muV[","SaveState_klonoa/s223/1":"ShareData=AE;6NT~FeOT{gV:9ywQ++[5~3Q5|z9Ur?ROUUo[hV5)sCUq~Ic8PvS^T$X+m+d","SaveState_klonoa/s224/1":"ShareData=AUsORUub@LUB/(Z9v865=aC/[5?H_0Uf4{=UAEAF+4M{SUdL$*8[/iBUbg1BVt","SaveState_klonoa/s225/1":"ShareData=AO$-(UZ[[f8&KIGURk3gVex:e5gVjpUWH~eT&?u)Vs6Ev9HTy=9En@&Ur_-_Vt","SaveState_klonoa/s226/1":"ShareData=AK}a;Upu=?8]y_CUGt/^VSG]:6EQVnUkLfCT~9TcV7,nD9W+lz8?HvIUgk5rVt","SaveState_klonoa/s310/1":"ShareData=AFW~GUavmK8]{ThUNIQzV02ziQ)&=7UtKM,T1koTVgw+g9L_,s8}S{nUlX8:V[","SaveState_klonoa/s311/1":"ShareData=AIa0JUv/^_8g8ZfTuNM|Vl]i(47LybUeK43T&Hi$V+fqh88dq08^Q1WUrrB_Vt","SaveState_klonoa/s312/1":"ShareData=AAhOX9pkYR9F0m@UXh6MVX5oV5vK:VUmSTGT|XCMV+]nv9xBw$T6+Wi9kwAM+^","SaveState_klonoa/s313/1":"ShareData=AQ;5l9wo2_T/?E;9v}X[+/mB-5q;APUn0lIT,I]OVuaHhUhHfkT:-W&9qMGT+5","SaveState_klonoa/s314/1":"ShareData=AK9tTTxZ4GT9x[R9m6on=YDd/Q}!_9UYO)@Tz^{5+/)}CUd8~k8Oe+kTv@fV+^","SaveState_klonoa/s315/1":"ShareData=AMTIn97j(k9BeuzUb79i=Z8xJQemG0Up2,bT5L^~V,JsG9o+f8T1c1c9o2wP+d","SaveState_klonoa/s320/1":"ShareData=AKCrbUll}m8^U7CUwN!=V2YCd5yD[4UXZ{?T-N5UVV]Mb92XP98:KuTUuuq,Vt","SaveState_klonoa/s321/1":"ShareData=ALKqRT)+P0UB:*49xe9m+(2jBQw1w9UWITAT{F3@VXhiGUVY+G9BF8;UJsc|VS","SaveState_klonoa/s322/1":"ShareData=AW:2wUpxfbT|0n!9TPuu+7EPo5,*^4Ubt|!T|~XmV_3X/T)^mJ9ftNjUn1y~Vt","SaveState_klonoa/s323/1":"ShareData=AJH}S9w-lX9QAA2Uux}gV:J&w6L5$_UnZnPT{LkIV:j||9j456UA2xL9nPi|+5","SaveState_klonoa/s324/1":"ShareData=AN~Ci9u_:{8~cB?UnNjmVwNs!Q3rzAUf{$,UK=v?VTzOa9hDHPT;O8P9p]2:+5","SaveState_klonoa/s325/1":"ShareData=AWt779nl1]T&Q[*9q41&=Y$c05|jBfUcjtnTz[WcVS!KAUr,!rT_GE69u)|]+^","SaveState_klonoa/s326/1":"ShareData=AE3znUR!?o8*?5z9i}:E=Qnp{QS[yhUq9LO9PM:7VE,Z~Ut,NKTtSA6UMpjSU!","SaveState_klonoa/s327/1":"ShareData=AY)FGUZvpL8v_rUT!-oGVj_nCQa=-VUb89[T?x?ZVk!}O8{{J48_5(9UZq})VS","SaveState_klonoa/s328/1":"ShareData=AI:~:UWa,781ioeT~$/DVhaTKP,H}7Ud1vEUI)1lVqp~W8=vm09GY:qUVaPiVt","SaveState_klonoa/s329/1":"ShareData=AK!Z9UovD38m:^3T${~]U&*B75mF|4UwCK7UFButV/Bex8@TJM9b88GUb[?zVt","SaveState_klonoa/s410/1":"ShareData=Aa~hUUj;*tT?lHI9I;TJ+*vrCQ0vp0UmPFfT|PGzV[HLWUSUPv9L&L&UrKqVVt","SaveState_klonoa/s412/1":"ShareData=AD:|99nI3iTpK6=9A2PA+95qoQz}{PUg~}HUBRM:VwZA)T,*DGUH[22923|6+^","SaveState_klonoa/s420/1":"ShareData=AY{knUmp&+8(8R[UAFd5V~?@&PUYz(Ub]BGT},_sVjOF(9nx!29VMVTUrRxzVt","SaveState_klonoa/s421/1":"ShareData=AFAIyUccTNTancG9Xu;?V4GuEP{Nq$Ut^$qT2uBEVh4XKUL7Nd8}hXZUcd6NVt","SaveState_klonoa/s422/1":"ShareData=AaQ|-UgkEMT3Yt]9e]!}+D&b=Q-YIiUa2gXUQxtTV9d8@T^/zt9GcQdUW}caVt","SaveState_klonoa/s423/1":"ShareData=ALAtjUbEU*8{T3tUnb&AV+U:WQGnS2UrM|mT^}tvV+i7R9r/[*9D0UVUaqacVt","SaveState_klonoa/s424/1":"ShareData=AJ?t;9kYqST](8C93Fdw=Ty:BQr,4{Uj-p5UCz/+V@TglUnaZrUI^cY959,v+^","SaveState_klonoa/s425/1":"ShareData=AFYx-UZ-)0Thoe/8~D$s+8rEM5(F+pUtVnqUKb,@V^qP6T9Q2s9RiPCUpceJV[","SaveState_klonoa/s426/1":"ShareData=AW-j,UcWQwTnHRo8_C*D+3J@:QTMh1UcJxCUJq${V85+:T4Zfx9F6|1UgEirVt","SaveState_klonoa/s427/1":"ShareData=AJ7{}T{W/TTuEdy9zr:p=YJ)e5GmMWUff~OTeZ/LVoho,UiGF*8iCA?USUTpVt","SaveState_klonoa/s428/1":"ShareData=AG6TCT)D,7T+d:u96$+F=Z6w_Qwq4NUs3lLT0d=kVgykwUbO]|8+5{{UCQ$WVt","SaveState_klonoa/s430/1":"ShareData=AVdl)Ukz5nTcdZp8[j_9+ziD&QIQ)6Ucm_(UNZgQVzf/cT-_)A9Uu6@Ueh7:Vt","SaveState_klonoa/s431/1":"ShareData=ASi):8/r!bT4ia(9s~5w=F-j+5/s$=Uf[WDT@$,$VjA3)UVzc3Tcc-u8_V[SVt","SaveState_klonoa/s510/1":"ShareData=AMxJXUcj:DT:^Td9kD}q+{bJE55!Q$UsJEbUUN_bV;f=BUlp9j8~I8HUrA$,V[","SaveState_klonoa/s511/1":"ShareData=ABh=CUakrQ8{:FpUoKnFV5AbCQO=KgUtbeRT3:_TVH$0G9qQT(8/O&5Unq:LVt","SaveState_klonoa/s512/1":"ShareData=AQwRrUNLy!UMqw89nUju+^PB[QxU*KUcFfRUIi~]V58LtUva{Q8,vq&UO^$PU!","SaveState_klonoa/s513/1":"ShareData=AU;I886YzGUI/+Q9qgV4=A/j3QfMqXUeQ)WUTsO=V2b8NUt5ZPTQHwW88*/|+C","SaveState_klonoa/s514/1":"ShareData=AGiNOUk;QH7(OnDTdk[ZV;2/05;+fHUq*3_UKY|;V[1tr8tJm/9I=@)Ujzp-V[","SaveState_klonoa/s515/1":"ShareData=ASb=s9X]rp9P!+PUnl0vV~72-5yHG7Uj{nAUBU^kV~?k:9qYkxT&|Cw9N^BcVt","SaveState_klonoa/s516/1":"ShareData=AI/kfUl{MV9BvLaUY8O(V}0+c54!6]UgPH2T4kKqVljFY9tlF287&y3UczL~V[","SaveState_klonoa/s520/1":"ShareData=AIk^fUeOT^T?=s09R3}4+w8np4(l$WUdjjCT*Z+mVfsFKUMA2w9J$VFUi{bIVt","SaveState_klonoa/s521/1":"ShareData=AA0FE9lj^(8?^A7Uk[*{WJ!smQsD2aUrhgXT1kKRVVPIy9oG{YT2uj,9l5[P+^","SaveState_klonoa/s522/1":"ShareData=AY-bQUalhc7!4QATlIum+NP1c4/A2LUa?8OT3tCDVaOA(85qee8}XC*Udf8i+d","SaveState_klonoa/s523/1":"ShareData=AW/f=Uc5ujTtgLh8@{TR+1o,4P-W,GUg}@$UBAP&V7My}T]QuF9a8*[Usj!^Vt","SaveState_klonoa/s524/1":"ShareData=AZ!?A93aLHT@yVE9gm/b+7P+kQV~_IUcFfRUK!~1U$FcvUDTQEUL!UN9uFWi+^","SaveState_klonoa/s525/1":"ShareData=AMpA-UttT!8:wRdT9ksJU(g|d5s-bXUuif^US^)GVo2Ha9e4z=9eU2dUVj}mVt","SaveState_klonoa/s526/1":"ShareData=AR8j&9RQpkT*aiy9khm0+(HT5Q&q|5UXWk;T)QcAV_Zq[UdS[vTcWAO9R8Y~+d","SaveState_klonoa/s527/1":"ShareData=AL?NK91@=f8/b+hUs:j=VxQ4|5GABvUb=NOT{rx&+ki$G9lWIhT)c@,96NIw+5","SaveState_klonoa/s528/1":"ShareData=ADx}N8$fdHT{pV99jXRo+|2^SQ_1QfUu{[OUM:?oVzePZUtrIpTx3M28;X^U+d","SaveState_klonoa/s530/1":"ShareData=AS7So8n:k_T$Z0q9sFuI=Vh305_^q,UbPf:T(Y5MVT=NLUoZXbTJ=}18w}(N+d","SaveState_klonoa/s610/1":"ShareData=Aa}=092:Hy8zS?^UO:znVx+!{QIdo@UXaW/T3fl|VfkfV9Hod-T1HUM9jt@!+^","SaveState_klonoa/s611/1":"ShareData=AE:R4Ut]]_ThprG9e=j_+e-W&4__DiUuI}rT@AKaV:Vm[T^go/9FY9VUWS&=V[","SaveState_klonoa/s612/1":"ShareData=AYzs9UoIgvT+M0[9dm~A+9tX0QmN6XUql5=UL^Wo+pUu2UEc/R9Qu,;UuQteV[","SaveState_klonoa/s613/1":"ShareData=AR2?o90[,~TjQIj8?/gv+?S3dQwlXdUr82pUTj7ZV2mg)T/4jOUQUxe96u[J+^","SaveState_klonoa/s614/1":"ShareData=AL~C+Uk;BT8{Ne7T}A?@Vy$L95?V4LUui;JT{]x:V1R!*9R&9,9KcsiUuTnsVS","SaveState_klonoa/s615/1":"ShareData=ARTOET}(7+UDNU]96Ci(VY8b!5Iw[RUv8T]UR7g3VztRMUlI&T9BK:MUDq4xVt","SaveState_klonoa/s616/1":"ShareData=AAp)j9q[3sTd)_s8{*Qy+-W(|P)[(EUWPwhUR:n9Vy5a8T:eIaT}Nu79n@r3+5","SaveState_klonoa/s617/1":"ShareData=AEKk|Uke}h9M/$TUrJh;V8DZ85/8m?Ue?ecUII+uVzX3W92(@X9VGG+Ua[^y+5","SaveState_klonoa/s620/1":"ShareData=AV9uPUk/)c9OXpdT)SiVVtH@L5oA8YUW?6(UIm5BVd=Z{9tT0k9YSU?Ul?$/Vt","SaveState_klonoa/s622/1":"ShareData=AGZNVUD~AmT5ILf9zUTh=W$235h=0+UuDeYT_?-!V,Y39Uj-1X84AS3UK,-@+5","SaveState_klonoa/s623/1":"ShareData=AKG0*9cf0I9U]W3UcnCAV6AloQi90XUb}Y,UHA@-Vv=:u9tM})Tz}x?9gyRMU!","SaveState_klonoa/s624/1":"ShareData=AYz[DUd2P}8]FK@T=ciHVgwCuQV[~CUV]eeUBfeVVj/WE8{v;V9gC=[UtrC;Vt","SaveState_klonoa/s625/1":"ShareData=Aa]?{UhFsS9Vf|YUqet{V5[AV6Ie9HUe1ndUBOJ0V/^{/9vyfU9QrmEUn):DVt","SaveState_klonoa/s626/1":"ShareData=ARVQ{UM!*6T}waX9iO83+)WHx54y=qUc~3PT}G23VnCfgUd6:s8}dz9UM:viU!","SaveState_klonoa/s627/1":"ShareData=AN-8/Ua]/jTqb^[9SZ,5Vbve~5I^!SUj1gYT@bk8VjEERT)t/08^OnpUa8)QVt","SaveState_klonoa/s630/1":"ShareData=AT1!0UhyD*SP1!aTv)0F9!VF/Q*{$aUYgeB86nH|VsF;x8q|A@TkHElUYWS1V[","SaveState_klonoa/s632/1":"ShareData=AI}K$UYZLx8}&f]UY!DKV:7t(5Yw,:UeZu|T[k&hVwS{:9o1;D8)q6MUv/baVt","SaveState_klonoa/s634/1":"ShareData=AR:d2Ud9~N8r;joT~qxA+7FG_Q6,~bUe+YbUQCX+Vene$8?(y$9ahF2Uv8IiVt","SaveState_klonoa/s635/1":"ShareData=AZPSJUbQF)TO$*M86duYV3m&}5a4c9Ud-k@UBj]sVY=&(Tm|$j9RD?^Uo,bBVt","SaveState_klonoa/s636/1":"ShareData=ADQn1Upw^18NK{dTm]E3WH[@HQ:^?dUc8MnT{$LsVsV4+8rU6+9ZgAJUu$$JVt","SaveState_klonoa/s810/1":"ShareData=AQQ!4Uvp]RTH61A8|Cg[+pO6aQsWLkUltABT^G$i+4*4FT@zJd9V6kAUmPb?Vt","SaveState_klonoa/s811/1":"ShareData=AMM@lUVP=bTE-1{8&pH?Vt/niQLN:ZUrHI~UI,}uV-WEET&Fu*9Gs2HUY|)~V[","SaveState_klonoa/s812/1":"ShareData=AOhq+Ug/$?S|J_U87fS{Vn^F45kxp6UgY0CT)gOXVyU@gTlU}A9UB?AUi8FzVt","SaveState_klonoa/s813/1":"ShareData=ALHpdUVU188@k-iT|t+2V8SZf4$|s]Uqeb9UM,G2V1seX9KP_59YBInUt-2oVt","SaveState_klonoa/s814/1":"ShareData=AR^ALUkZhcTrooD9R|ca+2a+!QQi5eUl=MDUQwFlVWu2YT)i8^9J~?HUiT(wVt","SaveState_klonoa/s815/1":"ShareData=ALgk8UjBAv8yj_eT~~YNV8L^*QYvIFUk0(iUD|ghVbSLn8(dyD9dz2dUa|inVt","SaveState_klonoa/s816/1":"ShareData=AVwuYUfK_=ToaIG8{xLB+8H2s5kh3gUf7@nUOdQS+O6U~T[BfT9g4{(Ug@9]Vt","SaveState_klonoa/s818/1":"ShareData=AV@BvUbF_4T-&Gm9S]-)+xFZJ5g6r8Ud6zBUH$MRVzzW&T{^LD9g1pwUi5P}Vt","SaveState_klonoa/s900/1":"ShareData=AMt9XUla_bTvEg69gG1I+FJ}EP|8p*UwV&dT/)^~VDxt=T^7T,8/YXzUs@IOVS","SaveState_klonoa/s901/1":"ShareData=AOP098[Fmj8Xb_fUi@f2U}i={5~aBWUo?fNTALd]Vk$7i93r4QSi=X48}yr]+5","SaveState_klonoa/s902/1":"ShareData=APX)-Uu74{TxvJi9V^kCWA}d+Pui~OUn(}]T;,LyVpagyT}kab8}DlhUut5eV[","SaveState_klonoa/s911/1":"ShareData=AS7XV9YboNT~y$U9r(,N+=inm4{)n=UfEEFT4|3jU$zL~Uph;WTqT9D9Y9)!Uw","SaveState_klonoa/s912/1":"ShareData=Aa[]XUrU=g8;GqAUE6M)VVG]SQe2+MUg&}NT-5}+Vj,Gd9TI0B8}h;aUd5-eVt","SaveState_klonoa/s913/1":"ShareData=AQIO_Ue!9I7ZFPL8&xZ6=Fs,(5;@+SUo?fN8UpzAV339jT1$||TH5{!Uq;2fVt","SaveState_klonoa/s920/1":"ShareData=AIoz-Ul*^pS=!te8^P3IV=tEl4^P4UUk8NQTu$Kg+{jd-T]axd82LE+Ue^OcWP","SaveState_klonoa/s921/1":"ShareData=AJhi*Un=_D9AKmZUlrMMV^90e5|J=}Uhd!nT8:nJVUWk89jmvN8(h}BUwd1CV[","SaveState_klonoa/s922/1":"ShareData=AG4!hT-iEU9K62yUX4pmVzXDm5~/?GUrKo4UCL-8Vba=/97k,88f&dWT;ZU3U!","SaveState_klonoa/s923/1":"ShareData=AIoz-UuTsCTt,VN8}z;;+ij/h4k6BwUb{ZQUKRuaV~y,VT&W^C9MKqGUa6LEV[","SaveState_ssbb/adventure/010001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AW=_jVSD^,AAAAAAAABrUvF(tVt","SaveState_ssbb/adventure/030001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ALF]eU!9!_AAAAAAAABrUq-3yVt","SaveState_ssbb/adventure/030101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ASs$rU!9!_AAAAAAAABrUv{~QVt","SaveState_ssbb/adventure/040001.pac/1":"ShareData=AAABrUVH5=AAAAAASi+nVSD^,AAABrUVH5=AVbSm+^q,aAAAAAAAABrUf?XuV[","SaveState_ssbb/adventure/040101.pac/1":"ShareData=ANT=*UV,]{6?PcLTA[8vV~7Qb49npCUZ$sCTApl5VgMFJ8T*|R8i^UxUn$d*Vt","SaveState_ssbb/adventure/040201.pac/1":"ShareData=AAABrUVH5=AAAAAAZB}++^q,aAX:-JUgZ=TTJ3:|V[6R;ALSFp8gkxaUY5bKVt","SaveState_ssbb/adventure/040201a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AVfm*VSD^,AAAAAAAABrUVaEuVt","SaveState_ssbb/adventure/050001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUa7KTVt","SaveState_ssbb/adventure/050102.pac/1":"ShareData=AAABrUVH5=AAAAAAKXKlVSD^,AAABrUVH5=AUNL8U!9!_AAAAAAAABrUl3,tVt","SaveState_ssbb/adventure/050102a.pac/1":"ShareData=AAABrUVH5=AAAAAAH7R*VSD^,AAABrUVH5=ARm[eVSD^,AAAAAAAABrUt@M_Vt","SaveState_ssbb/adventure/050103.pac/1":"ShareData=AAABrUVH5=AAAAAAIv23VtfI:ANBz(UepvtTQh_kVSD^,AJh@:8V3lKUs@Q)Vt","SaveState_ssbb/adventure/060001.pac/1":"ShareData=AAABrUVH5=AAAAAAN@N=VtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUoS;1Vt","SaveState_ssbb/adventure/060002.pac/1":"ShareData=AAABrUVH5=AAAAAAa|9(VtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUYHP6Vt","SaveState_ssbb/adventure/060002a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUo|JHVt","SaveState_ssbb/adventure/060003.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUizFoVt","SaveState_ssbb/adventure/060004.pac/1":"ShareData=AAABrUVH5=AAAAAAEc3(VSD^,AAABrUVH5=ARc|GVSD^,AAAAAAAABrUbJ{JVt","SaveState_ssbb/adventure/060004a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AP=!uU!9!_AAAAAAAABrUWx6AVt","SaveState_ssbb/adventure/070001.pac/1":"ShareData=AAABrUVH5=AAAAAAIZ8@VSD^,AAABrUVH5=AR/eiVSD^,AAAAAAAABrUv4XTVt","SaveState_ssbb/adventure/070001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AI:tSVSD^,AAAAAAAABrUXe}3Vt","SaveState_ssbb/adventure/070002.pac/1":"ShareData=AAABrUVH5=AAAAAAOzNoVSD^,AAABrUVH5=AZeGRU!9!_AAAAAAAABrUW?]oVt","SaveState_ssbb/adventure/080001.pac/1":"ShareData=AD0=5UqJiVS0I/o8n-2)9}xO/3S)({Ue3p(TLs2lVojKaTvm_T8ivYaUcgfgVt","SaveState_ssbb/adventure/080101.pac/1":"ShareData=AAABrUVH5=AAAAAAQPh9VSD^,AAABrUVH5=AXD5,VSD^,AAAAAAAABrUqP9,Vt","SaveState_ssbb/adventure/080102.pac/1":"ShareData=AAABrUVH5=AAAAAAGqPuVtfI:AAABrUVH5=APG|(VSD^,AAAAAAAABrUWF8@Vt","SaveState_ssbb/adventure/080103.pac/1":"ShareData=AX:-JUVH5=ALSFpS^6w~VSD^,AAABrUVH5=AT}~!VdWFW8I1/RAX:-JUkAnhVt","SaveState_ssbb/adventure/080103a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AN;=aVSD^,AAAAAAAABrUq^I2Vt","SaveState_ssbb/adventure/080103b.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAX:-JUgZ=TTST~cVSD^,ALSFp8gkxaUkcO1Vt","SaveState_ssbb/adventure/080104.pac/1":"ShareData=AAABrUVH5=AAAAAAN]0@VSD^,AAABrUVH5=AA{]eVSD^,AAAAAAAABrUpo+rVt","SaveState_ssbb/adventure/080104a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AJ8x4VSD^,AAAAAAAABrUZIQJVt","SaveState_ssbb/adventure/080104b.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUo*XFVt","SaveState_ssbb/adventure/080105.pac/1":"ShareData=AAABrUVH5=AAAAAAG)62VSD^,AAABrUVH5=AC+TVVSD^,AAAAAAAABrUjz?lVt","SaveState_ssbb/adventure/080105a.pac/1":"ShareData=AX:-JUn5{BRn93)TMd$q9zyYFOIra0UgZ=T8d=wJVdfLX8SL-qTQ|ziUb*7UVt","SaveState_ssbb/adventure/080201.pac/1":"ShareData=AX:-JUVH5=ALSFpTOWzzVtfI:AAABrUVH5=AFyQWVdWFW8I1/RAX:-JUVz^UVt","SaveState_ssbb/adventure/080301.pac/1":"ShareData=AWi:*UZ86y7KwSNTP3q0T55_3O0omnUey1uS|I=?Vbz;{8c;~O8Q=MwUe0QFVt","SaveState_ssbb/adventure/090001.pac/1":"ShareData=AAABrUVH5=AAAAAAM2MmVSD^,AAABrUVH5=AB=,PU!9!_AAAAAAAABrUj[bWVt","SaveState_ssbb/adventure/090101.pac/1":"ShareData=AAABrUVH5=AAAAAAKEXq9FyMUAAABrUVH5=AE-uIVSD^,AAAAAAAABrUhJACVt","SaveState_ssbb/adventure/090201.pac/1":"ShareData=AAABrUVH5=AAAAAAU)](VSD^,AAABrUVH5=ADlS&VSD^,AAAAAAAABrUgG)6Vt","SaveState_ssbb/adventure/090202.pac/1":"ShareData=AAABrUVH5=AAAAAAQGZ:VtfI:AAABrUVH5=AP]O)VSD^,AAAAAAAABrUkZ78Vt","SaveState_ssbb/adventure/090203.pac/1":"ShareData=AAABrUVH5=AAAAAAN-khVSD^,AAABrUVH5=AF/d;VSD^,AAAAAAAABrUZRu)Vt","SaveState_ssbb/adventure/090203a.pac/1":"ShareData=AAABrUVH5=AAAAAAUg5K+d]wYAAABrUVH5=ABbyjU!9!_AAAAAAAABrUWWD-Vt","SaveState_ssbb/adventure/100001.pac/1":"ShareData=AAABrUVH5=AAAAAAPDl{VtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUXGwlVt","SaveState_ssbb/adventure/100001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=Aa{/6+CunXAAAAAAAABrUeS*aVt","SaveState_ssbb/adventure/100002.pac/1":"ShareData=AAABrUVH5=AAAAAAO_*N+5P5ZAAABrUVH5=AM1ODVSD^,AAAAAAAABrUr{P$Vt","SaveState_ssbb/adventure/100101.pac/1":"ShareData=AAABrUVH5=AAAAAAERC-VSD^,AAABrUVH5=AAG~;6O9QLAAAAAAAABrUdZh4Vt","SaveState_ssbb/adventure/100201.pac/1":"ShareData=AAABrUVH5=AAAAAAN|sC+5P5ZAAABrUVH5=AP=!uU!9!_AAAAAAAABrUp0QIVt","SaveState_ssbb/adventure/100202.pac/1":"ShareData=AAABrUVH5=AAAAAAPBoh+^q,aAAABrUVH5=AA^n=VSD^,AAAAAAAABrUlfVNV[","SaveState_ssbb/adventure/100202a.pac/1":"ShareData=AAABrUVH5=AAAAAAG,HQVtfI:AAABrUVH5=APd|zVSD^,AAAAAAAABrUc7eMVt","SaveState_ssbb/adventure/100203.pac/1":"ShareData=AAABrUVH5=AAAAAAQI}3VtfI:AAABrUVH5=AI43AVSD^,AAAAAAAABrUc^GqVt","SaveState_ssbb/adventure/100205.pac/1":"ShareData=AAABrUVH5=AAAAAAQ^6_VtfI:AAABrUVH5=AWYW!VSD^,AAAAAAAABrUgyjzVt","SaveState_ssbb/adventure/120001.pac/1":"ShareData=AAABrUVH5=AAAAAAO+b1VSD^,AAABrUVH5=AAAAAAAAAAAAAAAAAABrUnoc}Vt","SaveState_ssbb/adventure/120001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AABqPVSD^,AAAAAAAABrUZ|mfVt","SaveState_ssbb/adventure/120002.pac/1":"ShareData=AAABrUVH5=AAAAAAT-|AVSD^,AAABrUVH5=AC1NUVSD^,AAAAAAAABrUq1PZVt","SaveState_ssbb/adventure/120003.pac/1":"ShareData=AAABrUVH5=AAAAAAY&G!VSD^,AAABrUVH5=AH{b&U!9!_AAAAAAAABrUdVb1Vt","SaveState_ssbb/adventure/140001.pac/1":"ShareData=AAABrUVH5=AAAAAAO[N8VSD^,AAABrUVH5=AamBvVSD^,AAAAAAAABrUgJYOVt","SaveState_ssbb/adventure/140005.pac/1":"ShareData=AAABrUVH5=AAAAAAE0:{VSD^,AAABrUVH5=ATi1mU!9!_AAAAAAAABrUtP:cVt","SaveState_ssbb/adventure/140101.pac/1":"ShareData=AAABrUVH5=AAAAAASKY;VtfI:AAABrUVH5=AVH,0VSD^,AAAAAAAABrUV/dGVt","SaveState_ssbb/adventure/140102.pac/1":"ShareData=AAABrUVH5=AAAAAAWIDbVtfI:AAABrUVH5=AYiATVSD^,AAAAAAAABrUuCv:Vt","SaveState_ssbb/adventure/140103.pac/1":"ShareData=AAABrUVH5=AAAAAAU@XCVtfI:AAABrUVH5=AY]qd+CunXAAAAAAAABrUXNs?Vt","SaveState_ssbb/adventure/140104.pac/1":"ShareData=AAABrUVH5=AAAAAAS3jLVtfI:AAABrUVH5=ATFMsVSD^,AAAAAAAABrUvbf5Vt","SaveState_ssbb/adventure/140105.pac/1":"ShareData=AAABrUVH5=AAAAAAW:5*+d]wYAAABrUVH5=ACe}bVSD^,AAAAAAAABrUnII[Vt","SaveState_ssbb/adventure/140106.pac/1":"ShareData=AAABrUVH5=AAAAAAZnWbVtfI:AAABrUVH5=AVYUeVSD^,AAAAAAAABrUrGUEVt","SaveState_ssbb/adventure/160001.pac/1":"ShareData=AAABrUVH5=AAAAAAQhXNUwi,-AAABrUVH5=AL/t?U!9!_AAAAAAAABrUa6BbVt","SaveState_ssbb/adventure/160002.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AYqYZU!9!_AAAAAAAABrUZWG{Vt","SaveState_ssbb/adventure/160101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AIdhxVSD^,AAAAAAAABrUfQP=Vt","SaveState_ssbb/adventure/160102.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AA-f4U!9!_AAAAAAAABrUWNeqVt","SaveState_ssbb/adventure/160201.pac/1":"ShareData=AAABrUVH5=AAAAAARhdpVSD^,AAABrUVH5=AKKH*VSD^,AAAAAAAABrUjDIEVt","SaveState_ssbb/adventure/160202.pac/1":"ShareData=AAABrUVH5=AAAAAALA4;VtfI:AAABrUVH5=AG/glU!9!_AAAAAAAABrUp5=cVt","SaveState_ssbb/adventure/160301.pac/1":"ShareData=AAABrUVH5=AAAAAAQ]cuVSD^,AAABrUVH5=AKz)]U!9!_AAAAAAAABrUXV9nVt","SaveState_ssbb/adventure/160301a.pac/1":"ShareData=AAABrUVH5=AAAAAARr5]+d]wYAAABrUVH5=ATP4-U!9!_AAAAAAAABrUvJDFVt","SaveState_ssbb/adventure/160301b.pac/1":"ShareData=AAABrUVH5=AAAAAAGVh3+d]wYAAABrUVH5=AIcsmVSD^,AAAAAAAABrUf^5vVt","SaveState_ssbb/adventure/160301c.pac/1":"ShareData=AX:-JUoJUF6zlNkTPz2nVlFvI2(A,JUgZ=TTA@J(VB){V8SC6p8c;O&UYDQGVt","SaveState_ssbb/adventure/180001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AQ$/0VSD^,AAAAAAAABrUY7@bVt","SaveState_ssbb/adventure/180001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAGWcVSD^,AAAAAAAABrUaeefVt","SaveState_ssbb/adventure/180002.pac/1":"ShareData=AAABrUVH5=AAAAAAK54N+^q,aAAABrUVH5=AAUgtVSD^,AAAAAAAABrUg7ANVt","SaveState_ssbb/adventure/180003.pac/1":"ShareData=AAABrUVH5=AAAAAAKN-1VtfI:AAABrUVH5=ADA/_VSD^,AAAAAAAABrUv!FOVt","SaveState_ssbb/adventure/180101.pac/1":"ShareData=AWr]{Ugjxs7XNjqTO~8nUVJ*xLJ+&wUeaJETgiR~Vbz;{8QnZd8u)*/Ur=0~Vt","SaveState_ssbb/adventure/200001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AD[FXVSD^,AAAAAAAABrUt{y-Vt","SaveState_ssbb/adventure/200002.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AYl0?VSD^,AAAAAAAABrUrIIIVt","SaveState_ssbb/adventure/200003.pac/1":"ShareData=AY-bQUc:9a7h45/Th|t]+^Or4N}+OkUepvtTX=D^+f$u-8rbk_8S|y;UWTE(V[","SaveState_ssbb/adventure/200003a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AYPRSVSD^,AAAAAAAABrUtAp6Vt","SaveState_ssbb/adventure/220001.pac/1":"ShareData=AAABrUVH5=AAAAAAF82UVtfI:AAABrUVH5=AM5~_VSD^,AAAAAAAABrUv]DyVt","SaveState_ssbb/adventure/220002.pac/1":"ShareData=AAABrUVH5=AAAAAAX=aBVSD^,AAABrUVH5=AHby^VSD^,AAAAAAAABrUr{nAVt","SaveState_ssbb/adventure/220002a.pac/1":"ShareData=AAABrUVH5=AAAAAAUcP_VSD^,AAABrUVH5=AZR&qU!9!_AAAAAAAABrUW}MYVt","SaveState_ssbb/adventure/220003.pac/1":"ShareData=AAABrUVH5=AAAAAAU}EAVtfI:AAABrUVH5=ATD9:U!9!_AAAAAAAABrUkzzQVt","SaveState_ssbb/adventure/220003a.pac/1":"ShareData=AAABrUVH5=AAAAAAP60yVSD^,AAABrUVH5=AIN~2VSD^,AAAAAAAABrUo7N2Vt","SaveState_ssbb/adventure/220101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AR@&pU!9!_AAAAAAAABrUgZP*Vt","SaveState_ssbb/adventure/240001.pac/1":"ShareData=AX:-JUmP*dR9hBbTXNIUV[6R;ANBz(Uepvt8f+&/+;h+,8QSq:TGRnSUhFOHV[","SaveState_ssbb/adventure/240001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AYim$VSD^,AAAAAAAABrUpe=qVt","SaveState_ssbb/adventure/240002.pac/1":"ShareData=AAABrUVH5=AAAAAAK[)mVtfI:AAABrUVH5=AV_nE+5P5ZAAAAAAAABrUh^mzVt","SaveState_ssbb/adventure/240002a.pac/1":"ShareData=AAABrUVH5=AAAAAAY)o4VSD^,AAABrUVH5=AOH2nVSD^,AAAAAAAABrUYpNiVt","SaveState_ssbb/adventure/240002b.pac/1":"ShareData=AAABrUVH5=AAAAAAOB}gVSD^,AAABrUVH5=AC1NUVSD^,AAAAAAAABrUp&KwVt","SaveState_ssbb/adventure/240101.pac/1":"ShareData=AAABrUVH5=AAAAAAUExSU!9!_AAABrUVH5=AQ;?CVSD^,AAAAAAAABrUja;sVt","SaveState_ssbb/adventure/250001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AL(YnVSD^,AAAAAAAABrUtJfGVt","SaveState_ssbb/adventure/260001.pac/1":"ShareData=AAABrUVH5=AAAAAAASTPVtfI:AAABrUVH5=AMDmkVSD^,AAAAAAAABrUVIgQVt","SaveState_ssbb/adventure/260001a.pac/1":"ShareData=AAABrUVH5=AAAAAAGnlv+d]wYAAABrUVH5=AB9&gVSD^,AAAAAAAABrUj)riVt","SaveState_ssbb/adventure/270001.pac/1":"ShareData=AAABrUVH5=AAAAAAOJksVtfI:AAABrUVH5=AT|KCVSD^,AAAAAAAABrUV20SVt","SaveState_ssbb/adventure/270002.pac/1":"ShareData=AAABrUVH5=AAAAAAJ&XLV[6R;AAABrUVH5=AOg(xVSD^,AAAAAAAABrUb|/rVt","SaveState_ssbb/adventure/270002a.pac/1":"ShareData=AAABrUVH5=AAAAAAH8Ji+d]wYAAABrUVH5=ATu/|VSD^,AAAAAAAABrUmICUVt","SaveState_ssbb/adventure/270101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AIZ8@VSD^,AAAAAAAABrUXu21Vt","SaveState_ssbb/adventure/270201.pac/1":"ShareData=AAABrUVH5=AAAAAAAuRq+5P5ZAAABrUVH5=AAJD9VSD^,AAAAAAAABrUhbP0Vt","SaveState_ssbb/adventure/270202.pac/1":"ShareData=AAABrUVH5=AAAAAAEverVtfI:AAABrUVH5=AL=~]VSD^,AAAAAAAABrUe$,lVt","SaveState_ssbb/adventure/270202a.pac/1":"ShareData=AAABrUVH5=AAAAAAMJLk+d]wYAAABrUVH5=AAAAAAAAAAAAAAAAAABrUaR@9Vt","SaveState_ssbb/adventure/270203.pac/1":"ShareData=AAABrUVH5=AAAAAARkjGVtfI:AAABrUVH5=AB}E38=XDTAAAAAAAABrUr5$9Vt","SaveState_ssbb/adventure/280002.pac/1":"ShareData=AAABrUVH5=AAAAAAHfS(V[6R;AAABrUVH5=AImp*98TeWAAAAAAAABrUkiGuVt","SaveState_ssbb/adventure/280002a.pac/1":"ShareData=AAABrUVH5=AAAAAAGvu2VSD^,AAABrUVH5=AIZ9lVSD^,AAAAAAAABrUv*b/Vt","SaveState_ssbb/adventure/280003.pac/1":"ShareData=AAABrUVH5=AAAAAAB*NCVtfI:AAABrUVH5=AIDKbU!9!_AAAAAAAABrUdZ$BVt","SaveState_ssbb/adventure/280101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AY4rHU!9!_AAAAAAAABrUvqITVt","SaveState_ssbb/adventure/280201.pac/1":"ShareData=AAABrUVH5=AAAAAAK!xcVtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUYbx!Vt","SaveState_ssbb/adventure/280202.pac/1":"ShareData=AAABrUVH5=AAAAAATKXMVtfI:AAABrUVH5=ATsoqVSD^,AAAAAAAABrUpo5:Vt","SaveState_ssbb/adventure/280202a.pac/1":"ShareData=AAABrUVH5=AAAAAAO&v@+5P5ZAAABrUVH5=ADBznVSD^,AAAAAAAABrUp;l4Vt","SaveState_ssbb/adventure/280203.pac/1":"ShareData=AAABrUVH5=AAAAAADtBPVtfI:AAABrUVH5=AW4WMVSD^,AAAAAAAABrUnSmhVt","SaveState_ssbb/adventure/280204.pac/1":"ShareData=AAABrUVH5=AAAAAAZ07^VSD^,AAABrUVH5=AS!sKVSD^,AAAAAAAABrUdQ^GVt","SaveState_ssbb/adventure/280301.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ACM*~VSD^,AAAAAAAABrUwUU2Vt","SaveState_ssbb/adventure/290001.pac/1":"ShareData=AAABrUVH5=AAAAAAbNb4VtfI:AAABrUVH5=Aam0?VSD^,AAAAAAAABrUWNe*Vt","SaveState_ssbb/adventure/290001a.pac/1":"ShareData=AAABrUVH5=AAAAAAA)I&VSD^,AAABrUVH5=AVZCcU!9!_AAAAAAAABrUoDT4Vt","SaveState_ssbb/adventure/290001b.pac/1":"ShareData=AAABrUVH5=AAAAAAADC&VSD^,AAABrUVH5=AIm/PVSD^,AAAAAAAABrUiB7cVt","SaveState_ssbb/adventure/300001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANvUhVSD^,AAAAAAAABrUk6OYVt","SaveState_ssbb/adventure/310001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AHTN}VSD^,AAAAAAAABrUfG0vVt","SaveState_ssbb/adventure/310002.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAANK5)Uepvt8ae84VtfI:AJh@:TJ))1Uo@LUV[","SaveState_ssbb/adventure/310003.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AC_oCVSD^,AAAAAAAABrUhhCqVt","SaveState_ssbb/adventure/310003.pac/2":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AZYw,V[6R;AAAAAAAABrUsa]lVt","SaveState_ssbb/adventure/310003a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AGOrmVSD^,AAAAAAAABrUvz}~Vt","SaveState_ssbb/adventure/310003b.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AJ|ciVSD^,AAAAAAAABrUhVn-Vt","SaveState_ssbb/adventure/310101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=Aa2N2U!9!_AAAAAAAABrUhsHHVt","SaveState_ssbb/adventure/320001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANKZHVSD^,AAAAAAAABrUhtG8Vt","SaveState_ssbb/adventure/330001.pac/1":"ShareData=AAABrUVH5=AAAAAAV9E{U!9!_AAABrUVH5=AQlwFVSD^,AAAAAAAABrUcU^2Vt","SaveState_ssbb/adventure/330002.pac/1":"ShareData=AAABrUVH5=AAAAAALycDVSD^,AAABrUVH5=APJ78U!9!_AAAAAAAABrUujk=Vt","SaveState_ssbb/adventure/330002a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AX?a@VSD^,AAAAAAAABrUrs8QVt","SaveState_ssbb/adventure/330101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AY7jnVSD^,AAAAAAAABrUX:mlVt","SaveState_ssbb/adventure/330101a.pac/1":"ShareData=AAABrUVH5=AAAAAAWE(!VSD^,AAABrUVH5=AaySpVSD^,AAAAAAAABrUY;2,Vt","SaveState_ssbb/adventure/330102.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=APS_&U!9!_AAAAAAAABrUY41NVt","SaveState_ssbb/adventure/330103.pac/1":"ShareData=AAABrUVH5=AAAAAAHC;OVSD^,ANBz(UepvtTMGu)VSD^,AJh@:8V3lKUZRiyVt","SaveState_ssbb/adventure/330104.pac/1":"ShareData=AAABrUVH5=AAAAAAa7W4VSD^,AAABrUVH5=AF({hVtfI:AAAAAAAABrUazjHVt","SaveState_ssbb/adventure/330201.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AO4?;VSD^,AAAAAAAABrUkobWVt","SaveState_ssbb/adventure/340001.pac/1":"ShareData=AAABrUVH5=AAAAAAVG6nVSD^,AAABrUVH5=AE&x}+d]wYAAAAAAAABrUgAxaVt","SaveState_ssbb/adventure/340002.pac/1":"ShareData=AAABrUVH5=AAAAAAX(nDVtfI:AAABrUVH5=AWH~;VtfI:AAAAAAAABrUn)$[V[","SaveState_ssbb/adventure/340003.pac/1":"ShareData=AAABrUVH5=AAAAAAF5+0VtfI:AAABrUVH5=AC&Y[U!9!_AAAAAAAABrUVV:_Vt","SaveState_ssbb/adventure/340004.pac/1":"ShareData=AAABrUVH5=AAAAAAH^rRVSD^,AAABrUVH5=AD;[&VSD^,AAAAAAAABrUgZc=Vt","SaveState_ssbb/adventure/340005.pac/1":"ShareData=AAABrUVH5=AAAAAATbY!+d]wYAAABrUVH5=AAAAAAAAAAAAAAAAAABrUjiuyV[","SaveState_ssbb/adventure/350001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AH6JmVSD^,AAAAAAAABrUethtVt","SaveState_ssbb/adventure/360001.pac/1":"ShareData=AAABrUVH5=AAAAAABj8FVtfI:AAABrUVH5=AU&]aVtfI:AAAAAAAABrUgG[*V[","SaveState_ssbb/adventure/360001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AD_S_U!9!_AAAAAAAABrUjEO=Vt","SaveState_ssbb/adventure/360001b.pac/1":"ShareData=AAABrUVH5=AAAAAAIxYm9FyMUAAABrUVH5=AI!hXVSD^,AAAAAAAABrUYx25Vt","SaveState_ssbb/adventure/360001c.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUXrv7Vt","SaveState_ssbb/adventure/360002.pac/1":"ShareData=AAABrUVH5=AAAAAAHWzEVtfI:AAABrUVH5=AUZcMVSD^,AAAAAAAABrUslCWVt","SaveState_ssbb/adventure/370001.pac/1":"ShareData=AAABrUVH5=AAAAAAC[7fV[6R;AAABrUVH5=AE~@QU!9!_AAAAAAAABrUd,WYVt","SaveState_ssbb/adventure/370001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=Aa{K3VSD^,AAAAAAAABrUmE7eVt","SaveState_ssbb/adventure/370002.pac/1":"ShareData=AAABrUVH5=AAAAAAASNpVtfI:AAABrUVH5=AOG2)U!9!_AAAAAAAABrUX7i4Vt","SaveState_ssbb/adventure/370002a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AB;H8VSD^,AAAAAAAABrUeOgKVt","SaveState_ssbb/adventure/370003.pac/1":"ShareData=AAABrUVH5=AAAAAAK]C|VtfI:AAABrUVH5=ABBjKVSD^,AAAAAAAABrUv$B2Vt","SaveState_ssbb/adventure/370101.pac/1":"ShareData=AX:-JUVH5=ALSFpTMFE(Tzmn9AAABrUVH5=ADcx(VdWFW8I1/RAX:-JUcO6KVt","SaveState_ssbb/adventure/370201.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAWi:*Ue3p(TJlWP+5P5ZAJv~P8fD1MUY_x[V[","SaveState_ssbb/adventure/370203.pac/1":"ShareData=AX:-JUY?hj7m|T=S{*3J+L:0*PDztNUd!kZT&Hq~VdoRY8OTmi8{xYlUd@3fVt","SaveState_ssbb/adventure/370301.pac/1":"ShareData=AAABrUVH5=AAAAAAQ}CzVtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUi=]xV[","SaveState_ssbb/adventure/390001.pac/1":"ShareData=AAABrUVH5=AAAAAASLNhVSD^,AAABrUVH5=AAAy~ReS92AAAAAAAABrUjCc:Vt","SaveState_ssbb/adventure/400001.pac/1":"ShareData=AAABrUVH5=AAAAAAOA4JVSD^,AAABrUVH5=AAAAAAAAAAAAAAAAAABrUu2qVVt","SaveState_ssbb/adventure/400002.pac/1":"ShareData=AAABrUVH5=AAAAAAVcWgVSD^,AAABrUVH5=AH+6+VSD^,AAAAAAAABrUh^F/V[","SaveState_ssbb/adventure/400003.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUgcH]Vt","SaveState_ssbb/adventure/400004.pac/1":"ShareData=AAABrUVH5=AAAAAAXM}!VSD^,AAABrUVH5=AL(YnVSD^,AAAAAAAABrUu]HhV[","SaveState_ssbb/adventure/400005.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAX:-JUgZ=TTUWAxT(_w+ALSFp8gkxaUctV^Vt","SaveState_ssbb/adventure/400006.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUc+tZVt","SaveState_ssbb/adventure/400007.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUbD7;Vt","SaveState_ssbb/adventure/400008.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUmE7eVt","SaveState_ssbb/adventure/400009.pac/1":"ShareData=AAABrUVH5=AAAAAAVeQ,VSD^,AAABrUVH5=AAAAAAAAAAAAAAAAAABrUZ$wcVt","SaveState_ssbb/adventure/400101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUc/l@V[","SaveState_ssbb/adventure/410001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUr=OgVt","SaveState_ssbb/adventure/410002.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUfUUtVt","SaveState_ssbb/adventure/410003.pac/1":"ShareData=AAABrUVH5=AAAAAAZQO7VtfI:AAABrUVH5=AL+-}+d]wYAAAAAAAABrUkLFGV[","SaveState_ssbb/adventure/420001a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAALpq9Uf[@z8)ry3VSD^,AK_Q]T+)}lUY^OcVt","SaveState_ssbb/adventure/420001b.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AZOsRU!9!_AAAAAAAABrUg;+eVt","SaveState_ssbb/adventure/420001c.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AHqMwVSD^,AAAAAAAABrUghKDVt","SaveState_ssbb/adventure/420001d.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AI6dJU!9!_AAAAAAAABrUWNe,Vt","SaveState_ssbb/adventure/420002a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAX:-JUgZ=TTU{~tU!9!_ALSFp8gkxaUf$FSVt","SaveState_ssbb/adventure/420002b.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AEc7RU!9!_AAAAAAAABrUe-oAVt","SaveState_ssbb/adventure/420002c.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AKUs}U!9!_AAAAAAAABrUiNp*Vt","SaveState_ssbb/adventure/420002d.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AEeHjU!9!_AAAAAAAABrUjiP}Vt","SaveState_ssbb/adventure/420002e.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AKqh:U!9!_AAAAAAAABrUV&7WVt","SaveState_ssbb/adventure/420003a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ACL&9U!9!_AAAAAAAABrUWWD-Vt","SaveState_ssbb/adventure/420005a.pac/1":"ShareData=AWi:*Ucprh6$MgC8WB70V[6R;AX:-JUgZ=T8J6mA9qoFkTS;keTPy3UUmkk0V[","SaveState_ssbb/adventure/420005b.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AIZ86VSD^,AAAAAAAABrUli,UVt","SaveState_ssbb/adventure/420005c.pac/1":"ShareData=AAABrUVH5=AAAAAAO/f4VtfI:AAABrUVH5=ARq-4+^q,aAAAAAAAABrUucW_V[","SaveState_ssbb/adventure/420007a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AW_74VSD^,AAAAAAAABrUkzWCVt","SaveState_ssbb/adventure/420007b.pac/1":"ShareData=AAABrUVH5=AAAAAABOfBVtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUq5A7Vt","SaveState_ssbb/adventure/420007c.pac/1":"ShareData=AAABrUVH5=AAAAAAT$Iq+CunXAAABrUVH5=AAAAAAAAAAAAAAAAAABrUtnl(Vt","SaveState_ssbb/adventure/420009a.pac/1":"ShareData=AX:-JUVH5=ALSFp8Jp;xVSD^,AAABrUVH5=AOqr|VB){VS{~V7AX:-JUYbZgVt","SaveState_ssbb/adventure/420009b.pac/1":"ShareData=AAABrUVH5=AAAAAAO9wLV[6R;AAABrUVH5=AULy!VSD^,AAAAAAAABrUfKoEV[","SaveState_ssbb/adventure/420009c.pac/1":"ShareData=AAABrUVH5=AAAAAAa1z:VtfI:AAABrUVH5=AMgO9VSD^,AAAAAAAABrUr3@(Vt","SaveState_ssbb/adventure/420011a.pac/1":"ShareData=AAABrUVH5=AAAAAAY9C2VtfI:AAABrUVH5=AZlN}+5P5ZAAAAAAAABrUaGC7V[","SaveState_ssbb/adventure/420013a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUa@9BVt","SaveState_ssbb/adventure/420013b.pac/1":"ShareData=AAABrUVH5=AAAAAAFE&IVtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUpk+uVt","SaveState_ssbb/adventure/420015a.pac/1":"ShareData=AAABrUVH5=AAAAAAGm5VVtfI:AWi:*Ue3p(8eN](U!9!_AJv~PTTTE2Uab)(Vt","SaveState_ssbb/adventure/420017a.pac/1":"ShareData=AAABrUVH5=AAAAAAH^5u+CunXAAABrUVH5=ACsp)VSD^,AAAAAAAABrUi6yDVt","SaveState_ssbb/adventure/420017b.pac/1":"ShareData=AAABrUVH5=AAAAAAW2&cVtfI:AAABrUVH5=AI-FVVSD^,AAAAAAAABrUwV1CVt","SaveState_ssbb/adventure/420017c.pac/1":"ShareData=AAABrUVH5=AAAAAAIINbVSD^,AAABrUVH5=AJ/B6VSD^,AAAAAAAABrUc$8*Vt","SaveState_ssbb/adventure/420019a.pac/1":"ShareData=AAABrUVH5=AAAAAAIUK_VtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUn8r^Vt","SaveState_ssbb/adventure/420019b.pac/1":"ShareData=AAABrUVH5=AAAAAAY,F(VtfI:AAABrUVH5=AS5Q;+5P5ZAAAAAAAABrUuGToV[","SaveState_ssbb/adventure/420021c.pac/1":"ShareData=ANK5)UVH5=AJh@:8QWP2VSD^,AAABrUVH5=AO$t4Vbl@wS{~V7ANK5)UkdB4Vt","SaveState_ssbb/adventure/420021d.pac/1":"ShareData=AAABrUVH5=AAAAAAVg6G+d]wYAX:-JUgZ=T8X^jwVSD^,ALSFpTU0A;Ugj:UVt","SaveState_ssbb/adventure/420021e.pac/1":"ShareData=AAABrUVH5=AAAAAANfDaVtfI:AAABrUVH5=AKGjeVSD^,AAAAAAAABrUc3N+Vt","SaveState_ssbb/adventure/420023a.pac/1":"ShareData=AAABrUVH5=AAAAAAWR_JU!9!_AAABrUVH5=AO0f0VSD^,AAAAAAAABrUv,W6Vt","SaveState_ssbb/adventure/420023b.pac/1":"ShareData=AAABrUVH5=AAAAAAW=nJV[6R;AAABrUVH5=ARK}P+5P5ZAAAAAAAABrUumJGVt","SaveState_ssbb/adventure/420023c.pac/1":"ShareData=AAABrUVH5=AAAAAALDj8+d]wYAAABrUVH5=AAkY^VSD^,AAAAAAAABrUWm3zV[","SaveState_ssbb/adventure/420025a.pac/1":"ShareData=AAABrUVH5=AAAAAAT]}JVtfI:AAABrUVH5=AO*-vVSD^,AAAAAAAABrUamY6Vt","SaveState_ssbb/adventure/420025b.pac/1":"ShareData=AAABrUVH5=AAAAAAObR7+d]wYAAABrUVH5=AP={xVSD^,AAAAAAAABrUgKLZVt","SaveState_ssbb/adventure/420025c.pac/1":"ShareData=AAABrUVH5=AAAAAAaOTa+^q,aAAABrUVH5=AQkVGVSD^,AAAAAAAABrUvy:CVt","SaveState_ssbb/adventure/420027a.pac/1":"ShareData=AAABrUVH5=AAAAAALc8}VtfI:AAABrUVH5=AD*k$+5P5ZAAAAAAAABrUV?ymVt","SaveState_ssbb/adventure/420027b.pac/1":"ShareData=AAABrUVH5=AAAAAAL7i4VSD^,AAABrUVH5=AEpY-VSD^,AAAAAAAABrUf[v~Vt","SaveState_ssbb/adventure/420027c.pac/1":"ShareData=AAABrUVH5=AAAAAAA1-^VtfI:AAABrUVH5=AX4t*+CunXAAAAAAAABrUj/2AVt","SaveState_ssbb/adventure/420029b.pac/1":"ShareData=AAABrUVH5=AAAAAAWER+VtfI:AAABrUVH5=ABlKKVSD^,AAAAAAAABrUsvBZVt","SaveState_ssbb/adventure/420031a.pac/1":"ShareData=AAABrUVH5=AAAAAAZbO/+^q,aAAABrUVH5=AScz1V[6R;AAAAAAAABrUpqN+Vt","SaveState_ssbb/adventure/420031b.pac/1":"ShareData=AAABrUVH5=AAAAAAT95|VSD^,AAABrUVH5=ATKoNVSD^,AAAAAAAABrUicg4Vt","SaveState_ssbb/adventure/420031c.pac/1":"ShareData=AAABrUVH5=AAAAAAZV(3VtfI:AAABrUVH5=AOS{lVtfI:AAAAAAAABrUv82!Vt","SaveState_ssbb/adventure/420033a.pac/1":"ShareData=ANBz(UaK)r7M{@BS}:8_+5{h9OBne=UVIZpTh!EA+nWmG8cy2L8mZP]UvNmUVt","SaveState_ssbb/adventure/420033b.pac/1":"ShareData=AAABrUVH5=AAAAAAKmuJ+5P5ZAAABrUVH5=AY}K:VtfI:AAAAAAAABrUn):uVt","SaveState_ssbb/adventure/420035a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AMmklVSD^,AAAAAAAABrUf7tdVt","SaveState_ssbb/adventure/420037a.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAp~jVSD^,AAAAAAAABrUWiZ~Vt","SaveState_ssbb/adventure/420041.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AL_D7U!9!_AAAAAAAABrUwC?_Vt","SaveState_ssbb/adventure/420042.pac/1":"ShareData=AAABrUVH5=AAAAAAS$+o+CunXAAABrUVH5=AJtTNVSD^,AAAAAAAABrUXHqsVt","SaveState_ssbb/adventure/420043.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AbN};VSD^,AAAAAAAABrUZ-/8Vt","SaveState_ssbb/adventure/420044.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=Aa3(bVSD^,AAAAAAAABrUoI16Vt","SaveState_ssbb/adventure/420045.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUn]=4Vt","SaveState_ssbb/adventure/420046.pac/1":"ShareData=AAABrUVH5=AAAAAAa=T3U!9!_AAABrUVH5=AFrN(U!9!_AAAAAAAABrUliGCVt","SaveState_ssbb/adventure/420047.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ADe?uVSD^,AAAAAAAABrUfB*kVt","SaveState_ssbb/adventure/420051.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ARjWeU!9!_AAAAAAAABrUh?,nVt","SaveState_ssbb/adventure/420052.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AH4t@VSD^,AAAAAAAABrUoP)eVt","SaveState_ssbb/adventure/420053.pac/1":"ShareData=AAABrUVH5=AAAAAAMy~xUVH5=AAABrUVH5=ATuhZU!9!_AAAAAAAABrUiInMVt","SaveState_ssbb/adventure/420054.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ACMeeU!9!_AAAAAAAABrUeun[Vt","SaveState_ssbb/adventure/420055.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ATOkkU!9!_AAAAAAAABrUZn0zVt","SaveState_ssbb/adventure/420056.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AF@r6U!9!_AAAAAAAABrUj{I7Vt","SaveState_ssbb/adventure/420057.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AY6-!U!9!_AAAAAAAABrUZ@mJVt","SaveState_ssbb/adventure/420058.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AW1ZnU!9!_AAAAAAAABrUb^iQVS","SaveState_ssbb/adventure/420059.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAb6WU!9!_AAAAAAAABrUXyOIVS","SaveState_ssbb/adventure/420060.pac/1":"ShareData=AAABrUZ[)334dvUPyS=+9fq}e3Mi;2Us3lLT:gw8VCLQd4Q*Lk8)V,]Um)9vVt","SaveState_ssbb/adventure/900001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AVe(kU!9!_AAAAAAAABrUf*YXVt","SaveState_ssbb/adventure/900101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AQ==;U!9!_AAAAAAAABrUkrB$Vt","SaveState_ssbb/adventure/900201.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AYN9pUwi,-AAAAAAAABrUhRYzVt","SaveState_ssbb/adventure/910101.pac/1":"ShareData=AY3VPUrSSqSR6X?8voY0U*Lb-3ftOaUhJF5TiS9&VUrWZTu~=:8o[{OUmq5eVt","SaveState_ssbb/adventure/920001.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AUzGZU!9!_AAAAAAAABrUtkACVt","SaveState_ssbb/adventure/920101.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AOQTyVSD^,AAAAAAAABrUei)FVt","SaveState_ssbb/adventure/920201.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ACiymVSD^,AAAAAAAABrUoIB:Vt","SaveState_ssbb/adventure/920301.pac/1":"ShareData=AWr]{Ub(L+SMHpK8LBVCVAj{@2$0~*Ue3p(TNd9V+nkgnTJD;N8aLcyUbv;Y+5","SaveState_ssbb/adventure/920401.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AQS;}VSD^,AAAAAAAABrUWu6UVt","SaveState_ssbb/adventure/920501.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AM5S~VSD^,AAAAAAAABrUfJ(FVt","SaveState_ssbb/adventure/920601.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AKMvMVSD^,AAAAAAAABrUuOY|Vt","SaveState_ssbb/adventure/920701.pac/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AA","SaveState_ssbb/melee/STGBATTLEFIELD.PAC/1":"ZNCA8O)c~{L?:=T@Q$g1lG8OY&J$giAAF}!z(-3:L1rtOXgv]H9L^;Zj7-+WV4?GVN6{}{=","SaveState_ssbb/melee/STGCONFIGTEST.PAC/1":"ZNCA8U]F*x?5FG[HS^SKQZoZ{,L3gRAAE?q6YW(hh9^:BJR@Oti+e?Sa|ZxXv5=kAvvODl=","SaveState_ssbb/melee/STGCRAYON.PAC/1":"ZNCA8t{yMPH6eSOHCtkTU&gVIR$JSqAAB6o1$/*YH]hivR*XuMa,gQ6LeyM=wNP;btviMV=","SaveState_ssbb/melee/STGDOLPIC.PAC/1":"ZNCA8t{yMPx;sZ{+B0TNL~UG(y5]|ZAACY3U9:^jXx3?o[BZC}ON$toCD3cKBJp{zW^/7c=","SaveState_ssbb/melee/STGDONKEY.PAC/1":"ZNCA8t{yMPAAEuVcv=4w8[T]U!UZ77AAEt]fpLKW6a*pj10}M7&:;su4hC/?gmHlZ~6gRX=","SaveState_ssbb/melee/STGDXBIGBLUE.PAC/1":"ZNCA8U]F*xTr!&J5nrgG5?!(CZmG,MAAH{s?(QBNx=Uwmg-F*1p4@3{XEC2,XS7r;o}ksS=","SaveState_ssbb/melee/STGDXCORNERIA.PAC/1":"ZNCA8U]F*x0&qaG$T5[Cms}zM2SSY]AAAgEke7lpYsU:4:0cf/xotmz[CzpkUJMZdzKY$q=","SaveState_ssbb/melee/STGDXGARDEN.PAC/1":"ZNCA8t|0vkj+v{@DxY$52$p~CD6&RzAAI:aigbPf_x|)6hEW7-XR7ux)N5KT@f7n$tXnh3=","SaveState_ssbb/melee/STGDXGREENS.PAC/1":"ZNCA8U]F*x:Ops5(sk5d/w82bJQ&YZAAFKwxpRQ*A4rFo{;@77ffvSohl(/OjdFnj1v59p=","SaveState_ssbb/melee/STGDXONETT.PAC/1":"ZNCA8U]F*xf;mTX(PEVMvb4V&s=VOuAAC8;iy^4nlwno_4^ALf62WykvshMt:ECys+_C&1=","SaveState_ssbb/melee/STGDXONETT_en.PAC/1":"ZNCA8U]F*x7_)*gbCK{V{s+CHulG3YAAAAA4o8Spn}Fw)?Y4}-cTy1OFw+JNf9/?uk_h*]=","SaveState_ssbb/melee/STGDXPSTADIUM_en.PAC/1":"ZNCA8U]F*x@TTA:26e8YU2vzEemJs2AAAAg-)[?_R3NjNtaecZUQnfeQ5Uos9F23o=)$;R=","SaveState_ssbb/melee/STGDXRCRUISE.PAC/1":"ZNCA8t|0vkkokJ}?ePT5gCb:CwgLMDAAAAf$srlbi3~ipC:fL$o28UY:bRgCU_JG=qDqDa=","SaveState_ssbb/melee/STGDXSHRINE.PAC/1":"ZNCA8t|0vkKWTvhPvJoQ9=9vM{kUU^AABL-@XX4TuDJUDjj)=l:6E/VSf-]bM]mL_ihb5;=","SaveState_ssbb/melee/STGDXYORSTER.PAC/1":"ZNCA8t|0vkXm:$DSsXrm?kui]:zS{)AAEt@F{sPG;30_l?lyUkj]]ILVG^~NeE$_$rU6=v=","SaveState_ssbb/melee/STGDXZEBES.PAC/1":"ZNCA8t|0vk?5FG[Y7/p)nl]UewVj6TAAAAAQqp^[LC]-?XS0Mhh_it6D{[mHF!}qn*4|1H=","SaveState_ssbb/melee/STGEARTH.PAC/1":"ZNCA8t|0vkY!44oP$_,dh+M}gv7QE=AAFhORziURVRtQm4E;XP[|WG6g|HaV0,S,~O9YCa=","SaveState_ssbb/melee/STGEDIT_0.PAC/1":"ZNCA8U]F*xXLo:CBm}K?QSm{n(PE/$AAEvgOZ{cXH2B![J^9OJnHENVCpp)KnfZVLZdLvS=","SaveState_ssbb/melee/STGEDIT_1.PAC/1":"ZNCA8U]F*xp=aOjV)uOv?QB^4*{9WPAAAAAw-?qOmGRB!]@0jTKsEP3!AatnT;D$_1j6uG=","SaveState_ssbb/melee/STGEDIT_2.PAC/1":"ZNCA8U]F*x7_)*g&qn7^dMzaW,-8SHAAEt]RziURT(V=$B3sCucTy1OD[Ib:$jcea1oFow=","SaveState_ssbb/melee/STGEMBLEM_00.PAC/1":"ShareData=AHCE9Uk,E~TcqxT8:0rk+R}Ok5x|V,Uqu=-UN!ZyV1ZK!T5Vx;9JHBVUv1=EVt","SaveState_ssbb/melee/STGEMBLEM_01.PAC/1":"ShareData=AY-bQUdIGX7?20xTpQ?R9o[y=4[JqqUmVBCUS4qoVu]+R8xN0E9a;GcUtlX/Vt","SaveState_ssbb/melee/STGEMBLEM_02.PAC/1":"ShareData=AI1/MUsAY$TKN|G8t_D)9]07APiO]~UgvQyUKFv,ViZ$ZToYL:9e|YSUf*jpVt","SaveState_ssbb/melee/STGFAMICOM.PAC/1":"ZNCA8t{yMP?Cj]/U)!!np;OCm(Yht{AAE=}w?v|(AdP{n;1~y2*7PNk)is|[oN{KzcV6o;=","SaveState_ssbb/melee/STGFINAL.PAC/1":"ZNCA8t{yMPvpj5THU(YK7+8II[j|,rAAG406uey?q;I/5Jy(-gZKgJV{Y]S]+AMXSlD|)x=","SaveState_ssbb/melee/STGFZERO.PAC/1":"ZNCA8t|0vkXm:$DW/Un)Asa+g{2ezjAAEt@xio8QmhsK$5U1)$krqaN5CyBD]/PjCE_=D$=","SaveState_ssbb/melee/STGFZERO.PAC/2":"ZNCA8t|0vkD3S1mz[!~3nz|o(FVd(FAACAxn{B!rb_x36i=}z-O0*GfmrM}:*drAC!NG6@=","SaveState_ssbb/melee/STGGREENHILL.PAC/1":"ZNCA8t|0vkl(w*0Gn{R@YDs|BDhO3=AAGV{:}VlMsCR,;lkM&bT1khOWOsyrYV!Bu;2tw$=","SaveState_ssbb/melee/STGGW.PAC/1":"ZNCA8t|0vk;,HE+D5c|Va]dS9XpPB4AIuHrdvSpQ2L;H-v~feEXcxwP$2BnGR|1y-&Kul9=","SaveState_ssbb/melee/STGGW_en.PAC/1":"ZNCA8t|0vk@v8!)j/8Fz;lb0wWN+mXAABNWvpj5Tm0_uU9pud-Nsa?m*9caWnmT@&7*~nY=","SaveState_ssbb/melee/STGHALBERD.PAC/1":"ZNCA8t{yMP5WHO:AGE3GgkSaloBn{ZAAEt!q}5c(a[A?I]yEi{33]H3qMAi&=XL[Ky$+0;=","SaveState_ssbb/melee/STGHALBERD.PAC/2":"ZNCA8t{yMPJd{Jnl]d|PTm3Dw(fTv(AAB]t/yPJ7-TQs7+5@87aXAC*5_Cyb~KaKs&u^RZ=","SaveState_ssbb/melee/STGHEAL.PAC/1":"ZNCA8U]F*xk(IZQip/+Xn?WgF;82w6AAEt!5oBH,Y*SN,FVz=W5ue{r@H-&?ODll;ZID+{=","SaveState_ssbb/melee/STGHOMERUN.PAC/1":"ZNCA8U]F*xHY2MugbK/kte?N6Be3))AAHti:/Qi;UdjId3OQva?$wT!P=Z]9sWW$|7K,$[=","SaveState_ssbb/melee/STGHOMERUN_en.PAC/1":"ZNCA8U]F*xXLo:CE|m&Yh[61-d=jkhAAEvfh{emlfMHet{Wzi9krqaNl!ebU6E=EW,j5r,=","SaveState_ssbb/melee/STGICE.PAC/1":"ZNCA8t|0vkh^,kDu5/f?3awO*-P=u|AACh7_Uw!zV9^DK8LD1|:[Je&IeO1192IoD&2wlP=","SaveState_ssbb/melee/STGJUNGLE.PAC/1":"ZNCA8t{yMPKWTvh6fl&fcDTj=8-y?&AAAyHHU:zK;cZ4khZbG@/w(:]q(QC:Rq}3XJ3r3]=","SaveState_ssbb/melee/STGKART.PAC/1":"ZNCA8t{yMPKS7:]rzSxEiqn|cIH+8FAAC[[iFAGe-1C03)/Zw^2E-=JI]1UwsAX@i-9qM0=","SaveState_ssbb/melee/STGMADEIN_en.PAC/1":"ZNCA8t|0vk:Ops56?uq0&y5Z2(tT{JAAG/LQ{_CPUUw[&srM}hco6U]kajI^CO^G1euSI~=","SaveState_ssbb/melee/STGMANSION.PAC/1":"ZNCA8t{yMP(38kWX|@f4]yrL__y:AbAAI3WuRMVPl|LcS=tcRoYM_-{l@&:,V63XmkvU6m=","SaveState_ssbb/melee/STGMARIOPAST_00.PAC/1":"ZNCA8t{yMPLHQ*Je4X$$@jIQWKmeqMAAF}!(chbVZlEOq2&;o4Z76Kb2i|)30;=iGT|@Fm=","SaveState_ssbb/melee/STGMARIOPAST_01.PAC/1":"ZNCA8t{yMP07C}A)hf==bB*xST_L{cAAE?qx(3^Fnse1:UpUkR!{MOVD,OWk@sEfqQYM:Q=","SaveState_ssbb/melee/STGMETALGEAR_00.PAC/1":"ZNCA8t|0vkKWu_k~1B+lq9^nSHc,-JAAH8nnjC-v1E6L|W*dT4u^Y15FM,lxw8w78+8c_I=","SaveState_ssbb/melee/STGMETALGEAR_01.PAC/1":"ZNCA8t|0vkms6/V5h{|s=X0?89GXNWAAA[5Jt]!1!lGgrOJ$fJ4$9=pH&cZUwFrR2yiUsn=","SaveState_ssbb/melee/STGMETALGEAR_02.PAC/1":"ZNCA8t|0vkntOo5wfH4v,/,1AJkkS2AAAB@v;+,UjixpKTeO5(b|9Mo*G;OVD,EV117!P{=","SaveState_ssbb/melee/STGNEWPORK_en.PAC/1":"ZNCA8t|0vkgK_cY7nOvbVv_@p1fi)aAAE?po0fx?P/Z38du^[D9[m3uVYHEd$y&6CmwC{2=","SaveState_ssbb/melee/STGNORFAIR.PAC/1":"ZNCA8t{yMPF{sPGYXG6-],39qGp@n0AAEt!/euLuoua8]heBQi]:9pL/3ArliSc|[vf(&i=","SaveState_ssbb/melee/STGOLDIN.PAC/1":"ZNCA8t{yMP4D^SSSt/$)W[YPNVz~^:AAFW2rQ!GDI9)23+;Te+uL1C@0TN10/BG*Gpm=IN=","SaveState_ssbb/melee/STGONLINETRAINING.PAC/1":"ZNCA8U]F*x@TTA:M!uagPY2E!bD&DoAACXL_$X_+TFL5Z;$]W|VNj6hVY|r+,RR(xFYl:a=","SaveState_ssbb/melee/STGORPHEON.PAC/1":"ZNCA8t{yMP4;CbqJvBUi;LRY]ik[X+AACY2F1dq}Hb1E/BFnw*nAJXic_1Za[8s8zniux)=","SaveState_ssbb/melee/STGPALUTENA.PAC/1":"ZNCA8t|0vk$?/uc@0RB*JSeIEYsIGnAAE_p9;YCc)/^!2+F_)Pg9$,(yfQ_^@7LYL:gGSA=","SaveState_ssbb/melee/STGPICTCHAT_en.PAC/1":"ZNCA8t|0vk:~K+7ts*SV*]dcV~@IagAAAB]7LZ+egi=Abr5qEUWEaK1uu4xbrgwn_Zl{FH=","SaveState_ssbb/melee/STGPIRATES.PAC/1":"ZNCA8t{yMPFN1tDt(Hs=&+4DlgsiOuAN4+MG&0)BBt!M0rCk&Yaite*HNH:P6FV7-I0j*8=","SaveState_ssbb/melee/STGPLANKTON.PAC/1":"ZNCA8t|0vkq3eT&MQD{O;z]vmJF{6cAACY0Kxu4i:6E/VA?*FOas6=y?n7BS4mDmQN66OE=","SaveState_ssbb/melee/STGRESULT_en.PAC/1":"ZNCA8U]F*x]WW6-!qGB|vLc}Y5o/Y,AAAwy5xiX;0l5BCkByrIdQhc6Je3}~5wBe3X3;uH=","SaveState_ssbb/melee/STGSTADIUM_en.PAC/1":"ZNCA8t|0vkYVCmmd~$a--X9[1e-QCIAAF6_mvnyt:hSoUtAY72]*Sh9IpYF-@gCkPSbt+3=","SaveState_ssbb/melee/STGSTARFOX_CORNERIA.PAC/1":"ShareData=AQm5[Ui+B_8{jI;UPj[uVp&[A5n|-lUpU*aUN8CmV8Csm9KmMC9Z}XoUhac$Vt","SaveState_ssbb/melee/STGSTARFOX_GDIFF.PAC/1":"ShareData=ANl!}UhgJ)78g8fTOVwH8qmJSQVYjGUVvnZT$M7QU|?{k8XY|a8=!hHUo[$QVt","SaveState_ssbb/melee/STGTARGETLV1.PAC/1":"ZNCA8U]F*xYIlJF[H!)IB:jk~qjI9?AAEt@zjJ?B]Zn{K@(,V3iWWuwx/|H=[01o+tX27+=","SaveState_ssbb/melee/STGTARGETLV2.PAC/1":"ZNCA8U]F*x]xx:_Z1pRaS@?hENoO+JAAGuEm[A)W3)_i*RQDJKKu$OqErJDqdrf)_]v?:6=","SaveState_ssbb/melee/STGTARGETLv3.PAC/1":"ZNCA8U]F*x/elIuH6go]eI5X,lcKqUAAF5Xof^GyosVAsQ!stH-&uZojeJ|0dIo;(DVFmE=","SaveState_ssbb/melee/STGTARGETLv4.PAC/1":"ZNCA8U]F*xmK-crI;AS:KaXDjcaLL6AABZamU$E1FOG02m;]jpvyWeY,;}j;{QgoG6)JwW=","SaveState_ssbb/melee/STGTARGETLv5.PAC/1":"ZNCA8U]F*x:p;16WzEX;$DLnCVkmC]AAEvgymNr|N?xi{gDVgPc;Ad@Yl^[?jB=ei4UGgS=","SaveState_ssbb/melee/STGTENGAN_1.PAC/1":"ZNCA8t|0vk/elIu&T@Te+4?@lySqFAAAAAAUQT$kd4=TCs59$+,sL[Dfw?5iP4j]A2GbKK=","SaveState_ssbb/melee/STGTENGAN_2.PAC/1":"ZNCA8t|0vk~GN5qhtm?4ajMn8QUr(yAAEt@_xqE:Rb?aMB8Oj~,?m{EAXc2[8jD_cb*Y{!=","SaveState_ssbb/melee/STGTENGAN_3.PAC/1":"ZNCA8t|0vkAAEuV7I{8I@O2JODhkMgAAEt@Z[0|r]*SgSha1bZi@;H2[c0]4X(8dl{^c$G=","SaveState_ssbb/melee/STGVILLAGE_00_en.PAC/1":"ZNCA8t|0vksZoIetZLeP29or=T}@RVAAEt@3r=$moYg5*3=;7sv7+CnT^|/dVhn68UK}R/=","SaveState_ssbb/melee/STGVILLAGE_01_en.PAC/1":"ZNCA8t|0vkX,KAE*CMs/uoXrA$;w^sAAAAf~j9W-br9(/_i2FneilY)3:e^bJa4NrzUnXq=","SaveState_ssbb/melee/STGVILLAGE_02_en.PAC/1":"ZNCA8t|0vkL@MZp,7zJfWwEvXdJPMLAAG/KnR[f4caDVp:g}eW1j4=&S})1vy-1E$:0KW;=","SaveState_ssbb/melee/STGVILLAGE_03_en.PAC/1":"ZNCA8t|0vk~ho,rtX9FUD,io1)-?B7AAF6-wmf^Wl|LcSc]4Fv,Q~=C/+{C+lqP/zPAxnI=","SaveState_ssbb/melee/STGVILLAGE_04_en.PAC/1":"ZNCA8t|0vk~8:!skB,k_7_lzY;vZq1AAEvg?^gP]W?v&,+d+me:;jXH[bhi{7JXhLSuY?*=","SaveState_zelview/bdan_boss_scene/1":"ShareData=ALBO09pDzb8/gRVUV$FnWDHBoRA?F:Ur?ROUHSd|V2RFx9qxDDT=6v;90^A:+^","SaveState_zelview/bdan_scene/1":"ShareData=AF?[nUW?;S8I8R~T7WAkU*^KzQDPcEUlcyOT0Lxb+=6~n8?gyI8&@w(Uqaw7Vt","SaveState_zelview/besitu_scene/1":"ShareData=AGBgTUuOH{T9;3(9N};F+$DZYP_HiVUb3G=UES+*V7q1+UHs8:9KQ]5Uv[RpV[","SaveState_zelview/Bmori1_scene/1":"ShareData=AZeH]Um1dC8y;1xUD&LhV:RKP5YMG0UbOt]T@r&PV1*G*9fr&c9A)mNUuAbGV[","SaveState_zelview/bowling_scene/1":"ShareData=AW^}LUte!|T6Jn-9z6Wl+l@vw5qo:MUooAQT4VtZVa(PaUqS2M8}i}kUo{a~Vt","SaveState_zelview/daiyousei_izumi_scene/1":"ShareData=AF18lUX:}d8R2j&T2~(C+RoeyP5_v?UhlzaT&HpqVY@d|8)vT,8;y~DUwMK4+5","SaveState_zelview/ddan_boss_scene/1":"ShareData=AJ8ZYUWy7X9eoEdUjm+/+(Kxt5kjtDUm8jkUGKkX=C,w:9v=wX9CG+iUVcdM=a","SaveState_zelview/ddan_scene/1":"ShareData=AVi$iUbCxE8:^OSUL(KuV5}LH5g/4/UseFvUO@~oVu*{h9c]dK9Nq&+Ul-yf+C","SaveState_zelview/FIRE_bs_scene/1":"ShareData=Aa}6xUAWEaUE]E@9s?H(=Vmt8Qmo3SUj2U}UB1tQV1l@GUq-o{8|8efUJjUvVt","SaveState_zelview/ganon_boss_scene/1":"ShareData=AD{$sUei4y8/uXEUtoKoV+D&M5dHyRUb+x!UDb:?V_*aN9suX18[7s}UbV3yVt","SaveState_zelview/ganon_demo_scene/1":"ShareData=AJmDE9S*i^9I:a:UXS?nV}fvB5,v08UYT{rUPRM2WF2c_917oET~Wj-9LruY+^","SaveState_zelview/ganon_final_scene/1":"ShareData=ADd&{9vr0]T*MV|9mqPp=R^09Q&j5]UXJj~Ud|9tWTYGmUc/oGT*H]I9tci(+^","SaveState_zelview/ganon_scene/1":"ShareData=AKO*,UXtL|9fB2sUb$JVV27iB5p|gAUr3/9UU1zV+w8/)9q-mt9Z@:jUZ=-dV[","SaveState_zelview/ganon_sonogo_scene/1":"ShareData=AQbmXUQo}59C_wEUf,x7VvsajQhnJ0UrM|mUI^M0WInAp9tz|(8|j0lUGU7xVS","SaveState_zelview/ganon_tou_scene/1":"ShareData=AWnNhUmL~48aIPx8_Wi6=J)Y)4{v]WUYJ3:8|tpHWCr@&T$kVXT95w_UlIK?WP","SaveState_zelview/ganontika_scene/1":"ShareData=ADwI3UaD,u8^ACgUt]qbV2e={Qr9,fUm7,MUCgAAV9w0Z94$!p9M1Y~UwiS9V[","SaveState_zelview/ganontikasonogo_scene/1":"ShareData=AVc18T,u(,85vFe9qaZ6V^-;9Q4*1uUcA+&8zW^HV~SPcUhI};S6]bmT4!vH+^","SaveState_zelview/gerudoway_scene/1":"ShareData=AB|jj9unD^T3t,-9p/jv+zyqX5?2KBUuC!_USrDMV7BU9UuWfVT:WGb9u2fLUw","SaveState_zelview/hairal_niwa2_scene/1":"ShareData=AHaV9UWEkm8|w=$UUM^OWLH]pQ,n7JUdC)RUMX+EV0dMl9NZ&P9QvPFUbtWyV[","SaveState_zelview/hairal_niwa_n_scene/1":"ShareData=ACj*vUY,-yUHfi^9fT;4WJbSNQz4FEUk?FkUCiGkV:C(CUGJG(9KH-VUaW,[Vt","SaveState_zelview/hairal_niwa_scene/1":"ShareData=AFGcHUoZXQ9VsaLUbJ~@WcG&B5bZ-+UW3ecUJq=WV9t,v92F[g9QmCmUa,QJVt","SaveState_zelview/hakaana2_scene/1":"ShareData=AT||5T!}YjT-vH)9x0)}V-C^T50:GIUi}/jT3DGRVjGM-UoV_v8knfOT=5RpU!","SaveState_zelview/hakaana_ouke_scene/1":"ShareData=AM2:YUp}Z*8mwGMUIY}jVW2+B5o&m@UiT=[T0AXIVf}d@9U!xO8[8R|UqV;G+5","SaveState_zelview/hakaana_scene/1":"ShareData=AapuDUp9-_83N?(UAfsRVsQi;QEI2CUd20sUNu|jVnjpn9HW@A9M1/lUpt02Vt","SaveState_zelview/HAKAdan_bs_scene/1":"ShareData=AHyBX9iq:V9OF{sUYK0JV];-aQzQ4JUhh&yUCpzDV:oj~94U]{T{{a59if1E+^","SaveState_zelview/HAKAdan_scene/1":"ShareData=AX;$[T|b,vUTh4C9p{E0V//Tb52Z3_UcEZ6UGK5LVslL8Ul7Qa8)C;@UI=-XVt","SaveState_zelview/HAKAdanCH_scene/1":"ShareData=AL{OWUP)*m9aeTiUftwZV1uaj6C6B@UrGSjUD:]=V+@PB9t(ZO8&Pp4T*iJ;Vt","SaveState_zelview/hakasitarelay_scene/1":"ShareData=ARP-kUaD688}d;LUN052VInNaQQmGpUiIwKUL4G_+~(QQ9JfgD9UN7[UjfZ-+^","SaveState_zelview/hakasitarelay_scene/2":"ShareData=AY~+;UfiM,9B5y&T^/&tWde^n5v|DXUegELUR$DKU4UW/9JLkm9KFR7Uo?G2Vt","SaveState_zelview/HIDAN_scene/1":"ShareData=Aa|j{Uq6OB84d[|USm(FVV=?~5-OmZUg[t|T;A6HV;O$x9PoOg8,3_SUqBH|V[","SaveState_zelview/hylia_labo_scene/1":"ShareData=AO/0aUCO(V9AoiDUtsU-V+CfAQ6qQSUhvhTT6uQ3Vm67v9r);n9FS!yUBJ|ZVt","SaveState_zelview/hylia_labo_scene/2":"ShareData=AZ~[dUCn4g9K~XEUb5Q]+eP}:QsNFjUl[SEUU-tQ+$WxR92S8L8)ba,UG*0N+d","SaveState_zelview/ice_doukutu_scene/1":"ShareData=ATdVwUW?UCT2~4d9xvc)+m(JH6DKBOUXu3&T(76RVUNY(Uu6TE8^/:fUXz&fWP","SaveState_zelview/jyasinboss_scene/1":"ShareData=AZG,fUBK$59WTUFUYOQtWOGDw5tt)mUv&,TUNc5ZWMWw)91!u]8!lrRUCW=-Vt","SaveState_zelview/jyasinzou_scene/1":"ShareData=AENR_Uty^UTR{?082XI^+FhDwQAI?PUZ9*5UG4z3V9h0ZTuW+i9McqDUV&X|V[","SaveState_zelview/kakusiana_scene/1":"ShareData=ACDaYUZp$pUIXvn9m|hX+=^P{Qn(C6UrEt?T^dz?V(7S}Udk&&9KsI(UX-joWP","SaveState_zelview/kenjyanoma_scene/1":"ShareData=AAhbM9WO11ULrU49k*3[=JMip6FKQzUiDc4ULuZ&Vx+@3UgcvPT@;T99N)(s+5","SaveState_zelview/kinsuta_scene/1":"ShareData=AQ{*WUdiz|S@[}$8oDRD9]9n[5vN*eUWUv8T7fy8Vr@7eTr{Z18|g2eUje2wV[","SaveState_zelview/mahouya_scene/1":"ShareData=AE}f9UeuGV8R/wZT:{91U{0UQ5gkWkUYjaST+p_8Vg1;}8;Awq8(j[YUXh/MVt","SaveState_zelview/men_scene/1":"ShareData=ACw[LUchN+87&&/UF|5|+m$Zc5sGhNUZ_u^UUX/wVa6*I9L&]&9H;IGUZH_RVS","SaveState_zelview/miharigoya_scene/1":"ShareData=AZVB[UV77tT68$/9d~w~+iZeqP}[e3UnMQKT/kgDVZ@o[UBY409B1Z5Uufw/Vt","SaveState_zelview/MIZUsin_bs_scene/1":"ShareData=AZ2@0T*4i:USj{v9mLrV=Cpr~5b[[iUj]v6UEBKyV?;2PUp*q68^a*}UNkhJVt","SaveState_zelview/MIZUsin_scene/1":"ShareData=AEsCjUbGZDT+Uhm95kP)=XI?e5456@UpI=^T,NG$WKrVUUoAyx9FHR@Uf}4CU!","SaveState_zelview/moribossroom_scene/1":"ShareData=ACtN_93?3c9Dk4WUIrw)VxjoBQVumgUr(,rT){zFV,|}^9SCvqUKtfJ9x(0;=a","SaveState_zelview/nakaniwa_scene/1":"ShareData=AX2iDUNhXX8-z$eUc7I_V4J-bQcMa0UbauaT63GNV7qU{9k?vx8/v4;US_w=Vt","SaveState_zelview/sasatest_scene/1":"ShareData=AM5&EUs=?PT)!I59g78W=I9@KP&v-MUa,h7URGOVWH,x~UG?--9K6X^Ul7tnWP","SaveState_zelview/spot00_scene/1":"ShareData=APe&@UtP2W8lV)cUI@D1V9CQoQvqQ,UZp:2T8IIPV6,g49RYV]9FRg1Uiu3]WP","SaveState_zelview/spot01_scene/1":"ShareData=AZ((eUOhd,T3:cx9shKX=BDG:Qk4dCUokz8T9n@+V-T]5UsdVV858g@UAs]6V[","SaveState_zelview/spot02_scene/1":"ShareData=AL{qGUU(ALT?+Lo93sa-=Y8Ie5YDk+Ue/&DT~R^LVS(X$UkL=B88*-XUHd{QVt","SaveState_zelview/spot03_scene/1":"ShareData=AO[vnT|vZKT[n(L9p?gv=S_E4Q_T5ZUh]Y+T0f]CV-YM^Uu_8|8@yvEUKSqpVt","SaveState_zelview/spot04_scene/1":"ShareData=AE56b9NAB$T?23;9o!pA=Z8?LQW+n)Uhw4=T0g*pVxGS6Uf6pjT+q|)9O-]z+5","SaveState_zelview/spot05_scene/1":"ShareData=AK__vUZNT0TGYQ388[oI+=89y5l[?2UvX10T^k)2V=mJ[Tv]iS9N9?dUc*]0WP","SaveState_zelview/spot05_scene/2":"ShareData=AGnS2Usygi8z(&cT(!lxV:;6XQwq4NUp_s~T[3tkWEtLo9Shs!8(,tYUmgU/=a","SaveState_zelview/spot06_scene/1":"ShareData=AE+j99qAp:T2GKt9ba+_=ZD=;6E4w,Ur3f;T}[GK=XE2{UJ{wvUJDu+92pOCV[","SaveState_zelview/spot07_scene/1":"ShareData=AaotlTbK+p9dqbmUoK({WB)=pQr)(hUmy8LUU4ZtV5kAx9z[}I7,e]+TkEu2+5","SaveState_zelview/spot08_scene/1":"ShareData=AB{;yUF3=IT?R1t9l|Jv=iZrq5|zy@Uqk=OT7GAjV7d+=UW*^e8$Vw/T|b?aVS","SaveState_zelview/spot09_scene/1":"ShareData=AFp[M9Xg;[8*?^vUXN0^WNI1KQ{}{!Uhe3wT_j:QVudp,9hjG3TpAf|9IZ~X+^","SaveState_zelview/spot10_scene/1":"ShareData=ARcBtUhFwj82oC0T*O{EVem-eQzzg8Ukf@fT]e3MVXtNb9F5M_8${4BUcjY*Vt","SaveState_zelview/spot11_scene/1":"ShareData=AFs3a9P!9*9dp~^UpYIfV(iA]5/?ipUeR~bUDvIAV(|^{97?GeT?wt/9WJ8e+^","SaveState_zelview/spot12_scene/1":"ShareData=AQIM&UG:r[T;{}K9h|}A=B*,iQ0gq4UnVWLT5SrTWEsLIUVup49BUKAUC}$q+^","SaveState_zelview/spot13_scene/1":"ShareData=AI&8;9SrIcUKz(S9t1U8=b*0@5lxI-Uprg=UAFusV{aVoUs25HT7g+,9PDiw=a","SaveState_zelview/spot15_scene/1":"ShareData=AZwc^UVd4/8l5Vp9ZW:-+~I1c51mr[Uu8Xe9FWzFWF4J;UEP+MT0{GnUtba!WP","SaveState_zelview/spot16_scene/1":"ShareData=AE;x&Uo1z}8)qFlUO=Q9+oc1_Q5@JpUl!;0UPGvoWLtKT9KP7n9Q=fRUea?z+5","SaveState_zelview/spot17_scene/1":"ShareData=ANpg49rmVjUQBHg90Ht|=LWA!Qc;KAUwY!iUIo^=WOq+-Uc_,GUSzbm9Pfx~+^","SaveState_zelview/spot18_scene/1":"ShareData=APi+yUvzlI9GdbCUi!=WWGXrMQ1MUKUv7&4UA2SxV)k/,92ano9WlrqUjpavV[","SaveState_zelview/spot20_scene/1":"ShareData=AL+c29oSluS-2^E8pu;eV{LWC58O3pUX@{NT;OK5Vmo{gTfHMqT(gtV9r8wh=a","SaveState_zelview/sutaru_scene/1":"ShareData=AFIMEUknM59Yl,4UJfndV^1y|Q!k(IUs==pUSBYYWO_Ju9R?d,9Vrz8UsBk/=a","SaveState_zelview/syatekijyou_scene/1":"ShareData=AW5-IUu$PuT~ZTl9x2HG+4Z|558$|OUXTl@T_bt*VbCVbUiguT8=p$qUnG9;Vt","SaveState_zelview/syotes2_scene/1":"ShareData=ASL6a91c9}TfpQV9PzJ4+oP;/Qw~@QUi*AFT=:DxVhj9=US*14T-@T&96=AW+5","SaveState_zelview/takaraya_scene/1":"ShareData=AW=UWUfQvqT1cd193|ri+zIZ9QgD51UZdW*UN3upVU_ysUvMFD8&j}|Uc]HYVt","SaveState_zelview/test01_scene/1":"ShareData=AT3eST)0ZTUKZaY9uibY=EI^/QjD/aUbS:7UDeYzV[J2@Uh6QZ8!(Z:UB}SOV[","SaveState_zelview/testroom_scene/1":"ShareData=AQZ=vUj&bzT@;rb9Ro/VWEnVSQM~F7Uq*n/UJAH8V)l-UUO]dQ9Xm$=Umu,EWP","SaveState_zelview/tokinoma_scene/1":"ShareData=ANsaGUjq~x8PbsKUTGs{Vd*|u4-Ji8Ur$*ET:2ZdVZhJI9e78g8(x7!Uf[NsWP","SaveState_zelview/turibori_scene/1":"ShareData=AK*Gz9l1vm9EJ$EUoku;V!kJQ5_hH5Uv;|5UBvnkVzxZz9pxVRUJdgB9iSLN+^","SaveState_zelview/ydan_boss_scene/1":"ShareData=AW2ViUjxxRTv;O08_=$dV|Lng5Y}E;UbSNZUS9*;++g]GT:bzi9eRUaUgx|IV[","SaveState_zelview/ydan_boss_scene/2":"ShareData=AGA*N9zwfy8?jq]UoC4-WI[0V5Yn8,UdT?]T5b7{+/liL94JBoT6vC094Ke4+^","SaveState_zelview/ydan_scene/1":"ShareData=AW,fkUwdQ+56s+FT-X!E9u{/*5tQF1UWs?X5y/N2VgUU~9A_B(Q|M=BUwBi?V[","SaveState_zelview/yousei_izumi_tate_scene/1":"ShareData=AF?[nUbhvg7&8+lT?j~$9&XUOO[Qr}Ub(C*T,,daVY|j^8@!Qq8$Lq,Urbl8+d","SaveState_zelview/yousei_izumi_yoko_scene/1":"ShareData=AYt:DUn1nN7y8z:TbEl8+U[eu39?DxUny}[TekarVY2?&8n?Y18r*iaUvoFc+5","SaveState_pik2/user/Ebisawa/title/bg_autumn.szs/1":"ShareData=APR]m96[Q9UUdQu9l]!w=aMKQ6K:DvUh/1DULNP]V][,?Uf$aQT|i-995{:O+^","SaveState_pik2/user/Ebisawa/title/bg_spring.szs/1":"ShareData=ABU_U90nOfT{V6w90NtM=b*~7RUnKdUrd*,UFE6:V($IIUuY+mUVDGI9NZ(r+^","SaveState_pik2/user/Ebisawa/title/bg_summer.szs/1":"ShareData=AEvPU9n-wNUHS149lDKw=IDWt6J,$PUWclLUNp)iWLhloUdZ6NUGJ+z946pO+^","SaveState_pik2/user/Ebisawa/title/bg_winter.szs/1":"ShareData=AQU&s9iuywUM{]U9uXg)=Jn,Y58T!|UwI&uUMsH=V*:j9UWgzMUKvHN9W0t3+^","SaveState_pik2/user/Kando/map/forest/arc.szs/1":"ShareData=ACfgTUQ1)28-|P~Uotm[Vf/c:Q(cbFUjX:)T,|;6VXK$y9sL-,8s4UeUQi!XWP","SaveState_pik2/user/Kando/map/last/arc.szs/1":"ShareData=AYzs9UXA^v8@rq=UB6/^=fniAQ&&DBUi[r!T[DHDVe7/X9X-[38^);AUos-gWP","SaveState_pik2/user/Kando/map/newtest/arc.szs/1":"ShareData=AEeF-Unt?FUT70392qn^=GUh65bWVdUdha-UNJuyWB3;kUXM{J9Y[ssUhuA4V[","SaveState_pik2/user/Kando/map/tutorial/arc.szs/1":"ShareData=AO0dPUYfC)T9aOg9pbXM+/HO@Q;01!UYtMgUSPUaV-4=GUtbNs8)sRoUi4ph+^","SaveState_pik2/user/Kando/map/vrbox/build.szs/1":"ShareData=AZGtTUW|ER8F0uLTr^^A+iKjkPyJy7UZg91T1Lia=c{);8=HDy8@r,EUeL:1WP","SaveState_pik2/user/Kando/map/vrbox/flooring.szs/1":"ShareData=ARF4G9n~N)UAj)s9Uac6=X~2QRdL~ZUh]@fUn5|iWd*i/T*MxpUj&vQ9lQAP=a","SaveState_pik2/user/Kando/map/vrbox/hiroba.szs/1":"ShareData=AY3VPUo}/|8B)hMTh2qk+nBca4^|3,UeG2&UE{wcVwV3e881TH9M^u5Usmv_V[","SaveState_pik2/user/Kando/map/vrbox/ice.szs/1":"ShareData=AW,fkUWt7k8NvBxT]}?hVW+uJPY;|0UXTl@T~Sy=+?7Lf9B;yU8?nZ@UuLs+V[","SaveState_pik2/user/Kando/map/vrbox/tatami.szs/1":"ShareData=AF,p;Ua{xHT*mc69mul1=gB+QQ~yEQUW-kdUH(y)WHr^NUmQyN9dY|_Uh:~iWP","SaveState_pik2/user/Kando/map/vrbox/test.szs/1":"ShareData=AC5(MUmUbxTtK[p9Na)A=XSyF4wAKDUrxWqT}2K;=H/ryT^LjK9Ol(0UhN6MWP","SaveState_pik2/user/Kando/map/yakushima/arc.szs/1":"ShareData=AI(Qa9r{qj9G:i~UlJk0=PFIh5zs2gUhjApURAv_V6{R^91{gsT|3O&96qu*+^","SaveState_pik2/user/Kando/map/zukan/forest/arc.szs/1":"ShareData=AJ6k$9kQaoTPGIk8?X-:Vz$;8Q5|z9Uq|2GUI)vQVhB+]T5=~&UTSYX94C1aWP","SaveState_pik2/user/Kando/map/zukan/last/arc.szs/1":"ShareData=AE[:59O1JX9UiM6Uf?$CV6s[bQ5wnFUl~9|UBZ[SV_kaj9qaF8Tch1x9TxM8V[","SaveState_pik2/user/Kando/map/zukan/tutorial/arc.szs/1":"ShareData=AawOLUpxf=T/(P)9H8mO=SDZ^Qr08eUq-nyUS~yNV/Ml|UQEH49eV+7UbJ}hWP","SaveState_pik2/user/Kando/map/zukan/yakushima/arc.szs/1":"ShareData=AK9H39h^lCT]|sf9N,iEWKdvWQ1!+RUvg71UPD_HVsn=XT*gd4USUoj9ua9/V[","SaveState_luigis_mansion/map1/1":"ShareData=AI1/MUwPI+8QAE:TphRi=r|+!5A?n}Uh5YGUM_~_V/W+W89Kd-9fdJrUYqWXVt","SaveState_luigis_mansion/map1/2":"ShareData=AD9~6Ug~e}8eoH/Ty!wc+?e7!57!+tUwUJTT~K]tV1S2+8q(qa8^NNIUYI$+Vt","SaveState_luigis_mansion/map10/1":"ShareData=ANK5)UeXT+S_!Gw8L_-nU$wmT5i@=zUbSWeUC$o!WL;[STUBKP9IQiMUgG:AWP","SaveState_luigis_mansion/map11/1":"ShareData=AT1!0UYi*ES_[:98yh(@+3)t:PX3f!UYaURT4@FSV}XH,Th3B?8/5r9Uo?BrWP","SaveState_luigis_mansion/map12/1":"ShareData=ANBz(UmA7f7Rl7n8Jt@u+3o4MO/z*YUm0Pj83AJjV23&wTEaJWTo|*]UiydAV[","SaveState_luigis_mansion/map13/1":"ShareData=AYk9CUohw9TV)Hj89]}r+r^1;P!XK9Ubsl]UKr}&V{IWLTdhCy9ToIoUawQ&WP","SaveState_luigis_mansion/map2/1":"ShareData=AFzPkUpb9MT|lAQ9zDG$=CMTdQzT[RUaw?YUSWR9V]oA]UjFf?9CVQUUidH0+d","SaveState_luigis_mansion/map3/1":"ShareData=AXM9sUwBwY8@u;SUP{gvVebw?Qa5sOUatDqUQ}&ZV69Pe9fcO:9Oqs]UdXb|Vt","SaveState_luigis_mansion/map4/1":"ShareData=AKD0bUa2b(TqS,p9rgkw=FjFG5b$SxUm2c=TtWj1VvK*[UaBA$88h,BUl]a,Vt","SaveState_luigis_mansion/map5/1":"ShareData=AbPGaUi{1d8!DqwUCVReWTC?QQMS]TUgJ-PT_qMbV+4$a9U=hK8{$wYUeF2?Vt","SaveState_luigis_mansion/map6/1":"ShareData=ANpj[UvS-B8[APyUf8BKWcIqWQ3meXUkD{ET0ctlV5YgQ97vYa8-{J(UX,9cU!","SaveState_luigis_mansion/map7/1":"ShareData=AX1TAUqT+}8l/o=UUtgzWe{h)QjLT/UXsi[T7553V,(m-9OXqx8-BKfUjtoH=a","SaveState_luigis_mansion/map8/1":"ShareData=AGCccUk,q98}4C&UD{Z8WS8G253|?dUeT+4T,RsfV1r?a9IAkL9B)dVUppkTVt","SaveState_luigis_mansion/map9/1":"ShareData=ADr54Uez@W7,d]tTcXIs+f:{a5VMVAUuU-uT2x,hWa&uR862[w8/yedUjxa5V[","SaveState_sms/airport0/1":"ShareData=ASsakUm-|W8,luRUvD]TWXRv]Q/TobUfnwFUFRROV$3PS9sL?N8-]V:UwQ[GWP","SaveState_sms/airport1/1":"ShareData=AJmf;9z0T49B^2[UbpAdWn$1v5-1eSUnMQKT+Ps~V)cMl9rrP?Tzvr-9y2+y=a","SaveState_sms/bia_ex1/1":"ShareData=ARn@7Uoo9b9T*;DUg,7?Wr2$F5&-}&UuSeHUPVR:W2ZWd95&!r9Zs2oUno5EWq","SaveState_sms/bianco0/1":"ShareData=AZ;aM9Lbzi9Vw,fUf8RfWX}@26DoCDUmcG&T}9^vWo)3[91aF^UOKX?9LS6mV[","SaveState_sms/bianco1/1":"ShareData=AKwgHT[L^sULOBD92|&p=$/yN5@Yw?UbS:7UKD;7Wj*=nUf@Kl87?vQT;IfvWP","SaveState_sms/bianco2/1":"ShareData=AQ(-?T/4=y9g;f6Uhw=~W9,,~P,iBWUhI}jT*Q;4Wkml1903Dv8x2FnT/(A(WP","SaveState_sms/bianco3/1":"ShareData=AV:[2Uc1=fTUl0vUH;jWW=mesQKRxfUq!A!8+qQGWTbf89ft@5TfZ^vUa2h,WP","SaveState_sms/bianco4/1":"ShareData=ACsjR9u=cKT|2eP968|6==i-TQ^GuFUiD_FUGih:Wt:k&UWg!+T|Ro,9uF;z=2","SaveState_sms/bianco5/1":"ShareData=AL^-:UV8giT[8?j9XT-l=/=(kQ|Z8ZUs=-rUQ_iNWpx1yUDZ7o9Cl!5UhKheWq","SaveState_sms/bianco6/1":"ShareData=ACJ)~UXbR=9S@?ZUBg=?W4QHpQ~7KRUW]qeT)^-vWos~Q9h|t89V[*eUubno=2","SaveState_sms/bianco7/1":"ShareData=ARr2S9ku;bT&?&[9kEvRW9FK[QWv;FUiEi*T6^DWWgZmQUYa_7T-o,a9vi4xV[","SaveState_sms/biancoBoss/1":"ShareData=AH8&UUpL]WTmMh69Q5um=Oit/Q5vDzUpk2ZT~nHyV!gPeT*=;D8/*3dUnQi[WP","SaveState_sms/casino0/1":"ShareData=AFm/g9nw0CT!2hE9N]18=U5:r5/lzZUtlWdUJZgrWD]TGT{Ux~UIp2m96X{Q+^","SaveState_sms/casino1/1":"ShareData=AGhBOUZK)98^xI]Uj!mUWH)[/5r}bMUZ_u^UAiJYWJ:OA9ugnJ8&4^nUhkEVV[","SaveState_sms/coro_ex0/1":"ShareData=AFM1uUb)|@9I^8VUm7:TW~sD@54&{tUes,fUJI35WuUhb9pi9V9LD^lUhI3BWq","SaveState_sms/coro_ex1/1":"ShareData=AV-9;UV,=pT{rfx93Fy!==ApAQ,VN|UrcQYUAh@eWn_ujUZH:?9K]l6UjwGjWq","SaveState_sms/coro_ex2/1":"ShareData=AADk:T|))7UNjvg9qYdk=46O@QwlXdUqb9cUGn:{WXYf_UkZpv8![p)T{Q47WP","SaveState_sms/coro_ex4/1":"ShareData=AQlq59rM6o9LDq1Uv-z7W,2ipQ[:*?Un8MMUS$sTW;L-^9j6o}UTqro9xx|V=2","SaveState_sms/coro_ex5/1":"ShareData=AN~szUV@-JUCK/L94:q|=*]geQ&&tMUc(huT|RDDWR*TiUwInK9R,Q/UfnInWq","SaveState_sms/coro_ex6/1":"ShareData=AES@2UgkMbTamVx8,K4V=LdYI5!-3hUeh5]UTp93Wg$bfT4F~n9O_;!Um$|}Wq","SaveState_sms/delfino0/1":"ShareData=AErAY9sj;?8[m9dULNgOWEb5u6Gt&=Ud*E_UL@jAWb|]N9f=2rUNz(+91XLv=a","SaveState_sms/delfino1/1":"ShareData=ATemn9xS8i8-YJ~Ui)^fV)QKh5_wS+UZ:m2Tz0v:VzOQt93AP0T7}8Z9t[)u+^","SaveState_sms/delfino2/1":"ShareData=ANRfpUf8PBT~o,[9n)mh=Nvh$54QvQUbsl]UFs/0V^nbyUmBpx9NU?GUr*-FV[","SaveState_sms/delfino3/1":"ShareData=AUVbHUryP+T4rRE9l2&/WC{,YQ8GN5UqnOkUA2~[V)R1wUoEV38^s50UlJF:WP","SaveState_sms/delfino4/1":"ShareData=ARtTTUdKGV8|Rz2UgaHiV^7[75QLdvUd20sUNY+$Whqq19y|;!8!U7sUjj7CV[","SaveState_sms/delfinoBoss/1":"ShareData=AE6)4UsO,=7!afDUs!T*Wo|m;5OUsQUVs2ETC;K}WAIKC9h(Ns7:&zrUZVs)WP","SaveState_sms/dolpic_ex0/1":"ShareData=ATOfrUo1iL9E@F3UrEr,=PxoT5bQ6,UfDYBUB*r8WfSuM93&;U8_tozUYt|DWP","SaveState_sms/dolpic_ex1/1":"ShareData=AUjm;9ljgtUVe,g9I(51=/[[vQ{ND+Uc,@2Ul@n/Wxb;OUh^s)UV52P9M^H/=2","SaveState_sms/dolpic_ex2/1":"ShareData=AQ?R0Ujm!CT$~x:9b(Xt=1f-MQpAQdUn390UQYFJWPWWkUFTa&9MO2WUkR=$Wq","SaveState_sms/dolpic_ex3/1":"ShareData=ATF2_UAj;cUEW~I9qnio=*,YbQ74WEUea!cUS9AHWc&SkUf[e[8]y@YUSyd*WP","SaveState_sms/dolpic_ex4/1":"ShareData=AQ5=~UM|S89K/lUUYH-yWqv|dQtARTUp3gET{@PqWT)DN9nuZc8!kaVUI!-CWq","SaveState_sms/dolpic0/1":"ShareData=AFM=_Udg_^8p{!HUM3m3WS6ojQV87KUV|=dT@]AhWp0|b9Krgh8-UV)UrPx,Wq","SaveState_sms/dolpic1/1":"ShareData=AR*;X96ep[UKbtd9s[yH=d^|aQwXUtUv04rUL&gbWeCOdUt|6_UQjIW9ju:K=2","SaveState_sms/dolpic10/1":"ShareData=AU;C5UQn*_9dxKxUf_uXWi!3,51@f9Ud]q!UL$^CV^@yZ9i[B38&C6QT}q!_+^","SaveState_sms/dolpic5/1":"ShareData=AJtqEUXw+b9B?t5Ud!RZW_S5T5x921UX1O@T1-^7WHP~j92bl88(]0YUuMEtWP","SaveState_sms/dolpic6/1":"ShareData=AWSPO9wQe4T!a6z9RUev=0}}DRC,GyUqZjeUHxm@W37-)UK)S@T3I3(9z~ql=a","SaveState_sms/dolpic7/1":"ShareData=AQ?2^UT(V^9RP[5Ui(Fj=!!ZsQzVi+UY16MUK3G|WEjFH9okxV9CWL@T)eaI+^","SaveState_sms/dolpic8/1":"ShareData=AYFdLUOU,R9S^{JUn4sO=6SM{5K6X:UqoB[UI~6=W,k!,92aXl8z7!_T]L;xV[","SaveState_sms/dolpic9/1":"ShareData=AOnwIT}0L5T)9N+91zTg=1(MXQvlvLUdfg|UDoL{WO2V[Ur&+[8|b5^UE*6L+^","SaveState_sms/mam_ex0/1":"ShareData=AAI:XUWAvvT+!qY94VfL=54Zx6F*5EUnm&rT)9O3WWuWoUv5Rb8_9v:UcE[_WP","SaveState_sms/mam_ex1/1":"ShareData=AIvZUUP(SiUYQQ/9vPZD=ccsDQz]OHUX+b*UfK|+W38eIUrMye9Gdg4UJL=h+^","SaveState_sms/mamma0/1":"ShareData=AZ-X^UjWIu9De/dUFBMa=J9vBQ$_Q:UdC0QUJyx+WCcyc9i5I{9G4VqUd3@RWq","SaveState_sms/mamma1/1":"ShareData=ADRet9PG=h9OdOqUZW&5Wb}2v5y&_KUYw;xUD]?2V)8li9iA(oT={n79G/oq=a","SaveState_sms/mamma2/1":"ShareData=AS~xJ9iRqT9W^OaT*10KWW(el59OWYUnR85T^)P-V*+*a96hx7UQ[o$9zxAYWq","SaveState_sms/mamma3/1":"ShareData=AVu0BT|xJx9TvPnUv5Vi=t(5}5rBkXUs$&YUMK/OWP+Hm9wp+@8|*RpUS_IL=a","SaveState_sms/mamma4/1":"ShareData=AS/~@UV0m:8$QY3US^_{==EME5/J2(UgS~4UNLQUWfLV]9UH)U9ZY4mUnT@v=a","SaveState_sms/mamma5/1":"ShareData=AIvsv8?~M*T,@?z95O!zWz,t:Qe{*PUh_tVT&)4)V*7vsUgvw6TZ2}h9Aq4*Vt","SaveState_sms/mamma6/1":"ShareData=AJ]}LTxBYP8/)K!UYPI:Wxc)eQ)v&:UjsaXT;Rp=WAo]k9jLDe8USRzTrpFj+^","SaveState_sms/mamma7/1":"ShareData=AAv?39E}N|9QtNYUn9gu+8=j:Qzy5VUsq1;UDCZiWp}zj97SmqTuBA-8:4LM+^","SaveState_sms/mare_ex0/1":"ShareData=AWx@VT0:))UCkga9yS[g=&SmS5?*ivUdii0T^l5L+/@EEUd?@j8@}pAT7}7sV[","SaveState_sms/mare0/1":"ShareData=AMcgj9nz-xUB-6E97?yN=*sa-6Hbg:UqxH]UIpbPWk7f|UZ-aIT23OS9i=oD=a","SaveState_sms/mare1/1":"ShareData=AV$F59kEX5T{w3Q93ev8V/|tm5NS{cUW1u$UTQfFWyL({Um/UdT}Ak296rbkWP","SaveState_sms/mare2/1":"ShareData=AF!A}8?QYPT*1fe9k-t4VzYNb59[x7Ury8dUN@VZWriv&UtK)UT5tIC8?:L?=2","SaveState_sms/mare3/1":"ShareData=AXI(/9taPoT|:Yu9qWv-=Ys3EQ,0c?Uq3zvUWCvPWX{K&Ujz:HUCzSZ90{k,+5","SaveState_sms/mare4/1":"ShareData=AE,_09oI7EUH0Y(9jZ!8=5!k^Qy8?gUca]KUSL&*Wo09nUt2eXUTkaP9y$5*+^","SaveState_sms/mare5/1":"ShareData=ADX-a94JWtTBLvK95~O]Wpp2&Q4IpyUi~VgTI1t)WMzNqUfc14TCuzW9seY?WP","SaveState_sms/mare5/2":"ShareData=AVcI4UP,Jd9GCA-UY,&2WBve&5-NL_UWk6QUO@g}WWxI*90x9c9AuqrUU(DSV[","SaveState_sms/mare6/1":"ShareData=AJy!h9vK@kTFp4l80+x==Xt0R5{a]LUgKvsT)|QLWtJ_yThUrKT{p,&9h2:LV[","SaveState_sms/mare7/1":"ShareData=ANAy@9gCG@9c!T99lumu=7=qqRCPo6UvETP9YK)IWl7vtUkPi~9H/mG9Z=t|=a","SaveState_sms/mareBoss/1":"ShareData=AVWVy9T3km9Xv:/9vC4X=l+@NRB&sNUil;E9VWa!=8heNUj8c,9CLDH9e@?B=a","SaveState_sms/mareUndersea/1":"ShareData=AI~fP9t=TEUG~c496O1o=i;d*5-fR;UZHs9UBEhO=X[TXUj|9VUHq)39sh[e=a","SaveState_sms/monte_ex0/1":"ShareData=ABU41UZAem8$F}L9p^7S==ovy5Uh=(Uv+=88:/[PWZW5NUZJYZT3vFAUo8e3Wq","SaveState_sms/monte0/1":"ShareData=ARh(dUsPAO8-lA{UeYr?W3KD*5wQPZUeE?IUUAD7Wo=YQ9vIe[8}QqvUcu6JWq","SaveState_sms/monte1/1":"ShareData=AJLQ9Uv;z(8!ninUrs/!Wad7-QX9N7UZODRULDgzV*7]Y92?DS9Y@WlUlg?&Wq","SaveState_sms/monte2/1":"ShareData=AB/_?Uj=y@UNfhz9MhQh=b|KA5/[5~Uk-G:UK=fRWQEzhT{KS-9T+jhUjL8pWP","SaveState_sms/monte3/1":"ShareData=AOlP4Ui:B[8)q_!T^!;pV@k{VQp2/vUiV}-T|vZcWHO=l9Ymi39XfMEUY-=B=a","SaveState_sms/monte4/1":"ShareData=AD5O4UnzzA9YoRRUb&Z(Wg^F/Q7VVcUlPe?T^jBdW6R9Z9nlhU9RMdTUp{P6WP","SaveState_sms/monte5/1":"ShareData=AO[kZUk0vr9AO8fUY2F@WwQK?QcXlbUj]{6T/,RL=O[7y93S8j8}^F?UYKN_WP","SaveState_sms/monte6/1":"ShareData=AS@(E98LVyUFLTW9p*RH=q]wa5zK&MUY5@yUBx9JV*i=,Ut~^}T}{[M92PB/Wq","SaveState_sms/monte7/1":"ShareData=AD{:SUe,!R9F_^VUcejjWsgqBQ(r_KUh)W3UF]!EV&f6)9209f9bEkYUfHGL+5","SaveState_sms/option/1":"ShareData=ADY]jUXzwk78M8cT_cScV$N7x5QW:hUtto5TYt]DV__+@8$q+68lAUeUtp+W+5","SaveState_sms/pinnaBeach0/1":"ShareData=ANSS$UWMO9T9c=&9syXD=yUA1QJZ]]UeGn/UJc0cV^g?WUZt~j9GTHFUv71bWq","SaveState_sms/pinnaBeach1/1":"ShareData=AO^/dUf:/M8$1IMUe!FNWtFSbQ_BDJUX*g&T~Nj=V(7]=9q]8q8]g16Ur[)uWq","SaveState_sms/pinnaBeach2/1":"ShareData=Aa:z[UMQT)URmHe9p0(L=t~Ri5=+2EUm(vmT}bBmV^{k2Uj!,K84kOzT|!{JWP","SaveState_sms/pinnaBeach3/1":"ShareData=AHQPg9G0!Y9e;NPUc2i]Wz^DhQ/5p(Ulw6@T}t0GV$gEn9g(j+T;93z9W?DTWP","SaveState_sms/pinnaBeach4/1":"ShareData=AFYoJUnT1r8:0ACUs6RqWwNJ:5mhQ7Uwdc+T*LiCWEYO09h9Un9O{~xUrJHWWq","SaveState_sms/pinnaBoss0/1":"ShareData=ACvxYUF5PYUELHe9tB=/=36gK59[]^Uj3ChT}uHAWi&_GUX2/j8|/|zUIL@wV[","SaveState_sms/pinnaBoss1/1":"ShareData=APS30Um,$!UT9C[9SV|3=M6Gn5tfWnUnwVhUUT,sWg&!fUWSoj9S:H4UW$Rt+^","SaveState_sms/pinnaParco0/1":"ShareData=AUYm{Tn5|,UECQj9lYn(=liiuQhX&gUpmBsUI4)xW,Ah6Uux|288r81TpV8z=a","SaveState_sms/pinnaParco1/1":"ShareData=AJ-jRUj;aGUK,QH9u-i*=geBNQ:dg(Uio8zT{2sEV!_?iUtgl+9e^@IUhQzX+^","SaveState_sms/pinnaParco2/1":"ShareData=AWU}j9v|?+T(s~p9mT|Q=~XG_QNc^:UYI]cUK-KTWK^VVUg4~YT7B{$9vp7c=2","SaveState_sms/pinnaParco3/1":"ShareData=AKj3/85k5DUK*N;92TUQ=a{)06CKlEUmH+OUMrGVWMTF]Um19~TD!U|85[3O+^","SaveState_sms/pinnaParco4/1":"ShareData=AU6(S9pU{J8=3gsUN?riW5H{35@]]UUd+1FT*Y2IWZey69Qx53US^M29rKGo=2","SaveState_sms/pinnaParco5/1":"ShareData=Aa*y9UUPlF9J4WCUe^7zWs;BfQ1I0rUrqeUUV:O;Wt;Na9oqOQ9NiCrUOe)j+C","SaveState_sms/pinnaParco6/1":"ShareData=AW)Hf9wNgmT]gwP9X&IF=bK/+Qxr68UZM9HT:DOxV!CoqUD4mlT$,J49qLvl=2","SaveState_sms/pinnaParco7/1":"ShareData=AKT-uT^-|VT0YLb9r;TfWqFmv5}:t)Uk@S[T41w}WcoNIUYzR/9E!cKUM$iT=a","SaveState_sms/ricco0/1":"ShareData=AK:hhUtJr}9UnCXUaYYYW0IPUQ:BJsUubkIT(&9KWf97Q95@aj9e|*=UY!_jWq","SaveState_sms/ricco1/1":"ShareData=AM53yUqWQi9QYarUrs$3V1}Xk5U-cBUrl65T(^URV^S4:92!]M9Wf_3UXUJEWP","SaveState_sms/ricco2/1":"ShareData=AMXgZUCWhjT8s1$9j?FN=svhEQMuGWUf:uMT6R}9Wf3~*Umzg+9BjqbT}@d4WP","SaveState_sms/ricco3/1":"ShareData=AHx&69yIAB9ZXmlUW|Ak=xKKz5a|u7UXP8hT{D/AWgEf193=!uUM$M{9k?qmWP","SaveState_sms/ricco4/1":"ShareData=ALgYD9UV~tT)djZ9ybS~WSPUcQg]-?Uv&,TUB~Z7Wp,pAUW?e(T:H3[9S,jSWq","SaveState_sms/ricco5/1":"ShareData=AK[S6Uc1I?8t,2JT[UDKWwn@oQ?M{hUl{YFUM1DwWEzT88]A5c9YLB(Us9QXWP","SaveState_sms/ricco6/1":"ShareData=AEF$!96pQC9U,r|UQKhBVk:4{P}T^EUkZ8fUUn~QW-S3(93*|uUQUz-9k_T+V[","SaveState_sms/ricco7/1":"ShareData=AB;hzUq!OU9KaC[UozSU==;YC6MN6cUgvQyUP]pCV@YRr9zIME9gVgaUo]fpWP","SaveState_sms/ricco8/1":"ShareData=AD=4=9H+d;UI)E~9t2t~=~2$C5sE3tUeI=aURZR|Wo}g}Uv6}aT2=ft9JAzbVt","SaveState_sms/rico_ex0/1":"ShareData=AXouGUcuGr7X?~1TEE$~W_F2tQegB0UdPsDTv?4zV}QJH8J$L=85Gm@UqLgHWP","SaveState_sms/rico_ex1/1":"ShareData=Aa8LuUXfHGT*5k:9h2V^=-k)5QttvYUp-mFT{xk{W:L90UqHA+9L-+FUonyTWq","SaveState_sms/sirena_ex0/1":"ShareData=AQIf^9nK@KUFxv09rQc?=8ZFo5-VJmUg@3yUON,]WkDnKUpQUmULr7G9s~2*=2","SaveState_sms/sirena_ex1/1":"ShareData=AM9W6UsJrq9Y3)(UrLqRWtXOL5i6dNUYlR)UPSm+WRJb~93bF;9YWy{UqV+iWq","SaveState_sms/sirena0/1":"ShareData=AFL6jUVgXrT[gfx9cnuE=peyiP5e7SUvy?3UQIyfWX;LfUPUYb9Mf9DUgWysWq","SaveState_sms/sirena1/1":"ShareData=AON-Q9yimp8)PP!UZQ5sWqKt}5?PeMUY7?@T|KrOWG_8U9l(X&T;bbZ9hJ&SV[","SaveState_sms/sirena2/1":"ShareData=AKPa:Uv@Y$Tq(}?9C;9{+6_NHP5|7]Uh3=cT1?C1WDMt@T+Q]*8(yFAUa5Y9+d","SaveState_sms/sirena3/1":"ShareData=AE)C)9xMsPT=/[u9s8{xWkhL6Q7=*2Uq,gnUS-2iWF4LuUiebTT*9x09t&I&=a","SaveState_sms/sirena4/1":"ShareData=AYFC*UhSQ^9Od)=UpY$i=i4PURCHlGUetCeUS[JpV@YRR92s3B9Sij,UZ_6GWP","SaveState_sms/sirena5/1":"ShareData=AC,?=9xGZqT;cFB9Ikfd=dCDr4*Q^,UktFCT@KK3V^gT/T|n5lTz3gj9maoa+^","SaveState_sms/sirena6/1":"ShareData=AJ!9Y9rk3+9TVKIT|2Q/WW[WQ5;5Y}Ue)+,UlG)bWQee?9N(NNUHpFl9n0,==2","SaveState_sms/sirena7/1":"ShareData=AOczU92UJ}T8-q{9o)y}=ZmQ@QI@x~UdA-8UH8K?V(RIIUVyu,T95&^9qOwsWP","SaveState_sms/test11/1":"ShareData=ARh~DUaU]SUN$o69nvj3=m4F[Q0ivLUk*LlT*[OcV@K~yUv*qu9Kr8CT)wnpWP","SaveState_rtdl/airfortBg/1":"ShareData=AYt:DUa&DV8W52pTw!bRUc3XsPF:9}Uk;UJT2c=aU}t@(86gpO9CYepUogxNVt","SaveState_rtdl/airislandBg/1":"ShareData=AY2]EUdFCI8MUE-TY6ChVFz[O4_t|CUkGalUBbu:Vk&*V8vi@i9a?unUc[iBVt","SaveState_rtdl/airtempleBg/1":"ShareData=AQ~lAUupceTy!Zb9UqEgVnoYpPu;0hUkT:,T+EkjVib-?UA}7v8_r(|UkKbe+d","SaveState_rtdl/bridgeBg/1":"ShareData=AAABrUVH5=AAAAAATZ?rVtfI:AN}S6UYonOTk/m@VSD^,ADg,k8x(M$UY~oYVS","SaveState_rtdl/caveBg/1":"ShareData=AYlJNUk1N[SuFp-8uc*]+RmaK3{!goUqC4!T;SebVUiQYTopXc8-ALcUt_bcVS","SaveState_rtdl/cavenormalBg/1":"ShareData=ATQEEUvgPtS2mt;8]9CK+8_F|QDpx,UVRhATfSw]VZWW9T@GSN8z/8@Ugr@2Vt","SaveState_rtdl/challenge1Bg/1":"ShareData=AAABrUVH5=AAAAAAAsMyVtfI:AX:-JUgZ=TTII|[UVH5=ALSFp8gkxaUrx~xVt","SaveState_rtdl/challenge2Bg/1":"ShareData=AAABrUVH5=AAAAAAN~UqV[6R;AAABrUVH5=AAAAAAAAAAAAAAAAAABrUaJW@V[","SaveState_rtdl/challenge3Bg/1":"ShareData=AAABrUVH5=AAAAAARzI[V[6R;AAABrUVH5=AAAAAAAAAAAAAAAAAABrUq=A4Vt","SaveState_rtdl/challenge4Bg/1":"ShareData=AAABrUVH5=AAAAAAQqctVSD^,AAABrUVH5=ARo@$VSD^,AAAAAAAABrUq]N!Vt","SaveState_rtdl/challenge5Bg/1":"ShareData=AAABrUVH5=AAAAAACJP-V[6R;AAABrUVH5=AAAAAAAAAAAAAAAAAABrUrh9UV[","SaveState_rtdl/challenge6Bg/1":"ShareData=AAABrUVH5=AAAAAAQ[53VtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUoRQYV[","SaveState_rtdl/challenge7Bg/1":"ShareData=AAABrUVH5=AAAAAAIq!NVtfI:AAABrUVH5=AAAAAAAAAAAAAAAAAABrUmyVqVt","SaveState_rtdl/desertBg/1":"ShareData=AX:-JUp2HW7ToCP8VrGRVe[:KOQP@YUmP$f8vMU2VB/!UTLU8CTYvIFUu+ehU!","SaveState_rtdl/factoryBg/1":"ShareData=AAABrUVH5=AAAAAAExO(U!9!_AX:-JUgZ=T8bEGnU!9!_ALSFpTU0A;Ums37VS","SaveState_rtdl/finalBg/1":"ShareData=AX:-JUXFm0Sy?0zS{~V7AJC=JN^f*?UYROQ8/_7VVB){V8J/DlT+ys4Umq6kU!","SaveState_rtdl/gckbeachBg/1":"ShareData=AAABrUVH5=AAAAAAS{_(VSD^,AX:-JUgZ=TTN:h5Uwi,-ALSFp8gkxaUeaUXVS","SaveState_rtdl/gckcanyon2Bg/1":"ShareData=AAABrUVH5=AAAAAAJ{!|VSD^,AAABrUVH5=AKFK)VSD^,AAAAAAAABrUVr^q+d","SaveState_rtdl/gckcanyonBg/1":"ShareData=AAABrUVH5=AAAAAAK9OEVSD^,AAABrUVH5=ATsZZU!9!_AAAAAAAABrUmV}a+5","SaveState_rtdl/gcksnowmtBg/1":"ShareData=AD*F=Ud^ymS~LI/81QtfU-4(wOv|y5UlLlUTo5BfVH9DgTi0*k8w1@0Uu$v$VS","SaveState_rtdl/grassBg/1":"ShareData=AL~LUUpo0iUJj[=9ie}(+mc{B5+45;UuSGHUR:$PVeBo^Uf:7z9PaTZUeK{EVS","SaveState_rtdl/halcandoraBg/1":"ShareData=AP_z0Uq_Q[7{}PeT(l1dU_uA)4nVJCUdf3;T/+uOVNS*D8@{MY8?vCnUeFmBVS","SaveState_rtdl/halcandraBg/1":"ShareData=ANBz(Ud9_wS8e+=S{~V7ATNs9OnlitUrfKo9Pmj0U5;4u8XcVIUG|@OUh;/)Vt","SaveState_rtdl/icebldgBg/1":"ShareData=AIJScUZh;kS]JP_82PQ8VhpNjO}lICUh;yVT+;z[VBwqwTcRlT9CDgtUa~U[+d","SaveState_rtdl/icecaveBg/1":"ShareData=ANBz(Ub1&Y7lG!6TO661NZcyjOT8y;UhJF5TyOf{Vbl@w8J-^)84ug&UWjWs98","SaveState_rtdl/landiaBg/1":"ShareData=AAABrUVH5=AAAAAAXDgh+CunXAAABrUVH5=AJbU-U!9!_AAAAAAAABrUs|hmVt","SaveState_rtdl/lavaBg/1":"ShareData=AAABrUVH5=AAAAAAVDsH98TeWAAABrUVH5=AVAUKVSD^,AAAAAAAABrUd{duU!","SaveState_rtdl/levelmap1Bg/1":"ShareData=AT+{1Ued+CSa*duTyr/yVi{?3PGI|7UYHZb85$krVbj++8r=4ZTo5K{Ud{@eU!","SaveState_rtdl/levelmap2Bg/1":"ShareData=AQ{*WUb{I~7WMCETbvg$VlQd,4rJX^Uk?yzTE|eHVSN6t8o8d:8Uxi$Uo)I4U!","SaveState_rtdl/levelmap3Bg/1":"ShareData=AWi:*Uv0V=7wT0K8d2GWVT_2yOjPSZUrYIx8kc/iVbh4)TTk(wTqWu(UepgnUw","SaveState_rtdl/levelmap4Bg/1":"ShareData=AAABrUVH5=AAAAAAB8V{VSD^,AAABrUVH5=AO:omVSD^,AAAAAAAABrUX^^Y+C","SaveState_rtdl/levelmap5Bg/1":"ShareData=AAABrUVH5=AAAAAABKY{VSD^,AAABrUVH5=AOxcsVSD^,AAAAAAAABrUg)Bo+C","SaveState_rtdl/levelmap6Bg/1":"ShareData=AAABrUVH5=AAAAAAaFS]VSD^,AAABrUVH5=ARW]/VSD^,AAAAAAAABrUpS)p+d","SaveState_rtdl/levelmap7Bg/1":"ShareData=AAABrUVH5=AAAAAAM6h{VSD^,AAABrUVH5=AD)OeVSD^,AAAAAAAABrUt=f!+d","SaveState_rtdl/logBg/1":"ShareData=AAABrUVH5=AAAAAAV}DAUVH5=AAABrUVH5=AQ()mUwi,-AAAAAAAABrUcqU,U!","SaveState_rtdl/lowper2Bg/1":"ShareData=AK|&xUir}O7;gXR8nIDpV+un[4+9?5UlDD^9DCJG9wSkATlHtvT&M0jUd[6^VS","SaveState_rtdl/lowperBg/1":"ShareData=AAABrUVH5=AAAAAATV[2U!9!_AAABrUVH5=Aaf(NT(_w+AAAAAAAABrUYV/cU!","SaveState_rtdl/oasisBg/1":"ShareData=AX:-JUqwNSSU3|+8Q{K*+CunXAOW;PUeAgKT5Zn1VB){VTC[D-8]&lAUY?;8U!","SaveState_rtdl/popstarBg/1":"ShareData=AHpg=Ug-)H871BGUBD4*VL&Nr5x|V,Uria[UFs{3U)Xb59Q7YE9TxgrUWe7!VS","SaveState_rtdl/popstarstageBg/1":"ShareData=AWxG6UqQNTTHJds8{u&*VmU!QQa26UUbqx/T8wRNVYF&CT08PZ8=uEdUZo/-VS","SaveState_rtdl/pyramidBg/1":"ShareData=ANBz(UmP*dR_KrU8P_U?8=XDTAX:-JUgZ=TTJi+wVAK_vTA4lf8SCC9Urs$UU!","SaveState_rtdl/seaBg/1":"ShareData=ANpZIUlp1:7,@V3T1cqgT_cv:4[4?UUWOCJTt^]uU1_t-8-Riz8u4a|UcxHDU!","SaveState_rtdl/seatemple2Bg/1":"ShareData=AY3VPUirppSK[:ITp[s=+i{XbPBi?OUenj78o;QIVUG|V8=DdITpRpBUj9FP+d","SaveState_rtdl/seatempleBg/1":"ShareData=ANBz(Uk;D7R7$D4TF^0;+8*m;3k]?*Uepvt8SAuxVbl@w8Km6NTW=hCUZT@VVS","SaveState_rtdl/shootingBg/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAY3VPUXK4STd,yl9FyMUACC|o88zPhUf;D++C","SaveState_rtdl/snowBg/1":"ShareData=AWr]{UoTV5ST|5|8X7)iVuB$u3$L;VUW7gOTjnEwVA/FATJaLa84BI@UXF9+VS","SaveState_rtdl/subwayBg/1":"ShareData=AWr]{UZ86yR|tq1S^$g;+nv2h2:T1(Uepvt8jds=VAY7*8c&!PTE(xFUX(em9g","SaveState_rtdl/sunBg/1":"ShareData=AAABrUVH5=AAAAAAbAbrVtfI:AAABrUVH5=AA{4?U!9!_AAAAAAAABrUt|3]Vt","SaveState_rtdl/volcanoBg/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ASg:}VSD^,AAAAAAAABrUgQvfVS","SaveState_sfa/ancient0/1":"ShareData=ACZR^9z*_/UU;3c9WR5G=E64-RDe]AUrHWfT}1lG=FUz|UF09;UHvu&9sT@x+^","SaveState_sfa/ancient1/1":"ShareData=ARt^DT8x0;9e|naUvo:RWDi_v6F*5EUmhRhUQ$tN=M[+29q2n&8v/PXT3)j[=a","SaveState_sfa/ancient10/1":"ShareData=AFgf|Ujy0V8~[|BUL+kEV8WMW6jF_[Uo]{5T*]nHWYF]x9Liz/9Y-7fUuoO1+^","SaveState_sfa/ancient11/1":"ShareData=AY/0h9GkpH9Q{TgUuA!+V2RKKRB4NCUfy+oUIbA/V$tB_9ve*0T_J?!9Xdgd+^","SaveState_sfa/ancient12/1":"ShareData=AW]JS9cp^b9M}&*UYABwWB;q&QW9QoUi:nZUS5Q}=I-k~94I+jT4,wN9G7?L=a","SaveState_sfa/ancient13/1":"ShareData=AXCjJ9iguq8)cAFUF(s~V8lIN54nu[UmuE8T?Y~K=xi9i9L6$5T3DXI90Ic*+^","SaveState_sfa/ancient14/1":"ShareData=AXfg_9zb+Y9T?RVUi8HDWUF{gQ,J}WUhh-9UNnMsWBla(9sty!T[k-C9k&Qa=a","SaveState_sfa/ancient14/2":"ShareData=ALilYUl2|T9Fg9VUo@b=+:mS(Q*mI-Ugj+gT[$bFWD[k$9s]Ed8)nIrUo&Gj=a","SaveState_sfa/ancient15/1":"ShareData=ABXDpUgPWrT~v?m97|cY=A7d^QUq0&UYaURT?aNYV:6CVUpA}_8-PGjUf!:=+^","SaveState_sfa/ancient15/2":"ShareData=AB@[d9wde,T&w1M9YpwX+ncy6RC5AxUp|RbT|4RCVw/J7UOr@GT&vf89z(Kk=a","SaveState_sfa/ancient2/1":"ShareData=ACVwV9fghv9X~E]Um92-WAeD,5{Qo+UeG2&UC)K6=DWb:97a1MT1(kE9VizR=a","SaveState_sfa/ancient3/1":"ShareData=AM?J29ZT]MT!Q9Y9urSO=Nvo(5$r!=Ud;zYT]xi[=Gk6ZUXcAqTa*[w9F1:p=a","SaveState_sfa/ancient4/1":"ShareData=AU(qLUM*Ps8]M|YUb0YvWD43X5e,T&Uq/RPUP32?+^39;9s^yp8-fq[UPI30+^","SaveState_sfa/ancient5/1":"ShareData=AT=y[UAx:$UBSCF9kcvI=0F}bQ+oAcUZ)*vUQ1&FV@7cBUVM0a9D3G]US)50=a","SaveState_sfa/ancient6/1":"ShareData=ACnT692Wqf9Wo|$UafcBV0n|C5929}Ui$taT{x1LVXr,F90Dj/T;_],96^Sh+^","SaveState_sfa/ancient7/1":"ShareData=AWzgK9jF3@T=A]19em^N=m~v~Qr$pWUoMJ!T=1;IV&b{zUTl~oT/0&$90*K7=a","SaveState_sfa/ancient8/1":"ShareData=AGjx)9N3OX9W8uxUb(PAWfsfnRR?q7UvzH;T};P==J+sU9prbOT3d6j9gDh3=a","SaveState_sfa/ancient9/1":"ShareData=AUM-PUdH7+TuIl]8&=4)+:$sKQpk6tUdd9ST)}xCWdujsT!gdi9P|d$UWLVd+^","SaveState_sfa/loc10/1":"ShareData=AUt=e9EtICUU4K}94Khd=Evl2Q^|GoUkP5kUKja*+=*WwUoJ_zTrGq}8^a~Q=a","SaveState_sfa/loc11/1":"ShareData=ASNFY9uRYw8{LGpUk4_fWVT-25}]m!Ul{YFUF}]v+vW_59q1wwT9Lb?9kn+==2","SaveState_sfa/loc11/2":"ShareData=AH8BhUZLG/9I_~CUMa6GWJPMW5zx;zUW$F$Ue5y7WETzF97~Xh9MV^&UdgUx=a","SaveState_sfa/loc11/3":"ShareData=AG{(]UN]M[UP|2~95@jA=uedM5{{YRUiV}-T}]IeWBCa1UwaII8@j=MUJV+J=a","SaveState_sfa/loc11/4":"ShareData=ASoycUj0JWT]_C,93D*R+5ruj6CBfDUm1HTUQmK^V}!nKUlGE(9I:OeUpT4E=a","SaveState_sfa/loc12/1":"ShareData=AN@:oUT!F&9Z/QoUbK]B=L;LT5=YKWUX,KEUJ5qwWJj=i93*UM8(1uhT}9O5=a","SaveState_sfa/loc12/2":"ShareData=ANBAq95K8qT=u,i9PH7F=h{XSQ@LTpUqh(LT{EtHWLD;dUU$aIT;bJ^93zuU=a","SaveState_sfa/loc12/3":"ShareData=AQbmXURc*F9f=B0Uh|;*WGsE25(8u4UchrLUK/3iWjm$n9lgs{8?Q&tUNWBT=a","SaveState_sfa/loc13/1":"ShareData=AL-kcUfJqL8sHOzT;(_7V0R(G6ZLgoUh*YoUI-T+=J(6f9E8zk9LS{2Us2&Y+^","SaveState_sfa/loc13/2":"ShareData=ASE=GUsC5@8r4|(T5akkVwj306ihf~UdQv6UDA(D=NpF-8&Z7l9Tsg$UlnrF+^","SaveState_sfa/loc14/1":"ShareData=AER],URHbdUHcmx9h)3*=M[FmQG4BPUaxf1UQ^U|=V!FCUqF=O8;adcUM0jG=a","SaveState_sfa/loc14/2":"ShareData=AZjNr9zih}T[/BO9Ztq8=Ui:N5=drGUjr,9T-K;^=W?kVUK}i-T6cHG96[NJ=a","SaveState_sfa/loc16/1":"ShareData=ARV1sUF}(c8,7vnUXf@FVtZ^76LQH}Uq_i:T!x5@V&rVi9oPR*8vD:~T}WL3+^","SaveState_sfa/loc18/1":"ShareData=AA5sC90Q,(8vy[N9v7)A=SUR2Q(iB}UYrv]8our~=Jl=KUa^ga8q(f[90j;5=a","SaveState_sfa/loc18/2":"ShareData=Aa]EeUEW8T9d4R_Ufa]xV!FGK5*&;~Uf/6hUO2]K+/k_n90)@$8:oA^UHWuo=a","SaveState_sfa/loc18/3":"ShareData=AC{-D9a/D-UD,z99s!i/=L!jT6D[;AUqb9cUL2iC++xrIUo&XgTg|y$9b+/]=a","SaveState_sfa/loc19/1":"ShareData=AK0*N970Dp84qa&UMU7vWnW9j5DkA!Up7BcT~eRv=UPb89ThP6T,Q*W9xUmc=a","SaveState_sfa/loc19/2":"ShareData=ANUY=Te-F!UN8}J9yB0v=gAy{ROtFXUr/g;UIsl(=E)?SUkLyn8dA0YTt+6&=a","SaveState_sfa/loc2/1":"ShareData=AL9i~9Uw;6ULTn~93MDf=Mxq,578GaUkOa!UNHG3=E!r9UhG}jT,v4E9ZC*!=a","SaveState_sfa/loc21/1":"ShareData=ALJw2UXS0w8]aAwUvrd@VcPsZQ@=U-UW4}kUEPM?=kU_g9v/*O8=0R$UoAvC+5","SaveState_sfa/loc21/2":"ShareData=AR*5FUh+*?822nuT[}$eWH{obRArw6UwfRET,Iks=wgQz9E*Pn8}nKWUsS&!+^","SaveState_sfa/loc23/1":"ShareData=AOYuLT*|s]8!grgUd2VX+=R[zRZ@PkUX(DfT!16qWT0MW9wZ3{8v+46UPH8E=a","SaveState_sfa/loc23/2":"ShareData=ANbS?UhmY[UC,aR9mwW4=Kh7:5!yl0UXfKnUO]sSWTHFTUlc{X9PBYGUsyPB=a","SaveState_sfa/loc26/1":"ShareData=APS+fUCF@59Jc4SUcJ-|WZvIWQ(4?iUm8z{UT|_oV;[F@9o;/o8,o,rUAPv/=a","SaveState_sfa/loc27/1":"ShareData=ATTf19tVA*T2jDk9zmB}=E?CE5=sL$UaVOAUG3b]+^+W^UcV*bUU1=+9xF&p=a","SaveState_sfa/loc27/2":"ShareData=AFQX^9xSP:T@~S,9zI8DV}{F(5?*9[Uj:g-T)@=2=TRQBUjLPIT:Wwn92Mi{=a","SaveState_sfa/loc28/1":"ShareData=AVt|xUgMtgT21)J9nlW_=OPO_5UgQiUoy69T&1qE=hCmHUf6Rf9A+n[UWaZ*+^","SaveState_sfa/loc29/1":"ShareData=AJW3!9fjP&8^=~5UvC3GWg0|/5R{xJUs-D1T)fWp=AFyl96c(*T9zgx9Vm/8=a","SaveState_sfa/loc31/1":"ShareData=AO$:nUl|&v8;BKjUrv}bWJJG-Q29@@Ui)yoT6(d&V?P)$9i_]m9D__~Ucgh-=a","SaveState_sfa/loc31/2":"ShareData=AHRX*9sz298}VnrUtv4=Vw!SGQ65JPUklb)T687PVn3/V9hfy7T~xM&9w6Ge+^","SaveState_sfa/loc32/1":"ShareData=AA*6h9g}BzTi8D+91+f~VvD2i6K37&UcUN)Tbrw}VVWfPUk[ERTkqEO9uAHr=a","SaveState_sfa/loc32/2":"ShareData=AUdS:9kq?s9D;^2UZDk-V;xx95&V!4Ug&b$T6&{gVeDh[9wk^YT71E}9mCg4+^","SaveState_sfa/loc33/1":"ShareData=APu~k9wK=jT7l=(9uwQ=WEyP|5|qO8Upo/uURLhgVxAlQUchUZT58s$94IHT=a","SaveState_sfa/loc33/2":"ShareData=AMpVA9v0lE8*!qBUZakWV?huh5}8*=Uq;!PT5R}DVpav^9oFz^T&qKe9pF0g+^","SaveState_sfa/loc34/1":"ShareData=AaghVUmK6XT@@ze9jcT)Vyt035yV^6UW|=;T-tB0Vj(v[UZziE8~xX}UV9x0=a","SaveState_sfa/loc34/2":"ShareData=APU~69k(elTYk,A9Uog&WBxwM54~p_Uq3z5UNjEgV:x_,UU30+UG^cV9pzK;=a","SaveState_sfa/loc39/1":"ShareData=AHog6Ul@!kT6B2v9nLKg=JPM853xq)UnS,JT2n,NVV[GwUi}Pe8-=:5Uk5S?=a","SaveState_sfa/loc39/2":"ShareData=AL8_Y9pH[Q9CyYOUr/?IV:+$UQ)&=7UnecMT]LO4VwErR9rw^gT5$:k9yud*+^","SaveState_sfa/loc4/1":"ShareData=ABSQ89P28:UCBB39r7;$=Ix-:6FI!QUte5zULT3hV=Id3UbV1uT91qb9WrxZ=a","SaveState_sfa/loc4/2":"ShareData=ARg^j9F/p$9Z4@DUf_i3WKT!75^/+gUjcU@T}_9PVbA_!9m&G)T3sVM9J^=v=a","SaveState_sfa/loc4/3":"ShareData=AKY7892tZc9AImoUKh1mWMJQF6Az^hUn(MET*QV4V1ITS9b*/EUFn-E9yDoB=a","SaveState_sfa/loc4/4":"ShareData=AJf~/T_sigT!wz(9r&y4=E;K!Q~gciUr9ZCT/P/rV1t7&UYO6M8gepET,b@6=a","SaveState_sfa/loc40/1":"ShareData=AS[gW9YV(i9Iqx,Ucpn,WN}+35$|M-Utk4GT^[J:Vv2fg9xinBT9^(v9c8ti+^","SaveState_sfa/loc43/1":"ShareData=AKlrt9b4619JY)[UX2g;Wl3*&Q?o*5Ub?3$UN^GqV}Zra94oyhT$ln_9d(&&=a","SaveState_sfa/loc43/2":"ShareData=AQ~GuUgTj18/jO@UX0!++!~ZtQ|{]{UhzJ-T~tT^V!CQ*9rCQV8|b8VUc3HG=a","SaveState_sfa/loc44/1":"ShareData=AaHliUY+1|8)|e;UYHt:WUI{0Q@&srUd?/zT3f;UV;Ief9j62W8?]i]Uc6pT=2","SaveState_sfa/loc44/2":"ShareData=AEYAVUvpe&8_nj(Ue+eOWH-abQ,6ukUoafAT3@Wf=FM$u94^|)8[mQ2Uj4/+=2","SaveState_sfa/loc45/1":"ShareData=AY${09c5pCT{*T19sg~c=D?LNRBZ=)UjS{!T^mUsVA~?GUtp6)T,ab69JDk*+^","SaveState_sfa/loc48/1":"ShareData=AS-}V9uXLJ9B}_+Uf06,WEgg6Q54J0UoM:NT9vL2Ve]H{93MCsT~D0~9oC/Z+^","SaveState_sfa/loc48/2":"ShareData=APyBHUHnzk9H1VJUs]gbWNr54Q15jMUZwihULe^wVadNc9unB78|ZlxUEfNi+^","SaveState_sfa/loc50/1":"ShareData=AMDj09aqc+8}d@GUk+m|V(jVd5yz0tUp$WoTz4X8=VXcJ9qi_aTmY{M9IPq_=a","SaveState_sfa/loc50/2":"ShareData=AXms=9NjD]9Nbb+Ufn^1WM$ZS54|RZUjKI2UJDR2=Ab4]972mRT]6,N9U64_+^","SaveState_sfa/loc51/1":"ShareData=AB(@197Dew8)++(UrIQ{V5rl86G;_dUjjUWT0P?z=F9E59rQatT0!Sd9zIQy+^","SaveState_sfa/loc54/1":"ShareData=ANoZ5Uug1GT/KKF9G2U$V8pHwQ6Ij|UdkoqUB19+V2(|UUVD,:9ftW_UWQV!+^","SaveState_sfa/loc54/2":"ShareData=ABip:UaJT^8(fNOT)ZSOVjv:z5?PeMUXj^+T|F39Vq$B}9anhS9C~=OUgzrI+d","SaveState_sfa/loc55/1":"ShareData=ASjF~Uff{3T4xbN9L;[C+0TVR6DJZ(Uqb9cT}4VJVnUv7UKBUT9b$h^UwL|c+5","SaveState_sfa/loc56/1":"ShareData=AR+Uz9jYgF8~6XDUBXrcV7;1Y5|q@{Um7,MUS9L[VY}m}9gf6ST{hd~90~^s+^","SaveState_sfa/loc58/1":"ShareData=AZbb|UhSV1T7XOa9MPZ4WUA7dQ)BPSUV5WdUR2I^WNlYxUQA_c9cDE^UVov*+^","SaveState_sfa/loc59/1":"ShareData=AW}JzUQSj2T}krJ92(ps=u?J359fFEUlWf:UDy7LV{[O5Ut(!d8/Eu^UIO-E+^","SaveState_sfa/loc60/1":"ShareData=AGs0qUJhtIT{UFm9n,X0+&3tz6GfO_UWSuOUH)XNV^;(YUb-*y8-J2VUHU4l=a","SaveState_sfa/loc61/1":"ShareData=AOHKTUE&_yT*OYS9j:dn=S,iX5iNCEUl63?UFfoEWIb&xUV![c8_BVHUSE[2=a","SaveState_sfa/loc62/1":"ShareData=ACrZ1UMpb&UC)zn91cbb=nDU*5+mt,Utw3BUSgsaV@j9)UfJNI8}CbZUK7Qw+^","SaveState_sfa/loc63/1":"ShareData=AC$aHUf|Vx8~GqQUBI=$VuFsGQoJ)qUhW7TT1/&TVaKg~9N)~r8[88BUg{f^=a","SaveState_sfa/loc65/1":"ShareData=AC43ZT^yeLT]7E_9u9]IV?cSX6CJc+UWjhhT+AB-VmX4GUv)ZO8m~7QUS61m=a","SaveState_sfa/loc67/1":"ShareData=AOo5991J@89P,&CUlq0sV9S;R5+bpNUYaoJUOlPo=ZE?t9zbJ(T0Y0j978mD+^","SaveState_sfa/loc68/1":"ShareData=AG:1]UlMcj8=o}RUlQW-=HFxfRBakTUhLLwT-kiM=QQ,q9ym*W9Dc,-UkS2b=a","SaveState_sfa/loc69/1":"ShareData=ANzel94cYFTnXtx8?5RWVwT,lQ*q~YUtC9LUO9(W=F~a|T@82!UGyzI9ow2w=a","SaveState_sfa/loc7/1":"ShareData=AN&W}T{Jj/T:ocM9tj5i=Z/kH6CJc+UmI-JT,JC2=M_P!Urwhl8rKuDURz~Z+^","SaveState_sfa/loc70/1":"ShareData=AKn/s9n]1|8]ee(UmqW2V6EBw586?MUV?s9T1=p{+9YEB9oD~BT-k8G9u$9Q=a","SaveState_sfa/loc71/1":"ShareData=AK&kWUWMdXT&Yy]9SG-W+tcT?5-:p[Ua:3&UN6|K=H]QQUAKA/9ceK}UW2)h+^","SaveState_sfa/loc72/1":"ShareData=AJ&v~UhOqjT$V|[9uz,C+8PR=5:}yxUbyAZUFZEG=LSb&Uk(fj8,T9/UV/kw+^","SaveState_sfa/loc72/2":"ShareData=AE-lz91KtY8:AMsT|_/sVtXK{6Gd$iUX$[@UNXQ-=V&i=9LClaUQ33/914oj=a","SaveState_sfa/loc73/1":"ShareData=AEWO=Ul-j089{jUTZO@zU)AlLRcB/:UrYm,T([J(=YkwJ82i429bz7]UXM^4+^","SaveState_sfa/loc74/1":"ShareData=AQO6K9R5;B9c9&4Ufk*3V&w7rQ![C!UldIBUQBIpV(*~H92SUxT?o-x9O~K$=a","SaveState_sfa/loc8/1":"ShareData=AL&C0T5@RyUCxR=9vgUs+?b]=RTjrRUaMH^UITPI=R94GUj+{T88LvZT-7qo+^","SaveState_sfa/loc8/2":"ShareData=AG0fSUX7So7{E[HTR+G]Vwzz}RTsxSUhh$:UP!,/=SWHr8ecUX9c0asUqt0c+^","SaveState_sfa/loc9/1":"ShareData=AB5CkTWNR$9O:3pUbHykWR3WZQ}gfVUaff=UP0kGV8H?$9vb3{7},tPTXJI[=a","SaveState_sonic_colors/stg110/1":"ShareData=ATa;:9hF{6T8_bQ9sr*;=(&$XQ[cr_Ubsl]UG47dV|^wxUi+a-T=tpd9s5u6Wq","SaveState_sonic_colors/stg120/1":"ShareData=AD3lY9jkwmT2Ep19K0e3WX@tkQ(Ya6UwUx(UI/{;Vd]t!UF&c{UAUhl95P0!+^","SaveState_sonic_colors/stg190/1":"ShareData=AI$!;Up8y!SyB:|T,v+99;=hVQfB$?Usw&y8I]5r+{*7~9D=^jTB4nEUYzd5V[","SaveState_sonic_colors/stg210/1":"ShareData=AQANd9dfUX8@-V:UqMTQWJSh^5?LI-Uklb)T;V=i+~rk1949s@Th@bd9cieL+5","SaveState_sonic_colors/stg220/1":"ShareData=AFM^iUZj0V9enZcUqOq6V*yg(QYKL&UfGCEUTh&~V|+m[9la{]9H3KSUhZ2==2","SaveState_sonic_colors/stg290/1":"ShareData=AXJD0Up}-h82GQ{T0aNoVbG,w6EuiiUf;mqUR9GTWG,eM8:tp&9gY3QUuu7*Vt","SaveState_sonic_colors/stg410/1":"ShareData=AGmG8UoKS29J98gUd6GwWi:BS5]D40UhQB(T{2A;WC2AV9yXXj9VZ~eUvYcOWP","SaveState_sonic_colors/stg420/1":"ShareData=AU{o9Ul0|[T{kMn9r]}v=z;Q)5]kurUbHM=UO(dEWEcY0UdX)s9PBgiUq^KgV[","SaveState_sonic_colors/stg490/1":"ShareData=AULl7UvuNuT?NHh9UKaK+:QH65+![QUu{+,UMb)PVn{6*UR^2V9R/R{UZ7*/+5","SaveState_sonic_colors/stg510/1":"ShareData=AOJMq9pvIV9Iv2[Ug2*UWV3_*QUBgJUdfg|T}Ve{W4jQh9t|p4US7fr9z8qiWP","SaveState_sonic_colors/stg520/1":"ShareData=AYv+wUZQ|oT3u$J9JWV&+$$$z6E{;RUWqW&UJOD1+/U/1UHlx)9ZI)cUda_iWP","SaveState_sonic_colors/stg590/1":"ShareData=AJAtxUsw-(TiN{b9W@MP=MO$16Cj|wUXx;sT!z3RV@L~gUSX228$?&+Ui|:3Vt","SaveState_sonic_colors/stg610/1":"ShareData=AYmb(UUvk]9WQP[Ubz22V^25dQmW-YUql5=UAVPqV[h4:9pd8U8-DK3USaZQV[","SaveState_sonic_colors/stg620/1":"ShareData=AP@-,9SMK[UNYMx95dGV=q+O,Qg2|3Up~=eT*Ty=WAr*NUt@E(T5W[m9Q=jK+^","SaveState_sonic_colors/stg690/1":"ShareData=AB(,bUvujK82ti$UVH5=AM7!tQDE&zUb:y!TYLe8AI_V79t0^38vNokUVH5=AA","SaveState_sonic_colors/stg710/1":"ShareData=AI+$NUf+!CS!BOl85ifQ=ao^+Pgd5eUr(s3TjT_mV8|xUTlL{Y8o1e4UgXH_WP","SaveState_sonic_colors/stg720/1":"ShareData=APCn3UpHS(8B*j7T-J@xU6So,5wo&tUpPI:T]6k3VkK,W8{bZ,8}c?@Ud4vnWP","SaveState_sonic_colors/stg790/1":"ShareData=AY=~yUk9Z_8/{7aUtG/?=;52oQNGkbUbRq2T0P~?V=6Y@92vwV9BIrwUq}FFWq","SaveState_psychonauts/ASCO/1":"ShareData=ALo4|92gwR9SagVUtI}qWCfDJ5rE/fUg|o2T)r]3WIQz=9h!3,Tz_~,9S_~kV[","SaveState_psychonauts/ASGR/1":"ShareData=AFdM^Upy-eTxNEn9Y{y?=Vko,52nZcUprc9TaW|WV6KonUBn9d8oJp:Uu!FDWP","SaveState_psychonauts/ASGR/2":"ShareData=AI1/MUV?cgTH8j@80Q8TWQw:45:lUsUg(t!T}*gOV-)Q5Ta^,79QQ=FUVajpV[","SaveState_psychonauts/ASLB/1":"ShareData=AX5$?UcbA}TXZFs8r+ncVsUGK5^!mBUs5TjT1I}mWQX&eTc~]K8]G[vUq(0yVt","SaveState_psychonauts/ASRU/1":"ShareData=AGSs8Utp+F8_Q+HT{tgtV)L(/QKo$IUYWy*T!:OxV(f5[9cd~{8^PInUb/xLV[","SaveState_psychonauts/ASUP/1":"ShareData=AD1&CT25dC9PKn7Ua6$SWW_$!RL(n3UlwOKUC$mGW3SEI940N287dH=T?3Q^+5","SaveState_psychonauts/BBA2/1":"ShareData=AYPE=95-re8uyba9luAy=HuR15&r~{UbUEp8w,I-=Y_ePUvsTH88@E$9rQ2lWP","SaveState_psychonauts/BBLT/1":"ShareData=AGqBj9jN)&8)QvqUDiEp=tO$jQo^sXUl2WeT]?87=Z*Ec9d*_CT&I=_9uUSmWP","SaveState_psychonauts/BVES/1":"ShareData=ABq1m9i{V}80XT!UY;Q4WO5xc576N8Uh)^3T~$wrWI8$k9qCDaTuJ-L91Lsn+^","SaveState_psychonauts/BVMA/1":"ShareData=AOoipTyak^9dyG{UcwF7WYlEQQkCpEUdB@HT^fbLWF8}S9mn9G8Ykx(TeH*gU!","SaveState_psychonauts/BVRB/1":"ShareData=AI2RvT]XmIT&)},9ol9e=w^;5Q+mc?UscRMT!PODWH)A3Uc;KL8V(8LT$NQJ=a","SaveState_psychonauts/BVWC/1":"ShareData=AY]hRUoZ5Z8OI*eTAfqpU;BJR55KnHUoTj3UD,}zWA8op85cHd9WSy7Ua}k1WP","SaveState_psychonauts/BVWD/1":"ShareData=AYuPOUdtl}8Q4e3TAp@(Vg=$F5Ds-vUaC$0UH!pyV@G_R8y~4N9UpW!UXB[1WP","SaveState_psychonauts/BVWE/1":"ShareData=AY3VPUg1PS8a,RMTQxie+p5:EPmf^TUeHE$T|iw)V@h|U83QCo9J:hJUj[[?WP","SaveState_psychonauts/BVWT/1":"ShareData=AAABrUVOt~5mW9!5{U]{VAtcxQ7;1BUc@EvUTNNTWNQTKQpM[k9fp)xUZAThWP","SaveState_psychonauts/CABH_NIGHT/1":"ShareData=APirkUUGAN8;Os6Uv$[OWvc&@Q/:aTUqOnJT?^A0V{|fe95SS[8_kY6UCeg3Wq","SaveState_psychonauts/CABH/1":"ShareData=AL]0I9ODro9Q/y8UjKmpW;siFQX]U6UwCl$UURr[V|D:o9t|$IT1+|n9eK,9Wq","SaveState_psychonauts/CABU/1":"ShareData=AP&NMUd7b8TY9,K9PP3~=k0_-53{~5Ul,_3Tso76Wdxa@UM}9Q8mi[_UWCdB=2","SaveState_psychonauts/CAGP_NIGHT/1":"ShareData=AXs0zT[vyITq?XI9uc^k=rL_W5*~_UUi,@|ThR@LV)T|NUX^z97@ex(T4/|A+^","SaveState_psychonauts/CAGP/1":"ShareData=ATvU~UMth7UQtgT97;TZWoZw(6E2_SUYlR)UKEkGWHK0xUn]Q28=gDEULIjb=a","SaveState_psychonauts/CAJA/1":"ShareData=AAmX?94IO|Tz,R_9Ib+bV;xLX6BepoUruumUFT~0V&qLoUFh9kUTvx092GzA=a","SaveState_psychonauts/CAKC_NIGHT/1":"ShareData=AaNn(UDtEy9XdQ7UZxdU=q-97Q-NS&Ufng|UQyL3Wk3IK9zjLd87FzOUATxI=2","SaveState_psychonauts/CAKC/1":"ShareData=ADjp[91;LRTp_,L9W,W]=q|4h576N8UifX7T2uA-Wo|CjUCu51T2=lF9oIo9=2","SaveState_psychonauts/CALI_NIGHT/1":"ShareData=AOR}y9w*h{8[UXCUiG)DWf9ar5)w/EUh&KZT~n8VVy{BR9yS26T]t)x97soa=a","SaveState_psychonauts/CALI/1":"ShareData=AFAo?8:CaxT~uV:9xExCWPg7^57!+tUV@5cT$]!6V~U_QUf~E}S}^ww9EQHr=a","SaveState_psychonauts/CAMA_NIGHT/1":"ShareData=AIYRJ9gWNI9Jf5gUuN!:WE,q[QrvDoUh^qJUC6{xWe$i/94YsOT=kqA9HlgqWP","SaveState_psychonauts/CAMA/1":"ShareData=AJ0e;Unh_nT:oY795U)Z=*+g(5(C:vUg0MnT~HW0V&aFEUYIJK8x(!EUv4*]Wq","SaveState_psychonauts/CARE_NIGHT/1":"ShareData=AA9:$9uqsl9C*rnUp_[(=;I$B5,6=lUfku9UIV;$V:$749ztY}T5Uml9p1R~WP","SaveState_psychonauts/CARE/1":"ShareData=AMnG795m4;9Cu^xUpZ2_=7h4dQ::67Ul@IuT?kP+WHaO59jK,1Tc^t*9r^:*+^","SaveState_psychonauts/CASA/1":"ShareData=AK/0?91MX:T,X6/9f5G1+(UnX5=z6gUfOsiT|AQuV)8F9UDPBDUHH699vc+,+^","SaveState_psychonauts/LLLL/1":"ShareData=AHtae9K*Pn8([7qUh7KSWnx-v5)P|NUe)q,T4hDWV^:J@96,yBTY;ji9LYpU+^","SaveState_psychonauts/LOCB/1":"ShareData=AERRE9biRyT38ne91a4h=M+?{Q(b{{Us/KfT:3h5V&u/yUh@ohTpaD;9Ks4}+^","SaveState_psychonauts/LOMA/1":"ShareData=AabAcUo]?JT[5vf97eQ[=qPc355^W&Uq)XQUL|@lWMf=UUlEgZ8!!Z~UpRD9V[","SaveState_psychonauts/LOMA/2":"ShareData=AbP/zUCp*ZT&HTh9q4JkWY?OM51|]&UuF[YT-(BzWXHHIUo7;=8z!iXUOdB^+^","SaveState_psychonauts/MCBB/1":"ShareData=ADB^:9jDS*T{@E?9v*0(=s!,[Q+s[~UkXWhUP_1!XE^5FUo]iHUGQJt9u@m,=a","SaveState_psychonauts/MCBB/2":"ShareData=AH5{FUp^lI9gN6+UX79nWn}1|5kiGQUp7JXUnf+WWSF}X9l/c?9JQF?UV:uXWP","SaveState_psychonauts/MCBB/3":"ShareData=AAX,99gRJm9V[ypUcYw5W2e_l5^_1uUp5}IUB*MpWX4Z19q6Q]T;gGD9b~i1W~","SaveState_psychonauts/MCTC/1":"ShareData=AL({NUvaTW8O;N-T]fv$WA-z!6CamiUgCF9T91AgWn9q*8=i9q8/WS^UZ59eWq","SaveState_psychonauts/MIFL/1":"ShareData=AC|{8UW?qf8zf,CUNzgT=zjqW5$KTxUrasCT41Gb+q?qF9L~cB8)Wa)Uur}!=2","SaveState_psychonauts/MILL/1":"ShareData=Aaiae9s6i-9ClmDT*@j~W8lkB6H6{aUsWx6T0BMY=pL=F9S:,uT-|o89jD95=2","SaveState_psychonauts/MIMM/1":"ShareData=APhb;95]ra9A,@NUUgcW-MTx66JwoOUW+)^UHzOFXll[39fD{aUA2K_91zbw={","SaveState_psychonauts/MMDM/1":"ShareData=AIK]x8(vzp9a2S8UiM/TWi5H55i@=zUbtohUNz~/V}&v*9j|1xTWylh8*iE&+d","SaveState_psychonauts/MMI1/1":"ShareData=ARFP}9x;k^8_7]1UcKaOWz4;(5~;(oUdbipUEp|ZWQs-v9yr1yT/1-n9j2TX={","SaveState_psychonauts/NIBA/1":"ShareData=AH2eSTo?x?T|nds97j6+=gdSYQjz*UUhkPmUGGSNWIOmlUYe&~8bg^FTq3r8Vt","SaveState_psychonauts/NIMP/1":"ShareData=AG~Ai92rC$8-}oN9jA)=WX^W85$Hz7Uk{dG8]YavV*OT|Uc,5R8&MvB9i6I!=2","SaveState_psychonauts/SACU/1":"ShareData=AV3H*Up6*h9IC(WUqQV?WR74y5hB[|UV2i2UJl}LWIVLd9vA8M9b?J@Ufwf[WP","SaveState_psychonauts/STMU/1":"ShareData=AGC?eT@Dd&9ertDUYSI,WKJ/)5)O|,UcO:iUIzqgV1;Cb90i4J8vaL+T4-8&Vt","SaveState_psychonauts/THCW/1":"ShareData=AUYGFUS:&,9aL+ZUX(bOWdw6A5}X(iUkG78UMu(/Wp)|V9hPE{8[XQ?UBMer+^","SaveState_psychonauts/THFB/1":"ShareData=AGVk+93j)!T,J$,9OU(P=T0cyQ?VbNUn41dUN&*MV$g7mUIxd!UEjzo9u5)9+^","SaveState_psychonauts/THMS/1":"ShareData=ALT^o9oTl@T(2Vy9Yq),=B[e(5(Y}&UZ:=iT7y-FWGuT6UEuYpT&@H79zR}d=a","SaveState_psychonauts/WWMA/1":"ShareData=ACbk3Uowa]UEN_&9qvs$Wki9dQ]=CfUfXI;UJU@7=?V}nUaD](9IEW8Ur-OPWq","SaveState_mph/bigeye_c1_model/1":"ShareData=AS-_AUimv^7)qCpT~^XxU3DTU3__s2UlwiET@]=YU|:9;8?RMX8~[VhUniS!VS","SaveState_mph/bigeyeroom_model/1":"ShareData=AU?n1Ur_Q88zv2qUGIlTVYB[R5V@PvUXQ!/T]g4|VsmH59XOG;9EGz|UWy5-Vt","SaveState_mph/crystalroom_model/1":"ShareData=AASZmUhAUgT[!(u9fDhi+ykmsQ3Qg}Ufbo8UAdxcVd/K(UO|ml9OHdfUe_xkVt","SaveState_mph/ctf1_model/1":"ShareData=ASA/;Umom48!NQbUlh:B+,U]qQ4?OgUsbonT}gS{Vvp8n9x(jp9BMfaUVur2Vt","SaveState_mph/Cylinder_C1_model/1":"ShareData=AOL{v90?dZTNF?y9JTn&9?V?d57m[ZUc)5AT(8C*VIO=YUTmNQT[~xQ9s{+4+d","SaveState_mph/cylinderroom_model/1":"ShareData=AAqUY90L(zT;=^!9r)ij+,Jn{Quek1Ucb9ET}EGfVh*ZfUbqKiT6s$491u=g+d","SaveState_mph/e3Level_Model/1":"ShareData=AD=f:Ur}_JT&^d-9hU}QVh0]iP$kjfUq/RPUCOf?VZ78]UnfVO8!:r9UhkURVt","SaveState_mph/Gorea_b1_Model/1":"ShareData=ADoMGT!&3I9LUmOUpi|]WEh/wQ5NgjUskuoUR3^qVZ*wV9jGiB8tL,uT;D:*VS","SaveState_mph/gorea_b2_Model/1":"ShareData=ADpfp9443oT/lpx9RhxW+-l1[QuBW$Uj}4*T)2kAWFx}HUboE2UH-go93T|h+^","SaveState_mph/Gorea_c1_Model/1":"ShareData=AX:-JUnc^67y!5&TAqb?Um,u5P/3VZUgk}ST!!peVkHyB8RIRe8,@/wUXvhvVS","SaveState_mph/Gorea_Land_Model/1":"ShareData=APvnyUmB0=8Z~53T=C7jU9(~f5_8K5Ua2JrUH?tUV,fN$8}5wN9dq2vUlu|t+^","SaveState_mph/mp_fh_data/levels/models/blueRoom_Model/1":"ShareData=ABI:1Uckk,9A)-5Ui8rkWYW,$QzDW8UZ&tYT^*9ZV1:yk97(_e8]RS|UYss5+5","SaveState_mph/mp_fh_data/levels/models/e3Level_Model/1":"ShareData=ARtfL9tE]?9Ail~UjpLFVu)]bQ}1UUUhQ04T?0yzVb*kF9km{xT17ji9k3xk+d","SaveState_mph/mp_fh_data/levels/models/mp1_Model/1":"ShareData=AP$ZR9rlZ[8*CV:UuL?bVufgrQ7V81UZ|7BUT=B_V-c[}9x8s9T4Yv+90@+c+5","SaveState_mph/mp_fh_data/levels/models/mp2_Model/1":"ShareData=AIyd?UsDa&8!~3XUFeb&V5nabQGVG0UrM|mUPax9WE]cs9gSe28!XTXUY{]tV[","SaveState_mph/mp_fh_data/levels/models/mp3_Model/1":"ShareData=ANw7v9zOL7TmVyI9A$m^+lGgv59sXrUl_gFUD1]WVb{GXT7JHcUCu0!9lgB~+5","SaveState_mph/mp_fh_data/levels/models/mp5_Model/1":"ShareData=AWXnFUvWoWT0kJ,9P_IV+{nJ?QnYnAUWJTIUTMR^Vu7NAUBv3J9gJ&NUmT8OV[","SaveState_mph/mp_fh_data/levels/models/testLevel_Model/1":"ShareData=AEIOZ9z6;*9Rq@}UtE_8V!iT)5~n]_UnQhOUHo3mV2W;x92y,IUFR,N97u+H+^","SaveState_mph/mp1_Model/1":"ShareData=ANE]4UcEjeT0w2I9S[HV+;TId4|fAIUj0VpT_cb9VnishUJx+t8&TcUUlmJGVt","SaveState_mph/mp10_model/1":"ShareData=AJy^59ew5g8[ThfUhe})V,vvEQ1{:VUds)ET~cO=VwvwY9jy{7TZ@+89H*@b+d","SaveState_mph/mp11_model/1":"ShareData=AEJvu9gp;-8$W1fUicVIV?CEIQ!~vHUWsIiT(0FeVT2-V9wQr|TlP?v9HTvW+d","SaveState_mph/mp12_model/1":"ShareData=AS(WYUl9gD9A8h7UEY{KVfKqoQgM=2UZUQ)T|A/4Vu]0b9QOX~9YE83UX!y=Vt","SaveState_mph/mp13_model/1":"ShareData=AMxzZUWs(GT!,!o9k{,^+v-,6Q7DwzUbNoMT)?Fg+rkH{Uq@-s8_n1bUc{vbVS","SaveState_mph/mp14_model/1":"ShareData=AU!MJUX=9/T?6ob9vdI!+{xI855!Q$UrVpTT)P$+V~W@(Uih!v9A;~BUs2ouVt","SaveState_mph/mp2_model/1":"ShareData=ACdz1UmhA^8zqi]UAOneV;PR3Qv(:)UZ7NeT!tW3V;a/g9WnM(8[X^!UgM8gV[","SaveState_mph/mp3_Model/1":"ShareData=ARw[b94lEcTh[U}9S7Uq+U@g|Q}/s|Ubg6&T1^v!VM}XoT{xKbT,1ZZ9xcBx+5","SaveState_mph/mp4_model/1":"ShareData=AW=O8907WkT9QtB9xcA&+:v:A5x|A6UjtO{UK2{(V:@AaUn)r_T^10!9kjgC+d","SaveState_mph/mp5_Model/1":"ShareData=AL7jYUp(YpT6--C9ntw_+^H1*Q{LVGUdL)ST-;GzVWQm/UoJ^+8o64DUes-kVS","SaveState_mph/mp6_model/1":"ShareData=AM5&EUiuR2T2~$x9M$lC+(*mrQC]KBUk&aKT?Th_V_!-[UBA{29BTwcUW4V8Vt","SaveState_mph/mp7_model/1":"ShareData=AW^cXUj_h[88d[rULmywVqi2PQ5_P1UoM:NT2n|fVu:$)9HX{f8[VN}Up/HHVt","SaveState_mph/mp8_model/1":"ShareData=AKrD1Uj$EjTz5J)93i=&+g7w06LZN|UgRi1T1SDAV;aAUUX3~D8&dRpUcJhGVS","SaveState_mph/mp9_model/1":"ShareData=AKlO@9xkX=Ti;(M9RW;g+3+go5z,h4UatJ:T&kxVV;ueGT|ft)T5Fuk97bT[+5","SaveState_mph/TeleportRoom_model/1":"ShareData=AA{:w9mj,BT;}Mm9g_GE+qN|$5k6v7Uj;*jUBkpwVqL4LT^n00URiWE9mTqCVt","SaveState_mph/unit1_b2_model/1":"ShareData=ARh$mUwdA@8?HFMUQYDdV;pkPQhL]wUq97iUG:H0V4hpq9PfPO9dOZEUqg42Vt","SaveState_mph/unit1_c0_model/1":"ShareData=AA?-qUmKBJT?iCU901$X+[i@P5P5u7UhUPQT=9B;VTS8lUjRpC8!H*uUqF|8VS","SaveState_mph/unit1_c1_model/1":"ShareData=AC5L8Uo?LnT9,xm9U;vf+n{YtQ=r:?UeGn/UPOlkV3leZUC_tF9Q4hAUXTh8Vt","SaveState_mph/unit1_c2_model/1":"ShareData=AI_Z!9xg(+TrZy$9No=J+:boj5qwf4UiQ~ZT@yo0Vbu1QUQ;VZT]h)r9lLoZ+d","SaveState_mph/unit1_c3_model/1":"ShareData=AHJs09Y[5zUJIu59v*&4+&9p-5/-hJUnO3-UHqr5V/=ksUk_poT2xt]9cBGX+C","SaveState_mph/unit1_c4_model/1":"ShareData=ABb0+Tgk]f8@dYUUu@gVVu[q-QxnZWUuDeYT5bK@+(?_H9sl8J8EzL-TZIpLUV","SaveState_mph/unit1_c5_model/1":"ShareData=AFO$TT6:xJUIJM;9j,Js+loK15,$!nUgYJ~UM9L4VawV=Undn[8R8-4T~N05VS","SaveState_mph/unit1_cx_model/1":"ShareData=AVM$ZUU[RL9c}knUYJN/Vsw)@5mzN6UZ,ujUD&u|Va4cd91hcp8_6d7UE!z@U!","SaveState_mph/unit1_cz_model/1":"ShareData=AZi7xUYeB/8rz8XT5^&DVMFaLP;?6YUq3~_T)[efVd@ax8;ve_9emzjUWv;|VS","SaveState_mph/unit1_land_model/1":"ShareData=AY8(9T{rA[T=GQ*9wM[K+,5^g5~qIxUk}N!UA52yVifu,Uc&$g9E?~dUC&p~VS","SaveState_mph/unit1_morph_cx_model/1":"ShareData=AY!/OTT6[8T7=&k9vg*[+1jwT5gw1sUV_zbT8sp5VLSmrUjlDY7t}39TI$,,8j","SaveState_mph/unit1_morph_cz_model/1":"ShareData=AW0)}UWVWoSfPM$8XpFHT^:WMPMX?}Uokz8T[YwZVA/FAS|3x+9Eh}LUsPjrVS","SaveState_mph/unit1_rm1_cx_model/1":"ShareData=AF~oiT8]*bT=qIG9vyaj+eJOH5oaM[Uj-!5T_VGYVa]LAUf!)Y8WXllT;3)-UV","SaveState_mph/unit1_RM1_model/1":"ShareData=AW~6k92uz59C-[WUdiIsV3itD5;|E}Uk:mLT_m86Vi*cr94&S]T;cFl9oVcB+5","SaveState_mph/unit1_rm2_model/1":"ShareData=AaM169Hk/4UMnRu9pQ/2=W{-q5wTieUduJ_UJ7v!V+hAxUaGqRT,PzM9Z,3l+d","SaveState_mph/unit1_rm3_model/1":"ShareData=AV_0BUmCcET[zVa9v@3DVw95qQ5VVCUlqr*UOoQBV;q/pUl@h09E:HOUkJ7KVS","SaveState_mph/unit1_rm6_model/1":"ShareData=AY5oZUg1o1T$uiU9l&e2V[am453lX]Ul=MDUB4oDVzBn0UpD6+9FM|+Ujc2rVS","SaveState_mph/unit2_b2_model/1":"ShareData=AAh|lUvZHzT+/!(9x^^=+5VZv5fnaSUa_2,T?*QYVT@;rUd&M*8:fdCUmV~UVS","SaveState_mph/unit2_c0_model/1":"ShareData=ALp6GUAD-y8~ro6Um7s{V,Hi=Q3wp2Ua^cXT?$zpVgg5,9tiIH8?uDjUDY6~VS","SaveState_mph/unit2_c1_model/1":"ShareData=AJ5G;9eh:{T+PW!9ju5rVr_V-Q^{+LUh@zWT]Co^VnPc4Ukx+JTxw{y9G/E0U!","SaveState_mph/unit2_c2_model/1":"ShareData=AXZTj95[*o8-uDcUZ),zVjVONQV3shUrzwoUMjV$VyKbX942j]T=?PM96u1d+d","SaveState_mph/unit2_c3_model/1":"ShareData=AO7zc9jktH9O,KPUpvZ_VSj/nQ]ypJUq[=TT)RS6V0rSN9u&0?UP|m]9qbuK+d","SaveState_mph/unit2_c4_model/1":"ShareData=AaUs+UwRJeT~_xx9L4u/+9=L?Q3Mg4Ua?8OT/Tc(Vv|}3UFC*j8;rQNUjHL;Vt","SaveState_mph/unit2_c6_model/1":"ShareData=AC$}|9iDz,8,KP;UeH1lVmuE:QW*z{Ukv3GT]b9aVe~NX940{,T2{q19r(kp+5","SaveState_mph/unit2_c7_model/1":"ShareData=AIOv0Uoc@iT-de89jvb-+[Bn;QV(?JUanaCT^rYzVZ[rUUfrPF9OvpbUZzIiU!","SaveState_mph/unit2_cx_model/1":"ShareData=Aa68oTkds;T0;,p9nHgK+gYv45iFNtUgCF9T7MU&Ve2V1UXnE;7~mg&TY(|]Uw","SaveState_mph/unit2_cz_model/1":"ShareData=ADj7*9x&TG9C!+aUI5$~U},+T5nx,mUe$Q4UFwrNVh1x]9dzLDUCW7!9zL*p+d","SaveState_mph/unit2_Land_model/1":"ShareData=AaxEZUeY3T9Eqf*URpRHVn:{*QVmH0UYZM^T4U3iVrM4-9N6XT8}[kEUg[rFVS","SaveState_mph/unit2_RM3_model/1":"ShareData=AZ)gdUhsOf8q0:6UHlSWVp@OJQ4*UhUs26qUIFx@VeWA89a[|o8@xi~UoZ8eVt","SaveState_mph/unit2_rm4_model/1":"ShareData=AQStnUF_c6T*OYS92|wp+6AI35iWIFUl63?UB6/qV_fgqUX~Ku8=jP&T}n=OVS","SaveState_mph/unit2_rm8_model/1":"ShareData=AY{~]9vO,T8nnZHT^b]6V=46ZQdJ&EUmv^@T$WquVmxbI9O23zT0tJq9lZti+5","SaveState_mph/unit3_b1_model/1":"ShareData=AC}cpT*8E_9Tv!)Usm;KV{u,g5adK6Ud3e]UU-W;WO97d9yjeL8(h)]UO37GVt","SaveState_mph/unit3_b2_model/1":"ShareData=ARqZbUWbSG8OHTxTtTC8U=1gj54*EXUam+=UCRLaWN?Kj8wVf&9J]&oUthjiVt","SaveState_mph/unit3_c0_model/1":"ShareData=AEf91UjA_h8/k!bUbVCSVx@A&Q09mWUgq-EUJP{wVd~o)97S|@8[qf?UanD[VS","SaveState_mph/unit3_c1_model/1":"ShareData=APN-2UtN3PT2BFm9ryt(+uyOL6Lp^vUk]H@UGsE2VRC0zUf!K88;3l;UW(ygVS","SaveState_mph/unit3_c2_model/1":"ShareData=AZPSJUas_*S!D8rTm[,?V,8zY6IgI1Ubb+B8}mvoV/kP{8rDKlT?!5BUh2TdVt","SaveState_mph/unit3_cx_model/1":"ShareData=ARSZ$8v/;TT(IoW95DqO+0$f;5=0~/UkF=MT!KBLVafbKUkfSWS_~rV8nh~198","SaveState_mph/unit3_cz_model/1":"ShareData=AT+{1Uk0cFS8Sbs8uo$H9szH4PxGQdUl2b!T?X!sVa,a4Ts?4X8;wHMUcV^7VS","SaveState_mph/unit3_land_model/1":"ShareData=AF(6t92Ozm9AT}VUCA]oVxccZQko5;Ud1vEUM$BPVyfzU9Yk?SUH+oG95o4t+5","SaveState_mph/unit3_morph_cz_model/1":"ShareData=AT1!0Ul:JQS9F!08=BbqUG/8448^/]Uk^$~T6EN=U^!p7Ts1sV8;d*KUi+)uVS","SaveState_mph/unit3_rm1_model/1":"ShareData=AC@MnUjmk|8wyNeUNSXGVeL-qQd=)|UmrfZT$o;)V0|HI9NRqA8]so{Uh,d@VS","SaveState_mph/unit3_rm2_model/1":"ShareData=AXMTh93C@)T5{m?9WK6l+g2]!6Lx/NUr&Y@UC|&3+ez_;UM87YT~wIJ93Sy;+d","SaveState_mph/unit4_b1_model/1":"ShareData=AF9AI9RszH8=36qUn}:}VxkVl5,{{OUa*,PT5DJ=Vta:;94&-YTwmb99I[F9+d","SaveState_mph/unit4_b2_model/1":"ShareData=AQ+4vUXz74T6~?b9Js*!+:{x{5BEe(Uk4G/Tz(ZPV~[rsT{(WB9D(2kUXI?rVt","SaveState_mph/unit4_c0_model/1":"ShareData=ALR5PUIjDLUA0F&9y~7:U_hdN5PpPUUrr^LUT5;DVjT[}UVL4&8$pX^UH4qMVS","SaveState_mph/unit4_c1_model/1":"ShareData=AQ)Va9h]6k88Jb)T}1bYVxawz5gSKiUY?yWT2]8)Vm+jv9Ty_NT8JCg9h{PZ+5","SaveState_mph/unit4_cx_model/1":"ShareData=ADbV&TaRqjT(={69nltk+jyL]PzKjQUk8/{T,T]~VD=k4UZVbI7zgC;TzQ8wUw","SaveState_mph/unit4_cz_model/1":"ShareData=AUOU5Ul_GR7xtnDTacAz82g:;PyOUUUY:5RTZww6Va!g58+g[L8q4UFUtE,?VS","SaveState_mph/unit4_land_model/1":"ShareData=AYnfgUoVg@T}f[o9tDeA+]z^uQ83/)UX&r@UGkdXV@)WmUkpoe9L:O}UVMmOVt","SaveState_mph/unit4_rm1_model/1":"ShareData=AR?p^9r3^681=$/UU=}HV3oBlQ}4~jUe;,QT(aVOWBqE/9L,7RT76gw9k~P!+^","SaveState_mph/unit4_rm2_model/1":"ShareData=AY?HR8snMh9Mh|$Ueis}V)F-55[(AOUq97iUPjx]VYB9[9zRsrS[h~N8v!l;VS","SaveState_mph/unit4_rm5_model/1":"ShareData=AS+M/8]pWS8(CZN9wj5B+*Q@AQm2A7UXNB68{XgvViEB/Ul7*O8MNw&8&0,|+C","SaveState_katamari_damacy/clvl1/1":"ShareData=ACP29UgHl:9gRb$T**GAV{jn^Q]f4xUt8n-UgLPe+td!f90:?j9Nq&XUa&];VSW","SaveState_katamari_damacy/clvl1/2":"ShareData=AJx/|UAma{T)tGc9rLgQV^Lo/REe/ZUd,p|T*:_T+EDJvUfOJG8=t(RT*&II+5h","SaveState_katamari_damacy/clvl2/1":"ShareData=AXOtx9V_dUT1ySlUi!c_Vz7A4Ra@DyUqPLg8|LQmVoO*79kBSz8v?UY9gNwd+d}","SaveState_katamari_damacy/clvl3/1":"ShareData=AFlsF9q9R-TCZ/68m1*yW8i_x6FH,vUm43sT}q&IWqTRfTa_e~T}W:x9x4z1=a(","SaveState_katamari_damacy/clvl4/1":"ShareData=AJ9[;UV@uUUQ$+l9mY4PW7[KbQ(5-;UZ)RIUI5~{V{D,4Uv5198?u1FUWBvrWPA","SaveState_katamari_damacy/clvl5/1":"ShareData=AXq+WUsa6r8}H,yUXITr=ovrsQ:_F:UXnlWUSfV4WO?zp9u*)=9XJ_-Uj{TO=bD","SaveState_katamari_damacy/clvl6/1":"ShareData=AJSCS9vnU|TY;;+UrMp0W6k&=6ED~dUpNv68reQ:WK@:g9qqaL8y8m|93?lz+^z","SaveState_katamari_damacy/clvl7/1":"ShareData=ACeI/97B0t8@Va8UDqPOWOF2HQsmY=UnX)WUDADEVVp)79J?GHUQ0[*9qT3W+5h","SaveState_katamari_damacy/clvl8/1":"ShareData=AOJP5USYrX9W7dpUv*xOWj9&yQ,-hcUmQ*VUDoh^V8LnF9hMZ,8vRcUT^;6m=bD","SaveState_katamari_damacy/clvl9/1":"ShareData=Aa,sf9it?kTOU+08ru!nW~h=;RA8$eUlpV|UU6{eWAC4eTm~79T)w3+93T3pWPJ","SaveState_katamari_damacy/lvl1/1":"ShareData=AC+jY9lQGFUOu(C9f|~!+q95C6CEN(Ud&FJUS0-6U{0*EUR[42UGM6H9i=WM+5P","SaveState_katamari_damacy/lvl10/1":"ShareData=ATiW;UOAQsUMKA+9n90dW:2|x6WKprUmSQBT*,khV[gerUYws;8;5&FT{V&nWPA","SaveState_katamari_damacy/lvl10/2":"ShareData=AD=}r9n^@1T6*f~UfI[a=GZLLQ@[a_Uc]GJ9V*M8+}L!U9p(2{9D/|Y94j&RWPA","SaveState_katamari_damacy/lvl10/3":"ShareData=AVUbe8{7qo8&V~i9up5/Wcf0]Q}UtfUX4Di8:8t3+x9pRUf++[86V[28@VIeWPA","SaveState_katamari_damacy/lvl10/4":"ShareData=AGTJ,UX7v8T}AA[9oc7GW:3H$Q!i)vUo}2pUIsJqV7RfgUgaNy8|U]CUwGYxWPA","SaveState_katamari_damacy/lvl2/1":"ShareData=AD}Jt9x-_?T)paZ9mEBK+u=CUQ&?)AUnH)wUBr,;Vrkp_UW[$tUEXTp9lBoE+d]","SaveState_katamari_damacy/lvl3/1":"ShareData=AAnUB9jTtwT2Iwy9ix1SWrgmLQ3goXUWa6ZUIa?IWLN&0Uj^$HT}nN,9uVY@+^q","SaveState_katamari_damacy/lvl4/1":"ShareData=AO/0|97MC4UN~VJ93GE}+~ft)QsU5[UfFy*UBFWGViA]IUm-I$UEqP-9m_8z+d]","SaveState_katamari_damacy/lvl5/1":"ShareData=AEL(+Udb:ST|+xK9kam)Wr/xc5z18hUiEkvUTn9/WBTsgUY8pk9f4X$UY6jZ+^q","SaveState_katamari_damacy/lvl6/1":"ShareData=AO4pf9L@bzUDaPa9i+DWWy2^EQ^NXhUs26qT*m@UV!0C@UlR44TpI/L9U)6?WPA","SaveState_katamari_damacy/lvl7/1":"ShareData=AAdp~UtHIWT]C@$9l&m)WP4Gt5_{&!Uq6N@UBcO9+u5@|UXF_$9b2YpUau^bWPA","SaveState_katamari_damacy/lvl8/1":"ShareData=AA1H)T|RDNUQaqC9p?xIW6Qz&6OxcjUY@M|UJOiUWLM3kUcCE_8;hx$UTR6t+^q","SaveState_katamari_damacy/lvl9/1":"ShareData=AO=eYUsCYk9bN/EUZS$[W;8ANQ&P_2UZ9FGULt3-WD,1O9yG,W8-a9_UZa7~WPA","SaveState_katamari_damacy/lvl9/2":"ShareData=ARxR0Ug&;x8j/agT5MqRWrp9?Q(A=(Ut^$qT7dDCV*Qbg9D&Zx8&5[hUqacfWPA","SaveState_katamari_damacy/snow/1":"ShareData=AR~QTUZdJ/85YugT/?E-V7;@sQ8~6_UpzzcT*EsWVVvZ?9PPIe9SaU1Ut[gfVtf","SaveState_dksiv/dks1/1":"ShareData=AZV}y9iY?pT4XSV9s:-8WKil(5?GYLUbEiLUM+vs=XOz:UWVR&T@;]29o-,;+^","SaveState_dksiv/dks2/1":"ShareData=AYj5a9mQPqT~$9l92P}*=F0&RQ,tlHUc@5ET;s9jV0js?UX~e[Tm/qx9x*LM+5","SaveState_dkcr/MWLD_frontend/1":"ShareData=AS]B2Uv$jB8O@4EUOMc:Vr41m5pl_)UitZ0TZf58U${/R9PuBq8uf05Ucd4DVEg","SaveState_dkcr/MWLD_Map/1":"ShareData=AAi4JUsYTm8~=p0UkpP(V0!t7Q3pobUj]{6T_/d~VpBHw9p~R28,h/GUp@)cV7C","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Blast.pak/1":"ShareData=AAABrUVH5=AAAAAAU5OyVSD^,AAABrUVH5=AHtBTUwi,-AAAAAAAABrUs|g_VEg","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Challenge.pak/1":"ShareData=AAABrUVH5=AAAAAAMf$/U!9!_AAABrUVH5=AHsvmU!9!_AAAAAAAABrUfPANVEg","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Collapse.pak/1":"ShareData=AAABrUVH5=AAAAAAO=CnU!9!_AAABrUVH5=AAn0NU!9!_AAAAAAAABrUgL5dVEg","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Equalizer.pak/1":"ShareData=AAABrUVH5=AAAAAASz]TU!9!_AAABrUVH5=AHQ{IUwi,-AAAAAAAABrUf_C{VEg","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Ride.pak/1":"ShareData=AAABrUVH5=AAAAAAC9@+Uwi,-AAABrUVH5=AS0]EUwi,-AAAAAAAABrUmYuaVEg","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Shift.pak/1":"ShareData=AAABrUVH5=AAAAAAO+q8U!9!_AAABrUVH5=AXL|=Uwi,-AAAAAAAABrUa2mpVEg","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Spikes.pak/1":"ShareData=AAABrUVH5=AAAAAAIltRU!9!_AAABrUVH5=AG/&SUwi,-AAAAAAAABrUXP$KVEg","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Temple.pak/1":"ShareData=AAABrUVH5=AAAAAAG-lh+CunXAAABrUVH5=AZ;K?UVH5=AAAAAAAABrUiX|+Vf8","SaveState_dkcr/Worlds/W00_Trophy/L0X_Trophy_Vertical.pak/1":"ShareData=AAABrUVH5=AAAAAAXljD+CunXAAABrUVH5=AU0L!U!9!_AAAAAAAABrUjCZLVf8","SaveState_dkcr/Worlds/W01_Jungle/L01_Jungle_Intro.pak/1":"ShareData=AMxNpUW^ux8UrroT_8M:U(Re-5WQ!-Uk=RET4rLDVL-VW8,2k[8^|ahUdgJjVEg","SaveState_dkcr/Worlds/W01_Jungle/L02_Jungle_Cling.pak/1":"ShareData=AVvT[UeAMN74tblTM?1FVOAM,55I/!Ubf&JT6]{mVCSBO8V[0b8~2JfUXACUVEg","SaveState_dkcr/Worlds/W01_Jungle/L03_Jungle_Rambi.pak/1":"ShareData=AW)i-Us8G58b?l-Tq/3$VZpkf43e[~Uf6oLT?$^/U:9ZX8u3Qj8;:bsUvKMkVEg","SaveState_dkcr/Worlds/W01_Jungle/L04_Jungle_Silhouette.pak/1":"ShareData=AAbTuUXGny4&N1U6J9UUVIRUe5tG^0Uv,;:4$aT{U3*/c5s/$PQ9J!PUoJ[[Vf8","SaveState_dkcr/Worlds/W01_Jungle/L05_Jungle_Barrelcannons.pak/1":"ShareData=AL9yhUfWY6S;M,G9D2vLU*6)XP}8O0Udf3;T5v_@VMh5cT!jIW8;n3dUpvIXVEg","SaveState_dkcr/Worlds/W01_Jungle/L06_Jungle_MCTutorial.pak/1":"ShareData=Aa!;mUW/hR5b(3*5-sQ6VTsSHQU8-)UXChFT;|MOVR=|[5UvMr8&rMrUdF[fVEg","SaveState_dkcr/Worlds/W01_Jungle/L07_Jungle_Boss_Mugly.pak/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAX:-JUgZ=TTQYVpUwi,-ALSFp8gkxaUkG^+VEg","SaveState_dkcr/Worlds/W02_Beach/L01_Beach_Intro_v2.pak/1":"ShareData=AYt:DUqr7?SEklwTuUKF+y(k)OIra0UgZ=T8WiMgU3S_&83E|pTR92cUq-hcVf8","SaveState_dkcr/Worlds/W02_Beach/L02_Beach_SandCastles_V2.pak/1":"ShareData=AAABrUVH5=AAAAAAV?FPU!9!_AAABrUVH5=AG[hCUwi,-AAAAAAAABrUnVG5VEg","SaveState_dkcr/Worlds/W02_Beach/L03_Beach_RocketBarrelIntro.pak/1":"ShareData=AAABrUVH5=AAAAAACh,]+d]wYAAABrUVH5=AAAAAAAAAAAAAAAAAABrUXQ,&VEg","SaveState_dkcr/Worlds/W02_Beach/L04_Beach_CannonballAttack.pak/1":"ShareData=AAABrUVH5=AAAAAAZ9kDVSD^,AAABrUVH5=AI=n&U!9!_AAAAAAAABrUWy;PVEg","SaveState_dkcr/Worlds/W02_Beach/L05_Beach_Squid.pak/1":"ShareData=AAABrUVH5=AAAAAAVU(8+d]wYAAABrUVH5=AOGgZ98TeWAAAAAAAABrUldsmVf8","SaveState_dkcr/Worlds/W02_Beach/L06_Beach_Blubbo.pak/1":"ShareData=AAABrUVH5=AAAAAAHy(UUwi,-AAABrUVH5=AAAAAAAAAAAAAAAAAABrUfB9BVf8","SaveState_dkcr/Worlds/W02_Beach/L07_Beach_Tidalwave.pak/1":"ShareData=AAABrUVH5=AAAAAAKZJ1VSD^,AAABrUVH5=ABub6U!9!_AAAAAAAABrUvzJ$VEg","SaveState_dkcr/Worlds/W02_Beach/L08_Crab_Boss_Arena.pak/1":"ShareData=AAABrUVH5=AAAAAACZZZ9g&VVAAABrUVH5=ASN|KU!9!_AAAAAAAABrUdzSnVf8","SaveState_dkcr/Worlds/W03_Ruins/L01_Ruins_Introduction_v2.pak/1":"ShareData=AAABrUVH5=AAAAAAEbGyU!9!_ANBz(Uepvt8as6RUwi,-AJh@:TJ/]0Us=GtVEg","SaveState_dkcr/Worlds/W03_Ruins/L02_Ruins_BarrelButtons.pak/1":"ShareData=AAABrUVH5=AAAAAAKu/hU!9!_AAABrUVH5=AK*B1Uwi,-AAAAAAAABrUq|6]VEg","SaveState_dkcr/Worlds/W03_Ruins/L03_Ruins_ShipAttack.pak/1":"ShareData=AAABrUVH5=AAAAAAG]B1U!9!_AAABrUVH5=Aah8/Uwi,-AAAAAAAABrUg[wzVEg","SaveState_dkcr/Worlds/W03_Ruins/L04_Ruins_WaterWheels.pak/1":"ShareData=AX:-JUVH5=ALSFpTODtmU!9!_AAABrUVH5=ASFkWU70[U8I1/RAX:-JUn&gRVEg","SaveState_dkcr/Worlds/W03_Ruins/L05_Ruins_Rambi.pak/1":"ShareData=AAABrUVH5=AAAAAAS(?0Uwi,-AAABrUVH5=AAnlpU!9!_AAAAAAAABrUj6W]VEg","SaveState_dkcr/Worlds/W03_Ruins/L06_Ruins_BlueBiters.pak/1":"ShareData=AAABrUVH5=AAAAAAYtwZU!9!_ANBz(UepvtTQ|3oUwi,-AJh@:8V3lKUeV@gVEg","SaveState_dkcr/Worlds/W03_Ruins/L07_Ruins_Boss_Stu.pak/1":"ShareData=AAABrUqEV3Ol|(_4dQk29yk^A3v2^LUgZ=TTA+SVVNpx-47c9v8gkxaUhv[mVEg","SaveState_dkcr/Worlds/W04_Cave/L01_Cave_Introduction.pak/1":"ShareData=AAABrUVH5=AAAAAAQ@-f+d]wYAAABrUVH5=AOUJsU!9!_AAAAAAAABrUlo7LVf8","SaveState_dkcr/Worlds/W04_Cave/L02_Cave_BatAttack.pak/1":"ShareData=AAABrUVH5=AAAAAAM8CvVSD^,AAABrUVH5=AEzwVU!9!_AAAAAAAABrUq-eQVEg","SaveState_dkcr/Worlds/W04_Cave/L03_Cave_MolePatrol.pak/1":"ShareData=AAABrUVH5=AAAAAAX8?m9g&VVAAABrUVH5=AAZ1AUVH5=AAAAAAAABrUd5M[VEg","SaveState_dkcr/Worlds/W04_Cave/L04_Cave_ClingCarts.pak/1":"ShareData=AAABrUVH5=AAAAAAW]^5U!9!_AAABrUVH5=AYAE&Uwi,-AAAAAAAABrUj]J^VEg","SaveState_dkcr/Worlds/W04_Cave/L05_Cave_BombsAway_v2.pak/1":"ShareData=AAABrUVH5=AAAAAAK^X(U!9!_AAABrUVH5=AW=@WU!9!_AAAAAAAABrUjFEMVEg","SaveState_dkcr/Worlds/W04_Cave/L06_Cave_Boss_MoleTrain.pak/1":"ShareData=AAABrUVH5=AAAAAAG24^+5P5ZAAABrUVH5=AY@:pVSD^,AAAAAAAABrUZ[htVf8","SaveState_dkcr/Worlds/W05_Forest/L01_Forest_Vines.pak/1":"ShareData=AAABrUVH5=AAAAAAC{CGU!9!_AAABrUVH5=ASY,{U!9!_AAAAAAAABrUVtObVf8","SaveState_dkcr/Worlds/W05_Forest/L02_Forest_Movers.pak/1":"ShareData=AH:AZUkU2M7ae1g88U[oVQS7{OHTknUe3p(8Sz{pU8kO6TsD!|S^6}lUfA,kVEg","SaveState_dkcr/Worlds/W05_Forest/L03_Forest_Bounce.pak/1":"ShareData=AAABrUVH5=AAAAAAaNTUU!9!_AAABrUVH5=ACdOdU!9!_AAAAAAAABrUvOxHVEg","SaveState_dkcr/Worlds/W05_Forest/L04_Forest_Barrels.pak/1":"ShareData=AY-bQUi/7sSK=9HTtS;xUwi,-AT[C2Uenj78xr}eT*;vR8=VpKTpavCUjD1-VEg","SaveState_dkcr/Worlds/W05_Forest/L05_Forest_Vineride.pak/1":"ShareData=AAABrUVH5=AAAAAARmWp+CunXAAABrUVH5=AAt_4Uwi,-AAAAAAAABrUYsbTVEg","SaveState_dkcr/Worlds/W05_Forest/L06_Forest_Chase.pak/1":"ShareData=AAABrUVH5=AAAAAAB/liUwi,-AAABrUVH5=AX~pRU!9!_AAAAAAAABrUZZzkVEg","SaveState_dkcr/Worlds/W05_Forest/L07_Forest_ClingSwing.pak/1":"ShareData=AAABrUVH5=AAAAAAY4tsU!9!_AAABrUVH5=ALKh^Uwi,-AAAAAAAABrUaWbZVEg","SaveState_dkcr/Worlds/W05_Forest/L08_Forest_Totems.pak/1":"ShareData=AAABrUVH5=AAAAAAP$xXVSD^,AAABrUVH5=AQ9!&Uwi,-AAAAAAAABrUhD*2VEg","SaveState_dkcr/Worlds/W05_Forest/L09_Forest_Boss_MongoRuby.pak/1":"ShareData=AAABrUVH5=AAAAAACDoTU!9!_AAABrUVH5=AH+cTVSD^,AAAAAAAABrUwF/AVf8","SaveState_dkcr/Worlds/W06_Cliff/L02_Cliff_TarFalls.pak/1":"ShareData=AAABrUVH5=AAAAAAQEsnU!9!_AAABrUVH5=AC|7IUwi,-AAAAAAAABrUnzsLVEg","SaveState_dkcr/Worlds/W06_Cliff/L03_Cliff_Boulders.pak/1":"ShareData=AAABrUVH5=AAAAAAP?3-+CunXAAABrUVH5=AX6hCU!9!_AAAAAAAABrUff+ZVf8","SaveState_dkcr/Worlds/W06_Cliff/L03_Cliff_Minecart.pak/1":"ShareData=AAABrUVH5=AAAAAALFo2U!9!_AAABrUVH5=AP=tHUwi,-AAAAAAAABrUhJ68VEg","SaveState_dkcr/Worlds/W06_Cliff/L04_Cliff_Counterweight.pak/1":"ShareData=AAABrUVH5=AAAAAALn(AU!9!_AAABrUVH5=ATcSAUwi,-AAAAAAAABrUvx4KVEg","SaveState_dkcr/Worlds/W06_Cliff/L05_Cliff_Rambi.pak/1":"ShareData=AAABrUVH5=AAAAAAYKA~U!9!_AAABrUVH5=AGbH9U!9!_AAAAAAAABrUe}5ZVEg","SaveState_dkcr/Worlds/W06_Cliff/L07_Cliff_Avalanche.pak/1":"ShareData=AAABrUVH5=AAAAAAKfZ3+d]wYAAABrUVH5=AFhN(UVH5=AAAAAAAABrUW3|/Vf8","SaveState_dkcr/Worlds/W06_Cliff/L08_Cliff_ShipGraveyard.pak/1":"ShareData=AAABrUVH5=AAAAAAZ&=[U!9!_AAABrUVH5=AT:QrUwi,-AAAAAAAABrUiX;AVf8","SaveState_dkcr/Worlds/W06_Cliff/L09_Cliff_Ascend_V2.pak/1":"ShareData=AAABrUVH5=AAAAAAW:a/+CunXAAABrUVH5=ACXIHUwi,-AAAAAAAABrUgT!sVEg","SaveState_dkcr/Worlds/W06_Cliff/L10_Cliff_Boss_Thugly.pak/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AV$V$+d]wYAAAAAAAABrUaW)XVf8","SaveState_dkcr/Worlds/W07_Factory/L01_Factory_FoggyFumes.pak/1":"ShareData=AX:-JUVH5=ALSFpTLChQ98TeWAAABrUVH5=AK*4dU70[U8I1/RAX:-JUgloKVf8","SaveState_dkcr/Worlds/W07_Factory/L02_Factory_Smashers.pak/1":"ShareData=AAABrUVH5=AAAAAAQM50U!9!_AAABrUVH5=AV^}&Uwi,-AAAAAAAABrUf:HDVEg","SaveState_dkcr/Worlds/W07_Factory/L03_Factory_RobotHands.pak/1":"ShareData=AAABrUVH5=AAAAAAMpEWU!9!_AAABrUVH5=Aa9HmU!9!_AAAAAAAABrUsqYrVf8","SaveState_dkcr/Worlds/W07_Factory/L04_Factory_RocketBarrel.pak/1":"ShareData=AAABrUVH5=AAAAAAW*n0U!9!_AAABrUVH5=ADv:;UVH5=AAAAAAAABrUf/_lVEg","SaveState_dkcr/Worlds/W07_Factory/L05_Factory_Gears.pak/1":"ShareData=AAABrUVH5=AAAAAASg&yU!9!_AAABrUVH5=ABlicUwi,-AAAAAAAABrUk,X_VEg","SaveState_dkcr/Worlds/W07_Factory/L06_Factory_Switcheroo.pak/1":"ShareData=AAABrUVH5=AAAAAALo~YUVH5=AAABrUVH5=ATQQ$Uwi,-AAAAAAAABrUdLu/VEg","SaveState_dkcr/Worlds/W07_Factory/L07_Factory_Musicmadness.pak/1":"ShareData=AAABrUVH5=AAAAAAKc*JUwi,-AAABrUVH5=AY?|yUwi,-AAAAAAAABrUfJb;VEg","SaveState_dkcr/Worlds/W07_Factory/L08_Factory_Launch.pak/1":"ShareData=AAABrUVH5=AAAAAAZ$Q5U!9!_AAABrUVH5=ASXX@Uwi,-AAAAAAAABrUd}CPVEg","SaveState_dkcr/Worlds/W07_Factory/L10_Factory_Boss_RobotChicken.pak/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ALI1pUwi,-AAAAAAAABrUwZJVVEg","SaveState_dkcr/Worlds/W08_Volcano/L01_Volcano_Fireballs.pak/1":"ShareData=AAABrUVH5=AAAAAAALgO+CunXAAABrUVH5=AFkX7Uwi,-AAAAAAAABrUctquVEg","SaveState_dkcr/Worlds/W08_Volcano/L02_Volcano_Minecart.pak/1":"ShareData=AAABrUVH5=AAAAAAZ$gGUwi,-AAABrUVH5=AV}/BUwi,-AAAAAAAABrUum2QVEg","SaveState_dkcr/Worlds/W08_Volcano/L03_Volcano_BobbingBasalt_v2.pak/1":"ShareData=AAABrUVH5=AAAAAADH_~Uwi,-AAABrUVH5=AXir/UVH5=AAAAAAAABrUp]r3VEg","SaveState_dkcr/Worlds/W08_Volcano/L04_Volcano_Rocketbarrel.pak/1":"ShareData=AAABrUVH5=AAAAAAKctnU!9!_AAABrUVH5=AU,M|UVH5=AAAAAAAABrUtXnnVEg","SaveState_dkcr/Worlds/W08_Volcano/L05_Volcano_RiverRide.pak/1":"ShareData=AX66IUnn_|R=IJq8dxY;+uS~$O=!*7UW&sQTb6=?VH7_!TW-D:85Y^CUjVSUVEg","SaveState_dkcr/Worlds/W08_Volcano/L06_Volcano_Rambi_Silhouette.pak/1":"ShareData=AAABrUVH5=AAAAAAMad[U!9!_AAABrUVH5=ATo]LUwi,-AAAAAAAABrUmvTIVEg","SaveState_dkcr/Worlds/W08_Volcano/L07_Volcano_Eruption.pak/1":"ShareData=AAABrUVH5=AAAAAARV{_U!9!_AAABrUVH5=AJl+kU!9!_AAAAAAAABrUXsXrVEg","SaveState_dkcr/Worlds/W08_Volcano/L08_Volcano_Boss_TikiTong.pak/1":"ShareData=AAABrUVH5=AAAAAAV_vlUwi,-AAABrUVH5=ARR:@U!9!_AAAAAAAABrUs@=mVf8","SaveState_elb/stg01/1":"ShareData=AF{FU9v?6]9AbpLUG^*6+&:6XQ?yl]Uh}SGT4@H$V:~F?9f3HiT+mQY9zf+p+^","SaveState_elb/stg02/1":"ShareData=AET-d9obTWS2:jf906mg=M=m[RA4J]UaJkoTUXU~V@xt4Ucru4S{C3o9nUF~Vt","SaveState_elb/stg02a/1":"ShareData=AXOd7Uj}*|8&}noUu:S0V)$3(6I22JUa?8OT~pumVv{{t9p(VO8[gtPUfn7*WP","SaveState_elb/stg02b/1":"ShareData=AK1[a92N~b8|xki94v=p=r1QqQ!zUBUimBb8;8qoWMGLDUdaQG8tGr)9n+C}Vt","SaveState_elb/stg02c/1":"ShareData=AaH&=Usl:hTCc$0T*POlV[$+RQDFZ+UW;mP80M?SV94(&9g0?DTX-4rUq-q:WP","SaveState_elb/stg02d/1":"ShareData=AIOLX9xT])84Bi&95UXH=neL=RAcl5UmVtD85ff7V!569UlNNw8rEAV97j$^Uw","SaveState_elb/stg03/1":"ShareData=ASCBD92L|q8&t4wUVCv5=KY(mQ&IiQUc&)ZUG{:-V$-Wm9S2rNUANpa9n2]q+^","SaveState_elb/stg04/1":"ShareData=AE!SeUX[2/8Xip1T~e@39&54Z5Bv_dUel@6T2n0KV6;?98]ej~9AndBUY+8$V[","SaveState_lm3d/map1/1":"ShareData=AMoHoUagVo8Z@(BT+LY]=sZc@5341aUdE{tT2_[wV:C!e9DH809EIy8UVI$dV[","SaveState_lm3d/map10/1":"ShareData=AAABrUtogU4dkkOPV]H,UuI--O{1zWUr~8qUR_M:V}H=oP6)Ea9U3)}Ud*4iWP","SaveState_lm3d/map11/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAANBz(UepvtTH/NzVtfI:AJh@:8V3lKUXieKV[","SaveState_lm3d/map12/1":"ShareData=AAABrUVH5=AAAAAAAZd*+5P5ZAQ=;UUVIZpTnTYyVtfI:AAA0=807+mUgtZ9V[","SaveState_lm3d/map13/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AI2r+VtfI:AAAAAAAABrUf/SmWP","SaveState_lm3d/map2/1":"ShareData=AE3N6UaFH78XZ}/T7KbOVf?]+P~M?AUa=V~T?s|FWDKyH8:b@T8{@i_UWo6$+^","SaveState_lm3d/map3/1":"ShareData=AAdp8Um4w&8,VIqUZxAjVy/RMPvQ=gUmy8LUP(r1V-t0J953Oi8/)}wUwP[0U!","SaveState_lm3d/map4/1":"ShareData=AY-bQUfE~WS{jRj8x^Rg=Ne8k5cWh(UkvA~T]eP,V=/|GTqotG8?a]-UiRRLVt","SaveState_lm3d/map5/1":"ShareData=APe{JUV+(h7:P[^TiJ={+hNo65zL}yUb;{)T;XnrV}S!N8=N0z8}@_KUW:@rVt","SaveState_lm3d/map9/1":"ShareData=ADHh0UtLys7)e88Tp?3BVT2rk5n7s8UdL)ST;]IhWf~-+88JTV9E$LLUu;x@WP","SaveState_pkmnpl/0/1":"ShareData=AD?s&Uwbn(8R9WvTO=xwXAn&8Q)xqLUvxMRUhqpwW4h)H8Q4E19lz-QUi!t6Xn","SaveState_pkmnpl/0/2":"ShareData=AY}hQUj&x]8O8z&TzV!GW*GOkQ+Z)AUlHHvUYBYbWwAo]89uzE96{3XUtssxXn","SaveState_pkmnpl/0/3":"ShareData=ADRI?UlXer8JzrRTQ;XEW+m-FQ+ZP~Uk|),Usk5NW:hSZ8J;b09ro-jUb~R9Xn","SaveState_pkmnpl/0/4":"ShareData=AaemhUsZR]S/t?/7)]aDXR)w[Q*0i=Ua?TnUZQF;W5=xOS8Cvg90i:bUv)5lXn","SaveState_pkmnpl/0/5":"ShareData=AaVggUbD&)7![2oS&5=cXk@k,Q[w4yUoNHjUovY(WxQft7^IX99s$iTUj{r_XL","SaveState_pkmnpl/0/6":"ShareData=AHDxUUd)}$8Jr64TRAYqXrLFFQ?fH4UaX56UorlNWrBa28s_Wt9qH7IUgVACXn","SaveState_pkmnpl/0/7":"ShareData=AI[5iUniW:86Aa(TxDO{X4iTbQ?MyrUqQg?UjkvsW&J7_88e619m5AvUYl+AXL","SaveState_pkmnpl/0/8":"ShareData=AD?s&UtB1I8hch]S{[DTXdG?3RB*_zUm(*yUd@ZIW8_)z8K,7b9oqFOUeeeCXL","SaveState_pkmnpl/0/9":"ShareData=ANBz(UeILl8L6?bTSVk|W1T0uQ=:zCUd_nRUfK_KW0Dr38hbPj90_cpUjY+uXL","SaveState_MarioAndSonicAtTheOlympicGames2012/a_test.arc/1":"ShareData=AR2ZUUb~w^9J(oSUjBwQV^y1E5@ng5Utk~1UQ(x_V-(^992XkO9KHttUfsLqV[","SaveState_MarioAndSonicAtTheOlympicGames2012/a2_test.arc/1":"ShareData=AYh}0UBC4b9FomHUb!MiVXMf8Q85M0UrfKoUOis3VwKPz9xZNY8{DR0UM$knVt","SaveState_MarioAndSonicAtTheOlympicGames2012/a3_test.arc/1":"ShareData=AGAGcUN7GOUOF)&917Az=LiaO5mF;1UbOnwUJ[^cV0p&WUv{1@8-O1zT^QMrVt","SaveState_MarioAndSonicAtTheOlympicGames2012/a4_test.arc/1":"ShareData=AC;)89r1;ET0eW$9S5JR+](*|Qx0BlUj-IiUE_vnVyZV5T}{GpUTeNG9h8V|+^","SaveState_MarioAndSonicAtTheOlympicGames2012/aqu1_100m_4p.arc/1":"ShareData=AUA1uUcNm^8;Q(0UtFrzV_aM,Q5GD^UmrfZT+SrjVLMjc9v]Ov8&eLvUtv+PVt","SaveState_MarioAndSonicAtTheOlympicGames2012/aqu1_100m.arc/1":"ShareData=ALSbz93im!8&NTKUc]biV8/UcQ305BUf[/_UADsiVV)To9iVpDT;RNn9kL1f+5","SaveState_MarioAndSonicAtTheOlympicGames2012/aqu1_sync.arc/1":"ShareData=AQ{ot93LCF9c^)HUs=l-Vyv^]Q(^ElUoItJUP[;3VjsQO9ms9XULDQ/98J^B+5","SaveState_MarioAndSonicAtTheOlympicGames2012/d110h_cmn1.arc/1":"ShareData=AC:&ZUo^8kT=;(x9S,=k+zXb}Q0TkWUZi+-T^MOlV90hvUDmS?9JV,*UtB8JV[","SaveState_MarioAndSonicAtTheOlympicGames2012/dcano_cmn1.arc/1":"ShareData=ADqihT](O08[ZyuUbUtuWmBw)Q~MO7Uk:C0T+Q15VsB=a9x01&85yq2T5VfgWq","SaveState_MarioAndSonicAtTheOlympicGames2012/deque_cmn1.arc/1":"ShareData=AO&/lUo25^8t&05T(7r?WY@vAQ?t;aUnPo,T0sG~V]fLg8)}(I8&ikyUX0C$Wq","SaveState_MarioAndSonicAtTheOlympicGames2012/dfenc_cmn1.arc/1":"ShareData=AWi:*UrCDV7:Ad*TWDf{U9uN64*Qq0UW4t_T=[XIV3ME^8LOYb9FSjPUsNO$Vt","SaveState_MarioAndSonicAtTheOlympicGames2012/dlong_cmn1.arc/1":"ShareData=AOf@QUc}~r8R*=*T[+j8VfZcg57U8XUde{ET@Z{nVYY(]8[&PA8,Q6XUjjxlVt","SaveState_MarioAndSonicAtTheOlympicGames2012/dspri_cmn1.arc/1":"ShareData=AL)yd9vWjNTp/BA9VkCR+r91$Qc|~eUic~]T&|ppVrEswUJaCdT;q,h9hZ[{+^","SaveState_MarioAndSonicAtTheOlympicGames2012/dsync_cmn1.arc/1":"ShareData=AWjcKUWMD|8lhu}T@-~6V*(/9QS=sgUp}2HUF~;hVW*nJ8=)c(9Kq7dUhC+VWP","SaveState_MarioAndSonicAtTheOlympicGames2012/dthro_cmn1.arc/1":"ShareData=AD/^+Urh8*S^@(c8zzbu+V6KLPgv=cUs[/sT)4gzVj^,qTt3=M9I_]yUV{6DVt","SaveState_MarioAndSonicAtTheOlympicGames2012/dtram_cmn1.arc/1":"ShareData=AT+{1UYl7,8CGNmTd9evU-DJ]4XI4cUWv_=T:9BMV}XH,85yVh9A+f5UYx=wVt","SaveState_MarioAndSonicAtTheOlympicGames2012/dunev_cmn1.arc/1":"ShareData=AGH)jUvdiK9A9QxUC^a7WN$gE5fY^iUo_8MUC(?WV;L}h9Zp&~9KhXKUkK=8V[","SaveState_MarioAndSonicAtTheOlympicGames2012/eton_c210.arc/1":"ShareData=AOn/kUFe?Q8?}wTUZfwOWo!RcQwYaEUWjChT=Rh!VtK2n9xEU,8ko6MUA}3:+5","SaveState_MarioAndSonicAtTheOlympicGames2012/exce_fenc.arc/1":"ShareData=AWZ9)UivBG8G^AFTQGC&U@0@(QQWOSUpI=^T[9sgVe7:X8eL[z8;eiWUdG{bVt","SaveState_MarioAndSonicAtTheOlympicGames2012/exce_judo.arc/1":"ShareData=ASSQF9yUDr9SLbYUo[$mV+d7:Q;HX/UZp,pUB?B,VtBd^9id&CT4tqN9JY&T+d","SaveState_MarioAndSonicAtTheOlympicGames2012/exce_tabl_4p.arc/1":"ShareData=ARm@8Ue8Z29a7g{Ur8l6V[rs3Q6rtvUl54yUN3GLVgbk-9y}fO9Ik}lUINQ-VS","SaveState_MarioAndSonicAtTheOlympicGames2012/exce_tabl.arc/1":"ShareData=AXTg89Z!]_9U?F?Uv7wTV8^9b4y$o-UhtVnUM{{=VZo_}9lSPDT07wA9J7S:+C","SaveState_MarioAndSonicAtTheOlympicGames2012/gree_eque.arc/1":"ShareData=AWmx39h3U~8{QVPUhr5vV*X}VQ{=QXUwdc+UKU*NV[J+*9t0gVUFnw49qfk|+5","SaveState_MarioAndSonicAtTheOlympicGames2012/hors_beac.arc/1":"ShareData=AOJ9=UkoZAT_P@[9fK,1+31Wf5zjwfUj3p+UQ2mCValIIUKuYC9d:39UelVzVt","SaveState_MarioAndSonicAtTheOlympicGames2012/nor1_tram.arc/1":"ShareData=ARdLO9Pn558-z3IUalx(V?wv)QuF1hUrn1VUL?9{VdqyS930CST]0W!9F87l+d","SaveState_MarioAndSonicAtTheOlympicGames2012/nor1_unev.arc/1":"ShareData=AC(X]92y@]9GZ(NUr*5hV;$$O5wPrDUq;WzUO+K{Vg7C}9p-dJUCNH6944gD+5","SaveState_MarioAndSonicAtTheOlympicGames2012/nor2_badm.arc/1":"ShareData=AAFWxT*QVS8=ag5UhoQtUi8ViQlgSTUkj^BT~UXyVXnR)9y^|@8_o~hT^JR1VS","SaveState_MarioAndSonicAtTheOlympicGames2012/nor2_ryth.arc/1":"ShareData=ALbHt9g:1W9f0wEUbK6pVuY]h5,n$KUe*5gUAHt8Vsi1E9l/OCT3E|r9Ni~e+d","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_100m_4p.arc/1":"ShareData=AXi,,95kQyUA;NF9y:+^=T}QD5;n)uUgl7!UBhOIVW[ijUjr:RUB9;Z9x~/|Vt","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_100m.arc/1":"ShareData=AWs(1Ua51s9KogiUfu^L+(N|/55!o[Uo6+*UD:}0VUk8q9r5|[9S!CFUk=R$V[","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_110h_4p.arc/1":"ShareData=AOCOk9y11KT/6-a9o3[yV1q+l5I,R^UmF^eULv|ZVT~acUp=,mT__/p9k_}6Vt","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_110h.arc/1":"ShareData=AOxQb92W|78}OB_UrROcWFW_C6D?gsUinP7T^SXsVf-aC94yF9UB0L!960L:VS","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_4x1r_4p.arc/1":"ShareData=AAZm,9eXwmUK}ts9qTL!=O0xqQpHg[UZFqlT}JaEVjaXfUt76_T?lxO9R;3^Vt","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_4x1r.arc/1":"ShareData=AIt+5UhP+H9OgR9UrE[d+](QlQGli(Ual95T|capV_P{=91pqV9V7QhUl(pSV[","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_disc.arc/1":"ShareData=AP2P88|fDeUKJHQ9v6LL=YlMUQ3XiWUaEN8UG/&nVj{H3UV2IUTlVta8_Is-+5","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_hamm.arc/1":"ShareData=AY{$[T!F9m9Jb,NUp2/$WHux{5hM@]UrhkmT^EbCVYtsg9rs+L8ls!|T,792+d","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_jave.arc/1":"ShareData=Aa7{$T{NGAT^!I19x|fK=ROG~Q5DJAUlzx{T)hQrVlr!5UYu|Z8kiqQUFy5CVS","SaveState_MarioAndSonicAtTheOlympicGames2012/olym_long.arc/1":"ShareData=ABHr4UM$$_UB~J99uOzz=K/s=RC)Y(UwK(VUT~j4Vfz1zUrMsJ8=|UFT*u9y+5","SaveState_MarioAndSonicAtTheOlympicGames2012/pty1_cmn1.arc/1":"ShareData=ADLF{Up$vW9P@T|UtCj[VuEMNQ{E3+Ul{KyT^W73Vv5},9swmt9RlwUUwH(YVt","SaveState_MarioAndSonicAtTheOlympicGames2012/pty2_cmn1.arc/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUrq9aVt","SaveState_MarioAndSonicAtTheOlympicGames2012/pty3_cmn1.arc/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUl6-UVt","SaveState_MarioAndSonicAtTheOlympicGames2012/pty4_cmn1.arc/1":"ShareData=AGSI4UC2Q0UD}i&9ynv,V$50f5+b4RUYcL(T{O1TVYA4jUtX*F8)~6uT|z[5Vt","SaveState_MarioAndSonicAtTheOlympicGames2012/pty5_cmn1.arc/1":"ShareData=ALmE)9kHmkT8l,?9p9cn+77c96R]0gUez~!UA1xVVf3IAUjbmoUK$z^94FK?+5","SaveState_MarioAndSonicAtTheOlympicGames2012/pty6_cmn1.arc/1":"ShareData=AAc1zUrlmFUC:?i9jEI5V)26a5?]YWUuif^T{[NBV?ywGUvL]e9aWv_Ur2lD+d","SaveState_MarioAndSonicAtTheOlympicGames2012/roya_shoo.arc/1":"ShareData=ARCuGUfN]b8la_fUGN_9VkKRl5R=iGUrxWqUS)y0U&xk:9X!d29KcmwUV,a[VS","SaveState_MarioAndSonicAtTheOlympicGames2012/velo_spri.arc/1":"ShareData=AL9($9MBgQUR3u~95x]X+!W2~5+eqLUsY}pT^g-^VaY]0Uko_fT-$T|9S2_,+d","SaveState_MarioAndSonicAtTheOlympicGames2012/wemb_foot.arc/1":"ShareData=AHYn@UdSRU9N*-FUpG5TV$_Z:QcNu)UiXAfUF$LCV-+FX9sooF9Gai7UrA^dVt","SaveState_spm/aa1_01/1":"ShareData=AEw~uUhhKY8gwliUOXWjV)7$_QVjb8UfW=NTdPS0WA+,]9ae]387Q@+UjD19WP","SaveState_spm/aa1_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ABmZBVtfI:AAAAAAAABrUk7pHV[","SaveState_spm/aa2_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AF,0MVtfI:AAAAAAAABrUf=)[WP","SaveState_spm/aa2_02/1":"ShareData=AK__vUrl4V7{FLHTxWGKWTKE{3*evfUrwGkT3]hcWNdU7819]W8$4h6Ua7S,WP","SaveState_spm/aa3_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AVu{KVtfI:AAAAAAAABrUlQI6V[","SaveState_spm/aa4_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AG$KkVSD^,AAAAAAAABrUcK^~WP","SaveState_spm/an1_01/1":"ShareData=AAABrUVH5=AAAAAAN762V[6R;AAABrUVH5=AXr8/V[6R;AAAAAAAABrUhxD@WP","SaveState_spm/an1_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AMEj5V[6R;AAAAAAAABrUVOrHWP","SaveState_spm/an1_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANq/VWPAa~AAAAAAAABrUW_NDWP","SaveState_spm/an1_04/1":"ShareData=AAABrUVH5=AAAAAAK^(:=a~!bAAABrUVH5=ACI_(V[6R;AAAAAAAABrUVOq*WP","SaveState_spm/an1_05/1":"ShareData=AAABrUVH5=AAAAAAVu_e+^q,aAAABrUVH5=AZq[IV[6R;AAAAAAAABrUpIj?WP","SaveState_spm/an1_06/1":"ShareData=AAABrUVH5=AAAAAAG6Q-=2L^cAX:-JUgZ=TTB!7mV[6R;ALSFp8gkxaUf}UrV[","SaveState_spm/an1_07/1":"ShareData=AAABrUVH5=AAAAAALG,3VtfI:AAABrUVH5=ANB0AV[6R;AAAAAAAABrUtB_?WP","SaveState_spm/an1_08/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANB0PV[6R;AAAAAAAABrUXe13WP","SaveState_spm/an1_09/1":"ShareData=AAABrUVH5=AAAAAAJ}tx+5P5ZAAABrUVH5=AZ&zMV[6R;AAAAAAAABrUvUf)WP","SaveState_spm/an1_10/1":"ShareData=AAABrUVH5=AAAAAALbQ)+5P5ZAAABrUVH5=AXhQ?V[6R;AAAAAAAABrUq+m-WP","SaveState_spm/an1_11/1":"ShareData=AAABrUVH5=AAAAAAOHBT+5P5ZAAABrUVH5=AZq?=V[6R;AAAAAAAABrUl@ahWP","SaveState_spm/an2_01/1":"ShareData=AAABrUVH5=AAAAAABMtAVSD^,AAABrUVH5=AZq[IV[6R;AAAAAAAABrUfhFCWP","SaveState_spm/an2_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AP6UYV[6R;AAAAAAAABrUrF*6WP","SaveState_spm/an2_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AZq?=V[6R;AAAAAAAABrUtd$2WP","SaveState_spm/an2_04/1":"ShareData=AAABrUVH5=AAAAAAVd3p+^q,aAAABrUVH5=ABgWUV[6R;AAAAAAAABrUcFB_WP","SaveState_spm/an2_05/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AK@*FV[6R;AAAAAAAABrUfX&lWP","SaveState_spm/an2_06/1":"ShareData=AAABrUVH5=AAAAAALC&^VSD^,AX:-JUgZ=T8YmEJV[6R;ALSFpTU0A;UdvNBWP","SaveState_spm/an2_07/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ACzkQV[6R;AAAAAAAABrUe;TtWP","SaveState_spm/an2_08/1":"ShareData=AAABrUVH5=AAAAAAL{77+5P5ZAX:-JUgZ=T8UF-^V[6R;ALSFpTU0A;Un&]5WP","SaveState_spm/an2_09/1":"ShareData=AAABrUVH5=AAAAAAEICcWPAa~AAABrUVH5=ANB0AV[6R;AAAAAAAABrUjsBqWP","SaveState_spm/an2_10/1":"ShareData=AAABrUVH5=AAAAAAHE,K+d]wYAAABrUVH5=AW$qfV[6R;AAAAAAAABrUgSU;WP","SaveState_spm/an3_01/1":"ShareData=AAABrUVH5=AAAAAAbKCd+^q,aAAABrUVH5=Aa$GTWPAa~AAAAAAAABrUavW2WP","SaveState_spm/an3_02/1":"ShareData=AAABrUVH5=AAAAAAZq?=+^q,aAAABrUVH5=AaDSsV[6R;AAAAAAAABrUd9?GWP","SaveState_spm/an3_03/1":"ShareData=AAABrUVH5=AAAAAAD5Y|+^q,aAAABrUVH5=AF][oV[6R;AAAAAAAABrUdVrpWP","SaveState_spm/an3_04/1":"ShareData=AAABrUVH5=AAAAAAV!i?VtfI:AAABrUVH5=AC_]MV[6R;AAAAAAAABrUmO3qWP","SaveState_spm/an3_05/1":"ShareData=AAABrUVH5=AAAAAAYuFI+5P5ZAAABrUVH5=ABlP~V[6R;AAAAAAAABrUwfS3WP","SaveState_spm/an3_06/1":"ShareData=AAABrUVH5=AAAAAAJ_esVSD^,AAABrUVH5=ARL8{V[6R;AAAAAAAABrUs_M^WP","SaveState_spm/an3_07/1":"ShareData=AAABrUVH5=AAAAAAPusd+5P5ZAAABrUVH5=AFu6fV[6R;AAAAAAAABrUguB1WP","SaveState_spm/an3_08/1":"ShareData=AAABrUVH5=AAAAAAFseTWPAa~AAABrUVH5=ANB0AV[6R;AAAAAAAABrUb=&DWP","SaveState_spm/an3_09/1":"ShareData=AGC)yUmiFtT+QB(9Ij&k=jXcg47b~5Uq3z5UEOnyWFg7wUF;Zr9T}ZXUaCMcWP","SaveState_spm/an3_10/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANB0AV[6R;AAAAAAAABrUb:@cWP","SaveState_spm/an3_11/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ABGA)V[6R;AAAAAAAABrUq$45WP","SaveState_spm/an3_12/1":"ShareData=AY3VPUVk]A7L:PjTjh3^=MKh^3!~ySUXT+TTf+)BV@0KW8j{tm85/XFUXvA:WP","SaveState_spm/an3_13/1":"ShareData=AAABrUVH5=AAAAAABK*a+^q,aAAABrUVH5=AS5r2V[6R;AAAAAAAABrUlEO5WP","SaveState_spm/an3_14/1":"ShareData=AAABrUVH5=AAAAAAQac=+5P5ZAAABrUVH5=AON5BV[6R;AAAAAAAABrUe*}nWP","SaveState_spm/an3_15/1":"ShareData=AAABrUVH5=AAAAAALcd4=a~!bAAABrUVH5=AQM{1Wqbj/AAAAAAAABrUoLNJWP","SaveState_spm/an3_16/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ABE(uVtfI:AAAAAAAABrUwD?_V[","SaveState_spm/an4_01/1":"ShareData=ACwd4Ui0}3Tozca9Js-D+,iua4dlgRUlLlUTzkQHV{o)?UO+b88spkVUV=ZIWP","SaveState_spm/an4_02/1":"ShareData=AS=*1Ufl-iTt1~G9IIFg=iF(*4n5hGUdf3;T]cRbV]O3NT*6zJ8_wqrUkNf[WP","SaveState_spm/an4_03/1":"ShareData=AVriNUZ(,:T71Ef9kQUf=d1tR5ewH!UrVpTUS8[~WaXc*Un+=08;N,aUdA2lWP","SaveState_spm/an4_04/1":"ShareData=ASccOUXpUtT&9hy94o?7=c1@s48^/]UlI}/T6jhaWKC=|Ug_!}8|F;8UvZ+fWP","SaveState_spm/an4_05/1":"ShareData=ALoS]Ue5A?T+_!b974?$=dj^7QEiexUZdW*UF^2nWQAbIUd!:{8{L:tUrvN]WP","SaveState_spm/an4_06/1":"ShareData=AXI^mUj3uET9r~w9yiMR=6SFl5qR)vUlKmMT0[BsV|BUQUiMyF8,0j|UZ*SpWP","SaveState_spm/an4_07/1":"ShareData=AAslYUkzpIUP@DH9wb8/=pm-~P!?7~Ui${/UJn;pWl9P0Uk|Bj9f57BUj;V[WP","SaveState_spm/an4_08/1":"ShareData=ALqCDUXOo9T,DA]9t9dn=g230QCOruUq1l+UOS+0V|zTtUsNxM8&eyoUr[@cWP","SaveState_spm/an4_09/1":"ShareData=AH}:2UfWMsT9sLn9xB{7=jYql5b}48UoVP$T9pb&WVlNCUVfNU8&Ke8UqzN^WP","SaveState_spm/an4_10/1":"ShareData=APSEVUlUItT7?f69iy99=w3XoQcvtaUic~]T/mM6V[(o;UwF~&9DR3&Ur$IaWP","SaveState_spm/an4_11/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AM=V+V[6R;AAAAAAAABrUona[WP","SaveState_spm/an4_12/1":"ShareData=AZbhsUkIK1T@}8@90}O)=uyJL4=DprUV_zbT]2Y&WTGtKUl$@K8{_THUrPB&WP","SaveState_spm/bos_01/1":"ShareData=AX:-JUoJUFRn0x(TR?kJ9g&VVAX:-JUgZ=T8Oy;zV|$XY8SC6pTQ|ziUazoXWP","SaveState_spm/dan_01/1":"ShareData=AAABrUVH5=AAAAAAFHW++5P5ZAAABrUVH5=AaVkHV[6R;AAAAAAAABrUdkzOWP","SaveState_spm/dan_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AE8*YV[6R;AAAAAAAABrUs-R7WP","SaveState_spm/dan_03/1":"ShareData=AAABrUVH5=AAAAAADHAa+5P5ZAAABrUVH5=AHxKHV[6R;AAAAAAAABrUpU6wWP","SaveState_spm/dan_04/1":"ShareData=AAABrUVH5=AAAAAAMgJ@+5P5ZAAABrUVH5=ATn9zV[6R;AAAAAAAABrUvEilWP","SaveState_spm/dan_11/1":"ShareData=AAABrUVH5=AAAAAADJj7+5P5ZAAABrUVH5=AC_]zV[6R;AAAAAAAABrUdl@zWP","SaveState_spm/dan_12/1":"ShareData=AP6OMUsQt873MkPTlE5_+}v9I4k7]TUeaJETds^lV}A8K8znbM8obhDUn49DWP","SaveState_spm/dan_13/1":"ShareData=AAABrUVH5=AAAAAAWBp(+5P5ZAAABrUVH5=AVX5]V[6R;AAAAAAAABrUfxY[WP","SaveState_spm/dan_14/1":"ShareData=AK[DHUv]+KT_atI9r*{@=qC!zP48y}UV6ckT7Yf7WOG0(Uq3u?9FE&NUd-*mWP","SaveState_spm/dan_21/1":"ShareData=AKu5EUjqF4Tc6jP9eE[U=Ne7[O5!0VUin5}T9-o/WE{XRUTE_&9C@8EUg@xVWP","SaveState_spm/dan_22/1":"ShareData=AL}2MUhhY)T/)k&9U7Pe=F&Q-5BUvaUd&s1T/3TEV*F^0UDRG09B$0gUco}}WP","SaveState_spm/dan_23/1":"ShareData=AP9C;UifAPT[Gyj9g;=w=eY2P4[9B0UhLJPT6C!]WH8IqUGPDS8~|x?Ujq;TWP","SaveState_spm/dan_24/1":"ShareData=AGwY3UcUCPTaZeC9XK5,=UzL]P|zj)UVfKhT_jHSWFFptUDXy-8[Jb*UY&n0WP","SaveState_spm/dan_30/1":"ShareData=AA@?_UcfKiT5wu59hDl^=8P0=Qcim|Uj8R/T1zDoWG{:LUdj7;9EP2nUXSZsWP","SaveState_spm/dan_41/1":"ShareData=AYt:DUkI;&75]XvTp)92+9GHQ5qHsJUcJ;(TtrZiV!33t86c(|85~p;UW=KhWP","SaveState_spm/dan_42/1":"ShareData=AAABrUVH5=AAAAAABg)8+5P5ZAAABrUVH5=AGJ!~V[6R;AAAAAAAABrUuCp6WP","SaveState_spm/dan_43/1":"ShareData=AAABrUVH5=AAAAAATN~)+5P5ZAAABrUVH5=AL+?nV[6R;AAAAAAAABrUVqMXWP","SaveState_spm/dan_44/1":"ShareData=AAABrUVH5=AAAAAATz/s+5P5ZAAABrUVH5=AOxX1V[6R;AAAAAAAABrUke|~WP","SaveState_spm/dan_61/1":"ShareData=AXMu,UbNDHSp6Qz83?},=Re=xPY5M7UeaJETs5ydWK1K9Tlh_T8vVj0UpBonWP","SaveState_spm/dan_62/1":"ShareData=AAABrUVH5=AAAAAAEGQ@+^q,aAAABrUVH5=AF}}7V[6R;AAAAAAAABrUjs$xWP","SaveState_spm/dan_63/1":"ShareData=AAABrUVH5=AAAAAAMFNi+^q,aAY-bQUXK4STZ5xrV[6R;ACC|o888ViUk4&;WP","SaveState_spm/dan_64/1":"ShareData=AAABrUVH5=AAAAAAZqM-+^q,aAAABrUVH5=AAQdfV[6R;AAAAAAAABrUnc:AWP","SaveState_spm/dan_70/1":"ShareData=AQDU?Uk}ScTp$m99a9M/=1^Q_4j9*7UlMKAT!{=BWICatUHYHK8]a}{UqE&2WP","SaveState_spm/dos_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AUDk5V[6R;AAAAAAAABrUwRKlWP","SaveState_spm/gn1_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAX:-JUgZ=T8Yd[KV[6R;ALSFpTU0A;Um7cNWP","SaveState_spm/gn1_02/1":"ShareData=AAABrUVH5=AAAAAAD?RIV[6R;AAABrUVH5=AZq?=V[6R;AAAAAAAABrUnzk=WP","SaveState_spm/gn1_03/1":"ShareData=AAABrUVH5=AAAAAABF],8j*)SAAABrUVH5=AV/}VV[6R;AAAAAAAABrUqALfWP","SaveState_spm/gn1_04/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AQ@O!V[6R;AAAAAAAABrUsVzdWP","SaveState_spm/gn1_05/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AG6ekV[6R;AAAAAAAABrUXk$DWP","SaveState_spm/gn2_01/1":"ShareData=AAABrUVH5=AAAAAAQ]iZV[6R;AX:-JUgZ=T8M|i}WPAa~ALSFpTU0A;Ut-F~WP","SaveState_spm/gn2_02/1":"ShareData=AAABrUVH5=AAAAAAO!uT=a~!bAAABrUVH5=AXNZ8V[6R;AAAAAAAABrUc1t$WP","SaveState_spm/gn2_03/1":"ShareData=AAABrUVH5=AAAAAASp;_=a~!bAAABrUVH5=ANB0AV[6R;AAAAAAAABrUtIx4WP","SaveState_spm/gn2_04/1":"ShareData=AAABrUVH5=AAAAAAQVld+^q,aAAABrUVH5=ABXKoWPAa~AAAAAAAABrUsOS7WP","SaveState_spm/gn2_05/1":"ShareData=AP:UNUkKr_R=4R0Tts@/=Qzve2(A,JUgZ=T8W+Q*WYS=K8nW3:TI|HmUZ7unWP","SaveState_spm/gn2_06/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANB0eV[6R;AAAAAAAABrUs)[+WP","SaveState_spm/gn3_01/1":"ShareData=AAABrUVH5=AAAAAAM]lYV[6R;AAABrUVH5=AIqYQV[6R;AAAAAAAABrUtB_|WP","SaveState_spm/gn3_02/1":"ShareData=AAABrUVH5=AAAAAAQG7w=a~!bANBz(Uepvt8cArLV[6R;AJh@:TJ/]0UWZ6~WP","SaveState_spm/gn3_03/1":"ShareData=AWi:*UZz0xR|kk0TK;0~=01382:T1(Uepvt8X306WYwK^8c;~OTE~rEUd&&FWP","SaveState_spm/gn3_04/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAQdBV[6R;AAAAAAAABrUoJ0iWP","SaveState_spm/gn3_05/1":"ShareData=AAABrUVH5=AAAAAAK3lb+^q,aAAABrUVH5=AB9IQV[6R;AAAAAAAABrUkeWqWP","SaveState_spm/gn3_06/1":"ShareData=AX$/KUmrNgR9qHc8W5^]=g5:g3Ju+)UepvtTE33xWabmaTEh)Y8SLI+UZTQAWP","SaveState_spm/gn3_07/1":"ShareData=AAABrUVH5=AAAAAAHE,K+d]wYAAABrUVH5=AKX@lV[6R;AAAAAAAABrUeLSMWP","SaveState_spm/gn3_08/1":"ShareData=AAABrUVH5=AAAAAALRiS=a~!bAAABrUVH5=ASH~WWPAa~AAAAAAAABrUe_@JWP","SaveState_spm/gn3_09/1":"ShareData=AAABrUVH5=AAAAAAF&D@V[6R;AAABrUVH5=ARq!wV[6R;AAAAAAAABrUZXikWP","SaveState_spm/gn3_10/1":"ShareData=AAABrUVH5=AAAAAAYr/H=a~!bAAABrUVH5=AXuZvWPAa~AAAAAAAABrUc/AJWP","SaveState_spm/gn3_11/1":"ShareData=AAABrUVH5=AAAAAAXy!t+^q,aAAABrUVH5=AM&z$V[6R;AAAAAAAABrUi0|yWP","SaveState_spm/gn3_12/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AUOcnWPAa~AAAAAAAABrUVlNzWq","SaveState_spm/gn3_13/1":"ShareData=AWi:*Ucyxi6$MgCTHLhmW-ch$N,QRzUgZ=TTOe@==JFyp8e+F@8bjS=Umh([Wq","SaveState_spm/gn3_14/1":"ShareData=ANBz(UVH5=AJh@:TKWFIV[6R;AAABrUVH5=AU0j}WYiQz8I1/RANBz(UwI:8WP","SaveState_spm/gn3_15/1":"ShareData=AAABrUVH5=AAAAAAT5@Q+^q,aAAABrUVH5=AF1(uV[6R;AAAAAAAABrUn8w9WP","SaveState_spm/gn3_16/1":"ShareData=AT+{1Ujjkz38uG^8vMo)=s}&{2{tMsUmQ;T33D2jWYgE_ThoX]4our6UmcG[WP","SaveState_spm/gn4_01/1":"ShareData=AAABrUVH5=AAAAAAKL8qV[6R;AX:-JUgZ=T8O)^$V[6R;ALSFpTU0A;Uj8/?WP","SaveState_spm/gn4_02/1":"ShareData=AAABrUVH5=AAAAAAOX9y+^q,aAAABrUVH5=AK7XOV[6R;AAAAAAAABrUt@)JWP","SaveState_spm/gn4_03/1":"ShareData=AX:-JUVH5=ALSFp8hRK]U!9!_AAABrUVH5=AIH0DV|$XYS{~V7AX:-JUs}]sWP","SaveState_spm/gn4_04/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AT[IEV[6R;AAAAAAAABrUh$O[WP","SaveState_spm/gn4_05/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AT=T&V[6R;AAAAAAAABrUXSPbWP","SaveState_spm/gn4_06/1":"ShareData=AX:-JUVH5=ALSFp8VEPB98TeWAAABrUVH5=Aaei1V|$XYS{~V7AX:-JUd:UMWP","SaveState_spm/gn4_07/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AE,yyV[6R;AAAAAAAABrUXSPkWP","SaveState_spm/gn4_08/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AO(=EV[6R;AAAAAAAABrUn3{yWP","SaveState_spm/gn4_09/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ASF3yV[6R;AAAAAAAABrUXOVLWP","SaveState_spm/gn4_10/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAP:UNUeaJE8p[FSV[6R;AJSkaTn(y]UhlmMWP","SaveState_spm/gn4_11/1":"ShareData=AAABrUVH5=AAAAAAYuFI+5P5ZAAABrUVH5=AU:~RV[6R;AAAAAAAABrUVMTiWP","SaveState_spm/gn4_12/1":"ShareData=AAABrUVH5=AAAAAAN?P8=a~!bAAABrUVH5=AXNZ2V[6R;AAAAAAAABrUWdC8WP","SaveState_spm/gn4_13/1":"ShareData=ANBz(UVH5=AJh@:8g!Bj+CunXAAABrUVH5=AL1b!V}HHyS{~V7ANBz(Uhe{)WP","SaveState_spm/gn4_14/1":"ShareData=AAABrUVH5=AAAAAAN@8UVtfI:AAABrUVH5=AX6,PV[6R;AAAAAAAABrUXS8@WP","SaveState_spm/gn4_15/1":"ShareData=AAABrUVH5=AAAAAAO|Al=a~!bAX:-JUgZ=T8LJUJWPAa~ALSFpTU0A;UXg]fWP","SaveState_spm/gn4_16/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAT+{1Uenj78xY-VV[6R;AJf+{Tr@bcUYk0]WP","SaveState_spm/gn4_17/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AWEDIV[6R;AAAAAAAABrUpv{qWP","SaveState_spm/go1_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AOI&V+^q,aAAAAAAAABrUp)0AWP","SaveState_spm/go1_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ACC=5VtfI:AAAAAAAABrUtYnuWP","SaveState_spm/go1_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AMP_t+^q,aAAAAAAAABrUhVK9WP","SaveState_spm/he1_01/1":"ShareData=ASu0|UVY@hTUij:8~Q|5Wejpl5QFz6Ug7[sT2qMvV{zz)T~4![8^zg:UrV^$WP","SaveState_spm/he1_02/1":"ShareData=AD/^+Uf0ucS@_$L8w[gB=~iAK59Fc0UhXUQT[+gTV|;n_TgxE08}4H(UXTkQWP","SaveState_spm/he1_03/1":"ShareData=AD*F=Uhr(qTKsf38n/XMVZrG;P74~fUi4C$T/3)eWE!qlTu_Z98-[;mUg:2TWP","SaveState_spm/he1_04/1":"ShareData=ATG|DUwfXE8OJ_RT6b*4Wl=uGQN4R/UY2ShUN=nRV*Au-8,;lq9XbDCUr!q]WP","SaveState_spm/he1_05/1":"ShareData=APe{JUuMhK8Otd@TpEhv=t]oE5jbyPUZybVUI=w,WEfx)8+3JJ9OY,XUbt}7WP","SaveState_spm/he1_06/1":"ShareData=AYt:DUi8tM7$9F+TZUYHV5cw&PEUI*Uj~X?T1fp,V0YN{865yJ8|7hUUm*hlV[","SaveState_spm/he2_01/1":"ShareData=APxILUf0h0TB0;o8z~tEW=k8X4(-lDUrl65URM+MWcpwyTgh]C9c23YUftAzWP","SaveState_spm/he2_02/1":"ShareData=AWZ9)UWyM1S5,a28WnE5=z_lV5Zx[dUZFqlUF4n1WYC_)THHSG9Iz$*Ue|u@WP","SaveState_spm/he2_03/1":"ShareData=AH5)YUh==-7@8&JTgTwM=V:k25kI[RUjsaXT~R&!WFnjf8+3vE9ErGMUjINvWP","SaveState_spm/he2_04/1":"ShareData=AWr]{Ujs]FSqp-P8h]0I+q?9g4F{tsUoi&ET1KTfV3nXCS^7yQ8/9_LUbdW|V[","SaveState_spm/he2_05/1":"ShareData=AP$aOUo*C]TInYl8w=|mU4hEEO!-DUUg@@xUJ1?iV}A8KTzh2Q9O5H]UlJtMWP","SaveState_spm/he2_06/1":"ShareData=AAABrUVH5=AAAAAAGcTiVtfI:AAABrUVH5=ACx_:V[6R;AAAAAAAABrUap0,WP","SaveState_spm/he2_07/1":"ShareData=AY]hRUoFC?7oxk}Tk_HNVgNx+5Y]|OUlc=pT&X5AV}0hL81f8F8:(mAUtUfeWP","SaveState_spm/he2_08/1":"ShareData=Aa!;mUg?qnQcF$uQspXm+RT]b5k*(MUc?Z=T=atiWM9i+5cPWh8{zsPUsM^bWP","SaveState_spm/he2_09/1":"ShareData=ANBz(Uk|B[7+epGTNrBEVCAi9N8)ZSUiez{T0jh]V}HHy8LT6U8:iceUu@D&WP","SaveState_spm/he3_01/1":"ShareData=ARfsaUud58UCDUD9tCjfV(ckkQO*?OUW-kdUFNXaWRLK$Usm)f9Lq&MUeGacWP","SaveState_spm/he3_02/1":"ShareData=ATBQ?Ukz81T:MhN9c=]xWhs:2Q:!_cUcO:iUTW_IWD$d{UR3:d9dh[cUkAS6Wq","SaveState_spm/he3_03/1":"ShareData=AM69CUo2MXT91dQ9hRqeWhNQ!QnMQ^Ut!!wUN&X/WGh[YUt@=79Z3*lUf[GiWP","SaveState_spm/he3_04/1":"ShareData=AM7h!UmME7S63Gf8if[RWN6j;QWVEMUb=NOUOZuHWAqd}TU3HA9HgXQUV@7$WP","SaveState_spm/he3_05/1":"ShareData=AYA$LUZSLv7W@HMS|t:CVkR8DPnEDiUuU-uT:9FaV{Be}8ef219FB]7UloHBWP","SaveState_spm/he3_06/1":"ShareData=AII!2UlxnsUPj9)95fL[=l[C956@p~Ue]7ST{6JXWV1UAUwB?~9IDDHUiqkOWP","SaveState_spm/he3_07/1":"ShareData=AYXO}UX4ZgUNunE9j7ay=mrP:QYpDRUY@g7UJ86kV@YRRUcj*b9U5j]Ut:DtWP","SaveState_spm/he3_08/1":"ShareData=AKu*gTlE7-UE25B9v|Uy=4U@r5&QY,UrHI~UQa,sV$176UliS67*$}tTaou4+C","SaveState_spm/he4_01/1":"ShareData=AXV0:UpBqhTW35n88+f2Wd?+n5dGm]Uqb5NTz6~/WIXwnTe2Fb8[TYnUb|^uWP","SaveState_spm/he4_02/1":"ShareData=AD{ICUgm9ETn*xI9bRBeU7|hOQIfDhUwOC-T~)E^WL[j)T|DB&8,@HWUZD?:WP","SaveState_spm/he4_03/1":"ShareData=AKmvsUv/1]StV+18o5hsWg=Dn4)F0:Uko_PTlww3WIS[LTcI1;8yv6AUXG8VWP","SaveState_spm/he4_04/1":"ShareData=AX:-JUoM}P7Y:eeTTM(?+5P5Zy~K77Uvan4T4X/,V|$XY8gG_~9E734UgkeJWP","SaveState_spm/he4_05/1":"ShareData=AAABrUVH5=AAAAAAW892WPAa~AX:-JUgZ=TTC9{eV[6R;ALSFp8gkxaUkeXeWP","SaveState_spm/he4_06/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AJ*:,V[6R;AAAAAAAABrUiRBgWP","SaveState_spm/he4_07/1":"ShareData=AAABrUVH5=AAAAAAQtg*+^q,aAX:-JUgZ=T8Z/oNV[6R;ALSFpTU0A;Ufp@$WP","SaveState_spm/he4_08/1":"ShareData=AAABrUVH5=AAAAAAD&~zVtfI:AAABrUVH5=AMB]u+5P5ZAAAAAAAABrUgiX8WP","SaveState_spm/he4_09/1":"ShareData=AQiemUoauETnTiA9E?Eo=XmsD5FVCTUt!ESUP{48Wb2/|T~lxP9VJ@,UuaB?WP","SaveState_spm/he4_10/1":"ShareData=ARuZnUc;bNT?g1U9KUrI=dge850ho;UmW;nULT71WeZeyT|GuD9XhK=Ugx!}WP","SaveState_spm/he4_11/1":"ShareData=AB^geUkZ2BT+F6N9Oqd|=p4:GQN_X?UZOwmUB$WkWbzNYUJPE:9Xd)0Ufw9SWP","SaveState_spm/he4_12/1":"ShareData=AX:-JUoJUFRn0x(TF3;=+5P5ZAX:-JUgZ=T8S;ApV|$XY8SC6pTQ|ziUh3OrWP","SaveState_spm/kri_00/1":"ShareData=AQ9Y*8s&dtT-34~9zGL@=O-|MQm$KDUcLO}T5KXGV1D5{Uf&LWS;=h!8lU7:+5","SaveState_spm/kri_01/1":"ShareData=AW5J98_7*AT6[T|94x;,=W@E95fFb)Uk,-:T!SxqWFxXcUgrAmTRAHW8)WULVS","SaveState_spm/kri_02/1":"ShareData=AHPsv8uqJ6Tu=mh96HcE=E4__Q57K1UeDHLTsW-DV/3j(Uoc7aSy6F(84|LZ+d","SaveState_spm/kri_03/1":"ShareData=AGsclTs1QH842[99uhJj=xwk:5PIBWUXu*W8qpKDV;i3xUhew*SneE8TaAuY+d","SaveState_spm/kri_04/1":"ShareData=AUgI{9C,XqT,DW[90*@g=NQ0z4^Cl[UtbeRT0k]8V,aJZUdpg4TTY3[8_pBY+^","SaveState_spm/kri_05/1":"ShareData=AO4G9T9GjWT035L9lH[8=k]^mQ20;]Uh3=cT9L-PWBDOLUt+9{8fB$ET&:V(+^","SaveState_spm/kri_06/1":"ShareData=AA(/R81&x~T&UyF9ws|[=R1YjQY;edUi,$AT20;HV*e,}Ulo-,S)*uC83@0e+5","SaveState_spm/kri_07/1":"ShareData=AMr3~TNa69T]8EX9q{/q=duG+5T{QmUq(3eT_~+LWH[vrUlh*x7u!SoTDg4L+^","SaveState_spm/kri_08/1":"ShareData=AV2Go7,2u}TnPC-9qGZi=M8A(5HQwbUValrTpQM8V/-(GUYdtvR596-8F4C~=a","SaveState_spm/kri_09/1":"ShareData=AF+G$T+xQ[UE9NO9wp@6V(C+E5;1ZGUqsf9ULvBuVubWSUWaS|89UrHT$UIb=a","SaveState_spm/kri_10/1":"ShareData=AB9s6T3/,BT+|Wt9j~)2==9WP56,jTUbQ(/T,{;|WF,^SUgPE}8d9ijT~KjvWP","SaveState_spm/ls1_01/1":"ShareData=ABkA4UZmQRTxH,/9rA2Y=2qvQ4zjspUot59T@A~&V{k&oUsW$G8=HFiUv0|eWP","SaveState_spm/ls1_02/1":"ShareData=AC}DpUwdg5T8g/V97M3p=pxzoP@T:jUk4G/T@^LMWo&LZUk|,i8$d5JUY30hWP","SaveState_spm/ls1_03/1":"ShareData=ATi(]Utl-}T2;Lb9nU$e=,E~DQX}F4Ui|{ST1N)7WlsFbUsvB/8)gN?Ui+ABWq","SaveState_spm/ls1_04/1":"ShareData=AMwxwUhWyqTz_}a9pQgy=nmj|QRk;aUfkyvT8XBNWnDt6Ul]dq8]w--UeuF0WP","SaveState_spm/ls1_05/1":"ShareData=AClM[UnnpOT71Ef9ha5C=l{Kb5Ye2_UfWQHT=ZapWNI2OUbT*K9D-bvUc/t(WP","SaveState_spm/ls1_06/1":"ShareData=AATkTUuBblT=s+&9i9|4=4aMgQ0QIRUg8$GUPcSGWD500UpC;P8)0DOUaI~oWP","SaveState_spm/ls1_07/1":"ShareData=AEF}tUm|;7T[Z7+9x@~n=$&p14{LxSUY-G]T:JoOWH0^IUkvmW8=vR$UWgVXWP","SaveState_spm/ls1_08/1":"ShareData=AZAPpUfgC3T5v+o9rEN1=5Enp5Wit0UX*g&T?W2pV$KADUbT|Q8{[joUZWC7WP","SaveState_spm/ls1_09/1":"ShareData=AL)f-Ur]saT@}k29rl(J=/TqnP8iAAUl83}T^ZwqWa(HZUwiSM8:b_1Ue?aYWq","SaveState_spm/ls1_10/1":"ShareData=AQ?OVUdbQITr]459zXo-==ESKP*yL?Uu(gbTueg&WQ&|@Udsm]8wsB&Uq]hjWq","SaveState_spm/ls1_11/1":"ShareData=AEfFZUX)/ST3o,e9Q|FE=kYdlPs,7bUt2wUT(l[hV^^ACUQ*hB8!;M}UX_(CWP","SaveState_spm/ls1_12/1":"ShareData=AZ3R|Uv{{CT&m{690+b-=o{1DPq69SUfEEFT/+1]WC3;fUs,NV8;[?*UX4y]WP","SaveState_spm/ls2_01/1":"ShareData=APi+yUs1b1T(FpY91[{4=7BB^5h{HsUiNo{T(8kGV)-D~UWh(m8[qOYUVZ14WP","SaveState_spm/ls2_02/1":"ShareData=AMIf7Ud+kRT~=_r9Qmc~=dDKAQKjZSUq-!,UQH^HWo)O}UU*m!9d]{7UriofWP","SaveState_spm/ls2_03/1":"ShareData=AMs3=Uoxe4TpwtU9K7}M=KX:Y4__DiUuSDsT[$@HWN)X^UBRJD8/hdlUlnpmWP","SaveState_spm/ls2_04/1":"ShareData=AE$jeUlCjFTzzJ$9VjqR=fG~_5q[e2Ugg2pT]g?bV^v8|UA&?I9BckTUm0I$WP","SaveState_spm/ls2_05/1":"ShareData=ATaGAUtpZ3T]:QE9eg3g=jJ(}5ncjgUh-~dT$Q60V*y$FUAVkd8_tFIUkp8+WP","SaveState_spm/ls2_06/1":"ShareData=ATb?_UrGb&T=!f/9UPCP+^7$s5ewH!UrVpTUBb_3V[:gEUSedi8$R4zUgfp}WP","SaveState_spm/ls2_07/1":"ShareData=AZYp8UdZSPT?d1e9n=In=6Dn(5LVS=Ub89[T0{S9WjX:QUb|iC8;/3NUh)J6Wq","SaveState_spm/ls2_08/1":"ShareData=AH4/9UY^]*T!P729eZ:;=!6U?Q3/~DUen&0UAd08V$ur}UBOhx9g=?FUfWMWWP","SaveState_spm/ls2_09/1":"ShareData=APJxzUnWcqT3kR@9i_IB=dDg05g^&wUVLPVT,GD1WFy,eUf0]^8(pN3UhOxlWP","SaveState_spm/ls2_10/1":"ShareData=AJk~1UklTqTx?e99PDgn=H7dfPNa)RUjML@T@:zeV@L~gT}u6;9BbfOUlbJ*WP","SaveState_spm/ls2_11/1":"ShareData=AKlzDUhx1zT+2DY9X1io=Q$C*5c65}UlHe@T;9[DWFFdSUE:KT8$S3|Uj^WWWP","SaveState_spm/ls2_12/1":"ShareData=AGilJUfc5wTfIzZ9GXU5=J[G94]2k4Ug7[sT//2TWL6BCUCeY(8^aofUm-t0WP","SaveState_spm/ls2_13/1":"ShareData=AWT75UmetvTqZt!9dRVs=I)||PK[;,UW^E:T9mHYV*TACT)l@}8-}KYUr?L$WP","SaveState_spm/ls2_14/1":"ShareData=ACwd4UvP0OT=8wp9e{/R=vA&QP(z:*UYsgTT_6D)V{yA[UQOOO8^U?bUYm8VWP","SaveState_spm/ls2_15/1":"ShareData=AK-~GUs{NhTbRsg9Il:O=xO|N4?gX]UrYIxTi6U)WE=LPUUoE18waFSUe$nZWP","SaveState_spm/ls2_16/1":"ShareData=ABCnhUWHOKTwDEK9LI1?=xw5!4jPkVUeAgKT+6tpV(wz:UC1?t8;AkPUXMf/WP","SaveState_spm/ls2_17/1":"ShareData=AFn{;Ut62DTk?Yr9Rurc+^2&cPe~wNUd5YXT5g6qWNCCOUL/Oo9Co0~Uk&DrWP","SaveState_spm/ls2_18/1":"ShareData=AQ)PWUn_;3TjeM=9f_}w=Sp~qP2{AZUiez{T1C7mV{WwbUGMbx8/VWzUXSTNWP","SaveState_spm/ls3_01/1":"ShareData=AXt~zUjyOPT9LvY9P(skWu-p6P2}X8UjsaXT:9_6V^FQNUO}mH8&?s7UpdqdWP","SaveState_spm/ls3_02/1":"ShareData=AB}w~Ui]6qTefhh9H[I5=x8QuPy]i!UYjaST[t51WLWr^T**ru9C;,(UVaOSWP","SaveState_spm/ls3_03/1":"ShareData=AH5)YUjziPSi&b88t+m6=h[iI5JRtHUd:)[T8YG1WC:3GTjQGD9FeMHUo+FKWP","SaveState_spm/ls3_04/1":"ShareData=AR$|zUh?HcTZbfx9Hu[x=iO^Y4Xuq$Uvjt5T--LYWmRK[T)oDP8~ix3UwWL}Wq","SaveState_spm/ls3_05/1":"ShareData=AX~UpUWKQATV8|U9LCYX=I2qjQDN|0Ub$4$Tiwz;V^!;DUSZ]*8sGd/Ufd3[WP","SaveState_spm/ls3_06/1":"ShareData=AaG2jUp]2UTnR)l9KWuY=J3:[PcPCzUdf3;T$0fzV}KvjUDcM;9B@j/Uh?3XWP","SaveState_spm/ls3_07/1":"ShareData=ACQDWUpX1RS~r?E8,x3o+pT}-PTcoFUoCV$TwG:6V@:9@T3jyg8xT)wUh*xPWP","SaveState_spm/ls3_08/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AV|x*V[6R;AAAAAAAABrUuNk|WP","SaveState_spm/ls3_09/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AF!=$V[6R;AAAAAAAABrUv0gLWP","SaveState_spm/ls3_10/1":"ShareData=AAABrUVH5=AAAAAAHLMI+^q,aAAABrUVH5=AJF9fV[6R;AAAAAAAABrUo1,uWP","SaveState_spm/ls3_11/1":"ShareData=AAABrUVH5=AAAAAAJT$F=a~!bAAABrUVH5=AQ0I]V[6R;AAAAAAAABrUhYI6WP","SaveState_spm/ls3_12/1":"ShareData=AAABrUVH5=AAAAAAOTiY+5P5ZAAABrUVH5=ANB0AV[6R;AAAAAAAABrUwKA6WP","SaveState_spm/ls3_13/1":"ShareData=AAABrUVH5=AAAAAAUs@X+d]wYAAABrUVH5=ANB0AV[6R;AAAAAAAABrUs/c$WP","SaveState_spm/ls4_01/1":"ShareData=AN}S6Uv+=s7p[AtTn,)hWtW~:P6~{sUeuj&TF9a2WJ=cX83=9V8REcWUv+oTWP","SaveState_spm/ls4_02/1":"ShareData=AChJ7UY{gsTcXH?9eV!c=zKmS4ih(OUa4w_T&;gpWX!0{T{i+78&c6nUkb_]Wq","SaveState_spm/ls4_03/1":"ShareData=ADz]RUjEhiT?1^d9axyc=nWl~Q5DJAUmC@AUE|n|WbUPJUN$J38^$}IUbG])WP","SaveState_spm/ls4_04/1":"ShareData=AK(dwUgm!=T-@mu9Sdu~=b-s$QKgbVUjwj(T@=K3Wl(RwT{DzS8)&|cUa4cQWP","SaveState_spm/ls4_05/1":"ShareData=AF)]CUbA)oTYZN;9I)Wf=iy=^4=w4sUhymTT]Ms:V$Xi3UDQnQ9BM*hUlpq{WP","SaveState_spm/ls4_06/1":"ShareData=AVzFDUv^;PS}&(Q9evR2={P9APoeTbUmY}gTlKR~V}uRlT{{u=8uvO]Ul;t2WP","SaveState_spm/ls4_07/1":"ShareData=AM&t&UhLmk7u-d-TSa_6=mNapPp,-5UY]M@T[-=!V{u+t8f9Fm8{_Z-UjqjNWq","SaveState_spm/ls4_08/1":"ShareData=AXV0:UXOM[S:O$B8s:S{=x~Nu3/MVFUdf3;T4srwWJ|73Tu(nR8(q6xUn38nWq","SaveState_spm/ls4_09/1":"ShareData=AAABrUVH5=AAAAAAHFYF=a~!bAAABrUVH5=AZ)K:V[6R;AAAAAAAABrUVcIcWq","SaveState_spm/ls4_10/1":"ShareData=AJ9x_Ur2PGTq0Jb9GK?&=uM72PK2*[UrnAjT72o/Wbb]8T*aEV8|r6?Uq:-4Wq","SaveState_spm/ls4_11/1":"ShareData=AAJHsUlRgc4*yi|Qnoa$=RHjTQDyW4Ubfa?Ta5{-WWw+,44{^m88g3UUuiv|WP","SaveState_spm/ls4_12/1":"ShareData=AExRbUW,hv48SaX9PP1I=4ax[3(pnvUmQ;T36vteWa|$AT^f-L40y:gUgss,Wq","SaveState_spm/ls4_13/1":"ShareData=AY]AGUi~cESLM]Z8p/0?+8}S[QBVLuUeKL]S}ypYV^);vTk5;I8br/zUe?5CWP","SaveState_spm/mac_01/1":"ShareData=ANrXsUiQALT&@p89be8d=fWx_Q5$sXUcFmaUNYK7WUo!=UC!z59Vs~OUs3cTWq","SaveState_spm/mac_02/1":"ShareData=AAe1pUnrPNT5~)s9GTv9=u1~PQyBp@UWITAUJ(,]V)2DDUOOZI9axM?Uwc+|WP","SaveState_spm/mac_03/1":"ShareData=AZ@A2UBE4gT{lzW9llx!=y|Y46ETQfUd^VZUB2p4WBjx1UcK+69A~:GUELy5V[","SaveState_spm/mac_04/1":"ShareData=AIL-~UEnX~UBsF-94F}6=Sx(nQ6+[EUd[-uUM6;zV[T{sUpDK[8-yr4UGEo)Vt","SaveState_spm/mac_05/1":"ShareData=AO&TVUns&0TB~j39Ea]/Vvi-GQ2r+[UiiUjT4r8UV}LWUTz94g8(0~)UqpW_WP","SaveState_spm/mac_06/1":"ShareData=ALH+rUXXvp8R){ITzjbP=h=ls6H:GBUWDs2T@{gyV|_[A8kxL)8;~yXUivQ8Wq","SaveState_spm/mac_07/1":"ShareData=AWZ9)Ur}FoSk&|@8T_2O=d*GHQb4~PUd^qaT3dnBV(QfuTDWi|8*QcXUe}OAWP","SaveState_spm/mac_08/1":"ShareData=AW?G^UZf]17,9xDTSvR]V~WA@Qu!,6Ub:e^UD(K[V@L3H8a-D79ORN-UW6evWP","SaveState_spm/mac_09/1":"ShareData=AOorjUYMUvT&y]|9o&J/=sPQH5/j/+UlrA4T81PJWN/V*UcEbV8_Ue0Ub*s(Wq","SaveState_spm/mac_11/1":"ShareData=AI:h0Umgm;T&y@I9P1mC=fOB5QyDZpUj}UkUP+wwV*(5!UUQ-a9MgzfUeDD}WP","SaveState_spm/mac_12/1":"ShareData=AFmrdUny1;80ZhfT)~6-V,}Tj5Uc9TUdIQ^UOR+GWLIqo9M{@y9P}t1UmCydWP","SaveState_spm/mac_14/1":"ShareData=AG2g@Uhge,S{q~=9Avy/=cCORQpf0)UY,u-TidlJWcL}iT8TiP800:LUtPKkWP","SaveState_spm/mac_15/1":"ShareData=ALaK0UjNl(8HL~=Tkt&vWF]h!4;R{lUVxWjT$$9rV@TZE8tG^-8;1S[Uil,4WP","SaveState_spm/mac_16/1":"ShareData=ADr,7UsYz;8ea1OTaf{,=i;Fk40@hzUXH~~T6iPuV}s018wQfV8@1yZUqNjWWq","SaveState_spm/mac_17/1":"ShareData=AYTDNUjH|N76_PRTGh][WQ[*FP9-BRUg7/LT/q~*WCRq48SJve8^_dkUWutlWP","SaveState_spm/mac_18/1":"ShareData=AWZ9)Uj6i679BG]TMhO?V;{n0PxYcfUknu-T68ZhV|a+I8XWOK8?_XsUh//}WP","SaveState_spm/mac_19/1":"ShareData=ADtu/94MM[TtoZH9mos}=Aj[j50QHPUdlr0T0-B|WKb)|UvrNGT-dNu9zhIp=2","SaveState_spm/mac_22/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AN~@TV[6R;AAAAAAAABrUVH5=AA","SaveState_spm/mac_30/1":"ShareData=AFdMk9kVt?TyE@*9i+p_=ZuEf5;|dGUdz;HTgVNeVw,E4UWx}UTvP!}9h8[o=a","SaveState_spm/mg1_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AZwydV[6R;AAAAAAAABrUc8h:WP","SaveState_spm/mg2_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AR@nNV[6R;AAAAAAAABrUsp]:WP","SaveState_spm/mg2_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ACc~5V[6R;AAAAAAAABrUo(SHWP","SaveState_spm/mg2_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ABfchV[6R;AAAAAAAABrUgSLZWP","SaveState_spm/mg2_04/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ACs;BV[6R;AAAAAAAABrUnbM?WP","SaveState_spm/mg2_05/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AGh/dV[6R;AAAAAAAABrUq~=9WP","SaveState_spm/mg3_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AaaVs98TeWAAAAAAAABrUi3|_WP","SaveState_spm/mg3_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUoJrcWP","SaveState_spm/mg3_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUiQRBWP","SaveState_spm/mg3_04/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUY32tWP","SaveState_spm/mg3_05/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUe2p9WP","SaveState_spm/mg4_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ARxVzVtfI:AAAAAAAABrUr{}[V[","SaveState_spm/mi1_01/1":"ShareData=AZOeVUpBwfUIbgz96dCp==T$jQ2lPyUe?zfURyomWUbTKUnb:W9PE}aUshUtWP","SaveState_spm/mi1_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AaV$oV[6R;AAAAAAAABrUda?xWP","SaveState_spm/mi1_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AI-NlV[6R;AAAAAAAABrUqNT&WP","SaveState_spm/mi1_04/1":"ShareData=AE$CxUmg9FT-VGf9eLJ[=COp{P4wH4UmFQzUSb5)Wd3{EUGr+U9PP,dUkY86WP","SaveState_spm/mi1_05/1":"ShareData=AWHx&Uq?6nSl=kW8g0pk+t/GaQcy3eUj|C7T7e7|WJsKbTTy;r8{KOmUuR{lWP","SaveState_spm/mi1_06/1":"ShareData=ANBz(Ukr8RSHBEJ8S:-H+0i6qPoeTbUlliYTx}/xV*;UmTFo!h80&ygUwdo1WP","SaveState_spm/mi1_07/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ASfjDV[6R;AAAAAAAABrUqOKWWP","SaveState_spm/mi1_08/1":"ShareData=AVv_CUVg=VTyu~Z8!zgR+0Z|(5H$jNUZgPTUSa*pWU3XTT(HP:9Yla3Uhw0?WP","SaveState_spm/mi1_09/1":"ShareData=AT{p5Us@KjT1DCA9RWjv=Qv}W5sE3tUea!cUK=yRWBPzkUP&Qy9Z9l=Ut|r6WP","SaveState_spm/mi1_10/1":"ShareData=ARL0HUm;DnT/&Gi9YpQ1Wp6f1QNndNUWANHT|,&UWSL7|UB$a59GenWUkyo:WP","SaveState_spm/mi1_11/1":"ShareData=AMOG5Uvt}QT9lLn9UQs(WsghJ5,e/JUeshcUDXrkWj,NMT(}+39ge2AUjCkhWP","SaveState_spm/mi2_01/1":"ShareData=AaO6CUeU-gT[9q;9c)=8=TCu9Pp}+)Us)VnULK!SWp~kdUU6!V9ZYmnUbpRJWP","SaveState_spm/mi2_02/1":"ShareData=AbJieUd{dxT-j@V9SE;m=k1Q1QZCUxUmYLgUQB[hWN[x$UTX]!9GwVBUrkO4WP","SaveState_spm/mi2_03/1":"ShareData=AVVM)UelqqT+HIK9f+HW=fiG]5pD-sUhQQ}UGc7OWRjJYUAQ,49VQ=/Ugx(}WP","SaveState_spm/mi2_04/1":"ShareData=AYlJNUf0B?8BFQrTvO;D+$e9M5iROqUja=:T{qxdV(m468lWi/9UtgmUtBm0WP","SaveState_spm/mi2_05/1":"ShareData=AQrwTUqYDN9Z=frUSz,JWN]]x5ns~2Ubt|!URCz$Wg7F79Imx*9eW$:Uu(jDWP","SaveState_spm/mi2_06/1":"ShareData=AM;n$Ud(hDS/P[D8MK}1=L^RGQS2mfUrVpTUHZ0oWmywNTMDnj9fH=jUV9=eWP","SaveState_spm/mi2_07/1":"ShareData=AFL$jUmqq^8[]S7UCY2F=J_;94{p7KUY5@yUPZ*cWNQ@=9LgzL9S1*3UeF*aWP","SaveState_spm/mi2_08/1":"ShareData=AAABrUVH5=AAAAAAN$is+5P5ZAX:-JUgZ=TTIU|OV[6R;ALSFp8gkxaUYs;qWP","SaveState_spm/mi2_09/1":"ShareData=AH:AZUoK]3SiO5&8v0]4+1XDIPo!xgUjsLGTbPX1V^7y+Tgfzb8vn?+UYXztWP","SaveState_spm/mi2_10/1":"ShareData=ADr54UdvevSOk$c80hrA+9u5kQds&5Us,|yTOe-zWJH7TTxANy8ji!jUq{&FWP","SaveState_spm/mi2_11/1":"ShareData=AO(h2UaQKjS-_I-8|KC,+7LP$QI:blUsJdaT2RTxWC^M|T0xnp8}kefUgE^PWP","SaveState_spm/mi3_01/1":"ShareData=AAABrUVH5=AAAAAAIhJFU!9!_AX:-JUgZ=TTI[TEV[6R;ALSFp8gkxaUu5gCWP","SaveState_spm/mi3_02/1":"ShareData=AH:AZUi}mC7*AlgTwz?QVrIAT434EQUkXDfT7{RGV^ys98tWWM8(OLIUb(AuWP","SaveState_spm/mi3_03/1":"ShareData=AQ=;UUar(t8g;Y;Tuebs=W/s7PZ&pwUlxx/T{y&:WPTGx8mwq99T*4@Unnm(WP","SaveState_spm/mi3_04/1":"ShareData=AHe9VUX(pO8foVwTc)F}=UZrqP,/:sUr-$8T(_&}WAK@,85UH|9TVqXUlqC-WP","SaveState_spm/mi3_05/1":"ShareData=AX:-JUv!jH7i)q0TXsw=U^gp/PO)&CUb7!(T,Ek,V{u9C8NJ1M8_XdWUgKgPWP","SaveState_spm/mi3_06/1":"ShareData=AO;-kUm?sfTnkHw9B*ll=a1tX4-U=lUjIz_UHGF4V]WFfT7Pqn9F5=QUl}C_WP","SaveState_spm/mi4_01/1":"ShareData=ANT=*UtsM*7}K}}S}JP6=ARL@P$VeXUean7UU!!]WV1eZ8Ja{S9f@bkUn2?MWP","SaveState_spm/mi4_02/1":"ShareData=AX:-JUmo2p7_KXtTVCfL9|q1rPLhN?UW4?-T~sBnV^AdZ8i]Y(9EM=HUWn9oWP","SaveState_spm/mi4_03/1":"ShareData=AKv1tUg8LK8Sk:mTqD$NVscMb4,vb5UYmI3UCJ:RWG)^^85T@|9O+Z7UrLiRWP","SaveState_spm/mi4_04/1":"ShareData=AWi:*UgZCOS;CO-8j)2aU[vVg4O_ZEUeRPZURWK_WYwK^TCZa?9W(c:UWdOyWP","SaveState_spm/mi4_05/1":"ShareData=AP:UNUasIBTF[i[84wcA9,K1+O!NfrUhii4T^bVsWYS=KTghQJ9H^hnUV8&)WP","SaveState_spm/mi4_06/1":"ShareData=AK47uUW$//TPU~q89f|oVy^oxPc?iSUi7MgUB:-/WiD{|TpV*49T!tNUg5$vWP","SaveState_spm/mi4_07/1":"ShareData=ANBz(Uc)SF8F^_aTTDlj9+5R34DxkeUj]v6T*?!bWYiQz8Lv[?9dB)AUs+AoWP","SaveState_spm/mi4_08/1":"ShareData=AY3VPUkAR2TYI&]8bSnZUiI]MPQuGMUh={zT)6X2WRDZYTjHof9Mq++Uo]ubWP","SaveState_spm/mi4_09/1":"ShareData=AXx0HUo4]i7wG]zTLu1(=BluNQFS;1UqeIjT)Qr@WYZJH8bBcv9c_p&UYZ1oWP","SaveState_spm/mi4_10/1":"ShareData=AH5)YUf55LTMU$*8z9-1+LGrX4hURbUi${/UN)6(WbB7=Tf3cE9dA$3Uvd*kWP","SaveState_spm/mi4_11/1":"ShareData=AWi:*UgBGLS[ve48eYv&+SARqO-=:~Ug@i1UT2Z]WYnE|TGntc9bMyHUwZ;XWP","SaveState_spm/mi4_12/1":"ShareData=AX:-JUmFl=SyE-h8UX_?+4IICPHVhAUd20sUCg*AV^AdZTDc[V9b3baUhEg@WP","SaveState_spm/mi4_13/1":"ShareData=AAABrUZ9!$Oc(ot4x!xGVo/JO4ik)MUct]GUA_9EV]k3{PQTB]9TSsbUaj7HWP","SaveState_spm/mi4_14/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAATugJUnniNT1]eoV[6R;ASf9j8}~jcUtP)!WP","SaveState_spm/mi4_15/1":"ShareData=AY3VPUd/_QS/L]P8TAntVF]HyPA0]]Ug@3yUL|0~WRDZYTnu4)9XWShUb~]ZWP","SaveState_spm/sp1_01/1":"ShareData=AYlPPUbU?4Siix=8L[|EVTQ8QPWoX3Uavq-T!{-)Wd+86TAe;q8]T^)Umw5lWP","SaveState_spm/sp1_02/1":"ShareData=AOqJyUmwkD7~-{,T@:~[Wf1*n5FWH8UleWCT/}sZWEE]I8:Mv]8,TCEUdUVUWq","SaveState_spm/sp1_03/1":"ShareData=ANBz(UeLzH7@[5-TN{GWWE+-j4hz_[Ur5_XUQBxvWZM668X]C(9f1IoUnu7[Wq","SaveState_spm/sp1_04/1":"ShareData=AT+{1UsS&ESAEyzTwwLtV{/&}NcH{iUepvt8b~eAV}E*-82It*TCM4+UsHPPWq","SaveState_spm/sp1_05/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AQD{NV[6R;AAAAAAAABrUjw,^Wq","SaveState_spm/sp1_06/1":"ShareData=AX:-JUVH5=ALSFpTTahT=a~!bAAABrUVH5=ANB0tV|$XY8I1/RAX:-JUhRPfWq","SaveState_spm/sp1_07/1":"ShareData=AT+{1Uu5u/R-5HeTkvg/99x*d3Ub!KUgZ=T8g1u^V}E*-83&92TM(;(Um1CNWP","SaveState_spm/sp2_01/1":"ShareData=ANl!}UiXcc7nnj(TQ}1v=k^zPPu+CRUn~$[T-N^UWoZ7d8P+dC9B(8aUf5Q9WP","SaveState_spm/sp2_02/1":"ShareData=AQ=;UUrjbhSuzeq8t4vL+ayh44KLPXUwaZoTt3&cWO$/tTr@!w8qLmQUf$,_WP","SaveState_spm/sp2_03/1":"ShareData=ANBz(UmZBeR_KrUTCj83=cC9bNLu^xUgZ=T8X98XWYiQz8MpA@TGRnSUv;_JWq","SaveState_spm/sp2_04/1":"ShareData=AWi:*Umr$R7-/z0TX9$w9,fVW34-HNUY]M@T@9svWYwK^8VD^X8-N1~Ur7d|WP","SaveState_spm/sp2_05/1":"ShareData=AX:-JUoJUFRn0x(TK_X27Df{oN,QRzUgZ=T8h_0(WaSgZ8SC6pTQ|ziUl_$kWP","SaveState_spm/sp2_06/1":"ShareData=AAABrUVH5=AAAAAAGgJB+d]wYAAABrUVH5=AC&-OV[6R;AAAAAAAABrUor?^WP","SaveState_spm/sp2_07/1":"ShareData=AX:-JUVH5=ALSFpS}GQ!8=XDTAAABrUVH5=AE4(fV|$XY8I1/RAX:-JUt,MgWP","SaveState_spm/sp2_08/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AUh9hV[6R;AAAAAAAABrUnzkPWP","SaveState_spm/sp2_09/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AQiXjV[6R;AAAAAAAABrUpIjmWP","SaveState_spm/sp2_10/1":"ShareData=AENR_Uaqc^7@zPQTr8v^+^}:55lj!jUVfKhT__VyV}s018nSAG9DD@(Ufp=sWP","SaveState_spm/sp3_01/1":"ShareData=AAABrUVH5=AAAAAACR/vWqbj/AX:-JUgZ=T8R&2|V[6R;ALSFpTU0A;Ud/T~WP","SaveState_spm/sp3_02/1":"ShareData=AAABrUVH5=AAAAAAUd@A+^q,aAAABrUVH5=ANB0hV[6R;AAAAAAAABrUuAY^WP","SaveState_spm/sp3_03/1":"ShareData=AAABrUVH5=AAAAAAO@bg+5P5ZAAABrUVH5=ACv9HV[6R;AAAAAAAABrUgFkSWP","SaveState_spm/sp3_04/1":"ShareData=AY3VPUVH5=ACC|oTcvBl+^q,aAAABrUVH5=AFzuFWRDZY8j*)SAY3VPUnNP2Wq","SaveState_spm/sp3_05/1":"ShareData=AX:-JUmiHfR9qHcTN|!}V}=Qt2:T1(Uepvt8Y8W2V|$XY8QSq:TGRnSUdM@nWP","SaveState_spm/sp3_06/1":"ShareData=AAABrUVH5=AAAAAAHn^*+^q,aAAABrUVH5=AWJSuV[6R;AAAAAAAABrUtIyQWP","SaveState_spm/sp3_07/1":"ShareData=AAABrUVH5=AAAAAANDQM+^q,aAAABrUVH5=ALX&QV[6R;AAAAAAAABrUW=e/WP","SaveState_spm/sp4_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AKr_yV[6R;AAAAAAAABrUht=}WP","SaveState_spm/sp4_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AVN]IV[6R;AAAAAAAABrUerctWP","SaveState_spm/sp4_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AXNZ8V[6R;AAAAAAAABrUu4y2WP","SaveState_spm/sp4_04/1":"ShareData=AAABrUVH5=AAAAAANuM^+d]wYAAABrUVH5=AHDd!WPAa~AAAAAAAABrUb1etWP","SaveState_spm/sp4_05/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=Aa3nCV[6R;AAAAAAAABrUtv/qWP","SaveState_spm/sp4_06/1":"ShareData=ANBz(UVH5=AJh@:TJMw8+CunXAAABrUVH5=AM3UgWz9Z08I1/RANBz(Uq/}OWP","SaveState_spm/sp4_07/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ALy^FV[6R;AAAAAAAABrUtIn1WP","SaveState_spm/sp4_08/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AP]EwV[6R;AAAAAAAABrUn4{6WP","SaveState_spm/sp4_09/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=APFY2V[6R;AAAAAAAABrUYrRJWP","SaveState_spm/sp4_10/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ALfsVV[6R;AAAAAAAABrUknm8WP","SaveState_spm/sp4_11/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AT52WV[6R;AAAAAAAABrUbzGvWP","SaveState_spm/sp4_12/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANB0PV[6R;AAAAAAAABrUfr-zWP","SaveState_spm/sp4_13/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANB0tV[6R;AAAAAAAABrUb&aRWP","SaveState_spm/sp4_14/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AUa!|V[6R;AAAAAAAABrUbrAdWP","SaveState_spm/sp4_15/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAANBz(Uepvt8VkH,V[6R;AJh@:TJ/]0Ukbn{WP","SaveState_spm/sp4_16/1":"ShareData=AAABrUVH5=AAAAAAG{[r+^q,aAAABrUVH5=AN76YV[6R;AAAAAAAABrUXq^rWP","SaveState_spm/sp4_17/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AAAAAAAAAAAAAAAAAABrUtIxdWP","SaveState_spm/ta1_01/1":"ShareData=AF4fCUiepLT2jU$9G&lk=k;2(QZ3nUUq:T!UI6pDV^;NiT|rH[9F~{}UrL:9WP","SaveState_spm/ta1_02/1":"ShareData=ADJx|UogW!T1*[I9TF8+==G+W53}1(UmFeGT{x@ZWLQMGT|ly29Sv^rUj=S3WP","SaveState_spm/ta1_03/1":"ShareData=AOtQmUs$7~T8x5k9GrRL=H:I:P}X[sUm8jkUGlnoWLmdvUR3n^9To@wUcBc/WP","SaveState_spm/ta1_04/1":"ShareData=AEfFZUf)06Tz&Tu9TIIaWdX3D5Bt[5Uq-56UBEPFV^@)BUMVQb9c^N9UW|f*WP","SaveState_spm/ta1_05/1":"ShareData=AY-bQUYW5LStH6W82R4x+&!^H4}_BPUl_CtT]iV)WMUG=Ttz/A8:8Z|UXAcJWP","SaveState_spm/ta1_06/1":"ShareData=AW0)}UcF+XSq7D(8b2l]Vy=^j4=,;uUhFIOT,nQPWBZ8kTOTU88@4bSUkC&tWP","SaveState_spm/ta1_07/1":"ShareData=AAABrUVJZJ36;*}PasEA+X@+^3ZrRbUr5MlT!$t|WD9hHPfngU8_DGtUmlxAWP","SaveState_spm/ta1_08/1":"ShareData=ANK5)Uh_RsSmUEa8O9T7+qccN5n31jUhctZT$U1LV^[!!S|zPI8/]a}Uke7KWP","SaveState_spm/ta1_09/1":"ShareData=AL~@$UqK1BT+U*89Pz6O=fUio51BCfUYkGfUF}~aWB,eBUF~rF9g?_2Un*RvWP","SaveState_spm/ta2_01/1":"ShareData=AKjQdUb|e+TmsV69alo]W-{w:QZ~m)UwD_bT2A,7WAk=sUAi[(8[JcIUVVQ}WP","SaveState_spm/ta2_02/1":"ShareData=AH2nLUvEA+TX!9C8^iq^V+4$oP(h3(UXdzIT8T11WD)XuT6&]|8=;o;Uf9K3WP","SaveState_spm/ta2_03/1":"ShareData=AIx5_UoJUJTCdGW8@Q{UWeDS/5o-guUjzL~T:hAJWLgtRT_h|@8![3[UikeuWP","SaveState_spm/ta2_04/1":"ShareData=AYA$LUu~i]SV+3P8UQ?-+}LZ0Pgm=fUq[~tTfhuuV)aT,TQc&U83xMzUt9/{WP","SaveState_spm/ta2_05/1":"ShareData=AE+a(UhBW}T!p(K9JnZx=bM7Z5cW2^UiR2LUC)!lWL6xQUL)cj9Y$MiUYyrWWP","SaveState_spm/ta2_06/1":"ShareData=AHkbJUW1_fTXQKU8)zJq=T1f^5FVsrUV|=dT]1v^WC}2lT;bXL8?a98UY{]SWP","SaveState_spm/ta3_01/1":"ShareData=ALrmfUj:*07w(rjT_tD:V6~3cP)+2_UbtW=TlbYnWHb3M8;{F:8kV=XUe|opWP","SaveState_spm/ta3_02/1":"ShareData=ANBz(Umo3^7=H*~TK:!9+!2elPK[;,UXsi[T?AmsV{Kmp8Yrk,8($*{UhE]WWP","SaveState_spm/ta3_03/1":"ShareData=AOqJyUi?ijTApXr8^Fl;+Z}wfPr;DtUjZDmT0ZI:We*6FT,zEE8_+PMUn-rTWP","SaveState_spm/ta3_04/1":"ShareData=AX:-JUuRii7TMU*TL;i{=ZTB}4,^qHUd6]?T0~dBWAzio8PIzF8)M!&UjB=VWP","SaveState_spm/ta3_05/1":"ShareData=AIAMbUYxxbS_8$N8rG,f+]Nip5gSKiUY+sVT7-KNV(/=ITmK{b9AZLaUht(dWP","SaveState_spm/ta3_06/1":"ShareData=AWi:*UsGQ^74k(3TB!ZA=gGN[O}S{AUhymTT-Ws$V}L*}8Z/5Q8];-KUgmDnWP","SaveState_spm/ta3_07/1":"ShareData=ANBz(UdWZuS0Dn(8c$w+Ve;4O4YIjoUokz8T2hIoV{3;uTIM@,8)6wGUrmMxWP","SaveState_spm/ta3_08/1":"ShareData=AUsVyUqNI/Tji249bIjYV[jIr5c3O~Uq={RT:XHMWOHZ7T}fLV9A~!JUlLK-WP","SaveState_spm/ta4_01/1":"ShareData=AMJlTUsjTUTbMc@9KRi/V:6B8QDdJ1Uo6MST$(4gWBhj@UK}:48]kEPUd*C-WP","SaveState_spm/ta4_02/1":"ShareData=AQ=;UUlPGA7$}toTzG)8VB~G|PsN69UkXDfT4z!+WO66r8kZSK9CdGFUWXGDWP","SaveState_spm/ta4_03/1":"ShareData=AQH~3UvM/=TN!3B8)ReJ+{+usQU-FBUVUVWT8~)iWKqoJTz:9,8]n&tUhDY1WP","SaveState_spm/ta4_04/1":"ShareData=AM7h!Uj0p[Sh=668c2PS+]~qbQA9a4UbN(RT+x(6WMUIVTTkj}8?(U/Utx5UWP","SaveState_spm/ta4_05/1":"ShareData=ANK5)Uv=MQ77V/tTNkHDVF|)(O@RW4Ulc=pT+qjdV{|Bx8L]Wr8|8*-UsOOgWP","SaveState_spm/ta4_06/1":"ShareData=AD/^+UVu@xS|w&o88*S+WcWiKP+ZhyUZdW*UB)$pWFR8oTj{329MoV|UV^]@WP","SaveState_spm/ta4_07/1":"ShareData=AajK,UvZhqT-no(9QTK[=Wo(zPZYW^Uh+Q&T2YAdWEII)UUTJw8_TK6UnqeiWP","SaveState_spm/ta4_08/1":"ShareData=AY;tCUmXclT~EAs97&[T=wvh|5qbAwUk7OIT1ngxV@zjUUq[!k8;XykUv)T:WP","SaveState_spm/ta4_09/1":"ShareData=AX:-JUg+GaSa}J-8VjKj+]F+mP7m2dUo/oaTv:|aWAYQlTM8q?84Jq4Ue&9)WP","SaveState_spm/ta4_10/1":"ShareData=ANBz(UV/_=ScINL8S=8/+OT31O-3iIUg&^uT(ndPV}HHyS|/Fj8@gWTUn0SHWP","SaveState_spm/ta4_11/1":"ShareData=AT+{1UrC7676&$~TYq8M+)!OQPY]XEUhymTT=];_V}E*-8ng058?eE/Udt7VWP","SaveState_spm/ta4_12/1":"ShareData=AbI*oUm*HP5UGZ*5sCI}V!eD&QBiwAUj(d[T+EzaV}r:)QwRM99AsEyUWYYBWP","SaveState_spm/ta4_13/1":"ShareData=AH:AZUn4[4S,uBk8yLz]UWt:LPDc8xUa?8OT=/RJV^7y+Tyo$e8_*MKUm7}zWP","SaveState_spm/ta4_14/1":"ShareData=AU@udUgMGyT7/K/9F+:g=GX}MQKo$IUX1O@T,Z;?V@N^hT*-D*8/CjFUpagKWP","SaveState_spm/ta4_15/1":"ShareData=AWi:*UX9JL78D?vTAOCdVU*;x31DmeUrd)iT:i14V}VB|8bW2m9Cc,}UhMotWP","SaveState_spm/wa1_01/1":"ShareData=AAABrUVH5=AAAAAAJGZ0WPAa~AAABrUVH5=AUgmnV[6R;AAAAAAAABrUlG{SWP","SaveState_spm/wa1_02/1":"ShareData=AX:-JUVH5=ALSFpS|aNc+5P5ZAAABrUVH5=AR(}_V|$XY8I1/RAX:-JUb@cZWP","SaveState_spm/wa1_03/1":"ShareData=AAABrUVH5=AAAAAAK1I,VSD^,AAABrUVH5=AXNZqV[6R;AAAAAAAABrUaH9TWP","SaveState_spm/wa1_04/1":"ShareData=ANAltUrwmh8T771T&|JJ=/nAH5fnaSUavq-T0r6lWC?538!m2-8-xIyUm|VcWP","SaveState_spm/wa2_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAWi:*Ue3p(TFrQgV[6R;AJv~P8fD1MUuwCHWP","SaveState_spm/wa2_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AZGt_V[6R;AAAAAAAABrUVY,4WP","SaveState_spm/wa2_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANB0PV[6R;AAAAAAAABrUZkg8WP","SaveState_spm/wa3_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AKq,zV[6R;AAAAAAAABrUtEEbWP","SaveState_spm/wa3_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANB0nV[6R;AAAAAAAABrUo!J)WP","SaveState_spm/wa3_03/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=ANB0GV[6R;AAAAAAAABrUi66@WP","SaveState_spm/wa4_01/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AFBj@V[6R;AAAAAAAABrUua/&WP","SaveState_spm/wa4_02/1":"ShareData=AAABrUVH5=AAAAAAAAAAAAAAAAAABrUVH5=AN{r/V[6R;AAAAAAAABrUo_$tWP","SaveState_spm/wa4_03/1":"ShareData=AX:-JUoJUF6zlNkTP~Dl8=XDTAX:-JUgZ=TTQw1zV|$XY8SC6p8c;O&UtdH8WP"}')},function(e,t,a){(function(e,t){
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var a;!function(a){!function(r){var n="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),s=i(a);function i(e,t){return function(a,r){"function"!=typeof e[a]&&Object.defineProperty(e,a,{configurable:!0,writable:!0,value:r}),t&&t(a,r)}}void 0===n.Reflect?n.Reflect=a:s=i(n.Reflect,s),function(t){var a=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",i="function"==typeof Object.create,o={__proto__:[]}instanceof Array,l=!i&&!o,c={create:i?function(){return B(Object.create(null))}:o?function(){return B({__proto__:null})}:function(){return B({})},has:l?function(e,t){return a.call(e,t)}:function(e,t){return t in e},get:l?function(e,t){return a.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},h=Object.getPrototypeOf(Function),d="object"==typeof e&&e.env&&"true"===e.env.REFLECT_METADATA_USE_MAP_POLYFILL,u=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],a=function(){function e(e,t,a){this._index=0,this._keys=e,this._values=t,this._selector=a}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var a=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:a,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var a=this._find(e,!0);return this._values[a]=t,this},t.prototype.delete=function(t){var a=this._find(t,!1);if(a>=0){for(var r=this._keys.length,n=a+1;n<r;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new a(this._keys,this._values,r)},t.prototype.values=function(){return new a(this._keys,this._values,n)},t.prototype.entries=function(){return new a(this._keys,this._values,i)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[s]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function n(e,t){return t}function i(e,t){return[e,t]}}():Map,m=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new u}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}():Set,p=new(d||"function"!=typeof WeakMap?function(){var e=c.create(),t=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=n(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=n(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return n(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=n(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var t;do{t="@@WeakMap@@"+i()}while(c.has(e,t));return e[t]=!0,t}function n(e,r){if(!a.call(e,t)){if(!r)return;Object.defineProperty(e,t,{value:c.create()})}return e[t]}function s(e,t){for(var a=0;a<t;++a)e[a]=255*Math.random()|0;return e}function i(){var e,t=(e=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e));t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var a="",r=0;r<16;++r){var n=t[r];4!==r&&6!==r&&8!==r||(a+="-"),n<16&&(a+="0"),a+=n.toString(16).toLowerCase()}return a}}():WeakMap);function f(e,t,a){var r=p.get(e);if(v(r)){if(!a)return;r=new u,p.set(e,r)}var n=r.get(t);if(v(n)){if(!a)return;n=new u,r.set(t,n)}return n}function A(e,t,a){var r=f(t,a,!1);return!v(r)&&!!r.has(e)}function g(e,t,a){var r=f(t,a,!1);if(!v(r))return r.get(e)}function _(e,t,a,r){f(a,r,!0).set(e,t)}function S(e,t){var a=[],r=f(e,t,!1);if(v(r))return a;for(var n=function(e){var t=k(e,s);if(!M(t))throw new TypeError;var a=t.call(e);if(!x(a))throw new TypeError;return a}(r.keys()),i=0;;){var o=D(n);if(!o)return a.length=i,a;var l=o.value;try{a[i]=l}catch(e){try{I(n)}finally{throw e}}i++}}function b(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function v(e){return void 0===e}function w(e){return null===e}function x(e){return"object"==typeof e?null!==e:"function"==typeof e}function T(e,t){switch(b(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var a=3===t?"string":5===t?"number":"default",r=k(e,n);if(void 0!==r){var s=r.call(e,a);if(x(s))throw new TypeError;return s}return function(e,t){if("string"===t){var a=e.toString;if(M(a))if(!x(n=a.call(e)))return n;if(M(r=e.valueOf))if(!x(n=r.call(e)))return n}else{var r;if(M(r=e.valueOf))if(!x(n=r.call(e)))return n;var n,s=e.toString;if(M(s))if(!x(n=s.call(e)))return n}throw new TypeError}(e,"default"===a?"number":a)}function y(e){var t=T(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function C(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function M(e){return"function"==typeof e}function U(e){return"function"==typeof e}function k(e,t){var a=e[t];if(null!=a){if(!M(a))throw new TypeError;return a}}function D(e){var t=e.next();return!t.done&&t}function I(e){var t=e.return;t&&t.call(e)}function R(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===h)return t;if(t!==h)return t;var a=e.prototype,r=a&&Object.getPrototypeOf(a);if(null==r||r===Object.prototype)return t;var n=r.constructor;return"function"!=typeof n?t:n===e?t:n}function B(e){return e.__=void 0,delete e.__,e}t("decorate",(function(e,t,a,r){if(v(a)){if(!C(e))throw new TypeError;if(!U(t))throw new TypeError;return function(e,t){for(var a=e.length-1;a>=0;--a){var r=(0,e[a])(t);if(!v(r)&&!w(r)){if(!U(r))throw new TypeError;t=r}}return t}(e,t)}if(!C(e))throw new TypeError;if(!x(t))throw new TypeError;if(!x(r)&&!v(r)&&!w(r))throw new TypeError;return w(r)&&(r=void 0),function(e,t,a,r){for(var n=e.length-1;n>=0;--n){var s=(0,e[n])(t,a,r);if(!v(s)&&!w(s)){if(!x(s))throw new TypeError;r=s}}return r}(e,t,a=y(a),r)})),t("metadata",(function(e,t){return function(a,r){if(!x(a))throw new TypeError;if(!v(r)&&!function(e){switch(b(e)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;_(e,t,a,r)}})),t("defineMetadata",(function(e,t,a,r){if(!x(a))throw new TypeError;return v(r)||(r=y(r)),_(e,t,a,r)})),t("hasMetadata",(function(e,t,a){if(!x(t))throw new TypeError;return v(a)||(a=y(a)),function e(t,a,r){if(A(t,a,r))return!0;var n=R(a);return!w(n)&&e(t,n,r)}(e,t,a)})),t("hasOwnMetadata",(function(e,t,a){if(!x(t))throw new TypeError;return v(a)||(a=y(a)),A(e,t,a)})),t("getMetadata",(function(e,t,a){if(!x(t))throw new TypeError;return v(a)||(a=y(a)),function e(t,a,r){if(A(t,a,r))return g(t,a,r);var n=R(a);return w(n)?void 0:e(t,n,r)}(e,t,a)})),t("getOwnMetadata",(function(e,t,a){if(!x(t))throw new TypeError;return v(a)||(a=y(a)),g(e,t,a)})),t("getMetadataKeys",(function(e,t){if(!x(e))throw new TypeError;return v(t)||(t=y(t)),function e(t,a){var r=S(t,a),n=R(t);if(null===n)return r;var s=e(n,a);if(s.length<=0)return r;if(r.length<=0)return s;for(var i=new m,o=[],l=0,c=r;l<c.length;l++){var h=c[l];i.has(h)||(i.add(h),o.push(h))}for(var d=0,u=s;d<u.length;d++){h=u[d];i.has(h)||(i.add(h),o.push(h))}return o}(e,t)})),t("getOwnMetadataKeys",(function(e,t){if(!x(e))throw new TypeError;return v(t)||(t=y(t)),S(e,t)})),t("deleteMetadata",(function(e,t,a){if(!x(t))throw new TypeError;v(a)||(a=y(a));var r=f(t,a,!1);if(v(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var n=p.get(t);return n.delete(a),n.size>0||(p.delete(t),!0)}))}(s)}()}(a||(a={}))}).call(this,a(75),a(57))},function(e,t,a){e.exports=a.p+"logo-40496a2270a69fdcb86b.png"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(74),n=a(83);t.default=class{constructor(e){this.invertY=!1,this.invertX=!1,this.button=-1,this.onisdraggingchanged=null,this.listeners=[],this.scrollListeners=[],this.usePointerLock=!0,this.isInteractive=!0,this.touchGesture=0,this.prevTouchX=0,this.prevTouchY=0,this.prevPinchDist=0,this.dTouchX=0,this.dTouchY=0,this.dPinchDist=0,this._onKeyDown=e=>{if(function(e){switch(e){case"ShiftLeft":case"ShiftRight":case"AltLeft":case"AltRight":return!0;default:return!1}}(e.code))e.preventDefault();else if(!this._hasFocus())return;this.keysDown.set(e.code,!e.repeat),this.callListeners()},this._onKeyUp=e=>{this.keysDown.delete(e.code),this.callListeners()},this._onBlur=()=>{this.keysDown.clear(),this.callListeners()},this._onWheel=e=>{e.preventDefault(),this.dz+=-4*Math.sign(e.deltaY),this.callScrollListeners()},this._onTouchChange=e=>{if(this.isInteractive)if(e.preventDefault(),1==e.touches.length){const t=this._getScaledTouches(e.touches);this.touchGesture=1,this.prevTouchX=t[0].x,this.prevTouchY=t[0].y,this.dTouchX=0,this.dTouchY=0}else if(2==e.touches.length){const t=this._getPinchValues(e.touches);this.touchGesture=2,this.prevTouchX=t.x,this.prevTouchY=t.y,this.prevPinchDist=t.dist,this.dTouchX=0,this.dTouchY=0,this.dPinchDist=0}else this.touchGesture=0},this._onTouchMove=e=>{if(this.isInteractive)if(e.preventDefault(),1==e.touches.length){const t=this._getScaledTouches(e.touches);this.touchGesture=1,this.dTouchX=t[0].x-this.prevTouchX,this.dTouchY=t[0].y-this.prevTouchY,this.onMotion(this.dTouchX,this.dTouchY),this.prevTouchX=t[0].x,this.prevTouchY=t[0].y}else if(2==e.touches.length){const t=this._getPinchValues(e.touches);this.touchGesture=2,this.dTouchX=t.x-this.prevTouchX,this.dTouchY=t.y-this.prevTouchY,this.dPinchDist=t.dist-this.prevPinchDist,this.prevTouchX=t.x,this.prevTouchY=t.y,this.prevPinchDist=t.dist}else this.touchGesture=0},document.body.tabIndex=-1,this.toplevel=e,this.toplevel.tabIndex=-1,this.keysDown=new Map,document.addEventListener("keydown",this._onKeyDown,{capture:!0}),document.addEventListener("keyup",this._onKeyUp,{capture:!0}),window.addEventListener("blur",this._onBlur),this.toplevel.addEventListener("wheel",this._onWheel,{passive:!1}),this.toplevel.addEventListener("mousedown",e=>{this.isInteractive&&(this.button=e.button,n.GlobalGrabManager.takeGrab(this,e,{takePointerLock:this.usePointerLock,useGrabbingCursor:!0,releaseOnMouseUp:!0}),null!==this.onisdraggingchanged&&this.onisdraggingchanged())}),this.toplevel.addEventListener("touchstart",this._onTouchChange),this.toplevel.addEventListener("touchend",this._onTouchChange),this.toplevel.addEventListener("touchcancel",this._onTouchChange),this.toplevel.addEventListener("touchmove",this._onTouchMove),this.afterFrame(),r.GlobalSaveManager.addSettingListener("InvertY",(e,t)=>{this.invertY=e.loadSetting(t,!1)}),r.GlobalSaveManager.addSettingListener("InvertX",(e,t)=>{this.invertX=e.loadSetting(t,!1)})}addListener(e){this.listeners.push(e)}addScrollListener(e){this.scrollListeners.push(e)}getMouseDeltaX(){return this.dx}getMouseDeltaY(){return this.dy}getTouchDeltaX(){return 2==this.touchGesture?this.dTouchX:0}getTouchDeltaY(){return 2==this.touchGesture?this.dTouchY:0}getPinchDeltaDist(){return 2==this.touchGesture?this.dPinchDist:0}isKeyDownEventTriggered(e){return!!this.keysDown.get(e)}isKeyDown(e){return this.keysDown.has(e)}isDragging(){return 0!=this.touchGesture||n.GlobalGrabManager.hasGrabListener(this)}afterFrame(){this.dx=0,this.dy=0,this.dz=0,this.dTouchX=0,this.dTouchY=0,this.dPinchDist=0,this.keysDown.forEach((e,t)=>{this.keysDown.set(t,!1)})}focusViewer(){this.toplevel.focus()}_hasFocus(){return document.activeElement===document.body||document.activeElement===this.toplevel}callListeners(){for(let e=0;e<this.listeners.length;e++)this.listeners[e](this)}callScrollListeners(){for(let e=0;e<this.scrollListeners.length;e++)this.scrollListeners[e](this)}_getScaledTouches(e){const t=[],a=1e3/Math.max(1,Math.min(this.toplevel.clientWidth,this.toplevel.clientHeight));for(let r=0;r<e.length;r++)t.push({x:e[r].clientX*a,y:e[r].clientY*a});return t}_getPinchValues(e){const t=this._getScaledTouches(e);return{x:(t[0].x+t[1].x)/2,y:(t[0].y+t[1].y)/2,dist:Math.hypot(t[0].x-t[1].x,t[0].y-t[1].y)}}onMotion(e,t){this.dx+=e,this.dy+=t}onGrabReleased(){this.button=-1,null!==this.onisdraggingchanged&&this.onisdraggingchanged()}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(84),s=a(38),i=a(0),o=a(14),l=a(42),c=a(4),h=a(2),d=a(50),u=l.IS_DEVELOPMENT,m=l.IS_DEVELOPMENT;function p(e){const t=s.getFormatTypeFlags(e),a=s.getFormatCompFlags(e),r=s.getFormatFlags(e),n=function(e){switch(e){case 1:return WebGL2RenderingContext.UNSIGNED_BYTE;case 2:return WebGL2RenderingContext.UNSIGNED_SHORT;case 3:return WebGL2RenderingContext.UNSIGNED_INT;case 4:return WebGL2RenderingContext.BYTE;case 5:return WebGL2RenderingContext.SHORT;case 6:return WebGL2RenderingContext.INT;case 7:return WebGL2RenderingContext.HALF_FLOAT;case 8:return WebGL2RenderingContext.FLOAT;default:throw"whoops"}}(t);return{size:function(e){switch(e){case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4}}(a),type:n,normalized:!!(1&r)}}function f(e){if(1&s.getFormatFlags(e))return!1;const t=s.getFormatTypeFlags(e);return 4===t||5===t||6===t||(1===t||2===t||3===t)}function A(e){switch(e){case 1:return WebGL2RenderingContext.ELEMENT_ARRAY_BUFFER;case 2:return WebGL2RenderingContext.ARRAY_BUFFER;case 3:return WebGL2RenderingContext.UNIFORM_BUFFER}}function g(e){switch(e){case 0:return WebGL2RenderingContext.CLAMP_TO_EDGE;case 1:return WebGL2RenderingContext.REPEAT;case 2:return WebGL2RenderingContext.MIRRORED_REPEAT;default:throw"whoops"}}function _(e,t){if(2===t&&1===e)return WebGL2RenderingContext.LINEAR_MIPMAP_LINEAR;if(2===t&&0===e)return WebGL2RenderingContext.NEAREST_MIPMAP_LINEAR;if(1===t&&1===e)return WebGL2RenderingContext.LINEAR_MIPMAP_NEAREST;if(1===t&&0===e)return WebGL2RenderingContext.NEAREST_MIPMAP_NEAREST;if(0===t&&1===e)return WebGL2RenderingContext.LINEAR;if(0===t&&0===e)return WebGL2RenderingContext.NEAREST;throw new Error("Unknown texture filter mode")}function S(e,t=0){const a=e;return a.gl_buffer_pages[t/a.pageByteSize|0]}function b(e){return e.gl_texture}function v(e){return e.gl_sampler}function w(e,t){e.name=t,e.__SPECTOR_Metadata={name:t}}function x(e,t){const a=[];for(;;){const r=t.exec(e);if(!r)break;a.push(r)}return a}class T{constructor(e,t=1024){this.m=e,this.a=t,this.i=this.a,this.b=e(this.i),this.o=0}r(){this.o=0}n(e){if(this.o+1>this.b.length){const e=this.m(this.b.length+this.a);e.set(this.b),this.b=e}this.b[this.o++]=e}}class y{constructor(){this.u32=new T(e=>new Uint32Array(e)),this.f32=new T(e=>new Float32Array(e)),this.o=[]}reset(){this.u32.r(),this.f32.r(),this.o.length=0}pu32(e){this.u32.n(e)}pcmd(e){this.pu32(e)}pf32(e){this.f32.n(e)}po(e){this.o.push(e)}end(){this.pcmd(481)}setRenderPassParameters(e,t,a,r,n,s,i,o,l,c,h){this.pcmd(471),this.pu32(null!==e?1:0),null!==e&&(this.po(e),this.po(t)),this.po(a),this.po(r),this.pu32(n),this.pf32(s),this.pf32(i),this.pf32(o),this.pf32(l),this.pf32(c),this.pf32(h)}setViewport(e,t,a,r){this.pcmd(472),this.pf32(e),this.pf32(t),this.pf32(a),this.pf32(r)}setScissor(e,t,a,r){this.pcmd(473),this.pf32(e),this.pf32(t),this.pf32(a),this.pf32(r)}setPipeline(e){this.pcmd(475),this.po(e)}setBindings(e,t,a){this.pcmd(474),this.pu32(e),this.po(t),this.pu32(a.length);for(let e=0;e<a.length;e++)this.pu32(a[e])}setInputState(e){this.pcmd(476),this.po(e)}setStencilRef(e){this.pcmd(477),this.pf32(e)}draw(e,t){this.pcmd(478),this.pu32(e),this.pu32(t)}drawIndexed(e,t){this.pcmd(479),this.pu32(e),this.pu32(t)}drawIndexedInstanced(e,t,a){this.pcmd(480),this.pu32(e),this.pu32(t),this.pu32(a)}}var C;!function(e){e[e.uploadBufferData=491]="uploadBufferData",e[e.uploadTextureData=492]="uploadTextureData",e[e.end=493]="end"}(C||(C={}));class M{constructor(){this.u32=new T(e=>new Uint32Array(e)),this.gfxr=[],this.bufr=[]}reset(){this.u32.r(),this.gfxr.length=0,this.bufr.length=0}pu32(e){this.u32.n(e)}pcmd(e){this.pu32(e)}pgfxr(e){this.gfxr.push(e)}pbufr(e){this.bufr.push(e)}end(){this.pcmd(C.end)}uploadBufferData(e,t,a,r,n){i.assert(!!e),this.pcmd(C.uploadBufferData),this.pgfxr(e);const s=4*t,o=void 0!==r?4*r:0,l=void 0!==n?4*n:a.byteLength-o;this.pu32(s),this.pbufr(a),this.pu32(o),this.pu32(l)}uploadTextureData(e,t,a){this.pcmd(C.uploadTextureData),this.pgfxr(e),this.pu32(t),this.pu32(a.length);for(let e=0;e<a.length;e++)this.pbufr(a[e])}}function U(e){return e.blendMode==r.GfxBlendMode.ADD&&e.blendSrcFactor==r.GfxBlendFactor.ONE&&e.blendDstFactor===r.GfxBlendFactor.ZERO}function k(e,t,a){if(i.assert(1===a.attachmentsState.length),function(e,t,a,r){i.assert(0===t),a.colorWriteMask!==r.colorWriteMask&&(e.colorMask(!!(1&r.colorWriteMask),!!(2&r.colorWriteMask),!!(4&r.colorWriteMask),!!(8&r.colorWriteMask)),a.colorWriteMask=r.colorWriteMask);const n=a.rgbBlendState.blendMode!==r.rgbBlendState.blendMode||a.alphaBlendState.blendMode!==r.alphaBlendState.blendMode,s=a.rgbBlendState.blendSrcFactor!==r.rgbBlendState.blendSrcFactor||a.alphaBlendState.blendSrcFactor!==r.alphaBlendState.blendSrcFactor||a.rgbBlendState.blendDstFactor!==r.rgbBlendState.blendDstFactor||a.alphaBlendState.blendDstFactor!==r.alphaBlendState.blendDstFactor;(s||n)&&(U(a.rgbBlendState)&&U(a.alphaBlendState)?e.enable(e.BLEND):U(r.rgbBlendState)&&U(r.alphaBlendState)&&e.disable(e.BLEND)),n&&(e.blendEquationSeparate(r.rgbBlendState.blendMode,r.alphaBlendState.blendMode),a.rgbBlendState.blendMode=r.rgbBlendState.blendMode,a.alphaBlendState.blendMode=r.alphaBlendState.blendMode),s&&(e.blendFuncSeparate(r.rgbBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor,r.alphaBlendState.blendSrcFactor,r.alphaBlendState.blendDstFactor),a.rgbBlendState.blendSrcFactor=r.rgbBlendState.blendSrcFactor,a.alphaBlendState.blendSrcFactor=r.alphaBlendState.blendSrcFactor,a.rgbBlendState.blendDstFactor=r.rgbBlendState.blendDstFactor,a.alphaBlendState.blendDstFactor=r.alphaBlendState.blendDstFactor)}(e,0,t.attachmentsState[0],a.attachmentsState[0]),c.colorEqual(t.blendConstant,a.blendConstant)||(e.blendColor(a.blendConstant.r,a.blendConstant.g,a.blendConstant.b,a.blendConstant.a),c.colorCopy(t.blendConstant,a.blendConstant)),t.depthCompare!==a.depthCompare&&(e.depthFunc(a.depthCompare),t.depthCompare=a.depthCompare),t.depthWrite!==a.depthWrite&&(e.depthMask(a.depthWrite),t.depthWrite=a.depthWrite),t.stencilCompare!==a.stencilCompare){const r=e.getParameter(e.STENCIL_REF);e.stencilFunc(a.stencilCompare,r,255),t.stencilCompare=a.stencilCompare}t.stencilWrite!==a.stencilWrite&&(e.stencilMask(a.stencilWrite?255:0),t.stencilWrite=a.stencilWrite),t.stencilWrite&&t.stencilPassOp!==a.stencilPassOp&&(e.stencilOp(e.KEEP,e.KEEP,a.stencilPassOp),t.stencilPassOp=a.stencilPassOp),t.cullMode!==a.cullMode&&(0===t.cullMode?e.enable(e.CULL_FACE):0===a.cullMode&&e.disable(e.CULL_FACE),2===a.cullMode?e.cullFace(e.BACK):1===a.cullMode?e.cullFace(e.FRONT):3===a.cullMode&&e.cullFace(e.FRONT_AND_BACK),t.cullMode=a.cullMode),t.frontFace!==a.frontFace&&(e.frontFace(a.frontFace),t.frontFace=a.frontFace),t.polygonOffset!==a.polygonOffset&&(a.polygonOffset?(e.polygonOffset(1,1),e.enable(e.POLYGON_OFFSET_FILL)):e.disable(e.POLYGON_OFFSET_FILL),t.polygonOffset=a.polygonOffset)}class D{constructor(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}trackResourceCreated(e){this.creationStacks.set(e,(new Error).stack),this.liveObjects.add(e)}trackResourceDestroyed(e){this.deletionStacks.has(e)&&console.warn("Object double freed:",e,"\n\nCreation stack: ",this.creationStacks.get(e),"\n\nDeletion stack: ",this.deletionStacks.get(e),"\n\nThis stack: ",(new Error).stack),this.deletionStacks.set(e,(new Error).stack),this.liveObjects.delete(e)}checkForLeaks(){for(const e of this.liveObjects.values())console.warn("Object leaked:",e,"Creation stack:",this.creationStacks.get(e))}setResourceLeakCheck(e,t){t?this.liveObjects.add(e):this.liveObjects.delete(e)}}class I{constructor(e){this.gl=e,this._WEBGL_compressed_texture_s3tc=null,this._WEBGL_compressed_texture_s3tc_srgb=null,this._KHR_parallel_shader_compile=null,this._hostAccessPassPool=[],this._renderPassPool=[],this._fullscreenCopyMegaState=o.fullscreenMegaState,this._scWidth=0,this._scHeight=0,this._scTexture=null,this._currentActiveTexture=null,this._currentBoundVAO=null,this._currentProgram=null,this._resourceCreationTracker=null,this._resourceUniqueId=0,this._currentColorAttachments=[],this._currentColorResolveTos=[],this._currentDepthStencilResolveTo=null,this._currentMegaState=o.copyMegaState(o.defaultMegaState),this._currentSamplers=[],this._currentTextures=[],this._currentUniformBuffers=[],this._currentUniformBufferByteOffsets=[],this._currentUniformBufferByteSizes=[],this._debugGroupStack=[],this._resolveAttachmentsChanged=!1,this.bugQuirks=new n.GfxBugQuirksImpl,this.glslVersion="#version 300 es",this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this._WEBGL_compressed_texture_s3tc=e.getExtension("WEBGL_compressed_texture_s3tc"),this._WEBGL_compressed_texture_s3tc_srgb=e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this._KHR_parallel_shader_compile=e.getExtension("KHR_parallel_shader_compile"),this._uniformBufferMaxPageByteSize=Math.min(e.getParameter(e.MAX_UNIFORM_BLOCK_SIZE),65536);const t=d.preprocessProgram_GLSL(this.queryVendorInfo(),"\nout vec2 v_TexCoord;\n\nvoid main() {\n    v_TexCoord.x = (gl_VertexID == 1) ? 2.0 : 0.0;\n    v_TexCoord.y = (gl_VertexID == 2) ? 2.0 : 0.0;\n    gl_Position.xy = v_TexCoord * vec2(2) - vec2(1);\n    gl_Position.zw = vec2(1, 1);\n}\n","\nuniform sampler2D u_Texture;\nin vec2 v_TexCoord;\n\nvoid main() {\n    vec4 color = texture(u_Texture, v_TexCoord);\n    gl_FragColor = vec4(color.rgb, 1.0);\n}\n");this._fullscreenCopyProgram=this._createProgram(t),this._resolveReadFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this._resolveDrawFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this._renderPassDrawFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this._readbackFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this._blackTexture=this.ensureResourceExists(e.createTexture()),e.bindTexture(e.TEXTURE_2D,this._blackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA8,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this._currentMegaState.depthCompare=r.GfxCompareMode.ALWAYS,this._currentMegaState.depthWrite=!1,e.enable(e.DEPTH_TEST),this._checkForBugQuirks(),m&&(this._resourceCreationTracker=new D)}_checkForBugQuirksRowMajor(){const e=this.gl,t=this._compileShader(this.glslVersion+"\nprecision mediump float;\nlayout(row_major, std140) uniform ub_Test {\n    mat4x2 u_Test;\n};\nvoid main() {\n    gl_Position = vec4(1);\n}",e.VERTEX_SHADER),a=this._compileShader(this.glslVersion+"\nprecision mediump float;\nout vec4 o_Color;\nvoid main() {\n    o_Color = vec4(1);\n}",e.FRAGMENT_SHADER),r=this.ensureResourceExists(e.createProgram());e.attachShader(r,t),e.attachShader(r,a),e.linkProgram(r),i.assert(e.getProgramParameter(r,e.LINK_STATUS)),e.uniformBlockBinding(r,e.getUniformBlockIndex(r,"ub_Test"),0);const n=e.getActiveUniformBlockParameter(r,0,e.UNIFORM_BLOCK_DATA_SIZE);if(32===n)this.bugQuirks.rowMajorMatricesBroken=!1;else{if(64!==n)throw"whoops";this.bugQuirks.rowMajorMatricesBroken=!0}e.deleteProgram(r),e.deleteShader(t),e.deleteShader(a)}_checkForBugQuirks(){const e=this.gl;if(!this.bugQuirks.rowMajorMatricesBroken){const t=e.getExtension("WEBGL_debug_renderer_info");if(null!==t){const a=e.getParameter(t.UNMASKED_RENDERER_WEBGL);"MacIntel"!==navigator.platform||a.includes("NVIDIA")||(this.bugQuirks.rowMajorMatricesBroken=!0)}}this.bugQuirks.rowMajorMatricesBroken||this._checkForBugQuirksRowMajor()}configureSwapChain(e,t){if(this._scWidth!==e||this._scHeight!==t){const a=this.gl;this._scWidth=e,this._scHeight=t,null!==this._scTexture&&this._destroyTexture(this._scTexture),this._scTexture=this._createTexture(r.makeTextureDescriptor2D(s.GfxFormat.U8_RGBA_NORM,this._scWidth,this._scHeight,1)),a.bindTexture(a.TEXTURE_2D,b(this._scTexture)),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)}}getDevice(){return this}getOnscreenTexture(){return this._scTexture}present(e,t){if(void 0!==e){const a=this.gl;a.bindFramebuffer(a.DRAW_FRAMEBUFFER,e),this.blitFullscreenTexture(this._scTexture,t),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null)}else this.blitFullscreenTexture(this._scTexture)}blitFullscreenTexture(e,t={x:0,y:0,w:1,h:1}){const a=this.gl;this._setMegaState(this._fullscreenCopyMegaState),this._setActiveTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,b(e)),a.bindSampler(0,null),a.disable(a.SCISSOR_TEST),a.viewport(t.x*this._scWidth,t.y*this._scHeight,t.w*this._scWidth,t.h*this._scHeight),this._currentTextures[0]=null,this._currentSamplers[0]=null,this._useProgram(this._fullscreenCopyProgram),a.drawArrays(a.TRIANGLES,0,3)}translateTextureInternalFormat(e){switch(e){case s.GfxFormat.F32_R:return WebGL2RenderingContext.R32F;case s.GfxFormat.F32_RG:return WebGL2RenderingContext.RG32F;case s.GfxFormat.F32_RGB:return WebGL2RenderingContext.RGB32F;case s.GfxFormat.F32_RGBA:return WebGL2RenderingContext.RGBA32F;case s.GfxFormat.U16_R:return WebGL2RenderingContext.R16UI;case s.GfxFormat.U32_R:return WebGL2RenderingContext.R32UI;case s.GfxFormat.U8_R_NORM:return WebGL2RenderingContext.R8;case s.GfxFormat.U8_RG_NORM:return WebGL2RenderingContext.RG8;case s.GfxFormat.U8_RGB_NORM:return WebGL2RenderingContext.RGB8;case s.GfxFormat.U8_RGB_SRGB:return WebGL2RenderingContext.SRGB8;case s.GfxFormat.U8_RGBA_NORM:return WebGL2RenderingContext.RGBA8;case s.GfxFormat.U8_RGBA_SRGB:return WebGL2RenderingContext.SRGB8_ALPHA8;case s.GfxFormat.S8_RGBA_NORM:return WebGL2RenderingContext.RGBA8_SNORM;case s.GfxFormat.BC1:return this._WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case s.GfxFormat.BC1_SRGB:return this._WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case s.GfxFormat.BC2:return this._WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case s.GfxFormat.BC2_SRGB:return this._WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case s.GfxFormat.BC3:return this._WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case s.GfxFormat.BC3_SRGB:return this._WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case s.GfxFormat.D32F_S8:return WebGL2RenderingContext.DEPTH32F_STENCIL8;case s.GfxFormat.D24_S8:return WebGL2RenderingContext.DEPTH24_STENCIL8;case s.GfxFormat.D32F:return WebGL2RenderingContext.DEPTH_COMPONENT32F;case s.GfxFormat.D24:return WebGL2RenderingContext.DEPTH_COMPONENT24;default:throw"whoops"}}translateTextureFormat(e){switch(e){case s.GfxFormat.BC1:return this._WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case s.GfxFormat.BC1_SRGB:return this._WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case s.GfxFormat.BC2:return this._WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case s.GfxFormat.BC2_SRGB:return this._WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case s.GfxFormat.BC3:return this._WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case s.GfxFormat.BC3_SRGB:return this._WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case s.GfxFormat.D24_S8:case s.GfxFormat.D32F_S8:return WebGL2RenderingContext.DEPTH_STENCIL;case s.GfxFormat.D24:case s.GfxFormat.D32F:return WebGL2RenderingContext.DEPTH_COMPONENT}switch(s.getFormatCompFlags(e)){case 1:return WebGL2RenderingContext.RED;case 2:return WebGL2RenderingContext.RG;case 3:return WebGL2RenderingContext.RGB;case 4:return WebGL2RenderingContext.RGBA}}translateTextureType(e){switch(s.getFormatTypeFlags(e)){case 1:return WebGL2RenderingContext.UNSIGNED_BYTE;case 2:return WebGL2RenderingContext.UNSIGNED_SHORT;case 3:return WebGL2RenderingContext.UNSIGNED_INT;case 8:case 130:return WebGL2RenderingContext.FLOAT;case 129:case 131:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case 132:return WebGL2RenderingContext.FLOAT_32_UNSIGNED_INT_24_8_REV;case 4:return WebGL2RenderingContext.BYTE;default:throw"whoops"}}isTextureFormatCompressed(e){switch(s.getFormatTypeFlags(e)){case 65:case 66:case 67:return!0;default:return!1}}clampNumLevels(e){if(1===e.dimension&&e.depth>1){if(65===s.getFormatTypeFlags(e.pixelFormat)){let t=e.width,a=e.height;for(let r=0;r<e.numLevels;r++){if(t<=2||a<=2)return r-1;t=Math.max(t/2|0,1),a=Math.max(a/2|0,1)}}}return e.numLevels}_setActiveTexture(e){this._currentActiveTexture!==e&&(this.gl.activeTexture(e),this._currentActiveTexture=e)}_bindVAO(e){this._currentBoundVAO!==e&&(this.gl.bindVertexArray(e),this._currentBoundVAO=e)}_useProgram(e){this._currentProgram!==e&&(this.gl.useProgram(e.gl_program),this._currentProgram=e)}ensureResourceExists(e){if(null===e){const e=this.gl.getError();throw new Error(`Created resource is null; GL error encountered: ${e}`)}return e}_createBufferPage(e,t,a){const r=this.gl,n=this.ensureResourceExists(r.createBuffer()),s=A(t),i=function(e){switch(e){case 1:return WebGL2RenderingContext.STATIC_DRAW;case 2:return WebGL2RenderingContext.DYNAMIC_DRAW}}(a);return r.bindBuffer(s,n),r.bufferData(s,e,i),n}getNextUniqueId(){return++this._resourceUniqueId}createBuffer(e,t,a){this.gl.bindVertexArray(null);const r=4*e,s=[];let o;if(3===t){i.assert(r%this._uniformBufferMaxPageByteSize==0);let e=r;for(;e>0;)s.push(this._createBufferPage(Math.min(e,this._uniformBufferMaxPageByteSize),t,a)),e-=this._uniformBufferMaxPageByteSize;o=this._uniformBufferMaxPageByteSize}else s.push(this._createBufferPage(r,t,a)),o=r;const l=A(t),c={_T:n._T.Buffer,ResourceUniqueId:this.getNextUniqueId(),gl_buffer_pages:s,gl_target:l,usage:t,byteSize:r,pageByteSize:o};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(c),this.gl.bindVertexArray(this._currentBoundVAO),c}_createTexture(e){const t=this.gl,a=this.ensureResourceExists(t.createTexture());let r;const s=this.translateTextureInternalFormat(e.pixelFormat);this._setActiveTexture(t.TEXTURE0),this._currentTextures[0]=null;const o=this.clampNumLevels(e);if(0===e.dimension)r=WebGL2RenderingContext.TEXTURE_2D,t.bindTexture(r,a),t.texStorage2D(r,o,s,e.width,e.height),i.assert(1===e.depth);else{if(1!==e.dimension)throw"whoops";r=WebGL2RenderingContext.TEXTURE_2D_ARRAY,t.bindTexture(r,a),t.texStorage3D(r,o,s,e.width,e.height,e.depth)}return{_T:n._T.Texture,ResourceUniqueId:this.getNextUniqueId(),gl_texture:a,gl_target:r,pixelFormat:e.pixelFormat,width:e.width,height:e.height,depth:e.depth,numLevels:o}}createTexture(e){const t=this._createTexture(e);return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(t),t}createSampler(e){const t=this.gl,a=this.ensureResourceExists(t.createSampler());t.samplerParameteri(a,t.TEXTURE_WRAP_S,g(e.wrapS)),t.samplerParameteri(a,t.TEXTURE_WRAP_T,g(e.wrapT)),t.samplerParameteri(a,t.TEXTURE_MIN_FILTER,_(e.minFilter,e.mipFilter)),t.samplerParameteri(a,t.TEXTURE_MAG_FILTER,_(e.magFilter,0)),t.samplerParameterf(a,t.TEXTURE_MIN_LOD,e.minLOD),t.samplerParameterf(a,t.TEXTURE_MAX_LOD,e.maxLOD);const r={_T:n._T.Sampler,ResourceUniqueId:this.getNextUniqueId(),gl_sampler:a};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(r),r}createAttachment(e){const t=e.width,a=e.height,r=e.format,s=e.numSamples,i=this.gl,o=this.ensureResourceExists(i.createRenderbuffer());i.bindRenderbuffer(i.RENDERBUFFER,o),i.renderbufferStorageMultisample(i.RENDERBUFFER,s,this.translateTextureInternalFormat(r),t,a);const l={_T:n._T.Attachment,ResourceUniqueId:this.getNextUniqueId(),gl_renderbuffer:o,gfxTexture:null,pixelFormat:r,width:t,height:a};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(l),l}createAttachmentFromTexture(e){const{pixelFormat:t,width:a,height:r,numLevels:s}=e;this.gl;i.assert(1===s);const o={_T:n._T.Attachment,ResourceUniqueId:this.getNextUniqueId(),gl_renderbuffer:null,gfxTexture:e,pixelFormat:t,width:a,height:r};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(o),o}_createProgram(e){const t={_T:n._T.Program,ResourceUniqueId:this.getNextUniqueId(),descriptor:e,compileDirty:!0,bindDirty:!0,gl_program:null,gl_shader_vert:null,gl_shader_frag:null};return this._tryCompileProgram(t),t}createProgramSimple(e){const t=this._createProgram(e);return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(t),t}createProgram(e){return e.ensurePreprocessed(this.queryVendorInfo()),this.createProgramSimple(e)}createBindings(e){const{bindingLayout:t,uniformBufferBindings:a,samplerBindings:r}=e;i.assert(a.length>=t.numUniformBuffers),i.assert(r.length>=t.numSamplers);const s={_T:n._T.Bindings,ResourceUniqueId:this.getNextUniqueId(),uniformBufferBindings:a,samplerBindings:r};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(s),s}createInputLayout(e){const{vertexAttributeDescriptors:t,vertexBufferDescriptors:a,indexBufferFormat:r}=e,s={_T:n._T.InputLayout,ResourceUniqueId:this.getNextUniqueId(),vertexAttributeDescriptors:t,vertexBufferDescriptors:a,indexBufferFormat:r};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(s),s}createInputState(e,t,a){const r=e,o=this.gl,l=this.ensureResourceExists(o.createVertexArray());o.bindVertexArray(l);for(let e=0;e<r.vertexAttributeDescriptors.length;e++){const a=r.vertexAttributeDescriptors[e];f(a.format)&&console.warn("Vertex format uses sized integer types; this will cause a shader recompile on ANGLE platforms");const{size:n,type:s,normalized:l}=p(a.format),c=t[a.bufferIndex];if(null===c)continue;const h=i.assertExists(r.vertexBufferDescriptors[a.bufferIndex]),d=c.buffer;i.assert(2===d.usage),o.bindBuffer(o.ARRAY_BUFFER,S(c.buffer));const u=c.byteOffset+a.bufferByteOffset;o.vertexAttribPointer(a.location,n,s,l,h.byteStride,u),2===h.frequency&&o.vertexAttribDivisor(a.location,1),o.enableVertexAttribArray(a.location)}let c=null,h=null,d=null;if(null!==a){const e=a.buffer;i.assert(1===e.usage),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,S(a.buffer)),c=function(e){switch(e){case s.GfxFormat.U8_R:return WebGL2RenderingContext.UNSIGNED_BYTE;case s.GfxFormat.U16_R:return WebGL2RenderingContext.UNSIGNED_SHORT;case s.GfxFormat.U32_R:return WebGL2RenderingContext.UNSIGNED_INT;default:throw"whoops"}}(i.assertExists(r.indexBufferFormat)),h=s.getFormatCompByteSize(r.indexBufferFormat),d=a.byteOffset}o.bindVertexArray(null);const u={_T:n._T.InputState,ResourceUniqueId:this.getNextUniqueId(),vao:l,indexBufferByteOffset:d,indexBufferType:c,indexBufferCompByteSize:h,inputLayout:r,vertexBuffers:t};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(u),u}createRenderPipeline(e){const t=function(e){let t=0,a=0;const r=[];for(let n=0;n<e.length;n++){const{numUniformBuffers:s,numSamplers:i}=e[n];r.push({firstUniformBuffer:t,numUniformBuffers:s,firstSampler:a,numSamplers:i}),t+=s,a+=i}return{numUniformBuffers:t,numSamplers:a,bindingLayoutTables:r}}(e.bindingLayouts),a=function(e){switch(e){case 0:return WebGL2RenderingContext.TRIANGLES;default:throw new Error("Unknown primitive topology mode")}}(e.topology),r=e.program,s=e.megaStateDescriptor,i=e.inputLayout,o={_T:n._T.RenderPipeline,ResourceUniqueId:this.getNextUniqueId(),bindingLayouts:t,drawMode:a,program:r,megaState:s,inputLayout:i,ready:!1};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(o),o}createReadback(e){const t=this.gl,a=this.ensureResourceExists(t.createBuffer());t.bindBuffer(t.PIXEL_PACK_BUFFER,a),t.bufferData(t.PIXEL_PACK_BUFFER,4*e,t.STREAM_READ),t.bindBuffer(t.PIXEL_PACK_BUFFER,null);const r={_T:n._T.Readback,ResourceUniqueId:this.getNextUniqueId(),gl_pbo:a,gl_sync:null};return null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceCreated(r),r}createWebXRLayer(e){return new XRWebGLLayer(e,this.gl)}destroyBuffer(e){const{gl_buffer_pages:t}=e;for(let e=0;e<t.length;e++)this.gl.deleteBuffer(t[e]);null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}_destroyTexture(e){this.gl.deleteTexture(b(e))}destroyTexture(e){this._destroyTexture(e),null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}destroySampler(e){this.gl.deleteSampler(v(e)),null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}destroyAttachment(e){const t=e;null!==t.gl_renderbuffer&&this.gl.deleteRenderbuffer(t.gl_renderbuffer),null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(t)}destroyProgram(e){const t=e;this.gl.deleteProgram(t.gl_program),this.gl.deleteShader(t.gl_shader_vert),this.gl.deleteShader(t.gl_shader_frag),null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}destroyBindings(e){null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}destroyInputLayout(e){null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}destroyInputState(e){const t=e;this._currentBoundVAO===t.vao&&(this.gl.bindVertexArray(null),this._currentBoundVAO=null),this.gl.deleteVertexArray(t.vao),null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}destroyRenderPipeline(e){null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}destroyReadback(e){const t=e;null!==t.gl_sync&&this.gl.deleteSync(t.gl_sync),null!==t.gl_pbo&&this.gl.deleteBuffer(t.gl_pbo),null!==this._resourceCreationTracker&&this._resourceCreationTracker.trackResourceDestroyed(e)}createHostAccessPass(){let e=this._hostAccessPassPool.pop();return void 0===e&&(e=new M),e}createRenderPass(e){let t=this._renderPassPool.pop();void 0===t&&(t=new y);let a=0;if(null!==e.colorAttachment&&0===e.colorLoadDisposition&&(a|=WebGL2RenderingContext.COLOR_BUFFER_BIT),null!==e.depthStencilAttachment){const t=e.depthStencilAttachment,r=s.getFormatFlags(t.pixelFormat);4&r&&0===e.depthLoadDisposition&&(a|=WebGL2RenderingContext.DEPTH_BUFFER_BIT),8&r&&0===e.stencilLoadDisposition&&(a|=WebGL2RenderingContext.STENCIL_BUFFER_BIT)}t.descriptor=e;const{colorAttachment:r,colorResolveTo:n,depthStencilAttachment:i,depthStencilResolveTo:o,colorClearColor:l,depthClearValue:c,stencilClearValue:h}=e;return t.setRenderPassParameters(r,n,i,o,a,l.r,l.g,l.b,l.a,c,h),t}submitPass(e){e instanceof y?(e.end(),this.executeRenderPass(e.u32.b,e.f32.b,e.o),e.reset(),this._renderPassPool.push(e)):e instanceof M&&(e.end(),this.executeHostAccessPass(e.u32.b,e.gfxr,e.bufr),e.reset(),this._hostAccessPassPool.push(e))}readPixelFromTexture(e,t,a,r,n){const s=this.gl,i=e;s.bindFramebuffer(s.READ_FRAMEBUFFER,this._readbackFramebuffer);const o=a;s.framebufferTexture2D(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,o.gl_texture,0),s.bindBuffer(s.PIXEL_PACK_BUFFER,i.gl_pbo),s.readPixels(r,n,1,1,s.RED_INTEGER,s.UNSIGNED_INT,4*t),s.bindBuffer(s.PIXEL_PACK_BUFFER,null)}submitReadback(e){const t=this.gl,a=e;null!==a.gl_sync&&t.deleteSync(a.gl_sync),a.gl_sync=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0)}queryReadbackFinished(e,t,a){const r=this.gl,n=a,s=i.assertExists(n.gl_sync);return r.getSyncParameter(s,r.SYNC_STATUS)===r.SIGNALED&&(r.bindBuffer(r.PIXEL_UNPACK_BUFFER,n.gl_pbo),r.getBufferSubData(r.PIXEL_UNPACK_BUFFER,0,e,t),r.bindBuffer(r.PIXEL_UNPACK_BUFFER,null),!0)}queryLimits(){const e=this.gl;return{uniformBufferWordAlignment:e.getParameter(e.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4,uniformBufferMaxPageWordSize:this._uniformBufferMaxPageByteSize/4}}queryTextureFormatSupported(e){switch(e){case s.GfxFormat.BC1_SRGB:case s.GfxFormat.BC2_SRGB:case s.GfxFormat.BC3_SRGB:return null!==this._WEBGL_compressed_texture_s3tc_srgb;case s.GfxFormat.BC1:case s.GfxFormat.BC2:case s.GfxFormat.BC3:return null!==this._WEBGL_compressed_texture_s3tc;default:return!0}}queryPipelineReady(e){const t=e;if(t.ready)return!0;if(null===t.program.gl_program)return!1;const a=this.gl,r=t.program.gl_program;return null!==this._KHR_parallel_shader_compile?t.ready=a.getProgramParameter(r,this._KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):t.ready=!0,t.ready&&u&&this._checkProgramCompilationForErrors(t.program),t.ready}queryPlatformAvailable(){return this.gl.isContextLost()}queryVendorInfo(){return this}queryRenderPass(e){return e.descriptor}setResourceName(e,t){if(e.ResourceName=t,e._T===n._T.Buffer){const{gl_buffer_pages:a}=e;for(let e=0;e<a.length;e++)w(a[e],`${t} Page ${e}`)}else if(e._T===n._T.Texture)w(b(e),t);else if(e._T===n._T.Sampler)w(v(e),t);else if(e._T===n._T.Attachment){const{gl_renderbuffer:a}=e;null!==a&&w(a,t)}else e._T===n._T.InputState&&w(e.vao,t)}setResourceLeakCheck(e,t){null!==this._resourceCreationTracker&&this._resourceCreationTracker.setResourceLeakCheck(e,t)}pushDebugGroup(e){this._debugGroupStack.push(e)}popDebugGroup(){this._debugGroupStack.pop()}getBufferData(e,t,a=0){const r=this.gl;r.bindBuffer(r.COPY_READ_BUFFER,S(e,4*a)),r.getBufferSubData(r.COPY_READ_BUFFER,4*a,t)}checkForLeaks(){null!==this._resourceCreationTracker&&this._resourceCreationTracker.checkForLeaks()}executeRenderPass(e,t,a){let r=0,n=0,s=0;for(;;){const i=e[r++];if(471===i){const i=e[r++];s+=2*i,this.setRenderPassParameters(a,i,a[s++],a[s++],e[r++],t[n++],t[n++],t[n++],t[n++],t[n++],t[n++])}else if(472===i)this.setViewport(t[n++],t[n++],t[n++],t[n++]);else if(473===i)this.setScissor(t[n++],t[n++],t[n++],t[n++]);else if(474===i){const t=e[r++],n=e[r++];this.setBindings(t,a[s++],n,e,r),r+=n}else if(475===i)this.setPipeline(a[s++]);else if(476===i)this.setInputState(a[s++]);else if(477===i)this.setStencilRef(t[n++]);else if(478===i)this.draw(e[r++],e[r++]);else if(479===i)this.drawIndexed(e[r++],e[r++]);else{if(480!==i){if(481===i)return void this.endPass();throw new Error("Invalid execution")}this.drawIndexedInstanced(e[r++],e[r++],e[r++])}}}executeHostAccessPass(e,t,a){let r=0,n=0,s=0;for(;;){const i=e[r++];if(i===C.uploadBufferData)this.uploadBufferData(t[n++],e[r++],a[s++],e[r++],e[r++]);else{if(i!==C.uploadTextureData){if(i===C.end)return;throw new Error("Invalid execution")}{const i=t[n++],o=e[r++],l=e[r++],c=this.gl,{gl_texture:h,gl_target:d,pixelFormat:u,width:m,height:p,depth:f,numLevels:A}=i;this._setActiveTexture(c.TEXTURE0),this._currentTextures[0]=null,c.bindTexture(d,h);let g=m,_=p,S=f;const b=Math.min(o+l,A),v=this.isTextureFormatCompressed(u),w=d===WebGL2RenderingContext.TEXTURE_3D||d===WebGL2RenderingContext.TEXTURE_2D_ARRAY,x=this.translateTextureFormat(u);for(let e=0;e<b;e++){if(e>=o){const t=a[s++];if(d===WebGL2RenderingContext.TEXTURE_2D_ARRAY&&v){const a=t.byteLength/f;for(let r=0;r<f;r++)c.compressedTexSubImage3D(d,e,0,0,r,g,_,1,x,t,r*a,a)}else if(w)if(v)c.compressedTexSubImage3D(d,e,0,0,0,g,_,S,x,t);else{const a=this.translateTextureType(u);c.texSubImage3D(d,e,0,0,0,g,_,S,x,a,t)}else if(v)c.compressedTexSubImage2D(d,e,0,0,g,_,x,t);else{const a=this.translateTextureType(u);c.texSubImage2D(d,e,0,0,g,_,x,a,t)}}g=Math.max(g/2|0,1),_=Math.max(_/2|0,1)}}}}}_debugGroupStatisticsDrawCall(e=1){for(let t=this._debugGroupStack.length-1;t>=0;t--)this._debugGroupStack[t].drawCallCount+=e}_debugGroupStatisticsBufferUpload(e=1){for(let t=this._debugGroupStack.length-1;t>=0;t--)this._debugGroupStack[t].bufferUploadCount+=e}_debugGroupStatisticsTextureBind(e=1){for(let t=this._debugGroupStack.length-1;t>=0;t--)this._debugGroupStack[t].textureBindCount+=e}_debugGroupStatisticsTriangles(e){for(let t=this._debugGroupStack.length-1;t>=0;t--)this._debugGroupStack[t].triangleCount+=e}_compileShader(e,t){const a=this.gl,r=this.ensureResourceExists(a.createShader(t));return a.shaderSource(r,e),a.compileShader(r),r}_reportShaderError(e,t){const a=this.gl,r=a.getShaderParameter(e,a.COMPILE_STATUS);if(!r){console.error(function(e,t=1){return e.split("\n").map((e,a)=>`${i.leftPad(""+(t+a),4," ")}  ${e}`).join("\n")}(t));const r=a.getExtension("WEBGL_debug_shaders");r&&console.error(r.getTranslatedShaderSource(e)),console.error(a.getShaderInfoLog(e))}return r}_checkProgramCompilationForErrors(e){const t=this.gl,a=e.gl_program;if(!t.getProgramParameter(a,t.LINK_STATUS)){const a=e.descriptor;if(!this._reportShaderError(e.gl_shader_vert,a.preprocessedVert))return;if(!this._reportShaderError(e.gl_shader_frag,a.preprocessedFrag))return;console.error(t.getProgramInfoLog(e.gl_program))}}_tryCompileProgram(e){i.assert(e.compileDirty);const t=e.descriptor,a=this.gl;e.gl_shader_vert=this._compileShader(t.preprocessedVert,a.VERTEX_SHADER),e.gl_shader_frag=this._compileShader(t.preprocessedFrag,a.FRAGMENT_SHADER);const r=this.ensureResourceExists(a.createProgram());a.attachShader(r,e.gl_shader_vert),a.attachShader(r,e.gl_shader_frag),a.linkProgram(r),e.gl_program=r,e.compileDirty=!1,e.bindDirty=!0}_bindFramebufferAttachment(e,t){const a=this.gl;null===t?a.framebufferRenderbuffer(a.DRAW_FRAMEBUFFER,e,a.RENDERBUFFER,null):null!==t.gl_renderbuffer?a.framebufferRenderbuffer(a.DRAW_FRAMEBUFFER,e,a.RENDERBUFFER,t.gl_renderbuffer):null!==t.gfxTexture&&a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,e,a.TEXTURE_2D,b(t.gfxTexture),0)}setRenderPassParameters(e,t,a,r,n,s,o,l,c,h,d){const u=this.gl;u.bindFramebuffer(u.DRAW_FRAMEBUFFER,this._renderPassDrawFramebuffer);for(let e=t;e<this._currentColorAttachments.length;e++)u.framebufferRenderbuffer(u.DRAW_FRAMEBUFFER,u.COLOR_ATTACHMENT0+e,u.RENDERBUFFER,null),u.framebufferTexture2D(u.DRAW_FRAMEBUFFER,u.COLOR_ATTACHMENT0+e,u.TEXTURE_2D,null,0);this._currentColorAttachments.length=t;for(let a=0;a<t;a+=2){const t=e[a+0],r=e[a+1];this._currentColorAttachments[a]!==t&&(this._currentColorAttachments[a]=t,this._bindFramebufferAttachment(u.COLOR_ATTACHMENT0+a,t),this._resolveAttachmentsChanged=!0),this._currentColorResolveTos[a]!==r&&(this._currentColorResolveTos[a]=r,null!==r&&(this._resolveAttachmentsChanged=!0))}this._currentDepthStencilAttachment!==a&&(this._currentDepthStencilAttachment=a,this._bindFramebufferAttachment(u.DEPTH_STENCIL_ATTACHMENT,this._currentDepthStencilAttachment),this._resolveAttachmentsChanged=!0),this._currentDepthStencilResolveTo!==r&&(this._currentDepthStencilResolveTo=r,null!==r&&(this._resolveAttachmentsChanged=!0)),u.disable(u.SCISSOR_TEST),n&WebGL2RenderingContext.COLOR_BUFFER_BIT&&(i.assert(this._currentColorAttachments.length>0),u.clearColor(s,o,l,c)),n&WebGL2RenderingContext.DEPTH_BUFFER_BIT&&(i.assert(null!==this._currentDepthStencilAttachment),this._currentMegaState.depthWrite||(u.depthMask(!0),this._currentMegaState.depthWrite=!0),u.clearDepth(h)),n&WebGL2RenderingContext.STENCIL_BUFFER_BIT&&(i.assert(null!==this._currentDepthStencilAttachment),u.clearStencil(d)),0!==n&&u.clear(n)}setBindings(e,t,a,r,n){const s=this.gl;i.assert(e<this._currentPipeline.bindingLayouts.bindingLayoutTables.length);const o=this._currentPipeline.bindingLayouts.bindingLayoutTables[e],{uniformBufferBindings:l,samplerBindings:c}=t;i.assert(l.length>=o.numUniformBuffers),i.assert(c.length>=o.numSamplers),i.assert(a>=l.length);for(let e=0;e<l.length;e++){const t=l[e];if(0===t.wordCount)continue;const a=o.firstUniformBuffer+e,c=t.buffer,h=4*t.wordOffset+r[n+e],d=4*t.wordCount;if(c!==this._currentUniformBuffers[a]||h!==this._currentUniformBufferByteOffsets[a]||d!==this._currentUniformBufferByteSizes[a]){const e=h%c.pageByteSize,t=c.gl_buffer_pages[h/c.pageByteSize|0];i.assert(e+d<=c.pageByteSize),s.bindBufferRange(s.UNIFORM_BUFFER,a,t,e,d),this._currentUniformBuffers[a]=c,this._currentUniformBufferByteOffsets[a]=h,this._currentUniformBufferByteSizes[a]=d}}for(let e=0;e<c.length;e++){const t=c[e],a=o.firstSampler+e,r=null!==t&&null!==t.gfxSampler?v(t.gfxSampler):null,n=null!==t&&null!==t.gfxTexture?b(t.gfxTexture):null;if(this._currentSamplers[a]!==r&&(s.bindSampler(a,r),this._currentSamplers[a]=r),this._currentTextures[a]!==n){if(this._setActiveTexture(s.TEXTURE0+a),null!==n){const{gl_target:e}=i.assertExists(t).gfxTexture;s.bindTexture(e,n),this._debugGroupStatisticsTextureBind()}else s.bindTexture(s.TEXTURE_2D,this._blackTexture);this._currentTextures[a]=n}}}setViewport(e,t,a,r){this.gl.viewport(e,t,a,r)}setScissor(e,t,a,r){const n=this.gl;n.enable(n.SCISSOR_TEST),n.scissor(e,t,a,r)}_setMegaState(e){k(this.gl,this._currentMegaState,e)}setPipeline(e){this._currentPipeline=e,i.assert(this.queryPipelineReady(this._currentPipeline)),this._setMegaState(this._currentPipeline.megaState);const t=this._currentPipeline.program;if(""===t.descriptor.preprocessedVert){t.descriptor.ensurePreprocessed(this.queryVendorInfo()),t.compileDirty=!0,this._tryCompileProgram(t)}if(this._useProgram(t),t.bindDirty){const e=this.gl,a=t.gl_program,r=t.descriptor,n=x(r.preprocessedVert,/uniform (\w+) {([^]*?)}/g);for(let t=0;t<n.length;t++){const[r,s,i]=n[t],o=e.getUniformBlockIndex(a,s);e.uniformBlockBinding(a,o,t)}const s=x(r.preprocessedVert,/^uniform .*sampler\S+ (\w+)(?:\[(\d+)\])?;$/gm);let i=0;for(let t=0;t<s.length;t++){const[r,n,o]=s[t],l=o?parseInt(o):1,c=e.getUniformLocation(a,n);e.uniform1iv(c,h.range(i,l)),i+=l}t.bindDirty=!1}}setInputState(e){const t=e;this._currentInputState=t,null!==this._currentInputState?(i.assert(this._currentPipeline.inputLayout===this._currentInputState.inputLayout),this._bindVAO(this._currentInputState.vao)):(i.assert(null===this._currentPipeline.inputLayout),this._bindVAO(null))}setStencilRef(e){this.gl.stencilFunc(this._currentMegaState.stencilCompare,e,255)}draw(e,t){const a=this.gl,r=this._currentPipeline;a.drawArrays(r.drawMode,t,e),this._debugGroupStatisticsDrawCall(),this._debugGroupStatisticsTriangles(e/3)}drawIndexed(e,t){const a=this.gl,r=this._currentPipeline,n=this._currentInputState,s=i.assertExists(n.indexBufferByteOffset)+t*i.assertExists(n.indexBufferCompByteSize);a.drawElements(r.drawMode,e,i.assertExists(n.indexBufferType),s),this._debugGroupStatisticsDrawCall(),this._debugGroupStatisticsTriangles(e/3)}drawIndexedInstanced(e,t,a){const r=this.gl,n=this._currentPipeline,s=this._currentInputState,o=i.assertExists(s.indexBufferByteOffset)+t*i.assertExists(s.indexBufferCompByteSize);r.drawElementsInstanced(n.drawMode,e,i.assertExists(s.indexBufferType),o,a),this._debugGroupStatisticsDrawCall(),this._debugGroupStatisticsTriangles(e/3*a)}framebufferAttachmentForFormat(e){const t=s.getFormatFlags(e),a=!!(4&t),r=!!(8&t);if(a&&r)return WebGL2RenderingContext.DEPTH_STENCIL_ATTACHMENT;if(a)return WebGL2RenderingContext.DEPTH_ATTACHMENT;if(r)return WebGL2RenderingContext.STENCIL_ATTACHMENT;throw"whoops"}endPass(){const e=this.gl;for(let t=0;t<this._currentColorAttachments.length;t++){const a=this._currentColorAttachments[t],r=this._currentColorResolveTos[t];null!==r&&(i.assert(a.width===r.width&&a.height===r.height),i.assert(null!==a.gl_renderbuffer),e.disable(e.SCISSOR_TEST),e.bindFramebuffer(e.READ_FRAMEBUFFER,this._resolveReadFramebuffer),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this._resolveDrawFramebuffer),this._resolveAttachmentsChanged&&(e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,a.gl_renderbuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r.gl_texture,0)),e.blitFramebuffer(0,0,a.width,a.height,0,0,r.width,r.height,e.COLOR_BUFFER_BIT,e.LINEAR),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null))}const t=this._currentDepthStencilAttachment,a=this._currentDepthStencilResolveTo;null!==t&&null!==a&&(i.assert(t.width===a.width&&t.height===a.height),i.assert(null!==t.gl_renderbuffer),e.disable(e.SCISSOR_TEST),e.bindFramebuffer(e.READ_FRAMEBUFFER,this._resolveReadFramebuffer),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this._resolveDrawFramebuffer),this._resolveAttachmentsChanged&&(e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,this.framebufferAttachmentForFormat(t.pixelFormat),e.RENDERBUFFER,t.gl_renderbuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,this.framebufferAttachmentForFormat(a.pixelFormat),e.TEXTURE_2D,a.gl_texture,0)),e.blitFramebuffer(0,0,t.width,t.height,0,0,a.width,a.height,e.DEPTH_BUFFER_BIT,e.NEAREST),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null)),this._resolveAttachmentsChanged=!1}uploadBufferData(e,t,a,r,n){const s=this.gl,{gl_target:i,byteSize:o,pageByteSize:l}=e;if(i===s.UNIFORM_BUFFER){if(t%l!=0)throw new Error(`Assert fail: (dstByteOffset [${t}] % dstPageByteSize [${l}]) === 0`);if(n%l!=0)throw new Error(`Assert fail: (byteSize [${n}] % dstPageByteSize [${l}]) === 0`)}if(!(t+n<=o))throw new Error(`Assert fail: (dstByteOffset [${t}] + byteSize [${n}]) <= dstByteSize [${o}], gl_target ${i}`);const c=t+n;let h=t,d=t%l;for(;h<c;)s.bindBuffer(s.COPY_WRITE_BUFFER,S(e,h)),s.bufferSubData(s.COPY_WRITE_BUFFER,d,a,r,Math.min(c-h,l)),h+=l,d=0,r+=l,this._debugGroupStatisticsBufferUpload()}}t.createSwapChainForWebGL2=function(e){return new I(e)},t.gfxDeviceGetImpl_GL=function(e){return e},t.getPlatformTexture_GL=function(e){return b(e)}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(6),s=a(84),i=a(0),o=r(a(133));function l(e){if(0===e)return"clamp-to-edge";if(1===e)return"repeat";if(2===e)return"mirror-repeat";throw"whoops"}function c(e){if(1===e)return"linear";if(0===e)return"nearest";throw"whoops"}function h(e){if(2===e)return"linear";if(1===e)return"nearest";if(0===e)return"nearest";throw"whoops"}function d(e){if(e===n.GfxFormat.U8_RGBA_NORM)return"rgba8unorm";if(e===n.GfxFormat.U8_RG_NORM)return"rg8unorm";if(e===n.GfxFormat.D24_S8)return"depth24plus-stencil8";throw"whoops"}function u(e){return e.gpuBuffer}function m(e){if(0===e)return"none";if(1===e)return"front";if(2===e)return"back";throw"whoops"}function p(e){if(e===n.GfxFrontFaceMode.CCW)return"ccw";if(e===n.GfxFrontFaceMode.CW)return"cw";throw"whoops"}function f(e){if(e===n.GfxBlendFactor.ZERO)return"zero";if(e===n.GfxBlendFactor.ONE)return"one";if(e===n.GfxBlendFactor.SRC_COLOR)return"src-color";if(e===n.GfxBlendFactor.ONE_MINUS_SRC_COLOR)return"one-minus-src-color";if(e===n.GfxBlendFactor.DST_COLOR)return"dst-color";if(e===n.GfxBlendFactor.ONE_MINUS_DST_COLOR)return"one-minus-dst-color";if(e===n.GfxBlendFactor.SRC_ALPHA)return"src-alpha";if(e===n.GfxBlendFactor.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(e===n.GfxBlendFactor.DST_ALPHA)return"dst-alpha";if(e===n.GfxBlendFactor.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";throw"whoops"}function A(e){if(e===n.GfxBlendMode.ADD)return"add";if(e===n.GfxBlendMode.SUBTRACT)return"subtract";if(e===n.GfxBlendMode.REVERSE_SUBTRACT)return"reverse-subtract";throw"whoops"}function g(e){return{operation:A(e.blendMode),srcFactor:f(e.blendSrcFactor),dstFactor:f(e.blendDstFactor)}}function _(e){return{format:"bgra8unorm",colorBlend:g(e.rgbBlendState),alphaBlend:g(e.alphaBlendState),writeMask:e.colorWriteMask}}function S(e){if(e===n.GfxCompareMode.NEVER)return"never";if(e===n.GfxCompareMode.LESS)return"less";if(e===n.GfxCompareMode.EQUAL)return"equal";if(e===n.GfxCompareMode.LEQUAL)return"less-equal";if(e===n.GfxCompareMode.GREATER)return"greater";if(e===n.GfxCompareMode.NEQUAL)return"not-equal";if(e===n.GfxCompareMode.GEQUAL)return"greater-equal";if(e===n.GfxCompareMode.ALWAYS)return"always";throw"whoops"}function b(e){if(1===e)return"vertex";if(2===e)return"instance";throw"whoops"}function v(e){if(e===n.GfxFormat.U8_RG)return"uchar2";if(e===n.GfxFormat.U8_RGBA)return"uchar4";if(e===n.GfxFormat.F32_R)return"float";if(e===n.GfxFormat.F32_RG)return"float2";if(e===n.GfxFormat.F32_RGB)return"float3";if(e===n.GfxFormat.F32_RGBA)return"float4";throw"whoops"}class w{constructor(e){this.device=e,this.commandEncoder=null}uploadBufferData(e,t,a,r,n){const s=t<<2,i=void 0!==r?r<<2:0,o=void 0!==n?n<<2:0;e.gpuBuffer.setSubData(s,a,i,o)}uploadTextureData(e,t,a){const r=e;r.pixelFormat,i.align(r.width,256);let n=0;for(let e=0;e<a.length;e++)n+=a[e].byteLength;const s=this.device.createBuffer({size:n,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC});let o=0,l=r.width,c=r.height;for(let e=0;e<a.length;e++){s.setSubData(o,a[e]),o+=a[e].byteLength;const n={buffer:s,offset:0,rowPitch:l,imageHeight:c},i={texture:r.gpuTexture,mipLevel:t+e,arrayLayer:0,origin:[0,0,0]},h=[l,c,1];this.commandEncoder.copyBufferToTexture(n,i,h),l=Math.max(l/2|0,1),c=Math.max(c/2|0,1)}}finish(){return this.commandEncoder.finish()}}class x{constructor(){this.commandEncoder=null,this.renderPassEncoder=null,this.colorAttachments=[{attachment:null,loadValue:"load"}],this.depthStencilAttachment={attachment:null,depthLoadValue:"load",depthStoreOp:"store",stencilLoadValue:"load",stencilStoreOp:"store"},this.renderPassDescriptor={colorAttachments:this.colorAttachments,depthStencilAttachment:this.depthStencilAttachment}}setRenderPassDescriptor(e){if(this.descriptor=e,null!==e.colorAttachment){const t=e.colorAttachment,a=this.colorAttachments[0];a.attachment=t.gpuTextureView,a.loadValue=1===e.colorLoadDisposition?"load":e.colorClearColor,a.storeOp="store",a.resolveTarget=void 0,this.renderPassDescriptor.colorAttachments=this.colorAttachments;const r=e.colorResolveTo;null!==r&&(a.resolveTarget=r.gpuTextureView)}else this.renderPassDescriptor.colorAttachments=[];if(null!==e.depthStencilAttachment){const t=e.depthStencilAttachment,a=this.depthStencilAttachment;a.attachment=t.gpuTextureView,a.depthLoadValue=1===e.depthLoadDisposition?"load":e.depthClearValue,a.stencilLoadValue=1===e.stencilLoadDisposition?"load":e.stencilClearValue,a.depthStoreOp="store",a.stencilStoreOp="store",this.renderPassDescriptor.depthStencilAttachment=this.depthStencilAttachment}else this.renderPassDescriptor.depthStencilAttachment=void 0}beginRenderPass(e){i.assert(null===this.renderPassEncoder),this.setRenderPassDescriptor(e),this.renderPassEncoder=this.commandEncoder.beginRenderPass(this.renderPassDescriptor)}setViewport(e,t,a,r){this.renderPassEncoder.setViewport(e,t,a,r,0,1)}setScissor(e,t,a,r){this.renderPassEncoder.setScissorRect(e,t,a,r)}setPipeline(e){const t=e,a=i.assertExists(t.gpuRenderPipeline);this.renderPassEncoder.setPipeline(a)}setInputState(e){const t=e;null!==t.indexBuffer&&this.renderPassEncoder.setIndexBuffer(u(t.indexBuffer.buffer),t.indexBuffer.byteOffset);for(let e=0;e<t.vertexBuffers.length;e++){const a=t.vertexBuffers[e];null!==a&&this.renderPassEncoder.setVertexBuffer(e,u(a.buffer),a.byteOffset)}}setBindings(e,t,a){const r=t;this.renderPassEncoder.setBindGroup(e,r.gpuBindGroup,a.slice(0,r.bindingLayout.numUniformBuffers))}setStencilRef(e){this.renderPassEncoder.setStencilReference(e)}draw(e,t){this.renderPassEncoder.draw(e,1,t,0)}drawIndexed(e,t){this.renderPassEncoder.drawIndexed(e,1,t,0,0)}drawIndexedInstanced(e,t,a){this.renderPassEncoder.drawIndexed(e,a,t,0,0)}finish(){return this.renderPassEncoder.endPass(),this.renderPassEncoder=null,this.commandEncoder.finish()}}class T{constructor(e,t,a,r){this.adapter=e,this.device=t,this.canvasContext=a,this.glslang=r,this._resourceUniqueId=0,this._hostAccessPassPool=[],this._renderPassPool=[],this.bugQuirks=new s.GfxBugQuirksImpl,this.glslVersion="#version 450",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this._swapChain=this.canvasContext.configureSwapChain({device:t,format:"bgra8unorm"})}configureSwapChain(e,t){}getOnscreenTexture(){const e=this._swapChain.getCurrentTexture(),t=e.createView();return{_T:s._T.Texture,ResourceUniqueId:0,gpuTexture:e,gpuTextureView:t,pixelFormat:n.GfxFormat.U8_RGBA_NORM,width:0,height:0,numLevels:1}}getDevice(){return this}present(){}getNextUniqueId(){return++this._resourceUniqueId}createBuffer(e,t,a){let r=function(e){if(1===e)return GPUBufferUsage.INDEX;if(2===e)return GPUBufferUsage.VERTEX;if(3===e)return GPUBufferUsage.UNIFORM;throw"whoops"}(t);r|=GPUBufferUsage.COPY_DST;const n=4*e,i=this.device.createBuffer({usage:r,size:n});return{_T:s._T.Buffer,ResourceUniqueId:this.getNextUniqueId(),gpuBuffer:i}}createTexture(e){const t=[e.width,e.height,1],a=1===e.dimension?e.depth:1,r=e.numLevels,n=d(e.pixelFormat),i=GPUTextureUsage.COPY_DST|GPUTextureUsage.SAMPLED,o=this.device.createTexture({size:t,arrayLayerCount:a,mipLevelCount:r,format:n,dimension:"2d",usage:i}),l=o.createView();return{_T:s._T.Texture,ResourceUniqueId:this.getNextUniqueId(),gpuTexture:o,gpuTextureView:l,pixelFormat:e.pixelFormat,width:e.width,height:e.height,numLevels:r}}createSampler(e){const t=this.device.createSampler({addressModeU:l(e.wrapS),addressModeV:l(e.wrapT),lodMinClamp:e.minLOD,lodMaxClamp:e.maxLOD,minFilter:c(e.minFilter),magFilter:c(e.magFilter),mipmapFilter:h(e.mipFilter)});return{_T:s._T.Sampler,ResourceUniqueId:this.getNextUniqueId(),gpuSampler:t}}createAttachment(e){const t=e.width,a=e.height,r=e.format,n=e.numSamples,i=this.device.createTexture({size:[t,a,1],sampleCount:n,format:d(r),usage:GPUTextureUsage.OUTPUT_ATTACHMENT}),o=i.createView();return{_T:s._T.Attachment,ResourceUniqueId:this.getNextUniqueId(),gpuTexture:i,gpuTextureView:o}}createAttachmentFromTexture(e){const{gpuTexture:t}=e,a=t.createView();return{_T:s._T.Attachment,ResourceUniqueId:this.getNextUniqueId(),gpuTexture:t,gpuTextureView:a}}async _createShaderStage(e,t){let a;try{a=this.glslang.compileGLSL(e,t,!0)}catch(t){throw console.error(function(e,t=1){return e.split("\n").map((e,a)=>`${i.leftPad(""+(t+a),4," ")}  ${e}`).join("\n")}(e)),"whoops"}return{module:this.device.createShaderModule({code:a}),entryPoint:"main"}}async _createProgram(e){const t=e.deviceProgram;e.vertexStage=await this._createShaderStage(t.preprocessedVert,"vertex"),e.fragmentStage=await this._createShaderStage(t.preprocessedFrag,"fragment")}createProgramSimple(e){const t={_T:s._T.Program,ResourceUniqueId:this.getNextUniqueId(),deviceProgram:e,vertexStage:null,fragmentStage:null};return this._createProgram(t),t}createProgram(e){return e.ensurePreprocessed(this),this.createProgramSimple(e)}_createBindGroupLayout(e){const t=[];for(let a=0;a<e.numUniformBuffers;a++)t.push({binding:t.length,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,type:"uniform-buffer",hasDynamicOffset:!0});for(let a=0;a<e.numSamplers;a++)t.push({binding:t.length,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,type:"sampled-texture"}),t.push({binding:t.length,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,type:"sampler"});return this.device.createBindGroupLayout({bindings:t})}createBindings(e){const t=this._createBindGroupLayout(e.bindingLayout),a=[];let r=0;for(let t=0;t<e.uniformBufferBindings.length;t++){const n=e.uniformBufferBindings[t],s={buffer:u(n.buffer),offset:n.wordOffset<<2,size:n.wordCount<<2};a.push({binding:r++,resource:s})}for(let t=0;t<e.samplerBindings.length;t++){const n=e.samplerBindings[t];if(null!==n.gfxTexture){const e=n.gfxTexture.gpuTextureView;a.push({binding:r+0,resource:e})}if(null!==n.gfxSampler){const e=n.gfxSampler.gpuSampler;a.push({binding:r+1,resource:e})}r+=2}const n=this.device.createBindGroup({layout:t,bindings:a});return{_T:s._T.Bindings,ResourceUniqueId:this._resourceUniqueId,bindingLayout:e.bindingLayout,gpuBindGroupLayout:t,gpuBindGroup:n}}createInputLayout(e){const t=function(e){if(null!==e){if(e===n.GfxFormat.U16_R)return"uint16";if(e===n.GfxFormat.U32_R)return"uint32";throw"whoops"}}(e.indexBufferFormat),a=[];for(let t=0;t<e.vertexBufferDescriptors.length;t++){const r=e.vertexBufferDescriptors[t];if(null===r)continue;const n=r.byteStride;i.assert(n>0);const s=b(r.frequency),o=[];a[t]={stride:n,stepMode:s,attributeSet:o}}for(let t=0;t<e.vertexAttributeDescriptors.length;t++){const r=e.vertexAttributeDescriptors[t],n=i.assertExists(a[r.bufferIndex]),s={shaderLocation:r.location,format:v(r.format),offset:r.bufferByteOffset};n.attributeSet.push(s)}const r={indexFormat:t,vertexBuffers:a};return{_T:s._T.InputLayout,ResourceUniqueId:this.getNextUniqueId(),gpuVertexInputDescriptor:r}}createInputState(e,t,a){return{_T:s._T.InputState,ResourceUniqueId:this.getNextUniqueId(),inputLayout:e,vertexBuffers:t,indexBuffer:a}}_createPipelineLayout(e){const t=e.map(e=>this._createBindGroupLayout(e));return this.device.createPipelineLayout({bindGroupLayouts:t})}createRenderPipeline(e){const t={_T:s._T.RenderPipeline,ResourceUniqueId:this.getNextUniqueId(),descriptor:e,gpuRenderPipeline:null};return this.ensureRenderPipeline(t),t}async ensureRenderPipeline(e){if(null!==e.gpuRenderPipeline)return;const t=e.descriptor,a=t.program;if(null===a.vertexStage||null===a.fragmentStage)return;const r=this._createPipelineLayout(t.bindingLayouts),n=function(e){if(0===e)return"triangle-list";throw"whoops"}(t.topology),s={cullMode:m((i=t.megaStateDescriptor).cullMode),frontFace:p(i.frontFace)};var i;const o=function(e){return e.attachmentsState.map(_)}(t.megaStateDescriptor),l=function(e){return{format:"depth24plus-stencil8",depthWriteEnabled:e.depthWrite,depthCompare:S(e.depthCompare)}}(t.megaStateDescriptor),c=a.vertexStage,h=a.fragmentStage,d=t.inputLayout.gpuVertexInputDescriptor,u=t.sampleCount;this.device.pushErrorScope("none"),e.gpuRenderPipeline=this.device.createRenderPipeline({layout:r,vertexStage:c,fragmentStage:h,primitiveTopology:n,rasterizationState:s,colorStates:o,depthStencilState:l,vertexInput:d,sampleCount:u}),await this.device.popErrorScope(),void 0!==e.ResourceName&&(e.gpuRenderPipeline.label=e.ResourceName)}createReadback(){return{_T:s._T.Readback,ResourceUniqueId:this.getNextUniqueId()}}createWebXRLayer(e){throw"createWebXRLayer not implemented on WebGPU"}destroyBuffer(e){u(e).destroy()}destroyTexture(e){e.gpuTexture.destroy()}destroySampler(e){}destroyAttachment(e){e.gpuTexture.destroy()}destroyProgram(e){}destroyBindings(e){}destroyInputLayout(e){}destroyInputState(e){}destroyRenderPipeline(e){}destroyReadback(e){}createHostAccessPass(){let e=this._hostAccessPassPool.pop();return void 0===e&&(e=new w(this.device)),e.commandEncoder=this.device.createCommandEncoder(),e}createRenderPass(e){let t=this._renderPassPool.pop();return void 0===t&&(t=new x),t.commandEncoder=this.device.createCommandEncoder(),t.beginRenderPass(e),t}submitPass(e){const t=this.device.getQueue(),a=e,r=a.finish();t.submit([r]),a.commandEncoder=null,e instanceof x?this._renderPassPool.push(e):e instanceof w&&this._hostAccessPassPool.push(e)}readPixelFromTexture(e,t,a,r,n){}submitReadback(e){}queryReadbackFinished(e,t,a){return!0}queryLimits(){return{uniformBufferMaxPageWordSize:4096,uniformBufferWordAlignment:64}}queryTextureFormatSupported(e){return e!==n.GfxFormat.BC1&&e!==n.GfxFormat.BC1_SRGB&&(e!==n.GfxFormat.BC2&&e!==n.GfxFormat.BC2_SRGB&&(e!==n.GfxFormat.BC3&&e!==n.GfxFormat.BC3_SRGB))}queryPipelineReady(e){return null!==e.gpuRenderPipeline}queryPlatformAvailable(){return!0}queryVendorInfo(){return this}queryRenderPass(e){return e.descriptor}setResourceName(e,t){if(e.ResourceName=t,e._T===s._T.Buffer){e.gpuBuffer.label=t}else if(e._T===s._T.Texture){e.gpuTexture.label=t}else if(e._T===s._T.Attachment){const a=e;a.gpuTexture.label=t,a.gpuTextureView.label=t}else if(e._T===s._T.Sampler){e.gpuSampler.label=t}else if(e._T===s._T.RenderPipeline){const a=e;null!==a.gpuRenderPipeline&&(a.gpuRenderPipeline.label=t)}}setResourceLeakCheck(e,t){}checkForLeaks(){}pushDebugGroup(e){}popDebugGroup(){}}t.createSwapChainForWebGPU=async function(e){if(void 0===navigator.gpu)return null;const t=await navigator.gpu.requestAdapter(),a=await t.requestDevice(),r=e.getContext("gpupresent");if(!r)return null;const n=await o.default("glslang.wasm");return new T(t,a,r,n)}},function(e,t,a){(function(t){var a,r,n=(a="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t;e=e||{},t||(t=void 0!==e?e:{}),t.compileGLSLZeroCopy=function(e,a,r){if(r=!!r,"vertex"===a)var n=0;else if("fragment"===a)n=4;else{if("compute"!==a)throw Error("shader_stage must be 'vertex', 'fragment', or 'compute'");n=5}a=t._malloc(4);var s=t._malloc(4),i=function(e){var a=["string","number","boolean","number","number"],r={string:function(e){var t=0;if(null!=e&&0!==e){var a=1+(e.length<<2);t=Ie(a),U(e,g,t,a)}return t},array:function(e){var t=Ie(e.length);return A.set(e,t),t}},n=function(){var e=t._convert_glsl_to_spirv;return e||Ee("Assertion failed: Cannot call unknown function convert_glsl_to_spirv, make sure it is exported"),e}(),s=[],i=0;if(e)for(var o=0;o<e.length;o++){var l=r[a[o]];l?(0===i&&(i=Be()),s[o]=l(e[o])):s[o]=e[o]}return e=n.apply(null,s),0!==i&&Re(i),e}([e,n,r,a,s]);if(r=m(a),e=m(s),t._free(a),t._free(s),0===i)throw Error("GLSL compilation failed");return s=r/4,(a={}).data=t.HEAPU32.subarray(s,s+e),a.fa=function(){t._destroy_output_buffer(i)},a},t.compileGLSL=function(e,a,r){return a=(e=t.compileGLSLZeroCopy(e,a,r)).data.slice(),e.fa(),a};var r,n,s,i={};for(r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);n="object"==typeof window,s="function"==typeof importScripts;var o,l="";(n||s)&&(s?l=self.location.href:document.currentScript&&(l=document.currentScript.src),a&&(l=a),l=0!==l.indexOf("blob:")?l.substr(0,l.lastIndexOf("/")+1):"",s&&(o=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var c=t.print||console.log.bind(console),h=t.printErr||console.warn.bind(console);for(r in i)i.hasOwnProperty(r)&&(t[r]=i[r]);i=null;var d,u={"f64-rem":function(e,t){return e%t},debugger:function(){}};function m(e){var t="i32";switch("*"===t.charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return A[e>>0];case"i16":return _[e>>1];case"i32":case"i64":return b[e>>2];case"float":return w[e>>2];case"double":return x[e>>3];default:Ee("invalid type for getValue: "+t)}return null}t.wasmBinary&&(d=t.wasmBinary),"object"!=typeof WebAssembly&&h("no native wasm support detected");var p,f,A,g,_,S,b,v,w,x,T=!1,y="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function C(e,t,a){var r=t+a;for(a=t;e[a]&&!(a>=r);)++a;if(16<a-t&&e.subarray&&y)return y.decode(e.subarray(t,a));for(r="";t<a;){var n=e[t++];if(128&n){var s=63&e[t++];if(192==(224&n))r+=String.fromCharCode((31&n)<<6|s);else{var i=63&e[t++];65536>(n=224==(240&n)?(15&n)<<12|s<<6|i:(7&n)<<18|s<<12|i<<6|63&e[t++])?r+=String.fromCharCode(n):(n-=65536,r+=String.fromCharCode(55296|n>>10,56320|1023&n))}}else r+=String.fromCharCode(n)}return r}function M(e){return e?C(g,e,void 0):""}function U(e,t,a,r){if(0<r){r=a+r-1;for(var n=0;n<e.length;++n){var s=e.charCodeAt(n);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++n)),127>=s){if(a>=r)break;t[a++]=s}else{if(2047>=s){if(a+1>=r)break;t[a++]=192|s>>6}else{if(65535>=s){if(a+2>=r)break;t[a++]=224|s>>12}else{if(a+3>=r)break;t[a++]=240|s>>18,t[a++]=128|s>>12&63}t[a++]=128|s>>6&63}t[a++]=128|63&s}}t[a]=0}}function k(e){for(var t=0,a=0;a<e.length;++a){var r=e.charCodeAt(a);55296<=r&&57343>=r&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++a)),127>=r?++t:t=2047>=r?t+2:65535>=r?t+3:t+4}return t}function D(e){return 0<e%65536&&(e+=65536-e%65536),e}function I(){t.HEAP8=A=new Int8Array(f),t.HEAP16=_=new Int16Array(f),t.HEAP32=b=new Int32Array(f),t.HEAPU8=g=new Uint8Array(f),t.HEAPU16=S=new Uint16Array(f),t.HEAPU32=v=new Uint32Array(f),t.HEAPF32=w=new Float32Array(f),t.HEAPF64=x=new Float64Array(f)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var R=t.TOTAL_MEMORY||16777216;function B(e){for(;0<e.length;){var a=e.shift();if("function"==typeof a)a();else{var r=a.ga;"number"==typeof r?void 0===a.da?t.dynCall_v(r):t.dynCall_vi(r,a.da):r(void 0===a.da?null:a.da)}}}(p=t.wasmMemory?t.wasmMemory:new WebAssembly.Memory({initial:R/65536}))&&(f=p.buffer),R=f.byteLength,I(),b[87504]=5592928;var P=[],E=[],F=[],V=[];function O(){var e=t.preRun.shift();P.unshift(e)}var N=0,L=null,G=null;function H(){var e=j;return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}t.preloadedImages={},t.preloadedAudios={};var j="glslang.wasm";if(!H()){var W=j;j=t.locateFile?t.locateFile(W,l):l+W}function Z(){try{if(d)return new Uint8Array(d);if(o)return o(j);throw"both async and sync fetching of the wasm failed"}catch(e){Ee(e)}}function z(e){function a(e){t.asm=e.exports,N--,t.monitorRunDependencies&&t.monitorRunDependencies(N),0==N&&(null!==L&&(clearInterval(L),L=null),G&&(e=G,G=null,e()))}function r(e){a(e.instance)}function i(e){return(d||!n&&!s||"function"!=typeof fetch?new Promise((function(e){e(Z())})):fetch(j,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+j+"'";return e.arrayBuffer()})).catch((function(){return Z()}))).then((function(e){return WebAssembly.instantiate(e,o)})).then(e,(function(e){h("failed to asynchronously prepare wasm: "+e),Ee(e)}))}var o={env:e,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:u};if(N++,t.monitorRunDependencies&&t.monitorRunDependencies(N),t.instantiateWasm)try{return t.instantiateWasm(o,a)}catch(e){return h("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(d||"function"!=typeof WebAssembly.instantiateStreaming||H()||"function"!=typeof fetch)return i(r);fetch(j,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,o).then(r,(function(e){h("wasm streaming compile failed: "+e),h("falling back to ArrayBuffer instantiation"),i(r)}))}))}(),{}}function K(e){return t.___errno_location&&(b[t.___errno_location()>>2]=e),e}t.asm=function(e,t){return t.memory=p,t.table=new WebAssembly.Table({initial:1064,maximum:1064,element:"anyfunc"}),t.__memory_base=1024,t.__table_base=0,z(t)},E.push({ga:function(){Ce()}});var X=[null,[],[]],Y=0;function $(){return b[(Y+=4)-4>>2]}var q={};function Q(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var J=void 0;function ee(e){for(var t="";g[e];)t+=J[g[e++]];return t}var te={},ae={},re={};function ne(e){var t=Error,a=function(e,t){if(void 0===e)e="_unknown";else{var a=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);e=48<=a&&57>=a?"_"+e:e}return new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}(e,(function(t){this.name=e,this.message=t,void 0!==(t=Error(t).stack)&&(this.stack=this.toString()+"\n"+t.replace(/^Error(:[^\n]*)?\n/,""))}));return a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},a}var se=void 0;function ie(e){throw new se(e)}function oe(e,t,a){if(a=a||{},!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=t.name;if(e||ie('type "'+r+'" must have a positive integer typeid pointer'),ae.hasOwnProperty(e)){if(a.ia)return;ie("Cannot register type '"+r+"' twice")}ae[e]=t,delete re[e],te.hasOwnProperty(e)&&(t=te[e],delete te[e],t.forEach((function(e){e()})))}var le=[],ce=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function he(e){return this.fromWireType(v[e>>2])}function de(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function ue(e,t){switch(t){case 2:return function(e){return this.fromWireType(w[e>>2])};case 3:return function(e){return this.fromWireType(x[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function me(e,t,a){switch(t){case 0:return a?function(e){return A[e]}:function(e){return g[e]};case 1:return a?function(e){return _[e>>1]}:function(e){return S[e>>1]};case 2:return a?function(e){return b[e>>2]}:function(e){return v[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function pe(){return A.length}var fe={};function Ae(){return Ae.X||(Ae.X=[]),Ae.X.push(Be()),Ae.X.length-1}function ge(e){return 0==e%4&&(0!=e%100||0==e%400)}function _e(e,t){for(var a=0,r=0;r<=t;a+=e[r++]);return a}var Se=[31,29,31,30,31,30,31,31,30,31,30,31],be=[31,28,31,30,31,30,31,31,30,31,30,31];function ve(e,t){for(e=new Date(e.getTime());0<t;){var a=e.getMonth(),r=(ge(e.getFullYear())?Se:be)[a];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>a?e.setMonth(a+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return e}function we(e,t,a,r){function n(e,t,a){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=a[0]+e;return e}function s(e,t){return n(e,t,"0")}function i(e,t){function a(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=a(e.getFullYear()-t.getFullYear()))&&0===(r=a(e.getMonth()-t.getMonth()))&&(r=a(e.getDate()-t.getDate())),r}function o(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function l(e){e=ve(new Date(e.W+1900,0,1),e.ca);var t=o(new Date(e.getFullYear()+1,0,4));return 0>=i(o(new Date(e.getFullYear(),0,4)),e)?0>=i(t,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var c=b[r+40>>2];for(var h in r={na:b[r>>2],ma:b[r+4>>2],aa:b[r+8>>2],$:b[r+12>>2],Y:b[r+16>>2],W:b[r+20>>2],ba:b[r+24>>2],ca:b[r+28>>2],ya:b[r+32>>2],la:b[r+36>>2],oa:c?M(c):""},a=M(a),c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})a=a.replace(new RegExp(h,"g"),c[h]);var d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),u="January February March April May June July August September October November December".split(" ");for(h in c={"%a":function(e){return d[e.ba].substring(0,3)},"%A":function(e){return d[e.ba]},"%b":function(e){return u[e.Y].substring(0,3)},"%B":function(e){return u[e.Y]},"%C":function(e){return s((e.W+1900)/100|0,2)},"%d":function(e){return s(e.$,2)},"%e":function(e){return n(e.$,2," ")},"%g":function(e){return l(e).toString().substring(2)},"%G":function(e){return l(e)},"%H":function(e){return s(e.aa,2)},"%I":function(e){return 0==(e=e.aa)?e=12:12<e&&(e-=12),s(e,2)},"%j":function(e){return s(e.$+_e(ge(e.W+1900)?Se:be,e.Y-1),3)},"%m":function(e){return s(e.Y+1,2)},"%M":function(e){return s(e.ma,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.aa&&12>e.aa?"AM":"PM"},"%S":function(e){return s(e.na,2)},"%t":function(){return"\t"},"%u":function(e){return e.ba||7},"%U":function(e){var t=new Date(e.W+1900,0,1),a=0===t.getDay()?t:ve(t,7-t.getDay());return 0>i(a,e=new Date(e.W+1900,e.Y,e.$))?s(Math.ceil((31-a.getDate()+(_e(ge(e.getFullYear())?Se:be,e.getMonth()-1)-31)+e.getDate())/7),2):0===i(a,t)?"01":"00"},"%V":function(e){var t=o(new Date(e.W+1900,0,4)),a=o(new Date(e.W+1901,0,4)),r=ve(new Date(e.W+1900,0,1),e.ca);return 0>i(r,t)?"53":0>=i(a,r)?"01":s(Math.ceil((t.getFullYear()<e.W+1900?e.ca+32-t.getDate():e.ca+1-t.getDate())/7),2)},"%w":function(e){return e.ba},"%W":function(e){var t=new Date(e.W,0,1),a=1===t.getDay()?t:ve(t,0===t.getDay()?1:7-t.getDay()+1);return 0>i(a,e=new Date(e.W+1900,e.Y,e.$))?s(Math.ceil((31-a.getDate()+(_e(ge(e.getFullYear())?Se:be,e.getMonth()-1)-31)+e.getDate())/7),2):0===i(a,t)?"01":"00"},"%y":function(e){return(e.W+1900).toString().substring(2)},"%Y":function(e){return e.W+1900},"%z":function(e){var t=0<=(e=e.la);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.oa},"%%":function(){return"%"}})0<=a.indexOf(h)&&(a=a.replace(new RegExp(h,"g"),c[h](r)));return(h=function(e){var t=Array(k(e)+1);return U(e,t,0,t.length),t}(a)).length>t?0:(A.set(h,e),h.length-1)}for(var xe=Array(256),Te=0;256>Te;++Te)xe[Te]=String.fromCharCode(Te);J=xe,se=t.BindingError=ne("BindingError"),t.InternalError=ne("InternalError"),t.count_emval_handles=function(){for(var e=0,t=5;t<ce.length;++t)void 0!==ce[t]&&++e;return e},t.get_first_emval=function(){for(var e=5;e<ce.length;++e)if(void 0!==ce[e])return ce[e];return null};var ye=t.asm({},{c:Ee,I:function(){throw T=!0,"Pure virtual function called!"},C:function(){return Me.pa},v:function(){},q:function(){return K(1),-1},j:K,p:function(e,t){Y=t;try{return q.ha(),$(),$(),$(),$(),0}catch(e){return Ee(e),-e.ea}},i:function(e,t){Y=t;try{var a=$(),r=$(),n=$();for(t=e=0;t<n;t++){for(var s=b[r+8*t>>2],i=b[r+(8*t+4)>>2],o=0;o<i;o++){var l=g[s+o],d=X[a];0===l||10===l?((1===a?c:h)(C(d,0)),d.length=0):d.push(l)}e+=i}return e}catch(e){return Ee(e),-e.ea}},o:function(e,t){return Y=t,0},n:function(e,t){Y=t;try{return q.ha(),0}catch(e){return Ee(e),-e.ea}},H:function(e,t){Y=t;try{var a=$(),r=$();if(-1===a||0===r)var n=-22;else{var s=q.ja[a];if(s&&r===s.va){var i=(void 0).ta(s.sa);q.ra(a,i,r,s.flags),(void 0).xa(i),q.ja[a]=null,s.qa&&ke(s.wa)}n=0}return n}catch(e){return Ee(e),-e.ea}},m:function(){},G:function(e,t,a,r,n){var s=Q(a);oe(e,{name:t=ee(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:n},argPackAdvance:8,readValueFromPointer:function(e){if(1===a)var r=A;else if(2===a)r=_;else{if(4!==a)throw new TypeError("Unknown boolean type size: "+t);r=b}return this.fromWireType(r[e>>s])},Z:null})},F:function(e,t){oe(e,{name:t=ee(t),fromWireType:function(e){var t=ce[e].value;return 4<e&&0==--ce[e].ka&&(ce[e]=void 0,le.push(e)),t},toWireType:function(e,t){return function(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=le.length?le.pop():ce.length;return ce[t]={ka:1,value:e},t}}(t)},argPackAdvance:8,readValueFromPointer:he,Z:null})},l:function(e,t,a){a=Q(a),oe(e,{name:t=ee(t),fromWireType:function(e){return e},toWireType:function(e,t){if("number"!=typeof t&&"boolean"!=typeof t)throw new TypeError('Cannot convert "'+de(t)+'" to '+this.name);return t},argPackAdvance:8,readValueFromPointer:ue(t,a),Z:null})},e:function(e,t,a,r,n){function s(e){return e}t=ee(t),-1===n&&(n=4294967295);var i=Q(a);if(0===r){var o=32-8*a;s=function(e){return e<<o>>>o}}var l=-1!=t.indexOf("unsigned");oe(e,{name:t,fromWireType:s,toWireType:function(e,a){if("number"!=typeof a&&"boolean"!=typeof a)throw new TypeError('Cannot convert "'+de(a)+'" to '+this.name);if(a<r||a>n)throw new TypeError('Passing a number "'+de(a)+'" from JS side to C/C++ side to an argument of type "'+t+'", which is outside the valid range ['+r+", "+n+"]!");return l?a>>>0:0|a},argPackAdvance:8,readValueFromPointer:me(t,i,0!==r),Z:null})},d:function(e,t,a){function r(e){e>>=2;var t=v;return new n(t.buffer,t[e+1],t[e])}var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];oe(e,{name:a=ee(a),fromWireType:r,argPackAdvance:8,readValueFromPointer:r},{ia:!0})},k:function(e,t){var a="std::string"===(t=ee(t));oe(e,{name:t,fromWireType:function(e){var t=v[e>>2];if(a){var r=g[e+4+t],n=0;0!=r&&(n=r,g[e+4+t]=0);var s=e+4;for(r=0;r<=t;++r){var i=e+4+r;if(0==g[i]){if(s=M(s),void 0===o)var o=s;else o+=String.fromCharCode(0),o+=s;s=i+1}}0!=n&&(g[e+4+t]=n)}else{for(o=Array(t),r=0;r<t;++r)o[r]=String.fromCharCode(g[e+4+r]);o=o.join("")}return ke(e),o},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var r="string"==typeof t;r||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||ie("Cannot pass non-string to std::string");var n=(a&&r?function(){return k(t)}:function(){return t.length})(),s=De(4+n+1);if(v[s>>2]=n,a&&r)U(t,g,s+4,n+1);else if(r)for(r=0;r<n;++r){var i=t.charCodeAt(r);255<i&&(ke(s),ie("String has UTF-16 code units that do not fit in 8 bits")),g[s+4+r]=i}else for(r=0;r<n;++r)g[s+4+r]=t[r];return null!==e&&e.push(ke,s),s},argPackAdvance:8,readValueFromPointer:he,Z:function(e){ke(e)}})},E:function(e,t,a){if(a=ee(a),2===t)var r=function(){return S},n=1;else 4===t&&(r=function(){return v},n=2);oe(e,{name:a,fromWireType:function(e){for(var t=r(),a=v[e>>2],s=Array(a),i=e+4>>n,o=0;o<a;++o)s[o]=String.fromCharCode(t[i+o]);return ke(e),s.join("")},toWireType:function(e,a){var s=r(),i=a.length,o=De(4+i*t);v[o>>2]=i;for(var l=o+4>>n,c=0;c<i;++c)s[l+c]=a.charCodeAt(c);return null!==e&&e.push(ke,o),o},argPackAdvance:8,readValueFromPointer:he,Z:function(e){ke(e)}})},D:function(e,t){oe(e,{ua:!0,name:t=ee(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},b:function(){t.abort()},B:pe,A:function(e,t,a){g.set(g.subarray(t,t+a),e)},z:function(e){if(2147418112<e)return!1;for(var t=Math.max(pe(),16777216);t<e;)t=536870912>=t?D(2*t):Math.min(D((3*t+2147483648)/4),2147418112);return!!function(e){e=D(e);var t=f.byteLength;try{return-1!==p.grow((e-t)/65536)&&(f=p.buffer,!0)}catch(e){return!1}}(t)&&(I(),!0)},h:function e(t){if(0===t)return 0;if(t=M(t),!fe.hasOwnProperty(t))return 0;e.X&&ke(e.X);var a=k(t=fe[t])+1,r=De(a);return r&&U(t,A,r,a),e.X=r},y:function(e){return Math.log(e)/Math.LN2},g:function(e){var t=Ae.X[e];Ae.X.splice(e,1),Re(t)},f:Ae,x:function(){Ee("trap!")},w:function(){return 0},u:function(){},t:function(){},s:function(e,t,a,r){return we(e,t,a,r)},r:function(){Ee("OOM")},a:350016},f);t.asm=ye;var Ce=t.__GLOBAL__sub_I_bind_cpp=function(){return t.asm.J.apply(null,arguments)},Me=t.__ZSt18uncaught_exceptionv=function(){return t.asm.K.apply(null,arguments)};t.___embind_register_native_and_builtin_types=function(){return t.asm.L.apply(null,arguments)},t.___getTypeName=function(){return t.asm.M.apply(null,arguments)},t._convert_glsl_to_spirv=function(){return t.asm.N.apply(null,arguments)},t._destroy_output_buffer=function(){return t.asm.O.apply(null,arguments)};var Ue,ke=t._free=function(){return t.asm.P.apply(null,arguments)},De=t._malloc=function(){return t.asm.Q.apply(null,arguments)},Ie=t.stackAlloc=function(){return t.asm.T.apply(null,arguments)},Re=t.stackRestore=function(){return t.asm.U.apply(null,arguments)},Be=t.stackSave=function(){return t.asm.V.apply(null,arguments)};function Pe(){function e(){if(!Ue&&(Ue=!0,!T)){if(B(E),B(F),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();V.unshift(e)}B(V)}}if(!(0<N)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)O();B(P),0<N||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),e()}),1)):e())}}function Ee(e){throw t.onAbort&&t.onAbort(e),c(e),h(e),T=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(t.dynCall_v=function(){return t.asm.R.apply(null,arguments)},t.dynCall_vi=function(){return t.asm.S.apply(null,arguments)},t.asm=ye,t.then=function(e){if(Ue)e(t);else{var a=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){a&&a(),e(t)}}return t},G=function e(){Ue||Pe(),Ue||(G=e)},t.run=Pe,t.abort=Ee,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return t.noExitRuntime=!0,Pe(),e});"undefined"!=typeof self&&self,r=()=>{const e=e=>(e=e||"glslang.wasm",new Promise(t=>{n({locateFile:()=>e,onRuntimeInitialized(){t({compileGLSLZeroCopy:this.compileGLSLZeroCopy,compileGLSL:this.compileGLSL})}})}));let t;return a=>(t||(t=e(a)),t)},e.exports=r()}).call(this,a(57))},function(e,t,a){"use strict";function r(e,t,a,r,n){const s=new Uint8Array(t*a*4);if(e.readPixels(0,0,t,a,e.RGBA,e.UNSIGNED_BYTE,s),n)for(let e=3;e<s.length;e+=4)s[e]=255;r.width=e.drawingBufferWidth,r.height=e.drawingBufferHeight;const i=r.getContext("2d"),o=i.createImageData(t,a);o.data.set(s),i.putImageData(o,0,0),i.save(),i.globalCompositeOperation="copy",i.setTransform(1,0,0,-1,0,a),i.drawImage(r,0,0),i.restore()}Object.defineProperty(t,"__esModule",{value:!0}),t.downloadRenderbufferToCanvas=function(e,t,a,n){const s=e.createFramebuffer();e.bindFramebuffer(e.READ_FRAMEBUFFER,s),e.bindRenderbuffer(e.RENDERBUFFER,t),e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,t);const i=e.getRenderbufferParameter(e.RENDERBUFFER,e.RENDERBUFFER_WIDTH),o=e.getRenderbufferParameter(e.RENDERBUFFER,e.RENDERBUFFER_HEIGHT);r(e,i,o,a,n),e.deleteFramebuffer(s)},t.downloadTextureToCanvas=function(e,t,a,n,s,i){const o=e.createFramebuffer();e.bindFramebuffer(e.READ_FRAMEBUFFER,o),e.framebufferTexture2D(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),r(e,a,n,s,i),e.deleteFramebuffer(o)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenderStatisticsTracker=class{constructor(){this.drawCallCount=0,this.textureBindCount=0,this.bufferUploadCount=0,this.triangleCount=0,this.frameStartCPUTime=0,this.frameCPUTime=0,this.fps=0}beginFrame(){this.frameStartCPUTime=window.performance.now(),this.drawCallCount=0,this.textureBindCount=0,this.bufferUploadCount=0,this.triangleCount=0,this.frameCPUTime=0,this.fps=0}endFrame(){return this.frameCPUTime=window.performance.now()-this.frameStartCPUTime,this.fps=1e3/this.frameCPUTime,this}applyDebugGroup(e){this.drawCallCount+=e.drawCallCount,this.textureBindCount+=e.textureBindCount,this.bufferUploadCount+=e.bufferUploadCount,this.triangleCount+=e.triangleCount}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r='"Source Code Pro", "Droid Sans Mono", monospace';function n(e,t){const a=e.ownerDocument.defaultView;let r=!1;function n(e){t(e),r&&a.requestAnimationFrame(n)}new IntersectionObserver((function(e){const{intersectionRatio:t}=e[e.length-1];var s;r!=(s=t>0)&&(r=s,r&&a.requestAnimationFrame(n))})).observe(e)}function s(e,t,a){console.assert("#"===e[0]&&7===e.length);const r=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16);console.assert("#"===t[0]&&7===t.length);const i=parseInt(t.slice(1,3),16),o=n+(parseInt(t.slice(3,5),16)-n)*a,l=s+(parseInt(t.slice(5,7),16)-s)*a;return`#${(0|r+(i-r)*a).toString(16)}${(0|o).toString(16)}${(0|l).toString(16)}`}function i(e){console.assert("#"===e[0]&&7===e.length);const t=(0|.299*parseInt(e.slice(1,3),16)+.587*parseInt(e.slice(3,5),16)+.114*parseInt(e.slice(5,7),16)).toString(16);return`#${t}${t}${t}`}class o{constructor(e){this._document=e,this._styleElem=this._document.createElement("style"),this._document.head.appendChild(this._styleElem),this._style=this._styleElem.sheet,this._owner=null}setCursor(e,t){if(!this._owner||e===this._owner)if(this._style.cssRules.length&&this._style.deleteRule(0),t){const a=`* { cursor: ${t} !important; }`;this._style.insertRule(a,0),this._owner=e}else this._owner=null}}class l{constructor(e,t){this._document=e,this._cursorOverride=t,this.onvalue=null,this.onend=null,this.onvalue=null,this.onend=null,this._toplevel=this._document.createElement("div"),this._toplevel.style.position="absolute",this._toplevel.style.transform="translate(0, -50%)",this._toplevel.style.fontFamily=r,this._toplevel.style.backgroundColor="#232323",this._toplevel.style.color="#c93",this._toplevel.style.border="2px solid #c93",this._toplevel.style.lineHeight="2em",this._toplevel.style.marginLeft="1em",this._toplevel.style.borderRadius="6px",this._toplevel.style.boxShadow="rgba(0, 0, 0, .4) 0px 4px 16px",this._toplevel.style.zIndex="9999",this._segments=[];for(let e=2;e>=-2;e--){const t=Math.pow(10,e),a=this._document.createElement("div");a._incr=t,a.style.padding=".5em 1em",a.textContent=""+t,this._toplevel.appendChild(a),this._segments.push(a)}this._anchorMouseX=0,this._anchorValue=void 0,this._value=void 0,this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this)}_onMouseMove(e){e.stopPropagation();const t=Math.round((e.clientX-this._anchorMouseX)/15),a=this._anchorValue+t*this._currentIncr;this._value!==a&&(this._value=a,this.onvalue(this._value));const r=e.clientY;for(const t of this._segments){if(r<t.getBoundingClientRect().bottom){this._selectSegment(t)&&this._anchorValue!==this._value&&(this._anchorMouseX=e.clientX,this._anchorValue=this._value);break}}}_onMouseUp(e){if(this._cursorOverride.setCursor(this,""),this._document.documentElement.removeEventListener("mouseup",this._onMouseUp),this.onend(),this._showTimeout)return clearTimeout(this._showTimeout),void(this._showTimeout=0);this._document.documentElement.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),this._document.body.removeChild(this._toplevel)}_selectSegment(e){const t=e._incr;if(this._currentIncr===t)return!1;this._currentIncr=t;for(const t of this._segments){const a=t===e;t.style.backgroundColor=a?"#c93":"",t.style.color=a?"#222":"",t.style.fontWeight=a?"bold":""}return!0}_show(){this._showTimeout=0,this._document.body.appendChild(this._toplevel),this._document.documentElement.addEventListener("mousemove",this._onMouseMove,{capture:!0})}setPosition(e,t){this._toplevel.style.left=e+"px",this._toplevel.style.top=t+"px"}show(e,t){this._anchorMouseX=t.clientX,this._anchorValue=e,this._selectSegment(this._segments[2]),this._document.documentElement.addEventListener("mouseup",this._onMouseUp),this._showTimeout=window.setTimeout(this._show.bind(this),100),this._cursorOverride.setCursor(this,"e-resize")}}t.default=class{constructor(e){this._document=e,this.onvaluechanged=null,this.onvaluechanged=null,this._prefix="",this._suffix="",this._paddingTop=.2,this._paddingBottom=1.5,this._toplevel=this._document.createElement("div"),this._toplevel.style.position="relative",this._document.body.appendChild(this._toplevel),this._textarea=this._document.createElement("textarea"),this._textarea.style.fontFamily=r,this._textarea.oninput=this._onInput.bind(this),this._textarea.onkeydown=this._onKeyDown.bind(this),this._toplevel.appendChild(this._textarea),this._canvas=this._document.createElement("canvas"),this._toplevel.appendChild(this._canvas),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onMouseLeave=this._onMouseLeave.bind(this),this._canvas.onmousedown=this._onMouseDown,this._canvas.onmouseleave=this._onMouseLeave,this._canvas.onmousemove=this._onMouseMove,this._textarea.style.whiteSpace="pre-wrap",this._textarea.style.wordBreak="break-all",this._textarea.style.position="absolute",this._textarea.style.left="-99999px",this._canvas.style.position="absolute",this._needsRecalculate=!1,this._valueChanged=!1,this._redraw_cursorPosition=void 0,this._redraw_cursorBlinkStart=void 0,this._cursorOverride=new o(this._document),this._numberDragger=new l(this._document,this._cursorOverride),this._numberDragger.onvalue=this._onNumberDraggerValue.bind(this),this._numberDragger.onend=this._onNumberDraggerEnd.bind(this),this.elem=this._toplevel,n(this._canvas,this._redraw.bind(this))}_setNeedsRecalculate(){this._needsRecalculate=!0}_setValueChanged(){this._valueChanged=!0}setPrefixSuffix(e,t){this._prefix=e,this._suffix=t,this._setNeedsRecalculate()}setFontSize(e){this._textarea.style.fontSize=e,this._setNeedsRecalculate()}setLineFlairs(e){this._lineFlairs=e}setSize(e,t){void 0!==t&&(this._minHeight=t),void 0!==e&&(this._width=e,this._canvas.style.width=`${e}px`,this._toplevel.style.width=`${e}px`,this._cols=this._xyToRowCol(e,0).col,this._textarea.style.width=`${this._cols}ch`),void 0===e&&void 0===t||this._setNeedsRecalculate()}getValue(){return this._textarea.value}setValue(e){this._textarea.value=e,this._setValueChanged(),this._setNeedsRecalculate()}getFullText(){return this._prefix+this._textarea.value+this._suffix}_isLineLocked(e){return e.lineno<this._prefixLines||e.lineno>=this._suffixLines}_recalculate(){if(!this._needsRecalculate)return;if(!this._toplevel.parentNode)return;const e=this.getFullText()+"\n",t=[];let a=0,r=0,n=0;for(;;){let s=e.indexOf("\n",a);if(s<0)break;const i=a,o=s+1,l=o-i-1,c=r,h=Math.max(Math.ceil(l/this._cols),1);t.push({start:i,end:o,length:l,rows:h,startRow:c,lineno:n}),r+=h,n++,a=o}this._lineModel=t,this._prefixLines=this._prefix.split("\n").length-1,this._suffixLines=this._lineModel.length-(this._suffix.split("\n").length-1);const s=[],i=[];let o;const l=/\b(function|for|while|if|else|break|continue|in|out|attribute|uniform|varying|return|struct|layout|precision|mediump|lowp|highp|discard)\b/g;for(;null!==(o=l.exec(e));)s.push({start:o.index,end:o.index+o[0].length,color:"#c26230"});const c=/\b(void|bool|float|[ui]?vec[234]|mat[234]|mat[234]x[234]|[u]?int|sampler[23]D)\b/g;for(;null!==(o=c.exec(e));)s.push({start:o.index,end:o.index+o[0].length,color:"#6d9cbe"});const h=/\W-?\d+(\.\d+)?\b/g;for(;null!==(o=h.exec(e));)s.push({start:o.index+1,end:o.index+o[0].length,color:"#a5c261"}),i.push({start:o.index+1,end:o.index+o[0].length});const d=/("[^"]*")|('[^']*')/g;for(;null!==(o=d.exec(e));)s.push({start:o.index,end:o.index+o[0].length,color:"#6d9cbe"});const u=/\/\/.*$/gm;for(;null!==(o=u.exec(e));)s.push({start:o.index,end:o.index+o[0].length,color:"#bc9458",style:"italic"});s.sort((e,t)=>e.start-t.start),this._syntaxRuns=s,this._draggableNumbers=i;const m=this._document.defaultView.getComputedStyle(this._textarea);this._textareaStyle=m;const p=this._canvas.getContext("2d");p.font=`${m.fontSize} ${m.fontFamily}`,this._charWidth=p.measureText(" ").width;const f=m.lineHeight;let A;if(A="normal"===f?1.3*parseFloat(m.fontSize):parseFloat(f),this._rowHeight=Math.ceil(A),void 0===this._charMarginTop){const e=4;this._charMarginTop=e-function(e,t,a,r){const n=e.createElement("canvas");n.width=t,n.height=a;const s=n.getContext("2d");s.font=r,s.textBaseline="top",s.fillStyle="black",s.fillText("l",0,0);const i=s.getImageData(0,0,t,a);for(let e=0;e<i.height;e++)for(let t=0;t<i.width;t++)if(i.data[4*(e*i.width+t)+3])return e;throw new Error("wtf")}(this._document,this._charWidth,this._rowHeight,p.font)}const g=(""+this._lineModel.length).length;this._gutterMargin=10,this._gutterWidth=this._charWidth*Math.max(g,2)+2*this._gutterMargin,this._textMargin=10;const _=this._lineModel[this._lineModel.length-1],S=_.startRow+_.rows-1,b=Math.ceil(Math.max(this._minHeight,this._rowHeight*(S+this._paddingTop+this._paddingBottom)));b!==this._height&&(this._height=b,this._canvas.style.height=`${this._height}px`,this._toplevel.style.height=`${this._height}px`,this._textarea.style.height=this._height-this._rowHeight+"px"),this._needsRecalculate=!1,this._recalculateMouseIdx(),this._valueChanged&&this.onvaluechanged&&this.onvaluechanged(),this._valueChanged=!1}_recalculateMouseIdx(){if(void 0===this._mouseX||void 0===this._mouseY)this._mouseIdx=void 0;else{const{row:e,col:t}=this._xyToRowCol(this._mouseX,this._mouseY),{line:a,idx:r}=this._rowColToLineIdx(e,t,!1),n=this._isLineLocked(a);this._mouseIdx=n?void 0:r}}_calculateIndentedLineStart(e){const t=this.getFullText();let a=e.start;for(;" "===t.charAt(a)&&a<=e.end;)a++;return a}_onInput(){this._setValueChanged(),this._setNeedsRecalculate()}_onKeyDown(e){if("Tab"!==e.key||e.shiftKey){if("Tab"===e.key&&e.shiftKey)e.preventDefault();else if("Home"===e.key){const t=this._getCursorIdx(),{line:a,lineIdx:r}=this._getCharPos(t),n=this._calculateIndentedLineStart(a);if(t!==n){if(e.shiftKey){const[e]=this._getSelection();this._setSelection(this._idxToTextarea(e),this._idxToTextarea(n))}else this._setCursor(this._idxToTextarea(n));e.preventDefault()}}}else this._hasSelection()||this._insertAtCursor("    "),e.preventDefault()}_onMouseDown(e){e.preventDefault();const{row:t,col:a}=this._xyToRowCol(e.offsetX,e.offsetY),{line:r}=this._rowColToLineIdx(t,0,!0);if(this._isLineLocked(r))this._textarea.blur();else if(-1===a)this._setSelection(this._idxToTextarea(r.start),this._idxToTextarea(r.end)),this._textarea.focus();else{const{idx:r}=this._rowColToLineIdx(t,a,!0);this._textarea.focus();const{idx:n}=this._rowColToLineIdx(t,a,!1),s=this._findDraggableNumber(n);if(!e.shiftKey&&s){const t=this._idxToTextarea(s.start),a=this._idxToTextarea(s.end),n=+this.getValue().slice(t,a);this._draggingNumber={start:t,end:a,value:n},this._syncNumberDraggerPosition(),this._setCursor(this._idxToTextarea(r)),this._numberDragger.show(n,e)}else e.shiftKey?(this._hasSelection()||(this._dragStartIdx=this._textarea.selectionStart),this._setSelection(this._dragStartIdx,this._idxToTextarea(r))):(this._dragStartIdx=this._idxToTextarea(r),this._setCursor(this._dragStartIdx)),this._dragging="selection",this._document.documentElement.addEventListener("mousemove",this._onMouseMove,{capture:!0}),this._document.documentElement.addEventListener("mouseup",this._onMouseUp)}}_onMouseUp(e){this._dragging=void 0,this._document.documentElement.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),this._document.documentElement.removeEventListener("mouseup",this._onMouseUp)}_onMouseMove(e){e.stopPropagation(),this._mouseX=e.offsetX,this._mouseY=e.offsetY,this._recalculateMouseIdx();const{row:t,col:a}=this._xyToRowCol(this._mouseX,this._mouseY),{line:r,idx:n}=this._rowColToLineIdx(t,a,!0);"selection"===this._dragging&&(this._setSelection(this._dragStartIdx,this._idxToTextarea(n)),this._textarea.focus());const{line:s,idx:i}=this._rowColToLineIdx(t,a,!1),o=this._isLineLocked(r);let l;l="selection"===this._dragging?"text":-1===a||o?"default":!e.shiftKey&&this._findDraggableNumber(i)?"e-resize":"text",this._canvas.style.cursor=l,this._dragging?this._cursorOverride.setCursor(this,l):this._cursorOverride.setCursor(this,"")}_onMouseLeave(e){this._mouseX=void 0,this._mouseY=void 0,this._mouseIdx=void 0}_onNumberDraggerValue(e){this._textarea.blur();const{start:t,end:a}=this._draggingNumber,r=function(e,t=2){let a=e.toFixed(t);for(;a.includes(".")&&".0".includes(a.slice(-1));)a=a.slice(0,-1);return a}(e);this.setValue(this._spliceValue(t,a,r)),this._draggingNumber.end=t+r.length,this._syncNumberDraggerPosition()}_onNumberDraggerEnd(){this._draggingNumber=null}_syncNumberDraggerPosition(){const{end:e}=this._draggingNumber,t=this._getCharPos(this._textareaToIdx(e)),{x:a,y:r}=this._rowColToXY(t.row,t.col),n=this._toplevel.getBoundingClientRect(),s=n.left+a,i=n.top+r+this._rowHeight/2+this._document.defaultView.scrollY;this._numberDragger.setPosition(s,i)}_spliceValue(e,t,a){const r=this.getValue();return r.slice(0,e)+a+r.slice(t)}_findDraggableNumber(e){return this._recalculate(),this._draggableNumbers.find(({start:t,end:a})=>e>=t&&e<=a)}_idxToTextarea(e){return e-this._prefix.length}_textareaToIdx(e){return e+this._prefix.length}_rowColToLineIdx(e,t,a){this._recalculate();let r,n,s=this._lineModel[0];for(s of this._lineModel)if(e>=s.startRow&&e<s.startRow+s.rows)break;return r=1===s.rows?t:(e-s.startRow)*this._cols+t,n=a?s.start+Math.min(Math.max(r,0),s.length):r>s.length?-1:s.start+r,{line:s,idx:n}}_xyToRowCol(e,t){this._recalculate(),t-=this._paddingTop*this._rowHeight;const a=Math.floor(t/this._rowHeight);let r;return e<this._gutterWidth&&(r=-1),e-=this._gutterWidth,void 0===r&&e<this._textMargin&&(r=0),e-=this._textMargin,void 0===r&&(r=Math.round(e/this._charWidth)),{row:a,col:r}}_rowColToXY(e,t){return{x:this._gutterWidth+this._textMargin+t*this._charWidth,y:(this._paddingTop+e)*this._rowHeight}}_getRowLength(e){this._recalculate();let t=this._lineModel[0];for(t of this._lineModel)if(e>=t.startRow&&e<t.startRow+t.rows)break;return 1===t.rows?t.length:e===t.startRow+t.rows-1?t.length%this._cols:this._cols}_getCharPos(e){this._recalculate();let t=this._lineModel[0];for(t of this._lineModel)if(e>=t.start&&e<t.end)break;const a=e-t.start;if(1===t.rows)return{line:t,lineIdx:a,row:t.startRow,col:a};const r=a%this._cols;return{line:t,lineIdx:a,row:t.startRow+Math.min(a/this._cols|0,t.rows),col:r}}_hasSelection(){return this._textarea.selectionStart!==this._textarea.selectionEnd}_getSelection(){const e=this._textareaToIdx(this._textarea.selectionStart),t=this._textareaToIdx(this._textarea.selectionEnd);return"forward"===this._textarea.selectionDirection?[e,t]:[t,e]}_getCursorIdx(){const[e,t]=this._getSelection();return t}_setSelection(e,t){const a=Math.min(e,t),r=Math.max(e,t),n=e<t?"forward":"backward";this._textarea.setSelectionRange(a,r,n)}_setCursor(e){this._textarea.setSelectionRange(e,e)}_insertAtCursor(e){if(this._textarea.focus(),!this._document.execCommand("insertText",!1,e)){const t=this._textarea.value,a=this._textarea.selectionStart,r=this._textarea.selectionEnd;this._textarea.value=t.slice(0,a)+e+t.slice(r),this._textarea.focus()}this._setValueChanged(),this._setNeedsRecalculate()}_redraw(e){const t=this._textarea.matches(":focus");if(!this._needsRecalculate&&!t)return;this._recalculate();const a=this._canvas.getBoundingClientRect(),r=this._document.defaultView,n=r.devicePixelRatio,o=this._width*n,l=this._height*n;let c=!1;this._canvas.width===o&&this._canvas.height===l||(this._canvas.width=o,this._canvas.height=l,c=!0);const h=Math.max(0,a.left),d=Math.max(0,a.top),u=r.innerWidth,m=r.innerHeight,p=Math.min(u,a.right),f=Math.min(m,a.bottom),A=h-a.left,g=d-a.top,_=p-h,S=f-d,b=this._canvas.getContext("2d");b.save(),c||(b.rect(A,g,_,S),b.clip()),b.scale(n,n);if(b.fillStyle="#232323",b.fillRect(0,0,this._width,this._height),t){const t=this._idxToTextarea(this._getCursorIdx());this._redraw_cursorPosition!==t&&(this._redraw_cursorPosition=t,this._redraw_cursorBlinkStart=e)}else this._redraw_cursorPosition=void 0;const v=this._textareaStyle.fontSize,w=this._textareaStyle.fontFamily;b.font=`${v} ${w}`;const x=(e,t)=>{const a=(this._paddingTop+e.startRow)*this._rowHeight;e.rows,this._rowHeight;b.fillStyle=t.color,b.fillRect(0,a,this._canvas.width,this._rowHeight)};if(this._redraw_cursorPosition){const{line:e}=this._getCharPos(this._textareaToIdx(this._redraw_cursorPosition));x(e,{color:"#2f2a34",lineno:-1})}if(this._lineFlairs)for(const e of this._lineFlairs){const t=this._lineModel[e.lineno];t&&x(t,e)}b.save(),b.fillStyle="#445",b.fillRect(0,0,this._gutterWidth,this._canvas.height),b.restore();for(let e=0;e<this._lineModel.length;e++){const t=this._lineModel[e],a=t.lineno+1,r=(this._paddingTop+t.startRow)*this._rowHeight;b.fillStyle=this._isLineLocked(t)?"#888":"#ccc",b.textBaseline="top",b.textAlign="right";const n=""+a;b.fillText(n,this._gutterWidth-this._gutterMargin,this._charMarginTop+r)}const T=this.getFullText()+"\n";if(b.save(),b.translate(this._gutterWidth+this._textMargin,0),this._hasSelection()){const e=this._getCharPos(this._textareaToIdx(this._textarea.selectionStart)),a=this._getCharPos(this._textareaToIdx(this._textarea.selectionEnd));for(let r=e.row;r<=a.row;r++){let n=r===e.row?e.col:0,s=r===a.row?a.col:this._getRowLength(r);const i=t?"#336":"#333",o=n*this._charWidth,l=s*this._charWidth,c=(this._paddingTop+r)*this._rowHeight;b.fillStyle=i,b.fillRect(o,c,l-o,this._rowHeight)}}const y=this._syntaxRuns;let C,M,U=0;if(this._draggingNumber){const{start:e,end:t}=this._draggingNumber;C={start:this._textareaToIdx(e),end:this._textareaToIdx(t)}}else!this._dragging&&this._mouseIdx>-1&&(C=this._findDraggableNumber(this._mouseIdx));for(let t=0;t<this._lineModel.length;t++){const a=this._lineModel[t];let r=a.startRow,n=0;for(let t=a.start;t<a.end;t++){n===this._cols&&r-a.startRow<a.rows-1&&(r++,n=0);const o=T.charAt(t),l=n*this._charWidth,c=(this._paddingTop+r)*this._rowHeight;if(t===this._textareaToIdx(this._redraw_cursorPosition)){b.save(),b.fillStyle="#fff";const t=(e-this._redraw_cursorBlinkStart)/1e3,a=Math.sin(6*t)+1;b.globalAlpha=a,b.fillRect(Math.floor(l),c,2,this._rowHeight),b.restore()}if("\n"===o)break;void 0!==C&&t>=C.start&&t<C.end&&(b.save(),b.beginPath(),b.moveTo(0|l,c+this._rowHeight),b.lineTo(l+this._charWidth|0,c+this._rowHeight),b.setLineDash([1,1]),b.strokeStyle="rgba(255, 255, 255, 0.6)",b.lineWidth=1,b.stroke(),b.restore());let h="#e6e1dc",d="";for(;U<y.length&&t>=y[U].end;)U++;if(U<y.length){const e=y[U];t>=e.start&&t<e.end&&(e.color&&(h=e.color),e.style&&(d=e.style))}this._isLineLocked(a)&&(h=s(h,i(h),.75)),b.textBaseline="top",b.textAlign="left",b.fillStyle=h;const u=`${d} ${v} ${w}`;M!==u&&(b.font=u,M=u),b.fillText(o,l,c+this._charMarginTop),n++}}b.restore(),b.restore()}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(7),s=a(77),i=a(0),o=a(2),l=a(156);function c(e,t=-e){return o.lerp(e,t,Math.random())}t.randomRange=c,t.snowballSplashIndex=28,t.fireballIndex=29,t.lavaSmokeIndex=30;const h=r.vec3.create();class d{constructor(e){this.timer=-1,this.lifetime=0,this.parent=null,this.modelMatrix=r.mat4.create(),this.velocity=r.vec3.create(),this.targetVelocity=r.vec3.create(),this.accel=r.vec3.create(),this.sinceUpdate=0,this.relativeScale=!1,this.startScale=0,this.endScale=0,this.scaleX=0,this.scaleY=0,this.rotationSpeed=0,this.motionType=0,this.flipbook=new s.FlipbookRenderer(e),this.flipbook.sortKeyBase=n.makeSortKey(132)}init(e,t,a,n=0){switch(this.type=t,r.mat4.copy(this.modelMatrix,a),r.vec3.set(this.velocity,0,0,0),r.vec3.set(this.targetVelocity,0,0,0),r.vec3.set(this.accel,0,0,0),this.scaleX=0,this.scaleY=0,this.flipbook.rotationAngle=0,this.rotationSpeed=0,r.vec4.set(this.flipbook.primColor,1,1,1,1),r.vec2.set(this.flipbook.screenOffset,0,0),this.relativeScale=!1,this.type){case 0:this.timer=20/30,this.motionType=0,this.rotationSpeed=7*.01745*30,r.vec4.set(this.flipbook.primColor,1,1,1,180/255),this.flipbook.changeData(e.getFlipbook(n),1);break;case 1:this.timer=20/30,this.motionType=1,this.velocity[1]=-200,this.modelMatrix[12]+=c(30),this.modelMatrix[13]+=c(30),this.modelMatrix[14]+=c(30);let t=16;Math.random()<.25?t=17:Math.random()<.5&&(t=22),this.flipbook.changeData(e.getFlipbook(t),1);break;case 2:this.timer=14/30,this.velocity[1]=-40,this.motionType=1,this.modelMatrix[12]+=c(40),this.modelMatrix[14]+=c(40),r.vec4.set(this.flipbook.primColor,c(210/255,1),c(190/255,1),c(200/255,1),1),this.flipbook.changeData(e.getFlipbook(15),0,!0);break;case 4:this.timer=10,this.motionType=1,this.endScale=200,r.vec3.set(this.targetVelocity,0,80,0),r.vec4.set(this.flipbook.primColor,180/255,240/255,160/255,160/255),this.flipbook.changeData(e.getFlipbook(4),0,!0),this.sinceUpdate=1;break;case 3:this.relativeScale=!0,this.motionType=2,this.parent.initParticle(e,this),this.timer=this.lifetime}}update(e){switch(this.type){case 0:case 1:case 2:this.scaleX=d.sparkleDimensions[30*this.timer>>>0],this.scaleY=this.scaleX;break;case 4:const t=230*e;this.scaleX=Math.min(this.endScale,this.scaleX+t),this.scaleY=this.scaleX,r.vec2.set(this.flipbook.screenOffset,-this.scaleX/2,this.scaleY/2);for(let e=0;e<3;e++)this.velocity[e]<this.targetVelocity[e]?this.velocity[e]=Math.min(this.velocity[e]+10*t,this.targetVelocity[e]):this.velocity[e]=Math.max(this.velocity[e]-10*t,this.targetVelocity[e]);this.sinceUpdate+=e,this.sinceUpdate>1/15&&(this.sinceUpdate=0,this.targetVelocity[0]=100*Math.random()-50,this.targetVelocity[2]=100*Math.random()-50);break;case 3:this.parent.config.updateParticle(this)}if(this.motion(e),r.mat4.copy(this.flipbook.modelMatrix,this.modelMatrix),this.relativeScale)r.vec3.set(h,this.scaleX,this.scaleY,1);else{const e=this.flipbook.flipbookData.flipbook;r.vec3.set(h,this.scaleX/e.width,this.scaleY/e.height,1)}return r.mat4.scale(this.flipbook.modelMatrix,this.flipbook.modelMatrix,h),this.flipbook.rotationAngle+=this.rotationSpeed*e,this.timer-=e,this.timer>=0}prepareToRender(e,t,a){this.update(a.deltaTime/1e3),this.flipbook.prepareToRender(e,t,a)}motion(e){0!==this.motionType&&(r.mat4.getTranslation(h,this.modelMatrix),1!==this.motionType&&r.vec3.scaleAndAdd(this.velocity,this.velocity,this.accel,e),r.vec3.scaleAndAdd(h,h,this.velocity,e),this.modelMatrix[12]=h[0],this.modelMatrix[13]=h[1],this.modelMatrix[14]=h[2])}}d.sparkleDimensions=[10,10,15,20,25,30,35,40,45,50,54,58,62,66,70,74,76,78,80,40,20];class u{constructor(){this.emitCount=0,this.modelMatrix=r.mat4.create(),this.movementController=null}update(e,t,a){for(null!==this.movementController&&this.movementController.movement(this.modelMatrix,t);this.emitCount>=1;)this.emit(e),this.emitCount--}emit(e){const t=e.getParticle();return null!==t&&(this.init(e,t),!0)}init(e,t){}}class m extends u{constructor(e,t=19){super(),this.type=e,this.sparkleColor=t}init(e,t){t.parent=this,t.init(e,this.type,this.modelMatrix,this.sparkleColor)}}t.Emitter=m;const p=r.vec3.create();t.emitAlongLine=function(e,t,a,n,s){for(let i=0;i<s;i++)if(r.vec3.lerp(p,a,n,i/(s-1)),r.mat4.fromTranslation(t.modelMatrix,p),!t.emit(e))return},t.emitAt=function(e,t,a){e.modelMatrix[12]=t[12],e.modelMatrix[13]=t[13],e.modelMatrix[14]=t[14],e.emitCount=a};t.Sparkler=class extends m{constructor(e,t=19){super(0,t),this.sparkleRate=e}update(e,t,a){this.emitCount=Math.random()>Math.exp(-this.sparkleRate*a*30)?1:0,super.update(e,t,a)}};t.StreamEmitter=class extends m{constructor(e,t){super(t),this.emitRate=e,this.active=!1}update(e,t,a){this.active&&(this.emitCount+=this.emitRate*a),super.update(e,t,a)}};const f=r.vec4.fromValues(1,1,1,1);class A{constructor(e){this.spriteIndex=0,this.delayRange=r.vec2.fromValues(0,5),this.frameChance=0,this.primColor=r.vec4.fromValues(1,1,1,1),this.pulseRange=r.vec2.fromValues(0,1),this.accelMin=r.vec3.create(),this.accelMax=r.vec3.create(),this.velMin=r.vec3.create(),this.velMax=r.vec3.create(),this.offsetMin=r.vec3.create(),this.offsetMax=r.vec3.create(),this.lifetimeRange=r.vec2.fromValues(0,5),this.startScaleRange=r.vec2.fromValues(1,1),this.endScaleRange=r.vec2.create(),this.phaseRange=r.vec2.create(),this.fpsRange=r.vec2.create(),this.rotationRange=r.vec2.create(),void 0!==e&&Object.assign(this,e)}initParticle(e,t,a){b(a.accel,this.accelMin,this.accelMax),b(a.velocity,this.velMin,this.velMax),b(e,this.offsetMin,this.offsetMax),a.lifetime=S(this.lifetimeRange),a.startScale=S(this.startScaleRange),0===this.endScaleRange[0]&&0===this.endScaleRange[1]?a.endScale=a.startScale:a.endScale=S(this.endScaleRange),a.rotationSpeed=.01745*S(this.rotationRange);const n=r.vec4.exactEquals(this.primColor,f)?0:3;a.flipbook.changeData(t.getFlipbook(this.spriteIndex),n),r.vec4.copy(a.flipbook.primColor,this.primColor);for(let e=0;e<3;e++)a.flipbook.envColor[e]=Math.max(0,this.primColor[e]-8/255);a.flipbook.envColor[3]=this.primColor[3],a.flipbook.animationController.init(S(this.fpsRange),S(this.phaseRange))}updateParticle(e){const t=1-e.timer/e.lifetime;e.scaleX=o.lerp(e.startScale,e.endScale,t),e.scaleY=e.scaleX;let a=this.primColor[3];t<this.pulseRange[0]?a*=t/this.pulseRange[0]:t>this.pulseRange[1]&&(a*=1-(t-this.pulseRange[1])/(1-this.pulseRange[1])),e.flipbook.primColor[3]=a,Math.abs(e.modelMatrix[13])>1e5&&(e.timer=-1)}}t.quicksandConfig=new A({spriteIndex:13,frameChance:.2,primColor:r.vec4.fromValues(1,1,155/255,100/255),pulseRange:r.vec2.fromValues(.1,.4),offsetMin:r.vec3.fromValues(-700,0,-700),offsetMax:r.vec3.fromValues(700,0,700),velMin:r.vec3.fromValues(0,90,0),velMax:r.vec3.fromValues(0,90,0),lifetimeRange:r.vec2.fromValues(2,2.5),startScaleRange:r.vec2.fromValues(2.5,2.8),endScaleRange:r.vec2.fromValues(4,5),phaseRange:r.vec2.fromValues(1,6)}),t.torchSmokeConfig=new A({spriteIndex:13,frameChance:.025,primColor:r.vec4.fromValues(1,1,1,35/255),pulseRange:r.vec2.fromValues(.3,.7),offsetMin:r.vec3.fromValues(0,110,0),offsetMax:r.vec3.fromValues(0,110,0),velMin:r.vec3.fromValues(0,40,0),velMax:r.vec3.fromValues(0,90,0),lifetimeRange:r.vec2.fromValues(4,7),startScaleRange:r.vec2.fromValues(2.6,3.2),endScaleRange:r.vec2.fromValues(5,6),phaseRange:r.vec2.fromValues(1,6)}),t.torchSparkleConfig=new A({spriteIndex:19,frameChance:.075,pulseRange:r.vec2.fromValues(.3,.7),offsetMin:r.vec3.fromValues(0,20,0),offsetMax:r.vec3.fromValues(0,20,0),velMin:r.vec3.fromValues(-30,120,-30),velMax:r.vec3.fromValues(60,360,60),accelMin:r.vec3.fromValues(0,-90,0),accelMax:r.vec3.fromValues(0,-50,0),lifetimeRange:r.vec2.fromValues(.9,1.3),startScaleRange:r.vec2.fromValues(.1,.2),endScaleRange:r.vec2.fromValues(.2,.4),phaseRange:r.vec2.fromValues(1,6)}),t.waterfallConfig=new A({spriteIndex:14,lifetimeRange:r.vec2.fromValues(216e3,216e3),startScaleRange:r.vec2.fromValues(1.8,2.2),phaseRange:r.vec2.fromValues(0,4),fpsRange:r.vec2.fromValues(15,30)}),t.brentildaWandConfig=new A({spriteIndex:19,delayRange:r.vec2.fromValues(1/15,1/15),pulseRange:r.vec2.fromValues(.4,.8),offsetMin:r.vec3.fromValues(-15,-15,-15),offsetMax:r.vec3.fromValues(15,15,15),accelMin:r.vec3.fromValues(0,-250,0),accelMax:r.vec3.fromValues(0,-250,0),lifetimeRange:r.vec2.fromValues(.7,.7),startScaleRange:r.vec2.fromValues(.25,.3),endScaleRange:r.vec2.fromValues(.03,.03),rotationRange:r.vec2.fromValues(200,240)});const g={spriteIndex:16,delayRange:r.vec2.fromValues(1/30,1/30),primColor:r.vec4.fromValues(0,1,0,1),pulseRange:r.vec2.fromValues(0,0),velMin:r.vec3.fromValues(0,70,0),velMax:r.vec3.fromValues(0,140,0),lifetimeRange:r.vec2.fromValues(.9,.9),startScaleRange:r.vec2.fromValues(.31,.37),endScaleRange:r.vec2.fromValues(.17,.22)};t.farJumpPadConfig=new A(Object.assign(Object.assign({},g),{offsetMin:r.vec3.fromValues(-75,0,-75),offsetMax:r.vec3.fromValues(75,6,75)})),t.nearJumpPadConfig=new A(Object.assign(Object.assign({},g),{offsetMin:r.vec3.fromValues(-25,0,-25),offsetMax:r.vec3.fromValues(25,6,25)})),t.lavaRockLaunchFlameConfig=new A({spriteIndex:t.fireballIndex,pulseRange:r.vec2.fromValues(.1,.3),accelMin:r.vec3.fromValues(0,-500,0),accelMax:r.vec3.fromValues(0,-500,0),velMin:r.vec3.fromValues(-50,200,-50),velMax:r.vec3.fromValues(50,400,50),offsetMin:r.vec3.fromValues(-40,-40,-40),offsetMax:r.vec3.fromValues(40,40,40),lifetimeRange:r.vec2.fromValues(1,1.5),startScaleRange:r.vec2.fromValues(2,2),endScaleRange:r.vec2.fromValues(4,4),phaseRange:r.vec2.fromValues(0,6),fpsRange:r.vec2.fromValues(5,8)});const _={spriteIndex:t.fireballIndex,delayRange:r.vec2.fromValues(1/30,1/30),pulseRange:r.vec2.fromValues(.1,.2),lifetimeRange:r.vec2.fromValues(.5,.5),phaseRange:r.vec2.fromValues(2,8),fpsRange:r.vec2.fromValues(8,8)};function S(e){return e[0]+Math.random()*(e[1]-e[0])}function b(e,t,a){for(let r=0;r<3;r++)e[r]=t[r]+Math.random()*(a[r]-t[r])}t.lavaRockBigTrailConfig=new A(Object.assign(Object.assign({},_),{startScaleRange:r.vec2.fromValues(4,4),endScaleRange:r.vec2.fromValues(1.6,1.6)})),t.lavaRockSmallTrailConfig=new A(Object.assign(Object.assign({},_),{startScaleRange:r.vec2.fromValues(2,2),endScaleRange:r.vec2.fromValues(.8,.8)})),t.lavaRockShardsConfig=new A({pulseRange:r.vec2.fromValues(.4,.6),accelMin:r.vec3.fromValues(0,-1e3,0),accelMax:r.vec3.fromValues(0,-1e3,0),velMin:r.vec3.fromValues(-400,400,-400),velMax:r.vec3.fromValues(400,800,400),offsetMin:r.vec3.fromValues(-20,-20,-20),offsetMax:r.vec3.fromValues(20,20,20),lifetimeRange:r.vec2.fromValues(3,3.5),startScaleRange:r.vec2.fromValues(.3,.5),rotationRange:r.vec2.fromValues(600,900)}),t.lavaRockExplosionConfig=new A({pulseRange:r.vec2.fromValues(.6,.7),offsetMin:r.vec3.fromValues(-80,0,-80),offsetMax:r.vec3.fromValues(80,0,80),lifetimeRange:r.vec2.fromValues(1,1),startScaleRange:r.vec2.fromValues(3,3),endScaleRange:r.vec2.fromValues(4,4),phaseRange:r.vec2.fromValues(0,2),fpsRange:r.vec2.fromValues(4,6)}),t.lavaRockSmokeConfig=new A({spriteIndex:14,primColor:r.vec4.fromValues(186/255,186/255,186/255,235/255),pulseRange:r.vec2.fromValues(.05,.1),velMin:r.vec3.fromValues(-70,-70,-70),velMax:r.vec3.fromValues(70,70,70),offsetMin:r.vec3.fromValues(-55,-55,-55),offsetMax:r.vec3.fromValues(55,55,55),lifetimeRange:r.vec2.fromValues(3,3),startScaleRange:r.vec2.fromValues(.1,.2),endScaleRange:r.vec2.fromValues(3.6,4.6),phaseRange:r.vec2.fromValues(0,7)}),t.snowballRippleConfig=new A({spriteIndex:12,primColor:r.vec4.fromValues(1,1,254/255,1),pulseRange:r.vec2.fromValues(0,.5),lifetimeRange:r.vec2.fromValues(1,1.2),startScaleRange:r.vec2.fromValues(.1,.1),endScaleRange:r.vec2.fromValues(1,1.4)}),t.snowballSplashConfig=new A({spriteIndex:t.snowballSplashIndex,primColor:r.vec4.fromValues(1,1,254/255,1),pulseRange:r.vec2.fromValues(0,.78),lifetimeRange:r.vec2.fromValues(.7,.7),startScaleRange:r.vec2.fromValues(.8,.8),endScaleRange:r.vec2.fromValues(.8,.8),fpsRange:r.vec2.fromValues(180/7,180/7)}),t.snowballBubbleConfig=new A({spriteIndex:11,primColor:r.vec4.fromValues(1,1,1,180/255),pulseRange:r.vec2.fromValues(0,.8),accelMin:r.vec3.fromValues(0,-1300,0),accelMax:r.vec3.fromValues(0,-1300,0),velMin:r.vec3.fromValues(-180,400,-180),velMax:r.vec3.fromValues(180,700,180),offsetMin:r.vec3.fromValues(-20,0,-20),offsetMax:r.vec3.fromValues(20,20,20),lifetimeRange:r.vec2.fromValues(2,2),startScaleRange:r.vec2.fromValues(.02,.04),endScaleRange:r.vec2.fromValues(.01,.01)}),t.fromBB=b;const v=r.vec3.create();class w extends m{constructor(e){super(3,e.spriteIndex),this.config=e,this.delayTimer=0,this.active=!0,this.delayTimer=S(this.config.delayRange)}initParticle(e,t){this.config.initParticle(v,e,t),t.modelMatrix[12]+=v[0],t.modelMatrix[13]+=v[1],t.modelMatrix[14]+=v[2]}update(e,t,a){this.active&&(this.config.frameChance>0?this.emitCount=Math.random()>Math.exp(-this.config.frameChance*a*30)?1:0:this.delayTimer<=0?(this.emitCount=1,this.delayTimer=S(this.config.delayRange)):this.delayTimer-=a),super.update(e,t,a)}}t.ConfigurableEmitter=w;t.WaterfallEmitter=class extends w{constructor(){super(t.waterfallConfig)}update(e,t,a){return!1}};t.ScaledEmitter=class extends w{constructor(e,t){super(t),this.scale=e}initParticle(e,t){this.config.initParticle(v,e,t),r.vec3.scale(v,v,this.scale),r.vec3.scale(t.velocity,t.velocity,this.scale),r.vec3.scale(t.accel,t.accel,this.scale),t.startScale*=this.scale,t.endScale*=this.scale,t.modelMatrix[12]+=v[0],t.modelMatrix[13]+=v[1],t.modelMatrix[14]+=v[2]}};t.JumpPadEmitter=class extends w{constructor(){super(...arguments),this.yellow=!1}initParticle(e,t){super.initParticle(e,t),this.yellow&&(t.flipbook.primColor[0]=1,t.flipbook.envColor[0]=1-8/255),this.yellow=!this.yellow}};t.MultiEmitter=class extends w{constructor(e,t){super(e),this.sprites=t}emit(e){for(let t=0;t<this.sprites.length;t++)if(this.config.spriteIndex=this.sprites[t],!super.emit(e))return!1;return!0}};t.LavaRockEmitter=class extends u{constructor(e,t){super(),this.neighbors=[],this.ready=!0;for(let a=0;a<t.length;a++){const n=t[a];r.mat4.getTranslation(p,n.modelMatrix);const s=r.vec3.dist(e,p);s>400&&s<1200&&(this.neighbors.push(n.modelMatrix),n.neighbors.push(this.modelMatrix))}r.mat4.fromTranslation(this.modelMatrix,e)}update(e,t,a){Math.random()>Math.exp(-.1*a*30)&&this.ready&&(this.emitCount=1),super.update(e,t,a)}init(e,t){this.ready=!1;let a=this.modelMatrix;const r=Math.random()>.5;if(!r&&this.neighbors.length>0){const e=Math.floor(Math.random()*this.neighbors.length);a=this.neighbors[e]}t.reset(this,a,r)}};t.SnowballChunkEmitter=class extends u{init(e,t){t.init(this.modelMatrix)}};class x{constructor(e,t){this.maxParticles=e,this.emitters=[],this.particlePool=[],this.particlePool=i.nArray(e,t)}prepareToRender(e,t,a){for(let e=0;e<this.emitters.length;e++)this.emitters[e].update(this,a.time/1e3,a.deltaTime/1e3);for(let r=0;r<this.maxParticles;r++)this.particlePool[r].timer>=0&&this.particlePool[r].prepareToRender(e,t,a)}getParticle(){for(let e=0;e<this.maxParticles;e++)if(this.particlePool[e].timer<0)return this.particlePool[e];return null}}class T extends x{constructor(e,t){super(e,()=>new d(t[19])),this.flipbooks=t}getFlipbook(e){return this.flipbooks[e]}}t.SceneEmitterHolder=class{constructor(e,a){const r=[];for(let t of[3,4,5])r[t]=a.ensureFlipbookData(e,t+1792);for(let t=8;t<=27;t++)r[t]=a.ensureFlipbookData(e,t+1792);r[t.snowballSplashIndex]=a.ensureFlipbookData(e,1066),r[t.fireballIndex]=a.ensureFlipbookData(e,1184),r[t.lavaSmokeIndex]=a.ensureFlipbookData(e,1729),this.flipbookManager=new T(300,r),this.lavaRockManager=new x(2,()=>a.spawnObject(e,this,955,p)[0]);const n=a.ensureGeoData(e,890);this.snowballChunkManager=new x(16,()=>new l.SnowballChunk(e,n))}prepareToRender(e,t,a){this.lavaRockManager.prepareToRender(e,t,a),this.snowballChunkManager.prepareToRender(e,t,a),this.flipbookManager.prepareToRender(e,t,a)}setVertexColorsEnabled(e){for(let t=0;t<this.flipbookManager.particlePool.length;t++)this.flipbookManager.particlePool[t].flipbook.setVertexColorsEnabled(e);for(let t=0;t<this.lavaRockManager.particlePool.length;t++)this.lavaRockManager.particlePool[t].setVertexColorsEnabled(e);for(let t=0;t<this.snowballChunkManager.particlePool.length;t++)this.snowballChunkManager.particlePool[t].setVertexColorsEnabled(e)}setTexturesEnabled(e){for(let t=0;t<this.flipbookManager.particlePool.length;t++)this.flipbookManager.particlePool[t].flipbook.setTexturesEnabled(e);for(let t=0;t<this.lavaRockManager.particlePool.length;t++)this.lavaRockManager.particlePool[t].setTexturesEnabled(e);for(let t=0;t<this.snowballChunkManager.particlePool.length;t++)this.snowballChunkManager.particlePool[t].setTexturesEnabled(e)}setMonochromeVertexColorsEnabled(e){for(let t=0;t<this.flipbookManager.particlePool.length;t++)this.flipbookManager.particlePool[t].flipbook.setMonochromeVertexColorsEnabled(e);for(let t=0;t<this.lavaRockManager.particlePool.length;t++)this.lavaRockManager.particlePool[t].setMonochromeVertexColorsEnabled(e);for(let t=0;t<this.snowballChunkManager.particlePool.length;t++)this.snowballChunkManager.particlePool[t].setMonochromeVertexColorsEnabled(e)}setAlphaVisualizerEnabled(e){for(let t=0;t<this.flipbookManager.particlePool.length;t++)this.flipbookManager.particlePool[t].flipbook.setAlphaVisualizerEnabled(e);for(let t=0;t<this.lavaRockManager.particlePool.length;t++)this.lavaRockManager.particlePool[t].setAlphaVisualizerEnabled(e);for(let t=0;t<this.snowballChunkManager.particlePool.length;t++)this.snowballChunkManager.particlePool[t].setAlphaVisualizerEnabled(e)}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=r(a(15));t.decompress=function(e){const t=e.createDataView();n.assert("Yay0"===n.readString(e,0,4));let a=t.getUint32(4,!1),r=t.getUint32(8,!1),i=t.getUint32(12,!1),o=16;const l=new Uint8Array(a);let c=0;for(;;){const e=t.getUint8(o++);let h=8;for(;h--;){if(e&1<<h)a--,l[c++]=t.getUint8(i++);else{const e=t.getUint16(r,!1);r+=2;const s=1+(4095&e);let o=2+(e>>12);2===o&&(o+=t.getUint8(i++)+16),n.assert(o>=3&&o<=273);let h=c-s;for(a-=o;o--;)l[c++]=l[h++]}if(a<=0)return new s.default(l.buffer)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(2);function n(e,t,a){return Math.sign(e)*r.clamp(Math.abs(e),t,a)}t.cLib_addCalc=function(e,t,a,r,s){const i=t-e,o=n(a*i,s,r);return Math.abs(o)>Math.abs(i)?t:e+o},t.cLib_addCalc2=function(e,t,a,r){return e+n(a*(t-e),0,r)},t.cLib_addCalcAngleRad=function(e,t,a,r,s){const i=(t-e)%6.283,o=2*i%6.283-i,l=n(o/a,s,r);return Math.abs(l)>Math.abs(o)?t:e+l},t.cLib_addCalcAngleRad2=function(e,t,a,r){const s=(t-e)%6.283,i=2*s%6.283-s,o=n(i/a,0,r);return Math.abs(o)>Math.abs(i)?t:e+o},t.cM_rndF=function(e){return Math.random()*e},t.cM_rndFX=function(e){return e*(Math.random()-.5)*2},t.cM_atan2s=function(e,t){return Math.atan2(e,t)*(32768/Math.PI)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(65),n=a(1),s=a(160),i=a(25),o=a(61),l=a(159),c=a(139),h=a(0),d=a(4),u=a(105),m=a(5),p=a(216),f=a(2),A=a(91),g=Math.PI/32767;function _(e,t){n.mat4.rotateX(e,e,t*g)}function S(e,t){n.mat4.identity(e),n.mat4.rotateY(e,e,t*g)}function b(e,t){n.mat4.rotateY(e,e,t*g)}function v(e,t){n.mat4.rotateZ(e,e,t*g)}function w(e,t){n.mat4.rotateZ(e,e,t[2]*g),n.mat4.rotateY(e,e,t[1]*g),n.mat4.rotateZ(e,e,t[0]*g)}function x(e,a,r=t.calc_mtx){a?n.mat4.translate(r,r,e):n.mat4.fromTranslation(r,e)}function T(e,a=e,r=t.calc_mtx){n.vec3.transformMat4(e,a,r)}function y(e,a=t.calc_mtx,r=C){n.mat4.fromQuat(r,e),n.mat4.mul(a,a,r)}t.mDoMtx_XrotM=_,t.mDoMtx_YrotS=S,t.mDoMtx_YrotM=b,t.mDoMtx_ZrotM=v,t.mDoMtx_ZYXrotM=w,t.calc_mtx=n.mat4.create(),t.MtxTrans=x,t.MtxPosition=T,t.quatM=y;const C=n.mat4.create(),M=n.vec3.create(),U=n.vec3.create();class k extends r.fopAc_ac_c{subload(e){const t=(15&this.parameters)>>0,a=(48&this.parameters)>>4,r=this.parameters>>6&63,s=k.kSpawnPatterns[t],i=k.kSpawnOffsets[s.group],o=s.count;switch(a){case 0:for(let t=0;t<o;t++){const a=n.vec3.set(M,i[t][0],i[t][1],i[t][2]),s=n.vec3.add(M,a,this.pos);e.scnPlay.grassPacket.newData(s,this.roomNo,r)}break;case 1:const t=n.mat4.fromYRotation(C,this.rot[1]/32767*Math.PI);for(let a=0;a<o;a++){const r=n.vec3.transformMat4(M,i[a],t),s=n.vec3.add(U,r,this.pos);e.scnPlay.treePacket.newData(s,0,this.roomNo)}break;case 2:case 3:for(let t=0;t<o;t++){const s=3===a,o=n.vec3.set(M,i[t][0],i[t][1],i[t][2]),l=n.vec3.add(M,o,this.pos);e.scnPlay.flowerPacket.newData(e,l,s,this.roomNo,r)}break;default:console.warn("Unknown grass actor type")}return 2}}function D(e,t){const a=e.renderer;return a.effectSystem.createBaseEmitter(a.device,a.renderCache,t)}function I(e,t){for(let a=0;a<e.materialInstances.length;a++)e.materialInstances[a].setAlphaWriteEnabled(t)}function R(e){I(e,!1)}k.PROCESS_NAME=440,k.kSpawnPatterns=[{group:0,count:1},{group:0,count:7},{group:1,count:15},{group:2,count:3},{group:3,count:7},{group:4,count:11},{group:5,count:7},{group:6,count:5}],k.kSpawnOffsets=[[[0,0,0],[3,0,-50],[-2,0,50],[50,0,27],[52,0,-25],[-50,0,22],[-50,0,-29]],[[-18,0,76],[-15,0,26],[133,0,0],[80,0,23],[86,0,-83],[33,0,-56],[83,0,-27],[-120,0,-26],[-18,0,-65],[-20,0,-21],[-73,0,1],[-67,0,-102],[-21,0,126],[-120,0,-78],[-70,0,-49],[32,0,103],[34,0,51],[-72,0,98],[-68,0,47],[33,0,-5],[135,0,-53]],[[-75,0,-50],[75,0,-25],[14,0,106]],[[-24,0,-28],[27,0,-28],[-21,0,33],[-18,0,-34],[44,0,-4],[41,0,10],[24,0,39]],[[-55,0,-22],[-28,0,-50],[-77,0,11],[55,0,-44],[83,0,-71],[11,0,-48],[97,0,-34],[-74,0,-57],[31,0,58],[59,0,30],[13,0,23],[-12,0,54],[55,0,97],[10,0,92],[33,0,-10],[-99,0,-27],[40,0,-87]],[[0,0,3],[-26,0,-29],[7,0,-25],[31,0,-5],[-7,0,40],[-35,0,15],[23,0,32]],[[-40,0,0],[0,0,0],[80,0,0],[-80,0,0],[40,0,0]]],t.createEmitter=D,t.setModelAlphaUpdate=I,t.initModelForZelda=R;class B extends r.fopAc_ac_c{constructor(){super(...arguments),this.posTop=n.vec3.create(),this.light=new o.LIGHT_INFLUENCE,this.state=0,this.lightPower=0,this.lightPowerTarget=0}subload(e){const t=s.dComIfG_resLoad(e,"Ep");if(3!==t)return t;this.hasGa=!!(this.parameters>>>6&1),this.hasObm=!!(this.parameters>>>7&1),this.type=63&this.parameters,63===this.type&&(this.type=0),0!==this.type&&3!==this.type||(this.model=new i.J3DModelInstance(e.resCtrl.getObjectRes(0,"Ep",this.hasObm?4:5)),R(this.model)),this.CreateInit(),o.dKy_plight_set(e.g_env_light,this.light);const a=D(e,1);if(n.vec3.copy(a.globalTranslation,this.posTop),a.globalTranslation[1]+=10,2!==this.type){const t=D(e,16388);n.vec3.copy(t.globalTranslation,a.globalTranslation),t.globalTranslation[1]+=20}const r=D(e,490);return n.vec3.copy(r.globalTranslation,this.posTop),r.globalTranslation[1]+=3,2}draw(e,t,a){0!==this.type&&3!==this.type||(o.settingTevStruct(e,1,this.pos,this.tevStr),o.setLightTevColorType(e,this.model,this.tevStr,a.camera),l.mDoExt_modelUpdateDL(e,this.model,t,a))}execute(e){0!==this.type&&3!==this.type||this.hasGa&&this.ga_move(),this.ep_move()}delete(e){o.dKy_plight_cut(e.g_env_light,this.light)}CreateInit(){this.daEp_set_mtx()}daEp_set_mtx(){0===this.type||3===this.type?(x(this.pos,!1),b(t.calc_mtx,this.rot[1]),_(t.calc_mtx,this.rot[0]),v(t.calc_mtx,this.rot[2]),n.mat4.copy(this.model.modelMatrix,t.calc_mtx),n.vec3.set(this.posTop,0,140,0),T(this.posTop)):n.vec3.copy(this.posTop,this.pos)}ga_move(){}ep_move(){0===this.state?(this.state=3,this.lightPowerTarget=this.scale[0]):3!==this.state&&4!==this.state||(this.lightPower=c.cLib_addCalc2(this.lightPower,this.lightPowerTarget,.5,.2),this.type),n.vec3.copy(this.light.pos,this.posTop),this.light.color.r=600/255,this.light.color.g=400/255,this.light.color.b=120/255,this.light.power=150*this.lightPower,this.light.fluctuation=250}}function P(e,t){for(let a=0;a<e.dStage_dt.mult.length;a++)if(e.dStage_dt.mult[a].roomNo===t)return e.dStage_dt.mult[a];return null}B.PROCESS_NAME=186,t.dComIfGp_getMapTrans=P;class E{constructor(e,t){this.anm=new l.mDoExt_btkAnm,this.isSC_01=!1,this.anm.init(e,t,!0,2)}entry(e){this.anm.entry(e)}play(e){this.isSC_01,this.anm.play(e)}}class F{constructor(e,t){this.anm=new l.mDoExt_brkAnm,this.anm.init(e,t,!0,2)}entry(e){this.anm.entry(e)}play(e){this.anm.play(e)}}class V extends r.fopAc_ac_c{constructor(){super(...arguments),this.numBg=4,this.bgModel=h.nArray(this.numBg,()=>null),this.bgBtkAnm=h.nArray(this.numBg,()=>null),this.bgBrkAnm=h.nArray(this.numBg,()=>null),this.bgTevStr=h.nArray(this.numBg,()=>null),this.bgW=new A.dBgW}subload(e){const a=e.resCtrl,r=this.parameters,s="Room"+r,l=["model.bmd","model1.bmd","model2.bmd","model3.bmd"],c=["model.bdl","model1.bdl","model2.bdl","model3.bdl"],d=["model.btk","model1.btk","model2.btk","model3.btk"],u=["model.brk","model1.brk","model2.brk","model3.brk"];for(let t=0;t<this.numBg;t++){let n=a.getStageResByName(0,s,l[t]);if(null===n&&(n=a.getStageResByName(0,s,c[t])),null===n)continue;this.bgModel[t]=new i.J3DModelInstance(n),R(this.bgModel[t]);const h=e.resCtrl.getStageResByName(6,s,d[t]);null!==h&&(this.bgBtkAnm[t]=new E(n,h));const m=e.resCtrl.getStageResByName(4,s,u[t]);null!==m&&(this.bgBrkAnm[t]=new F(n,m));const p=new o.dKy_tevstr_c;this.bgTevStr[t]=p,o.dKy_tevstr_init(p,r,-1)}const m=h.assertExists(a.getStageResByName(8,s,"room.dzb"));this.bgW.Set(m,32,null),e.scnPlay.bgS.Regist(this.bgW,this);for(let e=0;e<this.numBg;e++)null!==this.bgBtkAnm[e]&&this.bgBtkAnm[e].entry(this.bgModel[e]),null!==this.bgBrkAnm[e]&&this.bgBrkAnm[e].entry(this.bgModel[e]);const p=P(e,r);if(null!==p){x(n.vec3.set(M,p.transX,0,p.transZ),!1),b(t.calc_mtx,p.rotY);for(let e=0;e<this.numBg;e++)null!==this.bgModel[e]&&n.mat4.copy(this.bgModel[e].modelMatrix,t.calc_mtx)}return o.dKy_tevstr_init(e.roomStatus[r].tevStr,r,-1),2}execute(e,t){for(let e=0;e<this.numBg;e++)null!==this.bgBtkAnm[e]&&this.bgBtkAnm[e].play(t),null!==this.bgBrkAnm[e]&&this.bgBrkAnm[e].play(t)}draw(e,t,a){for(let r=0;r<this.numBg;r++)null!==this.bgModel[r]&&(o.settingTevStruct(e,1+r,null,this.bgTevStr[r]),o.setLightTevColorType(e,this.bgModel[r],this.bgTevStr[r],a.camera),l.mDoExt_modelUpdateDL(e,this.bgModel[r],t,a));const r=this.parameters;o.settingTevStruct(e,1,null,e.roomStatus[r].tevStr)}delete(e){e.scnPlay.bgS.Release(this.bgW)}}V.PROCESS_NAME=444;class O extends r.fopAc_ac_c{subload(e){const t=e.g_env_light,a=h.assertExists(e.resCtrl.getStageResByName(0,"Stage","vr_sky.bdl"));return this.model=new i.J3DModelInstance(a),R(this.model),e.scnPlay.vrboxLoaded=!0,t.vrboxInvisible=!1,2}dungeon_rain_proc(e){const t=e.g_env_light;if(o.dKy_checkEventNightStop(e)){const a=e.stageName;let r=-1;const n=e.mStayNo;"M_NewD2"===a&&3===n?r=1:"M_Dra09"===a?r=1:"kinMB"===a?r=1:"kindan"===a&&(r=2===n||13===n?1:4===n?2:0),0===r?0!==t.thunderMode&&(u.dKyw_rain_set(t,0),t.thunderMode=0):1===r?250!==t.rainCountOrig&&(o.dKy_change_colpat(t,1),u.dKyw_rain_set(t,250),t.thunderMode=1):2===r&&0===t.thunderMode&&(o.dKy_change_colpat(t,1),t.thunderMode=10)}}execute(e,t){this.dungeon_rain_proc(e)}daVrbox_color_set(e){const t=e.g_env_light;let a=0;if(a+=t.vrKasumiMaeCol.r+t.vrKasumiMaeCol.g+t.vrKasumiMaeCol.b,a+=t.vrSkyCol.r+t.vrSkyCol.g+t.vrSkyCol.b,a+=t.vrKumoCol.r+t.vrKumoCol.g+t.vrKumoCol.b,0===a)t.vrboxInvisible=!0;else{t.vrboxInvisible=!1;const e=this.model.modelMaterialData.materialData[0].material;d.colorCopy(e.colorConstants[0],t.vrKasumiMaeCol);const a=this.model.modelMaterialData.materialData[1].material;d.colorCopy(a.colorConstants[0],t.vrSkyCol)}}draw(e,a,r){const s=e.g_env_light;if(this.daVrbox_color_set(e),s.vrboxInvisible)return;let i=0;const c=e.roomStatus[e.mStayNo].fili;null!==c&&(i=c.skyboxY),x(e.cameraPosition,!1),t.calc_mtx[13]-=.09*(e.cameraPosition[1]-i),n.mat4.copy(this.model.modelMatrix,t.calc_mtx),o.dKy_setLight__OnModelInstance(s,this.model,r.camera),l.mDoExt_modelUpdateDL(e,this.model,a,r,e.dlst.sky)}}O.PROCESS_NAME=442;class N extends r.fopAc_ac_c{constructor(){super(...arguments),this.kasumiMae=null,this.kasumiMaeC0=d.colorNewCopy(d.TransparentBlack),this.kasumiMaeK0=d.colorNewCopy(d.TransparentBlack),this.usoUmi=null}subload(e){const t=h.assertExists(e.resCtrl.getStageResByName(0,"Stage","vr_back_cloud.bdl"));this.backCloud=new i.J3DModelInstance(t),R(this.backCloud);const a=e.resCtrl.getStageResByName(0,"Stage","vr_kasumi_mae.bdl");null!==a&&(this.kasumiMae=new i.J3DModelInstance(a),R(this.kasumiMae));const r=e.resCtrl.getStageResByName(0,"Stage","vr_uso_umi.bdl");return null!==r&&(this.usoUmi=new i.J3DModelInstance(r),R(this.usoUmi)),2}daVrbox2_color_set(e,t){const a=e.g_env_light;let r=0;if(r+=a.vrKasumiMaeCol.r+a.vrKasumiMaeCol.g+a.vrKasumiMaeCol.b,r+=a.vrSkyCol.r+a.vrSkyCol.g+a.vrSkyCol.b,r+=a.vrKumoCol.r+a.vrKumoCol.g+a.vrKumoCol.b,0===r)return;const s=u.dKyw_get_wind_vec(a),i=u.dKyw_get_wind_pow(a);let o=s[0],l=s[2];e.dStage_dt.stag.roomTypeAndSchBit;n.vec3.copy(M,e.cameraFwd),M[1]=0,n.vec3.normalize(M,M);const c=t*i*5e-4*(-o*M[2]- -l*M[0]);let h;const p=this.backCloud.materialInstances[0].materialData.material;h=p.texMatrices[0].matrix,h[12]=(h[12]+c)%1,h=p.texMatrices[1].matrix,h[12]=(h[12]+c)%1;const f=.8*c,A=this.backCloud.materialInstances[1].materialData.material;h=A.texMatrices[0].matrix,h[12]=(h[12]+f)%1,h=A.texMatrices[1].matrix,h[12]=(h[12]+f)%1;const g=.6*c,_=this.backCloud.materialInstances[2].materialData.material;h=_.texMatrices[0].matrix,h[12]=(h[12]+g)%1,h=_.texMatrices[1].matrix,h[12]=(h[12]+c+g)%1,this.backCloud.setColorOverride(m.ColorKind.K0,a.vrKumoCol),null!==this.kasumiMae&&(d.colorCopy(this.kasumiMaeC0,a.vrKasumiMaeCol,0),this.kasumiMaeK0.r=a.vrKumoCol.a,this.kasumiMae.setColorOverride(m.ColorKind.C0,this.kasumiMaeC0),this.kasumiMae.setColorOverride(m.ColorKind.K0,this.kasumiMaeK0)),null!==this.usoUmi&&this.usoUmi.setColorOverride(m.ColorKind.K0,a.vrUsoUmiCol)}execute(e,t){this.daVrbox2_color_set(e,t)}draw(e,a,r){const s=e.g_env_light;let i=0;if(i+=s.vrKasumiMaeCol.r+s.vrKasumiMaeCol.g+s.vrKasumiMaeCol.b,i+=s.vrSkyCol.r+s.vrSkyCol.g+s.vrSkyCol.b,i+=s.vrKumoCol.r+s.vrKumoCol.g+s.vrKumoCol.b,0===i)return;let c=0;const h=e.roomStatus[e.mStayNo].fili;null!==h&&(c=.09*(e.cameraPosition[1]-h.skyboxY)),x(e.cameraPosition,!1),t.calc_mtx[13]-=c,null!==this.usoUmi&&(n.mat4.copy(this.usoUmi.modelMatrix,t.calc_mtx),o.dKy_setLight__OnModelInstance(s,this.usoUmi,r.camera),l.mDoExt_modelUpdateDL(e,this.usoUmi,a,r,e.dlst.sky)),null!==this.kasumiMae&&(n.mat4.copy(this.kasumiMae.modelMatrix,t.calc_mtx),o.dKy_setLight__OnModelInstance(s,this.kasumiMae,r.camera),l.mDoExt_modelUpdateDL(e,this.kasumiMae,a,r,e.dlst.sky)),n.mat4.copy(this.backCloud.modelMatrix,t.calc_mtx),o.dKy_setLight__OnModelInstance(s,this.backCloud,r.camera),l.mDoExt_modelUpdateDL(e,this.backCloud,a,r,e.dlst.sky)}}N.PROCESS_NAME=443;class L extends r.fopAc_ac_c{constructor(){super(...arguments),this.pselIdx=0,this.effectMode=0,this.invert=!1,this.alwaysCheckPlayerPos=!1,this.target=0,this.effectSet=!1,this.pselSet=!1,this.innerFadeY=0,this.innerRadius=0,this.outerRadius=0}subload(e){this.pselIdx=255&this.parameters,this.effectMode=this.parameters>>>8&255,this.invert=!!(this.rot[0]>>>8&255),this.alwaysCheckPlayerPos=!!(255&this.rot[2]),this.invert?this.target=1:this.target=0,this.innerFadeY=100*(this.parameters>>24&255);const t=this.parameters>>>16&255;return this.alwaysCheckPlayerPos?(this.innerRadius=500*this.scale[0],this.outerRadius=this.innerRadius+10*t):(this.innerRadius=5e3*this.scale[0],this.outerRadius=this.innerRadius+100*t),this.wether_tag_efect_move(e),2}get_check_pos(e){return this.alwaysCheckPlayerPos||n.vec3.distance(this.pos,e.playerPosition)<n.vec3.distance(this.pos,e.cameraPosition)?e.playerPosition:e.cameraPosition}wether_tag_efect_move(e){}execute(e,t){this.invert?this.target=c.cLib_addCalc(this.target,0,.1,.01,1e-4):this.target=c.cLib_addCalc(this.target,1,.1,.01,1e-4),this.wether_tag_move(e)}raincnt_set(e,t){const a=e.g_env_light;let r=250*f.saturate(t*t*t)|0;o.dKy_checkEventNightStop(e)&&r<a.rainCount&&(r=a.rainCount),r>a.rainCountOrig&&(a.rainCount=r)}raincnt_cut(e){const t=e.g_env_light;o.dKy_checkEventNightStop(e)||(t.rainCount=t.rainCountOrig)}wether_tag_move(e){const t=e.g_env_light,a=this.get_check_pos(e),r=Math.hypot(a[0]-this.pos[0],a[2]-this.pos[2]),n=this.pos[1],s=n-this.innerFadeY,i=this.pos[1]+5e3*this.scale[1]+this.innerFadeY;if(r<this.outerRadius&&a[1]>s&&a[1]<=i){const s=this.outerRadius-this.innerRadius,o=Math.min((this.outerRadius-r)/s,1);let l=1;0!==this.innerFadeY&&(l=a[1]>n?1-f.saturate((a[1]-i)/this.innerFadeY):1-f.saturate((n-a[1])/this.innerFadeY));const c=this.target*o*l;t.envrIdxPrev===t.envrIdxCurr&&this.pselIdx<4&&(this.pselSet=!0,c>.5?(t.blendPselGather=c,t.pselIdxPrevGather=t.weatherPselIdx,t.pselIdxCurrGather=this.pselIdx,t.colSetModeGather=1):(t.blendPselGather=1-c,t.pselIdxPrevGather=this.pselIdx,t.pselIdxCurrGather=t.weatherPselIdx,t.colSetModeGather=1)),this.effectSet=!0,1===this.effectMode?this.raincnt_set(e,c):7===this.effectMode?0===t.thunderMode&&(t.thunderMode=2):8===this.effectMode?(0===t.thunderMode&&(t.thunderMode=2),this.raincnt_set(e,c)):9===this.effectMode&&(0===t.thunderMode&&(t.thunderMode=2),this.raincnt_set(e,c))}else this.pselSet&&(this.pselSet=!1,t.pselIdxPrevGather=t.weatherPselIdx,t.pselIdxCurrGather=t.weatherPselIdx,t.blendPselGather=0,t.colSetModeGather=1),this.effectSet&&(this.effectSet=!1,1===this.effectMode?this.raincnt_cut(e):7===this.effectMode?2===t.thunderMode&&(t.thunderMode=0):8===this.effectMode?(2===t.thunderMode&&(t.thunderMode=0),this.raincnt_cut(e)):9===this.effectMode&&(2===t.thunderMode&&(t.thunderMode=0),this.raincnt_cut(e)))}}L.PROCESS_NAME=385;class G extends r.fopAc_ac_c{constructor(){super(...arguments),this.influence=new o.WAVE_INFLUENCE}subload(e){return n.vec3.copy(this.influence.pos,this.pos),this.influence.innerRadius=5e3*this.scale[0],this.influence.outerRadius=Math.max(5e3*this.scale[2],this.influence.innerRadius+500),o.dKy__waveinfl_set(e.g_env_light,this.influence),2}delete(e){o.dKy__waveinfl_cut(e.g_env_light,this.influence)}}G.PROCESS_NAME=386;class H extends r.fopAc_ac_c{constructor(){super(...arguments),this.btkAnm=new l.mDoExt_btkAnm,this.bckAnm=new l.mDoExt_bckAnm}subload(e){const t=s.dComIfG_resLoad(e,"Ygush00");if(3!==t)return t;this.type=3&this.parameters;const a=e.resCtrl;return this.model=new i.J3DModelInstance(a.getObjectRes(0,"Ygush00",[10,9,9,9][this.type])),R(this.model),this.btkAnm.init(this.model.modelData,a.getObjectRes(6,"Ygush00",[14,13,13,13][this.type]),!0,2),this.bckAnm.init(this.model.modelData,a.getObjectRes(2,"Ygush00",[6,5,5,5][this.type]),!0,2),n.vec3.copy(this.model.baseScale,this.scale),n.mat4.translate(this.model.modelMatrix,this.model.modelMatrix,this.pos),2}execute(e,t){3!==this.type&&(this.btkAnm.play(t),this.bckAnm.play(t)),this.type}draw(e,t,a){o.settingTevStruct(e,2,this.pos,this.tevStr),o.setLightTevColorType(e,this.model,this.tevStr,a.camera),this.btkAnm.entry(this.model),this.bckAnm.entry(this.model),l.mDoExt_modelUpdateDL(e,this.model,t,a)}}H.PROCESS_NAME=153;class j extends r.fopAc_ac_c{constructor(){super(...arguments),this.baseQuat=n.quat.create(),this.baseQuatTarget=n.quat.create(),this.animDir=h.nArray(2,()=>0),this.animWave=h.nArray(2,()=>0),this.animMtxQuat=h.nArray(2,()=>n.quat.create()),this.nodeCallBack=(e,t)=>{2!==t&&3!==t||(v(e,-16384),y(this.baseQuat,e),y(2===t?this.animMtxQuat[0]:this.animMtxQuat[1],e),v(e,16384))}}subload(e){const t=s.dComIfG_resLoad(e,"Oyashi");if(3!==t)return t;const a=e.resCtrl;return this.model=new i.J3DModelInstance(a.getObjectRes(0,"Oyashi",4)),R(this.model),this.model.jointMatrixCalcCallback=this.nodeCallBack,n.mat4.translate(this.model.modelMatrix,this.model.modelMatrix,this.pos),w(this.model.modelMatrix,this.rot),2}execute(e,a){const r=e.g_env_light,s=u.dKyw_get_wind_vec(r),i=u.dKyw_get_wind_pow(r);S(t.calc_mtx,-this.rot[1]),T(M,s),n.vec3.set(U,0,1,0),n.vec3.cross(U,U,M),n.vec3.length(U)>=1e-8?(n.vec3.normalize(U,U),n.quat.setAxisAngle(this.baseQuatTarget,U,i*(1536*g))):n.quat.identity(this.baseQuatTarget),n.quat.slerp(this.baseQuat,this.baseQuat,this.baseQuatTarget,.25);for(let e=0;e<2;e++){const t=Math.min(384*i,256);this.animDir[e]=c.cLib_addCalcAngleRad2(this.animDir[e],t*g,4*g,32*g),this.animWave[e]+=(2048*i+c.cM_rndFX(128))*g*a;const r=Math.sin(this.animWave[e]);n.vec3.set(M,r,0,r),n.quat.setAxisAngle(this.animMtxQuat[e],M,this.animDir[e])}}draw(e,t,a){o.settingTevStruct(e,1,this.pos,this.tevStr),o.setLightTevColorType(e,this.model,this.tevStr,a.camera),l.mDoExt_modelUpdateDL(e,this.model,t,a)}}j.PROCESS_NAME=75;class W extends r.fopAc_ac_c{constructor(){super(...arguments),this.bckAnm=new l.mDoExt_bckAnm,this.effectMtx=n.mat4.create(),this.effectMtxCallback=(e,t)=>{n.mat4.copy(e,this.effectMtx)}}subload(e){const t=s.dComIfG_resLoad(e,"VzouK");if(3!==t)return t;const a=e.resCtrl;this.model=new i.J3DModelInstance(a.getObjectRes(0,"VzouK",8)),R(this.model);const r=a.getObjectRes(2,"VzouK",5);this.bckAnm.init(this.model.modelData,r,!0,0,0,r.duration),this.bckAnm.play(0);for(let e=0;e<this.model.materialInstances.length;e++)this.model.materialInstances[e].effectMtxCallback=this.effectMtxCallback;return 2}set_mtx(){n.vec3.copy(this.model.baseScale,this.scale),x(this.pos,!1,this.model.modelMatrix),w(this.model.modelMatrix,this.rot)}execute(e,t){this.set_mtx()}setEffectMtx(e,t,a){const r=1/a;var s,o,l;f.computeModelMatrixS(this.effectMtx,r,r,1),i.buildEnvMtx(C,1),n.mat4.mul(this.effectMtx,this.effectMtx,C),n.vec3.sub(M,t,e.cameraPosition),u.dKyr_get_vectle_calc(this.tevStr.lightObj.Position,t,U),s=M,o=M,l=U,n.vec3.negate(o,o),n.vec3.negate(l,l),n.vec3.normalize(o,o),n.vec3.normalize(l,l),n.vec3.add(s,o,l),n.vec3.dot(s,s)>0?n.vec3.normalize(s,s):n.vec3.set(s,0,0,0),n.mat4.lookAt(C,f.Vec3Zero,M,f.Vec3UnitY),n.mat4.mul(this.effectMtx,this.effectMtx,C),f.computeMatrixWithoutTranslation(this.effectMtx,this.effectMtx)}draw(e,t,a){o.settingTevStruct(e,0,this.pos,this.tevStr),o.setLightTevColorType(e,this.model,this.tevStr,a.camera),this.setEffectMtx(e,this.pos,.5),this.bckAnm.entry(this.model),l.mDoExt_modelUpdateDL(e,this.model,t,a)}}W.PROCESS_NAME=399,t.d_a__RegisterConstructors=function(e){function t(t){r.fpcPf__Register(e,t.PROCESS_NAME,t)}t(k),t(B),t(V),t(O),t(N),t(p.d_a_sea),t(L),t(G),t(H),t(j),t(W)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(11)),s=r(a(27)),i=r(a(39)),o=a(0),l=a(25),c=a(16),h=a(1),d=a(26),u=a(5),m=a(9),p=a(4),f=a(78),A=new TextDecoder("sjis");function g(e,t){const a=e.createDataView(),r=[];let n=0,s=!1;for(let i=0;i<t.length;i++)switch(t[i]){case"B":r.push(a.getUint8(n)),n+=1;break;case"I":r.push(a.getUint32(n)),n+=4;break;case"i":r.push(a.getInt32(n)),n+=4;break;case"f":r.push(a.getFloat32(n)),n+=4;break;case"s":const t=a.getUint16(n);n+=2,r.push(o.readString(e,n,t,!1)),n+=t;break;case".":s=!0;break;case" ":break;default:o.assert(!1)}return s||o.assert(e.byteLength===n),[n,...r]}const _=m.makeClearRenderPassDescriptor(!0,p.colorNewFromRGBA(0,0,0,1));class S{constructor(e,t){this.rarc=t,this.mainRenderTarget=new m.BasicRenderTarget,this.opaqueSceneTexture=new m.ColorTexture,this.modelInstances=[],this.destroyables=[],this.modelCache=new Map,this.renderHelper=new u.GXRenderHelperGfx(e)}createPanels(){const e=new n.Panel;e.customHeaderBackgroundColor=n.COOL_BLUE_COLOR,e.setTitle(n.RENDER_HACKS_ICON,"Render Hacks");const t=new n.Checkbox("Enable Vertex Colors",!0);t.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setVertexColorsEnabled(t.checked)},e.contents.appendChild(t.elem);const a=new n.Checkbox("Enable Textures",!0);return a.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setTexturesEnabled(a.checked)},e.contents.appendChild(a.elem),[e]}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();u.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}setIndirectTextureOverride(){for(let e=0;e<this.modelInstances.length;e++){const t=this.modelInstances[e].tex1Data.tex1.samplers;for(let a=0;a<t.length;a++){const r=this.modelInstances[e].materialInstanceState.textureMappings[a];"indirectdummy"===t[a].name&&(r.gfxTexture=this.opaqueSceneTexture.gfxTexture,r.width=c.EFB_WIDTH,r.height=c.EFB_HEIGHT,r.flipY=!0)}}}render(e,t){const a=this.renderHelper.renderInstManager;this.mainRenderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.opaqueSceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.setIndirectTextureOverride();const r=e.createHostAccessPass();this.prepareToRender(e,r,t),e.submitPass(r);const n=this.mainRenderTarget.createRenderPass(e,t.viewport,_);a.setVisibleByFilterKeyExact(1),a.drawOnPassRenderer(e,n),e.submitPass(n);const s=this.mainRenderTarget.createRenderPass(e,t.viewport,m.depthClearRenderPassDescriptor,this.opaqueSceneTexture.gfxTexture);let i;if(a.setVisibleByFilterKeyExact(2),a.drawOnPassRenderer(e,s),a.setVisibleByFilterKeyExact(4),a.hasAnyVisible()){e.submitPass(s);const r=this.mainRenderTarget.createRenderPass(e,t.viewport,m.noClearRenderPassDescriptor);a.drawOnPassRenderer(e,r),i=r}else i=s;return a.setVisibleByFilterKeyExact(8),a.drawOnPassRenderer(e,i),a.resetRenderInsts(),i}destroy(e){this.renderHelper.destroy(e),this.mainRenderTarget.destroy(e),this.opaqueSceneTexture.destroy(e),this.destroyables.forEach(t=>t.destroy(e)),this.modelInstances.forEach(t=>t.destroy(e));for(const t of this.modelCache.values())t.destroy(e)}}t.SunshineRenderer=S;class b{constructor(e,t){this.id=e,this.name=t}static createSunshineSceneForBasename(e,t,a,r,n,s){const i=r.findFile(`${n}.bmd`);if(!i)return null;const o=r.findFile(`${n}.btk`),l=r.findFile(`${n}.brk`),c=r.findFile(`${n}.bck`),h=r.findFile(`${n}.bmt`),d=f.createModelInstance(e,t,i,o,l,c,h);return d.name=n,d.isSkybox=s,d.passMask=a,d}createScene(e,t){const a=`j3d/sms/${this.id}.szs`;return t.dataFetcher.fetchData(a).then(e=>s.decompress(e)).then(t=>{const a=i.parse(t),r=function e(t){let a=0;const r=t.createDataView().getUint32(a+0),n=t.createDataView(0,r);a+=4;const s=n.getUint16(a+0),i=n.getUint16(a+2);a+=4;const l=o.readString(t,a,i,!1);a+=i,n.getUint16(a+0);const c=n.getUint16(a+2);a+=4;const h=A.decode(t.createTypedArray(Uint8Array,a,c));function d(r){const n=[];for(;r--;){const r=e(t.slice(a));n.push(r),a+=r.size}return n}a+=c;const u=t.slice(a,r);switch(l){case"GroupObj":case"LightAry":case"Strategy":case"AmbAry":{const[e,t]=g(u,"I.");return a+=e,{type:"Group",klass:l,name:h,size:r,children:d(t)}}case"IdxGroup":case"MarScene":{const[e,t,n]=g(u,"II.");return a+=e,{type:"Group",klass:l,name:h,size:r,children:d(n)}}case"AmbColor":{const[e,t,a,n,s]=g(u,"BBBB");return{type:"AmbColor",klass:l,name:h,size:r,r:t,g:a,b:n,a:s}}case"Light":{const[e,t,a,n,s,i,o,c,d]=g(u,"fffBBBBf");return{type:"Light",klass:l,name:h,size:r,x:t,y:a,z:n,r:s,g:i,b:o,a:c,intensity:d}}case"BananaTree":case"BiaTurnBridge":case"BiaWatermill":case"Coin":case"CoinRed":case"Fence":case"FenceInner":case"FenceRevolve":case"FenceWaterH":case"FenceWaterV":case"FerrisWheel":case"IceBlock":case"Manhole":case"MapObjBase":case"MapStaticObj":case"Merrygoround":case"MonumentShine":case"Palm":case"PalmNatume":case"PalmOugi":case"PinnaDoor":case"ShellCup":case"WoodBarrel":case"WoodBlock":case"Viking":{const[e,t,a,n,s,i,o,c,d,m,p,f,A]=g(u,"ffffff fffsi s.");return{type:"Model",klass:l,name:h,size:r,x:t,y:a,z:n,rotationX:s,rotationY:i,rotationZ:o,scaleX:c,scaleY:d,scaleZ:m,manager:p,model:A}}case"CoinBlue":{const[e,t,a,n,s,i,o,c,d,m,p,f,A]=g(u,"ffffff fffsi s i");return{type:"Model",klass:l,name:h,size:r,x:t,y:a,z:n,rotationX:s,rotationY:i,rotationZ:o,scaleX:c,scaleY:d,scaleZ:m,manager:p,model:A}}case"NozzleBox":{const[e,t,a,n,s,i,o,c,d,m,p,f,A]=g(u,"ffffff fffsi s ssff");return{type:"Model",klass:l,name:h,size:r,x:t,y:a,z:n,rotationX:s,rotationY:i,rotationZ:o,scaleX:c,scaleY:d,scaleZ:m,manager:p,model:A}}case"Shine":{const[e,t,a,n,s,i,o,c,d,m,p,f,A]=g(u,"ffffff fffsi s sii");return{type:"Model",klass:l,name:h,size:r,x:t,y:a,z:n,rotationX:s,rotationY:i,rotationZ:o,scaleX:c,scaleY:d,scaleZ:m,manager:p,model:A}}case"FruitsBoat":{const[e,t,a,n,s,i,o,c,d,m,p,f,A]=g(u,"ffffff fffsi s s");return{type:"Model",klass:l,name:h,size:r,x:t,y:a,z:n,rotationX:s,rotationY:i,rotationZ:o,scaleX:c,scaleY:d,scaleZ:m,manager:p,model:A}}case"Billboard":case"BrickBlock":case"DolWeathercock":case"WoodBox":{const[e,t,a,n,s,i,o,c,d,m,p,f,A]=g(u,"ffffff fffsI s IffI");return{type:"Model",klass:l,name:h,size:r,x:t,y:a,z:n,rotationX:s,rotationY:i,rotationZ:o,scaleX:c,scaleY:d,scaleZ:m,manager:p,model:A}}case"MapObjWaterSpray":{const[e,t,a,n,s,i,o,c,d,m,p,f,A]=g(u,"ffffff fffsI s IIIIII");return{type:"Model",klass:l,name:h,size:r,x:t,y:a,z:n,rotationX:s,rotationY:i,rotationZ:o,scaleX:c,scaleY:d,scaleZ:m,manager:p,model:A}}default:let e=!0;return(l.endsWith("Manager")||l.endsWith("Mgr"))&&(e=!1),l.startsWith("Cube")&&(e=!1),e&&console.warn(`Unknown object class ${s} ${l}, size ${r}`),{type:"Unknown",klass:l,name:h,size:r}}}(a.findFileData("map/scene.bin"));console.log(a,r);const n=new S(e,a),s=n.renderHelper.renderInstManager.gfxRenderCache,l=b.createSunshineSceneForBasename(e,s,1,a,"map/map/sky",!0);null!==l&&n.modelInstances.push(l);const c=b.createSunshineSceneForBasename(e,s,2,a,"map/map/map",!1);null!==c&&n.modelInstances.push(c);const h=b.createSunshineSceneForBasename(e,s,2,a,"map/map/sea",!1);null!==h&&n.modelInstances.push(h);const d=b.createSunshineSceneForBasename(e,s,4,a,"map/map/seaindirect",!1);return null!==d&&n.modelInstances.push(d),this.createSceneBinObjects(e,s,n,a,r),n})}createSceneBinObjects(e,t,a,r,n){"Group"===n.type?n.children.forEach(n=>this.createSceneBinObjects(e,t,a,r,n)):"Model"===n.type&&this.createRendererForSceneBinModel(e,t,a,r,n)}createRendererForSceneBinModel(e,t,a,r,n){const s=a.modelCache;function i(a){if(o.assert(!!a),s.has(a))return s.get(a);{const r=d.BMD.parse(a.buffer),n=new l.J3DModelData(e,t,r);return s.set(a,n),n}}function c(n,s){const c=o.assertExists(r.findFile(n)),h=o.assertExists(r.findFile(s)),u=i(c),m=new l.J3DModelInstanceSimple(u);if(null!==s){const r=new l.BMDModelMaterialData(e,t,d.BMT.parse(h.buffer));a.destroyables.push(r),m.setModelMaterialData(r)}return m.passMask=2,m}let u=[{k:"BananaTree",m:"BananaTree",p:"mapobj/bananatree"},{k:"BiaTurnBridge",m:"BiaTurnBridge",s:()=>c("mapobj/biaturnbridge.bmd","mapobj/bianco.bmt")},{k:"BiaWatermill",m:"BiaWatermill",s:()=>c("mapobj/biawatermill.bmd","mapobj/bianco.bmt")},{k:"BrickBlock",m:"BrickBlock",p:"mapobj/brickblock"},{k:"Coin",m:"coin",p:"mapobj/coin"},{k:"Coin",m:"invisible_coin",p:"mapobj/coin"},{k:"CoinRed",m:"coin_red",p:"mapobj/coin_red"},{k:"CoinBlue",m:"coin_blue",p:"mapobj/coin_blue"},{k:"DolWeathercock",m:"dptWeathercock",p:"mapobj/dptweathercock"},{k:"Fence",m:"fence_normal",p:"mapobj/fence_normal"},{k:"Fence",m:"fence3x3",p:"mapobj/fence_half"},{k:"FenceRevolve",m:"fence_revolve",p:"mapobj/fence_revolve_outer"},{k:"FenceInner",m:"fenceInnerGreen",p:"mapobj/fenceinnergreen"},{k:"FenceWaterH",m:"FenceWaterH",p:"mapobj/fencewaterh"},{k:"FenceWaterV",m:"FenceWaterV",p:"mapobj/fencewaterv"},{k:"FerrisWheel",m:"FerrisWheel",p:"mapobj/ferriswheel"},{k:"IceBlock",m:"IceBlock",p:"mapobj/iceblock"},{k:"Manhole",m:"manhole",p:"mapobj/manhole"},{k:"MapObjBase",m:"DokanGate",p:"mapobj/efdokangate"},{k:"MapObjBase",m:"ArrowBoardLR",s:()=>c("mapobj/arrowboardlr.bmd","mapobj/arrowboard.bmt")},{k:"MapObjBase",m:"ArrowBoardUp",s:()=>c("mapobj/arrowboardup.bmd","mapobj/arrowboard.bmt")},{k:"MapObjBase",m:"ArrowBoardDown",s:()=>c("mapobj/arrowboarddown.bmd","mapobj/arrowboard.bmt")},{k:"MapObjBase",m:"monte_chair",p:"mapobj/monte_chair_model"},{k:"MapStaticObj",m:"ReflectSky",s:()=>null},{k:"MapStaticObj",m:"SeaIndirect",s:()=>null},{k:"Merrygoround",m:"merry",p:"mapobj/merry"},{k:"NozzleBox",m:"NozzleBox",p:"mapobj/nozzlebox"},{k:"Palm",m:"palmNormal",p:"mapobj/palmnormal"},{k:"Palm",m:"palmLeaf",p:"mapobj/palmleaf"},{k:"PalmNatume",m:"palmNatume",p:"mapobj/palmnatume"},{k:"PalmOugi",m:"palmOugi",p:"mapobj/palmougi"},{k:"PinnaDoor",m:"PinnaDoor",p:"mapobj/pinnadoor"},{k:"ShellCup",m:"ShellCup",p:"mapobj/shellcup"},{k:"Shine",m:"shine",s:()=>function(e,t,a=2){const n=i(o.assertExists(r.findFile(e))),s=new l.J3DModelInstanceSimple(n);s.passMask=2;const c=o.assertExists(r.findFile(t)),h=d.BCK.parse(c.buffer);return h.loopMode=a,s.bindANK1(h),s}("mapobj/shine.bmd","mapobj/shine_float.bck")},{k:"Viking",m:"viking",p:"mapobj/viking"},{k:"WoodBox",m:"WoodBox",p:"mapobj/kibako"},{k:"WoodBarrel",m:"wood_barrel",s:()=>c("mapobj/barrel_normal.bmd","mapobj/barrel.bmt")}].find(e=>n.klass===e.k&&n.model===e.m);if(void 0===u){let e;if("MapStaticObj"===n.klass?e=`map/map/${n.model.toLowerCase()}`:"MapObjBase"===n.klass&&(e=`mapobj/${n.model.toLowerCase()}`),e){r.findFile(`${e}.bmd`)&&(u={k:n.klass,m:n.model,p:e})}}if(void 0===u)return console.warn(`No model for ${n.klass} ${n.model}`),null;let m=null;if(void 0!==u.p?m=function(n){const s=r.findFile(`${n}.bmd`);if(!s)return null;const o=r.findFile(`${n}.btk`),c=r.findFile(`${n}.brk`),h=r.findFile(`${n}.bck`),u=r.findFile(`${n}.bmt`),m=i(s),p=new l.J3DModelInstanceSimple(m);if(null!==u){const r=new l.BMDModelMaterialData(e,t,d.BMT.parse(u.buffer));a.destroyables.push(r),p.setModelMaterialData(r)}if(p.passMask=2,null!==o){const e=d.BTK.parse(o.buffer);p.bindTTK1(e)}if(null!==c){const e=d.BRK.parse(c.buffer);p.bindTRK1(e)}if(null!==h){const e=d.BCK.parse(h.buffer);p.bindANK1(e)}return p.name=n,p}(u.p):void 0!==u.s&&(m=u.s()),null===m)return null;const p=h.quat.create();return h.quat.fromEuler(p,n.rotationX,n.rotationY,n.rotationZ),h.mat4.fromRotationTranslationScale(m.modelMatrix,p,[n.x,n.y,n.z],[n.scaleX,n.scaleY,n.scaleZ]),a.modelInstances.push(m),m}}t.SunshineSceneDesc=b;const v=["Main Scenes",new b("dolpic0","Delfino Plaza"),new b("airport0","Delfino Airport"),new b("bianco0","Bianco Hills"),new b("ricco0","Ricco Harbor"),new b("mamma0","Gelato Beach"),new b("pinnaBeach0","Pinna Park Beach"),new b("pinnaParco0","Pinna Park"),new b("sirena0","Sirena Beach"),new b("delfino0","Delfino Hotel"),new b("mare0","Noki Bay"),new b("monte3","Pianta Village"),"Variations",new b("airport0","airport0"),new b("airport1","airport1"),new b("bia_ex1","bia_ex1"),new b("bianco0","bianco0"),new b("bianco1","bianco1"),new b("bianco2","bianco2"),new b("bianco3","bianco3"),new b("bianco4","bianco4"),new b("bianco5","bianco5"),new b("bianco6","bianco6"),new b("bianco7","bianco7"),new b("biancoBoss","biancoBoss"),new b("casino0","casino0"),new b("casino1","casino1"),new b("coro_ex0","coro_ex0"),new b("coro_ex1","coro_ex1"),new b("coro_ex2","coro_ex2"),new b("coro_ex4","coro_ex4"),new b("coro_ex5","coro_ex5"),new b("coro_ex6","coro_ex6"),new b("coronaBoss","coronaBoss"),new b("delfino0","delfino0"),new b("delfino1","delfino1"),new b("delfino2","delfino2"),new b("delfino3","delfino3"),new b("delfino4","delfino4"),new b("delfinoBoss","delfinoBoss"),new b("dolpic_ex0","dolpic_ex0"),new b("dolpic_ex1","dolpic_ex1"),new b("dolpic_ex2","dolpic_ex2"),new b("dolpic_ex3","dolpic_ex3"),new b("dolpic_ex4","dolpic_ex4"),new b("dolpic0","dolpic0"),new b("dolpic1","dolpic1"),new b("dolpic10","dolpic10"),new b("dolpic5","dolpic5"),new b("dolpic6","dolpic6"),new b("dolpic7","dolpic7"),new b("dolpic8","dolpic8"),new b("dolpic9","dolpic9"),new b("mam_ex0","mam_ex0"),new b("mam_ex1","mam_ex1"),new b("mamma0","mamma0"),new b("mamma1","mamma1"),new b("mamma2","mamma2"),new b("mamma3","mamma3"),new b("mamma4","mamma4"),new b("mamma5","mamma5"),new b("mamma6","mamma6"),new b("mamma7","mamma7"),new b("mare_ex0","mare_ex0"),new b("mare0","mare0"),new b("mare1","mare1"),new b("mare2","mare2"),new b("mare3","mare3"),new b("mare4","mare4"),new b("mare5","mare5"),new b("mare6","mare6"),new b("mare7","mare7"),new b("mareBoss","mareBoss"),new b("mareUndersea","mareUndersea"),new b("monte_ex0","monte_ex0"),new b("monte0","monte0"),new b("monte1","monte1"),new b("monte2","monte2"),new b("monte3","monte3"),new b("monte4","monte4"),new b("monte5","monte5"),new b("monte6","monte6"),new b("monte7","monte7"),new b("option","option"),new b("pinnaBeach0","pinnaBeach0"),new b("pinnaBeach1","pinnaBeach1"),new b("pinnaBeach2","pinnaBeach2"),new b("pinnaBeach3","pinnaBeach3"),new b("pinnaBeach4","pinnaBeach4"),new b("pinnaBoss0","pinnaBoss0"),new b("pinnaBoss1","pinnaBoss1"),new b("pinnaParco0","pinnaParco0"),new b("pinnaParco1","pinnaParco1"),new b("pinnaParco2","pinnaParco2"),new b("pinnaParco3","pinnaParco3"),new b("pinnaParco4","pinnaParco4"),new b("pinnaParco5","pinnaParco5"),new b("pinnaParco6","pinnaParco6"),new b("pinnaParco7","pinnaParco7"),new b("ricco0","ricco0"),new b("ricco1","ricco1"),new b("ricco2","ricco2"),new b("ricco3","ricco3"),new b("ricco4","ricco4"),new b("ricco5","ricco5"),new b("ricco6","ricco6"),new b("ricco7","ricco7"),new b("ricco8","ricco8"),new b("rico_ex0","rico_ex0"),new b("rico_ex1","rico_ex1"),new b("sirena_ex0","sirena_ex0"),new b("sirena_ex1","sirena_ex1"),new b("sirena0","sirena0"),new b("sirena1","sirena1"),new b("sirena2","sirena2"),new b("sirena3","sirena3"),new b("sirena4","sirena4"),new b("sirena5","sirena5"),new b("sirena6","sirena6"),new b("sirena7","sirena7"),new b("test11","test11")],w=new Map;w.set("Delfino Plaza","dolpic0"),w.set("Delfino Airport","airport0"),w.set("Bianco Hills","bianco0"),w.set("Ricco Harbor","ricco0"),w.set("Gelato Beach","mamma0"),w.set("Pinna Park Beach","pinnaBeach0"),w.set("Pinna Park","pinnaParco0"),w.set("Sirena Beach","sirena0"),w.set("Delfino Hotel","delfino0"),w.set("Noki Bay","mare0"),w.set("Pianta Village","monte3"),t.sceneGroup={id:"sms",name:"Super Mario Sunshine",sceneDescs:v,sceneIdMap:w}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(4),s=a(28),i=a(5),o=a(0),l=a(162),c=a(40),h=a(93),d=a(2);function u(e,t,a){const r=o.fallback(t.getValueNumber(`${a}R`),0)/255,s=o.fallback(t.getValueNumber(`${a}G`),0)/255,i=o.fallback(t.getValueNumber(`${a}B`),0)/255,l=o.fallback(t.getValueNumber(`${a}A`),0)/255;n.colorFromRGBA(e,r,s,i,l)}class m{constructor(){this.Position=r.vec3.create(),this.Color=n.colorNewFromRGBA(1,1,1,1),this.FollowCamera=!1}copy(e){r.vec3.copy(this.Position,e.Position),n.colorCopy(this.Color,e.Color),this.FollowCamera=e.FollowCamera}setFromLightInfo(e,t){u(this.Color,e,`${t}Color`);const a=o.fallback(e.getValueNumber(`${t}PosX`),0),n=o.fallback(e.getValueNumber(`${t}PosY`),0),s=o.fallback(e.getValueNumber(`${t}PosZ`),0);r.vec3.set(this.Position,a,n,s),this.FollowCamera=0!==e.getValueNumber(`${t}FollowCamera`)}setLight(e,t){this.FollowCamera?r.vec3.copy(e.Position,this.Position):r.vec3.transformMat4(e.Position,this.Position,t.worldMatrix),r.vec3.set(e.Direction,1,0,0),n.colorCopy(e.Color,this.Color),r.vec3.set(e.CosAtten,1,0,0),r.vec3.set(e.DistAtten,1,0,0)}}class p{constructor(){this.Light0=new m,this.Light1=new m,this.Alpha2=0,this.Ambient=n.colorNewFromRGBA(1,1,1,1)}copy(e){this.Light0.copy(e.Light0),this.Light1.copy(e.Light1),this.Alpha2=e.Alpha2,n.colorCopy(this.Ambient,e.Ambient)}setFromLightInfo(e,t){this.Light0.setFromLightInfo(e,`${t}Light0`),this.Light1.setFromLightInfo(e,`${t}Light1`),u(this.Ambient,e,`${t}Ambient`),this.Alpha2=o.fallback(e.getValueNumber(`${t}Alpha2`),0)/255}setOnMaterialParams(e,t,a){this.Light0.setLight(e.u_Lights[0],t),this.Light1.setLight(e.u_Lights[1],t);const s=e.u_Lights[2];r.vec3.set(s.Position,0,0,0),r.vec3.set(s.Direction,0,-1,0),r.vec3.set(s.CosAtten,1,0,0),r.vec3.set(s.DistAtten,1,0,0),n.colorFromRGBA(s.Color,0,0,0,this.Alpha2),a&&n.colorCopy(e.u_Color[i.ColorKind.AMB0],this.Ambient)}setOnModelInstance(e,t,a){this.Light0.setLight(e.getGXLightReference(0),t),this.Light1.setLight(e.getGXLightReference(1),t);const s=e.getGXLightReference(2);r.vec3.set(s.Position,0,0,0),r.vec3.set(s.Direction,0,-1,0),r.vec3.set(s.CosAtten,1,0,0),r.vec3.set(s.DistAtten,1,0,0),n.colorFromRGBA(s.Color,0,0,0,this.Alpha2),a&&e.setColorOverride(i.ColorKind.AMB0,this.Ambient)}}class f{constructor(e){this.Player=new p,this.Strong=new p,this.Weak=new p,this.Planet=new p,this.AreaLightName=o.assertExists(e.getValueString("AreaLightName")),this.Interpolate=o.fallback(e.getValueNumber("Interpolate"),-1),this.Player.setFromLightInfo(e,"Player"),this.Strong.setFromLightInfo(e,"Strong"),this.Weak.setFromLightInfo(e,"Weak"),this.Planet.setFromLightInfo(e,"Planet")}getActorLightInfo(e){if(0===e)return this.Player;if(1===e)return this.Strong;if(2===e)return this.Weak;if(3===e)return this.Planet;throw"whoops"}}t.AreaLightInfo=f;const A=r.vec3.create();function g(e,t,a,n,s){if(a.FollowCamera===e.FollowCamera)r.vec3.lerp(e.Position,a.Position,n.Position,s);else if(a.FollowCamera)r.vec3.transformMat4(A,a.Position,t.worldMatrix),r.vec3.lerp(e.Position,A,n.Position,s);else{if(!e.FollowCamera)throw"whoops";r.vec3.transformMat4(A,e.Position,t.viewMatrix),r.vec3.lerp(e.Position,a.Position,n.Position,s)}}t.ActorLightCtrl=class{constructor(e,t=-1){this.assocActor=e,this.lightType=t,this.currentAreaLight=null,this.blendAnimActorLight=new p,this.blendOutActorLight=null,this.zoneLightId=new b,this.interpolate=-1,this.blendAmount=-1}init(e){this.initActorLightInfo(e),this.tryFindNewAreaLight(e,!1);const t=e.lightDirector.getAreaLightInfo(e,this.zoneLightId);this.currentAreaLight=t;const a=this.getTargetActorLight(t);this.blendAnimActorLight.copy(a)}getTargetActorLight(e){return e.getActorLightInfo(this.lightType)}initActorLightInfo(e){-1===this.lightType&&e.sceneNameObjListExecutor.findLightInfo(this.assocActor)}reset(e){this.zoneLightId.clear();let t=!1;null!==e.lightDirector.lightAreaHolder&&(t=e.lightDirector.lightAreaHolder.tryFindLightID(this.zoneLightId,this.assocActor.translation)),t&&(this.resetCurrentLightInfo(e),this.blendOutActorLight=null,this.blendAnimActorLight.copy(this.getTargetActorLight(this.currentAreaLight))),this.currentAreaLight=e.lightDirector.getAreaLightInfo(e,this.zoneLightId)}updateLightBlend(e,t){if(null!==this.blendOutActorLight)if(this.blendAmount+=t,this.blendAmount<this.interpolate){const t=this.blendAmount/this.interpolate,a=this.getTargetActorLight(this.currentAreaLight);!function(e,t,a,r,s){n.colorLerp(e.Light0.Color,a.Light0.Color,r.Light0.Color,s),n.colorLerp(e.Light1.Color,a.Light1.Color,r.Light1.Color,s),n.colorLerp(e.Ambient,a.Ambient,r.Ambient,s),g(e.Light0,t,a.Light0,r.Light0,s),g(e.Light1,t,a.Light1,r.Light1,s),e.Alpha2=d.lerp(a.Alpha2,r.Alpha2,s)}(this.blendAnimActorLight,e,this.blendOutActorLight,a,t)}else this.blendAnimActorLight.copy(this.getTargetActorLight(this.currentAreaLight)),this.blendOutActorLight=null,this.blendAmount=-1}update(e,t,a,r){h.isHiddenModel(this.assocActor)||(this.tryFindNewAreaLight(e,a),this.updateLightBlend(t,r))}resetCurrentLightInfo(e){const t=e.lightDirector.getAreaLightInfo(e,this.zoneLightId);this.currentAreaLight=t,this.interpolate=t.Interpolate;const a=this.getTargetActorLight(t);this.blendAnimActorLight.Light0.FollowCamera=a.Light0.FollowCamera,this.blendAnimActorLight.Light1.FollowCamera=a.Light1.FollowCamera}tryFindNewAreaLight(e,t=!1){let a=!1;if(null!==e.lightDirector.lightAreaHolder&&(a=e.lightDirector.lightAreaHolder.tryFindLightID(this.zoneLightId,this.assocActor.translation)),a){if(null!==this.currentAreaLight&&(this.blendOutActorLight=this.getTargetActorLight(this.currentAreaLight),this.blendAnimActorLight.copy(this.blendOutActorLight)),this.resetCurrentLightInfo(e),0===this.interpolate||t){this.interpolate=0,this.blendOutActorLight=null;const e=this.getTargetActorLight(this.currentAreaLight);this.blendAnimActorLight.copy(e)}this.interpolate<0&&(this.interpolate=30)}}loadLight(e,t){if(null!==this.currentAreaLight)if(null!==this.blendOutActorLight)this.blendAnimActorLight.setOnModelInstance(e,t,!0);else{this.getTargetActorLight(this.currentAreaLight).setOnModelInstance(e,t,!0)}}};class _{constructor(e,t,a){this.zoneId=e,this.zoneName=t,this.lightIdToAreaLightName=new Map;for(let e=0;e<a.getNumRecords();e++){a.setRecord(e);const t=o.fallback(a.getValueNumber("LightID"),-1),r=o.assertExists(a.getValueString("AreaLightName"));this.lightIdToAreaLightName.set(t,r)}}getAreaLightName(e){return this.lightIdToAreaLightName.get(e)}}t.LightDataHolder=class{constructor(e){this.areaLightInfos=[],this.zoneInfos=[];for(let t=0;t<e.getNumRecords();t++)e.setRecord(t),this.areaLightInfos.push(new f(e))}ensureZoneInfo(e,t){for(let e=0;e<this.zoneInfos.length;e++)if(this.zoneInfos[e].zoneId===t)return this.zoneInfos[e];const a=e.scenarioData.zoneNames[t],r=e.sceneDesc.getZoneLightData(e.modelCache,a),n=new _(t,a,r);return this.zoneInfos.push(n),n}getAreaLightName(e,t,a){return t<0&&(t=0),this.ensureZoneInfo(e,t).getAreaLightName(a)}findAreaLight(e){for(let t=0;t<this.areaLightInfos.length;t++)if(this.areaLightInfos[t].AreaLightName===e)return this.areaLightInfos[t];return null}};class S extends c.NameObj{constructor(e,t){super(e,"LightDirector"),this.lightDataHolder=t,this.lightAreaHolder=null}findDefaultAreaLight(e){return this.findAreaLightFromZoneAndId(e,0,-1)}getAreaLightInfo(e,t){return this.findAreaLightFromZoneAndId(e,t.zoneId,t.lightId)}findAreaLightFromZoneAndId(e,t,a){const r=this.lightDataHolder.getAreaLightName(e,t,a);return o.assertExists(this.lightDataHolder.findAreaLight(r))}}t.LightDirector=S;class b{constructor(){this.clear()}clear(){this.zoneId=-1,this.lightId=-1}isOutOfArea(){return this.zoneId<0}isTargetArea(e){return this.zoneId===e.zoneId&&this.lightId===e.lightId}}class v extends l.AreaObjMgr{constructor(e){super(e,"LightArea"),e.lightDirector.lightAreaHolder=this}initAfterPlacement(){this.sort()}sort(){this.areaObj.sort((e,t)=>t.priority-e.priority)}tryFindLightID(e,t){const a=this.find_in(t);return null!==a?!e.isTargetArea(a)&&(e.zoneId=a.zoneId,e.lightId=a.lightId,!0):e.isOutOfArea()?(e.clear(),!1):(e.clear(),!0)}}t.LightAreaHolder=v;class w extends l.AreaObj{constructor(e,t,a,r){super(e,t,a,r),this.zoneId=e.zoneId,this.lightId=o.fallback(s.getJMapInfoArg0(a),-1),this.priority=o.fallback(s.getJMapInfoArg1(a),-1)}getManagerName(){return"LightArea"}}t.LightArea=w,t.createLightCtrlCube=function(e,t,a){return new w(e,t,a,1)},t.createLightCtrlCylinder=function(e,t,a){return new w(e,t,a,3)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(0),s=a(2),i=a(26),o=a(89),l=a(28);class c{constructor(){this.Name="",this.PlayFrame=-1,this.StartFrame=-1,this.EndFrame=-1,this.RepeatFrame=-1,this.Interpole=-1,this.Attribute=255}setFromAnmt(e){this.Name=n.assertExists(e.getValueString("name")),this.PlayFrame=n.assertExists(e.getValueNumber("play_frame")),this.StartFrame=n.assertExists(e.getValueNumber("start_frame")),this.EndFrame=n.assertExists(e.getValueNumber("end_frame")),this.Interpole=n.assertExists(e.getValueNumber("interpole"));const t=n.assertExists(e.getValueNumber("attribute"));t>-1&&(this.Attribute=t)}}t.BckCtrlData=c;class h{constructor(){this.defaultBckCtrlData=new c,this.bckCtrlDatas=[]}static parse(e){const t=new h;return t.setFromAnmt(l.createCsvParser(e)),t}setFromAnmt(e){e.mapRecords((e,t)=>{let a;"_default"===n.assertExists(e.getValueString("name"))?a=this.defaultBckCtrlData:(a=new c,this.bckCtrlDatas.push(a)),a.setFromAnmt(e)})}find(e){for(let t=0;t<this.bckCtrlDatas.length;t++)if(this.bckCtrlDatas[t].Name.toLowerCase()===e.toLowerCase())return this.bckCtrlDatas[t];return null}changeBckSetting(e,t){const a=this.find(e);null!==a&&(a.Interpole>-1||a.PlayFrame>-1||a.StartFrame>-1||a.EndFrame>-1||a.RepeatFrame>-1||255!==a.Attribute)?d(a,t):d(this.defaultBckCtrlData,t)}}function d(e,t){const a=t.frameCtrl;if(e.StartFrame>-1&&e.StartFrame<a.endFrame&&(a.startFrame=e.StartFrame,a.currentTimeInFrames=e.StartFrame,a.repeatStartFrame=e.StartFrame),e.EndFrame>-1&&e.EndFrame<a.endFrame&&(a.endFrame=e.EndFrame),e.RepeatFrame>-1&&e.RepeatFrame<a.endFrame&&(a.repeatStartFrame=e.RepeatFrame),e.PlayFrame>-1){const r=0!==e.PlayFrame?(a.endFrame-a.startFrame)/e.PlayFrame:0;t.changeSpeed(r)}e.Interpole>-1&&t.changeInterpoleFrame(e.Interpole),255!==e.Attribute&&(a.loopMode=e.Attribute)}function u(e,t){return n.nullify(e.get(t.toLowerCase()))}t.BckCtrl=h,t.getRes=u;class m{constructor(e){this.resTable=e,this.frameCtrl=new o.J3DFrameCtrl(0),this.currentRes=null,this.currentResName=null}startAnimation(){}stopAnimation(){}start(e){const t=n.assertExists(u(this.resTable,e));this.currentRes!==t&&(this.currentRes=t,this.currentResName=e.toLowerCase(),this.startAnimation()),this.frameCtrl.init(this.currentRes.duration),this.frameCtrl.loopMode=this.currentRes.loopMode}stop(){this.stopAnimation(),this.frameCtrl.speedInFrames=0}update(e){null!==this.currentRes&&this.frameCtrl.update(e)}isPlaying(e){return this.currentResName===e}isStop(){return null!==this.currentRes&&!!(1&this.frameCtrl.updateFlags)&&0===this.frameCtrl.speedInFrames}}t.AnmPlayerBase=m;class p{constructor(){this.scale=r.vec3.create(),this.translation=r.vec3.create(),this.rotation=r.quat.create()}copy(e){r.vec3.copy(this.scale,e.scale),r.vec3.copy(this.translation,e.translation),r.quat.copy(this.rotation,e.rotation)}}class f{constructor(){this.xformFrozen=new p,this.xformAnm=new p}}class A extends o.J3DFrameCtrl{constructor(){super(...arguments),this.interpoleFrame=0}}t.XanimeFrameCtrl=A;const g=r.vec3.create(),_=r.vec3.create(),S=r.quat.create();class b{constructor(e){this.curAnmTime=0,this.interpoleRatio=0,this.freeze=!1,this.resetJointXform=!1,this.ank1=null,this.joints=n.nArray(e,()=>new f)}initT(e){const t=e.bmd.jnt1.joints;for(let e=0;e<t.length;e++){const a=t[e],n=this.joints[e];r.vec3.set(n.xformFrozen.translation,a.translationX,a.translationY,a.translationZ),r.vec3.set(n.xformFrozen.scale,a.scaleX,a.scaleY,a.scaleZ),s.quatFromEulerRadians(n.xformFrozen.rotation,a.rotationX,a.rotationY,a.rotationZ),n.xformAnm.copy(n.xformFrozen)}}doFreeze(){this.freeze=!0}updateFrame(){this.resetJointXform=this.freeze,this.freeze=!1}setBck(e,t){n.assert(0===e),this.ank1=t}calcSingle(e){const t=this.joints[e];if(null!==this.ank1){const a=this.ank1.jointAnimationEntries[e],n=this.curAnmTime*this.ank1.duration,o=i.sampleAnimationData(a.scaleX,n),l=i.sampleAnimationData(a.scaleY,n),c=i.sampleAnimationData(a.scaleZ,n),h=i.sampleAnimationData(a.rotationX,n)*Math.PI,d=i.sampleAnimationData(a.rotationY,n)*Math.PI,u=i.sampleAnimationData(a.rotationZ,n)*Math.PI,m=i.sampleAnimationData(a.translationX,n),p=i.sampleAnimationData(a.translationY,n),f=i.sampleAnimationData(a.translationZ,n),A=g,b=_,v=S;r.vec3.set(A,o,l,c),r.vec3.set(b,m,p,f),s.quatFromEulerRadians(v,h,d,u),this.resetJointXform&&t.xformFrozen.copy(t.xformAnm),this.interpoleRatio<1&&(r.vec3.lerp(A,t.xformFrozen.scale,A,this.interpoleRatio),r.vec3.lerp(b,t.xformFrozen.translation,b,this.interpoleRatio),r.quat.lerp(v,t.xformFrozen.rotation,S,this.interpoleRatio)),r.vec3.copy(t.xformAnm.scale,A),r.vec3.copy(t.xformAnm.translation,b),r.quat.copy(t.xformAnm.rotation,v)}}calcJointMatrix(e,t,a){this.calcSingle(t);const n=this.joints[t];r.mat4.fromRotationTranslationScale(e,n.xformAnm.rotation,n.xformAnm.translation,n.xformAnm.scale)}}t.XanimeCore=b;t.XanimePlayer=class{constructor(e,t){this.resTable=e,this.modelInstance=t,this.frameCtrl=new A(0),this.currentRes=null,this.currentResName=null,this.interpoleRatio=0,this.interpoleFrameCounter=0,this.updatedFrameCtrl=!1,this.oldTimeInFrames=0,this.oldSpeedInFrames=0,this.core=new b(this.modelInstance.modelData.bmd.jnt1.joints.length),this.core.initT(this.modelInstance.modelData)}isRun(e){return this.currentResName===e}isTerminate(e){return this.currentResName!==e||0===this.frameCtrl.speedInFrames}getCurrentBckName(){return this.currentResName}changeAnimationBck(e){const t=u(this.resTable,e);null!==t?(this.changeAnimationSimple(t),this.currentRes=t,this.currentResName=e):this.currentResName=null}changeAnimationSimple(e){this.core.doFreeze(),this.core.setBck(0,e),this.frameCtrl.init(e.duration),this.frameCtrl.loopMode=e.loopMode,this.frameCtrl.interpoleFrame=1,this.interpoleRatio=0}calcAnm(){if(null!==this.currentRes){const e=0!==this.currentRes.duration?this.currentRes.duration:1,t=this.updatedFrameCtrl?this.oldTimeInFrames:this.frameCtrl.currentTimeInFrames;this.core.curAnmTime=t/e}this.core.updateFrame(),this.modelInstance.jointMatrixCalc=this.core,this.updatedFrameCtrl=!1}clearAnm(){}stop(){this.frameCtrl.speedInFrames=0}updateInterpoleRatio(e=1){const t=this.frameCtrl;0===t.speedInFrames&&1!==t.loopMode?(this.interpoleRatio=1,t.interpoleFrame=0):this.interpoleFrameCounter>=t.interpoleFrame?(this.interpoleRatio=1,t.interpoleFrame=0):(this.interpoleFrameCounter+=e,this.interpoleRatio=this.interpoleFrameCounter/Math.max(t.interpoleFrame,1))}update(e){null!==this.currentRes&&(this.oldTimeInFrames=this.frameCtrl.currentTimeInFrames,this.oldSpeedInFrames=this.frameCtrl.speedInFrames,this.frameCtrl.update(e),this.updatedFrameCtrl=!0,this.updateInterpoleRatio(e),this.core.interpoleRatio=this.interpoleRatio)}changeSpeed(e){this.frameCtrl.speedInFrames=e}changeInterpoleFrame(e){this.frameCtrl.interpoleFrame=e,this.interpoleFrameCounter=0,0===e?(this.interpoleRatio=1,this.core.interpoleRatio=1):(this.interpoleRatio=0,this.core.interpoleRatio=0,this.updateInterpoleRatio(1))}checkPass(e,t){return this.updatedFrameCtrl?this.frameCtrl.checkPass(e,t,this.oldTimeInFrames,this.oldSpeedInFrames):this.frameCtrl.checkPass(e,t)}};t.BtkPlayer=class extends m{constructor(e,t){super(e),this.modelInstance=t}startAnimation(){o.entryTexMtxAnimator(this.modelInstance,this.currentRes,this.frameCtrl)}stopAnimation(){o.removeTexMtxAnimator(this.modelInstance,this.currentRes)}};t.BrkPlayer=class extends m{constructor(e,t){super(e),this.modelInstance=t}startAnimation(){o.entryTevRegAnimator(this.modelInstance,this.currentRes,this.frameCtrl)}stopAnimation(){o.removeTevRegAnimator(this.modelInstance,this.currentRes)}};t.BtpPlayer=class extends m{constructor(e,t){super(e),this.modelInstance=t}startAnimation(){o.entryTexNoAnimator(this.modelInstance,this.currentRes,this.frameCtrl)}stopAnimation(){o.removeTexNoAnimator(this.modelInstance,this.currentRes)}};t.BvaPlayer=class extends m{constructor(e,t){super(e),this.modelInstance=t}calc(){if(null!==this.currentRes)for(let e=0;e<this.modelInstance.shapeInstances.length;e++)this.modelInstance.shapeInstances[e].visible=o.VAF1_getVisibility(this.currentRes,e,this.frameCtrl.currentTimeInFrames)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(53),s=a(43),i=a(40),o=a(0);class l{constructor(e,t,a,n,s){this.sensorType=t,this.radius=n,this.actor=s,this.center=r.vec3.create(),this.pairwiseSensors=[],this.sensorValid=!1,function(e,t){e.create(0),e.sensorHitChecker.initGroup(t)}(e,this)}isType(e){return this.sensorType===e}addHitSensor(e){this.pairwiseSensors.push(e)}invalidateBySystem(){this.sensorValid&&(o.arrayRemove(this.group,this),this.sensorValid=!1)}validateBySystem(){this.sensorValid||(this.group.push(this),this.sensorValid=!0)}}t.HitSensor=l;const c=r.vec3.create();class h{constructor(e,t,a,n,s,i,o){this.name=e,this.sensor=t,this.translation=a,this.baseMtx=n,this.useCallback=o,this.offset=r.vec3.create(),r.vec3.copy(this.offset,i)}doObjCol(e){for(let t=0;t<this.sensor.pairwiseSensors.length;t++)n.isDead(this.sensor.pairwiseSensors[t].actor)||this.sensor.actor.attackSensor(e,this.sensor,this.sensor.pairwiseSensors[t])}update(){if(this.useCallback);else if(null!==this.baseMtx);else{const e=this.sensor.center;null!==this.translation?r.vec3.copy(e,this.translation):r.vec3.copy(e,this.sensor.actor.translation);const t=this.sensor.actor.getBaseMtx();null!==t?(r.vec3.transformMat4(c,this.offset,t),r.vec3.add(e,e,c)):r.vec3.add(e,e,this.offset)}}}t.HitSensorInfo=h;function d(e){return e.isType(1)}function u(e){return e.sensorType>8&&e.sensorType<18}function m(e){return e.sensorType>111&&e.sensorType<116}function p(e){return e.sensorType>96&&e.sensorType<110}function f(e){return e.sensorType>69&&e.sensorType<95}t.HitSensorKeeper=class{constructor(){this.sensorInfos=[]}add(e,t,a,r,n,s,i){const o=new l(e,a,r,n,s),c=new h(t,o,null,null,n,i,!1);this.sensorInfos.push(c),c.update()}getSensor(e){for(let t=0;t<this.sensorInfos.length;t++)if(this.sensorInfos[t].name===e)return this.sensorInfos[t].sensor;return null}invalidateBySystem(){for(let e=0;e<this.sensorInfos.length;e++)this.sensorInfos[e].sensor.invalidateBySystem()}validateBySystem(){for(let e=0;e<this.sensorInfos.length;e++)this.sensorInfos[e].sensor.validateBySystem()}clear(){for(let e=0;e<this.sensorInfos.length;e++)this.sensorInfos[e].sensor.pairwiseSensors.length=0}doObjCol(e){for(let t=0;t<this.sensorInfos.length;t++)this.sensorInfos[t].doObjCol(e)}update(){for(let e=0;e<this.sensorInfos.length;e++)this.sensorInfos[e].update()}},t.isSensorPlayer=d,t.isSensorRide=u,t.isSensorRush=m,t.isSensorAutoRush=p,t.isSensorMapObj=f,t.isSensorNpc=function(e){return e.sensorType>4&&e.sensorType<6};class A extends i.NameObj{constructor(e){super(e,"SensorHitChecker"),this.playerGroup=[],this.rideGroup=[],this.eyeGroup=[],this.simpleGroup=[],this.mapObjGroup=[],this.characterGroup=[],s.connectToScene(e,this,5,-1,-1,-1)}clearGroup(e){for(let t=0;t<e.length;t++)e[t].pairwiseSensors.length=0}initGroup(e){d(e)?e.group=this.playerGroup:u(e)?e.group=this.rideGroup:e.isType(127)?e.group=this.eyeGroup:e.isType(74)||e.isType(76)||e.isType(21)||e.isType(71)||e.isType(31)||m(e)||p(e)?e.group=this.simpleGroup:f(e)?e.group=this.mapObjGroup:e.group=this.characterGroup}movement(e,t){super.movement(e,t),this.clearGroup(this.playerGroup),this.clearGroup(this.rideGroup),this.clearGroup(this.eyeGroup),this.clearGroup(this.simpleGroup),this.clearGroup(this.mapObjGroup),this.clearGroup(this.characterGroup),this.doObjColGroup(this.playerGroup,this.characterGroup),this.doObjColGroup(this.playerGroup,this.mapObjGroup),this.doObjColGroup(this.playerGroup,this.rideGroup),this.doObjColGroup(this.playerGroup,this.simpleGroup),this.doObjColGroup(this.playerGroup,this.eyeGroup),this.doObjColGroup(this.rideGroup,this.characterGroup),this.doObjColGroup(this.rideGroup,this.mapObjGroup),this.doObjColGroup(this.rideGroup,this.simpleGroup),this.doObjColGroup(this.rideGroup,this.eyeGroup),this.doObjColGroup(this.eyeGroup,this.characterGroup),this.doObjColGroup(this.eyeGroup,this.mapObjGroup),this.doObjColGroup(this.eyeGroup,this.simpleGroup),this.doObjColGroup(this.characterGroup,this.mapObjGroup),this.doObjColInSameGroup(this.characterGroup)}doObjColGroup(e,t){for(let a=0;a<e.length;a++){const r=e[a];for(let e=0;e<t.length;e++){const a=t[e];this.checkAttack(r,a)}}}doObjColInSameGroup(e){for(let t=0;t<e.length;t++){const a=e[t];for(let r=t+1;r<e.length;r++){const t=e[r];this.checkAttack(a,t)}}}checkAttack(e,t){if(e.actor!==t.actor){const a=r.vec3.squaredDistance(e.center,t.center),n=e.radius+t.radius;a<n*n&&(t.isType(127)||e.addHitSensor(t),e.isType(127)||t.addHitSensor(e))}}}t.SensorHitChecker=A},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.InputStream=class{constructor(e,t){this.buffer=e,this.assetIDLength=t,this.offs=0,this.setBuffer(e)}setBuffer(e){this.buffer=e,this.view=e.createDataView(),this.offs=0}getBuffer(){return this.buffer}skip(e){this.offs+=e}goTo(e){this.offs=e}tell(){return this.offs}align(e){this.offs=r.align(this.offs,e)}readBool(){const e=this.view.getUint8(this.offs++);return r.assert(0==e||1==e),1==e}readInt8(){return this.view.getInt8(this.offs++)}readUint8(){return this.view.getUint8(this.offs++)}readInt16(){const e=this.view.getInt16(this.offs);return this.offs+=2,e}readUint16(){const e=this.view.getUint16(this.offs);return this.offs+=2,e}readInt32(){const e=this.view.getInt32(this.offs);return this.offs+=4,e}readUint32(){const e=this.view.getUint32(this.offs);return this.offs+=4,e}readFloat32(){const e=this.view.getFloat32(this.offs);return this.offs+=4,e}readString(e=-1,t=!0){const a=r.readString(this.buffer,this.offs,e,t);return this.offs+=a.length,t&&this.offs++,a}readFourCC(){return this.readString(4,!1)}readAssetID(){return r.assert(0!==this.assetIDLength,"Asset ID length has not been set"),this.readString(this.assetIDLength,!1)}}},function(e,t,a){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=r.mat4.fromValues(1,0,0,0,0,1,0,0,0,0,2,0,0,0,-1,1);t.projectionMatrixOpenGLFromD3D=function(e){r.mat4.mul(e,n,e)};const s=r.mat4.fromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1);t.projectionMatrixD3DFromOpenGL=function(e){r.mat4.mul(e,s,e)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(272)),s=a(0),i=a(180);function o(e){return e=(e=(e=(e=e.toLowerCase().replace(/\\/g,"/")).replace(/^c:\/psychonauts\/resource\//,"")).replace(/^workresource\//,"")).replace(/\.(tga|dds)$/,"")}function l(e,t,a){switch(a=Math.max(a,4),t=Math.max(t,4),e){case 9:return t*a>>>1;case 10:case 11:return t*a;default:return function(e){switch(e){case 0:case 1:case 13:return 4;case 2:case 3:case 4:case 5:case 12:return 2;case 6:case 7:return 1;default:throw"whoops"}}(e)*t*a}}function c(e){const t=new i.DataStream(e);t.offs=40;let a="";t.view.getUint32(12,!0)&&(a=t.readStringStream_2b()),a=o(a);let r=1;t.view.getUint32(16,!0)&&(r=t.readUint32(),t.offs+=24);t.readUint32();const n=t.readUint32(),s=t.readUint32(),c=(t.readUint32(),t.readUint32()),h=t.readUint32(),d=t.readUint32();t.offs+=16;const u=[];let m=c,p=h;for(let e=0;e<d;e++){const e=l(n,m,p);u.push(t.readSlice(e)),m>1&&(m>>>=1),p>1&&(p>>>=1)}return{name:a,type:s,format:n,width:c,height:h,mipData:u}}function h(e,t,a){for(let r=0;r<a;r++){const a=e.readString(4);s.assert(" XT1"===a);const r=e.readUint32();t.push(c(e.readSlice(r)))}}t.normalizeTextureName=o,t.getTextureFormatName=function(e){switch(e){case 0:return"B8G8R8A8";case 1:return"B8G8R8X8";case 2:return"R4G4B4A4";case 3:return"R5G5B5A1";case 4:return"R5G5B5X1";case 5:return"R5G6B5";case 6:return"A8";case 7:return"L8";case 8:return"L8_2";case 9:return"DXT1";case 10:return"DXT3";case 11:return"DXT5";case 12:return"L8A8";case 13:return"L16A16"}},t.parsePPAKTexture=c,t.parse=function(e,t){const a=new i.DataStream(e);s.assert("PPAK"===a.readString(4));const r=function(e){let t=e.readUint16(),a=0;65021===t&&(a=e.readUint16(),t=e.readUint16());const r=[];for(s.assert(1===a);65535===t;){const a=e.readUint16(),n=e.readUint32();if(0===a){const t=e.readUint16();h(e,r,t)}else e.offs+=n;t=e.readUint16()}return s.assert(65535!=t),h(e,r,t),r}(a);s.assert("MPAK"===a.readString(4));const o=a.readUint16();for(let e=0;e<o;e++){a.readStringStream_2b(),a.readUint16();const e=a.readUint32();a.readSlice(e)}let l=null;if(t){!function(e){let t=e.readUint16(),a=0;64764===t&&(a=e.readUint16(),t=e.readUint16());for(let a=0;a<t;a++){e.readStringStream_2b();const t=e.readUint32();e.offs+=t}const r=e.readUint16();for(let t=0;t<r;t++){if(a){e.readStringStream_2b()}const t=e.readUint32();e.offs+=t}}(a);const e=a.buffer.slice(a.offs);l=n.parse(e,"MainScene")}return{textures:r,mainScene:l}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(188),n=a(100),s=a(317);class i{constructor(e){this.isDeletedMap=e}async create(e,t,a){this.locationNum=e;const r=a.pathBase;this.trkblkTab=(await t.fetchData(`${r}/TRKBLK.tab`)).createDataView();const s=n.getSubdir(e,a);if(this.isDeletedMap){console.log(`isDeletedMap; subdir ${s}`);const[a,n]=await Promise.all([t.fetchData(`${r}/mod${h(e)}.tab`),t.fetchData(`${r}/mod${h(e)}.bin`)]);this.blocksTab=a.createDataView(),this.blocksBin=n}else{const[a,n]=await Promise.all([t.fetchData(`${r}/${s}/mod${h(e)}.tab`),t.fetchData(`${r}/${s}/mod${h(e)}.zlb.bin`)]);this.blocksTab=a.createDataView(),this.blocksBin=n}}getBlock(e,t){if(this.isDeletedMap){let e=0;for(let t=0;t<this.blocksTab.byteLength/4&&268435456!=this.blocksTab.getUint32(4*t);t++)e++;const a=e+t;if(a<0||4*a>=this.blocksTab.byteLength)return null;const r=this.blocksTab.getUint32(4*a);if(!(268435456&r))return null;const n=16777215&r;return console.log(`Loading deleted block from offset 0x${n.toString(16)} (location num ${this.locationNum})`),this.blocksBin.slice(n)}if(e<0||2*e>=this.trkblkTab.byteLength)return null;const a=this.trkblkTab.getUint16(2*e)+t;if(a<0||4*a>=this.blocksTab.byteLength)return null;const r=this.blocksTab.getUint32(4*a);if(!(268435456&r))return null;const s=16777215&r,i=this.blocksBin.slice(s);return n.loadRes(i)}}t.SFA_GAME_INFO={pathBase:"StarFoxAdventures",makeBlockFetcher:async(e,t,a)=>{const r=new i(!1);return await r.create(e,t,a),r},subdirs:{0:"animtest",1:"animtest",2:"animtest",3:"arwing",4:"dragrock",5:"animtest",6:"dfptop",7:"volcano",8:"animtest",9:"mazecave",10:"dragrockbot",11:"dfalls",12:"swaphol",13:"shipbattle",14:"nwastes",15:"warlock",16:"shop",17:"animtest",18:"crfort",19:"swapholbot",20:"wallcity",21:"lightfoot",22:"cloudtreasure",23:"animtest",24:"clouddungeon",25:"mmpass",26:"darkicemines",27:"animtest",28:"desert",29:"animtest",30:"icemountain",31:"animtest",32:"animtest",33:"animtest",34:"darkicemines2",35:"bossgaldon",36:"animtest",37:"insidegal",38:"magiccave",39:"dfshrine",40:"mmshrine",41:"ecshrine",42:"gpshrine",43:"dbshrine",44:"nwshrine",45:"worldmap",46:"animtest",47:"capeclaw",48:"dbay",49:"animtest",50:"cloudrace",51:"bossdrakor",52:"animtest",53:"bosstrex",54:"linkb",55:"cloudjoin",56:"arwingtoplanet",57:"arwingdarkice",58:"arwingcloud",59:"arwingcity",60:"arwingdragon",61:"gamefront",62:"linklevel",63:"greatfox",64:"linka",65:"linkc",66:"linkd",67:"linke",68:"linkf",69:"linkg",70:"linkh",71:"linkj",72:"linki"}};const o={1:22,2:35,3:57,4:87,5:0,6:142,7:164,8:186,9:208,10:230,11:252,12:275,13:297,14:323,15:345,16:384,17:448,18:453,19:475,20:510,21:532,22:554,23:576,24:598,25:620,26:642,27:664,28:708,29:730,30:752,31:774,32:788,33:805,34:821,35:843,36:867,37:872,38:894,39:916,40:938,41:960,42:982,43:1004,44:1026,45:1048,46:1070,47:1071,48:1093,49:1115,50:1137,51:1159,52:1183,53:1205,54:1227,55:1243};class l{async create(e,t){const a=t.pathBase;this.blocksTab=(await e.fetchData(`${a}/BLOCKS.tab`)).createDataView(),this.blocksBin=await e.fetchData(`${a}/BLOCKS.bin`)}getBlock(e,t){const a=o[e]+t;if(a<0||4*a>=this.blocksTab.byteLength)return null;const r=this.blocksTab.getUint32(4*a);return console.log(`Loading block ${a} from BLOCKS.bin offset 0x${r.toString(16)}`),this.blocksBin.slice(r)}}t.SFADEMO_GAME_INFO={pathBase:"StarFoxAdventuresDemo",makeBlockFetcher:async(e,t,a)=>{const r=new i(!0);return await r.create(e,t,a),r},subdirs:{0:"animtest",1:"animtest",2:"animtest",3:"arwing",4:"dragrock",5:"animtest",6:"dfptop",7:"volcano",8:"animtest",9:"mazecave",10:"dragrockbot",11:"dfalls",12:"swaphol",13:"shipbattle",14:"nwastes",15:"warlock",16:"shop",17:"animtest",18:"crfort",19:"swapholbot",20:"wallcity",21:"lightfoot",22:"cloudtreasure",23:"animtest",24:"clouddungeon",25:"mmpass",26:"darkicemines",27:"dfptop",28:"desert",29:"frontend",30:"icemountain",31:"mmshrine",32:"animtest",33:"animtest",34:"darkicemines2",35:"bossgaldon",36:"animtest",37:"insidegal",38:"magiccave",39:"dfshrine",40:"mmshrine",41:"ecshrine",42:"gpshrine",43:"dbshrine",44:"nwshrine",45:"worldmap",46:"animtest",47:"capeclaw",48:"dbay",49:"animtest",50:"cloudrace",51:"bossdrakor",52:"animtest",53:"bosstrex",54:"linkb",57:"arwingdarkice",58:"arwingcloud",59:"arwingcity",60:"arwingdragon",61:"gamefront",62:"linklevel",63:"greatfox",64:"linka",65:"linkc",66:"linkd",67:"linke",68:"linkf",69:"linkg",70:"linkh",71:"linkj",72:"linki"}};const c={pathBase:"StarFoxAdventuresDemo",makeBlockFetcher:async(e,t,a)=>{const r=new l;return await r.create(t,a),r},subdirs:[]};function h(e){return e<5?e:e+1}const d=["Maps",new r.SFAMapSceneDesc(2,"loc2","Dragon Rock"),new r.SFAMapSceneDesc(4,"loc4","Volcano Force Point Temple"),new r.SFAMapSceneDesc(7,"loc7","ThornTail Hollow"),new r.SFAMapSceneDesc(8,"loc8","ThornTail Hollow Well"),new r.SFAMapSceneDesc(9,"loc9","Cheat Token Maze"),new r.SFAMapSceneDesc(10,"loc10","SnowHorn Wastes"),new r.SFAMapSceneDesc(11,"loc11","Krazoa Palace"),new r.SFAMapSceneDesc(12,"loc12","CloudRunner Fortress"),new r.SFAMapSceneDesc(13,"loc13","Walled City"),new r.SFAMapSceneDesc(14,"loc14","LightFoot Village"),new r.SFAMapSceneDesc(16,"loc16","CloudRunner Fortress Dungeon"),new r.SFAMapSceneDesc(18,"loc18","Moon Mountain Pass"),new r.SFAMapSceneDesc(19,"loc19","DarkIce Mines Exterior"),new r.SFAMapSceneDesc(21,"loc21","Ocean Force Point Temple Interior"),new r.SFAMapSceneDesc(23,"loc23","Ice Mountain"),new r.SFAMapSceneDesc(26,"loc26","Test Map (animtest)"),new r.SFAMapSceneDesc(27,"loc27","DarkIce Mines Interior"),new r.SFAMapSceneDesc(28,"loc28","DarkIce Mines Boss (Galdon)"),new r.SFAMapSceneDesc(29,"loc29","Cape Claw"),new r.SFAMapSceneDesc(31,"loc31","Krazoa Shrine (Test of Combat)"),new r.SFAMapSceneDesc(32,"loc32","Krazoa Shrine (Test of Fear)"),new r.SFAMapSceneDesc(33,"loc33","Krazoa Shrine (Test of Observation)"),new r.SFAMapSceneDesc(34,"loc34","Krazoa Shrine (Test of Knowledge)"),new r.SFAMapSceneDesc(39,"loc39","Krazoa Shrine (Test of Strength)"),new r.SFAMapSceneDesc(40,"loc40","Krazoa Shrine (Scales Encounter)"),new r.SFAMapSceneDesc(43,"loc43","CloudRunner Fortress Race"),new r.SFAMapSceneDesc(44,"loc44","Dragon Rock Boss (Drakor)"),new r.SFAMapSceneDesc(45,"loc45","SnowHorn Wastes Area"),new r.SFAMapSceneDesc(48,"loc48","Walled City Boss (RedEye King)"),new r.SFAMapSceneDesc(50,"loc50","Ocean Force Point Temple Exterior"),new r.SFAMapSceneDesc(51,"loc51","ThornTail Shop"),new r.SFAMapSceneDesc(54,"loc54","Magic Cave"),new r.SFAMapSceneDesc(55,"loc55","Ice Mountain Link"),new r.SFAMapSceneDesc(56,"loc56","Ice Mountain Link 2"),new r.SFAMapSceneDesc(58,"loc58","Arwing Flight (Main Planet)"),new r.SFAMapSceneDesc(59,"loc59","Arwing Flight (DarkIce Mines)"),new r.SFAMapSceneDesc(60,"loc60","Arwing Flight (CloudRunner Fortress)"),new r.SFAMapSceneDesc(61,"loc61","Arwing Flight (Walled City)"),new r.SFAMapSceneDesc(62,"loc62","Arwing Flight (Dragon Rock)"),new r.SFAMapSceneDesc(63,"loc63","Great Fox"),new r.SFAMapSceneDesc(65,"loc65","Great Fox 2"),new r.SFAMapSceneDesc(67,"loc67","SnowHorn Wastes Link"),new r.SFAMapSceneDesc(68,"loc68","DarkIce Mines Mineshaft"),new r.SFAMapSceneDesc(69,"loc69","Moon Mountain Pass Link"),new r.SFAMapSceneDesc(70,"loc70","Volcano Force Point Link"),new r.SFAMapSceneDesc(71,"loc71","LightFoot Village Link"),new r.SFAMapSceneDesc(72,"loc72","Cape Claw Link"),new r.SFAMapSceneDesc(73,"loc73","Ocean Force Point Link"),new r.SFAMapSceneDesc(74,"loc74","CloudRunner Fortress 2?"),"Full Scenes (HIGHLY EXPERIMENTAL)",new s.SFAWorldSceneDesc("hollow","swaphol",7,"ThornTail Hollow"),"Ancient Maps",new r.AncientMapSceneDesc("ancient0","Ancient Unknown Pit Room",c,0),new r.AncientMapSceneDesc("ancient1","Ancient Dragon Rock",c,1),new r.AncientMapSceneDesc("ancient2","Ancient Unknown Mine Room",c,2),new r.AncientMapSceneDesc("ancient3","Ancient ThornTail Hollow",c,3),new r.AncientMapSceneDesc("ancient4","Ancient Northern Wastes",c,4),new r.AncientMapSceneDesc("ancient5","Ancient Warlock Mountain",c,5),new r.AncientMapSceneDesc("ancient6","Ancient Shop",c,6),new r.AncientMapSceneDesc("ancient7","Ancient CloudRunner Fortress",c,7),new r.AncientMapSceneDesc("ancient8","Ancient DarkIce Mines Exterior",c,8),new r.AncientMapSceneDesc("ancient9","Ancient Ice Mountain Track 1",c,9),new r.AncientMapSceneDesc("ancient10","Ancient Ice Mountain Track 2",c,10),new r.AncientMapSceneDesc("ancient11","Ancient Ice Mountain Track 3",c,11),new r.AncientMapSceneDesc("ancient12","Ancient DarkIce Mines Interior",c,12),new r.AncientMapSceneDesc("ancient13","Ancient DarkIce Mines Boss Room",c,13),new r.AncientMapSceneDesc("ancient14","Ancient CloudRunner Fortress Race",c,14),new r.AncientMapSceneDesc("ancient15","Ancient Boss T-rex",c,15)];t.sceneGroup={id:"sfa",name:"Star Fox Adventures",sceneDescs:d}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(1),s=a(31),i=a(5),o=a(8),l=a(191),c=a(101),h=a(100);class d{constructor(e,t,a,o){this.shapeHelper=null,this.materialParams=new i.MaterialParams,this.packetParams=new i.PacketParams,this.sceneTextureSampler=null,this.pnMatrices=r.nArray(10,()=>n.mat4.create()),this.scratchMtx=n.mat4.create(),this.modelViewMtx=n.mat4.create();const l=s.compileVtxLoaderMultiVat(a,t);this.loadedVertexLayout=l.loadedVertexLayout,this.loadedVertexData=l.runVertices(e,o)}setMaterial(e){this.material=e,this.materialHelper=new i.GXMaterialHelperGfx(e.material)}setPnMatrices(e){this.pnMatrices=[];for(let t=0;t<e.length;t++)this.pnMatrices.push(n.mat4.clone(e[t]))}computeModelView(e,t,a){o.computeViewMatrix(e,t),n.mat4.mul(e,e,a)}prepareToRender(e,t,a,r,s){if(null===this.shapeHelper){const a=i.loadedDataCoalescerComboGfx(e,[this.loadedVertexData]);this.shapeHelper=new i.GXShapeHelperGfx(e,t.gfxRenderCache,a.coalescedBuffers[0],this.loadedVertexLayout,this.loadedVertexData)}this.packetParams.clear();for(let e=0;e<this.pnMatrices.length&&e<this.packetParams.u_PosMtx.length;e++)n.mat4.copy(this.packetParams.u_PosMtx[e],this.pnMatrices[e]);const o=t.newRenderInst();this.shapeHelper.setOnRenderInst(o);const l=this.materialHelper.allocateMaterialParams(o);for(let t=0;t<8;t++){const a=this.material.textures[t];null==a?this.materialParams.m_TextureMapping[t].reset():"fb-color-downscaled-8x"===a.kind||"fb-color-downscaled-2x"===a.kind?(this.materialParams.m_TextureMapping[t].gfxTexture=s.gfxTexture,null===this.sceneTextureSampler&&(this.sceneTextureSampler=e.createSampler({wrapS:0,wrapT:0,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:100})),this.materialParams.m_TextureMapping[t].gfxSampler=this.sceneTextureSampler,this.materialParams.m_TextureMapping[t].width=s.width,this.materialParams.m_TextureMapping[t].height=s.height,this.materialParams.m_TextureMapping[t].lodBias=0):"texture"===a.kind&&(this.materialParams.m_TextureMapping[t].gfxTexture=a.texture.gfxTexture,this.materialParams.m_TextureMapping[t].gfxSampler=a.texture.gfxSampler,this.materialParams.m_TextureMapping[t].width=a.texture.width,this.materialParams.m_TextureMapping[t].height=a.texture.height,this.materialParams.m_TextureMapping[t].lodBias=0)}o.setSamplerBindingsFromTextureMappings(this.materialParams.m_TextureMapping),n.mat4.mul(this.scratchMtx,this.pnMatrices[0],r),this.computeModelView(this.modelViewMtx,a.camera,this.scratchMtx),this.material.setupMaterialParams(this.materialParams,a,this.modelViewMtx),this.materialHelper.setOnRenderInst(e,t.gfxRenderCache,o),this.materialHelper.fillMaterialParamsDataOnInst(o,l,this.materialParams);for(let e=0;e<this.packetParams.u_PosMtx.length;e++)n.mat4.mul(this.scratchMtx,r,this.pnMatrices[e]),this.computeModelView(this.packetParams.u_PosMtx[e],a.camera,this.scratchMtx);this.shapeHelper.fillPacketParams(this.packetParams,o),t.submitRenderInst(o)}}function u(e,t=0){return n.vec3.fromValues(e.getFloat32(t+0),e.getFloat32(t+4),e.getFloat32(t+8))}t.ModelInstance=d;class m{constructor(e,t,a,s=!1){this.models=[],this.joints=[],this.weights=[],this.boneMatrices=[],this.invBindMatrices=[],this.yTranslate=0,this.modelTranslate=n.vec3.create(),this.scratchMtx=n.mat4.create();let i=0;const o=t.createDataView();let h;if(s)h={texOffset:84,texCount:160,posOffset:88,posCount:144,hasNormals:!1,nrmOffset:0,nrmCount:0,clrOffset:92,clrCount:148,texcoordOffset:96,texcoordCount:150,hasBones:!1,jointOffset:0,jointCount:0,shaderOffset:100,shaderCount:160,shaderFields:l.EARLY_SFA_SHADER_FIELDS,shaderSize:64,listOffset:104,listCount:159,listSize:52,numListBits:8,numLayersOffset:59,bitsOffsets:[116],bitsByteCounts:[132],oldVat:!0,hasYTranslate:!1,oldShaders:!0};else{const e=o.getUint16(4);switch(e){case 0:h={isMapBlock:!1,alwaysUseTex1:!0,texOffset:32,texCount:242,posOffset:40,posCount:228,hasNormals:!0,nrmOffset:44,nrmCount:230,clrOffset:48,clrCount:232,texcoordOffset:52,texcoordCount:234,hasBones:!0,jointOffset:60,jointCount:243,weightOffset:84,weightCount:244,shaderOffset:56,shaderCount:248,shaderFields:l.SFA_SHADER_FIELDS,listOffset:208,listCount:245,listSize:28,numListBits:8,bitsOffsets:[212],bitsByteCounts:[216],oldVat:!1,hasYTranslate:!1,oldShaders:!1};break;case 8:case 264:h={isMapBlock:!0,alwaysUseTex1:!0,texOffset:84,texCount:160,posOffset:88,posCount:144,hasNormals:!1,nrmOffset:0,nrmCount:0,clrOffset:92,clrCount:148,texcoordOffset:96,texcoordCount:150,hasBones:!1,jointOffset:0,jointCount:0,shaderOffset:100,shaderCount:162,shaderFields:l.SFA_SHADER_FIELDS,listOffset:104,listCount:161,listSize:28,numListBits:8,bitsOffsets:[120,124,128],bitsByteCounts:[132,134,136],oldVat:!1,hasYTranslate:!0,oldShaders:!1};break;default:throw Error(`Model type ${e} not implemented`)}}const m=o.getUint32(h.texOffset),p=o.getUint8(h.texCount),f=[];for(let e=0;e<p;e++){const t=o.getUint32(m+4*e);f.push(t)}const A=o.getUint32(h.posOffset),g=t.subarray(A);let _=t,S=0;if(h.hasNormals){const e=o.getUint32(h.nrmOffset);_=t.subarray(e),S=o.getUint8(36)}const b=o.getUint32(h.clrOffset),v=t.subarray(b),w=o.getUint32(h.texcoordOffset),x=t.subarray(w);let T=0;if(h.hasBones){const e=o.getUint32(h.jointOffset);T=o.getUint8(h.jointCount),this.joints=[];let t=e;for(let e=0;e<T;e++)this.joints.push({parent:o.getUint8(t),translation:u(o,t+4),worldTranslation:u(o,t+16)}),t+=28;const a=o.getUint32(h.weightOffset),r=o.getUint8(h.weightCount);this.weights=[],t=a;for(let e=0;e<r;e++){const e=.25*o.getUint8(t+2);this.weights.push({joint0:o.getUint8(t),joint1:o.getUint8(t+1),influence0:e,influence1:1-e}),t+=4}this.computeBoneMatrices();const n=o.getUint32(164);0!=n&&(console.log(`transIsPresent was 0x${n.toString(16)} in this model`),this.modelTranslate=u(o,68),console.log(`trans: ${this.modelTranslate}`))}const y=o.getUint32(h.shaderOffset),C=o.getUint8(h.shaderCount),M=[];i=y;const U=h.shaderFields;for(let e=0;e<C;e++){const e=t.subarray(i,U.size).createDataView(),a=l.parseShader(e,U);M.push(a),i+=U.size}const k=[],D=r.nArray(8,()=>[]);for(let e=0;e<=20;e++){k[e]={type:0};for(let t=0;t<8;t++)D[t][e]={compType:0,compShift:0,compCnt:0}}k[25]={type:0},D[0][9]={compType:3,compShift:0,compCnt:1},D[0][11]={compType:5,compShift:0,compCnt:1},D[0][13]={compType:3,compShift:7,compCnt:1},D[1][9]={compType:3,compShift:2,compCnt:1},D[1][11]={compType:5,compShift:0,compCnt:1},D[1][13]={compType:4,compShift:0,compCnt:1},D[2][9]={compType:4,compShift:0,compCnt:1},D[2][10]={compType:4,compShift:0,compCnt:0},D[2][11]={compType:5,compShift:0,compCnt:1},D[2][13]={compType:4,compShift:0,compCnt:1},D[2][14]={compType:4,compShift:0,compCnt:1},D[3][9]={compType:3,compShift:8,compCnt:1},D[3][10]={compType:1,compShift:0,compCnt:0},D[3][11]={compType:3,compShift:0,compCnt:1},D[3][13]={compType:3,compShift:10,compCnt:1},D[3][14]={compType:3,compShift:10,compCnt:1},D[3][15]={compType:3,compShift:10,compCnt:1},D[3][16]={compType:3,compShift:10,compCnt:1},D[4][9]={compType:4,compShift:0,compCnt:1},D[4][10]={compType:4,compShift:0,compCnt:0},D[4][11]={compType:5,compShift:0,compCnt:1},D[4][13]={compType:3,compShift:7,compCnt:1},D[5][9]={compType:3,compShift:h.oldVat?0:3,compCnt:1},D[5][10]={compType:1,compShift:0,compCnt:0},D[5][11]={compType:3,compShift:0,compCnt:1},D[5][13]={compType:3,compShift:8,compCnt:1},D[5][14]={compType:3,compShift:8,compCnt:1},D[5][15]={compType:3,compShift:8,compCnt:1},D[5][16]={compType:3,compShift:8,compCnt:1},D[6][9]={compType:3,compShift:8,compCnt:1},D[6][10]={compType:1,compShift:0,compCnt:0},D[6][11]={compType:3,compShift:0,compCnt:1},D[6][13]={compType:3,compShift:10,compCnt:1},D[6][14]={compType:3,compShift:10,compCnt:1},D[6][15]={compType:3,compShift:10,compCnt:1},D[6][16]={compType:3,compShift:10,compCnt:1},D[7][9]={compType:3,compShift:0,compCnt:1},D[7][10]={compType:1,compShift:0,compCnt:0},D[7][11]={compType:3,compShift:0,compCnt:1},D[7][13]={compType:3,compShift:10,compCnt:1},D[7][14]={compType:3,compShift:10,compCnt:1},D[7][15]={compType:3,compShift:10,compCnt:1},D[7][16]={compType:3,compShift:10,compCnt:1};const I=o.getUint32(h.listOffset),R=o.getUint8(h.listCount),B=[],P=[];for(let e=0;e<h.bitsOffsets.length;e++)B.push(o.getUint32(h.bitsOffsets[e])),P.push(o.getUint16(h.bitsByteCounts[e]));let E=0;h.hasBones&&(E=o.getUint8(250)),h.hasYTranslate?this.yTranslate=o.getInt16(142):this.yTranslate=0,this.computeBoneMatrices();const F=r.nArray(16,()=>n.mat4.create()),V=this;function O(r,n){const s=[];if(V.models[n]=s,0===r)return;const u=new c.LowBitReader(o,r);let m=!1,p=M[0];for(;!m;){const r=u.get(4);switch(r){case 1:p=M[u.get(6)];break;case 2:const n=u.get(h.numListBits);if(n>=R){console.warn(`Can't draw display list #${n} (out of range)`);continue}i=I+n*h.listSize;const c=o.getUint32(i),A=o.getUint16(i+4),b=t.subarray(c,A),w=[];w[9]={buffer:g,offs:0,stride:6},h.hasNormals&&(w[10]={buffer:_,offs:0,stride:0!=(8&S)?9:3}),w[11]={buffer:v,offs:0,stride:2};for(let e=0;e<8;e++)w[13+e]={buffer:x,offs:0,stride:4};try{if(0!=(p.flags&l.ShaderFlags.DevGeometry));else{const t=new d(w,k,D,b),r=l.buildMaterialFromShader(e,p,a,f,h.alwaysUseTex1,h.isMapBlock);t.setMaterial(r),t.setPnMatrices(F),s.push(t)}}catch(e){console.warn("Failed to create model and shader instance due to exception:"),console.error(e)}break;case 3:k[0].type=0;for(let e=0;e<8;e++)k[1+e].type=0;if(h.hasBones&&T>=2){k[0].type=1;let e=0;(p.hasAuxTex0||p.hasAuxTex1)&&(4294967295!==p.auxTexNum&&(k[1+e].type=1,e++,k[1+e].type=1,e++),k[1+e].type=1,e++),e=7;for(let t=0;t<E;t++)k[1+e].type=1,e--}const y=u.get(1);if(k[9].type=y?3:2,h.hasNormals&&0!=(1&p.attrFlags)){const e=u.get(1);k[10].type=e?3:2}else k[10].type=0;if(0!=(2&p.attrFlags)){const e=u.get(1);k[11].type=e?3:2}else k[11].type=0;const C=u.get(1);if(p.layers.length>0)for(let e=0;e<8;e++)e<p.layers.length?k[13+e].type=C?3:2:k[13+e].type=0;break;case 4:const U=u.get(4);if(U>V.boneMatrices.length)for(let e=0;e<U;e++)u.get(8);else{V.computeBoneMatrices();for(let e=0;e<U;e++){const t=u.get(8);F[e]=V.boneMatrices[t]}}break;case 5:m=!0;break;default:console.warn(`Skipping unknown model bits opcode ${r}`)}}}O(B[0],0);for(let e=1;e<B.length;e++)O(B[e],e)}computeBoneMatrices(){this.boneMatrices=[],this.invBindMatrices=[];for(let e=0;e<this.joints.length;e++){const t=this.joints[e];let a=n.mat4.create();if(255!=t.parent){if(t.parent>=e)throw Error("Bad joint hierarchy in model");a=this.boneMatrices[t.parent]}else a=n.mat4.create();const r=n.mat4.create();n.mat4.fromTranslation(r,t.worldTranslation);const s=n.mat4.create();n.mat4.invert(s,r),this.invBindMatrices.push(s);const i=n.mat4.create();n.mat4.fromTranslation(i,t.translation),n.mat4.mul(i,i,a),this.boneMatrices.push(i)}for(let e=0;e<this.weights.length;e++){const t=this.weights[e],a=this.invBindMatrices[t.joint0],r=this.invBindMatrices[t.joint1],s=n.mat4.clone(this.boneMatrices[t.joint0]);n.mat4.mul(s,s,a);const i=n.mat4.clone(this.boneMatrices[t.joint1]);n.mat4.mul(i,i,r),n.mat4.multiplyScalar(s,s,t.influence0),n.mat4.multiplyScalar(i,i,t.influence1),n.mat4.add(s,s,i),this.boneMatrices.push(s)}}getNumDrawSteps(){return this.models.length}prepareToRender(e,t,a,r,s,i){if(i<0||i>=this.models.length)return;const o=this.models[i];for(let i=0;i<o.length;i++)n.mat4.fromTranslation(this.scratchMtx,[0,this.yTranslate,0]),n.mat4.translate(this.scratchMtx,this.scratchMtx,this.modelTranslate),n.mat4.mul(this.scratchMtx,r,this.scratchMtx),o[i].prepareToRender(e,t,a,this.scratchMtx,s)}}t.Model=m;t.ModelCollection=class{constructor(e,t){this.texColl=e,this.gameInfo=t,this.models=[]}async create(e,t){const a=this.gameInfo.pathBase,[r,n]=await Promise.all([e.fetchData(`${a}/${t}/MODELS.tab`),e.fetchData(`${a}/${t}/MODELS.bin`)]);this.modelsTab=r.createDataView(),this.modelsBin=n}loadModel(e,t){if(void 0===this.models[t]){console.log(`Loading model #${t} ...`);const a=this.modelsTab.getUint32(4*t);if(0===a)throw Error(`Model #${t} not found`);const r=16777215&a,n=h.loadRes(this.modelsBin.subarray(r+36));this.models[t]=new m(e,n,this.texColl)}return this.models[t]}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getChannelFormat=function(e){return e>>>8},t.getTypeFormat=function(e){return 255&e}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=a(0),i=r(a(102)),o=a(4),l=a(8),c=a(2);function h(e,t){const a=.5*t[2],r=.5*t[1],n=.5*t[0],s=Math.sin(a),i=Math.cos(a),o=Math.sin(r),l=Math.cos(r),c=Math.sin(n),h=Math.cos(n);e[0]=h*o*i+c*l*s,e[1]=c*l*i-h*o*s,e[2]=h*l*s-c*o*i,e[3]=h*l*i+c*o*s}t.stringHash=function(e){let t=0;for(let a=0;a<e.length;a++){let r=e.charCodeAt(a);r-=r&r>>>1&32,t=r+131*t}return t},t.quatFromYPR=h;const d=n.vec3.create();function u(e,t,a){e[0]=c.clamp(a[0],t.minX,t.maxX),e[1]=c.clamp(a[1],t.minY,t.maxY),e[2]=c.clamp(a[2],t.minZ,t.maxZ)}t.aabbClosestPoint=u,t.computeViewSpaceDepthFromWorldSpaceAABBClosestPoint=function(e,t,a=d){return n.mat4.getTranslation(a,e.worldMatrix),u(a,t,a),l.computeViewSpaceDepthFromWorldSpacePoint(e,a)};const m=n.quat.create();t.mat4FromYPR=function(e,t){h(m,t),n.mat4.fromQuat(e,m)};class p{constructor(e,t=!0){this.buffer=e,this.littleEndian=t,this.offset=0,this.view=e.createDataView()}readUInt8(){const e=this.view.getUint8(this.offset);return this.offset+=1,e}readUInt16(){const e=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readUInt32(){const e=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readInt8(){const e=this.view.getInt8(this.offset);return this.offset+=1,e}readInt16(){const e=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat(){const e=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readString(e=1/0){let t="";for(let a=0;a<e;a++){const e=this.view.getUint8(this.offset++);if(0===e)break;t+=String.fromCharCode(e)}return t}readVec3(){const e=this.readFloat(),t=this.readFloat(),a=this.readFloat();return n.vec3.fromValues(e,t,a)}readRwMatrix(){const e=this.readVec3(),t=this.readFloat(),a=this.readVec3(),r=this.readFloat(),s=this.readVec3(),i=this.readFloat(),o=this.readVec3(),l=this.readFloat();return n.vec3.normalize(e,e),n.vec3.normalize(a,a),n.vec3.normalize(s,s),n.mat4.fromValues(e[0],e[1],e[2],t,a[0],a[1],a[2],r,s[0],s[1],s[2],i,o[0],o[1],o[2],l)}readColor(){const e=this.readFloat(),t=this.readFloat(),a=this.readFloat(),r=this.readFloat();return o.colorNewFromRGBA(e,t,a,r)}readColor8(){const e=this.readUInt8()/255,t=this.readUInt8()/255,a=this.readUInt8()/255,r=this.readUInt8()/255;return o.colorNewFromRGBA(e,t,a,r)}align(e){this.offset=s.align(this.offset,e)}eof(){return this.offset>=this.view.byteLength}get length(){return this.view.byteLength}get bytesLeft(){return this.length-this.offset}}t.DataStream=p;function f(e){const t=function(e){return{type:e.readUInt32(),length:e.readUInt32(),libraryID:e.readUInt32()}}(e),a=e.offset+t.length,r=e.buffer.slice(e.offset,a),n=[];if(function(e){switch(e){case i.PluginID.ID_STRUCT:case i.PluginID.ID_STRING:case i.PluginID.ID_RIGHTTORENDER:return!1;default:return!(256&e)}}(t.type))for(;e.offset<a;)n.push(f(e));else e.offset=a;return{header:t,data:r,children:n}}t.DataCacheIDName=class{constructor(){this.nameToDataMap=new Map,this.idToDataMap=new Map,this.nameToLockMap=new Map,this.idToLockMap=new Map}get count(){return this.idToDataMap.size}add(e,t,a,r=!1){this.idToLockMap.get(a)||(this.nameToDataMap.set(t,e),this.idToDataMap.set(a,e),this.nameToLockMap.set(t,r),this.idToLockMap.set(a,r))}getByName(e){return this.nameToDataMap.get(e)}getByID(e){return this.idToDataMap.get(e)}ids(){return this.idToDataMap.keys()}names(){return this.nameToDataMap.keys()}data(){return this.idToDataMap.values()}isIDLocked(e){return this.idToLockMap.get(e)||!1}isNameLocked(e){return this.nameToLockMap.get(e)||!1}removeByName(e,t=!1){!t&&this.isNameLocked(e)||(this.nameToDataMap.delete(e),this.nameToLockMap.delete(e))}removeByID(e,t=!1){!t&&this.isIDLocked(e)||(this.idToDataMap.delete(e),this.idToLockMap.delete(e))}clear(e=!1){for(const[t]of this.idToDataMap)this.removeByID(t,e);for(const[t]of this.nameToDataMap)this.removeByName(t,e)}},t.parseRWChunks=function(e){const t=[],a=new p(e,!0);for(;!a.eof();)t.push(f(a));return t},t.createRWStreamFromChunk=function(e){return new i.StreamMemory(e.data.createTypedArray(Uint8Array))},t.parseRWAtomic=function(e){const t=new p(e.data,!0);return{frameIndex:t.readInt32(),geomIndex:t.readInt32(),flags:t.readInt32(),unused:t.readInt32()}},t.parseRWClump=function(e){const t=new p(e.data,!0);return{numAtomics:t.readInt32(),numLights:t.readInt32(),numCameras:t.readInt32()}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(69),n=a(10),s=a(9),i=a(7),o=a(33),l=a(0),c=a(55);class h{constructor(e,t){this.textureHolder=t,this.renderTarget=new s.BasicRenderTarget,this.renderInstManager=new i.GfxRenderInstManager,this.mdl0Renderers=[],this.uniformBuffer=new o.GfxRenderDynamicUniformBuffer(e)}prepareToRender(e,t,a){this.renderInstManager.pushTemplateRenderInst().setUniformBuffer(this.uniformBuffer);for(let e=0;e<this.mdl0Renderers.length;e++)this.mdl0Renderers[e].prepareToRender(this.renderInstManager,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a);const r=this.renderInstManager;this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,s.standardFullClearRenderPassDescriptor);return r.drawOnPassRenderer(e,n),r.resetRenderInsts(),n}destroy(e){this.renderInstManager.destroy(e),this.renderTarget.destroy(e),this.uniformBuffer.destroy(e);for(let t=0;t<this.mdl0Renderers.length;t++)this.mdl0Renderers[t].destroy(e)}}t.createBasicNSBMDRendererFromNSBMD=function(e,t){const a=new n.FakeTextureHolder([]),s=new h(e,a),i=c.parseNSBMD(t);for(let t=0;t<i.models.length;t++){const t=i.models[0],n=new r.MDL0Renderer(e,t,l.assertExists(i.tex0));for(let e=0;e<n.viewerTextures.length;e++)a.viewerTextures.push(n.viewerTextures[e]);s.mdl0Renderers.push(n)}return s}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t){this.object=e,this.lastUsedAge=t}}t.DataShare=class{constructor(){this.objects=new Map,this.currentAge=0}loadNewScene(){this.currentAge++}deleteObjectsOlderThan(e,t){for(const[a,r]of this.objects.entries())r.lastUsedAge<=t&&(r.object.destroy(e),this.objects.delete(a))}pruneOldObjects(e,t){const a=this.currentAge-t;this.deleteObjectsOlderThan(e,a)}setObject(e,t){const a=new r(t,this.currentAge);this.objects.set(e,a)}getObject(e){if(this.objects.has(e)){const t=this.objects.get(e);return t.lastUsedAge=this.currentAge,t.object}return null}async ensureObject(e,t){let a=this.getObject(e);return null===a&&(a=await t(),this.setObject(e,a)),a}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(15)),i=a(0),o=n(a(58)),l=a(1);function c(e){const t=new Uint8Array(16*e.length);for(let a=0;a<e.length;a++)t[16*a+0]=o.F3DEX_GBI.G_SETOTHERMODE_L,t[16*a+2]=3,t[16*a+3]=29,t[16*a+4]=e[a]>>>24&255,t[16*a+5]=e[a]>>>16&255,t[16*a+6]=e[a]>>>8&255,t[16*a+7]=e[a]>>>0&255,t[16*a+8]=o.F3DEX_GBI.G_ENDDL;return new s.default(t.buffer)}const h=[c([252329984,202973256,202916416,202916296,202916416,202916296,252329984,202973256,202916416,202916296,202916416,202916296,202916808]),c([252330032,202973304,202916464,202916344,202916464,202916344,25233e4,202973272,202916432,202916312,202916432,202916312,202916824]),c([25233e4,202973272,202916432,202916312,202916432,202916312,25233e4,202973272,202916432,202916312,202916432,202916312,202916824]),c([].concat(...i.nArray(6,()=>[202916416,202916296])).concat([202916808])),c([202916464,202916344,202916464,202916344,202916464,202916344,202916432,202916312,202916432,202916312,202916432,202916312,202916824]),c([].concat(...i.nArray(6,()=>[202916432,202916312])).concat([202916824]))];function d(e,t=0,a=-1){const r=new o.RSPState(e.segmentBuffers,e.sharedOutput);r.gDPSetOtherModeH(12,2,8192),r.gDPSetOtherModeH(20,2,1<<20),p(r);const n={boneIndex:t,parentIndex:a,children:[],rspOutput:null,rspState:r,nodeData:null};return e.nodeStack.length>0&&e.nodeStack[0].children.push(n),e.nodeStack.unshift(n),n}function u(e){return i.assertExists(e.nodeStack[0])}function m(e){const t=e.nodeStack.shift();return t.rspOutput=t.rspState.finish(),t}function p(e){e.gDPSetTile(0,2,8,0,2,0,0,5,0,0,5,0),e.gDPSetTileSize(2,0,0,124,124),e.gDPSetTile(0,2,8,256,3,0,0,4,0,0,4,0),e.gDPSetTileSize(3,0,0,60,60),e.gDPSetTile(0,2,8,260,4,0,0,3,0,0,3,0),e.gDPSetTileSize(4,0,0,28,28),e.gDPSetTile(0,2,8,262,5,0,0,2,0,0,2,0),e.gDPSetTileSize(5,0,0,12,12),e.gDPSetTile(0,2,8,263,6,0,0,1,0,0,1,0),e.gDPSetTileSize(6,0,0,4,4)}function f(e,t){const a=u(e);o.runDL_F3DEX(a.rspState,t)}function A(e){if(3===e.type)e.xPhase=Math.random();else if(7===e.type){const t=(e.bbMax[1]+e.bbMin[1])/2;for(let a=0;a<e.baseVertexValues.length;a++)e.baseVertexValues[a].y=t}else 9===e.type&&(e.blinker={currBlink:0,strength:0,count:0,duration:1,timer:0})}t.isSelector=function(e){return null!==e&&"select"===e.kind},t.isSorter=function(e){return null!==e&&"sort"===e.kind},t.parse=function(e,t,a){const r=e.createDataView();i.assert(11==r.getUint32(0));const n=r.getUint32(4),s=r.getUint16(10),c=r.getUint32(12),g=r.getUint32(c+0),_=e.subarray(c+8,8*g),S=r.getUint32(24);let b=null;if(0!==S){const e=r.getFloat32(S+0),t=r.getUint16(S+4);let a=S+8;const n=[];for(let e=0;e<t;e++){const t=r.getFloat32(a+0),s=r.getFloat32(a+4),i=r.getFloat32(a+8),o=e,c=r.getUint16(a+12),h=r.getInt16(a+14),d=l.vec3.fromValues(t,s,i);n.push({boneIndex:o,parentIndex:h,boneAnimID:c,offset:d}),a+=16}b={translationScale:e,bones:n}}const v=r.getUint32(40);let w=null;if(0!==v){i.assert(null!==b);const t=[],a=r.getUint16(v);let n=v+4;for(let s=0;s<a;s++){const a=r.getInt16(n+0),s=r.getInt16(n+2),i=r.getInt16(n+4),o=l.vec3.fromValues(a,s,i),c=r.getInt8(n+6),h=r.getUint8(n+7);if(n+=8,-1!==c){const a=e.createTypedArray(Uint16Array,n,h,1);t.push({position:o,boneID:c,vertexIDs:a})}n+=2*h}w={vertexBoneEntries:t}}const x=r.getUint32(16),T=r.getUint16(50),y=(r.getUint16(x+22),e.subarray(x+24,16*T)),C=r.getUint16(8),M=r.getUint32(C+0),U=C+8+16*r.getUint8(C+5),k=e.slice(U,C+M),D=t+(a?0:3),I=[];I[1]=y,I[2]=k,I[3]=h[D],I[9]=_,I[15]=k;const R=new o.RSPSharedOutput;R.setVertexBufferFromData(y.createDataView());const B=[],P={buffer:e,segmentBuffers:I,sharedOutput:R,modelPoints:B,nodeStack:[],buildSortNodes:2===t},E=d(P,0);!function e(t,a){const r=t.buffer.createDataView();for(;;){const n=a,s=r.getUint32(n+0),o=r.getUint32(n+4);if(window.debug){const e=r.getUint32(n+4);console.log(i.hexzero(n,4),i.hexzero(s,2),i.hexzero(e,8))}if(0===s){const a=r.getUint16(n+8);0!==a&&e(t,n+a)}else if(1===s){r.getUint16(n+32);const a=r.getUint16(n+34),s=r.getUint32(n+36);if(t.buildSortNodes&&0!==a&&0!==s){const i=u(t),o=d(t,i.boneIndex,i.parentIndex),c=l.vec3.fromValues(r.getFloat32(n+8),r.getFloat32(n+12),r.getFloat32(n+16)),h=l.vec3.fromValues(r.getFloat32(n+20),r.getFloat32(n+24),r.getFloat32(n+28));l.vec3.sub(h,h,c),o.nodeData={kind:"sort",point:c,normal:h},d(t,i.boneIndex,i.parentIndex),e(t,n+a),m(t),d(t,i.boneIndex,i.parentIndex),e(t,n+s),m(t),m(t)}else 0!==a&&e(t,n+a),0!==s&&e(t,n+s)}else if(2===s){d(t,r.getInt8(n+9),u(t).boneIndex),e(t,n+r.getUint8(n+8)),m(t)}else if(3===s){const e=r.getUint16(n+8);r.getUint16(n+10);f(t,150994944+8*e)}else if(5===s){const e=u(t);e.rspState.gSPResetMatrixStackDepth(1),f(t,150994944+8*r.getUint16(n+8));let a=10;for(;;){e.rspState.gSPResetMatrixStackDepth(0);const s=r.getUint16(n+a);if(0===s)break;f(t,150994944+8*s),a+=2}}else if(8===s){0===r.getFloat32(n+12)&&e(t,n+r.getUint32(n+28))}else if(10===s){const e=r.getInt16(n+8),a=r.getInt16(n+10),s=r.getFloat32(n+12),i=r.getFloat32(n+16),o=r.getFloat32(n+20);t.modelPoints[e]={boneID:a,offset:l.vec3.fromValues(s,i,o)}}else if(12===s){const a=r.getUint16(n+8),s=r.getUint16(n+10),i=u(t);d(t,i.boneIndex,i.parentIndex);const o=n+12;for(let l=0;l<a;l++){const a=n+r.getUint32(o+4*l);d(t,i.boneIndex,i.parentIndex).nodeData={kind:"select",stateIndex:s},e(t,a),m(t)}m(t)}else if(13===s){const a=r.getUint16(n+20);0!==a&&e(t,n+a)}else if(14===s){r.getInt16(n+18);e(t,n+r.getUint16(n+16))}else if(15===s)e(t,n+r.getUint16(n+8));else{if(16!==s)throw`whoops ${s}`;r.getInt32(n+8);p(u(t).rspState)}if(0===o)return;a+=o}}(P,n);const F=m(P);i.assert(E===F);let V=null;const O=r.getInt32(44);if(O>0){let e=O;const t=r.getUint16(e+0),a=r.getUint16(e+2),n=r.getFloat32(e+4),s=[],o=R.textureCache.textures.length;for(let e=0;e<o;e++){const r=R.textureCache.textures[e];let n=r.dramAddr,i=r.dramPalAddr;const o=r.dramAddr>>>24==15,l=0!==r.dramPalAddr&&r.dramPalAddr>>>24==15;if(!o&&!l)continue;const c=[e];for(let e=1;e<a;e++)o&&(n+=t),l&&(i+=t),c.push(R.textureCache.translateTileTexture(I,n,i,r.tile));s.push(c)}const l=r.getUint16(e+8);i.assert(0===l),V={blockCount:a,speed:n,indexLists:s}}const N=r.getUint32(36),L=[];if(N>0){const e=r.getUint16(N);let t=N+2;for(let a=0;a<e;a++){const e=r.getUint16(t+0),a=Math.floor(e/100),n=e%100,s=r.getUint16(t+2);if(t+=4,e<=100||4===a||6===a){t+=2*s;continue}const o=[],c=[];for(let e=0;e<s;e++){const e=r.getUint16(t);o.push(e),c.push(R.vertices[e]),t+=2}const h={type:a,subID:n,vertexIndices:o,baseVertexValues:c,xPhase:0,yPhase:0,dy:0,dtx:0,dty:0,colorFactor:1};if(7===a){const e=l.vec3.create(),t=l.vec3.fromValues(c[0].x,c[0].y,c[0].z),a=l.vec3.clone(t);for(let r=0;r<c.length;r++)l.vec3.set(e,c[r].x,c[r].y,c[r].z),l.vec3.min(t,t,e),l.vec3.max(a,a,e);h.bbMin=t,h.bbMax=a}if(10===a){for(let e=0;e<L.length;e++)9===L[e].type&&L[e].subID===n&&(h.pairedEffect=L[e]);i.assert(!!h.pairedEffect)}A(h),L.push(h)}}return{geoFlags:s,animationSetup:b,vertexBoneTable:w,vertexEffects:L,textureAnimationSetup:V,rootNode:E,sharedOutput:R,modelPoints:B}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(77),n=a(1),s=a(0),i=a(2),o=a(30),l=a(137),c=a(7);class h extends r.GeometryRenderer{constructor(e,t,a){super(e,t),this.index=a}}t.ClankerTooth=h;const d=n.vec3.create();class u extends r.GeometryRenderer{constructor(){super(...arguments),this.boltState=0}movement(){let e=this.animationController.getTimeInSeconds();n.vec3.copy(d,this.clankerVector);let t=this.boltState;switch(this.boltState){case 0:e>=2&&Math.hypot(d[0]-u.peak[0],d[2]-u.peak[2])<=60&&(t=1);break;case 1:e>=1&&(t=2);break;case 2:e>=1&&(t=3);break;case 3:e>=1&&(t=0)}switch(this.boltState!==t&&(this.boltState=t,e=0,this.animationController.resetPhase()),this.boltState){case 0:break;case 1:n.vec3.lerp(d,d,u.peak,Math.sin(e*Math.PI/2));break;case 2:n.vec3.copy(d,u.peak);break;case 3:n.vec3.lerp(d,d,u.peak,Math.cos(e*Math.PI/2))}n.mat4.fromTranslation(this.modelMatrix,d)}}t.ClankerBolt=u,u.peak=n.vec3.fromValues(2640,5695,-10);class m extends r.GeometryRenderer{constructor(e,t,a,r,n=0,s=19){super(e,t),this.turnRate=n;for(let e=0;e<4;e++){const t=new l.Sparkler(r,s);t.movementController=new z(this.modelPointArray,e+5),a.flipbookManager.emitters.push(t)}}movement(e){n.mat4.rotateY(this.modelMatrix,this.modelMatrix,e.deltaTime/1e3*this.turnRate*.01745)}}class p extends r.GeometryRenderer{constructor(e,t,a){super(e,t);const r=new l.ConfigurableEmitter(l.brentildaWandConfig);r.movementController=new z(this.modelPointArray,31),a.flipbookManager.emitters.push(r)}}class f extends r.GeometryRenderer{constructor(e,t,a){super(e,t),this.center=n.vec3.create(),this.emitters=[],this.emitters.push(new l.JumpPadEmitter(l.nearJumpPadConfig),new l.JumpPadEmitter(l.farJumpPadConfig)),a.flipbookManager.emitters.push(...this.emitters)}movement(e){0===this.center[0]&&0===this.center[2]&&n.mat4.getTranslation(this.center,this.modelMatrix);const t=1.30875*this.animationController.getTimeInSeconds();this.modelMatrix[12]=this.center[0]+590*Math.cos(t),this.modelMatrix[14]=this.center[2]-590*Math.sin(t);const a=t-.1745;this.emitters[0].modelMatrix[12]=this.center[0]+590*Math.cos(a),this.emitters[0].modelMatrix[14]=this.center[2]-590*Math.sin(a),n.mat4.copy(this.emitters[1].modelMatrix,this.emitters[0].modelMatrix)}}const A=n.vec3.fromValues(-220,210,-220),g=n.vec3.fromValues(220,460,220),_=s.nArray(2,()=>n.vec3.create());class S extends r.GeometryRenderer{constructor(){super(...arguments),this.movementController=new K(800),this.timer=-1,this.sortKeyBase=c.makeSortKey(132)}init(e){this.timer=.8,n.mat4.getTranslation(_[0],e);for(let e=0;e<3;e++)_[0][e]+=l.randomRange(20);l.fromBB(_[1],A,g),this.movementController.setFromVel(_[0],_[1]),n.vec2.set(this.movementController.angularVel,l.randomRange(5.235),l.randomRange(5.235)),this.movementController.scale=l.randomRange(.65,1.1),this.setEnvironmentAlpha(1)}movement(e){super.movement(e),this.timer<.4&&this.setEnvironmentAlpha(this.timer/.4),this.timer-=e.deltaTime/1e3}}t.SnowballChunk=S;const b=n.vec3.create();class v extends r.GeometryRenderer{constructor(e,t,a){super(e,t),this.target=n.vec3.create(),this.state=0,this.movementController=new K(1800),this.sparkleEmitter=new l.StreamEmitter(30,1),this.chunkEmitter=new l.SnowballChunkEmitter,this.die(),a.flipbookManager.emitters.push(this.sparkleEmitter),this.sparkleEmitter.movementController=new z(this.modelPointArray,5),a.snowballChunkManager.emitters.push(this.chunkEmitter)}static computeTarget(e,t){n.vec3.set(e,0,-30,-60),n.vec3.transformMat4(e,e,t)}init(e,t){this.sparkleEmitter.active=!0,this.state=1,n.mat4.fromTranslation(this.modelMatrix,e),v.computeTarget(this.target,t),this.animationController.resetPhase()}movement(e){const t=this.animationController.getTimeInSeconds();t<1/30||(1===this.state&&(this.state=2,v.computeTarget(b,e.camera.worldMatrix),n.vec3.sub(this.target,b,this.target),n.vec3.scaleAndAdd(this.target,b,this.target,Math.random()>.5?21:43),n.mat4.getTranslation(b,this.modelMatrix),this.movementController.setFromTarget(b,this.target,32/30),n.vec2.set(this.movementController.angularVel,5.235,5.235)),super.movement(e),t<.2||(t>6||this.modelMatrix[13]<-1e3?this.die():(n.mat4.getTranslation(b,this.modelMatrix),n.vec3.transformMat4(b,b,e.camera.viewMatrix),n.vec3.len(b)<100&&(v.computeTarget(b,e.camera.worldMatrix),n.mat4.fromTranslation(this.chunkEmitter.modelMatrix,b),this.chunkEmitter.emitCount=8,this.die()))))}die(){this.state=0,this.sparkleEmitter.active=!1}}function w(e,t,a){t>a?t=a:t<-a&&(t=-a),n.mat4.rotateY(e,e,t)}t.Snowball=v;const x=s.nArray(2,()=>n.vec3.create());class T extends r.GeometryRenderer{constructor(e,t){super(e,t),this.throwTimer=0,this.currAnimation=0,this.animationMode=2}additionalSetup(e,t,a=0){this.snowball=e(293)[0]}movement(e){n.mat4.getTranslation(x[0],this.modelMatrix),n.mat4.getTranslation(x[1],e.camera.worldMatrix),n.vec3.sub(x[0],x[1],x[0]);const t=x[0],a=n.vec3.len(t),r=Math.atan2(t[0],t[2]),o=Math.atan2(this.modelMatrix[8],this.modelMatrix[10]);let l=i.angleDist(o,r);const c=Math.PI*e.deltaTime/1e3,h=a>500&&a<2750&&t[1]<1500;switch(this.currAnimation){case 0:this.selectorState.values[1]=0,this.throwTimer>0?this.throwTimer-=e.deltaTime/1e3:h&&Math.abs(l)<.15705&&0===this.snowball.state&&this.changeAnimation(1,1),a<3150&&w(this.modelMatrix,l,c);break;case 1:if(this.getAnimationPhase()>.98||!h)return this.changeAnimation(0,2),void(this.throwTimer=.4);this.getAnimationPhase()<.45&&w(this.modelMatrix,l,c),this.animationPhaseTrigger(.45)&&(this.selectorState.values[1]=1),this.animationPhaseTrigger(.58)&&(this.selectorState.values[1]=0,n.vec3.copy(x[0],s.assertExists(this.modelPointArray[5])),this.snowball.init(x[0],e.camera.worldMatrix))}}prepareToRender(e,t,a){super.prepareToRender(e,t,a),0!==this.snowball.state&&this.snowball.prepareToRender(e,t,a)}}t.SirSlush=T;class y{constructor(e){this.time=e,this.facePlayer=!1,this.yawUpdate=0,this.pitchUpdate=0,this.animMode=0,this.speedSign=0,this.timeToEnd=0,this.waitTime=0,this.waitIndex=0,this.distToEnd=0}}function C(e){return"kind"in e&&"keyframe"===e.kind}function M(e){return!("kind"in e)}function U(e,t){for(let a=0;a<e.keyframes.length;a++)if(t<=e.keyframes[a].time)return a;return e.keyframes.length}t.buildKeyframeData=function(e,t){const a=e.getFloat32(t+0);if(!!(1&e.getUint32(t+12)))return{kind:"camera",time:a};const r=e.getUint16(t+4)>>>4,n=15&e.getUint16(t+4),s=e.getUint16(t+6)>>>7,i=e.getUint16(t+6)>>4&7,o=e.getUint16(t+6)>>1&7,l=(e.getUint32(t+8),e.getUint32(t+8),7&e.getUint8(t+10)),c=e.getUint16(t+12)>>>7,h=e.getUint32(t+12)>>>12&2047,d=e.getUint32(t+12)>>>1&2047,u=e.getUint8(t+19)>>>4,m={time:a,pairIndex:r,keyPitch:s,keySpeed:h,keyYaw:c,useAngle:!!(1&n),useSpeed:!!(2&n)},p=new y(a);switch(1&l&&(2&u?p.waitIndex=(d-105)%15:p.waitTime=d/4),2&l&&(p.timeToEnd=h/4),i){case 1:p.facePlayer=!0,p.yawUpdate=2,p.pitchUpdate=2;break;case 2:p.yawUpdate=1;break;case 3:p.yawUpdate=2;break;case 4:p.pitchUpdate=1;break;case 5:p.pitchUpdate=2;break;case 6:p.yawUpdate=1,p.pitchUpdate=1;break;case 7:p.yawUpdate=2,p.pitchUpdate=2}switch(o){case 2:p.speedSign=1,p.animMode=1;break;case 3:p.speedSign=-1,p.animMode=1;break;case 4:p.speedSign=1,p.animMode=2;break;case 5:p.speedSign=-1,p.animMode=2}return{kind:"keyframe",keyframe:p,lerpEndpoint:m}},t.buildRails=function(e){const t=[],a=new Set,r=new Set;for(let t=0;t<e.length;t++){const r=e[t];void 0!==r&&(r.next>e.length?r.next=0:a.add(r.next))}for(let s=1;s<=e.length;s++){if(a.has(s))continue;const i=e[s];if(void 0===i)continue;if(0===i.next||!M(i.data))continue;const o=[i.data],l=[],c=[],h=[];let d=i.next;for(r.clear();0!==d;){const t=e[d];if(void 0===t){console.warn("bad next node index",d);break}if(C(t.data)?(l.push(t.data.keyframe),c.push(t.data.lerpEndpoint)):M(t.data)&&o.push(t.data),r.has(d))break;r.add(d),d=t.next}l.sort((e,t)=>e.time-t.time);for(let t=0;t<c.length;t++){const a=c[t];if(0===a.pairIndex)continue;const r=e[a.pairIndex];if(void 0===r){console.warn("missing lerp start index",a.pairIndex);continue}if(!C(r.data)){console.warn("lerp from non keyframe");continue}const n=r.data.lerpEndpoint,s={range:[n.time,a.time]};a.useAngle&&(s.yaw=[n.keyYaw,a.keyYaw],s.pitch=[n.keyPitch,a.keyPitch]),a.useSpeed&&(s.speed=[n.keySpeed,a.keySpeed]),h.push(s)}let u=0,m=1;for(let e=l.length-1;e>=0;e--)u+=D(o,l[e].time,m),l[e].distToEnd=u,m=l[e].time;let p=1;const f=o[o.length-1];for(let e=0;e<o.length-1;e++)if(n.vec3.exactEquals(o[e],f)){p=e/(o.length-1);break}t.push({points:o,keyframes:l,loopStart:p,lerps:h})}return t};const k=s.nArray(2,()=>n.vec3.create());function D(e,t,a){let r=0,s=1;for(E(k[0],e,t);t<a;)E(k[s],e,t),r+=n.vec3.dist(k[1-s],k[s]),s=1-s,t+=1e-4;return r}function I(e,t,a,r){if(E(e,t.points,a),0===r)return a;let s=r>0?.01:-.01;for(r=Math.abs(r);Math.abs(s)>1e-7;){let i=0,o=a+s;t.loopStart<1&&s>0&&o>=1||s<0&&o<t.loopStart?(o+=(t.loopStart-1)*(s>0?1:-1),E(k[0],t.points,o),n.vec3.copy(k[1],t.points[t.points.length-1]),i=n.vec3.dist(e,k[1])+n.vec3.dist(k[1],k[0])):(1===t.loopStart&&(o>1?o=1:o<0&&(o=0)),E(k[0],t.points,o),i=n.vec3.dist(e,k[0]));const l=Math.abs(r-i)<.1;if(i<r||l){if(a=o,r-=i,n.vec3.copy(e,k[0]),l)return a;if(1===t.loopStart){if(s>0&&1===o)return 1;if(s<0&&0===o)return 0}}else s/=2}return a}const R=n.vec3.create(),B=n.vec3.create(),P=s.nArray(4,()=>R);function E(e,t,a){if(a>=1)return void n.vec3.copy(e,t[t.length-1]);if(a<=0)return void n.vec3.copy(e,t[0]);if(t.length<4)return P[0]=t[0],P[1]=t[0],P[2]=t[1],P[3]=2===t.length?t[1]:t[2],void E(e,P,a);const r=(t.length-1)*a,s=r>>>0,i=t[s],l=t[s+1];s>0?n.vec3.sub(R,l,t[s-1]):n.vec3.sub(R,l,i),s+2<t.length?n.vec3.sub(B,t[s+2],i):n.vec3.sub(B,l,i),n.vec3.scale(R,R,.5),n.vec3.scale(B,B,.5);for(let t=0;t<3;t++)e[t]=o.getPointHermite(i[t],l[t],R[t],B[t],r%1)}const F=s.nArray(2,()=>n.vec3.create());const V=n.vec3.create();class O extends r.GeometryRenderer{constructor(e,t){super(e,t),this.waitTimer=0,this.moveTimer=0,this.rail=null,this.speed=100,this.facePlayer=!1,this.railYaw=!0,this.railPitch=!0}setRail(e){n.mat4.getTranslation(V,this.modelMatrix);for(let t=0;t<e.length;t++){for(let a=0;a<e[t].points.length;a++)if(n.vec3.exactEquals(V,e[t].points[a])){this.rail=e[t],this.moveTimer=a/(e[t].points.length-1);break}if(null!==this.rail)break}}applyKeyframe(e){this.facePlayer=e.facePlayer,2===e.pitchUpdate?this.railPitch=!1:1===e.pitchUpdate&&(this.railPitch=!0),2===e.yawUpdate?this.railYaw=!1:1===e.yawUpdate&&(this.railYaw=!0),0!==e.animMode&&(this.animationMode=e.animMode),this.waitTimer=e.waitTime,e.waitIndex>0&&(this.waitTimer=1/30),0!==e.speedSign&&(this.speed=e.speedSign*Math.abs(this.speed)),e.timeToEnd>0&&(this.speed=e.distToEnd/e.timeToEnd)}movement(e){const t=e.deltaTime/1e3;if(null===this.rail)return;if(this.waitTimer>0)return void(this.waitTimer=Math.max(this.waitTimer-t,0));const a=U(this.rail,this.moveTimer);this.moveTimer=I(V,this.rail,this.moveTimer,this.speed*t),n.mat4.fromTranslation(this.modelMatrix,V);const r=U(this.rail,this.moveTimer);if(a!==r){const e=this.rail.keyframes.length;let t=1,n=a,s=r;for(this.speed<0&&(t=-1,n--,s--);n!==s;)n<0?n=e-1:n>=e&&(n=0),this.applyKeyframe(this.rail.keyframes[n]),n+=t}this.facePlayer?console.warn("face player for object"):(!function(e,t,a){E(F[0],t.points,a);const r=a+1e-4>=1?a-1e-4:a;I(F[1],t,r,5);const s=F[0];n.vec3.sub(s,F[1],F[0]),e[0]=-Math.atan2(s[1],Math.hypot(s[0],s[2])),e[1]=Math.atan2(s[0],s[2]),e[2]=0}(V,this.rail,this.moveTimer),this.railYaw&&n.mat4.rotateY(this.modelMatrix,this.modelMatrix,V[1]),this.railPitch&&n.mat4.rotateX(this.modelMatrix,this.modelMatrix,V[0]))}}t.RailRider=O;class N extends O{constructor(e,t,a){super(e,t),this.bubbler=new l.Emitter(4),this.bubbler.movementController=new z(this.modelPointArray,5),a.flipbookManager.emitters.push(this.bubbler)}movement(e){super.movement(e);let t=0,a=2;this.waitTimer>0&&(t=1,a=1),1===t&&this.animationPhaseTrigger(.6)&&(this.bubbler.emitCount=1),t!==this.currAnimation&&this.changeAnimation(t,a)}}function L(e,t,a,r){const n=e/r;return i.lerp(a,t,Math.abs(n%2-1))}class G extends O{constructor(e,t,a){super(e,t),this.currAnimation=0,this.animationMode=2,this.blinkTimer=0,this.emitter=new l.StreamEmitter(30,2),this.emitter.movementController=new z(this.modelPointArray,6),a.flipbookManager.emitters.push(this.emitter)}applyKeyframe(e){super.applyKeyframe(e),this.railPitch=!1}movement(e){let t=1;switch(this.currAnimation){case 0:this.emitter.active=!0,super.movement(e),this.waitTimer>0&&this.changeAnimation(1,0);break;case 1:this.emitter.active=!1,t=L(this.blinkTimer,1,0,.1),this.blinkTimer>=1.5&&(this.blinkTimer=0,this.changeAnimation(2,0)),this.blinkTimer+=e.deltaTime/1e3;break;case 2:super.movement(e),t=0,0===this.waitTimer&&this.changeAnimation(3,0);break;case 3:t=L(this.blinkTimer,0,1,.1),this.blinkTimer>=1.5&&(this.blinkTimer=0,this.changeAnimation(0,2)),this.blinkTimer+=e.deltaTime/1e3}this.setEnvironmentAlpha(t)}}const H=s.nArray(2,()=>n.vec3.create());class j extends r.GeometryRenderer{constructor(e,t,a){super(e,t),this.movementController=new K(j.g),this.timer=-1,this.explode=!1,this.flameEmitter=new l.ConfigurableEmitter(l.lavaRockLaunchFlameConfig),this.bigTrail=new l.ConfigurableEmitter(l.lavaRockBigTrailConfig),this.smallTrail=new l.ConfigurableEmitter(l.lavaRockSmallTrailConfig),this.smokeEmitter=new l.ConfigurableEmitter(l.lavaRockSmokeConfig),this.explosionEmitter=new l.MultiEmitter(l.lavaRockExplosionConfig,[l.fireballIndex,l.lavaSmokeIndex]),this.lavaSparkleEmitter=new l.MultiEmitter(l.lavaRockShardsConfig,[20,21]),this.sparkleEmitter=new l.MultiEmitter(l.lavaRockShardsConfig,[17,18]),a.flipbookManager.emitters.push(this.flameEmitter,this.bigTrail,this.smallTrail,this.smokeEmitter,this.explosionEmitter,this.lavaSparkleEmitter,this.sparkleEmitter),this.flameEmitter.active=!1,this.smokeEmitter.active=!1,this.explosionEmitter.active=!1,this.lavaSparkleEmitter.active=!1,this.sparkleEmitter.active=!1,this.bigTrail.active=!1,this.smallTrail.active=!1}reset(e,t,a){this.parent=e,this.animationController.resetPhase(),n.mat4.getTranslation(H[0],e.modelMatrix),n.mat4.getTranslation(H[1],t);const r=i.lerp(1400,a?1200:1800,Math.random());this.timer=Math.sqrt(2*r/j.g)+Math.sqrt(2*(r+H[0][1]-H[1][1])/j.g),this.movementController.setFromTarget(H[0],H[1],this.timer),n.vec2.set(this.movementController.angularVel,240*l.randomRange(1,2)*.01745,240*-l.randomRange(1,2)*.01745),this.movementController.scale=l.randomRange(a?.8:.2,a?1:.6),this.explode=!a&&Math.random()>.5,a?this.bigTrail.active=!0:this.smallTrail.active=!0,this.flameEmitter.emitCount=3,this.flameEmitter.modelMatrix[12]=e.modelMatrix[12],this.flameEmitter.modelMatrix[13]=e.modelMatrix[13]+100,this.flameEmitter.modelMatrix[14]=e.modelMatrix[14]}movement(e){if(super.movement(e),l.emitAt(this.bigTrail,this.modelMatrix,0),l.emitAt(this.smallTrail,this.modelMatrix,0),this.movementController.reachedPeak&&this.explode)return l.emitAt(this.explosionEmitter,this.modelMatrix,2),l.emitAt(this.sparkleEmitter,this.modelMatrix,4),l.emitAt(this.smokeEmitter,this.modelMatrix,4),void this.die();this.timer-=e.deltaTime/1e3,this.timer<0&&(l.emitAt(this.lavaSparkleEmitter,this.modelMatrix,4),l.emitAt(this.smokeEmitter,this.modelMatrix,4),this.flameEmitter.emitCount=3,this.flameEmitter.modelMatrix[12]=this.modelMatrix[12],this.flameEmitter.modelMatrix[13]=this.modelMatrix[13]+100,this.flameEmitter.modelMatrix[14]=this.modelMatrix[14],this.die())}die(){this.timer=-1,this.parent.ready=!0,this.bigTrail.active=!1,this.smallTrail.active=!1}}t.LavaRock=j,j.g=1e3,t.clankerID=65537,t.createRenderer=function(e,t,a,n){switch(a){case 67:return new u(e,n);case 68:return new h(e,n,7);case 69:return new h(e,n,9);case 70:return new m(e,n,t,.015,230);case 71:case 80:return new m(e,n,t,.03,Math.random()>.5?200:-200);case 472:return new m(e,n,t,1/60,0,17);case 473:return new m(e,n,t,1/60,0,21);case 474:return new m(e,n,t,1/60);case 230:return new N(e,n,t);case 241:return new O(e,n);case 291:return new G(e,n,t);case 292:return new T(e,n);case 293:return new v(e,n,t);case 585:return new f(e,n,t);case 840:return new p(e,n,t);case 955:return new j(e,n,t)}return new r.GeometryRenderer(e,n)};const W=n.vec3.create();class Z{constructor(e){this.amplitudes=s.nArray(3,()=>0),this.speed=80+20*Math.random(),this.basePos=n.vec3.create(),this.baseYaw=0,this.baseRoll=0,this.baseScale=1,n.mat4.getTranslation(this.basePos,e.modelMatrix),n.mat4.getScaling(W,e.modelMatrix),this.baseScale=W[0],this.baseRoll=Math.atan2(e.modelMatrix[1],e.modelMatrix[5]),this.baseYaw=-Math.atan2(e.modelMatrix[2],e.modelMatrix[0])}movement(e,t){const a=t*this.speed*.01745;n.mat4.fromYRotation(e,this.baseYaw+Math.sin(a)*this.amplitudes[0]),n.mat4.rotateX(e,e,Math.cos(a)*this.amplitudes[1]),n.mat4.rotateZ(e,e,this.baseRoll),1!==this.baseScale&&(n.vec3.set(W,this.baseScale,this.baseScale,this.baseScale),n.mat4.scale(e,e,W)),e[12]=this.basePos[0],e[13]=this.basePos[1]+Math.sin(a)*this.amplitudes[2],e[14]=this.basePos[2]}}t.SinkingBobber=class extends Z{constructor(e){super(e),this.amplitudes[0]=.0349,this.amplitudes[1]=.078525,this.amplitudes[2]=10}};t.WaterBobber=class extends Z{constructor(e){super(e),this.amplitudes[0]=.05235,this.amplitudes[1]=.130875,this.amplitudes[2]=20}};class z{constructor(e,t){this.modelVector=s.assertExists(e[t])}movement(e,t){n.mat4.fromTranslation(e,this.modelVector)}}t.ModelPin=z;class K{constructor(e=1e3){this.g=e,this.start=n.vec3.create(),this.startVel=n.vec3.create(),this.angularVel=n.vec2.create(),this.startTime=-1,this.scale=1,this.reachedPeak=!1}setFromVel(e,t){this.startTime=-1,n.vec3.copy(this.start,e),n.vec3.copy(this.startVel,t)}setFromTarget(e,t,a){this.startTime=-1,n.vec3.copy(this.start,e),n.vec3.sub(this.startVel,t,e),n.vec3.scale(this.startVel,this.startVel,1/a),this.startVel[1]+=this.g*a/2}movement(e,t){this.startTime<0&&(this.startTime=t);const a=t-this.startTime;n.vec3.copy(W,this.start),n.vec3.scaleAndAdd(W,W,this.startVel,a),W[1]-=this.g*a*a/2,n.mat4.fromTranslation(e,W),n.mat4.rotateY(e,e,this.angularVel[0]*a),n.mat4.rotateX(e,e,this.angularVel[1]*a),1!==this.scale&&(n.vec3.set(W,this.scale,this.scale,this.scale),n.mat4.scale(e,e,W)),this.reachedPeak=a*this.g>=this.startVel[1]}}t.Projectile=K},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(15)),i=a(0),o=a(1),l=n(a(59)),c=a(36),h=a(31),d=a(16),u=a(31),m=a(5),p=a(5),f=a(10),A=a(7),g=a(4),_=a(61),S=a(91);function b(e){e.ropInfo.fogType=2,e.ropInfo.fogAdjEnabled=!0,e.hasFogBlock=!0;const t=new p.GXMaterialHelperGfx(e);return m.setChanWriteEnabled(t,8,!1),t}function v(e){const t=e.createTypedArray(Uint32Array,0,e.byteLength/4,1),a=[];for(let e=0;255!==t[e+0];e+=4){const r=t[e+0],n=t[e+1],s=t[e+2],i=t[e+3];a[r]={compCnt:n,compShift:i,compType:s}}return a}function w(e){const t=e.createTypedArray(Uint32Array,0,e.byteLength/4,1),a=[];for(let e=0;255!==t[e+0];e+=2){const r=t[e+0],n=t[e+1];a[r]={type:n}}return a}function x(e,t,a){const r=e.bp[l.BPRegister.TX_SETIMAGE0_I0_ID],n=1+(r>>>0&1023),s=1+(r>>>10&1023),i=r>>>20&15,o=e.bp[l.BPRegister.TX_SETMODE0_I0_ID],c=o>>>0&3,h=o>>>2&3,d=o>>>4&1,u=[0,2,4,0,1,3,5][o>>>5&7],m=o>>>9&5,p=e.bp[l.BPRegister.TX_SETMODE1_I0_ID],f=p>>>0&15,A=p>>>8&15;return console.assert(0===f),console.assert(0===m,"Non-zero LOD bias. This is untested"),{name:a,width:n,height:s,format:i,data:t,mipCount:1+A-f,paletteFormat:1,paletteData:null,wrapS:c,wrapT:h,minFilter:u,magFilter:d,minLOD:f,maxLOD:A,lodBias:m}}const T=o.vec3.create(),y=o.vec3.create(),C=o.vec3.create(),M=o.vec3.create(),U=o.mat4.create(),k=new m.PacketParams,D=new m.MaterialParams,I=Math.PI/32767;function R(e){return e*I}t.uShortTo2PI=R;const B=new S.cBgS_GndChk;function P(e,t,a){B.Reset(),o.vec3.copy(B.pos,a),B.pos[1]+=50;const r=e.scnPlay.bgS.GroundCross(B);return r>-1/0?r:a[1]}function E(e,t,a){g.colorCopy(t.u_Color[m.ColorKind.C0],e.roomStatus[a].tevStr.colorC0),g.colorCopy(t.u_Color[m.ColorKind.C1],e.roomStatus[a].tevStr.colorK0)}var F,V;!function(e){e[e.WHITE=0]="WHITE",e[e.PINK=1]="PINK",e[e.BESSOU=2]="BESSOU"}(F||(F={})),function(e){e[e.isFrustumCulled=1]="isFrustumCulled",e[e.needsGroundCheck=2]="needsGroundCheck"}(V||(V={}));class O{constructor(e){this.pinkTextureMapping=i.nArray(1,()=>new f.TextureMapping),this.whiteTextureMapping=i.nArray(1,()=>new f.TextureMapping),this.bessouTextureMapping=i.nArray(1,()=>new f.TextureMapping);const t=e.modelCache.device,a=e.renderer.renderCache,r=e.findExtraSymbolData("d_flower.o","l_matDL"),n=e.findExtraSymbolData("d_flower.o","l_matDL2"),s=e.findExtraSymbolData("d_flower.o","l_matDL3"),o=e.findExtraSymbolData("d_flower.o","l_Txo_ob_flower_pink_64x64TEX"),l=e.findExtraSymbolData("d_flower.o","l_Txo_ob_flower_white_64x64TEX"),A=e.findExtraSymbolData("d_flower.o","l_Txq_bessou_hanaTEX"),g=new u.DisplayListRegisters;u.displayListRegistersInitGX(g),u.displayListRegistersRun(g,r),this.whiteMaterial=b(d.parseMaterial(g,"l_matDL"));const _=x(g,l,"l_Txo_ob_flower_white_64x64TEX");this.whiteTextureData=new c.BTIData(t,a,_),this.whiteTextureData.fillTextureMapping(this.whiteTextureMapping[0]),u.displayListRegistersRun(g,n),this.pinkMaterial=b(d.parseMaterial(g,"l_matDL2"));const S=x(g,o,"l_Txo_ob_flower_pink_64x64TEX");this.pinkTextureData=new c.BTIData(t,a,S),this.pinkTextureData.fillTextureMapping(this.pinkTextureMapping[0]),u.displayListRegistersRun(g,s),this.bessouMaterial=b(d.parseMaterial(g,"l_matDL3"));const v=x(g,A,"l_Txq_bessou_hanaTEX");this.bessouTextureData=new c.BTIData(t,a,v),this.bessouTextureData.fillTextureMapping(this.bessouTextureMapping[0]);const w=e.findExtraSymbolData("d_flower.o","l_pos"),T=e.findExtraSymbolData("d_flower.o","l_color"),y=e.findExtraSymbolData("d_flower.o","l_texCoord"),C=e.findExtraSymbolData("d_flower.o","l_pos2"),M=e.findExtraSymbolData("d_flower.o","l_color2"),U=e.findExtraSymbolData("d_flower.o","l_texCoord2"),k=e.findExtraSymbolData("d_flower.o","l_pos3"),D=e.findExtraSymbolData("d_flower.o","l_color3"),I=e.findExtraSymbolData("d_flower.o","l_texCoord3"),R=e.findExtraSymbolData("d_flower.o","l_Ohana_highDL"),B=e.findExtraSymbolData("d_flower.o","l_Ohana_high_gutDL"),P=e.findExtraSymbolData("d_flower.o","l_OhanaDL"),E=e.findExtraSymbolData("d_flower.o","l_Ohana_gutDL"),F=e.findExtraSymbolData("d_flower.o","l_QbsafDL"),V=e.findExtraSymbolData("d_flower.o","l_QbsfwDL"),O=[];O[9]={compCnt:1,compShift:0,compType:4},O[13]={compCnt:1,compShift:0,compType:4},O[11]={compCnt:1,compShift:0,compType:5};const N=[];N[9]={type:2},N[11]={type:2},N[13]={type:2};const L=h.compileVtxLoader(O,N),G=[],H=(e,t,a,r)=>(G[9]={buffer:e,offs:0,stride:h.getAttributeByteSize(O,9)},G[11]={buffer:t,offs:0,stride:h.getAttributeByteSize(O,11)},G[13]={buffer:a,offs:0,stride:h.getAttributeByteSize(O,13)},L.runVertices(G,r)),j=H(w,T,y,P),W=H(w,T,y,E),Z=H(C,M,U,R),z=H(C,M,U,B),K=H(k,D,I,V),X=H(k,D,I,F);this.bufferCoalescer=m.loadedDataCoalescerComboGfx(t,[j,W,Z,z,K,X]),this.shapeWhiteUncut=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[0],L.loadedVertexLayout,j),this.shapeWhiteCut=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[1],L.loadedVertexLayout,W),this.shapePinkUncut=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[2],L.loadedVertexLayout,Z),this.shapePinkCut=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[3],L.loadedVertexLayout,z),this.shapeBessouUncut=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[4],L.loadedVertexLayout,K),this.shapeBessouCut=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[5],L.loadedVertexLayout,X)}destroy(e){this.bufferCoalescer.destroy(e),this.shapeWhiteUncut.destroy(e),this.shapeWhiteCut.destroy(e),this.shapePinkUncut.destroy(e),this.shapePinkCut.destroy(e),this.shapeBessouUncut.destroy(e),this.shapeBessouCut.destroy(e),this.whiteTextureData.destroy(e),this.pinkTextureData.destroy(e),this.bessouTextureData.destroy(e)}}function N(e,t){return o.vec3.squaredDistance(e,t)>=4e8}t.FlowerPacket=class{constructor(e){this.rooms=i.nArray(64,()=>[]),this.anims=new Array(8),this.flowerModel=new O(e);const t=2*Math.PI/8;for(let e=0;e<8;e++)this.anims[e]={active:!0,rotationX:0,rotationY:e*t,matrix:o.mat4.create()}}newData(e,t,a,r,n){const s=Math.floor(8*Math.random());let i=a?F.PINK:F.WHITE;"sea"===e.stageName&&33===r&&a&&(i=F.BESSOU);const l={flags:V.needsGroundCheck,type:i,animIdx:s,itemIdx:n,particleLifetime:0,pos:o.vec3.clone(t),modelMatrix:o.mat4.create()};return this.rooms[r].push(l),l}calc(e){for(let t=0;t<8;t++){const a=Math.cos(R(1e3*(e+250*t)));this.anims[t].rotationX=R(1e3+1e3*a)}}update(e){let t=0;for(let e=0;e<8;e++)o.mat4.fromYRotation(this.anims[e].matrix,this.anims[e].rotationY),o.mat4.rotateX(this.anims[e].matrix,this.anims[e].matrix,this.anims[e].rotationX),o.mat4.rotateY(this.anims[e].matrix,this.anims[e].matrix,-this.anims[e].rotationY);for(let a=0;a<this.rooms.length;a++){const r=this.rooms[a];for(let a=0;a<r.length;a++){const n=r[a];n.flags&V.needsGroundCheck&&t<8&&(n.pos[1]=P(e,0,n.pos),n.flags&=~V.needsGroundCheck,++t),n.flags&V.isFrustumCulled||o.mat4.mul(n.modelMatrix,o.mat4.fromTranslation(U,n.pos),this.anims[n.animIdx].matrix)}}}drawRoom(e,t,a,r,n){const s=this.rooms[t];if(0===s.length)return;let i;const l=r.camera.viewMatrix,c=o.mat4.getTranslation(y,r.camera.worldMatrix);i=a.pushTemplateRenderInst();{i.setSamplerBindingsFromTextureMappings(this.flowerModel.whiteTextureMapping);const h=this.flowerModel.whiteMaterial.allocateMaterialParams(i);E(e,D,t),_.dKy_GxFog_set(e.g_env_light,D.u_FogBlock,r.camera),this.flowerModel.whiteMaterial.fillMaterialParamsDataOnInst(i,h,D),this.flowerModel.whiteMaterial.setOnRenderInst(n,a.gfxRenderCache,i);for(let e=0;e<s.length;e++){const t=s[e];if(t.flags&V.isFrustumCulled||t.type!==F.WHITE)continue;if(N(c,t.pos))continue;const r=a.newRenderInst();this.flowerModel.shapeWhiteUncut.setOnRenderInst(r),o.mat4.mul(k.u_PosMtx[0],l,t.modelMatrix),this.flowerModel.shapeWhiteUncut.fillPacketParams(k,r),a.submitRenderInst(r)}}a.popTemplateRenderInst(),i=a.pushTemplateRenderInst();{i.setSamplerBindingsFromTextureMappings(this.flowerModel.pinkTextureMapping);const h=this.flowerModel.pinkMaterial.allocateMaterialParams(i);E(e,D,t),_.dKy_GxFog_set(e.g_env_light,D.u_FogBlock,r.camera),this.flowerModel.pinkMaterial.fillMaterialParamsDataOnInst(i,h,D),this.flowerModel.pinkMaterial.setOnRenderInst(n,a.gfxRenderCache,i);for(let e=0;e<s.length;e++){const t=s[e];if(t.flags&V.isFrustumCulled||t.type!==F.PINK)continue;if(N(c,t.pos))continue;const r=a.newRenderInst();this.flowerModel.shapePinkUncut.setOnRenderInst(r),o.mat4.mul(k.u_PosMtx[0],l,t.modelMatrix),this.flowerModel.shapePinkUncut.fillPacketParams(k,r),a.submitRenderInst(r)}}a.popTemplateRenderInst(),i=a.pushTemplateRenderInst();{i.setSamplerBindingsFromTextureMappings(this.flowerModel.bessouTextureMapping);const h=this.flowerModel.bessouMaterial.allocateMaterialParams(i);E(e,D,t),_.dKy_GxFog_set(e.g_env_light,D.u_FogBlock,r.camera),this.flowerModel.bessouMaterial.fillMaterialParamsDataOnInst(i,h,D),this.flowerModel.bessouMaterial.setOnRenderInst(n,a.gfxRenderCache,i);for(let e=0;e<s.length;e++){const t=s[e];if(t.flags&V.isFrustumCulled||t.type!==F.BESSOU)continue;if(N(c,t.pos))continue;const r=a.newRenderInst();this.flowerModel.shapeBessouUncut.setOnRenderInst(r),o.mat4.mul(k.u_PosMtx[0],l,t.modelMatrix),this.flowerModel.shapeBessouUncut.fillPacketParams(k,r),a.submitRenderInst(r)}}a.popTemplateRenderInst()}draw(e,t,a){const r=e.modelCache.device;for(let n=0;n<this.rooms.length;n++)this.drawRoom(e,n,t,a,r)}destroy(e){this.flowerModel.destroy(e)}};class L{constructor(e){this.shadowTextureMapping=i.nArray(1,()=>new f.TextureMapping),this.woodTextureMapping=i.nArray(1,()=>new f.TextureMapping);const t=e.modelCache.device,a=e.renderer.renderCache,r=e.findExtraSymbolData("d_tree.o","l_matDL"),n=e.findExtraSymbolData("d_tree.o","l_pos"),o=e.findExtraSymbolData("d_tree.o","l_color"),l=e.findExtraSymbolData("d_tree.o","l_texCoord"),A=e.findExtraSymbolData("d_tree.o","l_vtxAttrFmtList$4670"),g=e.findExtraSymbolData("d_tree.o","l_vtxDescList$4669"),_=e.findExtraSymbolData("d_tree.o","l_shadowVtxDescList$4654"),S=e.findExtraSymbolData("d_tree.o","l_shadowVtxAttrFmtList$4655"),T=e.findExtraSymbolData("d_tree.o","g_dTree_shadowPos"),y=e.findExtraSymbolData("d_tree.o","g_dTree_shadowMatDL"),C=new s.default(new Uint8Array([0,0,1,0,1,1,0,1]).buffer),M=(e.findExtraSymbolData("d_tree.o","l_Oba_swood_noneDL"),e.findExtraSymbolData("d_tree.o","l_Oba_swood_a_cuttDL"),e.findExtraSymbolData("d_tree.o","l_Oba_swood_a_cutuDL"),e.findExtraSymbolData("d_tree.o","l_Oba_swood_a_hapaDL")),U=e.findExtraSymbolData("d_tree.o","l_Oba_swood_a_mikiDL"),k=e.findExtraSymbolData("d_tree.o","g_dTree_Oba_kage_32DL"),D=e.findExtraSymbolData("d_tree.o","l_Txa_kage_32TEX"),I=e.findExtraSymbolData("d_tree.o","l_Txa_swood_aTEX"),R=new u.DisplayListRegisters;u.displayListRegistersInitGX(R),u.displayListRegistersRun(R,r),this.woodMaterial=b(d.parseMaterial(R,"d_tree::l_matDL"));const B=x(R,I,"l_Txa_swood_aTEX");this.woodTextureData=new c.BTIData(t,a,B),this.woodTextureData.fillTextureMapping(this.woodTextureMapping[0]),u.displayListRegistersInitGX(R),u.displayListRegistersRun(R,y);const P=d.parseMaterial(R,"d_tree::l_shadowMatDL");this.shadowMaterial=b(P);const E=x(R,D,"l_Txa_kage_32TEX");this.shadowTextureData=new c.BTIData(t,a,E),this.shadowTextureData.fillTextureMapping(this.shadowTextureMapping[0]);const F=v(S),V=w(_),O=h.compileVtxLoader(F,V),N=[];N[9]={buffer:T,offs:0,stride:h.getAttributeByteSize(F,9)},N[13]={buffer:C,offs:0,stride:h.getAttributeByteSize(F,13)};const L=O.runVertices(N,k),G=v(A),H=w(g),j=h.compileVtxLoader(G,H),W=[];W[9]={buffer:n,offs:0,stride:h.getAttributeByteSize(G,9)},W[11]={buffer:o,offs:0,stride:h.getAttributeByteSize(G,11)},W[13]={buffer:l,offs:0,stride:h.getAttributeByteSize(G,13)};const Z=j.runVertices(W,M),z=j.runVertices(W,U);this.bufferCoalescer=m.loadedDataCoalescerComboGfx(t,[L,Z,z]),this.shapeTop=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[1],j.loadedVertexLayout,Z),this.shapeMain=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[2],j.loadedVertexLayout,z),this.shapeShadow=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[0],O.loadedVertexLayout,L)}destroy(e){this.bufferCoalescer.destroy(e),this.shapeMain.destroy(e),this.shapeTop.destroy(e),this.shapeShadow.destroy(e),this.woodTextureData.destroy(e),this.shadowTextureData.destroy(e)}}t.TreePacket=class{constructor(e){this.rooms=i.nArray(64,()=>[]),this.anims=new Array(8),this.treeModel=new L(e);const t=2*Math.PI/8;for(let e=0;e<8;e++)this.anims[e]={active:!0,initialRotationShort:8192*e,topRotationY:e*t,topRotationX:0,trunkRotationX:0,trunkFallYaw:0,offset:o.vec3.create(),topMtx:o.mat4.create(),trunkMtx:o.mat4.create()}}checkGroundY(e,t,a){B.Reset(),o.vec3.copy(B.pos,a.pos),B.pos[1]+=50;const r=e.scnPlay.bgS.GroundCross(B);r>-1/0?(a.pos[1]=r,e.scnPlay.bgS.GetTriPla(B.polyInfo.bgIdx,B.polyInfo.triIdx).getNormal(T)):(a.pos[1]=r,o.vec3.set(T,0,1,0));const n=T,s=o.vec3.set(C,1,0,0),i=o.vec3.cross(M,n,s);return o.vec3.cross(s,n,i),a.shadowModelMtx[0]=s[0],a.shadowModelMtx[1]=s[1],a.shadowModelMtx[2]=s[2],a.shadowModelMtx[3]=a.pos[0],a.shadowModelMtx[4]=n[0],a.shadowModelMtx[5]=n[1],a.shadowModelMtx[6]=n[2],a.shadowModelMtx[7]=1+r,a.shadowModelMtx[8]=i[0],a.shadowModelMtx[9]=i[1],a.shadowModelMtx[10]=i[2],a.shadowModelMtx[11]=a.pos[2],o.mat4.transpose(a.shadowModelMtx,a.shadowModelMtx),r}newData(e,t,a){const r={flags:2,animIdx:Math.floor(8*Math.random()),status:t,trunkAlpha:255,pos:o.vec3.clone(e),unkMatrix:o.mat4.create(),topModelMtx:o.mat4.create(),trunkModelMtx:o.mat4.create(),shadowModelMtx:o.mat4.create()};return this.rooms[a].push(r),r}calc(e){for(let t=0;t<8;t++){let a=Math.cos(R(4e3*(e+250*t)));this.anims[t].topRotationY=R(100+this.anims[t].initialRotationShort+100*a),a=Math.cos(R(1e3*(e+250*t))),this.anims[t].topRotationX=R(100+100*a)}}updateRoom(e,t,a){const r=this.rooms[t];for(let n=0;n<r.length;n++){const s=r[n];if(a>=8)break;if(2&s.flags&&(s.pos[1]=this.checkGroundY(e,t,s),s.flags&=-3,++a),!(1&s.flags)){const e=this.anims[s.animIdx];if(0==(8&s.flags)){const t=o.vec3.add(T,s.pos,e.offset);o.mat4.mul(s.topModelMtx,o.mat4.fromTranslation(U,t),e.topMtx)}else o.mat4.copy(s.topModelMtx,s.unkMatrix);o.mat4.mul(s.trunkModelMtx,o.mat4.fromTranslation(U,s.pos),e.trunkMtx)}}return a}update(e){for(let e=0;e<8;e++){const t=this.anims[e];o.mat4.fromYRotation(t.topMtx,t.trunkFallYaw),o.mat4.rotateX(t.topMtx,t.topMtx,t.topRotationX),o.mat4.rotateY(t.topMtx,t.topMtx,t.topRotationY-t.trunkFallYaw),o.mat4.fromYRotation(t.trunkMtx,t.trunkFallYaw),o.mat4.rotateX(t.trunkMtx,t.trunkMtx,t.trunkRotationX),o.mat4.rotateY(t.trunkMtx,t.trunkMtx,R(t.initialRotationShort)-t.trunkFallYaw)}let t=0;t=this.updateRoom(e,e.mStayNo,t);for(let a=0;a<this.rooms.length&&!(t>8);a++)a!==e.mStayNo&&(t=this.updateRoom(e,a,t))}drawRoom(e,t,a,r,n){const s=this.rooms[t];if(0===s.length)return;let i;const l=r.camera.viewMatrix,c=o.mat4.getTranslation(y,r.camera.worldMatrix);i=a.pushTemplateRenderInst();{i.sortKey=A.makeSortKey(128);const h=this.treeModel.woodMaterial.allocateMaterialParams(i);E(e,D,t),_.dKy_GxFog_set(e.g_env_light,D.u_FogBlock,r.camera),g.colorFromRGBA(D.u_Color[m.ColorKind.C0],0,0,0,100/255),this.treeModel.shadowMaterial.fillMaterialParamsDataOnInst(i,h,D),this.treeModel.shadowMaterial.setOnRenderInst(n,a.gfxRenderCache,i),i.setSamplerBindingsFromTextureMappings(this.treeModel.shadowTextureMapping);for(let e=0;e<s.length;e++){const t=s[e];if(N(c,t.pos))continue;const r=a.newRenderInst();this.treeModel.shapeShadow.setOnRenderInst(r),o.mat4.mul(k.u_PosMtx[0],l,t.shadowModelMtx),this.treeModel.shapeShadow.fillPacketParams(k,r),a.submitRenderInst(r)}}a.popTemplateRenderInst(),i=a.pushTemplateRenderInst();{const h=this.treeModel.woodMaterial.allocateMaterialParams(i);E(e,D,t),_.dKy_GxFog_set(e.g_env_light,D.u_FogBlock,r.camera),g.colorFromRGBA(D.u_Color[m.ColorKind.C2],0,0,0,1),this.treeModel.woodMaterial.fillMaterialParamsDataOnInst(i,h,D),this.treeModel.woodMaterial.setOnRenderInst(n,a.gfxRenderCache,i),i.setSamplerBindingsFromTextureMappings(this.treeModel.woodTextureMapping);for(let e=0;e<s.length;e++){const t=s[e];if(1&t.flags)continue;if(N(c,t.pos))continue;const r=a.newRenderInst();this.treeModel.shapeMain.setOnRenderInst(r),o.mat4.mul(k.u_PosMtx[0],l,t.trunkModelMtx),this.treeModel.shapeMain.fillPacketParams(k,r),a.submitRenderInst(r);const n=a.newRenderInst();this.treeModel.shapeTop.setOnRenderInst(n),o.mat4.mul(k.u_PosMtx[0],l,t.topModelMtx),this.treeModel.shapeTop.fillPacketParams(k,n),a.submitRenderInst(n)}}a.popTemplateRenderInst()}draw(e,t,a){const r=e.modelCache.device;for(let n=0;n<this.rooms.length;n++)this.drawRoom(e,n,t,a,r)}destroy(e){this.treeModel.destroy(e)}};class G{constructor(e){this.grassTextureMapping=new f.TextureMapping,this.vmoriTextureMapping=new f.TextureMapping;const t=e.modelCache.device,a=e.renderer.renderCache,r=e.findExtraSymbolData("d_grass.o","l_matDL"),n=e.findExtraSymbolData("d_grass.o","l_vtxAttrFmtList$4529"),s=e.findExtraSymbolData("d_grass.o","l_vtxDescList$4528"),i=e.findExtraSymbolData("d_grass.o","l_pos"),o=e.findExtraSymbolData("d_grass.o","l_color"),l=e.findExtraSymbolData("d_grass.o","l_texCoord"),A=(e.findExtraSymbolData("d_grass.o","l_Oba_kusa_a_cutDL"),e.findExtraSymbolData("d_grass.o","l_Oba_kusa_aDL")),g=e.findExtraSymbolData("d_grass.o","l_Vmori_00DL"),_=(e.findExtraSymbolData("d_grass.o","l_Vmori_01DL"),e.findExtraSymbolData("d_grass.o","l_Vmori_color")),S=e.findExtraSymbolData("d_grass.o","l_Vmori_pos"),T=e.findExtraSymbolData("d_grass.o","l_Vmori_texCoord"),y=e.findExtraSymbolData("d_grass.o","l_Vmori_matDL"),C=e.findExtraSymbolData("d_grass.o","l_K_kusa_00TEX"),M=e.findExtraSymbolData("d_grass.o","l_Txa_ob_kusa_aTEX"),U=new u.DisplayListRegisters;u.displayListRegistersInitGX(U),u.displayListRegistersRun(U,r),this.grassMaterial=b(d.parseMaterial(U,"d_grass::l_matDL"));const k=x(U,M,"l_Txa_ob_kusa_aTEX");this.grassTextureData=new c.BTIData(t,a,k),this.grassTextureData.fillTextureMapping(this.grassTextureMapping),u.displayListRegistersRun(U,y),this.vmoriMaterial=b(d.parseMaterial(U,"d_grass::l_Vmori_matDL"));const D=x(U,C,"l_K_kusa_00TEX");this.vmoriTextureData=new c.BTIData(t,a,D),this.vmoriTextureData.fillTextureMapping(this.vmoriTextureMapping);const I=v(n),R=w(s),B=h.compileVtxLoader(I,R),P=[],E=(e,t,a,r)=>(P[9]={buffer:e,offs:0,stride:h.getAttributeByteSize(I,9)},P[11]={buffer:t,offs:0,stride:h.getAttributeByteSize(I,11)},P[13]={buffer:a,offs:0,stride:h.getAttributeByteSize(I,13)},B.runVertices(P,r)),F=E(i,o,l,A),V=E(S,_,T,g);this.bufferCoalescer=m.loadedDataCoalescerComboGfx(t,[F,V]),this.shapeMain=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[0],B.loadedVertexLayout,F),this.shapeVmori=new p.GXShapeHelperGfx(t,a,this.bufferCoalescer.coalescedBuffers[1],B.loadedVertexLayout,F)}destroy(e){this.bufferCoalescer.destroy(e),this.shapeMain.destroy(e),this.shapeVmori.destroy(e),this.grassTextureData.destroy(e),this.vmoriTextureData.destroy(e)}}t.GrassPacket=class{constructor(e){this.rooms=i.nArray(64,()=>[]),this.anims=new Array(8),this.textureMapping=i.nArray(1,()=>new f.TextureMapping),this.model=new G(e),e.stageName.startsWith("kin")||"Xboss1"===e.stageName?(this.material=this.model.vmoriMaterial,this.textureMapping[0].copy(this.model.vmoriTextureMapping),this.shape=this.model.shapeVmori):(this.material=this.model.grassMaterial,this.textureMapping[0].copy(this.model.grassTextureMapping),this.shape=this.model.shapeMain);for(let e=0;e<8;e++)this.anims[e]={active:!0,rotationY:R(8192*e),rotationX:0,modelMtx:o.mat4.create()}}newData(e,t,a){const r={flags:2,animIdx:Math.floor(8*Math.random()),itemIdx:a,pos:o.vec3.clone(e),modelMtx:o.mat4.create()};return this.rooms[t].push(r),r}calc(e){const t=Math.min(1e3,2e3);for(let a=0;a<8;a++){let r=Math.cos(R(t*(e+250*a)));this.anims[a].rotationX=R(t+t*r)}}updateRoom(e,t,a){const r=this.rooms[t];for(let t=0;t<r.length;t++){const n=r[t];if(a>=8)break;if(2&n.flags&&(n.pos[1]=P(e,0,n.pos),n.flags&=-3,++a),!(1&n.flags))if(n.animIdx<0);else{const e=this.anims[n.animIdx];o.mat4.mul(n.modelMtx,o.mat4.fromTranslation(U,n.pos),e.modelMtx)}}return a}update(e){for(let e=0;e<8;e++){const t=this.anims[e];o.mat4.fromYRotation(t.modelMtx,t.rotationY),o.mat4.rotateX(t.modelMtx,t.modelMtx,t.rotationX),o.mat4.rotateY(t.modelMtx,t.modelMtx,t.rotationY)}let t=0;t=this.updateRoom(e,e.mStayNo,t);for(let a=0;a<this.rooms.length&&!(t>8);a++)a!==e.mStayNo&&(t=this.updateRoom(e,a,t))}drawRoom(e,t,a,r,n){const s=this.rooms[t];if(0===s.length)return;let i;const l=r.camera.viewMatrix,c=o.mat4.getTranslation(y,r.camera.worldMatrix);i=a.pushTemplateRenderInst();{i.setSamplerBindingsFromTextureMappings(this.textureMapping);const h=this.material.allocateMaterialParams(i);E(e,D,t),_.dKy_GxFog_set(e.g_env_light,D.u_FogBlock,r.camera),this.material.fillMaterialParamsDataOnInst(i,h,D),this.material.setOnRenderInst(n,a.gfxRenderCache,i);for(let e=0;e<s.length;e++){const t=s[e];if(1&t.flags)continue;if(N(c,t.pos))continue;const r=a.newRenderInst();this.shape.setOnRenderInst(r),o.mat4.mul(k.u_PosMtx[0],l,t.modelMtx),this.shape.fillPacketParams(k,r),a.submitRenderInst(r)}}a.popTemplateRenderInst()}draw(e,t,a){const r=e.modelCache.device;for(let n=0;n<this.rooms.length;n++)this.drawRoom(e,n,t,a,r)}destroy(e){this.model.destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(4),n=a(0),s=a(61),i=a(1),o=a(65);class l{constructor(){this.roomNo=-1}}class c{constructor(e){this.C0=r.colorNewCopy(e),this.K0=r.colorNewCopy(e)}}t.stage_palet_info_class__DifAmb=c;class h{constructor(){this.actCol=new c(r.White),this.bgCol=n.nArray(4,()=>new c(r.White)),this.fogCol=r.colorNewCopy(r.White)}parse(e){const t=e.createDataView();return y(this.actCol.C0,t.getUint32(0)),y(this.actCol.K0,t.getUint32(3)),y(this.bgCol[0].C0,t.getUint32(6)),y(this.bgCol[0].K0,t.getUint32(9)),y(this.bgCol[1].C0,t.getUint32(12)),y(this.bgCol[1].K0,t.getUint32(15)),y(this.bgCol[2].C0,t.getUint32(18)),y(this.bgCol[2].K0,t.getUint32(21)),y(this.bgCol[3].C0,t.getUint32(24)),y(this.bgCol[3].K0,t.getUint32(27)),y(this.fogCol,t.getUint32(30)),this.virtIdx=t.getUint8(33),this.fogStartZ=t.getFloat32(36),this.fogEndZ=t.getFloat32(40),44}}t.stage_palet_info_class=h;class d{parse(e){const t=e.createDataView();return this.palIdx=e.createTypedArray(Uint8Array,0,8),this.changeRate=t.getFloat32(8),12}}t.stage_pselect_info_class=d;class u{constructor(){this.kumoCol=r.colorNewCopy(r.White),this.kumoCenterCol=r.colorNewCopy(r.White),this.skyCol=r.colorNewCopy(r.White),this.usoUmiCol=r.colorNewCopy(r.White),this.kasumiMaeCol=r.colorNewCopy(r.White)}parse(e){const t=e.createDataView();return r.colorFromRGBA8(this.kumoCol,t.getUint32(16)),r.colorFromRGBA8(this.kumoCenterCol,t.getUint32(20)),y(this.skyCol,t.getUint32(24)),y(this.usoUmiCol,t.getUint32(27)),y(this.kasumiMaeCol,t.getUint32(30)),36}}t.stage_vrbox_info_class=u;class m{parse(e){return this.pselIdx=e.createTypedArray(Uint8Array,0,8),8}}t.stage_envr_info_class=m;class p{parse(e){const t=e.createDataView();return this.nearPlane=t.getFloat32(0),this.farPlane=t.getFloat32(4),this.roomTypeAndSchBit=t.getUint32(12),28}}t.stage_stag_info_class=p;class f{parse(e){const t=e.createDataView();return this.transX=t.getFloat32(0),this.transZ=t.getFloat32(4),this.rotY=t.getUint16(8),this.roomNo=t.getUint8(10),this.waveMax=t.getUint8(11),12}}t.dStage_Multi_c=f;class A{parse(e){const t=e.createDataView();return this.param=t.getUint32(0),this.skyboxY=t.getFloat32(4),8}}t.dStage_FileList_dt_c=A;class g{constructor(){this.pos=i.vec3.create(),this.radius=0,this.fluctuation=0}parse(e){const t=e.createDataView(),a=t.getFloat32(0),r=t.getFloat32(4),n=t.getFloat32(8);return i.vec3.set(this.pos,a,r,n),this.radius=t.getFloat32(12),this.fluctuation=t.getUint8(27),28}}t.stage_lightvec_info_class=g;class _{constructor(){this.pos=i.vec3.create(),this.radius=0,this.color=r.colorNewCopy(r.White),this.fluctuation=0}parse(e){const t=e.createDataView(),a=t.getFloat32(0),n=t.getFloat32(4),s=t.getFloat32(8);return i.vec3.set(this.pos,a,n,s),this.radius=t.getFloat32(12),this.color=r.colorNewFromRGBA8(t.getUint32(24)),this.color.a=1,this.fluctuation=t.getUint8(27),28}}t.stage_plight_info_class=_;class S{constructor(){this.isTimePass=!1,this.reverb=0}parse(e,t){const a=e.createDataView(),r=a.getUint8(0);this.reverb=a.getUint8(1),this.isTimePass=!!a.getUint8(2);const n=a.getUint32(4);this.table=t.createTypedArray(Uint8Array,n,r,1)}}function b(e,t,a,r,n=-1){for(const s of a.headers.values()){const i=r[s.type];void 0!==i&&i(e,t,a.buffer.slice(s.offs),s.count,a.buffer,n)}}function v(e,t,a){const r=e.dStage_searchName(t);if(null===r)return void console.log(`Stage data references missing actor: ${t}`);a.gbaName=r.gbaName,a.subtype=r.subtype,n.assert(o.fpcLy_CurrentLayer(e.frameworkGlobals)===e.scnPlay.layer);const s=o.fpcSCtRq_Request(e.frameworkGlobals,null,r.pcName,a);n.assert(s)}function w(e,t,a,r,s,o=-1){let l=0;const c=a.createDataView();for(let s=0;s<r;s++){const r=n.readString(a,l+0,8,!0),s=c.getUint32(l+8,!1),h=c.getFloat32(l+12),d=c.getFloat32(l+16),u=c.getFloat32(l+20),m=c.getInt16(l+24),p=c.getInt16(l+26),f=c.getInt16(l+28),A=c.getUint16(l+30);v(e,r,{parameters:s,roomNo:t.roomNo,pos:i.vec3.fromValues(h,d,u),rot:i.vec3.fromValues(m,p,f),enemyNo:A,scale:i.vec3.fromValues(1,1,1),subtype:0,gbaName:0,parentPcId:4294967295,layer:o}),l+=32}}function x(e,t,a,r,s,o=-1){let l=0;const c=a.createDataView();for(let s=0;s<r;s++){const r=n.readString(a,l+0,8,!0),s=c.getUint32(l+8,!1),h=c.getFloat32(l+12),d=c.getFloat32(l+16),u=c.getFloat32(l+20),m=c.getInt16(l+24),p=c.getInt16(l+26),f=c.getInt16(l+28),A=c.getUint16(l+30),g=c.getUint8(l+32)/10,_=c.getUint8(l+33)/10,S=c.getUint8(l+34)/10;v(e,r,{parameters:s,roomNo:t.roomNo,pos:i.vec3.fromValues(h,d,u),rot:i.vec3.fromValues(m,p,f),enemyNo:A,scale:i.vec3.fromValues(g,_,S),subtype:0,gbaName:0,parentPcId:4294967295,layer:o}),l+=36}}function T(e,t,a){const r=["ACT0","ACT1","ACT2","ACT3","ACT4","ACT5","ACT6","ACT7","ACT8","ACT9","ACTA","ACTB"],n=["SCO0","SCO1","SCO2","SCO3","SCO4","SCO5","SCO6","SCO7","SCO8","SCO9","SCOA","SCOB"];for(let s=0;s<12;s++)b(e,t,a,{[r[s]]:w,[n[s]]:x},s)}t.roomRead_class=S,t.dStage_dt_decode=b,t.dStage_actorCreate=v;function y(e,t){r.colorFromRGBA8(e,4294967040&t|255)}function C(e,t,a,r){let n=0;for(let e=0;e<r;e++){const e=new h;n+=e.parse(a.slice(n)),t.pale.push(e)}}function M(e,t,a,r){let n=0;for(let e=0;e<r;e++){const e=new d;n+=e.parse(a.slice(n)),t.colo.push(e)}}function U(e,t,a,r){let n=0;for(let e=0;e<r;e++){const e=new u;n+=e.parse(a.slice(n)),t.virt.push(e)}}function k(e,t,a,r){let n=0;for(let e=0;e<r;e++){const e=new m;n+=e.parse(a.slice(n)),t.envr.push(e)}}function D(e,t,a,r){let n=0;for(let e=0;e<r;e++){const e=new f;n+=e.parse(a.slice(n)),t.mult.push(e)}}function I(e,t,a,r){n.assert(1===r),t.stag=new p,t.stag.parse(a)}function R(e,t,a,r){let n=0;for(let e=0;e<r;e++){const e=new _;n+=e.parse(a.slice(n)),t.lght.push(e)}}function B(e,t,a,r,n){let s=0;const i=a.createDataView();for(let e=0;e<r;e++){const e=new S,a=i.getUint32(s);s+=4,e.parse(n.slice(a),n),t.rtbl.push(e)}}function P(e,t,a,r,n,s){w(e,t,a,r,0,s)}function E(e,t,a,r,n,s){x(e,t,a,r,0,s)}t.dStage_stageDt_c=class extends l{constructor(){super(...arguments),this.pale=[],this.colo=[],this.virt=[],this.envr=[],this.mult=[],this.lght=[],this.rtbl=[]}},t.dStage_dt_c_stageInitLoader=function(e,t,a){b(e,t,a,{STAG:I})},t.dStage_dt_c_stageLoader=function(e,t,a){b(e,t,a,{MULT:D,ACTR:w,TGOB:w,TRES:P,RTBL:B,Pale:C,Colo:M,Virt:U,TGSC:x,LGHT:R,SCOB:x,EnvR:k,DOOR:x,TGDR:E}),T(e,t,a)};class F extends l{constructor(){super(...arguments),this.fili=null,this.lgtv=null}}t.dStage_roomDt_c=F;function V(e,t,a,r){0!==r?(n.assert(1===r),t.fili=new A,t.fili.parse(a)):t.fili=null}function O(e,t,a,r){0!==r?(t.lgtv=new g,t.lgtv.parse(a)):t.lgtv=null}function N(e,t,a,r,n,s){w(e,t,a,r,0,s)}function L(e,t,a,r,n,s){x(e,t,a,r,0,s)}t.dStage_roomStatus_c=class extends F{constructor(){super(...arguments),this.tevStr=new s.dKy_tevstr_c}},t.dStage_dt_c_roomLoader=function(e,t,a){b(e,t,a,{FILI:V,LGTV:O})},t.dStage_dt_c_roomReLoader=function(e,t,a){b(e,t,a,{ACTR:w,TGOB:w,TRES:N,TGSC:x,SCOB:x,DOOR:x,TGDR:L}),T(e,t,a)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(89);class n{constructor(){this.frameCtrl=new r.J3DFrameCtrl(0)}initPlay(e,t,a=1,r=0,n=-1,s=!1){s||this.frameCtrl.init(0),this.frameCtrl.init(n>=0?n:e),this.frameCtrl.loopMode=t,this.frameCtrl.speedInFrames=a,this.frameCtrl.currentTimeInFrames=a>0?r:this.frameCtrl.endFrame,this.frameCtrl.repeatStartFrame=this.frameCtrl.currentTimeInFrames}init(e,t,a=!0,r,n=1,s=0,i=-1,o=!1){this.anm=t,a&&this.initPlay(this.anm.duration,r,n,s,i,o)}play(e){return this.frameCtrl.update(e),!!(1&this.frameCtrl.updateFlags)&&0===this.frameCtrl.speedInFrames}}t.mDoExt_bckAnm=class extends n{entry(e,t=this.frameCtrl.currentTimeInFrames){this.frameCtrl.currentTimeInFrames=t,r.entryJointAnimator(e,this.anm,this.frameCtrl)}};t.mDoExt_btkAnm=class extends n{entry(e,t=this.frameCtrl.currentTimeInFrames){this.frameCtrl.currentTimeInFrames=t,r.entryTexMtxAnimator(e,this.anm,this.frameCtrl)}};t.mDoExt_brkAnm=class extends n{entry(e,t=this.frameCtrl.currentTimeInFrames){this.frameCtrl.currentTimeInFrames=t,r.entryTevRegAnimator(e,this.anm,this.frameCtrl)}};t.mDoExt_btpAnm=class extends n{entry(e,t=this.frameCtrl.currentTimeInFrames){this.frameCtrl.currentTimeInFrames=t,r.entryTexNoAnimator(e,this.anm,this.frameCtrl)}};t.mDoExt_bvaAnm=class extends n{entry(e,t=this.frameCtrl.currentTimeInFrames){this.frameCtrl.currentTimeInFrames=t;for(let t=0;t<e.shapeInstances.length;t++)e.shapeInstances[t].visible=r.VAF1_getVisibility(this.anm,t,this.frameCtrl.currentTimeInFrames)}},t.mDoExt_modelUpdateDL=function(e,t,a,r,n=null){const s=e.modelCache.device;null===n&&(n=e.dlst.main),e.renderer.extraTextures.fillExtraTextures(t),e.renderHacks.renderHacksChanged&&(t.setVertexColorsEnabled(e.renderHacks.vertexColorsEnabled),t.setTexturesEnabled(e.renderHacks.texturesEnabled)),t.calcAnim(r.camera),t.calcView(r.camera),a.setCurrentRenderInstList(n[0]),t.drawOpa(s,a,r.camera,r.viewport),a.setCurrentRenderInstList(n[1]),t.drawXlu(s,a,r.camera,r.viewport)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(26),n=a(0),s=a(25),i=a(36),o=a(91);t.dRes_control_c=class{constructor(){this.resObj=[],this.resStg=[]}findResInfo(e,t){for(let a=0;a<t.length;a++)if(t[a].name===e)return t[a];return null}findResInfoByArchive(e,t){for(let a=0;a<t.length;a++)if(t[a].archive===e)return t[a];return null}getStageResByName(e,t,a){return this.getResByName(e,t,a,this.resStg)}getObjectRes(e,t,a){return this.getResByID(e,t,a,this.resObj)}getResByName(e,t,a,r){return n.assertExists(this.findResInfo(t,r)).getResByName(e,a)}getResByID(e,t,a,r){return n.assertExists(this.findResInfo(t,r)).getResByIndex(e,a)}mountRes(e,t,a,r,n){null===this.findResInfo(a,n)&&n.push(new l(e,t,a,r))}destroy(e){for(let t=0;t<this.resObj.length;t++)this.resObj[t].destroy(e);for(let t=0;t<this.resStg.length;t++)this.resStg[t].destroy(e)}destroyList(e,t){for(let a=0;a<t.length;a++)t[a].destroy(e);t.length=0}};class l{constructor(e,t,a,r){this.name=a,this.archive=r,this.res=[],this.destroyables=[],this.loadResource(e,t)}lazyLoadResource(e,t,a,s){if(null===t.res){const a=t.file;if(3===e)t.res=r.BPK.parse(a.buffer);else if(4===e)t.res=r.BRK.parse(a.buffer);else if(5===e)t.res=r.BTP.parse(a.buffer);else if(6===e)t.res=r.BTK.parse(a.buffer);else if(10===e)t.res=r.BVA.parse(a.buffer);else if(9===e)t.res=function(e){const t=e.createDataView(),a=t.getUint32(0),r=new Map;let s=4;for(let i=0;i<a;i++){const a=n.readString(e,s+0,4),i=t.getUint32(s+4),o=t.getUint32(s+8);r.set(a,{type:a,count:i,offs:o}),s+=12}return{headers:r,buffer:e}}(a.buffer);else{if(11!==e)throw"whoops";t.res=a.buffer}}return t.res}getResEntryByIndex(e,t){const a=this.res;for(let e=0;e<a.length;e++)if(a[e].file.index===t)return a[e];throw"whoops"}getResEntryByID(e,t){const a=this.res;for(let e=0;e<a.length;e++)if(a[e].file.id===t)return a[e];throw"whoops"}getResEntryByName(e,t){const a=this.res;for(let e=0;e<a.length;e++)if(a[e].file.name===t)return a[e];return null}getResByIndex(e,t){return this.lazyLoadResource(e,this.getResEntryByIndex(e,t))}getResByID(e,t){return this.lazyLoadResource(e,this.getResEntryByID(e,t))}getResByName(e,t){const a=this.getResEntryByName(e,t);return null===a?null:this.lazyLoadResource(e,a)}autoLoadResource(e,t,a,n){const l=n.file;if("BMD "===a||"BMDM"===a||"BMDC"===a||"BMDS"===a||"BSMD"===a||"BDL "===a||"BDLM"===a||"BDLC"===a||"BDLI"===a){const a=new r.JSystemFileReaderHelper(l.buffer);if("J3D2bmd3"===a.magic||"J3D2bdl4"===a.magic){const i=new s.J3DModelData(e,t,r.BMD.parseReader(a));this.destroyables.push(i),n.res=i}}else if("BMT "===a||"BMTM"===a){const a=new s.BMDModelMaterialData(e,t,r.BMT.parse(l.buffer));this.destroyables.push(a),n.res=a}else"BCK "===a||"BCKS"===a?n.res=r.BCK.parse(l.buffer):"DZB "===a&&(n.res=new o.cBgD_t(l.buffer));if(l.name.endsWith(".bti")){const a=new i.BTIData(e,t,i.BTI.parse(l.buffer,l.name).texture);this.destroyables.push(a),n.res=a}}loadResource(e,t){for(let e=0;e<this.archive.files.length;e++){const t={file:this.archive.files[e],res:null};this.res.push(t)}const a=this.archive.root;for(let r=0;r<a.subdirs.length;r++){const s=a.subdirs[r];n.assert(0===s.subdirs.length);for(let a=0;a<s.files.length;a++){const r=this.res.find(e=>e.file===s.files[a]);this.autoLoadResource(e,t,s.type,r)}}}destroy(e){for(let t=0;t<this.destroyables.length;t++)this.destroyables[t].destroy(e)}}t.dRes_info_c=l,t.dComIfG_resLoad=function(e,t){return e.modelCache.requestObjectData(t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(9),s=a(50),i=a(14),o=a(0);class l{constructor(e=r.GfxFormat.U8_RGBA_NORM){this.gfxAttachment=null,this.colorTexture=new n.ColorTexture(e)}setParameters(e,t,a){return!!this.colorTexture.setParameters(e,t,a)&&(this.destroyAttachment(e),this.gfxAttachment=e.createAttachmentFromTexture(this.colorTexture.gfxTexture),!0)}destroyAttachment(e){null!==this.gfxAttachment&&(e.destroyAttachment(this.gfxAttachment),this.gfxAttachment=null)}destroy(e){this.colorTexture.destroy(e),this.destroyAttachment(e)}}t.PeekZResult=class{constructor(){this.triviallyCulled=!1,this.value=null}};class c{constructor(e,t){this.entries=[];const a=t;this.readback=e.createReadback(a)}destroy(e){e.destroyReadback(this.readback)}}t.PeekZManager=class{constructor(e=50){this.maxCount=e,this.framePool=[],this.submittedFrames=[],this.maxSubmittedFrames=10,this.currentFrame=null,this.resolveRenderPassDescriptor=n.makeEmptyRenderPassDescriptor(),this.colorAttachment=new l(r.GfxFormat.U32_R),this.depthTexture=new n.ColorTexture(r.GfxFormat.D32F_S8),this.depthSampler=null,this.fullscreenCopyBindings=null,this.fullscreenCopyPipeline=null,this.fullscreenCopyProgram=null,this.resultBuffer=new Uint32Array(this.maxCount),this.resolveRenderPassDescriptor.depthLoadDisposition=1,this.resolveRenderPassDescriptor.stencilLoadDisposition=1}returnFrame(e){e.entries.length=0,this.framePool.push(e)}newData(e,t,a){const r=o.assertExists(this.currentFrame);return t<-1||t>1||a<-1||a>1?(e.triviallyCulled=!0,!0):(e.triviallyCulled=!1,!(r.entries.length>=this.maxCount)&&(e.normalizedX=t,e.normalizedY=a,r.entries.push(e),!0))}setParameters(e,t,a){if(this.colorAttachment.setParameters(e,t,a),this.depthTexture.setParameters(e,t,a)){null===this.depthSampler&&(this.depthSampler=e.createSampler({minFilter:0,magFilter:0,mipFilter:0,wrapS:0,wrapT:0,minLOD:0,maxLOD:100}));const t=[{gfxTexture:this.depthTexture.gfxTexture,gfxSampler:this.depthSampler}];this.fullscreenCopyBindings=e.createBindings({bindingLayout:{numSamplers:1,numUniformBuffers:0},samplerBindings:t,uniformBufferBindings:[]})}null===this.currentFrame&&(this.framePool.length>0?this.currentFrame=this.framePool.pop():this.currentFrame=new c(e,this.maxCount))}submitFrame(e,t){if(null===this.currentFrame)return;if(null===this.fullscreenCopyPipeline){const t="\nout vec2 v_TexCoord;\n\nvoid main() {\n    v_TexCoord.x = (gl_VertexID == 1) ? 2.0 : 0.0;\n    v_TexCoord.y = (gl_VertexID == 2) ? 2.0 : 0.0;\n    gl_Position.xy = v_TexCoord * vec2(2) - vec2(1);\n    gl_Position.zw = vec2(1, 1);\n}\n",a="\nuniform highp sampler2D u_Texture;\nin vec2 v_TexCoord;\n\nout uint o_Output;\n\nvoid main() {\n    vec4 color = texture(u_Texture, v_TexCoord);\n    o_Output = uint(color.r * 4294967295.0);\n}\n",r=s.preprocessProgram_GLSL(e.queryVendorInfo(),t,a);this.fullscreenCopyProgram=e.createProgramSimple(r),this.fullscreenCopyPipeline=e.createRenderPipeline({bindingLayouts:[{numSamplers:1,numUniformBuffers:0}],inputLayout:null,megaStateDescriptor:i.fullscreenMegaState,program:this.fullscreenCopyProgram,sampleCount:1,topology:0})}const a=this.currentFrame;if(this.currentFrame=null,!e.queryPipelineReady(this.fullscreenCopyPipeline))return this.returnFrame(a);if(this.submittedFrames.length>=this.maxSubmittedFrames)return this.returnFrame(a);if(0===a.entries.length)return this.returnFrame(a);let r;this.resolveRenderPassDescriptor.colorAttachment=null,this.resolveRenderPassDescriptor.colorResolveTo=null,this.resolveRenderPassDescriptor.depthStencilAttachment=t,this.resolveRenderPassDescriptor.depthStencilResolveTo=this.depthTexture.gfxTexture,r=e.createRenderPass(this.resolveRenderPassDescriptor),e.submitPass(r),this.resolveRenderPassDescriptor.colorAttachment=this.colorAttachment.gfxAttachment,this.resolveRenderPassDescriptor.colorResolveTo=null,this.resolveRenderPassDescriptor.depthStencilAttachment=null,this.resolveRenderPassDescriptor.depthStencilResolveTo=null,r=e.createRenderPass(this.resolveRenderPassDescriptor),r.setPipeline(this.fullscreenCopyPipeline),r.setBindings(0,this.fullscreenCopyBindings,[]),r.setInputState(null),r.draw(3,0),e.submitPass(r);for(let t=0;t<a.entries.length;t++){const r=a.entries[t];r.attachmentX=(.5*r.normalizedX+.5)*this.colorAttachment.colorTexture.width+.5|0,r.attachmentY=(.5*r.normalizedY+.5)*this.colorAttachment.colorTexture.height+.5|0,e.readPixelFromTexture(a.readback,t,this.colorAttachment.colorTexture.gfxTexture,r.attachmentX,r.attachmentY)}e.submitReadback(a.readback),this.submittedFrames.push(a)}peekData(e){for(let t=0;t<this.submittedFrames.length;t++){const a=this.submittedFrames[t];if(e.queryReadbackFinished(this.resultBuffer,0,a.readback)){this.submittedFrames.splice(t,1);for(let e=0;e<a.entries.length;e++)a.entries[e].value=this.resultBuffer[e]/4294967295;this.returnFrame(a);break}}}destroy(e){null!==this.currentFrame&&this.currentFrame.destroy(e);for(let t=0;t<this.submittedFrames.length;t++)this.submittedFrames[t].destroy(e);for(let t=0;t<this.framePool.length;t++)this.framePool[t].destroy(e);null!==this.fullscreenCopyBindings&&e.destroyBindings(this.fullscreenCopyBindings),null!==this.fullscreenCopyProgram&&e.destroyProgram(this.fullscreenCopyProgram),null!==this.fullscreenCopyPipeline&&e.destroyRenderPipeline(this.fullscreenCopyPipeline),null!==this.depthSampler&&e.destroySampler(this.depthSampler),this.depthTexture.destroy(e),this.colorAttachment.destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(28),s=a(52),i=a(53),o=a(2),l=a(12),c=a(40),h=a(43),d=a(79),u=r.vec3.create(),m=r.vec3.create(),p=r.mat4.create();class f{constructor(e,t,a){this.worldMatrix=r.mat4.create(),this.aabb=new l.AABB,function(e,t,a){i.getJMapInfoRotate(u,t,a),o.computeModelMatrixR(e,u[0],u[1],u[2]),i.getJMapInfoTrans(u,t,a),e[12]=u[0],e[13]=u[1],e[14]=u[2]}(this.worldMatrix,e,t),n.getJMapInfoScale(u,t),this.aabb.minX=-.5*u[0]*1e3,this.aabb.minY=-.5*u[1]*1e3,this.aabb.minZ=-.5*u[2]*1e3,this.aabb.maxX=.5*u[0]*1e3,this.aabb.maxY=.5*u[1]*1e3,this.aabb.maxZ=.5*u[2]*1e3,1===a&&(this.aabb.minY+=.5*u[1]*1e3)}calcWorldMtx(e){r.mat4.copy(e,this.worldMatrix)}isInVolume(e){return this.calcWorldMtx(p),function(e,t,a){const r=t[0]-a[12],n=t[1]-a[13],s=t[2]-a[14];e[0]=r*a[0]+n*a[1]+s*a[2],e[1]=r*a[4]+n*a[5]+s*a[6],e[2]=r*a[8]+n*a[9]+s*a[10]}(u,e,p),this.aabb.containsPoint(u)}}class A{constructor(e,t){this.pos=r.vec3.create(),i.getJMapInfoTrans(this.pos,e,t),n.getJMapInfoScale(u,t);const a=500*u[0];this.radiusSq=a*a}calcPos(e){r.vec3.copy(e,this.pos)}isInVolume(e){return this.calcPos(u),r.vec3.sub(u,u,e),r.vec3.squaredLength(u)<this.radiusSq}}class g{constructor(e,t){this.pos=r.vec3.create(),this.upVec=r.vec3.create(),i.getJMapInfoTrans(this.pos,e,t),i.getJMapInfoRotate(u,e,t),o.computeModelMatrixR(p,u[0],u[1],u[2]),r.vec3.set(u,0,1,0),r.vec3.transformMat4(u,u,p),r.vec3.normalize(this.upVec,u),n.getJMapInfoScale(u,t);const a=500*u[0];this.radiusSq=a*a,this.height=500*u[1]}calcPos(e){r.vec3.copy(e,this.pos)}calcUpVec(e){r.vec3.copy(e,this.upVec)}isInVolume(e){this.calcPos(u),this.calcUpVec(m),r.vec3.sub(u,u,e);const t=h.vecKillElement(u,u,m);if(t>=0&&t<=this.height){if(r.vec3.squaredLength(u)<this.radiusSq)return!0}return!1}}class _{constructor(e,t){this.pos=r.vec3.create(),this.upVec=r.vec3.create(),i.getJMapInfoTrans(this.pos,e,t),i.getJMapInfoRotate(u,e,t),o.computeModelMatrixR(p,u[0],u[1],u[2]),r.vec3.set(u,0,1,0),r.vec3.transformMat4(u,u,p),r.vec3.normalize(this.upVec,u),n.getJMapInfoScale(u,t);const a=500*u[0];this.radiusSq=a*a}isInVolume(e){if(r.vec3.sub(u,this.pos,e),r.vec3.squaredLength(u)<this.radiusSq){if(r.vec3.dot(u,this.upVec)<0)return!0}return!1}}class S extends c.NameObj{constructor(e,t,a,r){if(super(t,s.getObjectName(a)),this.zoneAndLayer=e,this.aliveScenario=!0,this.isValid=!0,this.isAwake=!0,0===r?this.form=new f(t,a,0):1===r?this.form=new f(t,a,1):2===r?this.form=new A(t,a):3===r?this.form=new g(t,a):4===r&&(this.form=new _(t,a)),this.switchCtrl=d.createStageSwitchCtrl(t,a),this.switchCtrl.isValidSwitchAppear()){const e=new d.SwitchFunctorEventListener(this.validate.bind(this),this.invalidate.bind(this));d.getSwitchWatcherHolder(t).joinSwitchEventListenerAppear(this.switchCtrl,e),this.isValid=!1}t.create(13),t.areaObjContainer.getManager(this.getManagerName()).entry(this),d.addSleepControlForLiveActor}awake(e){this.isAwake=!0}sleep(e){this.isAwake=!1}validate(e){this.isValid=!0}invalidate(e){this.isValid=!1}scenarioChanged(e){this.aliveScenario=e.spawner.checkAliveScenario(this.zoneAndLayer)}isInVolume(e){return!(!this.isValid||!this.aliveScenario)&&this.form.isInVolume(e)}}t.AreaObj=S;class b extends c.NameObj{constructor(e,t){super(e,t),this.areaObj=[]}entry(e){this.areaObj.push(e)}find_in(e){for(let t=0;t<this.areaObj.length;t++)if(this.areaObj[t].isInVolume(e))return this.areaObj[t];return null}}t.AreaObjMgr=b},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(90)),s=a(28),i=a(0),o=a(1),l=a(4),c=a(2);class h{constructor(e){this.resourceDatas=new Map;const t=s.createCsvParser(e.findFileData("ParticleNames.bcsv"));this.effectNames=t.mapRecords(e=>i.assertExists(e.getValueString("name"))),this.autoEffectList=s.createCsvParser(e.findFileData("AutoEffectList.bcsv"));const a=e.findFileData("Particles.jpc");this.jpac=n.parse(a),this.jpacData=new n.JPACData(this.jpac)}getUserIndex(e){return this.effectNames.findIndex(t=>t===e)}getResourceRaw(e){return this.jpac.effects[this.getUserIndex(e)]}getResourceData(e,t){const a=this.getUserIndex(t);if(a<0)return null;if(!this.resourceDatas.has(a)){const r=e.modelCache.device,s=e.modelCache.cache,i=new n.JPAResourceData(r,s,this.jpacData,this.jpac.effects[a]);i.name=t,this.resourceDatas.set(a,i)}return this.resourceDatas.get(a)}getTextureMappingReference(e){return this.jpacData.getTextureMappingReference(e)}destroy(e){this.jpacData.destroy(e)}}function d(e,t){return""!==t&&(i.assert(7===t.length),e.r=parseInt(t.slice(1,3),16)/255,e.g=parseInt(t.slice(3,5),16)/255,e.b=parseInt(t.slice(5,7),16)/255,e.a=1,!0)}function u(e){let t=0;return e.includes("S")&&(t|=1),e.includes("R")&&(t|=2),e.includes("T")&&(t|=4),t}t.ParticleResourceHolder=h;class m{constructor(){this.baseEmitter=null,this.didInit=!1}init(e){i.assert(null===this.baseEmitter),this.baseEmitter=e,this.baseEmitter.flags|=64,this.didInit=!1}invalidate(){this.baseEmitter=null}setGlobalPrmColor(e){null!==this.baseEmitter&&l.colorCopy(this.baseEmitter.globalColorPrm,e)}setGlobalEnvColor(e){null!==this.baseEmitter&&l.colorCopy(this.baseEmitter.globalColorEnv,e)}setGlobalScale(e){null!==this.baseEmitter&&this.baseEmitter.setGlobalScale(e)}}class p{constructor(){this.particleEmitter=null,this.resource=null,this.groupID=0,this.visibleForce=!0}init(e){this.resource=e,this.loopMode=0===e.res.bem1.maxFrame?1:0}deleteEmitter(){this.isValid()&&M(this.particleEmitter)}isValid(){return null!==this.particleEmitter&&null!==this.particleEmitter.baseEmitter}setGroupID(e){this.groupID=e}link(e){i.assert(null===this.particleEmitter),this.particleEmitter=e,this.particleEmitter.baseEmitter.userData=this}unlink(){this.particleEmitter.baseEmitter.userData=null,this.particleEmitter=null}isOneTime(){return this.isValid()?0!==this.particleEmitter.baseEmitter.maxFrame:0===this.loopMode}setDrawParticle(e){this.isValid()&&this.particleEmitter.baseEmitter.setDrawParticle(e&&this.visibleForce)}}const f=l.colorNewCopy(l.White);function A(e,t){o.vec3.set(e.emitterCallBack.offset,i.fallback(t.getValueNumber("OffsetX"),0),i.fallback(t.getValueNumber("OffsetY"),0),i.fallback(t.getValueNumber("OffsetZ"),0));const a=i.fallback(t.getValueNumber("ScaleValue"),1);1!==a&&e.emitterCallBack.setBaseScale(a),e.emitterCallBack.affectFlags=u(i.assertExists(t.getValueString("Affect"))),e.emitterCallBack.followFlags=u(i.assertExists(t.getValueString("Follow"))),d(f,i.assertExists(t.getValueString("PrmColor")))&&e.setGlobalPrmColor(f),d(f,i.assertExists(t.getValueString("EnvColor")))&&e.setGlobalEnvColor(f);const r=t.getValueString("DrawOrder");"AFTER_INDIRECT"===r?e.setDrawOrder(73):"INDIRECT"===r?e.setDrawOrder(72):"3D"===r?e.setDrawOrder(71):"BLOOM_EFFECT"===r?e.setDrawOrder(76):"AFTER_IMAGE_EFFECT"===r?e.setDrawOrder(77):(console.warn("unknown draw order",r),e.setDrawOrder(71));const n=i.assertExists(t.getValueString("AnimName"));""!==n?(e.animNames=n.toLowerCase().split(" "),e.startFrame=i.fallback(t.getValueNumber("StartFrame"),0),e.endFrame=i.fallback(t.getValueNumber("EndFrame"),-1)):(e.animNames=null,e.startFrame=0,e.endFrame=-1),e.continueAnimEnd="on"===t.getValueString("ContinueAnimEnd")}t.setupMultiEmitter=A;class g{constructor(){this.globalColorPrm=l.colorNewCopy(l.White),this.globalColorEnv=l.colorNewCopy(l.White),this.offset=o.vec3.create(),this.baseScale=null,this.affectFlags=0,this.followFlags=0,this.drawParticle=!0,this.hostMtx=null,this.hostTranslation=null,this.hostRotation=null,this.hostScale=null}setEffectSRT(e,t,a,r,n,s){4&n&&(null!==a?o.vec3.transformMat4(v,this.offset,a):o.vec3.copy(v,this.offset),1&n&&o.vec3.mul(v,v,t),o.vec3.add(e.globalTranslation,r,v)),2&n&&o.mat4.copy(e.globalRotation,a),1&n?(null!==this.hostScale?o.vec3.copy(v,this.hostScale):o.vec3.copy(v,t),null!==this.baseScale&&o.vec3.scale(v,v,this.baseScale),e.setGlobalScale(v)):s&&null!==this.baseScale&&(o.vec3.set(v,this.baseScale,this.baseScale,this.baseScale),e.setGlobalScale(v))}setSRTFromHostMtx(e,t,a,r){const s=S,i=_,o=b;n.JPASetRMtxSTVecFromMtx(s,i,o,t),this.setEffectSRT(e,s,i,o,a,r)}setSRTFromHostSRT(e,t,a,r,n,s){let i;2&n?(i=_,c.computeModelMatrixR(i,a[0],a[1],a[2])):i=null,this.setEffectSRT(e,t,i,r,n,s)}isFollowSRT(e){let t=e?this.affectFlags:this.followFlags;return null===this.hostMtx&&null===this.hostTranslation&&(t&=-5),null===this.hostMtx&&null===this.hostRotation&&(t&=-3),null===this.hostMtx&&null===this.hostScale&&(t&=-2),t}followSRT(e,t){const a=this.isFollowSRT(t);null!==this.hostMtx?this.setSRTFromHostMtx(e,this.hostMtx,a,t):this.setSRTFromHostSRT(e,this.hostScale,this.hostRotation,this.hostTranslation,a,t)}setColor(e){l.colorCopy(e.globalColorEnv,this.globalColorEnv),l.colorCopy(e.globalColorPrm,this.globalColorPrm)}execute(e){this.followSRT(e,!1),this.setColor(e)}init(e){e.setDrawParticle(this.drawParticle),this.followSRT(e,!0)}setHostMtx(e,t=null){this.hostTranslation=null,this.hostRotation=null,this.hostScale=t,this.hostMtx=e}setHostSRT(e,t,a){this.hostTranslation=e,this.hostRotation=t,this.hostScale=a,this.hostMtx=null}setBaseScale(e){this.baseScale=e}}const _=o.mat4.create(),S=o.vec3.create(),b=o.vec3.create(),v=o.vec3.create();class w{constructor(e,t){this.singleEmitters=[],this.childEmitters=[],this.bckName=null,this.emitterCallBack=new g,this.allocateEmitter(e,t)}allocateEmitter(e,t){const a=e.effectSystem.particleResourceHolder;let r=[];if(t.includes(" "))r=t.split(" ");else if(t.match(/\d+$/))r.push(t);else{let e=0;for(;;){const n=`${t}${i.leftPad(""+e,2,"0")}`;if(a.getUserIndex(n)<0)break;r.push(n),e++}}for(let t=0;t<r.length;t++){const n=i.assertExists(a.getResourceData(e,r[t])),s=new p;s.init(n),this.singleEmitters.push(s)}}setDrawOrder(e){for(let t=0;t<this.singleEmitters.length;t++)this.singleEmitters[t].setGroupID(e)}createEmitter(e){for(let t=0;t<this.singleEmitters.length;t++)e.createSingleEmitter(this.singleEmitters[t],this.emitterCallBack);for(let t=0;t<this.childEmitters.length;t++)this.childEmitters[t].createEmitter(e)}createOneTimeEmitter(e){for(let t=0;t<this.singleEmitters.length;t++)this.singleEmitters[t].isOneTime()&&e.createSingleEmitter(this.singleEmitters[t],this.emitterCallBack)}createForeverEmitter(e){for(let t=0;t<this.singleEmitters.length;t++)this.singleEmitters[t].isOneTime()||e.createSingleEmitter(this.singleEmitters[t],this.emitterCallBack)}deleteEmitter(){for(let e=0;e<this.singleEmitters.length;e++)this.singleEmitters[e].deleteEmitter();for(let e=0;e<this.childEmitters.length;e++)this.childEmitters[e].deleteEmitter()}forceDeleteEmitter(e){for(let t=0;t<this.singleEmitters.length;t++)e.forceDeleteSingleEmitter(this.singleEmitters[t]);for(let t=0;t<this.childEmitters.length;t++)this.childEmitters[t].forceDeleteEmitter(e)}deleteForeverEmitter(){for(let e=0;e<this.singleEmitters.length;e++)this.singleEmitters[e].isOneTime()||this.singleEmitters[e].deleteEmitter();for(let e=0;e<this.childEmitters.length;e++)this.childEmitters[e].deleteForeverEmitter()}playEmitterOffClipped(){for(let e=0;e<this.singleEmitters.length;e++){const t=this.singleEmitters[e];if(!t.isValid()||t.isOneTime())continue;const a=t.particleEmitter.baseEmitter;a.flags&=-3,a.flags&=-5}}stopEmitterOnClipped(){for(let e=0;e<this.singleEmitters.length;e++){const t=this.singleEmitters[e];if(!t.isValid()||t.isOneTime())continue;const a=t.particleEmitter.baseEmitter;a.flags|=2,a.flags|=4}}playCalcAndDeleteForeverEmitter(){this.playCalcEmitter(-1),this.deleteForeverEmitter()}setName(e){this.name=e}setDrawParticle(e){this.emitterCallBack.drawParticle=e;for(let t=0;t<this.singleEmitters.length;t++){const a=this.singleEmitters[t];a.isValid()&&a.setDrawParticle(e)}}playCalcEmitter(e=-1){if(-1===e)for(let e=0;e<this.singleEmitters.length;e++){const t=this.singleEmitters[e];t.isValid()&&(t.particleEmitter.baseEmitter.flags&=-3)}else{const t=this.singleEmitters[e];t.isValid()&&(t.particleEmitter.baseEmitter.flags&=-3)}}setGlobalScale(e,t=-1){if(-1===t)for(let t=0;t<this.singleEmitters.length;t++){const a=this.singleEmitters[t];a.isValid()&&a.particleEmitter.setGlobalScale(e)}else{const a=this.singleEmitters[t];a.isValid()&&a.particleEmitter.setGlobalScale(e)}}setGlobalPrmColor(e,t=-1){if(-1===t){l.colorCopy(this.emitterCallBack.globalColorPrm,e);for(let t=0;t<this.singleEmitters.length;t++){const a=this.singleEmitters[t];a.isValid()&&a.particleEmitter.setGlobalPrmColor(e)}}else{const a=this.singleEmitters[t];a.isValid()&&a.particleEmitter.setGlobalPrmColor(e)}}setGlobalEnvColor(e,t=-1){if(-1===t){l.colorCopy(this.emitterCallBack.globalColorEnv,e);for(let t=0;t<this.singleEmitters.length;t++){const a=this.singleEmitters[t];a.isValid()&&a.particleEmitter.setGlobalEnvColor(e)}}else{const a=this.singleEmitters[t];a.isValid()&&a.particleEmitter.setGlobalEnvColor(e)}}setHostSRT(e,t,a){this.emitterCallBack.setHostSRT(e,t,a)}setHostMtx(e){this.emitterCallBack.setHostMtx(e)}}function x(e,t){return null!==t&&e.animNames.includes(t.toLowerCase())}function T(e,t,a){return 0!==e.frameCtrl.speedInFrames&&e.checkPass(t,a)}function y(e,t,a,r,n,s){return!!x(e,t)&&(1===r||(!(!n&&e.startFrame>=0)||T(a,e.startFrame,s)))}t.MultiEmitter=w;t.EffectKeeper=class{constructor(e,t,a){this.actor=t,this.groupName=a,this.multiEmitters=[],this.changeBckReset=!1,this.currentBckName=null,this.visibleScenario=!0,this.visibleDrawParticle=!0,function(e,t,a,r){if(null===e.effectSystem)return;const n=e.effectSystem.particleResourceHolder.autoEffectList;for(let a=0;a<n.getNumRecords();a++)n.setRecord(a),n.getValueString("GroupName")===r&&t.addAutoEffect(e,n)}(e,this,this.actor,this.groupName)}addAutoEffect(e,t){const a=new w(e,i.assertExists(t.getValueString("EffectName")));a.setName(i.assertExists(t.getValueString("UniqueName")));let r=t.getValueString("JointName");if(""===r&&(r=null),null!==r){const e=i.assertExists(this.actor.getJointMtx(r));a.emitterCallBack.setHostMtx(e)}else{const e=this.actor.getBaseMtx();null!==e?a.emitterCallBack.setHostMtx(e,this.actor.scale):a.emitterCallBack.setHostSRT(this.actor.translation,this.actor.rotation,this.actor.scale)}A(a,t);const n=i.fallback(t.getValueString("ParentName"),"");if(""!==n){i.assertExists(this.getEmitter(n)).childEmitters.push(a)}this.multiEmitters.push(a)}getEmitter(e){for(let t=0;t<this.multiEmitters.length;t++)if(this.multiEmitters[t].name===e)return this.multiEmitters[t];return null}isRegisteredEmitter(e){return null!==this.getEmitter(e)}createEmitter(e,t){const a=this.getEmitter(t);return null!==a&&a.createEmitter(e.effectSystem),a}deleteEmitter(e,t){const a=this.getEmitter(t);null!==a&&a.deleteEmitter()}forceDeleteEmitter(e,t){const a=this.getEmitter(t);null!==a&&a.forceDeleteEmitter(e.effectSystem)}deleteEmitterAll(){for(let e=0;e<this.multiEmitters.length;e++)this.multiEmitters[e].deleteEmitter()}playEmitterOffClipped(){for(let e=0;e<this.multiEmitters.length;e++)this.multiEmitters[e].playEmitterOffClipped()}stopEmitterOnClipped(){for(let e=0;e<this.multiEmitters.length;e++)this.multiEmitters[e].stopEmitterOnClipped()}clear(){for(let e=0;e<this.multiEmitters.length;e++)this.multiEmitters[e].playCalcAndDeleteForeverEmitter()}changeBck(){this.changeBckReset=!0}syncEffectBck(e,t,a,r){null!==a.animNames&&(y(a,this.currentBckName,t,0,this.changeBckReset,r)&&a.createOneTimeEmitter(e),y(a,this.currentBckName,t,1,this.changeBckReset,r)&&a.createForeverEmitter(e),function(e,t,a,r){if(!x(e,t)){if(!e.continueAnimEnd)return e.bckName!==t;const r=a.getCurrentBckName();if(null===r)return!1;if(!x(e,r))return a.isTerminate(r)}return e.endFrame>=0&&T(a,e.endFrame,r)}(a,this.currentBckName,t,r)&&a.deleteEmitter(),a.bckName=this.currentBckName)}updateSyncBckEffect(e,t){if(null===this.actor.modelManager||null===this.actor.modelManager.xanimePlayer)return;const a=this.actor.modelManager.xanimePlayer,r=0!==a.frameCtrl.speedInFrames;this.currentBckName=r?a.getCurrentBckName():null,null!==this.currentBckName&&(this.currentBckName=this.currentBckName.toLowerCase());for(let r=0;r<this.multiEmitters.length;r++)this.syncEffectBck(e,a,this.multiEmitters[r],t);this.changeBckReset=!1}syncVisibility(){for(let e=0;e<this.multiEmitters.length;e++)this.multiEmitters[e].setDrawParticle(this.visibleScenario&&this.visibleDrawParticle)}setVisibleScenario(e){this.visibleScenario=e,this.syncVisibility()}setDrawParticle(e){this.visibleDrawParticle=e,this.syncVisibility()}};class C{constructor(e,t){this.effectSystem=e,this.particleEmitters=[];for(let e=0;e<t;e++)this.particleEmitters.push(new m)}findAvailableParticleEmitter(){for(let e=0;e<this.particleEmitters.length;e++)if(null===this.particleEmitters[e].baseEmitter)return this.particleEmitters[e];return null}update(){for(let e=0;e<this.particleEmitters.length;e++){const t=this.particleEmitters[e],a=t.baseEmitter;null!==a&&(8&a.flags&&0===a.aliveParticlesBase.length&&0===a.aliveParticlesChild.length?this.effectSystem.forceDeleteEmitter(t):t.didInit||(null!==a.emitterCallBack&&a.emitterCallBack.init(a),t.didInit=!0))}}}t.ParticleEmitterHolder=C;function M(e){const t=i.assertExists(e.baseEmitter);t.flags|=1,t.maxFrame=1}t.EffectSystem=class{constructor(e,t){this.drawInfo=new n.JPADrawInfo,this.particleResourceHolder=new h(t);this.emitterManager=new n.JPAEmitterManager(e,6144,512),this.particleEmitterHolder=new C(this,6144)}makeMultiEmitterForUniqueName(e,t){const a=this.particleResourceHolder.autoEffectList;if(!a.findRecord(e=>e.getValueString("UniqueName")===t))return null;const r=new w(e,i.assertExists(a.getValueString("EffectName")));return r.setName(i.assertExists(a.getValueString("UniqueName"))),A(r,a),r}calc(e){this.particleEmitterHolder.update(),this.emitterManager.calc(e)}setDrawInfo(e,t,a){this.drawInfo.posCamMtx=e,this.drawInfo.prjMtx=t,this.drawInfo.texPrjMtx=a}draw(e,t,a){this.emitterManager.draw(e,t,this.drawInfo,a)}createEmitter(e,t){const a=this.particleEmitterHolder.findAvailableParticleEmitter();if(null===a)return null;const r=this.emitterManager.createEmitter(e);return null===r?null:(r.drawGroupId=t,a.init(r),a)}createSingleEmitter(e,t){if(e.isValid()){if(!e.isOneTime())return;e.unlink()}const a=this.createEmitter(e.resource,e.groupID);if(null!==a){e.link(a);const r=a.baseEmitter;null!==t&&(r.emitterCallBack=t)}}forceDeleteEmitter(e){if(null!==e.baseEmitter.userData){const t=e.baseEmitter.userData;i.assert(e===t.particleEmitter),t.particleEmitter=null}this.emitterManager.forceDeleteEmitter(e.baseEmitter),e.invalidate()}forceDeleteSingleEmitter(e){const t=e.particleEmitter;null!==t&&(e.particleEmitter=null,this.emitterManager.forceDeleteEmitter(t.baseEmitter),t.invalidate())}destroy(e){this.particleResourceHolder.destroy(e),this.emitterManager.destroy(e)}},t.deleteParticleEmitter=M},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(28),n=a(1),s=a(0),i=a(2),o=a(37),l=a(4);function c(e,t,a,r){e[0]=s.fallback(a.getValueNumber(`${r}_x`),0),e[1]=s.fallback(a.getValueNumber(`${r}_y`),0),e[2]=s.fallback(a.getValueNumber(`${r}_z`),0);const i=s.assertExists(t.stageDataHolder.findPlacedStageDataHolder(a));n.vec3.transformMat4(e,e,i.placementMtx)}const h=n.vec3.create(),d=n.vec3.create();class u{constructor(e,t){this.p0=n.vec3.create(),this.p3=n.vec3.create(),n.vec3.copy(this.p0,e),n.vec3.sub(this.p3,t,e),this.length=n.vec3.length(this.p3)}calcPos(e,t){n.vec3.scaleAndAdd(e,this.p0,this.p3,t)}calcVelocity(e,t){n.vec3.copy(e,this.p3)}getLength(e,t){return this.length*(t-e)}getTotalLength(){return this.length}getNearestParam(e,t){n.vec3.subtract(h,e,this.p0);const a=n.vec3.dot(h,this.p3),r=n.vec3.squaredLength(this.p3);return i.clamp(a/r,0,1)}getParam(e){return e/this.length}}class m{constructor(e,t,a,r){this.p0=n.vec3.create(),this.p1=n.vec3.create(),this.p2=n.vec3.create(),this.p3=n.vec3.create(),n.vec3.copy(this.p0,e),n.vec3.sub(this.p1,t,e),n.vec3.sub(this.p2,a,t),n.vec3.sub(this.p3,r,a),n.vec3.sub(this.p3,this.p3,this.p2),n.vec3.sub(this.p2,this.p2,this.p1),n.vec3.sub(this.p3,this.p3,this.p2),this.length=this.getLength(0,1)}calcPos(e,t){n.vec3.copy(e,this.p0),n.vec3.scaleAndAdd(e,e,this.p1,3*t),n.vec3.scaleAndAdd(e,e,this.p2,3*t*t),n.vec3.scaleAndAdd(e,e,this.p3,t*t*t)}calcVelocity(e,t){n.vec3.copy(e,this.p1),n.vec3.scaleAndAdd(e,e,this.p2,2*t),n.vec3.scaleAndAdd(e,e,this.p3,t*t),n.vec3.scale(e,e,3)}getLength(e,t,a=10){let r=0,s=0,i=2;const o=1/(2*a)*(t-e);for(let t=1;t<=a;t++)this.calcVelocity(h,e+o*(i-1)),r+=n.vec3.length(h),t<a&&(this.calcVelocity(h,e+o*i),s+=n.vec3.length(h)),i+=2;this.calcVelocity(h,e);const l=n.vec3.length(h);return this.calcVelocity(h,t),1/3*(o*(4*r+.5*(l+n.vec3.length(h))+2*s))}getTotalLength(){return this.length}getNearestParam(e,t){let a=-1,r=1/0;for(let s=0;s<=1;s+=t){this.calcPos(h,s);const t=n.vec3.squaredDistance(e,h);t<r&&(a=s,r=t)}return a}getParam(e){let t=e/this.length,a=this.getLength(0,t);if(Math.abs(e-a)>.01){for(let r=0;r<5;r++){this.calcVelocity(h,t);const r=n.vec3.length(h);if(t=i.clamp(t+(e-a)/r,0,1),a=this.getLength(0,t),Math.abs(e-a)<.01)break}(a<0||t>1)&&(t=i.clamp(t,0,1))}return t}}function p(e,t,a){return!(e-t<-a)&&!(e-t>a)}function f(e,t,a){return p(e[0],t[0],a)&&p(e[1],t[1],a)&&p(e[2],t[2],a)}function A(e,t,a,r){return f(e,t,.01)&&f(a,r,.01)?new u(e,r):new m(e,t,a,r)}class g{constructor(e,t,a){this.pointsInfo=a,this.railParts=[],this.railPartCoords=[],this.isClosed="CLOSE"===t.getValueString("closed"),this.railIter=new r.JMapInfoIter(t.bcsv,t.record),this.pointRecordCount=a.getNumRecords();const i=this.isClosed?this.pointRecordCount:this.pointRecordCount-1,o=n.vec3.create(),l=n.vec3.create(),h=n.vec3.create(),d=n.vec3.create();let u=0;for(let t=0;t<i;t++){const r=t,n=(t+1)%this.pointRecordCount;a.setRecord(r),s.assert(a.getValueNumber("id")===r),c(o,e,a,"pnt0"),c(l,e,a,"pnt2"),a.setRecord(n),c(h,e,a,"pnt1"),c(d,e,a,"pnt0");const i=A(o,l,h,d);this.railParts.push(i),u+=i.getTotalLength(),this.railPartCoords.push(u)}}copyPointPos(e,t){s.assert(t<this.pointRecordCount),this.isClosed||t!==this.railParts.length?n.vec3.copy(e,this.railParts[t].p0):this.railParts[t-1].calcPos(e,1)}calcRailCtrlPointIter(e){return this.pointsInfo.setRecord(e),this.pointsInfo}getRailPosCoord(e){return 0===e?0:this.isClosed||e!==this.pointRecordCount?this.railPartCoords[e-1]:this.getTotalLength()}getTotalLength(){return this.railPartCoords[this.railPartCoords.length-1]}getNearestRailPosCoord(e){let t=1/0,a=-1,r=-1;for(let s=0;s<this.railParts.length;s++){const i=this.railParts[s],o=i.getTotalLength(),l=i.getNearestParam(e,100/o);i.calcPos(h,l);const c=n.vec3.squaredDistance(h,e);c<t&&(t=c,a=l,r=s)}return this.getRailPosCoord(r)+this.railParts[r].getLength(0,a)}normalizePos(e,t){if(this.isClosed){const a=this.getTotalLength();let r=e%a;return t<0&&i.isNearZero(r,.001)&&(r=a),r<0&&(r+=a),r}return i.clamp(e,0,this.getTotalLength())}getIncludedSectionIdx(e,t){if(t<1)s.assert(!1);else for(let t=0;t<this.railParts.length;t++)if(e<this.railPartCoords[t]||t===this.railParts.length-1)return t;throw"whoops"}getCurrentCtrlPointIndex(e,t){if(e=this.normalizePos(e,1===t?-1:1),i.isNearZero(e,.001))return 0;if(i.isNearZero(this.getTotalLength()-e,.001))return this.isClosed?this.pointRecordCount-1:0;if(0===t){for(let t=0;t<this.railPartCoords.length;t++)if(e<this.railPartCoords[t])return t}else for(let t=this.railPartCoords.length-1;t>=0;t--){if(e>(0===t?0:this.railPartCoords[t-1])&&e<=this.railPartCoords[t])return t+1-((t+1)/this.pointRecordCount|0)*this.pointRecordCount}throw"whoops"}getCoordForRailPartIdx(e,t){const a=e>0?this.railPartCoords[e-1]:0,r=this.railParts[e];return i.clamp(t-a,0,r.getTotalLength())}calcRailDirection(e,t,a){if(t.calcVelocity(e,a),i.isNearZeroVec3(e,.001)){let r,s;a>=.5?(r=a-.1,s=a):(r=a,s=a+.1),t.calcPos(h,r),t.calcPos(e,s),n.vec3.sub(e,e,h)}n.vec3.normalize(e,e)}calcPosDir(e,t,a){a=this.normalizePos(a,1);const r=this.getIncludedSectionIdx(a,1),n=this.railParts[r],s=n.getParam(this.getCoordForRailPartIdx(r,a));n.calcPos(e,s),this.calcRailDirection(t,n,s)}calcPos(e,t){t=this.normalizePos(t,1);const a=this.getIncludedSectionIdx(t,1),r=this.railParts[a],n=r.getParam(this.getCoordForRailPartIdx(a,t));r.calcPos(e,n)}calcDirection(e,t){t=this.normalizePos(t,1);const a=this.getIncludedSectionIdx(t,1),r=this.railParts[a],n=r.getParam(this.getCoordForRailPartIdx(a,t));this.calcRailDirection(e,r,n)}getPartLength(e){return this.railParts[e].getTotalLength()}}function _(e,t){s.assert(S(t));const a=s.assertExists(t.getValueNumber("CommonPath_ID")),r=e.stageDataHolder.findPlacedStageDataHolder(t),[n,i]=r.getCommonPathPointInfo(a);return new g(e,n,i)}function S(e){return 65535!==s.fallback(e.getValueNumberNoInit("CommonPath_ID"),65535)}t.BezierRail=g,t.getBezierRailForActor=_,t.isConnectedWithRail=S;const b=n.vec3.create();t.RailRider=class{constructor(e,t,a){this.actor=t,this.currentPos=n.vec3.create(),this.currentDir=n.vec3.create(),this.currentPointId=-1,this.coord=0,this.speed=0,this.direction=0,this.startPos=n.vec3.create(),this.endPos=n.vec3.create(),s.assert(S(a)),this.bezierRail=_(e,a),this.setCoord(this.bezierRail.getTotalLength()),n.vec3.copy(this.endPos,this.currentPos),this.setCoord(0),n.vec3.copy(this.startPos,this.currentPos)}syncPosDir(){this.coord>0&&this.coord<this.bezierRail.getTotalLength()?this.bezierRail.calcPosDir(this.currentPos,this.currentDir,this.coord):0===this.coord?(this.bezierRail.calcPos(this.currentPos,this.coord),this.bezierRail.calcDirection(this.currentDir,.1)):(this.bezierRail.calcPos(this.currentPos,this.coord),this.bezierRail.calcDirection(this.currentDir,this.bezierRail.getTotalLength()-.1)),1===this.direction&&n.vec3.negate(this.currentDir,this.currentDir),this.currentPointId=this.bezierRail.getCurrentCtrlPointIndex(this.coord,this.direction)}copyPointPos(e,t){this.bezierRail.copyPointPos(e,t)}moveToNearestPoint(e){let t=1/0,a=0;for(let r=0;r<this.bezierRail.railParts.length;r++){this.copyPointPos(h,r);const s=n.vec3.squaredDistance(e,h);s<t&&(t=s,a=r)}this.coord=this.bezierRail.getRailPosCoord(a),this.syncPosDir()}moveToNearestPos(e){this.coord=this.bezierRail.getNearestRailPosCoord(e),this.syncPosDir()}setCoord(e){this.coord=this.bezierRail.normalizePos(e,1),this.syncPosDir()}setSpeed(e){this.speed=e}move(){0===this.direction?this.coord+=this.speed:this.coord-=this.speed,this.coord=this.bezierRail.normalizePos(this.coord,1),this.syncPosDir()}reverse(){this.direction=0===this.direction?1:0,this.syncPosDir()}getTotalLength(){return this.bezierRail.getTotalLength()}getPointNum(){return this.bezierRail.pointRecordCount}isLoop(){return this.bezierRail.isClosed}calcPosAtCoord(e,t){this.bezierRail.calcPos(e,t)}calcDirectionAtCoord(e,t){this.bezierRail.calcDirection(e,t)}isReachedGoal(){if(this.bezierRail.isClosed)return!1;const e=0===this.direction?this.getTotalLength()-this.coord:this.coord;return i.isNearZero(e,.001)}getPointArg(e,t){return this.bezierRail.calcRailCtrlPointIter(e).getValueNumberNoInit(t)}getCurrentPointArg(e){return this.getPointArg(this.currentPointId,e)}getNextPointArg(e){return this.getPointArg(this.getNextPointNo(),e)}getPartLength(e){return this.bezierRail.getPartLength(e)}getCurrentPointCoord(){return this.bezierRail.getRailPosCoord(this.currentPointId)}getPointCoord(e){return this.bezierRail.getRailPosCoord(e)}getNextPointNo(){const e=0===this.direction?1:-1,t=this.bezierRail.railParts.length;return(this.currentPointId+e+t)%t}getNextPointCoord(){return this.bezierRail.getRailPosCoord(this.getNextPointNo())}debugDrawRail(e,t=100){const a=this.getTotalLength()/t,r=o.getDebugOverlayCanvas2D();let s=-1;for(let i=0;i<t;i++){const t=this.bezierRail.normalizePos(i*a,1),c=this.bezierRail.getIncludedSectionIdx(t,1);this.bezierRail.calcPos(b,t),o.drawWorldSpacePoint(r,e,b,c!==s?l.Cyan:l.Magenta,10),s=c,this.bezierRail.calcDirection(d,t),n.vec3.scale(d,d,100),n.vec3.add(d,d,b),o.drawWorldSpaceLine(r,e,b,d,l.Yellow)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(40),n=a(43),s=a(162);class i extends s.AreaObj{getManagerName(){return"Water"}}t.WaterArea=i;class o extends s.AreaObjMgr{constructor(e){super(e,"Water")}}t.WaterAreaMgr=o;class l extends r.NameObj{constructor(e){super(e,"WaterAreaHolder"),this.oceanBowl=[],this.oceanRing=[],n.connectToSceneScreenEffectMovement(e,this)}entryOceanBowl(e){this.oceanBowl.push(e)}entryOceanRing(e){this.oceanRing.push(e)}movement(e,t){super.movement(e,t)}}function c(e,t){if(null!==e.areaObjContainer){if(null!==e.areaObjContainer.getAreaObj("Water",t))return!0}if(null!==e.waterAreaHolder){const a=e.waterAreaHolder;for(let e=0;e<a.oceanBowl.length;e++)if(a.oceanBowl[e].isInWater(t))return!0}return!1}t.WaterAreaHolder=l,t.getWaterAreaObj=c,t.isInWater=function(e,t){return c(e,t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(28),s=a(52),i=a(53),o=a(0),l=a(2),c=a(43),h=a(40),d=r.vec3.create(),u=r.vec3.create(),m=r.vec3.create(),p=r.vec3.create(),f=r.mat4.create();t.GravityInfo=class{constructor(){this.direction=r.vec3.create()}};const A=r.vec3.create(),g=r.vec3.create();class _ extends h.NameObj{constructor(e){super(e,"PlanetGravityManager"),this.gravities=[]}calcTotalGravityVector(e,t,a,n,s){let i=-1;r.vec3.set(A,0,0,0);for(let e=0;e<this.gravities.length;e++){const s=this.gravities[e];if(!(s.typeMask&n))continue;if(s.priority<i)continue;if(!s.calcGravity(g,a))continue;const o=r.vec3.length(g);let l=!1;s.priority===i?(r.vec3.add(A,A,g),o>-1&&(l=!0)):(r.vec3.copy(A,g),i=s.priority,l=!0),null!==t&&l&&(r.vec3.copy(t.direction,g),t.gravity=s,t.priority=s.priority)}return null!==e&&r.vec3.normalize(e,A),i>=0}registerGravity(e){this.gravities.push(e)}}function S(e,t){e.create(50),e.planetGravityManager.registerGravity(t)}t.PlanetGravityManager=_;class b{constructor(){this.range=-1,this.distant=0,this.priority=0,this.id=-1,this.typeMask=1,this.power=1,this.inverse=!1}calcGravity(e,t){let a=this.calcOwnGravityVector(e,t);if(a<0)return!1;a=Math.max(a-this.distant,1);const n=4e6/(a*a);return r.vec3.scale(e,e,n),this.inverse&&r.vec3.negate(e,e),!0}calcGravityFromMassPosition(e,t,a){r.vec3.subtract(e,a,t);const n=r.vec3.length(e);return this.isInRangeDistance(n)?(r.vec3.normalize(e,e),n):-1}isInRangeDistance(e){return this.range<0||e-this.distant<this.range}updateMtx(){}updateIdentityMtx(){this.updateMtx()}generateRandomPoint(e){for(;this.generateOwnRandomPoint(e),!(this.calcOwnGravityVector(d,e)>=0););}}function v(e,t){const a=t.getValueNumberNoInit("Range");null!==a&&(e.range=a);const r=t.getValueNumberNoInit("Distant");null!==r&&(e.distant=r);const n=t.getValueNumberNoInit("Priority");null!==n&&(e.priority=n);const s=t.getValueNumberNoInit("Gravity_id");null!==s&&(e.id=s);const i=t.getValueString("Gravity_type");null!==i&&("Normal"===i?e.typeMask=1:"Shadow"===i?e.typeMask=2:"Magnet"===i&&(e.typeMask=4));const o=t.getValueString("Power");null!==o&&("Light"===o?e.power=0:"Normal"===o?e.power=1:"Heavy"===o&&(e.power=2));const l=t.getValueNumberNoInit("Inverse");null!==l&&(e.inverse=0!==l)}function w(e,t,a=1){e[0]=c.getRandomFloat(-a,a),e[1]=c.getRandomFloat(-a,a),e[2]=c.getRandomFloat(-a,a),r.vec3.transformMat4(e,e,t)}class x extends b{constructor(){super(...arguments),this.rangeType=0,this.baseDistance=2e3,this.boxMtx=null,this.boxExtentsSq=null,this.planeNormal=r.vec3.create(),this.pos=r.vec3.create(),this.distanceCalcType=-1}setPlane(e,t){r.vec3.normalize(this.planeNormal,e),r.vec3.copy(this.pos,t)}setBaseDistance(e){this.baseDistance=e}setDistanceCalcType(e){this.distanceCalcType=e}setRangeType(e){this.rangeType=e}setRangeCylinder(e,t){this.cylinderRangeScaleX=e,this.cylinderRangeScaleY=t}setRangeBox(e){this.boxMtx=r.mat4.clone(e)}updateMtx(){if(1===this.rangeType){const e=o.assertExists(this.boxMtx);this.boxExtentsSq=r.vec3.create(),c.calcMtxAxis(d,u,m,e),this.boxExtentsSq[0]=r.vec3.squaredLength(d),this.boxExtentsSq[1]=r.vec3.squaredLength(u),this.boxExtentsSq[2]=r.vec3.squaredLength(m)}}isInSphereRange(e){if(this.range>=0){return r.vec3.squaredDistance(this.pos,e)<this.range*this.range?this.baseDistance:-1}return this.baseDistance}isInBoxRange(e){const t=this.boxMtx;r.mat4.getTranslation(d,t),r.vec3.subtract(d,e,d);const a=this.boxExtentsSq;l.getMatrixAxisX(u,t);const n=r.vec3.dot(d,u);if(n<-a[0]||n>a[0])return-1;l.getMatrixAxisY(u,t);const s=r.vec3.dot(d,u);if(s<-a[1]||s>a[1])return-1;l.getMatrixAxisZ(u,t);const i=r.vec3.dot(d,u);if(i<-a[2]||i>a[2])return-1;if(-1===this.distanceCalcType)return this.baseDistance;if(0===this.distanceCalcType)return this.baseDistance+Math.abs(n)/Math.sqrt(a[0]);if(1===this.distanceCalcType)return this.baseDistance+Math.abs(s)/Math.sqrt(a[1]);if(2===this.distanceCalcType)return this.baseDistance+Math.abs(i)/Math.sqrt(a[2]);throw"whoops"}isInCylinderRange(e){r.vec3.subtract(d,e,this.pos);const t=r.vec3.dot(this.planeNormal,d);if(t<0||t>this.cylinderRangeScaleY)return-1;r.vec3.scaleAndAdd(d,d,this.planeNormal,-t);const a=r.vec3.length(d);return a>this.cylinderRangeScaleX?-1:this.baseDistance+a}isInRange(e){if(0===this.rangeType)return this.isInSphereRange(e);if(1===this.rangeType)return this.isInBoxRange(e);if(2===this.rangeType)return this.isInCylinderRange(e);throw"whoops"}calcOwnGravityVector(e,t){const a=this.isInRange(t);return a<0?-1:(r.vec3.negate(e,this.planeNormal),a)}generateOwnRandomPoint(e){if(1===this.rangeType){w(e,this.boxMtx)}else if(2===this.rangeType){const t=this.cylinderRangeScaleX,a=this.cylinderRangeScaleY;e[0]=this.pos[0]+c.getRandomFloat(-t,t),e[1]=this.pos[1]+c.getRandomFloat(-a,a),e[2]=this.pos[2]+c.getRandomFloat(-t,t)}else{const t=this.range>=0?this.range:5e4;e[0]=this.pos[0]+c.getRandomFloat(-t,t),e[1]=this.pos[1]+c.getRandomFloat(-t,t),e[2]=this.pos[2]+c.getRandomFloat(-t,t)}}}var T,y;!function(e){e[e.X_Right=1]="X_Right",e[e.X_Left=2]="X_Left",e[e.Y_Right=4]="Y_Right",e[e.Y_Left=8]="Y_Left",e[e.Z_Right=16]="Z_Right",e[e.Z_Left=32]="Z_Left"}(T||(T={})),function(e){e[e.X_Left=0]="X_Left",e[e.X_Inside=1]="X_Inside",e[e.X_Right=2]="X_Right",e[e.Y_Left=0]="Y_Left",e[e.Y_Inside=3]="Y_Inside",e[e.Y_Right=6]="Y_Right",e[e.Z_Left=0]="Z_Left",e[e.Z_Inside=9]="Z_Inside",e[e.Z_Right=18]="Z_Right"}(y||(y={}));class C extends b{constructor(){super(...arguments),this.mtx=r.mat4.create(),this.extents=r.vec3.create(),this.validAreaFlags=63}setCube(e){this.mtx=r.mat4.clone(e)}updateMtx(){this.extents=r.vec3.create(),c.calcMtxAxis(d,u,m,this.mtx),this.extents[0]=r.vec3.length(d),this.extents[1]=r.vec3.length(u),this.extents[2]=r.vec3.length(m)}calcGravityArea(e){l.getMatrixTranslation(d,this.mtx),r.vec3.sub(d,e,d),l.getMatrixAxisX(u,this.mtx);const t=r.vec3.dot(d,u)/this.extents[0];let a=0;if(t>this.extents[0]){if(!(this.validAreaFlags&T.X_Right))return-1;a+=y.X_Right}else if(t>=-this.extents[0])a+=y.X_Inside;else{if(!(this.validAreaFlags&T.X_Left))return-1;a+=y.X_Left}l.getMatrixAxisY(u,this.mtx);const n=r.vec3.dot(d,u)/this.extents[1];if(n>this.extents[1]){if(!(this.validAreaFlags&T.Y_Right))return-1;a+=y.Y_Right}else if(n>=-this.extents[1])a+=y.Y_Inside;else{if(!(this.validAreaFlags&T.Y_Left))return-1;a+=y.Y_Left}l.getMatrixAxisZ(u,this.mtx);const s=r.vec3.dot(d,u)/this.extents[2];if(s>this.extents[2]){if(!(this.validAreaFlags&T.Z_Right))return-1;a+=y.Z_Right}else if(s>=-this.extents[2])a+=y.Z_Inside;else{if(!(this.validAreaFlags&T.Z_Left))return-1;a+=y.Z_Left}return a}calcFaceGravity(e,t,a){if(a===y.X_Left+y.Y_Inside+y.Z_Inside)l.getMatrixAxisX(e,this.mtx);else if(a===y.X_Inside+y.Y_Left+y.Z_Inside)l.getMatrixAxisY(e,this.mtx);else if(a===y.X_Inside+y.Y_Inside+y.Z_Left)l.getMatrixAxisZ(e,this.mtx);else if(a===y.X_Right+y.Y_Inside+y.Z_Inside)l.getMatrixAxisX(e,this.mtx),r.vec3.negate(e,e);else if(a===y.X_Inside+y.Y_Right+y.Z_Inside)l.getMatrixAxisY(e,this.mtx),r.vec3.negate(e,e);else{if(a!==y.X_Inside+y.Y_Inside+y.Z_Right)return-1;l.getMatrixAxisZ(e,this.mtx),r.vec3.negate(e,e)}const n=r.vec3.length(e);return r.vec3.normalize(e,e),l.getMatrixTranslation(d,this.mtx),r.vec3.sub(d,d,t),Math.max(n*r.vec3.dot(d,e),0)}calcEdgeGravity(e,t,a){if(r.vec3.copy(d,l.Vec3Zero),a===y.X_Inside+y.Y_Left+y.Z_Left)l.getMatrixAxisX(u,this.mtx),l.getMatrixAxisY(m,this.mtx),r.vec3.sub(d,d,m),l.getMatrixAxisZ(m,this.mtx),r.vec3.sub(d,d,m);else if(a===y.X_Left+y.Y_Inside+y.Z_Left)l.getMatrixAxisY(u,this.mtx),l.getMatrixAxisX(m,this.mtx),r.vec3.sub(d,d,m),l.getMatrixAxisZ(m,this.mtx),r.vec3.sub(d,d,m);else if(a===y.X_Right+y.Y_Inside+y.Z_Left)l.getMatrixAxisY(u,this.mtx),l.getMatrixAxisX(m,this.mtx),r.vec3.add(d,d,m),l.getMatrixAxisZ(m,this.mtx),r.vec3.sub(d,d,m);else if(a===y.X_Inside+y.Y_Right+y.Z_Left)l.getMatrixAxisX(u,this.mtx),l.getMatrixAxisY(m,this.mtx),r.vec3.add(d,d,m),l.getMatrixAxisZ(m,this.mtx),r.vec3.sub(d,d,m);else if(a===y.X_Left+y.Y_Left+y.Z_Inside)l.getMatrixAxisZ(u,this.mtx),l.getMatrixAxisX(m,this.mtx),r.vec3.sub(d,d,m),l.getMatrixAxisY(m,this.mtx),r.vec3.sub(d,d,m);else if(a===y.X_Right+y.Y_Left+y.Z_Inside)l.getMatrixAxisZ(u,this.mtx),l.getMatrixAxisX(m,this.mtx),r.vec3.add(d,d,m),l.getMatrixAxisY(m,this.mtx),r.vec3.sub(d,d,m);else if(a===y.X_Left+y.Y_Right+y.Z_Inside)l.getMatrixAxisZ(u,this.mtx),l.getMatrixAxisX(m,this.mtx),r.vec3.sub(d,d,m),l.getMatrixAxisY(m,this.mtx),r.vec3.add(d,d,m);else if(a===y.X_Right+y.Y_Right+y.Z_Inside)l.getMatrixAxisZ(u,this.mtx),l.getMatrixAxisX(m,this.mtx),r.vec3.add(d,d,m),l.getMatrixAxisY(m,this.mtx),r.vec3.add(d,d,m);else if(a===y.X_Inside+y.Y_Left+y.Z_Right)l.getMatrixAxisX(u,this.mtx),l.getMatrixAxisY(m,this.mtx),r.vec3.sub(d,d,m),l.getMatrixAxisZ(m,this.mtx),r.vec3.add(d,d,m);else if(a===y.X_Left+y.Y_Inside+y.Z_Right)l.getMatrixAxisY(u,this.mtx),l.getMatrixAxisX(m,this.mtx),r.vec3.sub(d,d,m),l.getMatrixAxisZ(m,this.mtx),r.vec3.add(d,d,m);else if(a===y.X_Right+y.Y_Inside+y.Z_Right)l.getMatrixAxisY(u,this.mtx),l.getMatrixAxisX(m,this.mtx),r.vec3.add(d,d,m),l.getMatrixAxisZ(m,this.mtx),r.vec3.add(d,d,m);else{if(a!==y.X_Inside+y.Y_Right+y.Z_Right)return-1;l.getMatrixAxisX(u,this.mtx),l.getMatrixAxisY(m,this.mtx),r.vec3.add(d,d,m),l.getMatrixAxisZ(m,this.mtx),r.vec3.add(d,d,m)}if(l.getMatrixTranslation(m,this.mtx),r.vec3.add(m,d,m),r.vec3.normalize(u,u),r.vec3.sub(p,m,t),r.vec3.scaleAndAdd(e,p,u,-r.vec3.dot(u,p)),r.vec3.sub(e,e,t),r.vec3.equals(e,l.Vec3Zero))return r.vec3.normalize(e,d),0;{const t=r.vec3.length(e);return r.vec3.normalize(e,e),t}}calcCornerGravity(e,t,a){if(r.vec3.copy(d,l.Vec3Zero),a===y.X_Left+y.Y_Left+y.Z_Left)l.getMatrixAxisX(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisY(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisZ(u,this.mtx),r.vec3.sub(d,d,u);else if(a===y.X_Right+y.Y_Left+y.Z_Left)l.getMatrixAxisX(u,this.mtx),r.vec3.add(d,d,u),l.getMatrixAxisY(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisZ(u,this.mtx),r.vec3.sub(d,d,u);else if(a===y.X_Left+y.Y_Right+y.Z_Left)l.getMatrixAxisX(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisY(u,this.mtx),r.vec3.add(d,d,u),l.getMatrixAxisZ(u,this.mtx),r.vec3.sub(d,d,u);else if(a===y.X_Right+y.Y_Right+y.Z_Left)l.getMatrixAxisX(u,this.mtx),r.vec3.add(d,d,u),l.getMatrixAxisY(u,this.mtx),r.vec3.add(d,d,u),l.getMatrixAxisZ(u,this.mtx),r.vec3.sub(d,d,u);else if(a===y.X_Left+y.Y_Left+y.Z_Right)l.getMatrixAxisX(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisY(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisZ(u,this.mtx),r.vec3.add(d,d,u);else if(a===y.X_Right+y.Y_Left+y.Z_Right)l.getMatrixAxisX(u,this.mtx),r.vec3.add(d,d,u),l.getMatrixAxisY(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisZ(u,this.mtx),r.vec3.add(d,d,u);else if(a===y.X_Left+y.Y_Right+y.Z_Right)l.getMatrixAxisX(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisY(u,this.mtx),r.vec3.add(d,d,u),l.getMatrixAxisZ(u,this.mtx),r.vec3.add(d,d,u);else{if(a!==y.X_Right+y.Y_Right+y.Z_Right)return-1;l.getMatrixAxisX(u,this.mtx),r.vec3.sub(d,d,u),l.getMatrixAxisY(u,this.mtx),r.vec3.add(d,d,u),l.getMatrixAxisZ(u,this.mtx),r.vec3.add(d,d,u)}if(l.getMatrixTranslation(u,this.mtx),r.vec3.add(e,d,u),r.vec3.sub(e,e,t),r.vec3.equals(e,l.Vec3Zero))return r.vec3.normalize(e,d),0;{const t=r.vec3.length(e);return r.vec3.normalize(e,e),t}}calcOwnGravityVector(e,t){const a=this.calcGravityArea(t);if(a<0)return-1;let r=-1;return r<0&&(r=this.calcFaceGravity(e,t,a)),r<0&&(r=this.calcEdgeGravity(e,t,a)),r<0&&(r=this.calcCornerGravity(e,t,a)),r>=0&&this.isInRangeDistance(r)?r:-1}generateOwnRandomPoint(e){const t=this.range>=0?this.range:6;w(e,this.mtx,t)}}class M extends b{constructor(){super(...arguments),this.pos=r.vec3.create()}calcOwnGravityVector(e,t){r.vec3.sub(e,this.pos,t);const a=r.vec3.length(e);return r.vec3.normalize(e,e),this.isInRangeDistance(a)?a:-1}generateOwnRandomPoint(e){e[0]=this.pos[0]+c.getRandomFloat(-this.range,this.range),e[1]=this.pos[1]+c.getRandomFloat(-this.range,this.range),e[2]=this.pos[2]+c.getRandomFloat(-this.range,this.range)}}class U extends b{constructor(){super(...arguments),this.gravityPoints=o.nArray(2,()=>r.vec3.create()),this.sideVector=r.vec3.create(),this.edgeValid=o.nArray(2,()=>!0),this.validSideVector=r.vec3.create(),this.validSideDegree=360,this.validSideCos=-1,this.segmentDirection=r.vec3.create(),this.segmentLength=0}setGravityPoint(e,t){r.vec3.copy(this.gravityPoints[e],t)}setSideVector(e){r.vec3.normalize(this.sideVector,e)}setValidSideDegree(e){this.validSideDegree=e}setEdgeValid(e,t){this.edgeValid[e]=t}updateLocalParam(){const e=.01745*this.validSideDegree*.5;this.validSideCos=Math.cos(e),r.vec3.sub(d,this.gravityPoints[1],this.gravityPoints[0]),r.vec3.normalize(d,d);const t=r.vec3.dot(d,this.sideVector);r.vec3.scaleAndAdd(u,this.sideVector,d,-t),r.mat4.fromRotation(f,e,d),r.vec3.transformMat4(this.validSideVector,u,f)}updateMtx(){this.updateLocalParam(),r.vec3.subtract(d,this.gravityPoints[1],this.gravityPoints[0]),this.segmentLength=r.vec3.length(d),r.vec3.normalize(this.segmentDirection,d)}calcOwnGravityVector(e,t){r.vec3.subtract(d,t,this.gravityPoints[0]);const a=r.vec3.dot(d,this.segmentDirection);if(this.validSideCos>-1&&r.vec3.squaredLength(this.validSideVector)>=0&&(r.vec3.scale(u,this.segmentDirection,a),r.vec3.sub(u,d,u),r.vec3.normalize(u,u),r.vec3.dot(u,this.validSideVector)<this.validSideCos))return-1;if(a>=0&&a<=this.segmentLength)r.vec3.scaleAndAdd(u,this.gravityPoints[0],this.segmentDirection,a);else if(a>=0){if(!this.edgeValid[1])return-1;r.vec3.copy(u,this.gravityPoints[1])}else{if(!this.edgeValid[0])return-1;r.vec3.copy(u,this.gravityPoints[0])}r.vec3.sub(d,u,t);const n=r.vec3.length(d);return this.isInRangeDistance(n)?(r.vec3.normalize(e,d),n):-1}generateOwnRandomPoint(e){r.vec3.lerp(e,this.gravityPoints[0],this.gravityPoints[1],Math.random()),e[0]+=c.getRandomFloat(-this.range,this.range),e[1]+=c.getRandomFloat(-this.range,this.range),e[2]+=c.getRandomFloat(-this.range,this.range)}}class k extends b{constructor(){super(...arguments),this.enableBottom=!1,this.topCutRate=0,this.mtx=r.mat4.create()}setEnableBottom(e){this.enableBottom=e}setTopCutRate(e){this.topCutRate=e}setLocalMatrix(e){r.mat4.copy(this.mtx,e)}updateMtx(){l.getMatrixAxisX(d,this.mtx),this.magX=r.vec3.length(d)}calcOwnGravityVector(e,t){l.getMatrixAxisY(d,this.mtx);const a=r.vec3.length(d);r.vec3.normalize(d,d),l.getMatrixTranslation(u,this.mtx),r.vec3.sub(u,t,u);const n=r.vec3.dot(d,u);if(r.vec3.scaleAndAdd(p,u,d,-n),l.isNearZeroVec3(p,.001)){let t=Math.abs(n);return n>0&&(t=Math.max(0,t-a*(1-this.topCutRate))),this.isInRangeDistance(t)?(r.vec3.scale(e,d,n>0?-1:1),t):-1}{const s=r.vec3.length(p);if(l.getMatrixTranslation(u,this.mtx),r.vec3.scaleAndAdd(m,u,p,this.magX/s),r.vec3.scaleAndAdd(d,u,d,a),n>=0){if(this.topCutRate,c.calcPerpendicFootToLineInside(u,t,m,d),r.vec3.sub(d,u,t),l.isNearZeroVec3(d,.001)){r.vec3.sub(u,u,m),r.vec3.normalize(u,u),r.vec3.negate(p,p);const t=r.vec3.dot(u,p);return r.vec3.scaleAndAdd(u,p,u,-t),l.isNearZeroVec3(u,.001)?r.vec3.negate(e,d):r.vec3.normalize(e,u),0}return!l.isNearZero(a,.001)&&!l.isNearZero(this.magX,.001)&&s<this.magX-n*(this.magX/a)?(r.vec3.sub(e,t,u),r.vec3.normalize(e,e),0):this.calcGravityFromMassPosition(e,t,d)}return this.enableBottom?(c.calcPerpendicFootToLineInside(u,t,u,m),r.vec3.sub(m,u,t),l.isNearZeroVec3(m,.001)?(r.vec3.negate(e,d),0):this.calcGravityFromMassPosition(e,t,u)):-1}}generateOwnRandomPoint(e){w(e,this.mtx)}}class D extends i.LiveActor{constructor(e,t,a,r){super(e,t,s.getObjectName(a)),this.gravity=r}}function I(e,t,a){l.computeModelMatrixSRT(e,1,1,1,a[0],a[1],a[2],t[0],t[1],t[2])}function R(e,t,a,r){l.computeModelMatrixSRT(e,r[0],r[1],r[2],a[0],a[1],a[2],t[0],t[1],t[2])}t.GlobalGravityObj=D,t.createGlobalPlaneGravityObj=function(e,t,a){const r=new x;return i.getJMapInfoRotate(d,t,a),i.getJMapInfoTrans(u,t,a),l.computeModelMatrixR(f,d[0],d[1],d[2]),c.calcMtxAxis(null,d,null,f),r.setPlane(d,u),v(r,a),r.updateIdentityMtx(),S(t,r),new D(e,t,a,r)},t.createGlobalPlaneInBoxGravityObj=function(e,t,a){const s=new x;s.setRangeType(1),i.getJMapInfoTrans(u,t,a),i.getJMapInfoRotate(m,t,a),n.getJMapInfoScale(d,a),r.vec3.scale(d,d,500),I(f,u,m),l.getMatrixAxisY(m,f),s.setPlane(m,u),r.vec3.scaleAndAdd(m,u,m,d[1]),c.setTrans(f,m),c.preScaleMtx(f,d),s.setRangeBox(f);const h=o.fallback(n.getJMapInfoArg0(a),-1);h>=0&&s.setBaseDistance(h);const p=o.fallback(n.getJMapInfoArg1(a),-1);return-1!==p&&s.setDistanceCalcType(p),v(s,a),s.updateIdentityMtx(),S(t,s),new D(e,t,a,s)},t.createGlobalPlaneInCylinderGravityObj=function(e,t,a){const r=new x;return r.setRangeType(2),i.getJMapInfoRotate(d,t,a),i.getJMapInfoTrans(u,t,a),I(f,u,d),l.getMatrixAxisY(d,f),r.setPlane(d,u),n.getJMapInfoScale(d,a),r.setRangeCylinder(500*d[0],500*d[1]),v(r,a),r.updateIdentityMtx(),S(t,r),new D(e,t,a,r)},t.createGlobalPointGravityObj=function(e,t,a){const r=new M;return i.getJMapInfoTrans(r.pos,t,a),n.getJMapInfoScale(d,a),r.distant=500*d[0],v(r,a),r.updateIdentityMtx(),S(t,r),new D(e,t,a,r)},t.createGlobalCubeGravityObj=function(e,t,a){const s=new C;i.getJMapInfoRotate(d,t,a),i.getJMapInfoTrans(u,t,a),n.getJMapInfoScale(m,a),I(f,u,d),l.getMatrixAxisY(d,f),r.vec3.scale(m,m,500),r.vec3.scaleAndAdd(d,u,d,m[1]),c.setTrans(f,d),c.preScaleMtx(f,m),s.setCube(f);let h=0;const p=o.fallback(n.getJMapInfoArg0(a),-1)>>>0;1&p&&(h|=T.X_Left),2&p&&(h|=T.X_Right);const A=o.fallback(n.getJMapInfoArg1(a),-1)>>>0;1&A&&(h|=T.Y_Left),2&A&&(h|=T.Y_Right);const g=o.fallback(n.getJMapInfoArg2(a),-1)>>>0;return 1&g&&(h|=T.Z_Left),2&g&&(h|=T.Z_Right),s.validAreaFlags=h,v(s,a),s.updateIdentityMtx(),S(t,s),new D(e,t,a,s)},t.createGlobalSegmentGravityObj=function(e,t,a){const s=new U;i.getJMapInfoTrans(d,t,a),i.getJMapInfoRotate(u,t,a),n.getJMapInfoScale(m,a),R(f,d,u,m),c.calcMtxAxis(u,m,null,f),s.setGravityPoint(0,d),r.vec3.scaleAndAdd(d,d,m,1e3),s.setGravityPoint(1,d),s.setSideVector(u);const l=o.fallback(n.getJMapInfoArg0(a),-1);0===l?(s.setEdgeValid(0,!1),s.setEdgeValid(1,!1)):1===l?(s.setEdgeValid(0,!0),s.setEdgeValid(1,!1)):2===l?(s.setEdgeValid(0,!1),s.setEdgeValid(1,!0)):3===l&&(s.setEdgeValid(0,!0),s.setEdgeValid(1,!0));const h=o.fallback(n.getJMapInfoArg1(a),-1);return h>=0&&s.setValidSideDegree(h),v(s,a),s.updateIdentityMtx(),S(t,s),new D(e,t,a,s)},t.createGlobalConeGravityObj=function(e,t,a){const s=new k;i.getJMapInfoTrans(d,t,a),i.getJMapInfoRotate(u,t,a),n.getJMapInfoScale(m,a),r.vec3.scale(m,m,500),R(f,d,u,m),s.setLocalMatrix(f);const l=o.fallback(n.getJMapInfoArg0(a),-1);s.setEnableBottom(0!==l);const c=o.fallback(n.getJMapInfoArg1(a),-1);return s.setTopCutRate(c/1e3),v(s,a),s.updateIdentityMtx(),S(t,s),new D(e,t,a,s)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(45)),i=r(a(62)),o=r(a(67)),l=r(a(80)),c=r(a(95)),h=r(a(96)),d=r(a(11)),u=a(68),m=a(0),p=a(1),f=n(a(18)),A=a(4),g=a(9),_=a(7),S=a(23),b=[{numSamplers:3,numUniformBuffers:3}];class v{constructor(e,t,a,r){this.textureHolder=t,this.zsi=a,this.modelCache=r,this.renderTarget=new g.BasicRenderTarget,this.roomRenderers=[],this.renderHelper=new S.GfxRenderHelper(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(.2)}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();r.setBindingLayouts(b),u.fillSceneParamsDataOnTemplate(r,a.camera);for(let r=0;r<this.roomRenderers.length;r++)this.roomRenderers[r].prepareToRender(e,this.renderHelper.renderInstManager,t,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,g.standardFullClearRenderPassDescriptor);_.executeOnPass(this.renderHelper.renderInstManager,e,r,2),e.submitPass(r);const n=this.renderTarget.createRenderPass(e,t.viewport,g.depthClearRenderPassDescriptor);return _.executeOnPass(this.renderHelper.renderInstManager,e,n,1),this.renderHelper.renderInstManager.resetRenderInsts(),n}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.roomRenderers.length;t++)this.roomRenderers[t].destroy(e)}createPanels(){const e=new d.Panel;e.customHeaderBackgroundColor=d.COOL_BLUE_COLOR,e.setTitle(d.RENDER_HACKS_ICON,"Render Hacks");const t=new d.Checkbox("Enable Vertex Colors",!0);t.onchanged=()=>{for(let e=0;e<this.roomRenderers.length;e++)this.roomRenderers[e].setVertexColorsEnabled(t.checked)},e.contents.appendChild(t.elem);const a=new d.Checkbox("Enable Textures",!0);a.onchanged=()=>{for(let e=0;e<this.roomRenderers.length;e++)this.roomRenderers[e].setTexturesEnabled(a.checked)},e.contents.appendChild(a.elem);const r=new d.Checkbox("Grayscale Vertex Colors",!1);r.onchanged=()=>{for(let e=0;e<this.roomRenderers.length;e++)this.roomRenderers[e].setMonochromeVertexColorsEnabled(r.checked)},e.contents.appendChild(r.elem);const n=new d.Checkbox("Show Vertex Normals",!1);n.onchanged=()=>{for(let e=0;e<this.roomRenderers.length;e++)this.roomRenderers[e].setShowVertexNormals(n.checked)},e.contents.appendChild(n.elem);const s=new d.Checkbox("Show Texture Coordinates",!1);return s.onchanged=()=>{for(let e=0;e<this.roomRenderers.length;e++)this.roomRenderers[e].setShowTextureCoordinates(s.checked)},e.contents.appendChild(s.elem),[e,new d.LayerPanel(this.roomRenderers)]}setEnvironmentSettingsIndex(e){for(let t=0;t<this.roomRenderers.length;t++)this.roomRenderers[t].setEnvironmentSettings(this.zsi.environmentSettings[e])}}t.OoT3DRenderer=v;class w{constructor(e){this.dataFetcher=e,this.filePromiseCache=new Map,this.fileDataCache=new Map,this.archivePromiseCache=new Map,this.archiveCache=new Map,this.modelCache=new Map}waitForLoad(){const e=[...this.filePromiseCache.values(),...this.archivePromiseCache.values()];return Promise.all(e)}fetchFile(e,t){m.assert(!this.filePromiseCache.has(e));const a=this.dataFetcher.fetchData(e,t,()=>{this.filePromiseCache.delete(e),this.archivePromiseCache.delete(e)});return this.filePromiseCache.set(e,a),a}fetchFileData(e,t=0){const a=this.filePromiseCache.get(e);return void 0!==a?a.then(()=>this.getFileData(e)):this.fetchFile(e,t).then(t=>(this.fileDataCache.set(e,t),t))}getFileData(e){return m.assertExists(this.fileDataCache.get(e))}getArchive(e){return m.assertExists(this.archiveCache.get(e))}fetchArchive(e){let t=this.archivePromiseCache.get(e);return void 0===t&&(t=this.fetchFileData(e).then(e=>e).then(t=>{const a=l.parse(h.maybeDecompress(t));return this.archiveCache.set(e,a),a}),this.archivePromiseCache.set(e,t)),t}getModel(e,t,a,r){let n=this.modelCache.get(r);if(void 0===n){const i=m.assertExists(l.findFileData(a,r)),o=s.parse(i);t.textureHolder.addTextures(e,o.textures),n=new u.CmbData(e,o),this.modelCache.set(r,n)}return n}destroy(e){for(const t of this.modelCache.values())t.destroy(e)}}var x;t.ModelCache=w,function(e){e[e.Player=0]="Player",e[e.En_Test=2]="En_Test",e[e.En_GirlA=4]="En_GirlA",e[e.En_Part=7]="En_Part",e[e.En_Light=8]="En_Light",e[e.En_Door=9]="En_Door",e[e.En_Box=10]="En_Box",e[e.Bg_Dy_Yoseizo=11]="Bg_Dy_Yoseizo",e[e.Bg_Hidan_Firewall=12]="Bg_Hidan_Firewall",e[e.En_Poh=13]="En_Poh",e[e.En_Okuta=14]="En_Okuta",e[e.Bg_Ydan_Sp=15]="Bg_Ydan_Sp",e[e.En_Bom=16]="En_Bom",e[e.En_Wallmas=17]="En_Wallmas",e[e.En_Dodongo=18]="En_Dodongo",e[e.En_Firefly=19]="En_Firefly",e[e.En_Horse=20]="En_Horse",e[e.En_Item00=21]="En_Item00",e[e.En_Arrow=22]="En_Arrow",e[e.En_Elf=24]="En_Elf",e[e.En_Niw=25]="En_Niw",e[e.En_Tite=27]="En_Tite",e[e.En_Reeba=28]="En_Reeba",e[e.En_Peehat=29]="En_Peehat",e[e.En_Butte=30]="En_Butte",e[e.En_Insect=32]="En_Insect",e[e.En_Fish=33]="En_Fish",e[e.En_Holl=35]="En_Holl",e[e.En_Scene_Change=36]="En_Scene_Change",e[e.En_Zf=37]="En_Zf",e[e.En_Hata=38]="En_Hata",e[e.Boss_Dodongo=39]="Boss_Dodongo",e[e.Boss_Goma=40]="Boss_Goma",e[e.En_Zl1=41]="En_Zl1",e[e.En_Viewer=42]="En_Viewer",e[e.En_Goma=43]="En_Goma",e[e.Bg_Pushbox=44]="Bg_Pushbox",e[e.En_Bubble=45]="En_Bubble",e[e.Door_Shutter=46]="Door_Shutter",e[e.En_Dodojr=47]="En_Dodojr",e[e.En_Bdfire=48]="En_Bdfire",e[e.En_Boom=50]="En_Boom",e[e.En_Torch2=51]="En_Torch2",e[e.En_Bili=52]="En_Bili",e[e.En_Tp=53]="En_Tp",e[e.En_St=55]="En_St",e[e.En_Bw=56]="En_Bw",e[e.En_A_Obj=57]="En_A_Obj",e[e.En_Eiyer=58]="En_Eiyer",e[e.En_River_Sound=59]="En_River_Sound",e[e.En_Horse_Normal=60]="En_Horse_Normal",e[e.En_Ossan=61]="En_Ossan",e[e.Bg_Treemouth=62]="Bg_Treemouth",e[e.Bg_Dodoago=63]="Bg_Dodoago",e[e.Bg_Hidan_Dalm=64]="Bg_Hidan_Dalm",e[e.Bg_Hidan_Hrock=65]="Bg_Hidan_Hrock",e[e.En_Horse_Ganon=66]="En_Horse_Ganon",e[e.Bg_Hidan_Rock=67]="Bg_Hidan_Rock",e[e.Bg_Hidan_Rsekizou=68]="Bg_Hidan_Rsekizou",e[e.Bg_Hidan_Sekizou=69]="Bg_Hidan_Sekizou",e[e.Bg_Hidan_Sima=70]="Bg_Hidan_Sima",e[e.Bg_Hidan_Syoku=71]="Bg_Hidan_Syoku",e[e.En_Xc=72]="En_Xc",e[e.Bg_Hidan_Curtain=73]="Bg_Hidan_Curtain",e[e.Bg_Spot00_Hanebasi=74]="Bg_Spot00_Hanebasi",e[e.En_Mb=75]="En_Mb",e[e.En_Bombf=76]="En_Bombf",e[e.En_Zl2=77]="En_Zl2",e[e.Bg_Hidan_Fslift=78]="Bg_Hidan_Fslift",e[e.En_OE2=79]="En_OE2",e[e.Bg_Ydan_Hasi=80]="Bg_Ydan_Hasi",e[e.Bg_Ydan_Maruta=81]="Bg_Ydan_Maruta",e[e.Boss_Ganondrof=82]="Boss_Ganondrof",e[e.En_Am=84]="En_Am",e[e.En_Dekubaba=85]="En_Dekubaba",e[e.En_M_Fire1=86]="En_M_Fire1",e[e.En_M_Thunder=87]="En_M_Thunder",e[e.Bg_Ddan_Jd=88]="Bg_Ddan_Jd",e[e.Bg_Breakwall=89]="Bg_Breakwall",e[e.En_Jj=90]="En_Jj",e[e.En_Horse_Zelda=91]="En_Horse_Zelda",e[e.Bg_Ddan_Kd=92]="Bg_Ddan_Kd",e[e.Door_Warp1=93]="Door_Warp1",e[e.Obj_Syokudai=94]="Obj_Syokudai",e[e.Item_B_Heart=95]="Item_B_Heart",e[e.En_Dekunuts=96]="En_Dekunuts",e[e.Bg_Menkuri_Kaiten=97]="Bg_Menkuri_Kaiten",e[e.Bg_Menkuri_Eye=98]="Bg_Menkuri_Eye",e[e.En_Vali=99]="En_Vali",e[e.Bg_Mizu_Movebg=100]="Bg_Mizu_Movebg",e[e.Bg_Mizu_Water=101]="Bg_Mizu_Water",e[e.Arms_Hook=102]="Arms_Hook",e[e.En_fHG=103]="En_fHG",e[e.Bg_Mori_Hineri=104]="Bg_Mori_Hineri",e[e.En_Bb=105]="En_Bb",e[e.Bg_Toki_Hikari=106]="Bg_Toki_Hikari",e[e.En_Yukabyun=107]="En_Yukabyun",e[e.Bg_Toki_Swd=108]="Bg_Toki_Swd",e[e.En_Fhg_Fire=109]="En_Fhg_Fire",e[e.Bg_Mjin=110]="Bg_Mjin",e[e.Bg_Hidan_Kousi=111]="Bg_Hidan_Kousi",e[e.Door_Toki=112]="Door_Toki",e[e.Bg_Hidan_Hamstep=113]="Bg_Hidan_Hamstep",e[e.En_Bird=114]="En_Bird",e[e.En_Wood02=119]="En_Wood02",e[e.En_Lightbox=124]="En_Lightbox",e[e.En_Pu_box=125]="En_Pu_box",e[e.En_Trap=128]="En_Trap",e[e.En_Arow_Trap=129]="En_Arow_Trap",e[e.En_Vase=130]="En_Vase",e[e.En_Ta=132]="En_Ta",e[e.En_Tk=133]="En_Tk",e[e.Bg_Mori_Bigst=134]="Bg_Mori_Bigst",e[e.Bg_Mori_Elevator=135]="Bg_Mori_Elevator",e[e.Bg_Mori_Kaitenkabe=136]="Bg_Mori_Kaitenkabe",e[e.Bg_Mori_Rakkatenjo=137]="Bg_Mori_Rakkatenjo",e[e.En_Vm=138]="En_Vm",e[e.Demo_Effect=139]="Demo_Effect",e[e.Demo_Kankyo=140]="Demo_Kankyo",e[e.Bg_Hidan_Fwbig=141]="Bg_Hidan_Fwbig",e[e.En_Floormas=142]="En_Floormas",e[e.En_Heishi1=143]="En_Heishi1",e[e.En_Rd=144]="En_Rd",e[e.En_Po_Sisters=145]="En_Po_Sisters",e[e.Bg_Heavy_Block=146]="Bg_Heavy_Block",e[e.Bg_Po_Event=147]="Bg_Po_Event",e[e.Obj_Mure=148]="Obj_Mure",e[e.En_Sw=149]="En_Sw",e[e.Boss_Fd=150]="Boss_Fd",e[e.Object_Kankyo=151]="Object_Kankyo",e[e.En_Du=152]="En_Du",e[e.En_Fd=153]="En_Fd",e[e.En_Horse_Link_Child=154]="En_Horse_Link_Child",e[e.Door_Ana=155]="Door_Ana",e[e.Bg_Spot02_Objects=156]="Bg_Spot02_Objects",e[e.Bg_Haka=157]="Bg_Haka",e[e.Magic_Wind=158]="Magic_Wind",e[e.Magic_Fire=159]="Magic_Fire",e[e.En_Ru1=161]="En_Ru1",e[e.Boss_Fd2=162]="Boss_Fd2",e[e.En_Fd_Fire=163]="En_Fd_Fire",e[e.En_Dh=164]="En_Dh",e[e.En_Dha=165]="En_Dha",e[e.En_Rl=166]="En_Rl",e[e.En_Encount1=167]="En_Encount1",e[e.Demo_Du=168]="Demo_Du",e[e.Demo_Im=169]="Demo_Im",e[e.Demo_Tre_Lgt=170]="Demo_Tre_Lgt",e[e.En_Fw=171]="En_Fw",e[e.Bg_Vb_Sima=172]="Bg_Vb_Sima",e[e.En_Vb_Ball=173]="En_Vb_Ball",e[e.Bg_Haka_Megane=174]="Bg_Haka_Megane",e[e.Bg_Haka_MeganeBG=175]="Bg_Haka_MeganeBG",e[e.Bg_Haka_Ship=176]="Bg_Haka_Ship",e[e.Bg_Haka_Sgami=177]="Bg_Haka_Sgami",e[e.En_Heishi2=179]="En_Heishi2",e[e.En_Encount2=180]="En_Encount2",e[e.En_Fire_Rock=181]="En_Fire_Rock",e[e.En_Brob=182]="En_Brob",e[e.Mir_Ray=183]="Mir_Ray",e[e.Bg_Spot09_Obj=184]="Bg_Spot09_Obj",e[e.Bg_Spot18_Obj=185]="Bg_Spot18_Obj",e[e.Boss_Va=186]="Boss_Va",e[e.Bg_Haka_Tubo=187]="Bg_Haka_Tubo",e[e.Bg_Haka_Trap=188]="Bg_Haka_Trap",e[e.Bg_Haka_Huta=189]="Bg_Haka_Huta",e[e.Bg_Haka_Zou=190]="Bg_Haka_Zou",e[e.Bg_Spot17_Funen=191]="Bg_Spot17_Funen",e[e.En_Syateki_Itm=192]="En_Syateki_Itm",e[e.En_Syateki_Man=193]="En_Syateki_Man",e[e.En_Tana=194]="En_Tana",e[e.En_Nb=195]="En_Nb",e[e.Boss_Mo=196]="Boss_Mo",e[e.En_Sb=197]="En_Sb",e[e.En_Bigokuta=198]="En_Bigokuta",e[e.En_Karebaba=199]="En_Karebaba",e[e.Bg_Bdan_Objects=200]="Bg_Bdan_Objects",e[e.Demo_Sa=201]="Demo_Sa",e[e.Demo_Go=202]="Demo_Go",e[e.En_In=203]="En_In",e[e.En_Tr=204]="En_Tr",e[e.Bg_Spot16_Bombstone=205]="Bg_Spot16_Bombstone",e[e.Bg_Hidan_Kowarerukabe=207]="Bg_Hidan_Kowarerukabe",e[e.Bg_Bombwall=208]="Bg_Bombwall",e[e.Bg_Spot08_Iceblock=209]="Bg_Spot08_Iceblock",e[e.En_Ru2=210]="En_Ru2",e[e.Obj_Dekujr=211]="Obj_Dekujr",e[e.Bg_Mizu_Uzu=212]="Bg_Mizu_Uzu",e[e.Bg_Spot06_Objects=213]="Bg_Spot06_Objects",e[e.Bg_Ice_Objects=214]="Bg_Ice_Objects",e[e.Bg_Haka_Water=215]="Bg_Haka_Water",e[e.En_Ma2=217]="En_Ma2",e[e.En_Bom_Chu=218]="En_Bom_Chu",e[e.En_Horse_Game_Check=219]="En_Horse_Game_Check",e[e.Boss_Tw=220]="Boss_Tw",e[e.En_Rr=221]="En_Rr",e[e.En_Ba=222]="En_Ba",e[e.En_Bx=223]="En_Bx",e[e.En_Anubice=224]="En_Anubice",e[e.En_Anubice_Fire=225]="En_Anubice_Fire",e[e.Bg_Mori_Hashigo=226]="Bg_Mori_Hashigo",e[e.Bg_Mori_Hashira4=227]="Bg_Mori_Hashira4",e[e.Bg_Mori_Idomizu=228]="Bg_Mori_Idomizu",e[e.Bg_Spot16_Doughnut=229]="Bg_Spot16_Doughnut",e[e.Bg_Bdan_Switch=230]="Bg_Bdan_Switch",e[e.En_Ma1=231]="En_Ma1",e[e.Boss_Ganon=232]="Boss_Ganon",e[e.Boss_Sst=233]="Boss_Sst",e[e.En_Ny=236]="En_Ny",e[e.En_Fr=237]="En_Fr",e[e.Item_Shield=238]="Item_Shield",e[e.Bg_Ice_Shelter=239]="Bg_Ice_Shelter",e[e.En_Ice_Hono=240]="En_Ice_Hono",e[e.Item_Ocarina=241]="Item_Ocarina",e[e.Magic_Dark=244]="Magic_Dark",e[e.Demo_6K=245]="Demo_6K",e[e.En_Anubice_Tag=246]="En_Anubice_Tag",e[e.Bg_Haka_Gate=247]="Bg_Haka_Gate",e[e.Bg_Spot15_Saku=248]="Bg_Spot15_Saku",e[e.Bg_Jya_Goroiwa=249]="Bg_Jya_Goroiwa",e[e.Bg_Jya_Zurerukabe=250]="Bg_Jya_Zurerukabe",e[e.Bg_Jya_Cobra=252]="Bg_Jya_Cobra",e[e.Bg_Jya_Kanaami=253]="Bg_Jya_Kanaami",e[e.Fishing=254]="Fishing",e[e.Obj_Oshihiki=255]="Obj_Oshihiki",e[e.Bg_Gate_Shutter=256]="Bg_Gate_Shutter",e[e.Eff_Dust=257]="Eff_Dust",e[e.Bg_Spot01_Fusya=258]="Bg_Spot01_Fusya",e[e.Bg_Spot01_Idohashira=259]="Bg_Spot01_Idohashira",e[e.Bg_Spot01_Idomizu=260]="Bg_Spot01_Idomizu",e[e.Bg_Po_Syokudai=261]="Bg_Po_Syokudai",e[e.Bg_Ganon_Otyuka=262]="Bg_Ganon_Otyuka",e[e.Bg_Spot15_Rrbox=263]="Bg_Spot15_Rrbox",e[e.Bg_Umajump=264]="Bg_Umajump",e[e.Arrow_Fire=266]="Arrow_Fire",e[e.Arrow_Ice=267]="Arrow_Ice",e[e.Arrow_Light=268]="Arrow_Light",e[e.Item_Etcetera=271]="Item_Etcetera",e[e.Obj_Kibako=272]="Obj_Kibako",e[e.Obj_Tsubo=273]="Obj_Tsubo",e[e.En_Wonder_Item=274]="En_Wonder_Item",e[e.En_Ik=275]="En_Ik",e[e.Demo_Ik=276]="Demo_Ik",e[e.En_Skj=277]="En_Skj",e[e.En_Skjneedle=278]="En_Skjneedle",e[e.En_G_Switch=279]="En_G_Switch",e[e.Demo_Ext=280]="Demo_Ext",e[e.Demo_Shd=281]="Demo_Shd",e[e.En_Dns=282]="En_Dns",e[e.Elf_Msg=283]="Elf_Msg",e[e.En_Honotrap=284]="En_Honotrap",e[e.En_Tubo_Trap=285]="En_Tubo_Trap",e[e.Obj_Ice_Poly=286]="Obj_Ice_Poly",e[e.Bg_Spot03_Taki=287]="Bg_Spot03_Taki",e[e.Bg_Spot07_Taki=288]="Bg_Spot07_Taki",e[e.En_Fz=289]="En_Fz",e[e.En_Po_Relay=290]="En_Po_Relay",e[e.Bg_Relay_Objects=291]="Bg_Relay_Objects",e[e.En_Diving_Game=292]="En_Diving_Game",e[e.En_Kusa=293]="En_Kusa",e[e.Obj_Bean=294]="Obj_Bean",e[e.Obj_Bombiwa=295]="Obj_Bombiwa",e[e.Obj_Switch=298]="Obj_Switch",e[e.Obj_Elevator=299]="Obj_Elevator",e[e.Obj_Lift=300]="Obj_Lift",e[e.Obj_Hsblock=301]="Obj_Hsblock",e[e.En_Okarina_Tag=302]="En_Okarina_Tag",e[e.En_Yabusame_Mark=303]="En_Yabusame_Mark",e[e.En_Goroiwa=304]="En_Goroiwa",e[e.En_Ex_Ruppy=305]="En_Ex_Ruppy",e[e.En_Toryo=306]="En_Toryo",e[e.En_Daiku=307]="En_Daiku",e[e.En_Nwc=309]="En_Nwc",e[e.En_Blkobj=310]="En_Blkobj",e[e.Item_Inbox=311]="Item_Inbox",e[e.En_Ge1=312]="En_Ge1",e[e.Obj_Blockstop=313]="Obj_Blockstop",e[e.En_Sda=314]="En_Sda",e[e.En_Clear_Tag=315]="En_Clear_Tag",e[e.En_Niw_Lady=316]="En_Niw_Lady",e[e.En_Gm=317]="En_Gm",e[e.En_Ms=318]="En_Ms",e[e.En_Hs=319]="En_Hs",e[e.Bg_Ingate=320]="Bg_Ingate",e[e.En_Kanban=321]="En_Kanban",e[e.En_Heishi3=322]="En_Heishi3",e[e.En_Syateki_Niw=323]="En_Syateki_Niw",e[e.En_Attack_Niw=324]="En_Attack_Niw",e[e.Bg_Spot01_Idosoko=325]="Bg_Spot01_Idosoko",e[e.En_Sa=326]="En_Sa",e[e.En_Wonder_Talk=327]="En_Wonder_Talk",e[e.Bg_Gjyo_Bridge=328]="Bg_Gjyo_Bridge",e[e.En_Ds=329]="En_Ds",e[e.En_Mk=330]="En_Mk",e[e.En_Bom_Bowl_Man=331]="En_Bom_Bowl_Man",e[e.En_Bom_Bowl_Pit=332]="En_Bom_Bowl_Pit",e[e.En_Owl=333]="En_Owl",e[e.En_Ishi=334]="En_Ishi",e[e.Obj_Hana=335]="Obj_Hana",e[e.Obj_Lightswitch=336]="Obj_Lightswitch",e[e.Obj_Mure2=337]="Obj_Mure2",e[e.En_Go=338]="En_Go",e[e.En_Fu=339]="En_Fu",e[e.En_Changer=341]="En_Changer",e[e.Bg_Jya_Megami=342]="Bg_Jya_Megami",e[e.Bg_Jya_Lift=343]="Bg_Jya_Lift",e[e.Bg_Jya_Bigmirror=344]="Bg_Jya_Bigmirror",e[e.Bg_Jya_Bombchuiwa=345]="Bg_Jya_Bombchuiwa",e[e.Bg_Jya_Amishutter=346]="Bg_Jya_Amishutter",e[e.Bg_Jya_Bombiwa=347]="Bg_Jya_Bombiwa",e[e.Bg_Spot18_Basket=348]="Bg_Spot18_Basket",e[e.En_Ganon_Organ=350]="En_Ganon_Organ",e[e.En_Siofuki=351]="En_Siofuki",e[e.En_Stream=352]="En_Stream",e[e.En_Mm=354]="En_Mm",e[e.En_Ko=355]="En_Ko",e[e.En_Kz=356]="En_Kz",e[e.En_Weather_Tag=357]="En_Weather_Tag",e[e.Bg_Sst_Floor=358]="Bg_Sst_Floor",e[e.En_Ani=359]="En_Ani",e[e.En_Ex_Item=360]="En_Ex_Item",e[e.Bg_Jya_Ironobj=361]="Bg_Jya_Ironobj",e[e.En_Js=362]="En_Js",e[e.En_Jsjutan=363]="En_Jsjutan",e[e.En_Cs=364]="En_Cs",e[e.En_Md=365]="En_Md",e[e.En_Hy=366]="En_Hy",e[e.En_Ganon_Mant=367]="En_Ganon_Mant",e[e.En_Okarina_Effect=368]="En_Okarina_Effect",e[e.En_Mag=369]="En_Mag",e[e.Door_Gerudo=370]="Door_Gerudo",e[e.Elf_Msg2=371]="Elf_Msg2",e[e.Demo_Gt=372]="Demo_Gt",e[e.En_Po_Field=373]="En_Po_Field",e[e.Efc_Erupc=374]="Efc_Erupc",e[e.Bg_Zg=375]="Bg_Zg",e[e.En_Heishi4=376]="En_Heishi4",e[e.En_Zl3=377]="En_Zl3",e[e.Boss_Ganon2=378]="Boss_Ganon2",e[e.En_Kakasi=379]="En_Kakasi",e[e.En_Takara_Man=380]="En_Takara_Man",e[e.Obj_Makeoshihiki=381]="Obj_Makeoshihiki",e[e.Oceff_Spot=382]="Oceff_Spot",e[e.End_Title=383]="End_Title",e[e.En_Torch=385]="En_Torch",e[e.Demo_Ec=386]="Demo_Ec",e[e.Shot_Sun=387]="Shot_Sun",e[e.En_Dy_Extra=388]="En_Dy_Extra",e[e.En_Wonder_Talk2=389]="En_Wonder_Talk2",e[e.En_Ge2=390]="En_Ge2",e[e.Obj_Roomtimer=391]="Obj_Roomtimer",e[e.En_Ssh=392]="En_Ssh",e[e.En_Sth=393]="En_Sth",e[e.Oceff_Wipe=394]="Oceff_Wipe",e[e.Oceff_Storm=395]="Oceff_Storm",e[e.En_Weiyer=396]="En_Weiyer",e[e.Bg_Spot05_Soko=397]="Bg_Spot05_Soko",e[e.Bg_Jya_1flift=398]="Bg_Jya_1flift",e[e.Bg_Jya_Haheniron=399]="Bg_Jya_Haheniron",e[e.Bg_Spot12_Gate=400]="Bg_Spot12_Gate",e[e.Bg_Spot12_Saku=401]="Bg_Spot12_Saku",e[e.En_Hintnuts=402]="En_Hintnuts",e[e.En_Nutsball=403]="En_Nutsball",e[e.Bg_Spot00_Break=404]="Bg_Spot00_Break",e[e.En_Shopnuts=405]="En_Shopnuts",e[e.En_It=406]="En_It",e[e.En_GeldB=407]="En_GeldB",e[e.Oceff_Wipe2=408]="Oceff_Wipe2",e[e.Oceff_Wipe3=409]="Oceff_Wipe3",e[e.En_Niw_Girl=410]="En_Niw_Girl",e[e.En_Dog=411]="En_Dog",e[e.En_Si=412]="En_Si",e[e.Bg_Spot01_Objects2=413]="Bg_Spot01_Objects2",e[e.Obj_Comb=414]="Obj_Comb",e[e.Bg_Spot11_Bakudankabe=415]="Bg_Spot11_Bakudankabe",e[e.Obj_Kibako2=416]="Obj_Kibako2",e[e.En_Dnt_Demo=417]="En_Dnt_Demo",e[e.En_Dnt_Jiji=418]="En_Dnt_Jiji",e[e.En_Dnt_Nomal=419]="En_Dnt_Nomal",e[e.En_Guest=420]="En_Guest",e[e.Bg_Bom_Guard=421]="Bg_Bom_Guard",e[e.En_Hs2=422]="En_Hs2",e[e.Demo_Kekkai=423]="Demo_Kekkai",e[e.Bg_Spot08_Bakudankabe=424]="Bg_Spot08_Bakudankabe",e[e.Bg_Spot17_Bakudankabe=425]="Bg_Spot17_Bakudankabe",e[e.Obj_Mure3=427]="Obj_Mure3",e[e.En_Tg=428]="En_Tg",e[e.En_Mu=429]="En_Mu",e[e.En_Go2=430]="En_Go2",e[e.En_Wf=431]="En_Wf",e[e.En_Skb=432]="En_Skb",e[e.Demo_Gj=433]="Demo_Gj",e[e.Demo_Geff=434]="Demo_Geff",e[e.Bg_Gnd_Firemeiro=435]="Bg_Gnd_Firemeiro",e[e.Bg_Gnd_Darkmeiro=436]="Bg_Gnd_Darkmeiro",e[e.Bg_Gnd_Soulmeiro=437]="Bg_Gnd_Soulmeiro",e[e.Bg_Gnd_Nisekabe=438]="Bg_Gnd_Nisekabe",e[e.Bg_Gnd_Iceblock=439]="Bg_Gnd_Iceblock",e[e.En_Gb=440]="En_Gb",e[e.En_Gs=441]="En_Gs",e[e.Bg_Mizu_Bwall=442]="Bg_Mizu_Bwall",e[e.Bg_Mizu_Shutter=443]="Bg_Mizu_Shutter",e[e.En_Daiku_Kakariko=444]="En_Daiku_Kakariko",e[e.Bg_Bowl_Wall=445]="Bg_Bowl_Wall",e[e.En_Wall_Tubo=446]="En_Wall_Tubo",e[e.En_Po_Desert=447]="En_Po_Desert",e[e.En_Crow=448]="En_Crow",e[e.Door_Killer=449]="Door_Killer",e[e.Bg_Spot11_Oasis=450]="Bg_Spot11_Oasis",e[e.Bg_Spot18_Futa=451]="Bg_Spot18_Futa",e[e.Bg_Spot18_Shutter=452]="Bg_Spot18_Shutter",e[e.En_Ma3=453]="En_Ma3",e[e.En_Cow=454]="En_Cow",e[e.Bg_Ice_Turara=455]="Bg_Ice_Turara",e[e.Bg_Ice_Shutter=456]="Bg_Ice_Shutter",e[e.En_Kakasi2=457]="En_Kakasi2",e[e.En_Kakasi3=458]="En_Kakasi3",e[e.Oceff_Wipe4=459]="Oceff_Wipe4",e[e.En_Eg=460]="En_Eg",e[e.Bg_Menkuri_Nisekabe=461]="Bg_Menkuri_Nisekabe",e[e.En_Zo=462]="En_Zo",e[e.Obj_Makekinsuta=463]="Obj_Makekinsuta",e[e.En_Ge3=464]="En_Ge3",e[e.Obj_Timeblock=465]="Obj_Timeblock",e[e.Obj_Hamishi=466]="Obj_Hamishi",e[e.En_Zl4=467]="En_Zl4",e[e.En_Mm2=468]="En_Mm2",e[e.Bg_Jya_Block=469]="Bg_Jya_Block",e[e.Obj_Warp2block=470]="Obj_Warp2block",e[e.Grezzo_DekuTreeWeb=471]="Grezzo_DekuTreeWeb",e[e.Grezzo_Hintstone=473]="Grezzo_Hintstone"}(x||(x={}));class T{constructor(e,t){this.modelCache=e,this.textureHolder=t}destroy(e){this.modelCache.destroy(e),this.textureHolder.destroy(e)}}class y{constructor(e,t,a=-1){this.id=e,this.name=t,this.setupIndex=a}async spawnActorForRoom(e,t,a,r,n,s){function c(e){return a.modelCache.fetchArchive(`oot3d/actor/${e}`)}function h(t,s,i=.01){const o=a.modelCache.getModel(e,a,t,s),l=new u.CmbInstance(e,a.textureHolder,o);return l.animationController.fps=20,l.setConstantColor(1,A.TransparentBlack),l.name=`${m.hexzero(n.actorId,4)} / ${m.hexzero(n.variable,4)} / ${s}`,p.mat4.scale(l.modelMatrix,n.modelMatrix,[i,i,i]),r.objectRenderers.push(l),l}function d(e,t){return o.parse(0,m.assertExists(l.findFileData(e,t)))}function g(t,r){const n=i.parse(0,m.assertExists(l.findFileData(t,r)));return a.textureHolder.addTextures(e,n.textures),n}if(n.actorId===x.En_Item00){const e=await c("zelda_keep.zar"),t=255&n.variable;if(0===t||1===t||2===t){const a=h(e,"item00/model/drop_gi_rupy.cmb",.015);a.setVertexColorScale(.5),a.modelMatrix[13]+=10;for(let e=0;e<a.shapeInstances.length;e++)a.shapeInstances[e].visible=!1;const r=t;a.shapeInstances[r].visible=!0}else if(3===t){h(e,"item00/model/drop_gi_heart.cmb",.04).setVertexColorScale(.5)}else if(6===t){h(e,"item00/model/drop_gi_hearts_1.cmb",.05).setVertexColorScale(.5)}else console.warn(`Unknown Item00 drop: ${m.hexzero(n.variable,4)}`)}else if(n.actorId===x.Bg_Haka_Trap){const e=await c("zelda_haka_objects.zar"),t=15&n.variable;if(0===t)h(e,"model/m_Hgiro_model.cmb",.1);else if(1===t)h(e,"model/m_Hkenzan_model.cmb",.1);else if(2===t)h(e,"model/m_HhasamiN_model.cmb",.1);else if(3===t)h(e,"model/m_HhasamiS_model.cmb",.1);else if(4===t)h(e,"model/m_Hfofo_model.cmb",.1);else{if(5!==t)throw"whoops";h(e,"model/m_Hgiro_model.cmb",.1)}}else if(n.actorId===x.Demo_Gj){const e=await c("zelda_gj.zar"),t=65535&n.variable;65284===t?h(e,"model/ganon_b1_model.cmb",.1):65288===t?h(e,"model/ganon_b2_1_model.cmb",.1):65289===t?h(e,"model/ganon_b2_2_model.cmb",.1):65290===t?h(e,"model/ganon_b2_3_model.cmb",.1):65291===t?h(e,"model/ganon_b2_4_model.cmb",.1):65292===t?h(e,"model/ganon_b2_5_model.cmb",.1):65293===t?h(e,"model/ganon_b2_6_model.cmb",.1):65294===t&&h(e,"model/ganon_b2_7_model.cmb",.1)}else if(n.actorId===x.Bg_Haka_Megane){const e=await c("zelda_haka_objects.zar"),t=15&n.variable;3===t?h(e,"model/m_HADsec00_model.cmb",.1):4===t?h(e,"model/m_HADsec02_model.cmb",.1):5===t?console.warn("unimplemented: Bg_Haka_Megane 0x05"):6===t?h(e,"model/m_HADsec05_model.cmb",.1):7===t?console.warn("unimplemented: Bg_Haka_Megane 0x07"):8===t?console.warn("unimplemented: Bg_Haka_Megane 0x08"):9===t?h(e,"model/m_HADsec12_model.cmb",.1):10===t?console.warn("unimplemented: Bg_Haka_Megane 0x0A"):11===t?console.warn("unimplemented: Bg_Haka_Megane 0x0B"):12===t?h(e,"model/m_HADinv0b_model.cmb",.1):console.warn(`unimplemented: Bg_Haka_Megane ${m.hexzero(t,8)}`)}else if(n.actorId===x.Bg_Haka_Sgami){const e=65535&n.variable;if(0===e){h(await c("zelda_haka_objects.zar"),"model/m_Hsgami_model.cmb",.1)}else if(1===e){h(await c("zelda_haka_objects.zar"),"model/m_Hsgami_model.cmb",.1)}else{if(256!==e)throw"whoops";h(await c("zelda_ice_objects.zar"),"model/ice_trap_model.cmb",.1)}}else if(n.actorId===x.Bg_Haka_Ship)h(await c("zelda_haka_objects.zar"),"model/m_Hship_model.cmb",.1);else if(n.actorId===x.En_Kusa)h(await c("zelda_field_keep.zar"),"model/grass05_model.cmb",.4);else if(n.actorId===x.En_Kanban){h(await c("zelda_keep.zar"),"objects/model/kanban1_model.cmb").modelMatrix[13]-=16}else if(n.actorId===x.En_Gs)h(await c("zelda_gs.zar"),"model/gossip_stone2_model.cmb",.1);else if(n.actorId===x.Obj_Tsubo)h(await c("zelda_tsubo.zar"),"model/tubo2_model.cmb",.15);else if(n.actorId===x.Obj_Kibako2)h(await c("zelda_kibako2.zar"),"model/CIkibako_model.cmb",.1);else if(n.actorId===x.En_Box){const e=h(await c("zelda_box.zar"),"model/tr_box.cmb",.005);function _(t){e.shapeInstances[0].visible=0===t,e.shapeInstances[1].visible=1===t||2===t,e.shapeInstances[2].visible=0===t,e.shapeInstances[3].visible=1===t||2===t,0!==t&&2!==t||p.mat4.scale(e.modelMatrix,e.modelMatrix,[2,2,2])}const t=n.variable>>>12&15;if(0===t)_(2);else if(1===t)_(2);else if(2===t)_(0);else if(3===t)_(2);else if(4===t)_(2);else if(5===t)_(1);else if(6===t)_(1);else if(7===t)_(1);else if(8===t)_(1);else if(9===t)_(2);else if(10===t)_(2);else if(11===t)_(2);else{if(12!==t)throw"Starschulz";_(2)}}else if(n.actorId===x.En_Door){h(await c("zelda_keep.zar"),"door/model/obj_door_omote_model.cmb")}else if(n.actorId===x.Obj_Syokudai){const e=await c("zelda_syokudai.zar"),t=n.variable>>>12&3;if(0===t)h(e,"model/syokudai_model.cmb",1);else if(1===t)h(e,"model/syokudai_ki_model.cmb",1);else if(2===t)h(e,"model/syokudai_isi_model.cmb",1);else if(3!==t)throw"Starschulz"}else if(n.actorId===x.Bg_Bowl_Wall){const e=await c("zelda_bowl.zar"),t=15&n.variable;if(0===t){h(e,"model/bowling_p1_model.cmb",1).bindCMAB(g(e,"misc/bowling_p1_model.cmab"))}else{if(1!==t)throw"Starschulz";h(e,"model/bowling_p2_model.cmb",1).bindCMAB(g(e,"misc/bowling_p2_model.cmab"))}}else if(n.actorId===x.En_Tana){const e=await c("zelda_shop_tana.zar"),t=15&n.variable;if(0===t)h(e,"model/shop_tana01_model.cmb",1);else if(1===t)h(e,"model/shop_tana02_model.cmb",1);else{if(2!==t)throw"Starschulz";h(e,"model/shop_tana03_model.cmb",1)}}else if(n.actorId===x.Bg_Bdan_Objects){const e=await c("zelda_bdan_objects.zar"),t=15&n.variable;if(0===t)h(e,"model/bdan_toge_model.cmb",.1);else if(1===t)h(e,"model/bdan_ere_model.cmb",.1);else if(2===t)h(e,"model/bdan_bmizu_modelT.cmb",.1);else{if(3!==t)throw"Starschulz";h(e,"model/bdan_fdai_model.cmb",.1)}}else if(n.actorId===x.Bg_Bdan_Switch){const e=await c("zelda_bdan_objects.zar"),t=15&n.variable;if(0===t)h(e,"model/bdan_switch_b_model.cmb",.1);else if(1===t)h(e,"model/bdan_switch_y_model.cmb",.1);else if(2===t)h(e,"model/bdan_switch_y_model.cmb",.1);else if(3===t)h(e,"model/bdan_switch_y_model.cmb",.1);else{if(4!==t)throw"Starschulz";h(e,"model/bdan_switch_y_model.cmb",.1)}}else if(n.actorId===x.En_Bombf){const e=await c("zelda_bombf.zar");h(e,"model/bm_flower_model.cmb",.01).modelMatrix[13]+=10,h(e,"model/bm_leaf_model.cmb",.01),h(e,"model/bm_leaf2_model.cmb",.01)}else if(n.actorId===x.En_Zf){const e=await c("zelda_zf.zar"),t=255&n.variable;if(0===t){h(e,"model/rezsulfos.cmb",.02).bindCSAB(d(e,"anim/zf_matsu.csab"))}else if(1===t){h(e,"model/rezsulfos.cmb",.02).bindCSAB(d(e,"anim/zf_matsu.csab"))}else if(128===t){h(e,"model/rezsulfos.cmb",.02).bindCSAB(d(e,"anim/zf_matsu.csab"))}else if(254===t){h(e,"model/dynafos.cmb",.02).bindCSAB(d(e,"anim/zf_matsu.csab"))}else{if(255!==t)throw"Starschulz";h(e,"model/rezsulfos.cmb",.02).bindCSAB(d(e,"anim/zf_matsu.csab"))}}else if(n.actorId===x.Bg_Po_Syokudai)h(await c("zelda_syokudai.zar"),"model/syokudai_model.cmb",1);else if(n.actorId===x.Obj_Hsblock){const e=await c("zelda_d_hsblock.zar"),t=15&n.variable;if(0===t)h(e,"model/field_fshot_model.cmb",.1);else if(1===t)h(e,"model/field_fshot_model.cmb",.1);else{if(2!==t)throw"starschulz";h(e,"model/field_fshot2_model.cmb",.1)}}else if(n.actorId===x.Bg_Gate_Shutter){h(await c("zelda_spot01_matoyab.zar"),"model/c_s01tomegate_model.cmb",1).setVertexColorScale(.5)}else if(n.actorId===x.Obj_Mure2){const e=await c("zelda_field_keep.zar"),t=15&n.variable;if(0===t){h(e,"model/grass05_model.cmb",.4)}else if(1===t){h(e,"model/grass05_model.cmb",.4)}else{if(2!==t)throw"starschulz";{const t=h(e,"model/obj_isi01_model.cmb",.1);t.setVertexColorScale(.5),t.modelMatrix[13]+=5}}}else if(n.actorId===x.Bg_Relay_Objects){const e=await c("zelda_relay_objects.zar"),t=n.variable>>>8&15;if(0===t)h(e,"model/relay_usu_model.cmb",.1);else{if(1!==t)throw"starschulz";h(e,"model/l_doorpou_model.cmb",.1)}}else if(n.actorId===x.Bg_Spot06_Objects){const e=await c("zelda_spot06_objects.zar"),t=65280&n.variable;if(0===t)h(e,"model/c_s06gate_model.cmb",.1);else if(256===t)h(e,"model/c_s06mizuzou_model.cmb",.1);else{if(512!==t)throw"starschulz";{const t=h(e,"model/c_s06beforewater_modelT.cmb",1);t.bindCMAB(g(e,"misc/c_s06beforewater_modelT.cmab")),t.setVertexColorScale(.5)}}}else if(n.actorId===x.Bg_Spot02_Objects){const e=await c("zelda_spot02_objects.zar"),t=15&n.variable;if(0===t)h(e,"model/obj_s02gate_model.cmb",.1);else if(1===t)h(e,"model/obj_s02futa_model.cmb",.1);else if(2===t)h(e,"model/obj_s02kinghaka_model.cmb",.1);else if(3===t);else if(4===t);else if(5!==t)throw"starschulz"}else if(n.actorId===x.Bg_Spot16_Doughnut){const e=await c("zelda_efc_doughnut.zar");h(e,"model/doughnut_aya_modelT.cmb",.1).bindCMAB(g(e,"misc/doughnut_aya_modelT.cmab"))}else if(n.actorId===x.Obj_Comb)h(await c("zelda_field_keep.zar"),"model/hatisu_model.cmb",.1);else if(n.actorId===x.Bg_Ganon_Otyuka)h(await c("zelda_ganon.zar"),"model/ganon_tyuka_ue_model.cmb",1);else if(n.actorId===x.Door_Gerudo)h(await c("zelda_door_gerudo.zar"),"model/gerudoway_shutter_model.cmb",1);else if(n.actorId===x.En_Fz)h(await c("zelda_fz.zar"),"model/frezad.cmb",.01);else if(n.actorId===x.Obj_Bombiwa)h(await c("zelda_bombiwa.zar"),"model/obj_18b_stone_model.cmb",.1);else if(n.actorId===x.Bg_Zg)h(await c("zelda_zg.zar"),"model/zeldoor_model.cmb",1);else if(n.actorId===x.Bg_Breakwall)h(await c("zelda_bwall.zar"),"model/a_bomt_model.cmb",.1);else if(n.actorId===x.Obj_Timeblock)h(await c("zelda_timeblock.zar"),"model/brick_toki_model.cmb",1);else if(n.actorId===x.Bg_Spot18_Basket)h(await c("zelda_spot18_obj.zar"),"model/obj_s18tubo_model.cmb",.1);else if(n.actorId===x.Bg_Spot18_Shutter)h(await c("zelda_spot18_obj.zar"),"model/obj_186_model.cmb",.1);else if(n.actorId===x.En_Blkobj){const e=await c("zelda_blkobj.zar");h(e,"model/m_WhontR_0d_model.cmb",1).bindCMAB(g(e,"misc/m_WusoR_0d_model.cmab"))}else if(n.actorId===x.En_Goroiwa)h(await c("zelda_goroiwa.zar"),"model/l_j_goroiwa_model.cmb",.1);else if(n.actorId===x.En_Siofuki){const e=await c("zelda_siofuki.zar");h(e,"model/efc_tw_whirlpool_modelT.cmb",.1).bindCMAB(g(e,"misc/efc_tw_whirlpool_modelT.cmab"))}else if(n.actorId===x.Bg_Mizu_Movebg)h(await c("zelda_mizu_objects.zar"),"model/m_WPathFloat_model.cmb",.1);else if(n.actorId===x.Bg_Ddan_Jd)h(await c("zelda_ddan_objects.zar"),"model/ddanh_jd_model.cmb",.1);else if(n.actorId===x.Bg_Dodoago)h(await c("zelda_ddan_objects.zar"),"model/ddanh_ago_model.cmb",.1);else if(n.actorId===x.Bg_Ddan_Kd)h(await c("zelda_ddan_objects.zar"),"model/ddanh_kaidan_model.cmb",.1);else if(n.actorId===x.En_Trap)h(await c("dk_trap.zar"),"model/trap_model.cmb",.1);else if(n.actorId===x.Bg_Mori_Hineri){const e=15&n.variable;0===e?h(await c("zelda_mori_hineri1.zar"),"model/l_hineri1_model.cmb",1):1===e&&h(await c("zelda_mori_hineri2.zar"),"model/l_hineri2_model.cmb",1)}else if(n.actorId===x.Bg_Mori_Elevator)h(await c("zelda_mori_objects.zar"),"model/l_elevator_model.cmb",1);else if(n.actorId===x.Bg_Mori_Bigst)h(await c("zelda_mori_objects.zar"),"model/l_bigst_model.cmb",1);else if(n.actorId===x.Bg_Heavy_Block)h(await c("zelda_heavy_object.zar"),"model/heavy_object_model.cmb",1);else if(n.actorId===x.Bg_Mori_Idomizu){const e=await c("zelda_mori_objects.zar");h(e,"model/l_idomizu_modelT.cmb",1).bindCMAB(g(e,"misc/l_idomizu_modelT.cmab"))}else if(n.actorId===x.Bg_Gjyo_Bridge){const e=await c("zelda_gjyo_objects.zar");h(e,"model/spot15_brige_modelT.cmb",.1).bindCMAB(g(e,"misc/spot15_brige_modelT.cmab"))}else if(n.actorId===x.Bg_Mori_Hashira4){const e=await c("zelda_mori_objects.zar");0===(15&n.variable)&&h(e,"model/l_4hasira_model.cmb",1)}else if(n.actorId===x.Bg_Mori_Rakkatenjo)h(await c("zelda_mori_objects.zar"),"model/l_tenjyou_model.cmb",1);else if(n.actorId===x.Bg_Mori_Kaitenkabe)h(await c("zelda_mori_objects.zar"),"model/l_kaiten_model.cmb",1);else if(n.actorId===x.Bg_Spot01_Fusya)h(await c("zelda_spot01_objects.zar"),"model/c_s01fusya_model.cmb",.1);else if(n.actorId===x.Bg_Spot01_Idohashira)h(await c("zelda_spot01_objects.zar"),"model/c_s01idohashira_model.cmb",.1);else if(n.actorId===x.Bg_Spot01_Idomizu){const e=await c("zelda_spot01_objects.zar");h(e,"model/c_s01idomizu_modelT.cmb",.1).bindCMAB(g(e,"misc/c_s01idomizu_modelT.cmab"))}else if(n.actorId===x.Bg_Spot01_Objects2){const e=15&n.variable;if(0===e)h(await c("zelda_spot01_matoya.zar"),"model/c_s01_k_kanban_model.cmb",.1);else if(1===e)h(await c("zelda_spot01_matoya.zar"),"model/c_s01_m_kanban_model.cmb",.1);else if(2===e)h(await c("zelda_spot01_matoya.zar"),"model/c_s01_n_kanban_model.cmb",.1);else if(3===e)h(await c("zelda_spot01_matoyab.zar"),"model/c_matoate_before_model.cmb",.1);else{if(4!==e)throw"whoops";h(await c("zelda_spot01_matoya.zar"),"model/c_matoate_house_model.cmb",.1)}}else if(n.actorId===x.Door_Warp1){const e=await c("zelda_warp1.zar");h(e,"model/warp_2_modelT.cmb",1).bindCMAB(g(e,"misc/warp_2_modelT_open.cmab"))}else if(n.actorId===x.Bg_Ydan_Hasi){const e=await c("zelda_ydan_objects.zar"),t=15&n.variable;if(0===t)h(e,"model/ydan_trift_model.cmb",.1);else if(1===t)h(e,"model/ydan_mizu_modelT.cmb",.1).bindCMAB(g(e,"misc/ydan_mizu_modelT.cmab"));else{if(2!==t)throw"whoops";h(e,"model/ydan_maruta_model.cmb",.1)}}else if(n.actorId===x.Bg_Ydan_Maruta){const e=await c("zelda_ydan_objects.zar"),t=n.variable>>>8&15;0===t?h(e,"model/ydan_ytoge_model.cmb",.1):1===t&&h(e,"model/ydan_t_hasigo_model.cmb",.1)}else if(n.actorId===x.Obj_Oshihiki){const e=await c("zelda_dangeon_keep.zar");let a=.1;const r=3&n.variable;0===r?a=.1:1===r?a=100/600:2===r?a=.2:3===r&&(a=200/600);const s=n.variable>>>6&3;if(0===t)h(e,"model/brick_15_deku_Sa_model.cmb",a);else if(1===t)0===s?h(e,"model/brick_15_dod_Sa_model.cmb",a):1===s&&h(e,"model/brick_15_dod_Sb_model.cmb",a);else if(3===t)0===s?h(e,"model/brick_15_frs_Ma_model.cmb",a):1===s&&h(e,"model/brick_15_frs_Mb_model.cmb",a);else if(4===t)h(e,"model/brick_15_fire_Sa_model.cmb",a);else if(5===t)h(e,"model/brick_15_wat_Ma_model.cmb",a);else if(6===t)0===r?h(e,"model/brick_15_soul_Sa_model.cmb",a):3===r&&h(e,"model/brick_15_soul_La_model.cmb",a);else if(7===t)h(e,"model/brick_15_dark_Ma_model.cmb",a);else if(10===t)h(e,"model/brick_15_dark_Ma_model.cmb",a);else{if(11!==t)throw"whoops";h(e,"model/brick_15_gerd_La_model.cmb",a)}}else if(n.actorId===x.Obj_Switch){const e=await c("zelda_dangeon_keep.zar"),a=7&n.variable;if(0===a)h(e,"model/switch_1_model.cmb",.1);else if(1===a)h(e,"model/switch_2_model.cmb",.1);else if(2===a)if(function(e){switch(e){case 0:case 1:case 2:case 9:return!0;default:return!1}}(t))h(e,"model/switch_4_model.cmb",.1);else{if(!function(e){switch(e){case 3:case 4:case 5:case 6:case 7:case 10:case 8:case 11:return!0;default:return!1}}(t))throw"whoops";h(e,"model/switch_5_model.cmb",.1)}else if(3===a)h(e,"model/switch_6_model.cmb",.1);else{if(4!==a)throw"whoops";h(e,"model/switch_9_model.cmb",.1)}}else if(n.actorId===x.Door_Ana)h(await c("zelda_field_keep.zar"),"model/ana01_modelT.cmb");else if(n.actorId===x.Bg_Mjin){const t=await c("zelda_mjin.zar"),r=15&n.variable;let s=0;1===r?s=3:6===r?s=0:3===r?s=2:4===r?s=4:5===r?s=5:2===r&&(s=1);const i=h(t,"model/mjin_flash_model.cmb",1),o=g(t,"misc/mjin_flash_model.cmab");a.textureHolder.addTextures(e,o.textures),i.bindCMAB(o,function(e){const t=new f.default;return t.setTimeInFrames(e),t}(s))}else if(n.actorId===x.Bg_Ydan_Sp){const e=await c("zelda_ydan_objects.zar"),t=n.variable>>>12&3;if(0===t)h(e,"model/ydan_spyuka_modelT.cmb",.1);else if(1===t)h(e,"model/ydan_spkabe_modelT.cmb",.1);else{if(2!==t)throw"whoops";h(e,"model/ydan_spyuka_modelT.cmb",.1)}}else if(n.actorId===x.Grezzo_DekuTreeWeb){h(await c("zelda_ydan_objects.zar"),"model/deku_kumo_kabe.cmb",.05)}else if(n.actorId===x.En_Hata){const e=await c("zelda_hata.zar"),t=n.variable>>>8&255,a=h(e,"model/ht_hata.cmb");a.bindCSAB(d(e,"anim/ht_hata.csab")),0===t?a.shapeInstances[2].visible=!1:255===t&&(a.shapeInstances[3].visible=!1)}else if(n.actorId===x.En_Wood02){const e=await c("zelda_wood02.zar"),t=255&n.variable;if(0===t){h(e,"model/tree01_model.cmb",1.5).setVertexColorScale(.5)}else if(1===t){h(e,"model/tree01_model.cmb",1).setVertexColorScale(.5)}else if(2===t){h(e,"model/tree03_model.cmb",.5).setVertexColorScale(.5)}else console.warn(`Unknown En_Wood02 model ${t}`)}else if(n.actorId===x.Bg_Toki_Hikari){const e=await c("zelda_toki_objects.zar"),t=15&n.variable;if(0===t){h(e,"model/tokinoma_hikari_modelT.cmb",1).bindCMAB(g(e,"misc/tokinoma_hikari_modelT.cmab"))}else if(1!==t)throw"whoops"}else if(n.actorId===x.Bg_Haka){h(await c("zelda_haka.zar"),"model/obj_haka_model.cmb",.1)}else if(n.actorId===x.Bg_Spot15_Rrbox){h(await c("zelda_spot15_obj.zar"),"model/spot15_box_model.cmb",.1)}else if(n.actorId===x.En_Ishi){const e=h(await c("zelda_field_keep.zar"),"model/obj_isi01_model.cmb",.1);e.modelMatrix[13]+=5,e.setVertexColorScale(.5)}else if(n.actorId===x.Obj_Hana){const e=await c("zelda_field_keep.zar"),t=3&n.variable;if(0===t)h(e,"model/flower1_model.cmb",.01);else if(1===t){h(e,"model/obj_isi01_model.cmb",.1).setVertexColorScale(.5)}else{if(2!==t)throw"whoops";h(e,"model/grass05_model.cmb",.4)}}else if(n.actorId===x.Bg_Spot03_Taki){const e=await c("zelda_spot03_object.zar");h(e,"model/c_s03bigtaki_modelT.cmb",.1).bindCMAB(g(e,"misc/c_s03bigtaki_modelT.cmab")),h(e,"model/c_s03shibuki_modelT.cmb",.1).bindCMAB(g(e,"misc/c_s03shibuki_modelT.cmab"))}else if(n.actorId===x.Obj_Lift){h(await c("zelda_d_lift.zar"),"model/lift_l_model.cmb",.1).setVertexColorScale(.5)}else if(n.actorId===x.Bg_Spot07_Taki){const e=await c("zelda_spot07_object.zar");h(e,"model/obj_s07taki01_modelT.cmb",.1).bindCMAB(g(e,"misc/obj_s07taki01_modelT.cmab"))}else if(n.actorId===x.En_A_Obj){const e=255&n.variable;if(10===e){h(await c("zelda_keep.zar"),"objects/model/kanban2_model.cmb")}else console.warn(`Unknown En_A_Obj model ${e}`)}else if(n.actorId===x.En_Ko){const e=255&n.variable;if(0===e){const e=await c("zelda_km1.zar"),t=h(e,"model/kokirimaster.cmb");t.shapeInstances[2].visible=!1,t.setVertexColorScale(.5),t.bindCSAB(d(e,"anim/km1_ishi_wait.csab"))}else if(1===e);else if(2===e){const e=await c("zelda_km1.zar"),t=h(e,"model/kokirimaster.cmb");t.shapeInstances[2].visible=!1,t.setVertexColorScale(.5),t.bindCSAB(d(e,"anim/km1_osiete_wait.csab"))}else if(3===e);else if(4===e){const e=await c("zelda_km1.zar"),t=h(e,"model/kokirimaster.cmb");t.shapeInstances[2].visible=!1,t.setVertexColorScale(.5),t.bindCSAB(d(e,"anim/km1_backcyu.csab"))}else if(5===e){const e=await c("zelda_kw1.zar"),t=h(e,"model/kokiripeople.cmb");t.setVertexColorScale(.5),t.shapeInstances[2].visible=!1,t.shapeInstances[3].visible=!1,t.shapeInstances[4].visible=!1,t.bindCSAB(d(e,"anim/km1_utsumuki_pose.csab"))}else if(6===e){const e=await c("zelda_kw1.zar"),t=h(e,"model/kokiripeople.cmb");t.setVertexColorScale(.5),t.shapeInstances[2].visible=!1,t.shapeInstances[3].visible=!1,t.shapeInstances[4].visible=!1,t.bindCSAB(d(e,"anim/km1_shinpai_pose.csab"))}else if(7===e);else if(8===e);else if(10===e);else if(11===e);else{if(12!==e)throw"whoops";{const e=await c("zelda_kw1.zar"),t=h(e,"model/kokiripeople.cmb");t.setVertexColorScale(.5),t.shapeInstances[5].visible=!1,t.shapeInstances[6].visible=!1,t.bindCSAB(d(e,"anim/fad_n_wait.csab"))}}}else if(n.actorId===x.En_Ossan){const e=15&n.variable;if(0===e){const e=await c("zelda_km1.zar"),t=h(e,"model/kokirimaster.cmb");t.shapeInstances[4].visible=!1,t.bindCSAB(d(e,"anim/km1_omise.csab")),t.setVertexColorScale(.5)}else if(1===e);else if(2===e){const e=await c("zelda_rs.zar"),t=h(e,"model/bomchumaster.cmb");t.bindCSAB(d(e,"anim/rs_matsu.csab")),t.setVertexColorScale(.5)}else if(3===e){const e=await c("zelda_ds2.zar"),t=h(e,"model/drugmaster.cmb");t.bindCSAB(d(e,"anim/ds2_matsu.csab")),t.setVertexColorScale(.5)}else if(4===e){const e=await c("zelda_sh.zar"),t=h(e,"model/shotmaster.cmb");t.bindCSAB(d(e,"anim/sh_matsu.csab")),t.setVertexColorScale(.5),t.shapeInstances[1].visible=!1,t.shapeInstances[2].visible=!1}else if(7===e){const e=await c("zelda_masterzoora.zar"),t=h(e,"model/zorapeople.cmb");t.bindCSAB(d(e,"anim/zo_omise.csab")),t.setVertexColorScale(.5)}else if(8===e){const e=await c("zelda_mastergolon.zar"),t=h(e,"model/goronpeople.cmb");t.bindCSAB(d(e,"anim/oF1d_omise.csab")),t.setVertexColorScale(.5)}else{if(10!==e)throw console.log(e),"Starschulz";{const e=await c("zelda_os.zar"),t=h(e,"model/maskmaster.cmb");t.bindCSAB(d(e,"anim/os_matsu.csab")),t.setVertexColorScale(.5)}}}else if(n.actorId===x.En_Brob){h(await c("zelda_brob.zar"),"model/brob.cmb").setVertexColorScale(.5)}else if(n.actorId===x.En_Heishi2){const e=await c("zelda_sd.zar"),t=255&n.variable;if(2===t){const t=h(e,"model/soldier.cmb");t.bindCSAB(d(e,"anim/sd_matsu.csab")),t.setVertexColorScale(.5)}else if(5===t){const t=h(e,"model/soldier.cmb");t.bindCSAB(d(e,"anim/sd_matsu.csab")),t.setVertexColorScale(.5)}else{if(6!==t)throw"whoops";h(e,"model/soldier2.cmb").setVertexColorScale(.5)}}else if(n.actorId===x.En_Eiyer){const e=await c("zelda_ei.zar"),t=65535&n.variable;if(0===t){const t=h(e,"model/stinga.cmb");t.bindCSAB(d(e,"anim/ei_swim.csab")),t.setVertexColorScale(.5)}else if(1===t){const t=h(e,"model/stinga.cmb");t.bindCSAB(d(e,"anim/ei_wait.csab")),t.setVertexColorScale(.5)}else if(2===t){const t=h(e,"model/stinga.cmb");t.bindCSAB(d(e,"anim/ei_wait.csab")),t.setVertexColorScale(.5)}else if(3===t){const t=h(e,"model/stinga.cmb");t.bindCSAB(d(e,"anim/ei_wait.csab")),t.setVertexColorScale(.5)}else{if(10!==t)throw"whoops";{const t=h(e,"model/stinga.cmb");t.bindCSAB(d(e,"anim/ei_swim.csab")),t.setVertexColorScale(.5)}}}else if(n.actorId===x.En_Horse_Link_Child){const e=await c("zelda_hlc.zar"),t=h(e,"model/childepona.cmb",.005);t.bindCSAB(d(e,"anim/hlc_anim_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ik){const e=await c("zelda_ik.zar"),t=h(e,"model/ironknack.cmb",.02);t.bindCSAB(d(e,"anim/ironknack_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_GeldB){const e=await c("zelda_gelb.zar"),t=h(e,"model/geld.cmb",.01);t.bindCSAB(d(e,"anim/geldB_talk.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ge1){const e=await c("zelda_ge1.zar"),t=h(e,"model/geldwoman.cmb",.01);t.bindCSAB(d(e,"anim/ge1_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ge2){const e=await c("zelda_gla.zar"),t=h(e,"model/geldwomanspear.cmb",.01);t.bindCSAB(d(e,"anim/geldA_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ssh){const e=await c("zelda_ssh.zar"),t=h(e,"model/spiderman.cmb",.03);t.bindCSAB(d(e,"anim/st_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.Boss_Sst){const e=await c("zelda_sst.zar"),t=h(e,"model/bongobongo.cmb",.015);t.modelMatrix[14]+=-500,t.bindCSAB(d(e,"anim/ss_wait_open.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Go2){const e=await c("zelda_oF1d.zar"),t=h(e,"model/goronpeople.cmb");t.bindCSAB(d(e,"anim/oF1d_dai_goron_kaii.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Cs){const e=await c("zelda_cs.zar"),t=h(e,"model/childstalker.cmb",.01);t.bindCSAB(d(e,"anim/cs_matsu03.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Cow){const e=await c("zelda_cow.zar"),t=h(e,"model/cow.cmb");t.bindCSAB(d(e,"anim/usi_mogmog.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Zo){const e=await c("zelda_zo.zar"),t=h(e,"model/zorapeople.cmb");t.bindCSAB(d(e,"anim/zo_riku_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_In){const e=await c("zelda_in.zar"),t=h(e,"model/ingo.cmb");t.bindCSAB(d(e,"anim/in_shigoto.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ma1){const e=await c("zelda_ma1.zar"),t=h(e,"model/childmalon.cmb");t.bindCSAB(d(e,"anim/ma1_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ma2){const e=await c("zelda_ma2.zar"),t=h(e,"model/malon.cmb");t.bindCSAB(d(e,"anim/ma2_shigoto.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Horse_Normal){const e=await c("zelda_horse_normal.zar"),t=h(e,"model/normalhorse.cmb");t.bindCSAB(d(e,"anim/hn_anim_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ta){const e=await c("zelda_ta.zar"),t=h(e,"model/talon.cmb");t.bindCSAB(d(e,"anim/ta_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ds){const e=await c("zelda_ds.zar"),t=h(e,"model/magicmaster.cmb",.013);t.bindCSAB(d(e,"anim/ds_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Mk){const e=await c("zelda_mk.zar"),t=h(e,"model/lakedoctor.cmb");t.bindCSAB(d(e,"anim/mk_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Niw_Lady){const e=await c("zelda_ane.zar"),t=h(e,"model/chickenlady.cmb");t.bindCSAB(d(e,"anim/Ane_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Niw_Girl){const e=await c("zelda_gr.zar"),t=h(e,"model/chickengirl.cmb");t.bindCSAB(d(e,"anim/gr_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Kakasi){const e=await c("zelda_ka.zar"),t=h(e,"model/strawman.cmb");t.bindCSAB(d(e,"anim/ka_dance.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Kakasi2){const e=await c("zelda_ka.zar"),t=h(e,"model/strawman.cmb");t.bindCSAB(d(e,"anim/ka_dance.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Kakasi3){const e=await c("zelda_ka.zar"),t=h(e,"model/strawman.cmb");t.bindCSAB(d(e,"anim/ka_dance.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Bubble){h(await c("zelda_bubble.zar"),"model/syabom.cmb",1).setVertexColorScale(.5)}else if(n.actorId===x.En_Daiku_Kakariko){const e=await c("zelda_daiku.zar"),t=h(e,"model/disciple.cmb");t.bindCSAB(d(e,"anim/dk2_hanasi.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Daiku){const e=await c("zelda_daiku.zar"),t=h(e,"model/disciple.cmb");t.bindCSAB(d(e,"anim/dk2_roya.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Du){const e=await c("zelda_du.zar"),t=h(e,"model/darunia.cmb");t.bindCSAB(d(e,"anim/du_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Sa){const e=await c("zelda_sa.zar"),t=h(e,"model/saria.cmb");t.bindCSAB(d(e,"anim/sa_okarina_hanasi_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Skj){const e=await c("zelda_skj.zar"),t=h(e,"model/stalkid.cmb");t.bindCSAB(d(e,"anim/skeltonJR_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Owl){const e=await c("zelda_owl.zar"),t=h(e,"model/kaeporagaebora1.cmb",.025);t.bindCSAB(d(e,"anim/owl_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ms){const e=await c("zelda_ms.zar"),t=h(e,"model/beanmaster.cmb");t.bindCSAB(d(e,"anim/ms_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Okuta){const e=await c("zelda_oc2.zar"),t=h(e,"model/octarock.cmb");t.bindCSAB(d(e,"anim/oc_float.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ani){const e=await c("zelda_ani.zar"),t=h(e,"model/roofman.cmb");t.bindCSAB(d(e,"anim/ani_suwari_wait.csab")),t.modelMatrix[13]-=25,t.setVertexColorScale(.5)}else if(n.actorId===x.En_Niw){const e=await c("zelda_nw.zar"),t=h(e,"model/chicken.cmb");t.bindCSAB(d(e,"anim/nw_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Toryo){const e=await c("zelda_toryo.zar"),t=h(e,"model/bosshead.cmb");t.bindCSAB(d(e,"anim/dk1_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Ru2){const e=await c("zelda_ru2.zar"),t=h(e,"model/ruto.cmb");t.bindCSAB(d(e,"anim/ru2_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Nb){const e=await c("zelda_nb.zar"),t=h(e,"model/nabooru.cmb");t.bindCSAB(d(e,"anim/nb_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.Demo_Sa){const e=await c("zelda_sa.zar"),t=h(e,"model/saria.cmb");t.bindCSAB(d(e,"anim/sa_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.Demo_Im){const e=await c("zelda_im.zar"),t=h(e,"model/impa.cmb",.01);t.bindCSAB(d(e,"anim/impa_matsu.csab")),t.setVertexColorScale(.5),t.shapeInstances[9].visible=!1}else if(n.actorId===x.En_Rl){const e=await c("zelda_rl.zar"),t=h(e,"model/raul.cmb",.01);t.bindCSAB(d(e,"anim/rl_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Zl3){const e=await c("zelda_zl2.zar"),t=h(e,"model/zelda.cmb",.01);t.bindCSAB(d(e,"anim/ze_a_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.Demo_Du){const e=await c("zelda_du.zar"),t=h(e,"model/darunia.cmb",.01);t.bindCSAB(d(e,"anim/du_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Heishi4){const e=await c("zelda_sd.zar"),t=h(e,"model/soldier.cmb");t.bindCSAB(d(e,"anim/sd_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Heishi1){const e=await c("zelda_sd.zar"),t=h(e,"model/soldier.cmb");t.bindCSAB(d(e,"anim/sd_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Heishi3){const e=await c("zelda_sd.zar"),t=h(e,"model/soldier.cmb");t.bindCSAB(d(e,"anim/sd_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Zl4){const e=await c("zelda_zl4.zar"),t=h(e,"model/childzelda.cmb");t.bindCSAB(d(e,"anim/kozelda_ushiro_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Tg){const e=await c("zelda_mu.zar"),t=h(e,"model/couple.cmb");t.bindCSAB(d(e,"anim/tg_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Mu){const e=await c("zelda_mu.zar"),t=h(e,"model/marketpeople.cmb");t.bindCSAB(d(e,"anim/mu_matsu.csab")),t.setVertexColorScale(.5);const a=15&n.variable;if(0===a)t.setConstantColor(1,A.colorNewFromRGBA(.39216,.5098,.92157)),t.setConstantColor(2,A.colorNewFromRGBA(.11765,.94118,.78431)),t.setConstantColor(3,A.colorNewFromRGBA(.62745,.98039,.23529)),t.setConstantColor(4,A.colorNewFromRGBA(.35294,.23529,.03992));else{if(1!==a)throw"whoops";t.setConstantColor(1,A.colorNewFromRGBA(.35294,.23529,.03992)),t.setConstantColor(2,A.colorNewFromRGBA(.62745,.98039,.23529)),t.setConstantColor(3,A.colorNewFromRGBA(.11765,.94118,.78431)),t.setConstantColor(4,A.colorNewFromRGBA(.35294,.23529,.03992))}}else if(n.actorId===x.En_Dog){const e=await c("zelda_dog.zar"),t=h(e,"model/dog.cmb");t.bindCSAB(d(e,"anim/dog_sit.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Hy){const e=63&n.variable;if(0===e){const e=await c("zelda_aob.zar"),t=h(e,"model/hyliawoman1.cmb");t.bindCSAB(d(e,"anim/aob_mastu.csab")),t.setVertexColorScale(.5)}else if(1===e){const e=await c("zelda_cob.zar"),t=h(e,"model/hyliawoman2.cmb");t.bindCSAB(d(e,"anim/cob_matsu.csab")),t.setVertexColorScale(.5)}else if(2===e){const e=await c("zelda_ahg.zar"),t=h(e,"model/hyliaman2.cmb");t.bindCSAB(d(e,"anim/ahg_matsu.csab")),t.setVertexColorScale(.5),t.setConstantColor(3,A.White),t.setConstantColor(4,A.White);for(let e=5;e<8;e++)t.shapeInstances[e].visible=!1}else if(3===e){const e=await c("zelda_boj.zar"),t=h(e,"model/hyliaman1.cmb");t.setConstantColor(3,A.colorNewFromRGBA(.21568,.21568,1)),t.setConstantColor(4,A.White),t.bindCSAB(d(e,"anim/boj2_5.csab")),t.setVertexColorScale(.5);for(let e=3;e<12;e++)t.shapeInstances[e].visible=!1;t.shapeInstances[6].visible=!0,t.shapeInstances[11].visible=!0}else if(4===e){const e=await c("zelda_ahg.zar"),t=h(e,"model/hyliaman2.cmb");t.bindCSAB(d(e,"anim/ahg2_18.csab")),t.setConstantColor(3,A.colorNewFromRGBA(1,0,0)),t.setVertexColorScale(.5);for(let e=3;e<8;e++)t.shapeInstances[e].visible=!1;t.shapeInstances[5].visible=!0}else if(5===e){const e=await c("zelda_boj.zar"),t=h(e,"model/hyliaman1.cmb");t.setConstantColor(3,A.colorNewFromRGBA(.19608,.31373,0)),t.setConstantColor(4,A.colorNewFromRGBA(.19608,.31373,0)),t.bindCSAB(d(e,"anim/boj2_9.csab")),t.setVertexColorScale(.5);for(let e=3;e<12;e++)t.shapeInstances[e].visible=!1;t.shapeInstances[7].visible=!0}else if(6===e){const e=await c("zelda_bba.zar"),t=h(e,"model/hyliaoldwoman.cmb");t.bindCSAB(d(e,"anim/bba_matsu.csab")),t.setVertexColorScale(.5)}else if(7===e){const e=await c("zelda_bji.zar"),t=h(e,"model/hyliaoldman.cmb");t.bindCSAB(d(e,"anim/bji_matsu.csab")),t.setConstantColor(3,A.White),t.setConstantColor(4,A.colorNewFromRGBA(0,.1968,.62745)),t.setVertexColorScale(.5),t.shapeInstances[5].visible=!1}else if(8===e){const e=await c("zelda_cne.zar"),t=h(e,"model/hylialady.cmb");t.bindCSAB(d(e,"anim/cne_n_wait.csab")),t.setVertexColorScale(.5),t.setConstantColor(2,A.colorNewFromRGBA(.62734,.70588,1)),t.setConstantColor(3,A.colorNewFromRGBA(.62734,.70588,1)),t.setConstantColor(4,A.colorNewFromRGBA(.62734,.70588,1)),t.shapeInstances[5].visible=!1}else if(9===e){const e=await c("zelda_boj.zar"),t=h(e,"model/hyliaman1.cmb");t.setConstantColor(3,A.White),t.setConstantColor(4,A.colorNewFromRGBA(.86275,0,.31373)),t.bindCSAB(d(e,"anim/boj_13.csab")),t.setVertexColorScale(.5);for(let e=6;e<12;e++)t.shapeInstances[e].visible=!1}else if(10===e){const e=await c("zelda_boj.zar"),t=h(e,"model/hyliaman1.cmb");t.setConstantColor(3,A.White),t.setConstantColor(4,A.colorNewFromRGBA(0,.5098,.86275)),t.bindCSAB(d(e,"anim/boj_14.csab")),t.setVertexColorScale(.5);for(let e=6;e<12;e++)t.shapeInstances[e].visible=!1}else if(11===e){const e=await c("zelda_cne.zar"),t=h(e,"model/hylialady.cmb");t.bindCSAB(d(e,"anim/cne2_15.csab")),t.setVertexColorScale(.5),t.setConstantColor(2,A.White),t.setConstantColor(3,A.colorNewFromRGBA(1,1,.39216)),t.setConstantColor(4,A.colorNewFromRGBA(.27451,.62734,.90196)),t.shapeInstances[4].visible=!1}else if(12===e){const e=await c("zelda_boj.zar"),t=h(e,"model/hyliaman1.cmb");t.setConstantColor(3,A.colorNewFromRGBA(1,.94118,.58824)),t.setConstantColor(4,A.colorNewFromRGBA(.58824,.23529,.35294)),t.bindCSAB(d(e,"anim/boj2_17.csab")),t.setVertexColorScale(.5);for(let e=3;e<12;e++)t.shapeInstances[e].visible=!1;t.shapeInstances[8].visible=!0}else if(13===e){const e=await c("zelda_ahg.zar"),t=h(e,"model/hyliaman2.cmb");t.bindCSAB(d(e,"anim/ahg2_18.csab")),t.setConstantColor(3,A.colorNewFromRGBA(.78431,.70588,1)),t.setConstantColor(4,A.colorNewFromRGBA(.78431,.70588,1)),t.setVertexColorScale(.5);for(let e=3;e<8;e++)t.shapeInstances[e].visible=!1;t.shapeInstances[6].visible=!0}else if(14===e){const e=await c("zelda_boj.zar"),t=h(e,"model/hyliaman1.cmb");t.bindCSAB(d(e,"anim/boj2_19.csab")),t.setConstantColor(3,A.White),t.setConstantColor(4,A.colorNewFromRGBA(.54901,1,.43137)),t.setVertexColorScale(.5);for(let e=3;e<12;e++)t.shapeInstances[e].visible=!1;t.shapeInstances[9].visible=!0}else if(15===e){const e=await c("zelda_bji.zar"),t=h(e,"model/hyliaoldman.cmb");t.bindCSAB(d(e,"anim/bji2_20.csab")),t.setConstantColor(3,A.colorNewFromRGBA(.5098,.70577,1)),t.setConstantColor(4,A.colorNewFromRGBA(.5098,.2745,.07843)),t.setVertexColorScale(.5),t.shapeInstances[3].visible=!1,t.shapeInstances[4].visible=!1}else if(19===e){const e=await c("zelda_bji.zar"),t=h(e,"model/hyliaoldman.cmb");t.bindCSAB(d(e,"anim/bji2_20.csab")),t.setConstantColor(3,A.colorNewFromRGBA(.2745,.5098,.82352)),t.setConstantColor(4,A.colorNewFromRGBA(.62754,0,.39215)),t.setVertexColorScale(.5),t.shapeInstances[3].visible=!1,t.shapeInstances[4].visible=!1}else if(20===e){const e=await c("zelda_ahg.zar"),t=h(e,"model/hyliaman2.cmb");t.bindCSAB(d(e,"anim/ahg2_18.csab")),t.setConstantColor(3,A.colorNewFromRGBA(0,.58823,.43137)),t.setConstantColor(4,A.colorNewFromRGBA(.62745,.90196,0)),t.setVertexColorScale(.5);for(let e=3;e<8;e++)t.shapeInstances[e].visible=!1;t.shapeInstances[6].visible=!0}else console.warn(`Unknown Hyrule Market NPC ${s} / ${m.hexzero(e,2)}`)}else if(n.actorId===x.Fishing){const e=await c("zelda_fishing.zar"),t=n.variable;if(0===t){const t=h(e,"model/fishmaster.cmb");t.bindCSAB(d(e,"anim/fs_matsu.csab")),t.setVertexColorScale(.5)}else console.log(`Unknown fishing model ${t}`)}else if(n.actorId===x.En_Bom_Bowl_Man){const e=await c("zelda_bg.zar"),t=h(e,"model/boringmaster.cmb");t.bindCSAB(d(e,"anim/bg_wait.csab")),t.setVertexColorScale(.5),t.modelMatrix[13]+=10}else if(n.actorId===x.En_Takara_Man){const e=await c("zelda_ts.zar"),t=h(e,"model/lottomaster.cmb");t.bindCSAB(d(e,"anim/ts_matsu.csab")),t.setVertexColorScale(.5),t.modelMatrix[13]+=10}else if(n.actorId===x.Grezzo_Hintstone){const e=await c("zelda_hintstone.zar");h(e,"model/hintstone.cmb").bindCSAB(d(e,"anim/newstock.csab"))}else if(n.actorId===x.En_Hintnuts){const e=await c("zelda_hintnuts.zar"),t=h(e,"model/dekunuts.cmb");t.bindCSAB(d(e,"anim/dnh_wait.csab")),t.setVertexColorScale(.5),t.modelMatrix[13]+=8}else if(n.actorId===x.En_Shopnuts){const e=await c("zelda_shopnuts.zar"),t=h(e,"model/akindonuts.cmb");t.bindCSAB(d(e,"anim/dnu_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Wf){const e=await c("zelda_wf.zar"),t=h(e,"model/wolfos.cmb");t.bindCSAB(d(e,"anim/wolfman_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Dekunuts){const e=await c("zelda_dekunuts.zar"),t=h(e,"model/okorinuts.cmb");t.bindCSAB(d(e,"anim/dn_wait.csab")),t.setVertexColorScale(.5),t.modelMatrix[13]+=6}else if(n.actorId===x.En_Am){h(await c("zelda_am.zar"),"model/amos.cmb",.015).setVertexColorScale(.5)}else if(n.actorId===x.En_Vm){h(await c("zelda_vm.zar"),"model/beamos.cmb").setVertexColorScale(.5)}else if(n.actorId===x.En_Crow){const e=await c("zelda_crow.zar"),t=h(e,"model/gue.cmb");t.bindCSAB(d(e,"anim/df_hover.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Bb){const e=await c("zelda_bb.zar"),t=h(e,"model/bubble.cmb");t.bindCSAB(d(e,"anim/bb_fly.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Test){const e=await c("zelda_skelton.zar"),t=h(e,"model/stalfos.cmb");t.bindCSAB(d(e,"anim/skelton_fighting_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Wallmas){const e=await c("zelda_wm2.zar"),t=h(e,"model/fallmaster.cmb");t.bindCSAB(d(e,"anim/wm_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Floormas){const e=await c("zelda_wm2.zar"),t=h(e,"model/floormaster.cmb");t.bindCSAB(d(e,"anim/wm_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_St){const e=await c("zelda_st.zar"),t=h(e,"model/staltula.cmb",.02);t.bindCSAB(d(e,"anim/st_matsu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Dodojr){const e=await c("zelda_dodojr.zar"),t=h(e,"model/babydodongo.cmb",.02);t.bindCSAB(d(e,"anim/dd_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Dodongo){const e=await c("zelda_dodongo.zar"),t=h(e,"model/dodongo.cmb",.02);t.bindCSAB(d(e,"anim/da_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Firefly){const e=await c("zelda_ff.zar"),t=h(e,"model/keith.cmb");t.bindCSAB(d(e,"anim/firefly_foot_at.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Fr){const e=await c("zelda_fr.zar"),t=h(e,"model/frog.cmb");t.bindCSAB(d(e,"anim/wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Fu){const e=await c("zelda_fu.zar"),t=h(e,"model/windmillman.cmb");t.bindCSAB(d(e,"anim/fu_mawasu.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Bw){const e=await c("zelda_bw.zar"),t=h(e,"model/torchsrag.cmb");t.bindCSAB(d(e,"anim/bw_aruku.csab")),t.bindCMAB(g(e,"Misc/torchsrag.cmab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Bili){const e=await c("zelda_bl.zar"),t=h(e,"model/bili.cmb");t.bindCSAB(d(e,"anim/bl_nomral.csab")),t.bindCMAB(g(e,"Misc/pt_bili.cmab")),t.setVertexColorScale(.5)}else if(n.actorId===x.Bg_Dy_Yoseizo){const e=await c("zelda_dy_obj.zar"),t=h(e,"model/fairy.cmb",.025);t.bindCSAB(d(e,"anim/DY_n_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Anubice_Tag){const e=await c("zelda_av.zar"),t=h(e,"model/anubis.cmb",.015);t.bindCSAB(d(e,"anim/av_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Dha){const e=await c("zelda_dh.zar"),t=h(e,"model/deadarm.cmb",.01);t.bindCSAB(d(e,"anim/dead_armR_wait_20f.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Dh){const e=await c("zelda_dh.zar"),t=h(e,"model/deadhand.cmb",.01);t.bindCSAB(d(e,"anim/dead_hand_wait_20f.csab")),t.setVertexColorScale(.5),p.mat4.rotateY(t.modelMatrix,t.modelMatrix,1.5705)}else if(n.actorId===x.En_Karebaba){const e=await c("zelda_dekubaba.zar"),t=h(e,"model/dekubaba.cmb",.01);t.bindCSAB(d(e,"anim/db_P_kougeki.csab")),t.modelMatrix[13]+=60,t.modelMatrix[14]+=3,t.setVertexColorScale(.5),h(e,"model/db_ha_model.cmb",.01).setVertexColorScale(.5);const a=h(e,"model/db_miki1_model.cmb",.01);a.modelMatrix[13]+=40,p.mat4.rotateX(a.modelMatrix,a.modelMatrix,-1.5705),a.setVertexColorScale(.5);const r=h(e,"model/db_miki2_model.cmb",.01);r.modelMatrix[13]+=20,p.mat4.rotateX(r.modelMatrix,r.modelMatrix,-1.5705),r.setVertexColorScale(.5);const n=h(e,"model/db_miki3_model.cmb",.01);p.mat4.rotateX(n.modelMatrix,n.modelMatrix,-1.5705),n.setVertexColorScale(.5)}else if(n.actorId===x.En_Sw){const e=await c("zelda_st.zar");if(0===n.variable){const t=h(e,"model/staltula.cmb",.02);t.bindCSAB(d(e,"anim/st_matsu.csab")),t.setVertexColorScale(.5)}else{const t=h(e,"model/staltula_gold.cmb",.02);t.bindCSAB(d(e,"anim/st_matsu.csab")),t.setVertexColorScale(.5)}}else if(n.actorId===x.En_Peehat){const e=await c("zelda_ph.zar"),t=65535&n.variable;if(0===t){const t=h(e,"model/peehat.cmb",.05);t.bindCSAB(d(e,"anim/ph_end.csab")),t.setVertexColorScale(.5)}else if(1===t){h(e,"model/peehat_tail.cmb",.05).setVertexColorScale(.5)}else if(65535===t){const t=h(e,"model/peehat.cmb",.05);t.bindCSAB(d(e,"anim/ph_end.csab")),t.setVertexColorScale(.5)}}else if(n.actorId===x.En_Dekubaba){h(await c("zelda_dekubaba.zar"),"model/db_ha_model.cmb").setVertexColorScale(.5)}else if(n.actorId===x.En_Tite){const e=await c("zelda_tt.zar"),t=h(e,"model/tectite.cmb");t.bindCSAB(d(e,"anim/tt_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.En_Rd){const e=await c("zelda_rd.zar"),t=n.variable>>>7&1;if(0===t){h(e,"model/redead.cmb").bindCSAB(d(e,"anim/re_dead_wait_20f.csab"))}else if(1===t){h(e,"model/gibud.cmb").bindCSAB(d(e,"anim/re_dead_wait_20f.csab"))}}else if(n.actorId===x.Boss_Goma){const e=await c("zelda_goma.zar"),t=h(e,"model/goma.cmb");t.bindCSAB(d(e,"anim/go_startdemo02.csab")),t.setVertexColorScale(.5),t.modelMatrix[13]+=-360}else if(n.actorId===x.Boss_Dodongo){const e=await c("zelda_kdodongo.zar"),t=h(e,"model/kingdodongo.cmb");t.bindCSAB(d(e,"anim/kd_wait.csab")),t.setVertexColorScale(.5)}else if(n.actorId===x.Boss_Fd){const e=await c("zelda_fd.zar"),t=h(e,"model/valbasiagnd.cmb");t.bindCSAB(d(e,"anim/vba_wait.csab")),t.setVertexColorScale(.5),t.modelMatrix[13]+=-730,t.modelMatrix[14]+=-13,t.modelMatrix[12]+=10,p.mat4.rotateY(t.modelMatrix,t.modelMatrix,1.5705)}else if(n.actorId===x.Boss_Ganon){const e=await c("zelda_ganon.zar"),t=h(e,"model/ganondorf.cmb");t.bindCSAB(d(e,"anim/G_n_wait.csab")),t.setVertexColorScale(.5),t.shapeInstances[10].visible=!1,t.shapeInstances[11].visible=!1}else if(n.actorId===x.Boss_Ganondrof){const e=await c("zelda_fantomHG.zar"),t=h(e,"model/ganonhorse.cmb");t.bindCSAB(d(e,"anim/hgf_wait.csab")),t.setVertexColorScale(.5),t.modelMatrix[13]+=-639;const a=await c("zelda_gnd.zar"),r=h(a,"model/phantomganon.cmb");r.bindCSAB(d(a,"anim/gnf_Dnormal.csab")),r.setVertexColorScale(.5),r.modelMatrix[13]+=-639,r.shapeInstances[10].visible=!1,r.shapeInstances[9].visible=!1,r.shapeInstances[8].visible=!1,r.shapeInstances[7].visible=!1,r.shapeInstances[6].visible=!1,r.shapeInstances[5].visible=!1}else if(n.actorId===x.Boss_Ganon2){const e=await c("zelda_ganon2.zar"),t=h(e,"model/ganon.cmb");t.bindCSAB(d(e,"anim/gn2_Kwait.csab")),t.setVertexColorScale(.5),t.modelMatrix[12]+=500,p.mat4.rotateY(t.modelMatrix,t.modelMatrix,1.5705)}else n.actorId===x.Elf_Msg||n.actorId===x.Elf_Msg2||n.actorId===x.En_Wonder_Talk||n.actorId===x.En_Wonder_Talk2||n.actorId===x.En_River_Sound||n.actorId===x.En_Wonder_Item||n.actorId===x.En_Okarina_Tag||n.actorId===x.En_Holl||console.warn(`Unknown actor ${s} / ${S=n.actorId,x[S]||m.hexzero(S,4)} / ${m.hexzero(n.variable,4)}`);var S}spawnSkybox(e,t,a,r){const n=t.roomRenderers[0];function s(a,r){const s=t.modelCache.getModel(e,t,a,r),i=new u.CmbInstance(e,t.textureHolder,s);return i.isSkybox=!0,i.animationController.fps=20,i.passMask=2,n.objectRenderers.push(i),i}function o(e,t){return i.parse(0,m.assertExists(l.findFileData(e,t)))}const c=255&r;if(1===c){s(a,"model/fine_tenkyu_1.cmb");s(a,"model/fine_kumo_a1.cmb").bindCMAB(o(a,"misc/fine_kumo_a.cmab")),s(a,"model/fine_kumo_b1.cmb").bindCMAB(o(a,"misc/fine_kumo_b.cmab"))}}async createScene(e,t){const a=`oot3d/scene/${this.id}.zar`,r=`oot3d/scene/${this.id}_info.zsi`,n=t.dataFetcher,s=await t.dataShare.ensureObject("oot3d/DataHolder",async()=>{const e=new w(n),t=new u.CtrTextureHolder;return new T(e,t)}),o=s.modelCache,h=s.textureHolder,[d,p]=await Promise.all([o.fetchFileData(a,1),o.fetchFileData(r)]),f=d.byteLength?l.parse(d):null,A=c.parseScene(p);m.assert(null!==A.rooms);const g=new v(e,h,A,o);t.destroyablePool.push(g);const _=function(e){return"ydan"===e||"ydan_dd"===e?0:"ddan"===e||"ddan_dd"===e?1:"bdan"===e||"bdan_dd"===e?2:"bmori1"===e||"bmori1_dd"===e?3:"hidan"===e||"hidan_dd"===e?4:"mizusin"===e||"mizusin_dd"===e?5:"jyasinzou"===e||"jyasinzou_dd"===e?6:"hakadan"===e||"hakadan_dd"===e?7:"ice_doukutu"===e||"ice_doukutu_dd"===e?8:"hakadan_ch"===e||"hakadan_ch_dd"===e?9:"ganontika"===e||"ganontika_dd"===e?10:"men"===e||"men_dd"===e?11:12}(this.id),S=[];for(let e=0;e<A.rooms.length;e++){const t=`oot3d/scene/${A.rooms[e].split("/").pop()}`;S.push(t),o.fetchFileData(t)}o.fetchArchive("oot3d/kankyo/BlueSky.zar"),await o.waitForLoad();for(let t=0;t<S.length;t++){const a=c.parseRooms(o.getFileData(S[t]));let r;r=-1===this.setupIndex?m.assertExists(a.find(e=>null!==e.mesh)):a[this.setupIndex],m.assert(null!==r.mesh);const n=S[t].split("/").pop(),s=new u.RoomRenderer(e,h,r.mesh,n);if(s.roomSetups=a,null!==f){const a=f.files.find(e=>e.name.startsWith(`ROOM${t}\\`)&&e.name.endsWith(".cmab")&&!e.name.endsWith("_t.cmab"));if(a){const t=i.parse(0,a.buffer);h.addTextures(e,t.textures),s.bindCMAB(t)}}g.roomRenderers.push(s);for(let t=0;t<r.actors.length;t++)this.spawnActorForRoom(e,_,g,s,r.actors[t],t)}for(let t=0;t<A.doorActors.length;t++)this.spawnActorForRoom(e,_,g,g.roomRenderers[0],A.doorActors[t],t);const b=o.getArchive("oot3d/kankyo/BlueSky.zar");return this.spawnSkybox(e,g,b,A.skyboxSettings),await o.waitForLoad(),g.setEnvironmentSettingsIndex(0),g}}const C=["Kokiri Forest",new y("spot04","Kokiri Forest"),new y("ydan","Inside the Deku Tree"),new y("ydan_boss","Inside the Deku Tree (Boss)"),new y("spot10","Lost Woods"),new y("spot05","Sacred Forest Meadow"),new y("bmori1","Forest Temple"),new y("moriboss","Forest Temple (Boss)"),new y("k_home","Know-It-All Brothers' Home"),new y("kokiri","Kokiri Shop"),new y("link","Link's Home"),"Kakariko Village",new y("spot01","Kakariko Village"),new y("kinsuta","Skulltula House"),new y("labo","Impa's House"),new y("mahouya","Granny's Potion Shop"),new y("shop_drag","Kakariko Potion Shop"),new y("spot02","Kakariko Graveyard"),new y("hut","Dampe's Hut"),new y("hakasitarelay","Dampe's Grave & Windmill Hut"),new y("hakaana_ouke","Royal Family's Tomb"),new y("hakadan","Shadow Temple"),new y("hakadan_boss","Shadow Temple (Boss)"),new y("hakadan_ch","Bottom of the Well"),new y("hakaana","Heart Piece Grave"),new y("kakariko","Generous Woman's House"),"Death Mountain",new y("spot16","Death Mountain"),new y("spot17","Death Mountain Crater"),new y("spot18","Goron City"),new y("shop_golon","Goron Shop"),new y("ddan","Dodongo's Cavern"),new y("ddan_boss","Dodongo's Cavern (Boss)"),new y("hidan","Fire Temple"),new y("fire_bs","Fire Temple (Boss)"),"Hyrule Field",new y("spot00","Hyrule Field"),new y("spot20","Lon Lon Ranch"),new y("souko","Talon's House"),new y("stable","Stables"),new y("spot99","Link's Nightmare"),new y("spot03","Zora's River"),new y("daiyousei_izumi","Great Fairy Fountain"),new y("yousei_izumi_tate","Small Fairy Fountain"),new y("yousei_izumi_yoko","Magic Fairy Fountain"),new y("kakusiana","Grottos"),"Hyrule Castle / Town",new y("spot15","Hyrule Castle"),new y("hairal_niwa","Castle Courtyard"),new y("hairal_niwa_n","Castle Courtyard (Night)"),new y("nakaniwa","Zelda's Courtyard"),new y("entra_day","Market Entrance (Day)"),new y("entra_night","Market Entrance (Night)"),new y("entra_ruins","Market Entrance (Ruins)"),new y("miharigoya","Lots'o'Pots"),new y("market_day","Market (Day)"),new y("market_night","Market (Night)"),new y("market_ruins","Market (Ruins)"),new y("market_alley","Market Back-Alley (Day)"),new y("market_alley_n","Market Back-Alley (Night)"),new y("bowling","Bombchu Bowling Alley"),new y("shop_night","Bombchu Shop"),new y("takaraya","Treasure Chest Game"),new y("kakariko_impa","Puppy Woman's House"),new y("shop_alley","Market Potion Shop"),new y("shop_face","Happy Mask Shop"),new y("syatekijyou","Shooting Gallery"),new y("shrine","Temple of Time (Outside, Day)"),new y("shrine_n","Temple of Time (Outside, Night)"),new y("shrine_r","Temple of Time (Outside, Adult)"),new y("tokinoma","Temple of Time (Interior)"),new y("kenjyanoma","Chamber of the Sages",3),new y("shop","Bazaar"),"Lake Hylia",new y("spot06","Lake Hylia"),new y("hylia_labo","Hylia Lakeside Laboratory"),new y("turibori","Fishing Pond"),new y("mizusin","Water Temple"),new y("mizusin_boss","Water Temple (Boss)"),"Zora's Domain",new y("spot07","Zora's Domain"),new y("spot08","Zora's Fountain"),new y("zoora","Zora Shop"),new y("bdan","Jabu-Jabu's Belly"),new y("bdan_boss","Jabu-Jabu's Belly (Boss)"),new y("ice_doukutu","Ice Cavern"),"Gerudo Desert",new y("spot09","Gerudo Valley"),new y("tent","Carpenter's Tent"),new y("spot12","Gerudo's Fortress"),new y("men","Gerudo Training Grounds"),new y("gerudoway","Thieves' Hideout"),new y("spot13","Haunted Wasteland"),new y("spot11","Desert Colossus"),new y("jyasinzou","Spirit Temple"),new y("jyasinzou_boss","Spirit Temple (Mid-Boss)"),"Ganon's Castle",new y("ganontika","Ganon's Castle"),new y("ganontikasonogo","Ganon's Castle (Crumbling)"),new y("ganon_tou","Ganon's Castle (Outside)"),new y("ganon","Ganon's Castle Tower"),new y("ganon_sonogo","Ganon's Castle Tower (Crumbling)"),new y("ganon_boss","Second-To-Last Boss Ganondorf"),new y("ganon_demo","Final Battle Against Ganon"),new y("ganon_final","Ganondorf's Death"),"Master Quest",new y("ydan_dd","Inside the Deku Tree"),new y("ddan_dd","Dodongo's Cavern"),new y("bdan_dd","Jabu-Jabu's Belly"),new y("bmori1_dd","Forest Temple"),new y("hidan_dd","Fire Temple"),new y("mizusin_dd","Water Temple"),new y("hakadan_dd","Shadow Temple"),new y("jyasinzou_dd","Spirit Temple"),new y("ganontika_dd","Ganon's Castle"),new y("ice_doukutu_dd","Ice Cavern"),new y("hakadan_ch_dd","Bottom of the Well"),new y("men_dd","Gerudo Training Grounds")];t.sceneGroup={id:"oot3d",name:"The Legend of Zelda: Ocarina of Time 3D",sceneDescs:C}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(169)),s=a(170),i=a(179),o=r(a(11)),l=a(0),c=a(9),h=a(1),d=a(5),u=r(a(60)),m=a(4);class p{constructor(e,t,a=new i.RetroTextureHolder){this.mlvl=t,this.textureHolder=a,this.renderTarget=new c.BasicRenderTarget,this.modelCache=new i.ModelCache,this.areaRenderers=[],this.defaultSkyRenderer=null,this.worldAmbientColor=m.colorNewCopy(m.OpaqueBlack),this.renderHelper=new d.GXRenderHelperGfx(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(.1)}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();a.camera.setClipPlanes(.2),d.fillSceneParamsDataOnTemplate(r,a,!1);for(let t=0;t<this.areaRenderers.length;t++)this.areaRenderers[t].prepareToRender(e,this.renderHelper,a,this.worldAmbientColor);this.prepareToRenderSkybox(e,a),this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}prepareToRenderSkybox(e,t){let a=null;for(let e=0;e<this.areaRenderers.length;e++)if(this.areaRenderers[e].visible&&this.areaRenderers[e].needSky){a=null!==this.areaRenderers[e].overrideSky?this.areaRenderers[e].overrideSky:this.defaultSkyRenderer;break}null!==a&&a.prepareToRender(e,this.renderHelper,t)}render(e,t){const a=this.renderHelper.renderInstManager,r=e.createHostAccessPass();this.prepareToRender(e,r,t),e.submitPass(r),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,c.transparentBlackFullClearRenderPassDescriptor);a.setVisibleByFilterKeyExact(2),a.drawOnPassRenderer(e,n),e.submitPass(n);const s=this.renderTarget.createRenderPass(e,t.viewport,c.depthClearRenderPassDescriptor);return a.setVisibleByFilterKeyExact(1),a.drawOnPassRenderer(e,s),a.resetRenderInsts(),s}destroy(e){this.textureHolder.destroy(e),this.renderTarget.destroy(e),this.renderHelper.destroy(e),this.modelCache.destroy(e);for(let t=0;t<this.areaRenderers.length;t++)this.areaRenderers[t].destroy(e);null!==this.defaultSkyRenderer&&this.defaultSkyRenderer.destroy(e)}createPanels(){return this.layersPanel=new o.LayerPanel(this.areaRenderers),this.layersPanel.onlayertoggled=()=>{this.onstatechanged()},[this.layersPanel]}serializeSaveState(e,t){const a=new DataView(e),r=new u.default(this.areaRenderers.length);return function(e,t){for(let a=0;a<e.length;a++)t.setBit(a,e[a].visible)}(this.areaRenderers,r),t=u.bitMapSerialize(a,t,r)}deserializeSaveState(e,t,a){const r=new DataView(e);if(t+(this.areaRenderers.length+7>>>3)<=a){const e=new u.default(this.areaRenderers.length);t=u.bitMapDeserialize(r,t,e),function(e,t){l.assert(t.numBits===e.length);for(let a=0;a<e.length;a++)e[a].setVisible(t.getBit(a))}(this.areaRenderers,e),this.layersPanel.syncLayerVisibility()}return t}}t.RetroSceneRenderer=p;class f{constructor(e,t,a,r=""){this.filename=e,this.gameCompressionMethod=t,this.name=a,this.worldName=r,this.id=r||e}async createScene(e,t){const a=t.dataFetcher,r=n.parse(await a.fetchData(`metroid_prime/${this.filename}`),this.gameCompressionMethod),o=new s.ResourceSystem([r]);for(const t of r.namedResourceTable.values()){if(l.assert("MLVL"===t.fourCC),""!==this.worldName&&this.worldName!==t.name)continue;const a=l.assertExists(o.loadAssetByID(t.fileID,t.fourCC)),r=new p(e,a),n=r.renderHelper.getCache(),s=a.areaTable,c=o.loadAssetByID(a.defaultSkyboxID,"CMDL");if(c){const t=o.findResourceNameByID(a.defaultSkyboxID),s=r.modelCache.getCMDLData(e,r.textureHolder,n,c),l=new i.CMDLRenderer(e,r.textureHolder,null,t,h.mat4.create(),s);l.isSkybox=!0,r.defaultSkyRenderer=l}for(let t=0;t<s.length;t++){const a=s[t],l=o.loadAssetByID(a.areaMREAID,"MREA");if(null!==l&&-1===a.areaName.indexOf("worldarea")){const t=new i.MREARenderer(e,r.modelCache,n,r.textureHolder,a.areaName,l);r.areaRenderers.push(t),t.visible=1===r.areaRenderers.length}}return r}throw"whoops"}}const A=[new f("mp1/Metroid1.pak",1,"Space Pirate Frigate"),new f("mp1/Metroid2.pak",1,"Chozo Ruins"),new f("mp1/Metroid3.pak",1,"Phendrana Drifts"),new f("mp1/Metroid4.pak",1,"Tallon Overworld"),new f("mp1/Metroid5.pak",1,"Phazon Mines"),new f("mp1/Metroid6.pak",1,"Magmoor Caverns"),new f("mp1/Metroid7.pak",1,"Impact Crater")];t.sceneGroupMP1={id:"mp1",name:"Metroid Prime",sceneDescs:A};const g=[new f("mp2/Metroid1.pak",3,"Temple Grounds"),new f("mp2/Metroid2.pak",3,"Great Temple"),new f("mp2/Metroid3.pak",3,"Agon Wastes"),new f("mp2/Metroid4.pak",3,"Torvus Bog"),new f("mp2/Metroid5.pak",3,"Sanctuary Fortress"),new f("mp2/Metroid6.pak",3,"Multiplayer - Sidehopper Station","M01_SidehopperStation"),new f("mp2/Metroid6.pak",3,"Multiplayer - Spires","M02_Spires"),new f("mp2/Metroid6.pak",3,"Multiplayer - Crossfire Chaos","M03_CrossfireChaos"),new f("mp2/Metroid6.pak",3,"Multiplayer - Pipeline","M04_Pipeline"),new f("mp2/Metroid6.pak",3,"Multiplayer - Spider Complex","M05_SpiderComplex"),new f("mp2/Metroid6.pak",3,"Multiplayer - Shooting Gallery","M06_ShootingGallery")];t.sceneGroupMP2={id:"mp2",name:"Metroid Prime 2: Echoes",sceneDescs:g};const _=[new f("mp3/Metroid1.pak",4,"G.F.S. Olympus","01a_GFShip_#SERIAL#"),new f("mp3/Metroid1.pak",4,"Norion","01b_GFPlanet_#SERIAL#"),new f("mp3/Metroid1.pak",4,"G.F.S. Valhalla","01c_Abandoned_#SERIAL#"),new f("mp3/Metroid3.pak",4,"Bryyo Cliffside","03a_Bryyo_Reptilicus_#SERIAL#"),new f("mp3/Metroid3.pak",4,"Bryyo Fire","03b_Bryyo_Fire_#SERIAL#"),new f("mp3/Metroid3.pak",4,"Bryyo Ice","03c_Bryyo_Ice_#SERIAL#"),new f("mp3/Metroid4.pak",4,"SkyTown, Elysia","04a_Skytown_Main_#SERIAL#"),new f("mp3/Metroid4.pak",4,"Eastern SkyTown, Elysia","04b_Skytown_Pod_#SERIAL#"),new f("mp3/Metroid5.pak",4,"Pirate Research","05a_Pirate_Research_#SERIAL#"),new f("mp3/Metroid5.pak",4,"Pirate Command","05b_Pirate_Command_#SERIAL#"),new f("mp3/Metroid5.pak",4,"Pirate Mines","05c_Pirate_Mines_#SERIAL#"),new f("mp3/Metroid6.pak",4,"Phaaze","06_Phaaze_#SERIAL#"),new f("mp3/Metroid7.pak",4,"Bryyo Seed","03d_Bryyo_Seed_#SERIAL#"),new f("mp3/Metroid7.pak",4,"Elysia Seed","04c_Skytown_Seed_#SERIAL#"),new f("mp3/Metroid7.pak",4,"Pirate Homeworld Seed","05d_Pirate_Seed_#SERIAL#"),new f("mp3/Metroid8.pak",4,"Space","08_Space_#SERIAL#")];t.sceneGroupMP3={id:"mp3",name:"Metroid Prime 3: Corruption",sceneDescs:_}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(145);t.parse=function(e,t){const a=new n.InputStream(e,0),s=a.readUint32();if(196613===s)return a.assetIDLength=4,function(e,t){r.assert(0===e.readUint32());const a=[],n=e.readUint32();for(let t=0;t<n;t++){const t=e.readFourCC(),r=e.readAssetID(),n=e.readUint32(),s=e.readString(n,!1);a.push({fourCC:t,fileID:r,fileName:s})}const s=new Map,i=new Map,o=e.readUint32();for(let n=0;n<o;n++){const n=!!e.readUint32(),o=e.readFourCC(),l=e.readAssetID();let c=e.readUint32(),h=e.readUint32();if(i.has(l)){const e=i.get(l);r.assert(o===e.fourCC),r.assert(c===e.fileSize);continue}let d=null;const u=a.find(e=>e.fileID===l);u&&(d=u.fileName,r.assert(u.fourCC===o));const m=e.getBuffer().subarray(h,c),p={name:d,fourCC:o,fileID:l,fileSize:c,fileOffset:h,compressionMethod:n?t:0,buffer:m};i.set(p.fileID,p),null!==p.name&&s.set(p.name,p)}return{namedResourceTable:s,resourceTable:i}}(a,t);if(2===s)return a.assetIDLength=8,function(e,t){r.assert(64===e.readUint32()),e.readString(16,!1),e.align(64);const a=e.readUint32();r.assert(3===a),r.assert("STRG"===e.readFourCC());const n=e.readUint32();r.assert("RSHD"===e.readFourCC());const s=e.readUint32();r.assert("DATA"===e.readFourCC()),e.readUint32(),e.align(64);const i=e.tell(),o=i+n,l=o+s;e.goTo(i);const c=[],h=e.readUint32();for(let t=0;t<h;t++){const t=e.readString(),a=e.readFourCC(),r=e.readAssetID();c.push({fourCC:a,fileID:r,fileName:t})}e.goTo(o);const d=e.readUint32(),u=new Map,m=new Map;for(let a=0;a<d;a++){const a=!!e.readUint32(),n=e.readFourCC(),s=e.readAssetID(),i=e.readUint32(),o=e.readUint32()+l;if(m.has(s)){const e=m.get(s);r.assert(n===e.fourCC),r.assert(i===e.fileSize);continue}let h=null;const d=c.find(e=>e.fileID===s);d&&(h=d.fileName,r.assert(d.fourCC===n));const p=e.getBuffer().slice(o,o+i),f={name:h,fourCC:n,fileID:s,fileSize:i,fileOffset:o,compressionMethod:a?t:0,buffer:p};m.set(f.fileID,f),null!==f.name&&u.set(f.name,f)}return{namedResourceTable:u,resourceTable:m}}(a,t);throw"whoops"}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(97)),i=a(176),o=n(a(15)),l=a(0),c=r(a(248)),h=r(a(177)),d=r(a(250)),u=r(a(251)),m=r(a(252)),p=r(a(253)),f=r(a(254)),A=a(145);t.invalidAssetID="";const g={MLVL:c.parse,MREA:h.parse,STRG:d.parse,TXTR:u.parse,CMDL:m.parse,ANCS:p.parse,CHAR:f.parse};function _(e,t){const a=new Uint8Array(e);let r=0;for(let e=0;e<t.length;e++)a.set(t[e],r),r+=t[e].byteLength;return l.assert(r===e),a}t.ResourceSystem=class{constructor(e,t=null){this.paks=e,this.nameData=t,this._cache=new Map}loadResourceBuffer_LZO(e){const t=e.createDataView(),a=[],r=t.getUint32(0);let n=r,s=4;for(;n>0;){const r=t.getUint16(s);s+=2;const o=e.subarray(s,r);s+=r;const l=i.decompress(o,16384);a.push(l.createTypedArray(Uint8Array)),n-=l.byteLength}const l=_(r,a);return new o.default(l.buffer)}loadResourceBuffer_CMPD(e,t){const a=e.createDataView();l.assert("CMPD"===l.readString(e,0,4,!1));const r=a.getUint32(4);let n=8,c=8+8*r,h=0;const d=[];for(let o=0;o<r;o++){const r=16777215&a.getUint32(n+0),o=a.getUint32(n+4),u=e.subarray(c,r);if(r===o)d.push(u.createTypedArray(Uint8Array));else if(2===t){const e=s.inflate(u.createTypedArray(Uint8Array));l.assert(e.byteLength===o),d.push(e)}else{let t=o,r=c;for(;t>0;){const n=a.getUint16(r);r+=2;const s=e.subarray(r,n);r+=n;const o=i.decompress(s,16384);d.push(o.createTypedArray(Uint8Array)),t-=o.byteLength}}n+=8,c+=r,h+=o}const u=_(h,d);return new o.default(u.buffer)}loadResourceBuffer(e){if(0===e.compressionMethod)return e.buffer;if(1===e.compressionMethod){const t=e.buffer.createTypedArray(Uint8Array,4),a=s.inflate(t);return new o.default(a.buffer)}if(3===e.compressionMethod)return this.loadResourceBuffer_LZO(e.buffer);if(2===e.compressionMethod||4===e.compressionMethod)return this.loadResourceBuffer_CMPD(e.buffer,e.compressionMethod);throw"whoops"}findResourceNameByID(e){const t=function(e){let t="";for(let a=0;a<e.length;a++)t+=l.hexzero(e.charCodeAt(a),2).toUpperCase();return t}(e);if(l.assert(8===t.length||16===t.length),null!==this.nameData){const e=this.nameData.Assets[t];if(e)return e.Filename}return t}findResourceByID(e){l.assert(4===e.length||8===e.length);for(const t of this.paks){const a=t.resourceTable.get(e);if(a)return a}return null}loadAssetByID(e,t){if(""===e||""===e)return null;const a=this._cache.get(e);if(void 0!==a)return a;const r=l.assertExists(g[t]),n=this.findResourceByID(e);if(!n)return null;l.assert(n.fourCC===t);const s=this.loadResourceBuffer(n),i=r(new A.InputStream(s,e.length),this,e);return this._cache.set(e,i),i}}},function(e,t,a){"use strict";e.exports=function(e,t,a,r){for(var n=65535&e|0,s=e>>>16&65535|0,i=0;0!==a;){a-=i=a>2e3?2e3:a;do{s=s+(n=n+t[r++]|0)|0}while(--i);n%=65521,s%=65521}return n|s<<16|0}},function(e,t,a){"use strict";var r=function(){for(var e,t=[],a=0;a<256;a++){e=a;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[a]=e}return t}();e.exports=function(e,t,a,n){var s=r,i=n+a;e^=-1;for(var o=n;o<i;o++)e=e>>>8^s[255&(e^t[o])];return-1^e}},function(e,t,a){"use strict";var r=a(63),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var i=new r.Buf8(256),o=0;o<256;o++)i[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&s||!e.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var a="",i=0;i<t;i++)a+=String.fromCharCode(e[i]);return a}i[254]=i[254]=1,t.string2buf=function(e){var t,a,n,s,i,o=e.length,l=0;for(s=0;s<o;s++)55296==(64512&(a=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=e.charCodeAt(s+1)))&&(a=65536+(a-55296<<10)+(n-56320),s++),l+=a<128?1:a<2048?2:a<65536?3:4;for(t=new r.Buf8(l),i=0,s=0;i<l;s++)55296==(64512&(a=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=e.charCodeAt(s+1)))&&(a=65536+(a-55296<<10)+(n-56320),s++),a<128?t[i++]=a:a<2048?(t[i++]=192|a>>>6,t[i++]=128|63&a):a<65536?(t[i++]=224|a>>>12,t[i++]=128|a>>>6&63,t[i++]=128|63&a):(t[i++]=240|a>>>18,t[i++]=128|a>>>12&63,t[i++]=128|a>>>6&63,t[i++]=128|63&a);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new r.Buf8(e.length),a=0,n=t.length;a<n;a++)t[a]=e.charCodeAt(a);return t},t.buf2string=function(e,t){var a,r,n,s,o=t||e.length,c=new Array(2*o);for(r=0,a=0;a<o;)if((n=e[a++])<128)c[r++]=n;else if((s=i[n])>4)c[r++]=65533,a+=s-1;else{for(n&=2===s?31:3===s?15:7;s>1&&a<o;)n=n<<6|63&e[a++],s--;s>1?c[r++]=65533:n<65536?c[r++]=n:(n-=65536,c[r++]=55296|n>>10&1023,c[r++]=56320|1023&n)}return l(c,r)},t.utf8border=function(e,t){var a;for((t=t||e.length)>e.length&&(t=e.length),a=t-1;a>=0&&128==(192&e[a]);)a--;return a<0?t:0===a?t:a+i[e[a]]>t?a:t}},function(e,t,a){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,a){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15));t.decompress=function(e,t){const a=e.createDataView();if(a.byteLength<3)throw"Input Overrun";let r=0,s=0,i=0,o=0,l=0,c=0;const h=new Uint8Array(t);function d(e){if(r+e>a.byteLength)throw"Input overrun"}function u(e){if(s+e>t)throw"Output overrun"}function m(){const e=r;for(;0===a.getUint8(r);)++r;return r-e}if(a.getUint8(r)>=22){const e=a.getUint8(r++)-17;d(e),u(e);for(let t=0;t<e;++t)h[s++]=a.getUint8(r++);l=4}else if(a.getUint8(r)>=18){c=a.getUint8(r++)-17,l=c,d(c),u(c);for(let e=0;e<c;++e)h[s++]=a.getUint8(r++)}for(;;){d(1);const e=a.getUint8(r++);if(192&e)d(1),i=s-((a.getUint8(r++)<<3)+(e>>>2&7)+1),o=1+(e>>>5),c=3&e;else if(32&e){if(o=2+(31&e),2===o){const e=m();d(1),o+=255*e+31+a.getUint8(r++)}d(2),c=a.getUint16(r,!0),r+=2,i=s-(1+(c>>>2)),c&=3}else if(16&e){if(o=2+(7&e),2===o){const e=m();d(1),o+=255*e+7+a.getUint8(r++)}if(d(2),c=a.getUint16(r,!0),r+=2,i=s-(((8&e)<<11)+(c>>>2)),c&=3,i===s)break;i-=16384}else{if(0===l){let t=e+3;if(3===t){const e=m();d(1),t+=255*e+15+a.getUint8(r++)}d(t),u(t);for(let e=0;e<t;++e)h[s++]=a.getUint8(r++);l=4;continue}4!==l?(d(1),c=3&e,i=s-((e>>>2)+(a.getUint8(r++)<<2)+1),o=2):(d(1),c=3&e,i=s-((e>>>2)+(a.getUint8(r++)<<2)+2049),o=3)}if(i<0)throw"Lookbehind overrun";d(c),u(o+c);for(let e=0;e<o;++e)h[s++]=h[i++];l=c;for(let e=0;e<c;++e)h[s++]=a.getUint8(r++)}if(3!==o)throw"LZO terminator not reached";return new n.default(h.buffer,0,s)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(16)),i=r(a(249)),o=r(a(178)),l=a(0),c=n(a(15)),h=a(31),d=a(1),u=r(a(97)),m=a(176),p=a(12),f=a(4);function A(e,t){const a=[];for(let r=0;r<t;r++){const t=e.readUint32();switch(t){case 0:case 1:case 6:a.push({type:t});break;case 2:{const r=e.readFloat32(),n=e.readFloat32(),s=e.readFloat32(),i=e.readFloat32();a.push({type:t,offsetS:r,offsetT:n,scaleS:s,scaleT:i});break}case 3:{const r=e.readFloat32(),n=e.readFloat32();a.push({type:t,offset:r,scale:n});break}case 4:case 5:{const r=e.readFloat32(),n=e.readFloat32(),s=e.readFloat32(),i=e.readFloat32();a.push({type:t,scale:r,numFrames:n,step:s,offset:i});break}case 7:{const r=e.readFloat32(),n=e.readFloat32();a.push({type:t,theta:r,phi:n});break}case 8:{const r=e.readUint32(),n=e.readFloat32(),s=e.readFloat32(),i=e.readFloat32(),o=e.readFloat32(),l=e.readFloat32(),c=e.readFloat32(),h=e.readFloat32(),d=e.readFloat32();a.push({type:t,transformType:r,scaleS:n,scaleT:s,rotationStatic:i,rotationScroll:o,transSStatic:l,transTStatic:c,transSScroll:h,transTScroll:d}),0!==r&&console.log("Non-zero transform type");break}}}return a}function g(e){const t=e.readUint32(),a=e.readFloat32(),r=e.readFloat32(),n=e.readFloat32(),s=e.readFloat32(),i=e.readFloat32(),o=e.readFloat32(),l=e.readFloat32(),c=e.readFloat32(),h=e.readFloat32(),u=e.readFloat32(),m=e.readFloat32(),f=e.readFloat32(),A=d.mat4.fromValues(a,i,h,0,r,o,u,0,n,l,m,0,s,c,f,1),g=e.readFloat32(),_=e.readFloat32(),S=e.readFloat32(),b=e.readFloat32(),v=e.readFloat32(),w=e.readFloat32();return[t,A,new p.AABB(g,_,S,b,v,w)]}function _(e,a,r,n,s,i,o,c,d,u,m,p){function f(e,t,a){const r=[];return r[9]={compCnt:1,compType:4,compShift:a},r[10]={compCnt:0,compType:e,compShift:14},r[11]={compCnt:1,compType:5,compShift:a},r[12]={compCnt:1,compType:5,compShift:a},r[13]={compCnt:1,compType:t,compShift:a},r[14]={compCnt:1,compType:4,compShift:a},r[15]={compCnt:1,compType:4,compShift:a},r[16]={compCnt:1,compType:4,compShift:a},r[17]={compCnt:1,compType:4,compShift:a},r[18]={compCnt:1,compType:4,compShift:a},r[19]={compCnt:1,compType:4,compShift:a},r[20]={compCnt:1,compType:4,compShift:a},r}let A=[];for(let g=0;g<a;g++){const a=d[r],g=d[r+1];e.goTo(a);e.readFloat32(),e.readFloat32(),e.readFloat32();const _=e.readUint32(),S=e.readUint16();e.readUint16();e.skip(8);const b=e.readUint32();e.readFloat32(),e.readFloat32(),e.readFloat32();p&&e.skip(4),e.skip(b),e.align(32);const v=e.tell(),w=m.materials[_],x=w.vtxAttrFormat,T=[],y=w.isUVShort,C=[];for(const e of t.vtxAttrFormats)x&e.mask&&(C[e.vtxAttrib]={type:e.type,enableOutput:e.mask<=16777215});const M=Math.log2(S);T[0]=f(4,4,M),T[1]=f(3,4,M),T[2]=f(3,3,M);const U=h.compileVtxLoaderMultiVat(T,C),k=e.getBuffer().slice(v,g),D=U.loadedVertexLayout,I=T[7&k.createDataView().getUint8(0)],R=y?l.assertExists(c):o,B=[];B[9]={buffer:e.getBuffer(),offs:n,stride:h.getAttributeByteSize(I,9)},B[10]={buffer:e.getBuffer(),offs:s,stride:h.getAttributeByteSize(I,10)},B[11]={buffer:e.getBuffer(),offs:i,stride:h.getAttributeByteSize(I,11)},B[12]={buffer:e.getBuffer(),offs:i,stride:h.getAttributeByteSize(I,12)},B[13]={buffer:e.getBuffer(),offs:R,stride:h.getAttributeByteSize(I,13)},B[14]={buffer:e.getBuffer(),offs:o,stride:h.getAttributeByteSize(I,14)},B[15]={buffer:e.getBuffer(),offs:o,stride:h.getAttributeByteSize(I,15)},B[16]={buffer:e.getBuffer(),offs:o,stride:h.getAttributeByteSize(I,16)},B[17]={buffer:e.getBuffer(),offs:o,stride:h.getAttributeByteSize(I,17)},B[18]={buffer:e.getBuffer(),offs:o,stride:h.getAttributeByteSize(I,18)},B[19]={buffer:e.getBuffer(),offs:o,stride:h.getAttributeByteSize(I,19)},B[20]={buffer:e.getBuffer(),offs:o,stride:h.getAttributeByteSize(I,20)};const P={materialIndex:_,worldModelIndex:u,loadedVertexData:U.runVertices(B,k),loadedVertexLayout:D};A.push(P),r++}return[A,r]}function S(e,a,r,n,s,i,o,c,d,u,m,p){const f=[];for(let A=0;A<a;A++){const a=d[r++],A=d[r];e.goTo(a);e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readUint16(),e.readUint16();e.skip(8);e.readUint16();const g=e.readUint16();e.skip(1);e.readUint8();const _=e.readUint8(),S=e.readUint8();e.skip(S),e.align(32);const b=m.materials[g].vtxAttrFormat,v=e.tell(),w=[];for(const e of t.vtxAttrFormats)b&e.mask&&(w[e.vtxAttrib]={type:e.type,enableOutput:e.mask<=16777215});const x=[];x[9]=p?{compCnt:1,compType:3,compShift:13}:{compCnt:1,compType:4,compShift:0},x[10]={compCnt:0,compType:3,compShift:14},x[11]={compCnt:1,compType:5,compShift:0},x[12]={compCnt:1,compType:5,compShift:0};const T=[];T[9]={buffer:e.getBuffer(),offs:n,stride:h.getAttributeByteSize(x,9)},T[10]={buffer:e.getBuffer(),offs:s,stride:h.getAttributeByteSize(x,10)},T[11]={buffer:e.getBuffer(),offs:i,stride:h.getAttributeByteSize(x,11)},T[12]={buffer:e.getBuffer(),offs:i,stride:h.getAttributeByteSize(x,12)};const y=1===_;for(let t=0;t<8;t++)x[13+t]={compCnt:1,compType:y?3:4,compShift:Math.log2(8192)},T[13+t]={buffer:e.getBuffer(),offs:y?l.assertExists(c):o,stride:h.getAttributeByteSize(x,13+t)};const C=[x,x,x,x,x,x,x,x],M=h.compileVtxLoaderMultiVat(C,w),U=M.loadedVertexLayout,k=e.getBuffer().slice(v,A),D=M.runVertices(T,k);f.push({materialIndex:g,worldModelIndex:u,loadedVertexData:D,loadedVertexLayout:U})}return[f,r]}function b(e,t,a,r,n,s,i,o,l){const c=a[o++],h=a[o++],d=a[o++],u=a[o++],m=n?a[o++]:null,p=a[o++];e.goTo(p);const f=e.readUint32();let A;return[A,o]=i?S(e,f,o,c,h,d,u,m,a,l,t,r):_(e,f,o,c,h,d,u,m,a,l,t,s),[{surfaces:A},o]}function v(e,t,a,r,n,s,i){const o=a[s++],l=a[s++],c=a[s++],h=a[s++],d=r?a[s++]:null,u=a[n++];e.goTo(u);const m=e.readUint32();let p;return n+=2,[p,s]=r?S(e,m,s,o,l,c,h,d,a,i,t,!1):_(e,m,s,o,l,c,h,d,a,i,t,!0),[{surfaces:p},n,s]}t.vtxAttrFormats=[{vtxAttrib:0,type:1,mask:16777216},{vtxAttrib:1,type:1,mask:33554432},{vtxAttrib:2,type:1,mask:67108864},{vtxAttrib:3,type:1,mask:134217728},{vtxAttrib:4,type:1,mask:268435456},{vtxAttrib:5,type:1,mask:536870912},{vtxAttrib:6,type:1,mask:1073741824},{vtxAttrib:7,type:1,mask:2147483648},{vtxAttrib:9,type:3,mask:3},{vtxAttrib:10,type:3,mask:12},{vtxAttrib:11,type:3,mask:48},{vtxAttrib:12,type:3,mask:192},{vtxAttrib:13,type:3,mask:768},{vtxAttrib:14,type:3,mask:3072},{vtxAttrib:15,type:3,mask:12288},{vtxAttrib:16,type:3,mask:49152},{vtxAttrib:17,type:3,mask:196608},{vtxAttrib:18,type:3,mask:786432},{vtxAttrib:19,type:3,mask:3145728}],t.parseWorldModelHeader=g,t.parseGeometry=b,t.parseGeometry_MP3_MREA=v;class w{constructor(){this.type=2,this.radius=0,this.castShadows=!1,this.gxLight=new s.Light}}function x(e,t){let a=f.colorNewCopy(f.TransparentBlack);const r=1.192092896e-7,n=[],s=e.readUint32();for(let i=0;i<s;i++){const s=e.readUint32(),i=e.readFloat32(),o=e.readFloat32(),l=e.readFloat32();t>=30&&e.skip(4);const c=e.readFloat32(),h=e.readFloat32(),u=e.readFloat32(),m=e.readFloat32(),p=e.readFloat32(),f=e.readFloat32();t>=30&&e.skip(12);const A=e.readFloat32(),g=e.readFloat32()/2;e.skip(4);const _=e.readBool();e.skip(4);const S=e.readUint32();if(e.skip(4),t>=30&&e.skip(20),0==s)a.r=Math.min(i*A,1),a.g=Math.min(o*A,1),a.b=Math.min(l*A,1),a.a=1;else{const e=new w;if(e.type=s,e.castShadows=_,e.gxLight.Color.r=i,e.gxLight.Color.g=o,e.gxLight.Color.b=l,e.gxLight.Color.a=1,d.vec3.set(e.gxLight.Position,c,h,u),d.vec3.set(e.gxLight.Direction,m,p,f),d.vec3.normalize(e.gxLight.Direction,e.gxLight.Direction),d.vec3.negate(e.gxLight.Direction,e.gxLight.Direction),1==s)d.vec3.set(e.gxLight.DistAtten,1,0,0),d.vec3.set(e.gxLight.CosAtten,1,0,0);else{const t=0==S?2/A:0,a=1==S?250/A:0,r=2==S?25e3/A:0;if(d.vec3.set(e.gxLight.DistAtten,t,a,r),3==s)if(g<0||g>90)d.vec3.set(e.gxLight.CosAtten,1,0,0);else{const t=.01745*g,a=Math.cos(t),r=1-a;d.vec3.set(e.gxLight.CosAtten,0,-a/r,1/r)}else d.vec3.set(e.gxLight.CosAtten,1,0,0)}if(e.gxLight.DistAtten[1]<r&&e.gxLight.DistAtten[2]<r)e.radius=3e36;else{let t=Math.max(i,o,l);2===e.type&&(t*=e.gxLight.CosAtten[0]);const a=15/255;e.gxLight.DistAtten[2]>r?t>=r&&(e.radius=Math.sqrt(t/(a*e.gxLight.DistAtten[2]))):e.gxLight.DistAtten[1]>r&&(e.radius=t/(a*e.gxLight.DistAtten[1]))}n.push(e)}}return{lights:n,ambientColor:a}}function T(e,t,a,r,n,s){const i={channelId:0,colorInA:15,colorInB:15,colorInC:15,colorInD:0,colorBias:0,colorOp:0,colorClamp:!0,colorScale:0,colorRegId:0,alphaInA:7,alphaInB:7,alphaInC:7,alphaInD:0,alphaBias:0,alphaOp:0,alphaClamp:!0,alphaScale:0,alphaRegId:0,indTexAddPrev:!1,indTexMatrix:0,indTexBiasSel:0,indTexFormat:0,indTexStage:0,indTexUseOrigLOD:!0,indTexWrapS:0,indTexWrapT:0,konstColorSel:0,konstAlphaSel:0,texMap:0+e,texCoordId:0+e};return"DIFF"===t?(i.konstColorSel=12,i.konstAlphaSel=28,i.colorInB=14,i.colorInC=8,i.colorInD=10,i.alphaInD=6):"CLR "===t?(i.colorInB=n?0:10,i.colorInC=8,i.colorInD=15,i.alphaInD=16&r?4:0,i.konstAlphaSel=29):"TRAN"===t?(i.konstAlphaSel=0,i.texSwapTable=[0,0,0,0],16&a?i.alphaInA=6:i.alphaInB=6,i.alphaInC=4,i.alphaInD=7):"INCA"===t?(i.colorInB=8,i.colorInC=12,i.colorInD=0):"BLOL"===t?(i.texSwapTable=[1,1,1,1],i.colorInB=0,i.colorInC=12,i.colorInD=0):"RFLV"===t?(i.colorInA=15,i.colorInB=15,i.colorInC=15,i.colorInD=8,i.colorRegId=3,i.alphaRegId=3):"RFLD"===t&&(i.colorInA=15,i.colorInB=6,i.colorInC=8,i.colorInD=0),i}var y;function C(e,t,a){return a===y.MP1||a===y.MP2?function(e,t,a){const r=e.readUint32(),n=[],i=[];for(let a=0;a<r;a++){const a=e.readAssetID(),r=l.assertExists(t.loadAssetByID(a,"TXTR")),s=n.indexOf(r);if(s>=0)i.push(s);else{const e=n.push(r)-1;i.push(e)}}const o=e.readUint32(),c=[];for(let t=0;t<o;t++){const t=e.readUint32();c.push(t)}const h=e.tell(),d=[];for(let t=0;t<o;t++){const r=e.readUint32(),n=e.readUint32(),i=[];l.assert(n<8);for(let t=0;t<n;t++){const t=e.readUint32();i.push(t)}const o=e.readUint32();a===y.MP2&&e.skip(8);const u=e.readUint32();let m=[];if(8&r){const t=e.readUint32();for(let a=0;a<t;a++){const t=e.readUint8()/255,a=e.readUint8()/255,r=e.readUint8()/255,n=e.readUint8()/255;m.push(f.colorNewFromRGBA(t,a,r,n))}}for(let e=m.length;e<4;e++)m.push(f.colorNewFromRGBA(0,0,0,0));const p=e.readUint16(),g=e.readUint16();if(1024&r){e.readUint32()}const _=e.readUint32();l.assert(_<=4);const S=[];for(let t=0;t<1;t++){const t=e.readUint32(),a={lightingEnabled:!!(1&t),ambColorSource:t>>>1&1,matColorSource:t>>>2&1,litMask:255,diffuseFunction:t>>>11&3,attenuationFunction:t>>>13&3},r={lightingEnabled:!1,ambColorSource:0,matColorSource:0,litMask:0,diffuseFunction:0,attenuationFunction:2};S.push({colorChannel:a,alphaChannel:r})}e.skip(4*(_-1)),S.push({colorChannel:{lightingEnabled:!1,ambColorSource:0,matColorSource:0,litMask:0,diffuseFunction:0,attenuationFunction:2},alphaChannel:{lightingEnabled:!1,ambColorSource:0,matColorSource:0,litMask:0,diffuseFunction:0,attenuationFunction:2}});const b=e.readUint32();l.assert(b<=8);let v=e.tell()+20*b;const w=[];for(let t=0;t<b;t++){const t=e.readUint32(),a=e.readUint32(),r=e.readUint32(),n=e.readUint32();e.skip(1);const i=e.readUint8(),o=e.readUint8(),l=s.getRasColorChannelID(e.readUint8()),c=t>>>0&31,h=t>>>5&31,d=t>>>10&31,u=t>>>15&31,m=a>>>0&31,p=a>>>5&31,f=a>>>10&31,A=a>>>15&31,g=r>>>0&15,_=r>>>4&3,S=r>>>6&3,b=!!(r>>>8),x=r>>>9&3,T=n>>>0&15,y=n>>>4&3,C=n>>>6&3,M=!!(n>>>8),U=n>>>9&3;let k=e.tell();e.goTo(v+2);const D=e.readUint8(),I=e.readUint8();e.goTo(k),v+=4;const R={colorInA:c,colorInB:h,colorInC:d,colorInD:u,colorOp:g,colorBias:_,colorScale:S,colorClamp:b,colorRegId:x,alphaInA:m,alphaInB:p,alphaInC:f,alphaInD:A,alphaOp:T,alphaBias:y,alphaScale:C,alphaClamp:M,alphaRegId:U,texCoordId:I,texMap:D,channelId:l,konstColorSel:o,konstAlphaSel:i,indTexStage:0,indTexMatrix:0,indTexFormat:0,indTexBiasSel:0,indTexWrapS:0,indTexWrapT:0,indTexAddPrev:!1,indTexUseOrigLOD:!1};w.push(R)}e.goTo(v);const x=e.readUint32();l.assert(x<=8);const T=[];for(let t=0;t<x;t++){const t=e.readUint32(),a=t>>>0&15,r=t>>>4&15,n=30+(t>>>9&31),s=!!(t>>>14&1),i=64+(t>>>15&63);T.push({type:a,source:r,matrix:n,normalize:s,postMatrix:i})}e.readUint32();const C=e.readUint32(),M=A(e,C),U=`PrimeGen_${t}`,k=1,D=!!(16&r),I=!!(512&r),R=!!(128&r),B=!!(32&r),P=[];P.push(f.colorNewFromRGBA(0,0,0,0)),P.push(f.colorNewFromRGBA(1,1,1,0)),P.push(f.colorNewFromRGBA(1,1,1,0)),P.push(f.colorNewFromRGBA(0,0,0,0));const E={name:U,cullMode:k,lightChannels:S,texGens:T,tevStages:w,alphaTest:{op:1,compareA:B?4:7,referenceA:.25,compareB:0,referenceB:0},ropInfo:{fogType:0,fogAdjEnabled:!1,blendMode:D?1:0,blendSrcFactor:g,blendDstFactor:p,blendLogicOp:0,depthTest:!0,depthFunc:1,depthWrite:R&&!D},indTexStages:[]},F=!!(8192&r),V=!1;d.push({isOccluder:I,isTransparent:D,isUVShort:F,isWhiteAmb:V,groupIndex:u,textureIndexes:i,vtxAttrFormat:o,gxMaterial:E,uvAnimations:M,colorRegisters:P,colorConstants:m}),l.assert(e.tell()-h===c[t])}return{textures:n,textureRemapTable:i,materials:d}}(e,t,a):function(e,t){const a=e.readUint32(),r=[],n=[],s=[];for(let i=0;i<a;i++){const a=e.readUint32(),o=e.tell()+a,c=e.readUint32(),h=e.readUint32();e.skip(4);const d=e.readUint32();e.skip(12);let u=0;const m=[];m.push(f.colorNewFromRGBA(1,1,1,1)),m.push(f.colorNewFromRGBA(0,0,0,0)),m.push(f.colorNewFromRGBA(0,0,0,0)),m.push(f.colorNewFromRGBA(0,0,0,0));const p=[],g=[],_=[],S=[],b=[];let v=!1,w=!1;for(;;){const a=e.readFourCC();if("END "===a){l.assert(e.tell()===o);break}if("PASS"===a){const a=e.readUint32(),s=e.tell()+a,i=e.readFourCC(),o=e.readUint32(),h=e.readAssetID(),d=4+e.readUint32()&15,m=e.readUint32();let f=null;if(0!==m){const t=e.tell()+m,a=(e.readUint16(),e.readUint16(),A(e,1));0!==a.length&&(f=a[0]),e.goTo(t)}l.assert(e.tell()===s);const v=t.loadAssetByID(h,"TXTR");let x;null!==v?(x=r.indexOf(v),x<0&&(x=r.push(v)-1,n[x]=x)):x=-1;let y=!1;if(null!==f)switch(f.type){case 1:case 0:case 6:case 7:y=!0}p[u]={type:1,source:d,matrix:30+3*u,postMatrix:64+3*u,normalize:y},g[u]=T(u,i,o,c,w),_[u]=x,S[u]=f,b[u]=i,u++,"DIFF"===i&&(w=!0)}else if("CLR "===a){const t=e.readFourCC(),a=e.readUint32();"DIFB"===t&&f.colorFromRGBA8(m[0],a)}else{if("INT "!==a)throw"whoops";{const t=e.readFourCC(),a=e.readUint32();"OPAC"===t&&(m[1].a=a,v=!0)}}}0===u&&(p[0]={type:1,source:4,matrix:30,postMatrix:64,normalize:!1},g[0]=T(0,"NULL",0,c,w),S[0]=null,b[0]="NULL",u++);const x=`Prime3Gen_${i}`,y=1,C=!!(256&c),M=!!(32&c),U=!!(16&c),k=!!(8&c)||M,D=!0,I=[];I.push({colorChannel:{lightingEnabled:!0,ambColorSource:0,matColorSource:0,litMask:255,diffuseFunction:2,attenuationFunction:1},alphaChannel:{lightingEnabled:!1,ambColorSource:0,matColorSource:0,litMask:0,diffuseFunction:0,attenuationFunction:2}}),I.push({colorChannel:{lightingEnabled:!1,ambColorSource:0,matColorSource:0,litMask:0,diffuseFunction:0,attenuationFunction:2},alphaChannel:{lightingEnabled:!1,ambColorSource:0,matColorSource:0,litMask:0,diffuseFunction:0,attenuationFunction:2}});const R=[];R.push(f.colorNewFromRGBA(0,0,0,0)),R.push(f.colorNewFromRGBA(1,1,1,0)),R.push(f.colorNewFromRGBA(1,1,1,0)),R.push(f.colorNewFromRGBA(0,0,0,0));const B={name:x,cullMode:y,lightChannels:I,texGens:p,tevStages:g,alphaTest:{op:1,compareA:U?4:7,referenceA:.75,compareB:0,referenceB:0},ropInfo:{fogType:0,fogAdjEnabled:!1,blendMode:k?1:0,blendSrcFactor:M?1:4,blendDstFactor:M?1:5,blendLogicOp:0,depthTest:!0,depthFunc:1,depthWrite:D&&!k},indTexStages:[]},P=!1,E=!!(524288&c);s.push({isOccluder:C,isTransparent:k,isUVShort:P,isWhiteAmb:E,groupIndex:h,textureIndexes:_,vtxAttrFormat:d,gxMaterial:B,uvAnimations:S,passTypes:b,colorRegisters:R,colorConstants:m})}return{textures:r,textureRemapTable:n,materials:s}}(e,t)}t.AreaLight=w,t.parseLightLayer=x,t.parse=function(e,t){l.assert(3735928559===e.readUint32());const a=e.readUint32();l.assert(15===a||25===a||30===a||32===a),e.skip(48);const r=e.readUint32();let n=a>=25?e.readUint32():0;const s=e.readUint32();let h=-1,d=-1,p=-1,f=-1,A=-1;a<=25&&(h=e.readUint32(),p=e.readUint32(),a>=25&&e.skip(4),f=e.readUint32(),e.skip(4),A=e.readUint32(),e.skip(25===a?20:12));const _=a>=25?e.readUint32():0,S=a>=30?e.readUint32():0;e.align(32);const w=[];for(let t=0;t<s;t++){const t=e.readUint32();w.push(t)}e.align(32);let T=null;if(_>0){const t=l.align(e.tell()+l.align(16*_,32)+l.align(8*S,32),32),r=function(e,t,a,r){const n=[];let s=0;for(let i=0;i<a;i++){e.readUint32();const a=e.readUint32(),i=e.readUint32(),o=(e.readUint32(),e.tell());if(s+=a,0===i)n.push(e.getBuffer().createTypedArray(Uint8Array,t,a)),t+=a;else{t+=l.align(i,32)-i;let s=a;for(;s>0;){e.goTo(t),t+=2;let a=e.readInt16();if(a<0)a=-a,n.push(e.getBuffer().createTypedArray(Uint8Array,t,a)),t+=a,s-=a;else if(r){const r=e.getBuffer().subarray(t,a),i=m.decompress(r,16384);n.push(i.createTypedArray(Uint8Array)),t+=a,s-=i.byteLength}else{const r=e.getBuffer().createTypedArray(Uint8Array,t,a),i=u.inflate(r);n.push(i),t+=a,s-=i.byteLength}}e.goTo(o)}}const i=new Uint8Array(s);let o=0;for(let e=0;e<n.length;e++)i.set(n[e],o),o+=n[e].byteLength;return l.assert(o===s),i}(e,t,_,32!==a);T=new c.default(r.buffer),e.align(32)}if(a>=30){for(let t=0;t<S;t++){const t=e.readFourCC(),a=e.readUint32();switch(t){case"WOBJ":h=a;break;case"GPUD":d=a;break;case"SOBJ":p=a;break;case"COLI":f=a;break;case"LITE":A=a}}e.align(32)}null!==T&&e.setBuffer(T);const M=[e.tell()];for(let e=1;e<s;e++){const t=M[e-1],a=w[e-1];M.push(l.align(t+a,32))}l.assert(0===h);const U=M[h+0];e.goTo(U);const k=C(e,t,function(e){if(15===e)return y.MP1;if(25===e)return y.MP2;if(30===e)return y.MP3;if(32===e)return y.DKCR;throw"whoops"}(a));let D;D=a<30?function(e,t,a,r,n,s){let i=[];for(let o=0;o<t;o++){const t=r[a++];let o,l,c;e.goTo(t),[o,l,c]=g(e);const h=i.length;let d;[d,a]=b(e,n,r,!1,!0,s>=25,!1,a,h),i.push({geometry:d,modelMatrix:l,bbox:c})}return i}(e,r,h+1,M,k,a):function(e,t,a,r,n,s,i){let o=[];for(let l=0;l<t;l++){const t=n[a++];let l,c,h;e.goTo(t),[l,c,h]=g(e);const d=o.length;let u;[u,a,r]=v(e,s,n,32===i,a,r,d),o.push({geometry:u,modelMatrix:c,bbox:h})}return o}(e,r,h+1,d,M,k,a);const I=[];if(15===a){const a=M[p];e.goTo(a);const r=e.readFourCC(),s=e.readUint32();l.assert("SCLY"===r),l.assert(1===s),n=e.readUint32();const o=[];for(let t=0;t<n;t++)o.push(e.readUint32());for(let a=0;a<n;a++){const r=e.tell()+o[a],n=i.parseScriptLayer_MP1(e.getBuffer(),e.tell(),t);I.push(n),e.goTo(r)}}else{let r=p;for(let s=0;s<n;s++){const n=M[r];e.goTo(n),r++;const o=e.readFourCC();e.skip(1);const c=e.readUint32();l.assert("SCLY"==o),l.assert(c==s);const h=i.parseScriptLayer_MP2(e,a,t);I.push(h)}}const R=[];let B=null;if(a<32){const t=M[f];e.goTo(t),B=o.parseAreaCollision(e);const r=M[A];e.goTo(r);const n=e.readUint32();l.assert(3133071021===n);const s=a<=25?2:a<=30?4:8;for(let t=0;t<s;t++){const t=x(e,a);R.push(t)}}return{materialSet:k,worldModels:D,scriptLayers:I,collision:B,lightLayers:R}},function(e){e[e.MP1=0]="MP1",e[e.MP2=1]="MP2",e[e.MP3=2]="MP3",e[e.DKCR=3]="DKCR"}(y=t.GameVersion||(t.GameVersion={})),t.parseMaterialSet=C},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(12),s=a(1);var i;!function(e){e[e.Solid=1]="Solid",e[e.FlippedTri=2]="FlippedTri",e[e.ShootThru=4]="ShootThru",e[e.SeeThru=8]="SeeThru"}(i=t.CollisionMaterial||(t.CollisionMaterial={}));class o{}t.CollisionEdge=o;class l{}t.CollisionTri=l;class c{constructor(){this.materials=[],this.vertexMaterialIDs=[],this.edgeMaterialIDs=[],this.triMaterialIDs=[],this.vertices=[],this.edges=[],this.tris=[]}}t.CollisionIndexData=c;class h{constructor(){this.type=2,this.triangles=[]}}t.CollisionOctreeLeaf=h;class d{constructor(){this.type=1,this.children=[null,null,null,null,null,null,null,null]}}t.CollisionOctreeBranch=d;class u{}function m(e){const t=new n.AABB;return t.minX=e.readFloat32(),t.minY=e.readFloat32(),t.minZ=e.readFloat32(),t.maxX=e.readFloat32(),t.maxY=e.readFloat32(),t.maxZ=e.readFloat32(),t}function p(e){const t=new u;t.bounds=m(e);const a=e.readUint32(),r=e.readUint32(),n=e.tell()+r;return t.rootNode=function e(t,a){if(0===a)return null;if(1===a){const a=new d;let r=t.readUint16();t.skip(2);const n=[];for(let e=0;e<8;e++)n.push(t.readUint32());const s=t.tell();for(let i=0;i<8;i++){const o=3&r;r>>=2,t.goTo(s+n[i]),a.children[i]=e(t,o)}return a}if(2===a){const e=new h;e.bounds=m(t);const a=t.readUint16();for(let r=0;r<a;r++)e.triangles.push(t.readUint16());return e}throw new Error(`Invalid octree node type: ${a}`)}(e,a),e.goTo(n),t}t.CollisionOctree=u,t.parseAreaCollision=function(e){r.assert(16777216===e.readUint32()),e.readUint32();const t=e.readUint32(),a=e.readUint32();return r.assert(3736058558===t),a>=5?null:{octree:p(e),indexData:function(e,t){const a=new c,r=e.readUint32();for(let n=0;n<r;n++)if(3===t){let t=0;const r=e.readUint32();262144&r&&(t|=i.ShootThru),524288&r&&(t|=i.Solid),33554432&r&&(t|=i.FlippedTri),67108864&r&&(t|=i.SeeThru),a.materials.push(t)}else{let t=i.Solid;e.readUint32();const r=e.readUint32();1048576&r&&(t|=i.ShootThru),16777216&r&&(t|=i.FlippedTri),67108864&r&&(t|=i.SeeThru),a.materials.push(t)}const n=e.readUint32();for(let t=0;t<n;t++)a.vertexMaterialIDs.push(e.readUint8());const h=e.readUint32();for(let t=0;t<h;t++)a.edgeMaterialIDs.push(e.readUint8());const d=e.readUint32();for(let t=0;t<d;t++)a.triMaterialIDs.push(e.readUint8());const u=e.readUint32();for(let t=0;t<u;t++){let t=new o;t.v0=e.readUint16(),t.v1=e.readUint16(),a.edges.push(t)}const m=e.readUint32()/3;for(let t=0;t<m;t++){let t=new l;t.e0=e.readUint16(),t.e1=e.readUint16(),t.e2=e.readUint16(),a.tris.push(t)}if(t>=4){const t=e.readUint32();e.skip(2*t)}const p=e.readUint32();for(let t=0;t<p;t++){let t=s.vec3.create();const r=e.readFloat32(),n=e.readFloat32(),i=e.readFloat32();s.vec3.set(t,r,n,i),a.vertices.push(t)}return a}(e,a)}};const f=s.vec3.create(),A=s.vec3.create(),g=s.vec3.create(),_=s.vec3.create(),S=s.vec3.create(),b=s.vec3.create(),v=s.vec3.create();function w(e,t,a,r,n,i){const o=f,l=A,c=g,h=_,d=S,u=b;s.vec3.sub(o,n,r),s.vec3.sub(l,i,r),s.vec3.sub(c,t,a),s.vec3.cross(h,o,l);const m=s.vec3.dot(c,h);if(m<=0)return!1;s.vec3.sub(d,t,r);let p=s.vec3.dot(d,h);if(p<0||p>m)return!1;s.vec3.cross(u,c,d);let v=s.vec3.dot(l,u);if(v<0||v>m)return!1;let w=-s.vec3.dot(o,u);if(w<0||v+w>m)return!1;const x=1/m;p*=x,v*=x,w*=x;let T=1-v-w;return s.vec3.set(e,T,v,w),!0}function x(e,t,a){const r=f;s.vec3.set(r,(a.minX+a.maxX)/2,(a.minY+a.maxY)/2,(a.minZ+a.maxZ)/2);const n=A;s.vec3.set(n,a.maxX-r[0],a.maxY-r[1],a.maxZ-r[2]);const i=g;s.vec3.add(i,e,t),s.vec3.scale(i,i,.5);const o=_;s.vec3.sub(o,t,i),s.vec3.sub(i,i,r);let l=Math.abs(o[0]);if(Math.abs(i[0])>n[0]+l)return!1;let c=Math.abs(o[1]);if(Math.abs(i[1])>n[1]+c)return!1;let h=Math.abs(o[2]);return!(Math.abs(i[2])>n[2]+h)&&(l+=1.192092896e-7,c+=1.192092896e-7,h+=1.192092896e-7,!(Math.abs(i[1]*o[2]-i[2]*o[1])>n[1]*h+n[2]*c)&&(!(Math.abs(i[2]*o[0]-i[0]*o[2])>n[0]*h+n[2]*l)&&!(Math.abs(i[0]*o[1]-i[1]*o[0])>n[0]*c+n[1]*l)))}const T=new n.AABB;t.areaCollisionLineCheck=function(e,t,a){return function e(t,a,r,n,s){if(null===r)return!1;if(!x(t,a,n))return!1;if(1===r.type){const i=r,o=n.minX,l=n.minY,c=n.minZ,h=n.maxX,d=n.maxY,u=n.maxZ,m=(o+h)/2,p=(l+d)/2,f=(c+u)/2;for(let r=0;r<8;r++){const n=T;if(n.minX=1&r?m:o,n.maxX=1&r?h:m,n.minY=2&r?p:l,n.maxY=2&r?d:p,n.minZ=4&r?f:c,n.maxZ=4&r?u:f,e(t,a,i.children[r],n,s))return!0}return!1}{const e=r;if(!x(t,a,e.bounds))return!1;const n=s.indexData;for(let r=0;r<e.triangles.length;r++){const s=e.triangles[r],o=n.tris[s],l=n.triMaterialIDs[s],c=n.materials[l],h=0!=(c&i.Solid),d=0!=(c&i.FlippedTri);if(!h)continue;const u=n.edges[o.e0],m=n.edges[o.e1];n.edges[o.e2];let p=u.v0,f=u.v1,A=m.v0!==p&&m.v0!==f?m.v0:m.v1;if(d){const e=p;p=A,A=e}const g=n.vertices[p],_=n.vertices[f],S=n.vertices[A];if(w(v,t,a,g,_,S)){v[0],g[0],v[1],_[0],v[2],S[0],v[0],g[1],v[1],_[1],v[2],S[1],v[0],g[2],v[1],_[2],v[2],S[2];return!0}}return!1}}(e,t,a.octree.rootNode,a.octree.bounds,a)}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=r(a(15)),i=a(0),o=a(5),l=a(12),c=a(10),h=a(6),d=a(17),u=a(7),m=a(8),p=a(16),f=a(4),A=a(2),g=a(5),_=a(178),S=n.mat4.fromValues(1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1),b=n.mat4.create();n.mat4.mul(b,S,n.mat4.fromScaling(n.mat4.create(),[1,1,1]));const v=n.mat4.clone(S);class w extends o.GXTextureHolder{addMaterialSetTextures(e,t){this.addTextures(e,t.textures)}}t.RetroTextureHolder=w;const x=n.vec3.create();class T{constructor(e,t,a){if(this.ambient=f.colorNewCopy(f.TransparentBlack),this.lights=[],3===t.options)f.colorCopy(this.ambient,f.OpaqueBlack);else if(0===a.lightLayers.length)f.colorCopy(this.ambient,f.White);else{const r=t.layerIdx,n=a.lightLayers[r];f.colorMult(this.ambient,n.ambientColor,t.ambient);const s=[];for(let r=0;r<n.lights.length;r++){const i=n.lights[r],o=l.squaredDistanceFromPointToAABB(i.gxLight.Position,e);if(o<i.radius*i.radius)if(i.castShadows&&2!=t.options){e.centerPoint(x);let t=!0;t&&null!==a.collision&&(t=!_.areaCollisionLineCheck(i.gxLight.Position,x,a.collision)),t&&s.push({sqDist:o,light:i})}else s.push({sqDist:o,light:i})}s.sort((e,t)=>e.sqDist-t.sqDist);for(let e=0;e<s.length&&e<8;e++)this.lights.push(s[e].light)}}}const y=n.mat4.create(),C=n.mat4.create(),M=new l.AABB;class U{constructor(e,t,a,r,n){this.surface=a,this.bbox=n,this.shapeHelper=new g.GXShapeHelperGfx(e,t,r,a.loadedVertexLayout,a.loadedVertexData)}destroy(e){this.shapeHelper.destroy(e)}}class k{constructor(e,t,a,r){this.surfaceData=e,this.materialInstance=t,this.materialGroupInstance=a,this.modelMatrix=r,this.packetParams=new o.PacketParams,this.materialTextureKey=t.textureKey}prepareToRender(e,t,a,r){if(!this.materialInstance.visible)return;let s;if(r)s=v,n.mat4.mul(C,s,this.modelMatrix);else if(s=b,n.mat4.mul(C,s,this.modelMatrix),M.transform(this.surfaceData.bbox,C),!a.camera.frustum.contains(M))return;const i=y;r?m.computeViewMatrixSkybox(i,a.camera):m.computeViewMatrix(i,a.camera);const o=t.renderInstManager.pushRenderInst();this.surfaceData.shapeHelper.setOnRenderInst(o),this.materialGroupInstance.setOnRenderInst(e,t.renderInstManager.gfxRenderCache,o),n.mat4.mul(this.packetParams.u_PosMtx[0],i,C),this.surfaceData.shapeHelper.fillPacketParams(this.packetParams,o),o.sortKey=u.setSortKeyDepthKey(o.sortKey,this.materialTextureKey),o.setSamplerBindingsFromTextureMappings(this.materialInstance.textureMappings),t.renderInstManager.submitRenderInst(o)}}const D=n.mat4.create(),I=new o.MaterialParams;class R{constructor(e,t,a){this.material=t,this.materialParamsBlockOffs=0,this.materialHelper=new g.GXMaterialHelperGfx(this.material.gxMaterial,a),this.gfxSampler=e.createSampler({minFilter:1,magFilter:1,mipFilter:2,minLOD:0,maxLOD:100,wrapS:1,wrapT:1})}destroy(e){e.destroySampler(this.gfxSampler)}setOnRenderInst(e,t,a){this.materialHelper.setOnRenderInst(e,t,a),a.setUniformBufferOffset(o.ub_MaterialParams,this.materialParamsBlockOffs,this.materialHelper.materialParamsBufferSize);const r=this.material.isTransparent?128:32;a.sortKey=u.makeSortKey(r,this.materialHelper.programKey)}prepareToRender(e,t,a,r,s,i){if(this.materialParamsBlockOffs=this.materialHelper.allocateMaterialParamsBlock(e),f.colorCopy(I.u_Color[o.ColorKind.MAT0],f.White),r)f.colorCopy(I.u_Color[o.ColorKind.AMB0],f.White);else{null!==s?f.colorCopy(I.u_Color[o.ColorKind.AMB0],s.ambient):this.material.isWhiteAmb?f.colorCopy(I.u_Color[o.ColorKind.AMB0],f.White):f.colorCopy(I.u_Color[o.ColorKind.AMB0],i);const e=D;n.mat4.mul(e,t.camera.viewMatrix,b);for(let t=0;t<8;t++)if(null!==s&&t<s.lights.length){const a=s.lights[t].gxLight;I.u_Lights[t].copy(a),p.lightSetWorldPositionViewMatrix(I.u_Lights[t],e,a.Position[0],a.Position[1],a.Position[2]),p.lightSetWorldDirectionNormalMatrix(I.u_Lights[t],e,a.Direction[0],a.Direction[1],a.Direction[2])}else I.u_Lights[t].reset()}for(let e=0;e<4;e++)f.colorCopy(I.u_Color[o.ColorKind.CPREV+e],this.material.colorRegisters[e]);for(let e=0;e<4;e++)f.colorCopy(I.u_Color[o.ColorKind.K0+e],this.material.colorConstants[e]);const l=t.time/1e3%900;for(let e=0;e<8;e++){const r=I.u_TexMtx[e],s=I.u_PostTexMtx[e];n.mat4.identity(r),n.mat4.identity(s);const i=this.material.uvAnimations[e];if(i)if(0===i.type)n.mat4.mul(r,t.camera.viewMatrix,b),n.mat4.mul(r,r,a),A.computeNormalMatrix(r,r),A.texEnvMtx(s,.5,-.5,.5,.5);else if(1===i.type)n.mat4.mul(r,t.camera.viewMatrix,b),n.mat4.mul(r,r,a),A.computeNormalMatrix(r,r),n.mat4.invert(D,t.camera.viewMatrix),n.vec3.set(x,a[12],a[13],a[14]),n.vec3.transformMat4(x,x,D),r[12]=x[0],r[13]=x[1],r[14]=x[2],A.texEnvMtx(s,.5,-.5,.5,.5);else if(2===i.type){const e=l*i.scaleS+i.offsetS,t=l*i.scaleT+i.offsetT;r[12]=e,r[13]=t}else if(3===i.type){const e=l*i.scale+i.offset,t=Math.cos(e),a=Math.sin(e);r[0]=t,r[4]=-a,r[12]=.5*(1-(t-a)),r[1]=a,r[5]=t,r[13]=.5*(1-(a+t))}else if(4===i.type){const e=i.step*i.scale*(i.offset+l),t=Math.floor(i.numFrames*(e%1))*i.step;r[12]=t}else if(5===i.type){const e=i.step*i.scale*(i.offset+l),t=Math.floor(i.numFrames*(e%1))*i.step;r[13]=t}else if(6===i.type)n.mat4.copy(r,a),r[12]=0,r[13]=0,r[14]=0,A.texEnvMtx(s,.5,-.5,.5*a[12],.5*a[13]);else if(7===i.type){n.mat4.mul(r,t.camera.viewMatrix,b),n.mat4.mul(r,r,a),A.computeNormalMatrix(r,r);const e=.025*(D[12]+D[14])*i.phi%1,o=.05*D[13]*i.phi%1,l=.5*i.theta;A.texEnvMtx(s,l,-l,e,o)}else if(8===i.type){const e=i.rotationStatic+l*i.rotationScroll,t=Math.sin(e),a=Math.cos(e);r[0]=i.scaleS*a,r[1]=i.scaleT*-t,r[4]=i.scaleS*t,r[5]=i.scaleT*a,r[12]=i.scaleS*(i.transTStatic+i.transSScroll*l)+(.5-.5*(a-t)),r[13]=i.scaleT*(i.transTStatic+i.transTScroll*l)+(.5-.5*(t+a))}}this.materialHelper.fillMaterialParamsData(e,this.materialParamsBlockOffs,I)}}class B{constructor(e,t,a,r){this.materialGroup=e,this.material=t,this.textureMappings=i.nArray(8,()=>new c.TextureMapping),this.visible=!0,this.textureKey=0;for(let n=0;n<t.textureIndexes.length;n++){const s=t.textureIndexes[n];if(-1===s)continue;const i=a.textures[a.textureRemapTable[s]];r.fillTextureMapping(this.textureMappings[n],i.name),this.textureMappings[n].gfxSampler=e.gfxSampler;const o=r.findTextureEntryIndex(i.name);this.textureKey=(this.textureKey|o<<30-10*n)>>>0}}}function P(e){let t=0,a=0,r=0;const n=[];for(let s=0;s<e.length;s++){const o=e[s];i.assert(o.loadedVertexLayout.vertexBufferStrides[0]===e[0].loadedVertexLayout.vertexBufferStrides[0]),t+=o.loadedVertexData.totalIndexCount,a+=o.loadedVertexData.totalVertexCount,r+=o.loadedVertexData.vertexBuffers[0].byteLength;for(let e=0;e<o.loadedVertexData.packets.length;e++){const a=o.loadedVertexData.packets[e],r=t+a.indexOffset,s=a.indexCount,i=a.posNrmMatrixTable,l=a.texMatrixTable;n.push({indexOffset:r,indexCount:s,posNrmMatrixTable:i,texMatrixTable:l})}}const s=new Uint8Array(r),o=new Uint32Array(t);let l=0,c=0,d=0;for(let t=0;t<e.length;t++){const a=e[t];i.assert(a.loadedVertexData.indexData.byteLength===2*a.loadedVertexData.totalIndexCount);const r=new Uint16Array(a.loadedVertexData.indexData);for(let e=0;e<r.length;e++)o[l++]=d+r[e];d+=a.loadedVertexData.totalVertexCount,i.assert(d<=4294967295),s.set(new Uint8Array(a.loadedVertexData.vertexBuffers[0]),c),c+=a.loadedVertexData.vertexBuffers[0].byteLength}const u={indexData:o.buffer,vertexBuffers:[s.buffer],totalIndexCount:t,totalVertexCount:a,vertexId:0,packets:n},m=Object.assign({},e[0].loadedVertexLayout);return m.indexFormat=h.GfxFormat.U32_R,{materialIndex:e[0].materialIndex,worldModelIndex:-1,loadedVertexLayout:m,loadedVertexData:u,origSurfaces:e}}t.ModelCache=class{constructor(){this.cmdlData=new Map}destroy(e){for(const[,t]of this.cmdlData.entries())t.destroy(e)}getCMDLData(e,t,a,r){return this.cmdlData.has(r.assetID)||this.cmdlData.set(r.assetID,new E(e,t,a,r)),this.cmdlData.get(r.assetID)}};t.MREARenderer=class{constructor(e,t,a,r,s,i){this.textureHolder=r,this.name=s,this.mrea=i,this.materialGroupInstances=[],this.materialInstances=[],this.surfaceData=[],this.surfaceInstances=[],this.cmdlData=[],this.actors=[],this.overrideSky=null,this.modelMatrix=n.mat4.create(),this.needSky=!1,this.visible=!0,this.translateModel(e,a),this.translateActors(e,a,t)}translateModel(e,t){const a=this.mrea.materialSet;this.textureHolder.addMaterialSetTextures(e,a);for(let t=0;t<a.materials.length;t++){const r=a.materials[t];void 0===this.materialGroupInstances[r.groupIndex]&&(this.materialGroupInstances[r.groupIndex]=new R(e,r))}this.materialInstances=a.materials.map(e=>{const t=this.materialGroupInstances[e.groupIndex];return new B(t,e,a,this.textureHolder)});const r=[];for(let e=0;e<this.mrea.worldModels.length;e++)for(let t=0;t<this.mrea.worldModels[e].geometry.surfaces.length;t++){this.materialInstances[this.mrea.worldModels[e].geometry.surfaces[t].materialIndex].material.isOccluder||r.push(this.mrea.worldModels[e].geometry.surfaces[t])}r.sort((e,t)=>e.materialIndex-t.materialIndex);const i=[],o=[],c=[];for(let e=0;e<r.length;){let t=e;const a=r[t].materialIndex;if(!this.materialInstances[a].material.isTransparent){for(;e<r.length&&r[e].materialIndex===a;)e++;c.push(P(r.slice(t,e)))}else c.push(r[e++])}for(let e=0;e<c.length;e++)i.push([new s.default(c[e].loadedVertexData.vertexBuffers[0])]),o.push(new s.default(c[e].loadedVertexData.indexData));this.bufferCoalescer=new d.GfxBufferCoalescerCombo(e,i,o);for(let a=0;a<c.length;a++){const r=c[a];let s;if(r.worldModelIndex>=0)s=this.mrea.worldModels[r.worldModelIndex].bbox;else{const e=r;s=new l.AABB;for(let t=0;t<e.origSurfaces.length;t++)s.union(s,this.mrea.worldModels[e.origSurfaces[t].worldModelIndex].bbox)}const i=new U(e,t,r,this.bufferCoalescer.coalescedBuffers[a],s);this.surfaceData.push(i);const o=this.materialInstances[c[a].materialIndex],h=this.materialGroupInstances[o.material.groupIndex],d=new k(i,o,h,n.mat4.create());this.surfaceInstances.push(d)}}translateActors(e,t,a){for(let r=0;r<this.mrea.scriptLayers.length;r++){const s=this.mrea.scriptLayers[r];for(let i=0;i<s.entities.length;i++){const o=s.entities[i],c=o.getRenderModel();if(null!==c){const r=new l.AABB;r.transform(c.bbox,o.modelMatrix);const n=new T(r,o.lightParams,this.mrea),s=a.getCMDLData(e,this.textureHolder,t,c),i=new F(e,this.textureHolder,n,o.name,o.modelMatrix,s),h=new V(o,i);this.actors.push(h)}if(78===o.type||"REAA"===o.type){const s=o;if(!this.needSky&&s.needSky&&(this.needSky=!0,null!==s.overrideSky)){const i=n.mat4.create(),o=a.getCMDLData(e,this.textureHolder,t,s.overrideSky);this.overrideSky=new F(e,this.textureHolder,null,`Sky_AreaAttributes_Layer${r}`,i,o),this.overrideSky.isSkybox=!0}}}}}setVisible(e){this.visible=e}prepareToRender(e,t,a,r){if(!this.visible)return;t.renderInstManager.pushTemplateRenderInst().filterKey=1;for(let e=0;e<this.materialGroupInstances.length;e++)this.materialGroupInstances[e].prepareToRender(t.renderInstManager,a,this.modelMatrix,!1,null,r);for(let r=0;r<this.surfaceInstances.length;r++)this.surfaceInstances[r].prepareToRender(e,t,a,!1);for(let r=0;r<this.actors.length;r++)this.actors[r].prepareToRender(e,t,a);t.renderInstManager.popTemplateRenderInst()}destroy(e){this.materialGroupInstances.forEach(t=>t.destroy(e)),this.bufferCoalescer.destroy(e);for(let t=0;t<this.cmdlData.length;t++)this.cmdlData[t].destroy(e);for(let t=0;t<this.actors.length;t++)this.actors[t].destroy(e);for(let t=0;t<this.surfaceData.length;t++)this.surfaceData[t].destroy(e);null!==this.overrideSky&&this.overrideSky.destroy(e)}};class E{constructor(e,t,a,r){this.cmdl=r,this.surfaceData=[];const n=this.cmdl.materialSets[0];t.addMaterialSetTextures(e,n);const i=[],o=[],l=this.cmdl.geometry.surfaces;for(let e=0;e<l.length;e++)i.push([new s.default(l[e].loadedVertexData.vertexBuffers[0])]),o.push(new s.default(l[e].loadedVertexData.indexData));this.bufferCoalescer=new d.GfxBufferCoalescerCombo(e,i,o);for(let t=0;t<l.length;t++){const r=this.bufferCoalescer.coalescedBuffers[t];this.surfaceData[t]=new U(e,a,l[t],r,this.cmdl.bbox)}}destroy(e){this.bufferCoalescer.destroy(e);for(let t=0;t<this.surfaceData.length;t++)this.surfaceData[t].destroy(e)}}t.CMDLData=E;class F{constructor(e,t,a,r,s,i){this.textureHolder=t,this.actorLights=a,this.name=r,this.cmdlData=i,this.materialGroupInstances=[],this.materialInstances=[],this.surfaceInstances=[],this.visible=!0,this.isSkybox=!1,this.modelMatrix=n.mat4.create();const o=this.cmdlData.cmdl.materialSets[0];for(let t=0;t<o.materials.length;t++){const a=o.materials[t];void 0===this.materialGroupInstances[a.groupIndex]&&(this.materialGroupInstances[a.groupIndex]=new R(e,a))}this.materialInstances=o.materials.map(e=>{const t=this.materialGroupInstances[e.groupIndex];return new B(t,e,o,this.textureHolder)});for(let e=0;e<this.cmdlData.surfaceData.length;e++){const t=this.cmdlData.surfaceData[e],a=t.surface,r=this.materialInstances[a.materialIndex],n=this.materialGroupInstances[r.material.groupIndex];r.material.isOccluder||this.surfaceInstances.push(new k(t,r,n,this.modelMatrix))}null!==s&&n.mat4.copy(this.modelMatrix,s)}setVisible(e){this.visible=e}prepareToRender(e,t,a){if(!this.visible)return;t.renderInstManager.pushTemplateRenderInst().filterKey=this.isSkybox?2:1;for(let e=0;e<this.materialGroupInstances.length;e++)void 0!==this.materialGroupInstances[e]&&this.materialGroupInstances[e].prepareToRender(t.renderInstManager,a,this.modelMatrix,this.isSkybox,this.actorLights,f.OpaqueBlack);for(let r=0;r<this.surfaceInstances.length;r++)this.surfaceInstances[r].prepareToRender(e,t,a,this.isSkybox);t.renderInstManager.popTemplateRenderInst()}destroy(e){this.materialGroupInstances.forEach(t=>t.destroy(e))}}t.CMDLRenderer=F;class V{constructor(e,t){this.entity=e,this.cmdlRenderer=t}prepareToRender(e,t,a){this.entity.active&&(this.entity.autoSpin&&n.mat4.rotateZ(this.cmdlRenderer.modelMatrix,this.entity.modelMatrix,a.time/1e3*8),this.cmdlRenderer.prepareToRender(e,t,a))}destroy(e){this.cmdlRenderer.destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.DataStream=class{constructor(e,t=e.createDataView(),a=0){this.buffer=e,this.view=t,this.offs=a}readUint8(){return this.view.getUint8(this.offs++)}readUint16(){const e=this.view.getUint16(this.offs,!0);return this.offs+=2,e}readUint32(){const e=this.view.getUint32(this.offs,!0);return this.offs+=4,e}readFloat32(){const e=this.view.getFloat32(this.offs,!0);return this.offs+=4,e}readString(e,t=e){const a=r.readString(this.buffer,this.offs,e,!1);return this.offs+=t,a}readStringStream_2b(){const e=this.readUint16();return this.readString(Math.max(e-1,0),e)}readStringStream_4b(){const e=this.readUint32();return this.readString(Math.max(e-1,0),e)}readSlice(e){const t=this.buffer.subarray(this.offs,e);return this.offs+=e,t}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(10),s=a(6),i=a(98);function o(e,t,a){var r=(t+3>>2)*(a+3>>2);return"DXT1"===e?8*r:"DXT3"===e||"DXT5"===e?16*r:"RGB"===e?t*a*3:0}function l(e,t){switch(e.format){case"DXT1":return i.decompressBC({type:"BC1",width:t.width,height:t.height,depth:1,flag:"SRGB",pixels:t.data.createTypedArray(Uint8Array)});case"DXT5":return i.decompressBC({type:"BC3",width:t.width,height:t.height,depth:1,flag:"SRGB",pixels:t.data.createTypedArray(Uint8Array)});default:return{type:"RGBA",width:t.width,height:t.height,depth:1,flag:"SRGB",pixels:new Uint8Array(t.width*t.height*4)}}}t.parse=function(e,t){const a=e.createDataView();r.assert("DDS "===r.readString(e,0,4)),r.assert(124===a.getUint32(4,!0));const n=a.getUint32(16,!0),s=a.getUint32(12,!0),i=a.getUint32(20,!0),l=Math.max(a.getUint32(28,!0),1),c=a.getUint32(76,!0);r.assert(32===c);const h=a.getUint32(80,!0);let d;if(4&h){const a=r.readString(e,84,4);"DXT1"!==a&&"DXT5"!==a&&console.log(`Unknown texture format ${a} in file ${t}`),d=a}else{if(!(64&h))throw"whoops";{const e=a.getUint32(88,!0);r.assert(24===e);const t=a.getUint32(92,!0);r.assert(16711680===t);const n=a.getUint32(96,!0);r.assert(65280===n);const s=a.getUint32(100,!0);r.assert(255===s),d="RGB"}}const u=[];let m=128,p=n,f=s;for(let t=0;t<l;t++){const a=o(d,p,f);0==t&&0!==a&&r.assert(a===i);const n=e.subarray(m,a);m+=a;const s={width:p,height:f,data:n};u.push(s),p>>=1,f>>=1,p=Math.max(p,1),f=Math.max(f,1)}return{name:t=t.toLowerCase(),width:n,height:s,format:d,levels:u}};class c extends n.TextureHolder{loadTexture(e,t){let a;a="RGB"===t.format?s.GfxFormat.U8_RGB_SRGB:"DXT1"===t.format&&e.queryTextureFormatSupported(s.GfxFormat.BC1_SRGB)?s.GfxFormat.BC1_SRGB:s.GfxFormat.U8_RGBA_SRGB;const r=[];for(let e=0;e<t.levels.length;e++){const n=t.levels[e];if(a===s.GfxFormat.BC1_SRGB||a===s.GfxFormat.BC3_SRGB)r.push(n.data.createTypedArray(Uint8Array));else{const e=l(t,n);r.push(e.pixels),e.pixels=null}n.data=null}const n=e.createTexture({dimension:0,pixelFormat:a,width:t.width,height:t.height,depth:1,numLevels:t.levels.length}),i=e.createHostAccessPass();i.uploadTextureData(n,0,r),e.submitPass(i);const o=new Map;return o.set("Format",t.format),{viewerTexture:{name:t.name,surfaces:[],extraInfo:o},gfxTexture:n}}}t.DDSTextureHolder=c},function(e,t,a){"use strict";function r(e,t){const a=window.URL.createObjectURL(t);!function(e,t){const a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",e),document.body.appendChild(a),a.click(),document.body.removeChild(a)}(e,a),window.URL.revokeObjectURL(a)}Object.defineProperty(t,"__esModule",{value:!0}),t.downloadBlob=r,t.downloadBufferSlice=function(e,t,a="application/octet-stream"){r(e,new Blob([t.createTypedArray(Uint8Array)],{type:a}))},t.downloadBuffer=function(e,t,a="application/octet-stream"){r(e,new Blob([t],{type:a}))}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(307));function s(e,t,a){const r=new Uint8Array(e,t);for(let e=0;e<a.length;e++)r[e]=a.charCodeAt(e)}function i(e,t){const a=e.data.byteLength,r=e.filename.length,n=new ArrayBuffer(30+r),i=new DataView(n);return s(n,0,"PK"),i.setUint16(4,20,!0),i.setUint32(14,t,!0),i.setUint32(18,a,!0),i.setUint32(22,a,!0),i.setUint16(26,r,!0),s(n,30,e.filename),n}function o(e,t,a){const r=e.data.byteLength,n=e.filename.length,i=new ArrayBuffer(46+n),o=new DataView(i);return s(i,0,"PK"),o.setUint16(4,2583,!0),o.setUint16(6,20,!0),o.setUint32(16,t,!0),o.setUint32(20,r,!0),o.setUint32(24,r,!0),o.setUint16(28,n,!0),o.setUint32(42,a,!0),s(i,46,e.filename),i}t.makeZipFile=function(e){const t=[],a=[],r=[];let l=0;for(let s=0;s<e.length;s++){const o=e[s],c=n.buf(new Uint8Array(o.data));r.push(c),a.push(l);const h=i(o,c);t.push(h),t.push(o.data),l+=h.byteLength+o.data.byteLength}const c=l;let h=0;for(let n=0;n<e.length;n++){const s=e[n],i=a[n],l=o(s,r[n],i);t.push(l),h+=l.byteLength}return t.push(function(e,t,a){const r=new ArrayBuffer(22),n=new DataView(r);return s(r,0,"PK"),n.setUint16(8,e,!0),n.setUint16(10,e,!0),n.setUint32(12,a,!0),n.setUint32(16,t,!0),r}(e.length,c,h)),function(e){let t=0;for(let a=0;a<e.length;a++)t+=e[a].byteLength;const a=new Uint8Array(t);let r=0;for(let t=0;t<e.length;t++)a.set(new Uint8Array(e[t]),r),r+=e[t].byteLength;return a.buffer}(t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(122),s=a(17),i=a(1),o=a(0);t.BackgroundPlaneData=class{constructor(e,t,a,r){if(this.name=t,this.dimensions=i.vec2.create(),this.frames=[],this.duration=0,this.texture=n.makeTextureFromXNA_Texture2D(e,a),null!==r){this.dimensions[0]=r.actualWidth,this.dimensions[1]=r.actualHeight;let e=0;for(let t=0;t<r.frames.length;t++){const n=r.frames[t],s=n.duration/1e7,[o,l,c,h]=n.rectangle,d=i.mat4.create();d[0]=c/a.width,d[5]=h/a.height,d[12]=o/a.width,d[13]=l/a.height,this.frames.push({time:e,texMatrix:d}),e+=s}this.duration=e}else{this.dimensions[0]=a.width,this.dimensions[1]=a.height;const e=i.mat4.create();this.frames.push({time:0,texMatrix:e}),this.duration=0}}calcTexMatrix(e,t){if(1===this.frames.length)i.mat4.copy(e,this.frames[0].texMatrix);else{const a=t%this.duration;let r=0;for(;r<this.frames.length&&!(this.frames[r].time>a);r++);o.assert(r>0),i.mat4.copy(e,this.frames[r-1].texMatrix)}}destroy(e){e.destroyTexture(this.texture)}};t.BackgroundPlaneStaticData=class{constructor(e,t){this.indexCount=6;const a=Float32Array.from([-.5,.5,0,0,0,1,0,0,.5,.5,0,0,0,1,1,0,.5,-.5,0,0,0,1,1,1,-.5,-.5,0,0,0,1,0,1]),n=Uint16Array.from([0,1,2,2,3,0]);this.vertexBuffer=s.makeStaticDataBuffer(e,2,a.buffer),this.indexBuffer=s.makeStaticDataBuffer(e,1,n.buffer);const i=[{location:0,bufferIndex:0,format:r.GfxFormat.F32_RGB,bufferByteOffset:0},{location:1,bufferIndex:0,format:r.GfxFormat.F32_RGB,bufferByteOffset:12},{location:2,bufferIndex:0,format:r.GfxFormat.F32_RG,bufferByteOffset:24}];this.inputLayout=t.createInputLayout(e,{indexBufferFormat:r.GfxFormat.U16_R,vertexAttributeDescriptors:i,vertexBufferDescriptors:[{byteStride:32,frequency:1}]}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}destroy(e){e.destroyBuffer(this.vertexBuffer),e.destroyBuffer(this.indexBuffer),e.destroyInputState(this.inputState)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(7),s=a(122),i=a(20),o=a(22),l=a(10),c=a(0),h=a(13),d=a(2),u=a(14),m=[{numSamplers:1,numUniformBuffers:1}];class p extends i.DeviceProgram{constructor(){super(...arguments),this.both="\nlayout(row_major, std140) uniform ub_Params {\n    vec4 u_ScaleOffset;\n    vec4 u_Misc[1];\n};\n\n#define u_Alpha (u_Misc[0].x)\n\nuniform sampler2D u_Texture;\n",this.vert=`\nout vec2 v_TexCoord;\n\nvoid main() {\n    vec2 p;\n    p.x = (gl_VertexID == 1) ? 2.0 : 0.0;\n    p.y = (gl_VertexID == 2) ? 2.0 : 0.0;\n    gl_Position.xy = p * vec2(2) - vec2(1);\n    gl_Position.zw = vec2(${o.reverseDepthForDepthOffset(1)}, 1);\n    v_TexCoord = p * u_ScaleOffset.xy + u_ScaleOffset.zw;\n}\n`,this.frag="\nin vec2 v_TexCoord;\n\nvoid main() {\n    vec4 color = texture(u_Texture, v_TexCoord);\n    gl_FragColor = vec4(color.rgb, u_Alpha);\n}\n"}}p.ub_Params=0;class f{constructor(e,t,a,r,n,i){this.name=a,this.backgroundTextureMapping=c.nArray(1,()=>new l.TextureMapping),this.starsTextureMapping=c.nArray(1,()=>new l.TextureMapping),this.shadowsTextureMapping=c.nArray(1,()=>new l.TextureMapping),this.backgroundProgram=e.createProgram(new p),this.backgroundTexture=s.makeTextureFromXNA_Texture2D(e,r),this.backgroundTextureMapping[0].gfxTexture=this.backgroundTexture,this.backgroundTextureMapping[0].gfxSampler=t.createSampler(e,{wrapS:1,wrapT:0,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:0}),this.starsTexture=null!==n?s.makeTextureFromXNA_Texture2D(e,n):null,this.starsTextureMapping[0].gfxTexture=this.starsTexture,this.starsTextureMapping[0].gfxSampler=t.createSampler(e,{wrapS:1,wrapT:1,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:0}),this.shadowsTexture=null!==i?s.makeTextureFromXNA_Texture2D(e,i):null,this.shadowsTextureMapping[0].gfxTexture=this.shadowsTexture,this.shadowsTextureMapping[0].gfxSampler=t.createSampler(e,{wrapS:1,wrapT:1,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:0})}destroy(e){e.destroyProgram(this.backgroundProgram),e.destroyTexture(this.backgroundTexture),null!==this.starsTexture&&e.destroyTexture(this.starsTexture),null!==this.shadowsTexture&&e.destroyTexture(this.shadowsTexture)}}function A(e,t,a=1,r=1,n=0,s=0,i=1){let o=e.allocateUniformBuffer(p.ub_Params,8);const l=e.mapUniformBufferF32(p.ub_Params),c=t.backbufferWidth/t.backbufferHeight;o+=h.fillVec4(l,o,a*c,r*c,n,s+1),o+=h.fillVec4(l,o,i)}t.SkyData=f;t.SkyRenderer=class{constructor(e){this.skyData=e}prepareToRender(e,t){const a=e.pushTemplateRenderInst();a.drawPrimitives(3),a.setInputLayoutAndState(null,null),a.setBindingLayouts(m),a.setGfxProgram(this.skyData.backgroundProgram);const s=(t.time/4e4+.5)%1,i=e.pushRenderInst();i.sortKey=n.makeSortKeyOpaque(0,this.skyData.backgroundProgram.ResourceUniqueId),i.setSamplerBindingsFromTextureMappings(this.skyData.backgroundTextureMapping);if(A(i,t,1e-4,1,s,0),null!==this.skyData.starsTexture){const a=function(e,t){c.assert(t>=0&&t<=1);let a=function(e){if(3===e)return.75;if(2===e)return 5/24;if(1===e)return 2/24;if(0===e)return 20/24;throw"whoops"}(e),r=function(e){if(3===e)return 22/24;if(2===e)return 20/24;if(1===e)return.25;if(0===e)return 4/24;throw"whoops"}(e);return r<a&&(r++,t<a&&t++),function(e){return e<0||e>1?0:e<1/3?3*e:e>2/3?3*(1-e):1}(d.invlerp(a,r,t))}(0,s);if(a>0){const s=e.pushRenderInst();s.sortKey=n.makeSortKeyOpaque(1,this.skyData.backgroundProgram.ResourceUniqueId),u.setAttachmentStateSimple(s.getMegaStateFlags(),{blendMode:r.GfxBlendMode.ADD,blendSrcFactor:r.GfxBlendFactor.SRC_ALPHA,blendDstFactor:r.GfxBlendFactor.ONE_MINUS_SRC_ALPHA}),s.setSamplerBindingsFromTextureMappings(this.skyData.starsTextureMapping);const i=t.camera.viewMatrix;A(s,t,.5,.5,Math.atan2(-i[2],i[0])/6.283*4,0,a)}}e.popTemplateRenderInst()}},t.fetchSkyData=async function(e,t,a,r){const n=`xnb/skies/${r}`,s=await e.fetchXNB(`xnb/skies/${r}.xnb`),i=s.background.toLowerCase(),o=await e.fetchXNB(`${n}/${i}.xnb`),l=null!==s.stars?await e.fetchXNB(`${n}/${s.stars.toLowerCase()}.xnb`):null,c=null!==s.shadows?await e.fetchXNB(`${n}/${s.shadows.toLowerCase()}.xnb`):null;return new f(t,a,r,o,l,c)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(12),s=a(17);function i(e){let t=0;for(let a=0;a<e.length;a++)t+=e[a].length;const a=new Float32Array(t);let r=0;for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)a[r++]=e[t][n];return a}t.GeometryData=class{constructor(e,t,a){this.bbox=new n.AABB,this.indexCount=a.indices.length;const o=a.vertices,l=o.map(e=>e.position),c=o.map(e=>e.normal),h=o.map(e=>e.texcoord);this.bbox.setFromPoints(l);const d=i(l),u=i(c),m=i(h),p=Uint32Array.from(a.indices);this.indexCount=p.length,this.positionBuffer=s.makeStaticDataBuffer(e,2,d.buffer),this.normalBuffer=s.makeStaticDataBuffer(e,2,u.buffer),this.texcoordBuffer=s.makeStaticDataBuffer(e,2,m.buffer),this.indexBuffer=s.makeStaticDataBuffer(e,1,p.buffer);const f=[{location:0,bufferIndex:0,format:r.GfxFormat.F32_RGB,bufferByteOffset:0},{location:1,bufferIndex:1,format:r.GfxFormat.F32_RGB,bufferByteOffset:0},{location:2,bufferIndex:2,format:r.GfxFormat.F32_RG,bufferByteOffset:0}];this.inputLayout=t.createInputLayout(e,{indexBufferFormat:r.GfxFormat.U32_R,vertexAttributeDescriptors:f,vertexBufferDescriptors:[{byteStride:12,frequency:1},{byteStride:12,frequency:1},{byteStride:8,frequency:1}]}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.positionBuffer,byteOffset:0},{buffer:this.normalBuffer,byteOffset:0},{buffer:this.texcoordBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}destroy(e){e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.positionBuffer),e.destroyBuffer(this.normalBuffer),e.destroyBuffer(this.texcoordBuffer),e.destroyInputState(this.inputState)}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15)),s=a(0),i=a(315),o=a(1),l=a(4);function c(e){let t,a=null,r=null;const n=e.indexOf("[[");if(n>0){const i=e.indexOf("`");s.assert(i>=0);const o=Number(e.slice(i+1,n));t=e.slice(0,i);const l=e.indexOf("]]");s.assert(l>=0),a=e.slice(l+4),r=[];for(let t=n+1;t<l-1;){s.assert("["===e.charAt(t));const a=e.indexOf("]",t);r.push(c(e.slice(t+1,a))),t=a+1;const n=e.charAt(t);if(s.assert(","===n||"]"===n),","===n)t++;else if("]"===n)break}s.assert(r.length===o)}else{const r=e.indexOf(", ");r>=0?(t=e.slice(0,r),a=e.slice(r+2)):(t=e,a=null)}return{className:t,ns:a,params:r}}t.ContentTypeReaderManager=class{constructor(){this.directByReaderName=new Map,this.directByTypeName=new Map,this.genericByReaderName=new Map,this.valueTypes=new Set,this.RegisterTypeReaderValueType(d,"System.Boolean","Microsoft.Xna.Framework.Content.BooleanReader"),this.RegisterTypeReaderValueType(u,"System.UInt16","Microsoft.Xna.Framework.Content.UInt16Reader"),this.RegisterTypeReaderValueType(m,"System.UInt32","Microsoft.Xna.Framework.Content.UInt32Reader"),this.RegisterTypeReaderValueType(p,"System.Int32","Microsoft.Xna.Framework.Content.Int32Reader"),this.RegisterTypeReaderValueType(A,"System.Enum","Microsoft.Xna.Framework.Content.EnumReader"),this.RegisterTypeReaderValueType(f,"System.TimeSpan","Microsoft.Xna.Framework.Content.TimeSpanReader"),this.RegisterTypeReaderDirect(g,"System.String","Microsoft.Xna.Framework.Content.StringReader"),this.RegisterTypeReaderGenericFactory(_,"System.Array","Microsoft.Xna.Framework.Content.ArrayReader"),this.RegisterTypeReaderGenericFactory(_,"System.List","Microsoft.Xna.Framework.Content.ListReader"),this.RegisterTypeReaderGenericFactory(S,"System.Dictionary","Microsoft.Xna.Framework.Content.DictionaryReader"),this.RegisterTypeReaderValueType(v,"Microsoft.Xna.Framework.Matrix","Microsoft.Xna.Framework.Content.MatrixReader"),this.RegisterTypeReaderValueType(w,"Microsoft.Xna.Framework.Vector4","Microsoft.Xna.Framework.Content.Vector4Reader"),this.RegisterTypeReaderValueType(x,"Microsoft.Xna.Framework.Rectangle","Microsoft.Xna.Framework.Content.RectangleReader"),this.RegisterTypeReaderDirect(b,"Microsoft.Xna.Framework.Graphics.Texture2D","Microsoft.Xna.Framework.Content.Texture2DReader")}IsValueType(e){return this.valueTypes.has(e)}RegisterTypeReaderDirect(e,t,a){this.directByReaderName.set(a,e),this.directByTypeName.set(t,e)}RegisterTypeReaderValueType(e,t,a){this.directByReaderName.set(a,e),this.directByTypeName.set(t,e),this.valueTypes.add(e)}RegisterTypeReaderEnum(e){this.directByTypeName.set(e,A)}RegisterTypeReaderGenericFactory(e,t,a){this.genericByReaderName.set(a,e)}ConstructTypeReaderForTypeSpec_TypeName(e){return s.assert(null===e.params),s.assertExists(this.directByTypeName.get(e.className))}ConstructTypeReaderForTypeSpec(e){const t=this.directByReaderName.get(e.className);if(void 0!==t)return t;if(null!==e.params){const t=e.params.map(e=>this.ConstructTypeReaderForTypeSpec_TypeName(e));return s.assertExists(this.genericByReaderName.get(e.className))(t)}throw`Missing type: ${e.className}`}};class h{constructor(e,t){this.typeReaderManager=e,this.buffer=t,this.Position=0,this.typeReaders=[],this.view=t.createDataView()}ReadBytes(e){const t=this.buffer.subarray(this.Position,e);return this.Position+=e,t}ReadByte(){return this.view.getUint8(this.Position++)}ReadBoolean(){return!!this.ReadByte()}ReadInt16(){const e=this.view.getInt16(this.Position,!0);return this.Position+=2,e}ReadUInt16(){const e=this.view.getUint16(this.Position,!0);return this.Position+=2,e}ReadInt32(){const e=this.view.getInt32(this.Position,!0);return this.Position+=4,e}ReadUInt32(){const e=this.view.getUint32(this.Position,!0);return this.Position+=4,e}ReadSingle(){const e=this.view.getFloat32(this.Position,!0);return this.Position+=4,e}ReadColor(){const e=this.ReadByte()/255,t=this.ReadByte()/255,a=this.ReadByte()/255,r=this.ReadByte()/255;return l.colorNewFromRGBA(e,t,a,r)}ReadVector2(){const e=this.ReadSingle(),t=this.ReadSingle();return o.vec2.fromValues(e,t)}ReadVector3(){const e=this.ReadSingle(),t=this.ReadSingle(),a=this.ReadSingle();return o.vec3.fromValues(e,t,a)}ReadVector4(){const e=this.ReadSingle(),t=this.ReadSingle(),a=this.ReadSingle(),r=this.ReadSingle();return o.vec4.fromValues(e,t,a,r)}ReadQuaternion(){const e=this.ReadSingle(),t=this.ReadSingle(),a=this.ReadSingle(),r=this.ReadSingle();return o.quat.fromValues(e,t,a,r)}ReadMatrix(){const e=this.ReadSingle(),t=this.ReadSingle(),a=this.ReadSingle(),r=this.ReadSingle(),n=this.ReadSingle(),s=this.ReadSingle(),i=this.ReadSingle(),l=this.ReadSingle(),c=this.ReadSingle(),h=this.ReadSingle(),d=this.ReadSingle(),u=this.ReadSingle(),m=this.ReadSingle(),p=this.ReadSingle(),f=this.ReadSingle(),A=this.ReadSingle();return o.mat4.fromValues(e,t,a,r,n,s,i,l,c,h,d,u,m,p,f,A)}Read7BitEncodedInt(){let e=0;for(let t=0;t<5;t++){const a=this.ReadByte();if(e|=(127&a)<<7*t,!(128&a))break}return e}ReadString(){const e=this.Read7BitEncodedInt(),t=s.readString(this.buffer,this.Position,e);return this.Position+=e,t}ReadAsset(){this.typeReaders=this.ReadTypeReaders();const e=this.Read7BitEncodedInt(),t=s.assertExists(this.ReadObject());return this.ReadSharedResources(e),t}ReadObject(){const e=this.Read7BitEncodedInt();return 0===e?null:(0,this.typeReaders[e-1])(this)}ReadObjectOrValueType(e){return this.typeReaderManager.IsValueType(e)?e(this):this.ReadObject()}ReadTypeReaders(){const e=this.Read7BitEncodedInt(),t=[];for(let a=0;a<e;a++){const e=this.ReadString(),a=this.ReadUInt32();s.assert(0===a);const r=c(e);t.push(this.typeReaderManager.ConstructTypeReaderForTypeSpec(r))}return t}ReadSharedResources(e){s.assert(0===e)}}function d(e){return e.ReadBoolean()}function u(e){return e.ReadUInt16()}function m(e){return e.ReadUInt32()}function p(e){return e.ReadInt32()}function f(e){const t=e.ReadInt32(),a=e.ReadInt32();return s.assert(0===a),t}function A(e){return e.ReadUInt32()}function g(e){return e.ReadString()}function _(e){return t=>{const a=t.ReadInt32();return s.nArray(a,()=>t.ReadObjectOrValueType(e[0]))}}function S(e){return t=>{const a=t.ReadInt32(),r=new Map;for(let n=0;n<a;n++){const a=t.ReadObjectOrValueType(e[0]),n=t.ReadObjectOrValueType(e[1]);r.set(a,n)}return r}}function b(e){const t=e.ReadInt32(),a=e.ReadInt32(),r=e.ReadInt32(),n=e.ReadInt32(),s=[];for(let t=0;t<n;t++){const t=e.ReadInt32();s.push(e.ReadBytes(t))}return{format:t,width:a,height:r,levelData:s}}function v(e){return e.ReadMatrix()}function w(e){return e.ReadVector4()}function x(e){const t=e.ReadInt32(),a=e.ReadInt32(),r=e.ReadInt32(),n=e.ReadInt32();return o.vec4.fromValues(t,a,r,n)}function T(e){const t=e.createDataView();s.assert("XNB"===s.readString(e,0,3));const a=t.getUint8(3);s.assert("w"===String.fromCharCode(a));const r=t.getUint8(4);s.assert(5===r);const o=!!(128&t.getUint8(5)),l=t.getUint32(6,!0);if(o){const a=t.getUint32(10,!0),r=new Uint8Array(a),s=new i.LZXState(16);let o=14,c=0;for(;o<l;){let a,n;if(255===t.getUint8(o+0)?(n=t.getUint16(o+1,!1),a=t.getUint16(o+3,!1),o+=5):(n=32768,a=t.getUint16(o+0,!1),o+=2),0===n||0===a)break;i.decompressLZX(s,r,c,n,e.subarray(o,a)),o+=a,c+=n}return new n.default(r.buffer)}return e.slice(10)}t.ContentReader=h,t.decompress=T,t.parse=function(e,t){return new h(e,T(t)).ReadAsset()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(5),n=a(1),s=a(0),i=a(189),o=a(316),l=a(149);function c(e,t,a,r){const n=r*t.blockCols+a,s=e.getUint32(t.blockTableOffset+4*n),i=s>>>23;return 255==i?null:{mod:i,sub:s>>>17&63}}t.getBlockInfo=c;class h{constructor(e){this.info=e,this.matrix=n.mat4.create(),this.models=[],this.modelMatrices=[],this.blockTable=[],this.blockCollections=[],this.numRows=e.getNumRows(),this.numCols=e.getNumCols();for(let t=0;t<this.numRows;t++){const a=[];this.blockTable.push(a);for(let r=0;r<this.numCols;r++){const n=e.getBlockInfoAt(r,t);a.push(n)}}}clearModels(){this.models=[],this.modelMatrices=[]}setMatrix(e){this.matrix=e}getNumDrawSteps(){return 3}prepareToRender(e,t,a,s,i){const o=t.pushTemplateRenderInst();r.fillSceneParamsDataOnTemplate(o,a,!1);for(let r=0;r<this.models.length;r++){const o=n.mat4.create();n.mat4.mul(o,this.matrix,this.modelMatrices[r]),this.models[r].prepareToRender(e,t,a,o,s,i)}t.popTemplateRenderInst()}async reloadBlocks(){this.clearModels();for(let e=0;e<this.numRows;e++)for(let t=0;t<this.numCols;t++){const a=this.blockTable[e][t];if(null!=a)try{null==this.blockCollections[a.mod]&&(this.blockCollections[a.mod]=await this.info.getBlockCollection(a.mod));const r=this.blockCollections[a.mod].getBlock(a.mod,a.sub);if(r){const a=n.mat4.create();n.mat4.fromTranslation(a,[640*t,0,640*e]),this.models.push(r),this.modelMatrices.push(a)}}catch(a){console.warn(`Skipping block at ${t},${e} due to exception:`),console.error(a)}}}openEditor(){const e=window.open("about:blank");e?e.onload=()=>{const t=[];for(let a=0;a<this.numRows;a++){const r=[];t.push(r);for(let t=0;t<this.numCols;t++){const n=this.blockTable[a][t],s=e.document.createElement("input");s.setAttribute("type","text"),s.setAttribute("value",`${null!=n?`${n.mod}.${n.sub}`:-1}`),r.push(s)}}const a=e.document.createElement("table");e.document.body.appendChild(a);for(let r=0;r<this.numRows;r++){const n=e.document.createElement("tr");a.appendChild(n);for(let a=0;a<this.numCols;a++){const s=e.document.createElement("td");n.appendChild(s),s.appendChild(t[r][a])}}const r=e.document.createElement("textarea");r.setAttribute("rows","60"),r.setAttribute("cols","100");const n=()=>{let e=-1,t=-1,a=-1,n=-1;for(let r=0;r<this.numRows;r++)for(let s=0;s<this.numCols;s++){null!=this.blockTable[r][s]&&(-1==e&&(e=r),n=r,-1==t?t=s:s<t&&(t=s),-1==a?a=s:s>a&&(a=s))}if(-1==e)return void(r.textContent="[]");let s="[";for(let r=e;r<=n;r++)s+=r!=e?",\n":"\n",s+=JSON.stringify(this.blockTable[r].slice(t,a+1),(e,t)=>Array.isArray(t)?t:null===t?null:"object"!=typeof t?null:`${t.mod}.${t.sub}`);s+="\n]",r.textContent=s},s=e.document.createElement("input");s.setAttribute("type","submit"),e.document.body.appendChild(s),s.onclick=async()=>{console.log("Reloading blocks...");for(let e=0;e<this.numRows;e++)for(let a=0;a<this.numCols;a++){const r=t[e][a].value.split(".",2);if(2==r.length){const t=Number.parseInt(r[0]),n=Number.parseInt(r[1]);this.blockTable[e][a]={mod:t,sub:n}}else this.blockTable[e][a]=null}n(),await this.reloadBlocks()};const i=e.document.createElement("div");e.document.body.appendChild(i),i.appendChild(r)}:console.warn("Failed to open editor. Please allow pop-up windows and try again.")}}async function d(e,t,a,r,n=!1){const s=r.pathBase,i=t.dataFetcher,[l,h]=await Promise.all([i.fetchData(`${s}/MAPS.tab`),i.fetchData(`${s}/MAPS.bin`)]),d=function(e,t,a){const r=28*a,n=e.getUint32(r+0),s=e.getUint32(r+4),i=t.getUint16(n+0),o=t.getUint16(n+2);return{mapsBin:t,locationNum:a,infoOffset:n,blockTableOffset:s,blockCols:i,blockRows:o}}(l.createDataView(),h.createDataView(),a),u=function(e){const t=[];for(let a=0;a<e.blockRows;a++){const r=[];t.push(r);for(let t=0;t<e.blockCols;t++){const n=c(e.mapsBin,e,t,a);r.push(n)}}return t}(d);return{getNumCols:()=>d.blockCols,getNumRows:()=>d.blockRows,async getBlockCollection(a){const s=new o.BlockCollection(a,n);return await s.create(e,t,r),s},getBlockInfoAt:(e,t)=>u[t][e]}}t.MapInstance=h,t.loadMap=d;class u extends i.SFARenderer{constructor(e){super(e)}async create(e){return this.map=new h(e),await this.map.reloadBlocks(),this}setMatrix(e){this.map.setMatrix(e)}renderWorld(e,t,a){for(let n=0;n<this.map.getNumDrawSteps();n++){const s=this.renderHelper.pushTemplateRenderInst();r.fillSceneParamsDataOnTemplate(s,a,!1),this.map.prepareToRender(e,t,a,this.sceneTexture,n),t.popTemplateRenderInst();let i=e.createHostAccessPass();this.prepareToRender(e,i,a),e.submitPass(i),t.drawOnPassRenderer(e,this.renderPass),t.resetRenderInsts(),this.copyToSceneTexture(e)}}}t.SFAMapSceneDesc=class{constructor(e,t,a,r=l.SFA_GAME_INFO,n=!1,s=!1){this.mapNum=e,this.id=t,this.name=a,this.gameInfo=r,this.isEarly=n,this.isAncient=s}async createScene(e,t){console.log(`Creating scene for ${this.name} (map #${this.mapNum}) ...`);const a=await d(e,t,this.mapNum,this.gameInfo,this.isAncient),r=new u(e);await r.create(a);const s=n.mat4.create();return n.mat4.rotateY(s,s,3*Math.PI/4),r.setMatrix(s),r}};t.AncientMapSceneDesc=class{constructor(e,t,a,r){this.id=e,this.name=t,this.gameInfo=a,this.mapKey=r}async createScene(e,t){const a=this.gameInfo.pathBase,r=t.dataFetcher,i=await r.fetchData(`${a}/AncientMaps.json`);console.log(`Creating scene for ${this.name} ...`);const l=new TextDecoder("utf-8").decode(i.arrayBuffer),c=JSON.parse(l)[this.mapKey],h=c.blocks.length,d=c.blocks[0].length,m=s.nArray(h,()=>s.nArray(d,()=>null));for(let e=0;e<h;e++)for(let t=0;t<d;t++){const a=c.blocks[e][t];if(null==a)m[e][t]=null;else{const r=a.split(".",2),n=Number.parseInt(r[0]),s=Number.parseInt(r[1]);m[e][t]={mod:n,sub:s}}}const p=this,f={getNumCols:()=>d,getNumRows:()=>h,async getBlockCollection(a){const r=new o.BlockCollection(a,!0);return await r.create(e,t,p.gameInfo),r},getBlockInfoAt:(e,t)=>m[t][e]},A=new u(e);await A.create(f);const g=n.mat4.create();return n.mat4.rotateY(g,g,3*Math.PI/4),A.setMatrix(g),A}};t.SFASandboxDesc=class{constructor(e,t,a,r=!1){this.id=e,this.name=t,this.gameInfo=a,this.isAncient=r}async createScene(e,t){console.log(`Creating scene for ${this.name} ...`);const a=s.nArray(20,()=>s.nArray(20,()=>null)),r=this,n={getNumCols:()=>20,getNumRows:()=>20,async getBlockCollection(a){const n=new o.BlockCollection(a,r.isAncient);return await n.create(e,t,r.gameInfo),n},getBlockInfoAt:(e,t)=>a[t][e]};console.log("Welcome to the sandbox. Type main.scene.openEditor() to open the map editor.");const i=new u(e);return await i.create(n),i}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(5),n=a(9);class s{constructor(e){this.renderTarget=new n.BasicRenderTarget,this.renderHelper=new r.GXRenderHelperGfx(e)}getCache(){return this.renderHelper.renderInstManager.gfxRenderCache}destroy(e){this.renderTarget.destroy(e),this.renderHelper.destroy(e)}}t.SFARendererHelper=s;t.SFARenderer=class extends s{constructor(){super(...arguments),this.sceneTexture=new n.ColorTexture}renderSky(e,t,a){}renderWorld(e,t,a){}prepareToRender(e,t,a){this.renderHelper.prepareToRender(e,t)}copyToSceneTexture(e){e.submitPass(this.renderPass),this.renderPass=this.renderTarget.createRenderPass(e,this.viewport,n.noClearRenderPassDescriptor,this.sceneTexture.gfxTexture)}render(e,t){const a=this.renderHelper.renderInstManager;return this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.sceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.viewport=t.viewport,this.renderPass=this.renderTarget.createRenderPass(e,this.viewport,n.standardFullClearRenderPassDescriptor,this.sceneTexture.gfxTexture),this.renderSky(e,a,t),this.renderWorld(e,a,t),this.renderPass=this.renderTarget.createRenderPass(e,this.viewport,n.noClearRenderPassDescriptor),this.renderPass}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=r(a(35)),i=a(5),o=a(6),l=a(100);class c{getTexture(e,t,a){const r=this.getTextureArray(e,t,a);return r?r.textures[0]:null}}function h(e,t){const a=t.createDataView(),r={name:"Texture",width:a.getUint16(10),height:a.getUint16(12),format:a.getUint8(22),mipCount:a.getUint16(28)+1,data:t.slice(96)},n={wrapS:a.getUint8(23),wrapT:a.getUint8(24),minFilt:a.getUint8(25),magFilt:a.getUint8(26)},o=s.calcMipChain(r,r.mipCount),l=i.loadTextureFromMipChain(e,o).gfxTexture,[c,h]=i.translateTexFilterGfx(n.minFilt);return{gfxTexture:l,gfxSampler:e.createSampler({wrapS:i.translateWrapModeGfx(n.wrapS),wrapT:i.translateWrapModeGfx(n.wrapT),minFilter:c,magFilter:i.translateTexFilterGfx(n.magFilt)[0],mipFilter:h,minLOD:0,maxLOD:100}),width:r.width,height:r.height}}function d(e){return 4294967295!=e&&0!=(2147483648&e)}function u(e,t,a,r){const s=t.getUint32(4*r);if(d(s)){const t=s>>24&63,r=2*(16777215&s);if(1===t){const t=a.slice(r);return{textures:[h(e,l.loadRes(t))]}}{const n={textures:[]},s=a.createDataView();for(let i=0;i<t;i++){const t=s.getUint32(r+4*i),o=a.slice(r+t),c=l.loadRes(o);n.textures.push(h(e,c))}return n}}return console.warn(`Texture id 0x${r.toString(16)} (tab value 0x${n.hexzero(s,8)}) not found in table. Using first valid texture.`),function(e,t,a){let r=0,n=!1;for(let e=0;e<t.byteLength;e+=4){const a=t.getUint32(e);if(4294967295==a){console.log("no valid id found");break}if(d(a)){n=!0;break}++r}return n?u(e,t,a,r):null}(e,t,a)}function m(e,t){const a=e.createTexture(o.makeTextureDescriptor2D(o.GfxFormat.U8_RGBA_NORM,2,2,1)),r=e.createSampler({wrapS:1,wrapT:1,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:100});let n=t;function s(){let e=1e4*Math.sin(n++);return e-Math.floor(e)}console.log(`Creating fake texture from seed ${n}`);const i=[127+127*s(),127+127*s(),127+127*s()],l=[.7*i[0],.7*i[1],.7*i[2]],c=[i[0],i[1],i[2],255],h=[l[0],l[1],l[2],255],d=new Uint8Array(16);d.set(h,0),d.set(c,4),d.set(c,8),d.set(h,12);const u=e.createHostAccessPass();return u.uploadTextureData(a,0,[d]),e.submitPass(u),{textures:[{gfxTexture:a,gfxSampler:r,width:2,height:2}]}}t.TextureCollection=c;class p{constructor(e,t,a){this.tab=e,this.bin=t,this.name=a,this.textures=[]}getTextureArray(e,t){if(void 0===this.textures[t])try{this.textures[t]=u(e,this.tab,this.bin,t)}catch(a){console.warn(`Failed to load texture 0x${t.toString(16)} from ${this.name} due to exception:`),console.error(a),this.textures[t]=m(e,t)}return this.textures[t]}}async function f(e,t,a){try{const[r,n]=await Promise.all([e.fetchData(t),e.fetchData(a)]);return new p(r.createDataView(),n,a)}catch(e){return console.warn("Failed to fetch texture file due to exception:"),console.error(e),null}}class A extends c{constructor(){super(...arguments),this.textures=[]}getTextureArray(e,t){return void 0===this.textures[t]&&(this.textures[t]=m(e,t)),this.textures[t]}}t.FakeTextureCollection=A;t.SFATextureCollection=class extends c{constructor(e){super(),this.gameInfo=e,this.fakes=new A}async create(e,t){const a=this.gameInfo.pathBase,[r,n,s,i]=await Promise.all([e.fetchData(`${a}/TEXTABLE.bin`),f(e,`${a}/TEXPRE.tab`,`${a}/TEXPRE.bin`),f(e,`${a}/${t}/TEX0.tab`,`${a}/${t}/TEX0.bin`),f(e,`${a}/${t}/TEX1.tab`,`${a}/${t}/TEX1.bin`)]);this.textableBin=r.createDataView(),this.texpre=n,this.tex0=s,this.tex1=i}getTextureArray(e,t,a=!1){let r;if(a)r=this.tex1;else{const e=this.textableBin.getUint16(2*t);console.log(`texid ${t} translated to textable value ${e}`),t<3e3||0==e?(t=e,r=this.tex0,console.log(`translated to tex0 num ${t}`)):(t=e+1,r=this.texpre,console.log(`translated to texpre num ${t}`))}return null===r?this.fakes.getTextureArray(e,t):r.getTextureArray(e,t)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(34),n=a(6),s=a(101),i=a(1),o=a(8);function l(e){return{texNum:e.getUint32(0),tevMode:e.getUint8(4),enableTexChainStuff:e.getUint8(5),texmtxIndex:e.getUint8(6)}}var c;function h(e){return e?{kind:"texture",texture:e}:null}function d(e){const t=e.createTexture(n.makeTextureDescriptor2D(n.GfxFormat.U8_RGBA_NORM,64,64,1)),a=e.createSampler({wrapS:1,wrapT:1,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:100}),r=new Uint8Array(16384);function s(e,t,a,n,s,i){const o=4*(64*t+e);r[o]=a,r[o+1]=n,r[o+2]=s,r[o+3]=i}for(let e=0;e<64;e++){const t=.0981875*e;for(let a=0;a<64;a++){const r=.39275*a,n=Math.cos(.5*Math.sin(r)+t),i=127*n+127;s(e,a,i,i,i,127*n*Math.cos(.39275*a*r)+127)}}const i=e.createHostAccessPass();return i.uploadTextureData(t,0,[r]),e.submitPass(i),{gfxTexture:t,gfxSampler:a,width:64,height:64}}t.SFA_SHADER_FIELDS={size:68,numLayers:65,layers:36},t.EARLY_SFA_SHADER_FIELDS={size:64,numLayers:59,layers:36},function(e){e[e.DevGeometry=2]="DevGeometry",e[e.Fog=4]="Fog",e[e.CullBackface=8]="CullBackface",e[e.ReflectSkyscape=32]="ReflectSkyscape",e[e.Water=64]="Water",e[e.Lava=128]="Lava",e[e.Reflective=256]="Reflective",e[e.AlphaCompare=1024]="AlphaCompare",e[e.StreamingVideo=131072]="StreamingVideo",e[e.SkyAmbientLit=262144]="SkyAmbientLit",e[e.FancyWater=2147483648]="FancyWater"}(c=t.ShaderFlags||(t.ShaderFlags={})),t.parseShader=function(e,t){const a={layers:[],flags:0,attrFlags:0,hasAuxTex0:!1,hasAuxTex1:!1,auxTexNum:-1};let r=e.getUint8(t.numLayers);r>2&&(console.warn(`Number of shader layers greater than maximum (${r} / 2)`),r=2);for(let n=0;n<r;n++){const r=l(s.dataSubarray(e,t.layers+8*n));a.layers.push(r)}return a.hasAuxTex0=0!=e.getUint32(8),a.hasAuxTex1=0!=e.getUint32(20),a.auxTexNum=e.getUint32(52),a.flags=e.getUint32(60),a.attrFlags=e.getUint8(64),a},t.makeMaterialTexture=h,t.buildMaterialFromShader=function(e,t,a,s,l,u){const m=new r.GXMaterialBuilder("Material"),p=[],f=[],A=[],g=[];let _=0,S=0,b=0,v=0,w=4,x=!1,T=!1;function y(e){switch(m.setTexCoordGen(b,1,w,60),m.setTevDirect(_),m.setTevOrder(_,b,v,0),e){case 0:m.setTevColorIn(_,15,8,10,15);break;case 1:case 9:m.setTevColorIn(_,8,0,1,15);break;default:console.warn(`Unhandled tev color-in mode ${e}`)}T?m.setTevAlphaIn(_,7,4,0,7):(m.setTevAlphaIn(_,7,4,5,7),T=!0),m.setTevColorOp(_,0,0,0,!0,0),m.setTevAlphaOp(_,0,0,0,!0,0),x=!0,_++,b++,v++,w++}function C(e){switch(m.setTexCoordGen(b,1,w,60),m.setTevDirect(_),m.setTevOrder(_,b,v,0),e){case 0:m.setTevColorIn(_,15,8,12,15);break;default:console.warn(`Unhandled colorInMode ${e}`)}T?m.setTevAlphaIn(_,7,4,0,7):(m.setTevAlphaIn(_,7,4,5,7),T=!0),m.setTevColorOp(_,0,0,0,!0,0),m.setTevAlphaOp(_,0,0,0,!0,0),x=!0,_++,b++,v++,w++}function M(){p[v]={kind:"fb-color-downscaled-8x"},m.setTexCoordGen(b,0,0,36),m.setTevDirect(_),m.setTevKColorSel(_,6),m.setTevOrder(_,b,v,7),m.setTevColorIn(_,15,8,14,0),m.setTevAlphaIn(_,7,7,7,0),m.setTevSwapMode(_,void 0,void 0),m.setTevColorOp(_,0,0,0,!0,0),m.setTevAlphaOp(_,0,0,0,!0,0),x=!0,b++,v++,_++}if(u)t.flags&c.FancyWater?function(){f[0]=(e,t,a)=>{o.texProjCameraSceneTex(e,t.camera,t.viewport,1),i.mat4.mul(e,e,a)},f[1]=(e,t,a)=>{o.texProjCameraSceneTex(e,t.camera,t.viewport,-1),i.mat4.mul(e,e,a)},p[0]={kind:"fb-color-downscaled-2x"},m.setTexCoordGen(0,0,0,30),p[1]=h(d(e)),m.setTexCoordGen(1,1,4,39),m.setIndTexOrder(0,1,1),m.setIndTexScale(0,0,0),g[0]=i.mat4.create(),i.mat4.fromScaling(g[0],[.5,.5,1]),m.setTevIndirect(0,0,0,7,1,6,6,!1,!1,0);const t=i.mat4.create();i.mat4.fromScaling(t,[.83,.83,.83]);const a=i.mat4.create();i.mat4.fromXRotation(a,Math.PI/4),i.mat4.mul(t,a,t),f[4]=()=>t,m.setTexCoordGen(2,1,4,42),m.setIndTexOrder(1,2,1),g[1]=i.mat4.create(),i.mat4.set(g[1],.3,-.3,0,0,.3,.3,0,0,0,0,1,0,0,0,0,1),m.setTevIndirect(1,1,0,7,2,0,0,!0,!1,0),m.setTevKColorSel(1,7),m.setTevKAlphaSel(1,1),m.setTevOrder(0,255,255,7),m.setTevColorIn(0,15,15,15,15),m.setTevAlphaIn(0,7,7,7,7),m.setTevColorOp(0,0,0,0,!0,0),m.setTevAlphaOp(0,0,0,0,!0,0),m.setTevOrder(1,0,0,7),m.setTevColorIn(1,14,15,15,8),m.setTevAlphaIn(1,7,7,7,6),m.setTevColorOp(1,0,0,3,!0,1),m.setTevAlphaOp(1,0,0,0,!0,1),g[2]=i.mat4.create(),i.mat4.set(g[2],0,-.5,0,0,.5,0,0,0,0,0,1,0,0,0,0,1),m.setTevIndirect(2,0,0,7,2,6,6,!1,!1,0),m.setTevIndirect(3,1,0,7,3,0,0,!0,!1,0),m.setTexCoordGen(3,0,0,33),m.setTevOrder(2,255,255,0),m.setTevColorIn(2,15,15,15,15),m.setTevAlphaIn(2,7,7,7,7),m.setTevColorOp(2,0,0,0,!0,0),m.setTevColorOp(2,0,0,0,!0,0),m.setTevOrder(3,3,0,0),m.setTevColorIn(3,8,2,3,15),m.setTevAlphaIn(3,7,7,7,5),m.setTevColorOp(3,0,0,0,!0,0),m.setTevColorOp(3,0,0,0,!0,0),m.setBlendMode(1,4,5,5),m.setCullMode(0),m.setZMode(!0,3,!1),m.setAlphaCompare(7,0,0,7,0),m.setChanCtrl(4,!1,0,1,0,0,2)}():(f[2]=(e,t,a)=>(o.texProjCameraSceneTex(e,t.camera,t.viewport,1),i.mat4.mul(e,e,a),e),0!=(t.flags&c.StreamingVideo)&&console.log("Found streaming video surface (?)"),0!=(t.flags&c.Lava)?(console.log("Found some lava!"),function(){p[2]=h(a.getTexture(e,s[t.layers[0].texNum],l)),m.setTexCoordGen(3,1,4,60);const r=a.getTexture(e,1536,!1);p[0]=h(r),A[2]=i.mat4.create(),m.setTexCoordGen(0,0,4,60,!1,70),p[1]=h(d(e)),A[0]=i.mat4.create(),i.mat4.fromScaling(A[0],[.9,.9,1]),m.setTexCoordGen(1,0,4,60,!1,64),m.setIndTexOrder(0,1,1),m.setIndTexScale(0,0,0),m.setTevIndirect(1,0,0,7,1,6,6,!1,!1,0),A[1]=i.mat4.create(),i.mat4.fromScaling(A[1],[1.2,1.2,1]);const n=i.mat4.create();i.mat4.fromXRotation(n,Math.PI/4),i.mat4.mul(A[1],n,A[1]),m.setTexCoordGen(2,0,4,60,!1,67),m.setIndTexOrder(1,2,1),m.setIndTexScale(1,0,0),m.setTevIndirect(2,1,0,7,2,0,0,!0,!1,0),m.setTevKAlphaSel(0,4),m.setTevKColorSel(1,4),m.setTevDirect(0),m.setTevOrder(0,0,2,0),m.setTevColorIn(0,15,8,10,15),m.setTevAlphaIn(0,6,7,7,4),m.setTevSwapMode(0,void 0,[0,1,2,0]),m.setTevColorOp(0,0,0,0,!0,0),m.setTevAlphaOp(0,1,0,2,!0,0),x=!0,m.setTevOrder(1,255,255,7),m.setTevColorIn(1,14,15,15,0),m.setTevAlphaIn(1,7,7,7,0),m.setTevSwapMode(1,void 0,void 0),m.setTevColorOp(1,0,0,0,!0,0),m.setTevAlphaOp(1,0,0,0,!0,0),m.setTevOrder(2,3,0,7),m.setTevColorIn(2,0,8,1,15),m.setTevAlphaIn(2,7,7,7,7),m.setTevSwapMode(2,void 0,void 0),m.setTevColorOp(2,0,0,0,!0,0),m.setTevAlphaOp(2,0,0,0,!0,0),_=3,w=4,b=4,v=3,S=2}()):function(){if(2===t.layers.length&&9==(127&t.layers[1].tevMode)){C(0),t.flags&c.Reflective&&(console.log("Found some reflective surfaces (special case)!"),M()),y(9),m.setTevDirect(_),m.setTevOrder(_,255,255,0),m.setTevKAlphaSel(_,0),0!==_&&x?(m.setTevColorIn(_,15,0,10,15),m.setTevAlphaIn(_,7,0,6,7)):(m.setTevColorIn(_,15,15,15,10),m.setTevAlphaIn(_,7,7,7,6)),m.setTevColorOp(_,0,0,0,!0,0),m.setTevAlphaOp(_,0,0,0,!0,0),x=!0,_++;for(let r=0;r<t.layers.length;r++)p.push(h(a.getTexture(e,s[t.layers[r].texNum],l)))}else{for(let e=0;e<t.layers.length;e++){const a=t.layers[e];t.flags&c.SkyAmbientLit?(m.setTexCoordGen(b,1,w,60),m.setTevDirect(_),m.setTevOrder(_,255,255,0),m.setTevColorIn(_,15,12,10,15),m.setTevAlphaIn(_,7,7,7,7),m.setTevColorOp(_,0,0,0,!0,0),m.setTevAlphaOp(_,0,0,0,!0,0),m.setTevDirect(_+1),m.setTevOrder(_+1,255,255,0),m.setTevColorIn(_+1,0,10,11,15),m.setTevAlphaIn(_+1,7,7,7,7),m.setTevColorOp(_+1,0,0,0,!0,0),m.setTevAlphaOp(_+1,0,0,0,!0,0),m.setTevDirect(_+2),m.setTevOrder(_+2,b,v,7),m.setTevColorIn(_+2,15,0,8,15),m.setTevAlphaIn(_+2,7,7,7,4),m.setTevColorOp(_+2,0,0,0,!0,0),m.setTevAlphaOp(_+2,0,0,0,!0,0),_+=3,b++,v++,w++):y(127&a.tevMode)}for(let r=0;r<t.layers.length;r++)p.push(h(a.getTexture(e,s[t.layers[r].texNum],l)));t.flags&c.Reflective&&(console.log("Found some reflective surfaces (normal case)!"),M())}}(),0!=(t.flags&c.ReflectSkyscape)?console.log("TODO: skyscape reflection?"):0!=(t.flags&c.Water)&&(console.log("Found some water?"),m.setTexCoordGen(b,0,0,0,!1,125),m.setTexCoordGen(b+1,1,0,60),p[v]=h(function(e){const t=e.createTexture(n.makeTextureDescriptor2D(n.GfxFormat.U8_RGBA_NORM,128,128,1)),a=e.createSampler({wrapS:1,wrapT:1,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:100}),r=new Uint8Array(65536);function s(e,t,a,n,s,i){const o=4*(128*t+e);r[o]=a,r[o+1]=n,r[o+2]=s,r[o+3]=i}for(let e=0;e<128;e++){const t=(e-64)/64;for(let a=0;a<128;a++){const r=(a-64)/64;let n=Math.hypot(r,t);if(n<.25||.75<n)n=0;else{let e=2*(n-.25);e<=.5?e=.5-e:e-=.5,n=-(2*e-1),0<n&&(n=Math.sqrt(n))}const i=16*n;s(e,a,i,i,i,i)}}const i=e.createHostAccessPass();return i.uploadTextureData(t,0,[r]),e.submitPass(i),{gfxTexture:t,gfxSampler:a,width:128,height:128}}(e)),m.setIndTexOrder(S,b+2,v+1),m.setTexCoordGen(b+2,1,0,60),m.setTevIndirect(_,S,0,2,2,0,0,!1,!1,0),m.setIndTexScale(S,0,0),m.setIndTexOrder(S+1,b+3,v+1),m.setTexCoordGen(b+3,1,0,60),m.setTevIndirect(_+1,S+1,0,2,2,0,0,!0,!1,0),m.setIndTexScale(S+1,0,0),m.setTevOrder(_,b,v,0),m.setTevColorIn(_,15,11,9,0),m.setTevAlphaIn(_,7,7,7,0),m.setTevSwapMode(_,void 0,void 0),m.setTevColorOp(_,0,0,0,!0,0),m.setTevAlphaOp(_,0,0,0,!0,0),x=!0,m.setTevOrder(_+1,b+1,v,0),m.setTevColorIn(_+1,15,11,9,0),m.setTevAlphaIn(_+1,7,7,7,0),m.setTevSwapMode(_+1,void 0,void 0),m.setTevColorOp(_+1,0,0,0,!0,0),m.setTevAlphaOp(_+1,0,0,0,!0,0),p[v+1]=h(d(e)),S+=2,b+=4,v+=2,_+=2));else{m.setUsePnMtxIdx(!0),C(0);for(let r=0;r<t.layers.length;r++)p.push(h(a.getTexture(e,s[t.layers[r].texNum],l)))}return t.flags&c.FancyWater||(1073741824&t.flags||536870912&t.flags?(m.setBlendMode(1,4,5,5),m.setZMode(!0,3,!1),m.setAlphaCompare(7,0,0,7,0)):(m.setBlendMode(0,1,0,5),m.setZMode(!0,3,!0),0!=(t.flags&c.AlphaCompare)&&0==(t.flags&c.Lava)?m.setAlphaCompare(4,0,0,4,0):m.setAlphaCompare(7,0,0,7,0)),m.setChanCtrl(4,!1,0,1,0,0,2),m.setCullMode(0!=(t.flags&c.CullBackface)?2:0)),{material:m.finish(),textures:p,setupMaterialParams:(e,t,a)=>{for(let r=0;r<10;r++)void 0!==f[r]&&f[r](e.u_TexMtx[r],t,a);for(let t=0;t<3;t++)void 0!==g[t]&&i.mat4.copy(e.u_IndTexMtx[t],g[t]);for(let t=0;t<20;t++)void 0!==A[t]&&i.mat4.copy(e.u_PostTexMtx[t],A[t])}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(12);function s(e,t,a){return r.readString(e,t+2,255,!0)}function i(e,t,a,n){const i=e.createDataView(),o=i.getUint32(a+16,n),l=i.getUint32(a+56,n),c=i.getUint32(a+64,n),h=i.getUint32(a+80,n),d=i.getUint8(a+84),u=i.getUint8(a+85),m=[];let p=o;for(let t=0;t<d;t++){const t=s(e,i.getUint32(p+0,n)),a=i.getUint32(p+8,n),r=i.getUint16(p+12,n),o=i.getUint8(p+14);m.push({name:t,format:a,offset:r,bufferIndex:o}),p+=16}let f=l,A=c,g=h;const _=[];for(let e=0;e<u;e++){const e=i.getUint32(f+0,n),a=i.getUint32(A+0,n),s=i.getUint32(A+4,n),o=t.subarray(g,e);_.push({data:o,stride:a,divisor:s}),g=r.align(g+e,8),f+=16,A+=16}return{vertexAttributes:m,vertexBuffers:_}}function o(e,t,a,i){const o=e.createDataView(),l=s(e,o.getUint32(a+16,i)),c=o.getUint32(a+32,i),h=o.getUint32(a+64,i),d=o.getUint16(a+94,i),u=o.getUint16(a+96,i),m=o.getUint16(a+98,i),p=o.getUint8(a+103);let f=c,A=h;const g=[],_=()=>{const e=o.getFloat32(A+0,i),t=o.getFloat32(A+4,i),a=o.getFloat32(A+8,i),r=o.getFloat32(A+12,i),s=o.getFloat32(A+16,i),l=o.getFloat32(A+20,i);A+=24;const c=e-r,h=t-s,d=a-l,u=e+r,m=t+s,p=a+l;return new n.AABB(c,h,d,u,m,p)};for(let e=0;e<p;e++){const e=o.getUint32(f+0,i),a=o.getUint32(f+24,i),n=o.getUint32(f+32,i),s=o.getUint32(f+36,i);r.assert(3===s);const l=o.getUint32(f+40,i),c=o.getUint32(f+44,i),h=o.getUint32(f+48,i),d=o.getUint16(f+52,i),u=o.getUint32(a+0,i),m=t.subarray(n,u);let p=e;const A=[];for(let e=0;e<d;e++){const e=o.getUint32(p+0,i),t=o.getUint32(p+4,i),a=_();A.push({offset:e,count:t,bbox:a}),p+=8}const S=_();f+=56,g.push({primType:s,indexFormat:l,count:c,offset:h,subMeshes:A,indexBufferData:m,bbox:S})}return{name:l,mesh:g,vertexIndex:m,boneIndex:u,materialIndex:d}}function l(e,t,a){const n=e.createDataView(),i=s(e,n.getUint32(t+16,a)),o=n.getUint32(t+24,a),l=n.getUint32(t+40,a),c=(n.getUint32(t+48,a),n.getUint32(t+56,a)),h=n.getUint32(t+72,a),d=n.getUint32(t+80,a),u=n.getUint32(t+88,a),m=(n.getUint32(t+104,a),n.getUint32(t+112,a),n.getUint32(t+160,a),n.getUint16(t+164,a),n.getUint16(t+166,a)),p=n.getUint8(t+168),f=n.getUint8(t+169),A=n.getUint16(t+170,a);n.getUint16(t+172,a),n.getUint16(t+174,a),n.getUint16(t+176,a),n.getUint16(t+178,a);let g=o;const _=new Map;for(let t=0;t<m;t++){const t=s(e,n.getUint32(g+0,a)),r=n.getUint32(g+8,a),i=n.getUint16(g+16,a),o=n.getUint8(g+18);if(0===o){const e=[];for(let t=0;t<i;t++)e.push(n.getInt32(r+4*t,a));_.set(t,{type:o,values:e})}else if(1===o){const e=[];for(let t=0;t<i;t++)e.push(n.getFloat32(r+4*t,a));_.set(t,{type:o,values:e})}else if(2===o){const l=[];for(let t=0;t<i;t++)l.push(s(e,n.getInt32(r+8*t,a)));_.set(t,{type:o,values:l})}g+=24}let S;{const t=s(e,n.getUint32(l+0,a)),i=s(e,n.getUint32(l+8,a));let o=n.getUint32(l+16,a),c=n.getUint32(l+24,a),h=n.getUint32(l+32,a),d=n.getUint32(l+40,a),u=n.getUint32(l+48,a),m=n.getUint32(l+56,a);const p=n.getUint32(l+64,a),f=n.getUint8(l+68),A=n.getUint8(l+69),g=n.getUint16(l+70,a);c+=24;const _=new Map;for(let t=0;t<f;t++){const t=s(e,n.getUint32(c+8,a)),r=s(e,n.getUint32(o+0,a));_.set(t,r),c+=16,o+=8}d+=24;const b=new Map;for(let t=0;t<A;t++){const t=s(e,n.getUint32(d+8,a)),i=s(e,n.getUint32(h+0,a));r.assert(!b.has(t)),b.set(t,i),d+=16,h+=8}m+=24;const v=new Map;for(let t=0;t<g;t++){const t=s(e,n.getUint32(m+8,a)),r=s(e,n.getUint32(u+0,a));v.set(t,r),m+=16,u+=8}S={shaderArchiveName:t,shadingModelName:i,revision:p,attrAssign:_,samplerAssign:b,shaderOption:v}}let b=c;const v=[];for(let t=0;t<f;t++)v.push(s(e,n.getUint32(b+0,a))),b+=8;let w=h,x=d+24;const T=[];for(let t=0;t<p;t++){const t=s(e,n.getUint32(x+8,a)),r=n.getUint8(w+0),i=n.getUint8(w+1),o=n.getUint8(w+2),l=(n.getUint8(w+5),n.getUint16(w+6,a)),c=n.getFloat32(w+8,a),h=n.getFloat32(w+12,a),d=n.getFloat32(w+16,a);w+=32,x+=16,T.push({name:t,addrModeU:r,addrModeV:i,addrModeW:o,filterMode:l,minLOD:c,maxLOD:h,lodBias:d})}let y=u;const C=[];for(let t=0;t<A;t++){const t=s(e,n.getUint32(y+8,a)),r=n.getUint8(y+16),i=n.getUint8(y+17),o=n.getUint16(y+18,a),l=n.getUint32(y+20,a);C.push({name:t,type:r,srcSize:i,srcOffset:o,offset:l}),y+=32}return{name:i,renderInfo:_,shaderAssign:S,textureName:v,samplerInfo:T,shaderParam:C}}function c(e,t,a,n){const c=e.createDataView(),h=s(e,c.getUint32(a+16,n)),d=c.getUint32(a+32,n),u=c.getUint32(a+40,n),m=c.getUint32(a+48,n),p=(c.getUint32(a+56,n),c.getUint32(a+64,n)),f=(c.getUint32(a+72,n),c.getUint32(a+80,n),c.getUint32(a+88,n),c.getUint32(a+96,n),c.getUint16(a+104,n)),A=c.getUint16(a+106,n),g=c.getUint16(a+108,n),_=(c.getUint16(a+110,n),c.getUint32(a+112,n),function(e,t,a){const n=e.createDataView();r.assert("FSKL"===r.readString(e,t+0,4));const i=n.getUint32(t+24,a),o=(n.getUint32(t+72,a),n.getUint16(t+76,a));n.getUint16(t+78,a),n.getUint16(t+80,a);let l=i;const c=[];for(let t=0;t<o;t++){const t=s(e,n.getUint32(l+0,a)),r=(n.getUint16(l+40,a),n.getUint16(l+42,a),n.getInt16(l+44,a),n.getInt16(l+46,a),n.getUint16(l+48,a),n.getUint32(l+52,a));n.getFloat32(l+56,a),n.getFloat32(l+60,a),n.getFloat32(l+64,a);if(4096&r){n.getFloat32(l+68,a),n.getFloat32(l+72,a),n.getFloat32(l+76,a)}else{n.getFloat32(l+68,a),n.getFloat32(l+72,a),n.getFloat32(l+76,a),n.getFloat32(l+80,a)}n.getFloat32(l+84,a),n.getFloat32(l+88,a),n.getFloat32(l+92,a);c.push({name:t}),l+=96}return{bones:c}}(e,d,n));let S=u;const b=[];for(let a=0;a<f;a++){r.assert("FVTX"===r.readString(e,S+0,4));const a=i(e,t,S,n);b.push(a),S+=96}let v=m;const w=[];for(let a=0;a<A;a++){r.assert("FSHP"===r.readString(e,v+0,4));const a=o(e,t,v,n);w.push(a),v+=112}let x=p;const T=[];for(let t=0;t<g;t++){r.assert("FMAT"===r.readString(e,x+0,4));const t=l(e,x,n);T.push(t),x+=184}return{name:h,fskl:_,fvtx:b,fshp:w,fmat:T}}function h(e){if(65534===e)return!0;if(65279===e)return!1;throw"whoops"}t.readBinStr=s,t.isMarkerLittleEndian=h,t.parse=function(e){const t=e.createDataView();r.assert("FRES    "===r.readString(e,0,8));const a=h(t.getUint16(12,!1)),n=t.getUint32(8,a);r.assert([524288,327683].includes(n));const i=t.getUint16(32,a);function o(n){const i=t.getUint32(40+16*n,a),o=t.getUint32(48+16*n,a),l=[];if(0===o)return{names:l,arrayOffs:i};r.assert(0===t.getUint32(o+0,a));const c=t.getUint32(o+4,a);let h=o+24;for(let r=0;r<c;r++)l.push(s(e,t.getUint32(h+8,a))),h+=16;return{names:l,arrayOffs:i}}s(e,i);const l=t.getUint32(144,a),d=0!==l?t.getUint32(l+4,a):0,u=0!==l?t.getUint32(l+8,a):0,m=0!==l?e.subarray(u,d):null,p=o(0);let f=p.arrayOffs;const A=[];for(let t=0;t<p.names.length;t++){const n=p.names[t];r.assert("FMDL"===r.readString(e,f+0,4));const s=c(e,m,f,a);r.assert(s.name===n),A.push(s),f+=120}const g=o(7),_=[];let S=g.arrayOffs;for(let r=0;r<g.names.length;r++){const n=g.names[r],s=t.getUint32(S+0,a),i=t.getUint32(S+8,a),o=e.subarray(s,i);_.push({name:n,buffer:o}),S+=16}return{fmdl:A,externalFiles:_}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(151),n=a(6),s=a(98),i=a(0),o=a(2);function l(e){switch(e){case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 45:return 4;case 46:case 47:return 5;case 48:case 49:return 6;case 50:case 51:case 52:return 8;case 53:case 54:case 55:case 56:return 10;case 57:case 58:return 12;default:return 1}}function c(e){switch(e){case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 45:case 46:return 4;case 47:case 48:case 50:case 53:return 5;case 49:case 51:case 54:return 6;case 52:case 55:return 8;case 56:case 57:return 10;case 58:return 12;default:return 1}}function h(e){switch(e){case 26:case 29:return 8;case 27:case 28:case 30:return 16;case 11:case 12:return 4;default:throw"whoops"}}function d(e){return o.clamp(Math.ceil(Math.log2(e/8)),0,4)}function u(e){let t=0;for(;!(1&e);)++t,e>>=1;return t}t.getFormatBlockWidth=l,t.getFormatBlockHeight=c,t.isChannelFormatSupported=function(e){switch(e){case 26:case 29:case 27:case 28:case 30:case 11:case 12:return!0;default:return!1}},t.getFormatBytesPerPixel=h,t.getBlockHeightLog2=d,t.deswizzle=function(e){const t=l(e.channelFormat),a=c(e.channelFormat),r=(e.width+t-1)/t|0,n=(e.height+a-1)/a|0,s=1<<d(n),i=h(e.channelFormat),o=8*s-1,m=u(8*s),p=u(512*s),f=u(i),A=512*s*Math.ceil(r*i/64);function g(e,t,a,r,n){e.set(a.createTypedArray(Uint8Array,r,n),t)}const _=e.buffer,S=new Uint8Array(r*n*i);for(let e=0;e<n;e++)for(let t=0;t<r;t++){const a=t<<f;let n=0;n+=(e>>>m)*A,n+=a>>>6<<p,n+=(e&o)>>>3<<9,n+=(63&a)>>>5<<8,n+=(7&e)>>>1<<6,n+=(31&a)>>>4<<5,n+=(1&e)>>>0<<4,n+=(15&a)>>>0<<0,g(S,(e*r+t)*i,_,n,i)}return S},t.decompress=function(e,t){const a=r.getChannelFormat(e.imageFormat),n=r.getTypeFormat(e.imageFormat);switch(a){case 26:return i.assert(1===n||6===n),s.decompressBC(Object.assign(Object.assign({},e),{type:"BC1",flag:1===n?"UNORM":"SRGB",pixels:t}));case 28:return i.assert(1===n||6===n),s.decompressBC(Object.assign(Object.assign({},e),{type:"BC3",flag:1===n?"UNORM":"SRGB",pixels:t}));case 29:return i.assert(1===n||2===n),s.decompressBC(Object.assign(Object.assign({},e),{type:"BC4",flag:1===n?"UNORM":"SNORM",pixels:t}));case 30:return i.assert(1===n||2===n),s.decompressBC(Object.assign(Object.assign({},e),{type:"BC5",flag:1===n?"UNORM":"SNORM",pixels:t}));case 11:return i.assert(1===n||6===n),Object.assign(Object.assign({},e),{type:"RGBA",flag:1===n?"UNORM":"SRGB",pixels:t});default:throw console.error(a.toString(16)),"whoops"}},t.getImageFormatString=function(e){const t=r.getChannelFormat(e),a=r.getTypeFormat(e);return`${function(e){switch(e){case 26:return"BC1";case 28:return"BC3";case 29:return"BC4";case 30:return"BC5";case 11:return"R8_G8_B8_A8";default:throw"whoops"}}(t)} (${function(e){switch(e){case 1:return"UNORM";case 2:return"SNORM";case 6:return"SRGB";default:throw"whoops"}}(a)})`},t.translateImageFormat=function(e){switch(r.getTypeFormat(e)){case 1:return n.GfxFormat.U8_RGBA_NORM;case 6:return n.GfxFormat.U8_RGBA_SRGB;case 2:return n.GfxFormat.S8_RGBA_NORM;default:throw"whoops"}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(327));!function(e){e[e.cTFETC1=0]="cTFETC1",e[e.cTFETC2=1]="cTFETC2",e[e.cTFBC1=2]="cTFBC1",e[e.cTFBC3=3]="cTFBC3",e[e.cTFBC4=4]="cTFBC4",e[e.cTFBC5=5]="cTFBC5",e[e.cTFBC7_M6_OPAQUE_ONLY=6]="cTFBC7_M6_OPAQUE_ONLY",e[e.cTFBC7_M5=7]="cTFBC7_M5",e[e.cTFPVRTC1_4_RGB=8]="cTFPVRTC1_4_RGB",e[e.cTFPVRTC1_4_RGBA=9]="cTFPVRTC1_4_RGBA",e[e.cTFASTC_4x4=10]="cTFASTC_4x4",e[e.cTFATC_RGB=11]="cTFATC_RGB",e[e.cTFATC_RGBA_INTERPOLATED_ALPHA=12]="cTFATC_RGBA_INTERPOLATED_ALPHA",e[e.cTFRGBA32=13]="cTFRGBA32",e[e.cTFRGB565=14]="cTFRGB565",e[e.cTFBGR565=15]="cTFBGR565",e[e.cTFRGBA4444=16]="cTFRGBA4444"}(t.BasisFormat||(t.BasisFormat={})),t.initializeBasis=async function(){if(!t.BasisFile)return new Promise(e=>n.default().then(a=>{a.initializeBasis(),t.BasisFile=a.BasisFile,e()}))}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(11)),i=r(a(102)),o=n(a(328)),l=a(10),c=a(6),h=a(17),d=a(20),u=a(32),m=a(13),p=a(1),f=a(8),A=a(23),g=a(0),_=a(9),S=a(7),b=a(4),v=a(196),w=a(12),x=a(14);function T(e,t){return(e%t+t)%t}function y(e,t,a,r){const n=Math.max(t/2|0,1),s=Math.max(a/2|0,1),i=r*t+T(-r*t,4),o=r*n+T(-r*n,4),l=new Uint8Array(o*s);for(let t=0;t<s;t++)for(let a=0;a<n;a++)for(let n=0;n<r;n++)l[r*a+o*t+n]=(e[r*(2*a+0)+i*(2*t+0)+n]+e[r*(2*a+1)+i*(2*t+0)+n]+e[r*(2*a+0)+i*(2*t+1)+n]+e[r*(2*a+1)+i*(2*t+1)+n])/4;return l}t.rwTexture=function(e,t,a=!0){const r=t+"/"+e.name.toLowerCase();if(a&&(e.raster.platform===i.Platform.PLATFORM_D3D8||e.raster.platform===i.Platform.PLATFORM_D3D9)){const t=e.raster.toD3dRaster();if(t.customFormat){const e=function(e){switch(e){case i.Raster.Format.D3DFMT_DXT1:return c.GfxFormat.BC1;case i.Raster.Format.D3DFMT_DXT2:case i.Raster.Format.D3DFMT_DXT3:return c.GfxFormat.BC2;case i.Raster.Format.D3DFMT_DXT4:case i.Raster.Format.D3DFMT_DXT5:return c.GfxFormat.BC3;default:throw new Error("Unrecognised texture format")}}(t.format),a=t.hasAlpha;g.assert(t.texture.length>0);const{width:n,height:s}=t.texture.level(0),o=[];for(let e=0;e<t.texture.length;e++)o.push(t.texture.level(e).data.slice());return{name:r,width:n,height:s,levels:o,pixelFormat:e,transparent:a}}}const n=e.raster.toImage();n.unindex();const{width:s,height:o}=n,l=[n.pixels.slice()],h=32===n.depth?c.GfxFormat.U8_RGBA_NORM:c.GfxFormat.U8_RGB_NORM,d=n.hasAlpha();return n.delete(),{name:r,width:s,height:o,levels:l,pixelFormat:h,transparent:d}};class C extends l.TextureMapping{constructor(e,t){super(),this.subimages=new Map,g.assert(t.length>0);const{width:a,height:r,pixelFormat:n,transparent:s}=t[0],i=t[0].levels.length,o=t[0].levels.map(e=>e.byteLength);for(let e=0;e<t.length;e++){const s=t[e];g.assert(s.width===a&&s.height===r&&s.levels.length===i&&s.pixelFormat===n),this.subimages.set(s.name,e)}let l=0;n===c.GfxFormat.U8_RGBA_NORM?l=4:n===c.GfxFormat.U8_RGB_NORM&&(l=3);const h=[];for(let e=0;e<i;e++){const a=new Uint8Array(o[e]*t.length);for(let r=0;r<t.length;r++)a.set(t[r].levels[e],r*o[e]);h.push(a)}if(1===h.length&&l>0){let e=h[0],n=a,s=r;for(;n>1&&s>1;)e=y(e,n,s*t.length,l),h.push(e),n=Math.max(n/2|0,1),s=Math.max(s/2|0,1)}const d=e.createTexture({dimension:1,pixelFormat:n,width:a,height:r,depth:t.length,numLevels:h.length}),u=e.createHostAccessPass();u.uploadTextureData(d,0,h),e.submitPass(u),this.gfxTexture=d,this.width=a,this.height=r,this.flipY=!1,this.transparent=s,this.gfxSampler=e.createSampler({magFilter:1,minFilter:1,mipFilter:h.length>1?2:0,minLOD:0,maxLOD:1e3,wrapS:1,wrapT:1})}destroy(e){null!==this.gfxTexture&&e.destroyTexture(this.gfxTexture),null!==this.gfxSampler&&e.destroySampler(this.gfxSampler)}}t.TextureArray=C;class M extends d.DeviceProgram{constructor(e={}){super(),this.both=M.program,void 0!==e.ALPHA_TEST&&this.defines.set("ALPHA_TEST",e.ALPHA_TEST),void 0!==e.SKY&&this.defines.set("SKY",e.SKY),void 0!==e.WATER&&this.defines.set("WATER",e.WATER)}}M.a_Position=0,M.a_Color=1,M.a_TexCoord=2,M.a_TexScroll=3,M.ub_SceneParams=0,M.program=o.default;const U=new M,k=new M({ALPHA_TEST:"< 0.9"}),D=new M({ALPHA_TEST:">= 0.9"}),I=new M({WATER:"1"}),R=new M({SKY:"1"});class B{constructor(e,t){this.program=e,this.atlas=t,this.megaStateFlags={}}prepare(e,t){const a=t.pushRenderInst();return a.setInputLayoutAndState(this.inputLayout,this.inputState),a.drawIndexes(this.indices),void 0===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program)),a.setGfxProgram(this.gfxProgram),a.setMegaStateFlags(this.megaStateFlags),void 0!==this.atlas&&a.setSamplerBindingsFromTextureMappings([this.atlas]),a}destroy(e){e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputState(this.inputState),void 0!==this.atlas&&this.atlas.destroy(e)}}t.SkyRenderer=class extends B{constructor(e,t,a){super(R,a);const r=new Float32Array([-1,-1,1,-1,1,1,1,1,1,1,-1,1]),n=new Uint32Array([0,1,2,0,2,3]);this.vertexBuffer=h.makeStaticDataBuffer(e,2,r.buffer),this.indexBuffer=h.makeStaticDataBuffer(e,1,n.buffer),this.indices=n.length;const s=[{location:M.a_Position,bufferIndex:0,format:c.GfxFormat.F32_RGB,bufferByteOffset:0}];this.inputLayout=t.createInputLayout(e,{indexBufferFormat:c.GfxFormat.U32_R,vertexAttributeDescriptors:s,vertexBufferDescriptors:[{byteStride:12,frequency:1}]});const i=[{buffer:this.vertexBuffer,byteOffset:0}],o={buffer:this.indexBuffer,byteOffset:0};this.inputState=e.createInputState(this.inputLayout,i,o)}prepareToRender(e,t,a){if(a.camera.isOrthographic)return;super.prepare(e,t).sortKey=S.makeSortKey(0)}};class P{constructor(e,t,a,r,n,s){this.positions=r,this.texCoords=n,this.colors=s,this.baseColor=b.colorNewCopy(b.White);const{texture:i,color:o,uvAnim:l}=e.material;i&&(this.texName=a+"/"+i.name.toLowerCase()),o&&(this.baseColor=b.colorNewFromRGBA(o[0]/255,o[1]/255,o[2]/255,o[3]/255));for(let e=0;e<8;e++){const t=l.interp(e);if(null===t)continue;const a=t.currentAnim;console.log("... on",a.uv.name),g.assert(0===a.uv.channels[0]);const r=a.frame(a.numFrames-a.numNodes).uv;this.texScroll=p.vec3.fromValues(r[4],r[5],a.duration)}this.indexMap=Array.from(new Set(e.indices)).sort(),this.indices=u.filterDegenerateTriangleIndexBuffer(u.convertToTriangleIndexBuffer(t?1:0,e.indices.map(e=>this.indexMap.indexOf(e))))}get vertices(){return this.indexMap.length}fillPosition(e,t){const a=this.indexMap[t];e[0]=this.positions[3*a+0],e[1]=this.positions[3*a+1],e[2]=this.positions[3*a+2]}fillColor(e,t){const a=this.indexMap[t];if(b.colorCopy(e,this.baseColor),null!==this.colors){const t=this.colors[4*a+0]/255,r=this.colors[4*a+1]/255,n=this.colors[4*a+2]/255,s=this.colors[4*a+3]/255;e.r*=t,e.g*=r,e.b*=n,e.a*=s}}fillTexCoord(e,t){const a=this.indexMap[t];null!==this.texCoords&&(e[0]=this.texCoords[2*a+0],e[1]=this.texCoords[2*a+1])}}t.ModelCache=class{constructor(){this.meshData=new Map}addAtomic(e,t){const a=e.geometry,r=a.morphTarget(0).vertices.slice(),n=a.numTexCoordSets>0?a.texCoords(0).slice():null,s=null!==a.colors?a.colors.slice():null,i=a.meshHeader,o=[];for(let e=0;e<i.numMeshes;e++){const a=new P(i.mesh(e),i.tristrip,t.txdName,r,n,s);o.push(a)}this.meshData.set(t.modelName,o)}addModel(e,t){let a=null;for(let r=e.atomics.begin;!r.is(e.atomics.end);r=r.next){const e=i.Atomic.fromClump(r),n=e.frame.name.toLowerCase();(null===a||n.endsWith("_l0")||n===t.modelName)&&(a=e)}null!==a&&this.addAtomic(a,t)}};t.MeshInstance=class{constructor(e,t){this.frags=e,this.item=t,this.modelMatrix=p.mat4.create(),p.mat4.fromRotationTranslationScale(this.modelMatrix,this.item.rotation,this.item.translation,this.item.scale),p.mat4.multiply(this.modelMatrix,p.mat4.fromQuat(p.mat4.create(),p.quat.fromValues(.5,.5,.5,-.5)),this.modelMatrix)}};class E{constructor(){this.renderLayer=32,this.minDistance=-1/0,this.maxDistance=1/0,this.water=!1,this.additive=!1,this.backface=!1}intern(){const e=JSON.stringify(this);return E.internMap.has(e)?E.internMap.get(e):(E.internMap.set(e,this),this)}clone(){return Object.assign(new E,this)}}t.DrawParams=E,E.internMap=new Map;const F=p.vec2.create(),V=p.vec3.create(),O=b.colorNewCopy(b.White);class N extends B{constructor(e,t,a,r,n,s,i=!1){super(N.programFor(a,i),s),this.params=a,this.bbox=new w.AABB(1/0,1/0,1/0,-1/0,-1/0,-1/0);let o=0;this.indices=0;for(const e of r)for(const t of e.frags)N.keepFrag(t,s)&&(o+=t.vertices,this.indices+=t.indices.length);g.assert(this.indices>0);const l=new Float32Array(13*o),d=new Uint32Array(this.indices);let u=0,f=0,A=0;for(const e of r)for(const t of e.frags){if(!N.keepFrag(t,s))continue;const a=t.vertices,r=void 0===t.texName||void 0===s?void 0:s.subimages.get(t.texName);for(let n=0;n<a;n++){t.fillPosition(V,n),p.vec3.transformMat4(V,V,e.modelMatrix),l[u++]=V[0],l[u++]=V[1],l[u++]=V[2],this.bbox.unionPoint(V),t.fillColor(O,n),u+=m.fillColor(l,u,O),t.fillTexCoord(F,n),l[u++]=F[0],l[u++]=F[1],l[u++]=void 0===r?-1:r;const a=t.texScroll;void 0!==a?(l[u++]=a[0],l[u++]=a[1],l[u++]=a[2]):u+=3}for(let e=0;e<t.indices.length;e++){const a=t.indices[e];g.assert(a+A<o),d[f++]=a+A}A+=a}this.vertexBuffer=h.makeStaticDataBuffer(e,2,l.buffer),this.indexBuffer=h.makeStaticDataBuffer(e,1,d.buffer);const _=[{location:M.a_Position,bufferIndex:0,format:c.GfxFormat.F32_RGB,bufferByteOffset:0},{location:M.a_Color,bufferIndex:0,format:c.GfxFormat.F32_RGBA,bufferByteOffset:12},{location:M.a_TexCoord,bufferIndex:0,format:c.GfxFormat.F32_RGB,bufferByteOffset:28},{location:M.a_TexScroll,bufferIndex:0,format:c.GfxFormat.F32_RGB,bufferByteOffset:40}],b=[{byteStride:52,frequency:1}];this.inputLayout=t.createInputLayout(e,{indexBufferFormat:c.GfxFormat.U32_R,vertexAttributeDescriptors:_,vertexBufferDescriptors:b});const v=[{buffer:this.vertexBuffer,byteOffset:0}],T={buffer:this.indexBuffer,byteOffset:0};this.inputState=e.createInputState(this.inputLayout,v,T),this.megaStateFlags={depthWrite:!i,cullMode:this.params.backface?0:2},x.setAttachmentStateSimple(this.megaStateFlags,{blendMode:c.GfxBlendMode.ADD,blendDstFactor:this.params.additive?c.GfxBlendFactor.ONE:c.GfxBlendFactor.ONE_MINUS_SRC_ALPHA,blendSrcFactor:c.GfxBlendFactor.SRC_ALPHA});let y=this.params.renderLayer;void 0!==this.atlas&&this.atlas.transparent&&(y=128),this.params.water?this.sortKey=S.makeSortKey(129):128===y&&this.bbox.minY>=n?this.sortKey=S.makeSortKey(130):this.sortKey=S.makeSortKey(y)}static programFor(e,t){return e.water?I:t?D:128&e.renderLayer?k:U}static keepFrag(e,t){return void 0!==e.texName&&void 0!==t?t.subimages.has(e.texName):void 0===e.texName&&void 0===t}static applicable(e,t){for(const a of e)for(const e of a.frags)if(N.keepFrag(e,t))return!0;return!1}prepareToRender(e,t,a){if(!a.camera.frustum.contains(this.bbox))return;const r=a.time/2500%24,{timeOn:n,timeOff:s}=this.params;if(void 0!==n&&void 0!==s){if(n<s&&(r<n||s<r))return;if(s<n&&r<n&&s<r)return}const i=f.computeViewSpaceDepthFromWorldSpaceAABB(a.camera,this.bbox);super.prepare(e,t).sortKey=S.setSortKeyDepth(this.sortKey,i)}}t.SceneRenderer=N;t.AreaRenderer=class{constructor(){this.renderers=[],this.bbox=new w.AABB(1/0,1/0,1/0,-1/0,-1/0,-1/0)}push(e){this.renderers.push(e),this.bbox.union(this.bbox,e.bbox)}prepareToRender(e,t,a){if(!a.camera.frustum.contains(this.bbox))return;const r=(f.computeViewSpaceDepthFromWorldSpaceAABB(a.camera,this.bbox)-this.bbox.boundingSphereRadius())/2.5;for(let n=0;n<this.renderers.length;n++){const s=this.renderers[n];s.params.minDistance<=r&&r<s.params.maxDistance&&s.prepareToRender(e,t,a)}}destroy(e){for(let t=0;t<this.renderers.length;t++)this.renderers[t].destroy(e)}};const L=[{numUniformBuffers:1,numSamplers:1}];t.GTA3Renderer=class{constructor(e,t,a,r,n){this.colorSets=t,this.weatherTypes=a,this.weatherPeriods=r,this.waterOrigin=n,this.renderers=[],this.renderTarget=new _.BasicRenderTarget,this.clearRenderPassDescriptor=_.standardFullClearRenderPassDescriptor,this.currentColors=v.emptyColorSet(),this.weather=0,this.renderHelper=new A.GfxRenderHelper(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(.01)}prepareToRender(e,t,a){const r=a.time/2500*this.weatherPeriods/24,n=this.colorSets[Math.floor(r)%this.weatherPeriods+this.weatherPeriods*this.weather],s=this.colorSets[Math.floor(r+1)%this.weatherPeriods+this.weatherPeriods*this.weather];v.lerpColorSet(this.currentColors,n,s,r%1),a.camera.setClipPlanes(1),this.renderHelper.pushTemplateRenderInst();const i=this.renderHelper.renderInstManager.pushTemplateRenderInst();i.setBindingLayouts(L);let o=i.allocateUniformBuffer(M.ub_SceneParams,68);const l=i.mapUniformBufferF32(M.ub_SceneParams);o+=m.fillMatrix4x4(l,o,a.camera.projectionMatrix),o+=m.fillMatrix4x3(l,o,a.camera.viewMatrix),o+=m.fillMatrix4x3(l,o,a.camera.worldMatrix),l[o++]=a.camera.frustum.right,l[o++]=a.camera.frustum.top,l[o++]=a.camera.frustum.near,l[o++]=a.camera.frustum.far,o+=m.fillColor(l,o,this.currentColors.amb),o+=m.fillColor(l,o,this.currentColors.skyTop),o+=m.fillColor(l,o,this.currentColors.skyBot),o+=m.fillColor(l,o,this.currentColors.water),l[o++]=this.waterOrigin[1],l[o++]=this.waterOrigin[2],l[o++]=this.waterOrigin[0],l[o++]=this.waterOrigin[3],l[o++]=a.time/1e3;for(let t=0;t<this.renderers.length;t++)this.renderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,this.clearRenderPassDescriptor);return this.renderHelper.renderInstManager.drawOnPassRenderer(e,r),this.renderHelper.renderInstManager.resetRenderInsts(),r}createPanels(){const e=new s.Panel;e.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,e.setTitle(s.TIME_OF_DAY_ICON,"Weather");const t=this.weatherTypes;return this.scenarioSelect=new s.SingleSelect,this.scenarioSelect.setStrings(t),this.scenarioSelect.onselectionchange=e=>{this.weather!==e&&(this.weather=e,this.onstatechanged(),this.scenarioSelect.selectItem(e))},this.scenarioSelect.selectItem(0),e.contents.appendChild(this.scenarioSelect.elem),e.setVisible(t.length>0),[e]}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.renderers.length;t++)this.renderers[t].destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(4),n=a(2);function s(e,t,a,n=255){return r.colorNewFromRGBA(e/255,t/255,a/255,n/255)}t.parseTimeCycle=async function(e,t){const a=e.split("\n"),n=[];for(const e of a){const a=e.trim().toLowerCase();if(""===a||a.startsWith("//"))continue;const i=a.split(/\s+/).map(Number);let[o,l,c,h,d,u,m,p,f,A,g,_,S,b,v,w,x,T,y,C,M,U,k,D,I,R,B,P,E,F,V,O,N,L,G,H,j,W,Z,z,K,X,Y,$,q,Q,J,ee,te,ae,re,ne,se,ie,oe,le,ce,he,de,ue,me,pe,fe,Ae,ge]=[];if(40===i.length)[o,l,c,S,b,v,w,x,T,y,C,M,U,k,D,I,R,B,P,E,F,V,O,N,L,G,H,j,W,Z,z,K,X,Y,$,q,Q,J,ee,te]=i;else if(52===i.length&&t.endsWith("timecyc.dat"))[o,l,c,h,d,u,m,p,f,A,g,_,S,b,v,w,x,T,y,C,M,U,k,D,I,R,B,P,E,F,V,O,N,L,G,H,j,W,Z,z,K,X,Y,$,q,Q,J,ee,ae,re,ne,se]=i;else{if(52!==i.length||!t.endsWith("timecycp.dat"))throw new Error("unable to parse time cycle");[o,l,c,h,d,u,S,b,v,w,x,T,y,C,M,U,k,D,I,R,B,P,E,F,V,O,N,L,G,H,j,W,Z,Y,$,q,ae,re,ne,se,ie,oe,le,ce,he,de,ue,me,pe,fe,Ae,ge]=i}const _e=s(o,l,c,0),Se=s(S,b,v),be=s(w,x,T),ve=s(y,C,M),we=s(U,k,D),xe=s(I,R,B),Te=s(j,W,Z),ye=void 0===z?r.colorNewCopy(r.White):s(z,K,X),Ce=s(Y,$,q),Me=void 0===Q?r.colorNewCopy(r.White):s(Q,J,ee,te),Ue=r.colorNewCopy(r.White);void 0!==ae&&void 0!==re&&void 0!==ne&&void 0!==se?(Ue.r=ae/255,Ue.g=re/255,Ue.b=ne/255,Ue.a=se/255):r.colorAdd(Ue,_e,Se),n.push({amb:_e,dir:Se,skyTop:be,skyBot:ve,sunCore:we,sunCorona:xe,sunSz:P,sprSz:E,sprBght:F,shad:V,lightShad:O,poleShad:N,farClp:L,fogSt:G,lightGnd:H,cloud:Te,fluffyTop:ye,fluffyBot:Ce,blur:Me,water:Ue})}return n},t.emptyColorSet=function(){return{amb:r.colorNewCopy(r.White),dir:r.colorNewCopy(r.White),skyTop:r.colorNewCopy(r.White),skyBot:r.colorNewCopy(r.White),sunCore:r.colorNewCopy(r.White),sunCorona:r.colorNewCopy(r.White),sunSz:0,sprSz:0,sprBght:0,shad:0,lightShad:0,poleShad:0,farClp:0,fogSt:0,lightGnd:0,cloud:r.colorNewCopy(r.White),fluffyTop:r.colorNewCopy(r.White),fluffyBot:r.colorNewCopy(r.White),blur:r.colorNewCopy(r.White),water:r.colorNewCopy(r.White)}},t.lerpColorSet=function(e,t,a,s){r.colorLerp(e.amb,t.amb,a.amb,s),r.colorLerp(e.dir,t.dir,a.dir,s),r.colorLerp(e.skyTop,t.skyTop,a.skyTop,s),r.colorLerp(e.skyBot,t.skyBot,a.skyBot,s),r.colorLerp(e.sunCore,t.sunCore,a.sunCore,s),r.colorLerp(e.sunCorona,t.sunCorona,a.sunCorona,s),e.sunSz=n.lerp(t.sunSz,a.sunSz,s),e.sprSz=n.lerp(t.sprSz,a.sprSz,s),e.sprBght=n.lerp(t.sprBght,a.sprBght,s),e.shad=n.lerp(t.shad,a.shad,s),e.lightShad=n.lerp(t.lightShad,a.lightShad,s),e.poleShad=n.lerp(t.poleShad,a.poleShad,s),e.farClp=n.lerp(t.farClp,a.farClp,s),e.fogSt=n.lerp(t.fogSt,a.fogSt,s),e.lightGnd=n.lerp(t.lightGnd,a.lightGnd,s),r.colorLerp(e.cloud,t.cloud,a.cloud,s),r.colorLerp(e.fluffyTop,t.fluffyTop,a.fluffyTop,s),r.colorLerp(e.fluffyBot,t.fluffyBot,a.fluffyBot,s),r.colorLerp(e.blur,t.blur,a.blur,s),r.colorLerp(e.water,t.water,a.water,s)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(12),s=a(0);function i(e,t){const a=e.split("\n");let r=null;for(const e of a){const a=e.trim().toLowerCase();""!==a&&"#"!==a[0]&&(null===r?r=a:"end"===a?r=null:t(r,a.split(/\s*,\s*/g)))}}!function(e){e[e.IS_ROAD=1]="IS_ROAD",e[e.DO_NOT_FADE=2]="DO_NOT_FADE",e[e.DRAW_LAST=4]="DRAW_LAST",e[e.ADDITIVE=8]="ADDITIVE",e[e.IS_SUBWAY=16]="IS_SUBWAY",e[e.IGNORE_LIGHTING=32]="IGNORE_LIGHTING",e[e.NO_ZBUFFER_WRITE=64]="NO_ZBUFFER_WRITE",e[e.DONT_RECEIVE_SHADOWS=128]="DONT_RECEIVE_SHADOWS",e[e.IGNORE_DRAW_DISTANCE=256]="IGNORE_DRAW_DISTANCE",e[e.IS_GLASS_TYPE_1=512]="IS_GLASS_TYPE_1",e[e.IS_GLASS_TYPE_2=1024]="IS_GLASS_TYPE_2",e[e.IS_GARAGE_DOOR=2048]="IS_GARAGE_DOOR",e[e.IS_DAMAGABLE=4096]="IS_DAMAGABLE",e[e.IS_TREE=8192]="IS_TREE",e[e.IS_PALM=16384]="IS_PALM",e[e.DOES_NOT_COLLIDE_WITH_FLYER=32768]="DOES_NOT_COLLIDE_WITH_FLYER",e[e.IS_TAG=1048576]="IS_TAG",e[e.DISABLE_BACKFACE_CULLING=2097152]="DISABLE_BACKFACE_CULLING",e[e.IS_BREAKABLE_STATUE=4194304]="IS_BREAKABLE_STATUE"}(t.ObjectFlags||(t.ObjectFlags={})),t.parseItemDefinition=function(e){let t=[];return i(e,(function(e,a){"objs"!==e&&"tobj"!==e&&"anim"!==e||t.push(function(e,t){const a={id:Number(e[0]),modelName:e[1],txdName:e[2],drawDistance:Number(e.length>5?e[4]:e[3]),flags:Number(t?e[e.length-3]:e[e.length-1]),tobj:t};return t&&(a.timeOn=Number(e[e.length-2]),a.timeOff=Number(e[e.length-1])),a}(a,"tobj"===e))})),{objects:t}},t.INTERIOR_EVERYWHERE=13,t.createItemInstance=function(e){return{modelName:e,translation:r.vec3.create(),scale:r.vec3.fromValues(1,1,1),rotation:r.quat.fromValues(0,0,0,1),interior:t.INTERIOR_EVERYWHERE}},t.parseItemPlacement=function(e,t){const a=[],n=[];return i(t,(function(t,s){"inst"===t&&a.push(function(e){let[t,a,n,s,i,o,l,c,h,d,u,m,p,f]=[];if(12===e.length)[t,a,s,i,o,l,c,h,d,u,m,p]=e,n="0";else if(13===e.length)[t,a,n,s,i,o,l,c,h,d,u,m,p]=e;else{if(11!==e.length)throw new Error("error parsing INST");[t,a,n,s,i,o,d,u,m,p,f]=e,l=c=h="1"}return{id:Number(t),modelName:a,translation:r.vec3.fromValues(Number(s),Number(i),Number(o)),scale:r.vec3.fromValues(Number(l),Number(c),Number(h)),rotation:r.quat.fromValues(Number(d),Number(u),Number(m),-Number(p)),interior:Number(n),lod:void 0===f?void 0:Number(f)}}(s)),"enex"===t&&e.startsWith("interior/")&&n.push(function([e,t,a,n,s,i,o,l,c,h,d,u,m,p,f,A,g,_]){return{enterPos:r.vec3.fromValues(Number(e),Number(t),Number(a)),enterAngle:Number(n),exitPos:r.vec3.fromValues(Number(l),Number(c),Number(h)),exitAngle:Number(d),size:r.vec3.fromValues(Number(s),Number(i),Number(o)),interior:Number(u),name:p.replace(/"/g,"")}}(s))})),{id:e,instances:a,interiors:n}},t.parseItemPlacementBinary=function(e){const t=[],a=e.getUint32(4,!0),n=e.getUint32(28,!0);s.assert(76===n);for(let s=0;s<a;s++){const a=n+40*s,i=e.getFloat32(a+0,!0),o=e.getFloat32(a+4,!0),l=e.getFloat32(a+8,!0),c=e.getFloat32(a+12,!0),h=e.getFloat32(a+16,!0),d=e.getFloat32(a+20,!0),u=e.getFloat32(a+24,!0),m=e.getInt32(a+28,!0),p=e.getInt32(a+32,!0),f=e.getInt32(a+36,!0);t.push({id:m,translation:r.vec3.fromValues(i,o,l),scale:r.vec3.fromValues(1,1,1),rotation:r.quat.fromValues(c,h,d,-u),interior:p,lod:f})}return t},t.parseZones=function(e){const t=new Map;return i(e,(function(e,[a,r,s,i,o,l,c,h,d]){"zone"===e&&"0"===r&&t.set(a,new n.AABB(Number(s),Number(i),Number(o),Number(l),Number(c),Number(h)))})),t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+=-_,:;~/?[]@!$&()*{}|^";t.btoa=function(e,t=e.byteLength,a=n,s=["0","0","0","0","0"]){r.assert(85===a.length);const i=t,o=3&-i;let l="";for(let t=0;t<i;){const n=Math.min(t+4,i);let c=0,h=24;for(;t<n;t++)c|=e[t]<<h,h-=8;c>>>=0,s.fill("0");for(let e=4;e>=0;e--){const t=a.charAt(c%85);r.assert(1===t.length),s[e]=t,c=c/85|0}l+=t===i?s.slice(0,5-o).join(""):s.join("")}return l},t.atob=function(e,t=0,a,s=n){r.assert(85===s.length);const i={};for(let e=0;e<85;e++)i[s.charAt(e)]=e;const o=a.length,l=4*((o+4)/5|0)-(5-o%5)%5;r.assert(l<=e.byteLength-t);e:for(let r=0;r<o;){let n=0;const s=r+5;for(;r<s;r++){n=85*n+(r<o?i[a.charAt(r)]:84)}for(let a=0;a<4;a++)if(e[t++]=n>>24&255,n<<=8,t>=l)break e}return l}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(1),s=a(31),i=a(4),o=a(35);function l(e,t,a){return r.assert(e.validOffsets.indexOf(t)>=0),e.dataBuffer.subarray(t,a)}t.HSD_ArchiveParse=function(e){const t=e.createDataView(),a=(t.getUint32(0),t.getUint32(4)),n=t.getUint32(8),s=t.getUint32(12),i=t.getUint32(16);t.getUint32(20);let o=32;const l=o,c=e.subarray(l,a);o+=a;const h=[];for(let e=0;e<n;e++){const e=t.getUint32(o+0),a=t.getUint32(l+e);h.includes(a)||h.push(a),o+=4}const d=o+8*s+8*i,u=[];for(let a=0;a<s;a++){const a=t.getUint32(o+0),n=t.getUint32(o+4),s=r.readString(e,d+n);h.includes(a)||h.push(a),u.push({name:s,offset:a}),o+=8}const m=[];for(let a=0;a<i;a++){const a=t.getUint32(o+0),n=t.getUint32(o+4),s=r.readString(e,d+n);m.push({name:s,offset:a}),o+=8}return h.sort((e,t)=>e-t),{dataBuffer:c,validOffsets:h,publics:u,externs:m}},t.HSD_Archive_FindPublic=function(e,t){const a=e.publics.find(e=>e.name===t);return void 0!==a?a:null};class c{constructor(e){this.archive=e,this.imageDescs=[],this.tlutDescs=[]}}function h(e,t,a){return l(e.archive,t,a)}function d(e,t){const a=t.createDataView(),r=a.getUint32(0),n=a.getUint16(4),s=a.getUint16(6),i=a.getUint32(8),l=(a.getUint32(12),a.getFloat32(16)),c=a.getFloat32(20),d=h(e,r,o.calcTextureSize(i,n,s));return{offs:t.byteOffset,format:i,width:n,height:s,mipCount:1,minLOD:l,maxLOD:c,data:d}}function u(e,t){const a=t.createDataView(),r=a.getUint32(0),n=a.getUint32(4),s=(a.getUint32(8),a.getUint16(12),h(e,r));return{offs:t.byteOffset,paletteFormat:n,paletteData:s}}function m(e,t,a){const s=a.createDataView(),o=s.getUint32(4),l=s.getUint32(8),c=s.getUint32(12),p=s.getFloat32(16),f=s.getFloat32(20),A=s.getFloat32(24),g=n.vec3.fromValues(p,f,A),_=s.getFloat32(28),S=s.getFloat32(32),b=s.getFloat32(36),v=n.vec3.fromValues(_,S,b),w=s.getFloat32(40),x=s.getFloat32(44),T=s.getFloat32(48),y=n.vec3.fromValues(w,x,T),C=s.getUint32(52),M=s.getUint32(56),U=s.getUint8(60),k=s.getUint8(61);r.assert(U>0&&k>0);const D=s.getUint32(64),I=s.getFloat32(68),R=s.getUint32(72),B=s.getUint32(76);r.assert(0!==B);const P=function(e,t){r.assert(0!==t);let a=e.imageDescs.find(e=>e.offs===t);return void 0===a&&(a=d(e,h(e,t)),e.imageDescs.push(a)),a}(t,B),E=function(e,t){if(0===t)return null;let a=e.tlutDescs.find(e=>e.offs===t);return void 0===a&&(a=u(e,h(e,t)),e.tlutDescs.push(a)),a}(t,s.getUint32(80)),F=(s.getUint32(84),s.getUint32(88));let V=null;if(0!==F){const e=h(t,F).createDataView();V={colorOp:e.getUint8(0),alphaOp:e.getUint8(1),colorBias:e.getUint8(2),alphaBias:e.getUint8(3),colorScale:e.getUint8(4),alphaScale:e.getUint8(5),colorClamp:!!e.getUint8(6),alphaClamp:!!e.getUint8(7),colorIn:[e.getUint8(8),e.getUint8(9),e.getUint8(10),e.getUint8(11)],alphaIn:[e.getUint8(12),e.getUint8(13),e.getUint8(14),e.getUint8(15)],constant:i.colorNewFromRGBA8(e.getUint32(16)),tev0:i.colorNewFromRGBA8(e.getUint32(20)),tev1:i.colorNewFromRGBA8(e.getUint32(24)),active:e.getUint32(28)}}e.push({flags:D,animID:l,src:c,rotation:g,scale:v,translation:y,blending:I,wrapS:C,wrapT:M,repeatS:U,repeatT:k,minFilt:5,magFilt:R,imageDesc:P,tlutDesc:E,tevDesc:V}),0!==o&&m(e,t,h(t,o))}function p(e,t,a){const n=a.createDataView(),i=n.getUint32(4),o=n.getUint32(8),l=n.getUint16(12),c=n.getUint16(14),d=n.getUint32(16),u=n.getUint32(20),{loadedVertexLayout:m,loadedVertexData:f}=function(e,t,a){const r=t.createDataView(),n=[],i=[],o=[];let l=0;for(;;){const t=r.getUint32(l+0);if(255===t)break;const a=r.getUint32(l+4),s=r.getUint32(l+8),c=r.getUint32(l+12),d=r.getUint8(l+16),u=r.getUint16(l+18),m=r.getUint32(l+20);i[t]={type:a},n[t]={compType:c,compCnt:s,compShift:d},o[t]={buffer:h(e,m),offs:0,stride:u},l+=24}const c=s.compileVtxLoader(n,i);return{loadedVertexLayout:c.loadedVertexLayout,loadedVertexData:c.runVertices(o,a)}}(t,h(t,o),h(t,d,32*c)),A=12288&l;if(0===A){const t=u;e.push({flags:l,loadedVertexLayout:m,loadedVertexData:f,kind:"Rigid",jointReference:t})}else{if(8192!==A)throw"whoops";{const a=[],n=u;if(0!==n){const e=h(t,n).createDataView();let r=0;for(;;){const n=e.getUint32(r+0);if(0===n)break;const s=h(t,n).createDataView();let i=0;const o=[];for(;;){const e=s.getUint32(i+0);if(0===e)break;const t=s.getFloat32(i+4);i+=8,o.push({jointReference:e,weight:t})}a.push(o),r+=4}}r.assert(a.length<=10),e.push({flags:l,loadedVertexLayout:m,loadedVertexData:f,kind:"Envelope",envelopeDesc:a})}}0!==i&&p(e,t,h(t,i))}function f(e,t,a){const n=a.createDataView(),s=n.getUint32(4),o=n.getUint32(8);let l=null;0!==o&&(l=function(e,t){const a=t.createDataView(),n=a.getUint32(4),s=a.getUint32(8),o=[];0!==s&&m(o,e,h(e,s));const l=i.colorNewCopy(i.TransparentBlack),c=i.colorNewCopy(i.TransparentBlack),d=i.colorNewCopy(i.TransparentBlack);let u=1,p=0;const f=a.getUint32(12);if(r.assert(0!==f),0!==f){const t=h(e,f).createDataView();i.colorFromRGBA8(l,t.getUint32(0)),i.colorFromRGBA8(c,t.getUint32(4)),i.colorFromRGBA8(d,t.getUint32(8)),u=t.getFloat32(12),p=t.getFloat32(16)}a.getUint32(16);let A=0,g=0,_=0,S=1,b=0,v=1,w=0,x=0,T=3,y=7,C=0,M=7;const U=a.getUint32(20);if(0!==U){const t=h(e,U).createDataView();A=t.getUint8(0),g=t.getUint8(1),_=t.getUint8(2),S=t.getUint8(3),b=t.getUint8(4),v=t.getUint8(5),w=t.getUint8(6),x=t.getUint8(7),T=t.getUint8(8),y=t.getUint8(9),C=t.getUint8(10),M=t.getUint8(11)}else b=1073741824&n?1:0,v=4,w=5,A|=16,T=134217728&n?7:3,536870912&n||(A|=32),y=!(536870912&n)&&1073741824&n?4:7;return{offs:t.byteOffset,renderMode:n,tobj:o,ambient:l,diffuse:c,specular:d,alpha:u,shininess:p,peFlags:A,alphaRef0:g,alphaRef1:_,dstAlpha:S,type:b,srcFactor:v,dstFactor:w,logicOp:x,zComp:T,alphaComp0:y,alphaOp:C,alphaComp1:M}}(t,h(t,o)));const c=n.getUint32(12),d=[];0!==c&&p(d,t,h(t,c)),e.push({mobj:l,pobj:d}),0!==s&&f(e,t,h(t,s))}function A(e,t,a,n){const s=t.createDataView();let i=0;function o(e){const t=e>>>5,a=31&e;let n;if(0===t)r.assert(0===a),n=s.getFloat32(i+0,!0),i+=4;else if(1===t)n=s.getInt16(i+0,!0),i+=2;else if(2===t)n=s.getUint16(i+0,!0),i+=2;else if(3===t)n=s.getInt8(i+0),i+=1;else{if(4!==t)throw"whoops";n=s.getUint8(i+0),i+=1}return n/(1<<a)}function l(){let e=128,t=0;for(let a=0;128&e;a++)e=s.getUint8(i++),t|=(127&e)<<7*a;return t}let c=0,h=0,d=0,u=0,m=0,p=!1;const f=[];let A=0,g=0;for(;i<t.byteLength;){const e=l(),t=15&e;let r=1+(e>>>4);for(let e=0;e<r;e++)5!==t?(1===t?(c=h,h=o(a),p||(d=u,u=0)):2===t?(c=h,h=o(a),p||(d=u,u=0)):3===t?(c=h,h=o(a),d=u,u=0):4===t?(c=h,h=o(a),d=u,u=o(n)):6===t&&(c=h=o(a)),p=!1,1===A||6===A?f.push({kind:"Constant",time:m,p0:c}):2===A?f.push({kind:"Linear",time:m,duration:g,p0:c,p1:h}):3!==A&&4!==A||f.push({kind:"Hermite",time:m,duration:g,p0:c,p1:h,d0:d,d1:u}),m+=g,g=l(),A=t):(d=u,u=o(n),p=!0)}return f}function g(e,t){const a=t.createDataView(),r=a.getUint32(0),n=a.getFloat32(4),s=a.getUint32(8),i=a.getUint32(12),o=[];return 0!==s&&function e(t,a,r){const n=r.createDataView(),s=n.getUint32(0),i=n.getUint32(4),o=(n.getFloat32(8),n.getUint8(12)),l=n.getUint8(13),c=n.getUint8(14),d=A(0,h(a,n.getUint32(16),i),l,c);t.push({type:o,keyframes:d}),0!==s&&e(t,a,h(a,s))}(o,e,h(e,s)),{flags:r,endFrame:n,fobj:o,objID:i}}function _(e,t,a){const r=a.createDataView(),n=r.getUint32(0),s=r.getUint32(4),i=r.getUint32(8),o=r.getUint32(12);let l=null;0!==s&&(l=g(t,h(t,s)));let c=[];0!==i&&function e(t,a,r){const n=r.createDataView(),s=n.getUint32(0),i=n.getUint32(4),o=n.getUint32(8),l=n.getUint32(12),c=n.getUint32(16),m=n.getUint16(20),p=n.getUint16(22);let f=null;0!==f&&(f=g(a,h(a,o)));const A=[],_=h(a,l).createDataView();let S=0;for(let e=0;e<m;e++){const e=_.getUint32(S+0);A.push(d(a,h(a,e))),S+=4}const b=[],v=h(a,c).createDataView();let w=0;for(let e=0;e<p;e++){const e=v.getUint32(w+0);b.push(u(a,h(a,e))),w+=4}t.push({animID:i,aobj:f,imageDescs:A,tlutDescs:b}),0!==s&&e(t,a,h(a,s))}(c,t,h(t,i));let m=null;0!==o&&(h(t,i),m={}),e.push({aobj:l,texAnim:c,renderAnim:m}),0!==n&&_(e,t,h(t,n))}t.HSD_LoadContext=c,t.HSD_LoadContext__ResolvePtrAutoSize=function(e,t){const a=function(e,t){const a=e.validOffsets.indexOf(t);r.assert(a>=0);let n,s=a+1;return n=s>=e.validOffsets.length?e.dataBuffer.byteLength:e.validOffsets[s],n-t}(e.archive,t);return l(e.archive,t,a)},t.HSD_LoadContext__ResolvePtr=h,t.HSD_LoadContext__ResolvePtrString=function(e,t){const a=h(e,t);return r.readString(a,0)},t.HSD_JObjLoadJoint=function(e,t){const a=new c(e),s=[];return function e(t,a,s){r.assert(0!==s);const i=h(a,s).createDataView(),o=i.getUint32(4),l=i.getUint32(8),c=i.getUint32(12),d=i.getUint32(16),u=i.getFloat32(20),m=i.getFloat32(24),p=i.getFloat32(28),A=n.vec3.fromValues(u,m,p),g=i.getFloat32(32),_=i.getFloat32(36),S=i.getFloat32(40),b=n.vec3.fromValues(g,_,S),v=i.getFloat32(44),w=i.getFloat32(48),x=i.getFloat32(52),T=n.vec3.fromValues(v,w,x),y=i.getUint32(56),C=n.mat4.create();if(0!==y){const e=h(a,y).createDataView(),t=e.getFloat32(0),r=e.getFloat32(4),s=e.getFloat32(8),i=e.getFloat32(12),o=e.getFloat32(16),l=e.getFloat32(20),c=e.getFloat32(24),d=e.getFloat32(28),u=e.getFloat32(32),m=e.getFloat32(36),p=e.getFloat32(40),f=e.getFloat32(44);n.mat4.set(C,t,o,u,0,r,l,m,0,s,c,p,0,i,d,f,1)}const M=[];0!==l&&e(M,a,l);const U={jointReferenceID:s,flags:o,rotation:A,scale:b,translation:T,inverseBindPose:C,children:M};if(0===d)t.push(Object.assign(Object.assign({},U),{kind:"None"}));else{if(16384&o)throw"whoops";if(32&o)throw"whoops";{const e=[];f(e,a,h(a,d)),t.push(Object.assign(Object.assign({},U),{kind:"DObj",dobj:e}))}}0!==c&&e(t,a,c)}(s,a,t.offset),r.assert(1===s.length),{jobj:s[0],imageDescs:a.imageDescs,tlutDescs:a.tlutDescs}},t.HSD_FObjLoadKeyframes=A,t.HSD_AObjLoadAnimJoint=function(e,t){if(null===t)return null;const a=[];return function e(t,a,n){r.assert(0!==n);const s=h(a,n).createDataView(),i=s.getUint32(0),o=s.getUint32(4),l=s.getUint32(8),c=(s.getUint32(12),s.getUint32(16),[]);0!==i&&e(c,a,i);let d=null;0!==l&&(d=g(a,h(a,l))),t.push({children:c,aobj:d}),0!==o&&e(t,a,o)}(a,new c(e),t.offset),r.assert(1===a.length),{root:a[0]}},t.HSD_AObjLoadMatAnimJoint=function(e,t){if(null===t)return null;const a=[];return function e(t,a,n){r.assert(0!==n);const s=h(a,n).createDataView(),i=s.getUint32(0),o=s.getUint32(4),l=s.getUint32(8),c=[];0!==i&&e(c,a,i);let d=[];0!==l&&_(d,a,h(a,l)),t.push({children:c,matAnim:d}),0!==o&&e(t,a,o)}(a,new c(e),t.offset),r.assert(1===a.length),{root:a[0]}},t.HSD_AObjLoadShapeAnimJoint=function(e,t){return null}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(48)),s=r(a(58)),i=a(77),o=a(123),l=a(1),c=a(0),h=a(10),d=a(16),u=a(7),m=a(8),p=a(13),f=a(2),A=a(25),g=l.mat4.create(),_=l.mat4.create(),S=l.mat4.create(),b=l.vec4.create();class v{constructor(e,t,a,r,n=[]){this.drawCall=t,this.drawMatrices=a,this.billboard=r,this.visible=!0,this.textureEntry=[],this.vertexColorsEnabled=!0,this.texturesEnabled=!0,this.monochromeVertexColorsEnabled=!1,this.alphaVisualizerEnabled=!1,this.gfxProgram=null,this.textureMappings=c.nArray(2,()=>new h.TextureMapping),this.material=null;for(let t=0;t<this.textureMappings.length;t++)if(t<this.drawCall.textureIndices.length){const a=this.drawCall.textureIndices[t];this.textureEntry[t]=e.sharedOutput.textureCache.textures[a],this.textureMappings[t].gfxTexture=e.textures[a],this.textureMappings[t].gfxSampler=e.samplers[a]}t.materialIndex>=0&&(this.material=c.assertExists(n[t.materialIndex])),this.megaStateFlags=s.translateBlendMode(this.drawCall.SP_GeometryMode,this.drawCall.DP_OtherModeL),this.createProgram()}createProgram(){const e=l.vec4.create();n.fillCombineParams(e,0,this.drawCall.DP_Combine);const t=[];for(let e=0;e<this.textureEntry.length;e++)t.push(this.textureEntry[e].tile);const a=new i.F3DEX_Program(this.drawCall.DP_OtherModeH,this.drawCall.DP_OtherModeL,e,8/255,t);a.defines.set("BONE_MATRIX_COUNT",this.drawMatrices.length.toString()),this.texturesEnabled&&this.drawCall.textureIndices.length&&a.defines.set("USE_TEXTURE","1");const r=0!=(4&this.drawCall.SP_GeometryMode);this.vertexColorsEnabled&&r&&a.defines.set("USE_VERTEX_COLOR","1"),131072&this.drawCall.SP_GeometryMode&&a.defines.set("LIGHTING","1"),262144&this.drawCall.SP_GeometryMode&&a.defines.set("TEXTURE_GEN","1"),524288&this.drawCall.SP_GeometryMode&&a.defines.set("TEXTURE_GEN_LINEAR","1"),this.monochromeVertexColorsEnabled&&a.defines.set("USE_MONOCHROME_VERTEX_COLOR","1"),this.alphaVisualizerEnabled&&a.defines.set("USE_ALPHA_VISUALIZER","1"),a.defines.set("EXTRA_COMBINE","1"),this.program=a,this.gfxProgram=null}setBackfaceCullingEnabled(e){const t=e?d.translateCullMode(this.drawCall.SP_GeometryMode):0;this.megaStateFlags.cullMode=t}setVertexColorsEnabled(e){this.vertexColorsEnabled=e,this.createProgram()}setTexturesEnabled(e){this.texturesEnabled=e,this.createProgram()}setMonochromeVertexColorsEnabled(e){this.monochromeVertexColorsEnabled=e,this.createProgram()}setAlphaVisualizerEnabled(e){this.alphaVisualizerEnabled=e,this.createProgram()}computeTextureMatrix(e,t){if(void 0!==this.textureEntry[t]){const a=this.textureEntry[t],r=a.tile.shifts<=10?1/(1<<a.tile.shifts):1<<16-a.tile.shifts,n=a.tile.shiftt<=10?1/(1<<a.tile.shiftt):1<<16-a.tile.shiftt;e[0]=r/a.width,e[5]=n/a.height,this.material&&128&this.material.data.flags&&(e[0]*=this.material.xScale(),e[5]*=this.material.yScale()),e[12]=-a.tile.uls/4/a.width,e[13]=-a.tile.ult/4/a.height;const s=0===t?32:64;this.material&&this.material.data.flags&s&&(e[12]=-this.material.getXShift(t)/a.width,e[13]=-this.material.getYShift(t)/a.height)}else l.mat4.identity(e)}prepareToRender(e,t,a,r){var n,s,o;if(!this.visible)return;null===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program));const c=t.pushRenderInst();c.setGfxProgram(this.gfxProgram),32&this.drawCall.DP_OtherModeL||(c.sortKey=u.makeSortKey(128)),null===(n=this.material)||void 0===n||n.fillTextureMappings(this.textureMappings),c.setSamplerBindingsFromTextureMappings(this.textureMappings),c.setMegaStateFlags(this.megaStateFlags),c.drawIndexes(this.drawCall.indexCount,this.drawCall.firstIndex);let h=c.allocateUniformBuffer(i.F3DEX_Program.ub_DrawParams,12*this.drawMatrices.length+16);const d=c.mapUniformBufferF32(i.F3DEX_Program.ub_DrawParams);r?m.computeViewMatrixSkybox(g,a.camera):m.computeViewMatrix(g,a.camera);for(let e=0;e<this.drawMatrices.length;e++)l.mat4.mul(_,g,this.drawMatrices[e]),8&this.billboard?A.J3DCalcBBoardMtx(_,_):2&this.billboard&&A.J3DCalcYBBoardMtx(_,_),h+=p.fillMatrix4x3(d,h,_);this.computeTextureMatrix(S,0),h+=p.fillMatrix4x2(d,h,S),this.computeTextureMatrix(S,1),h+=p.fillMatrix4x2(d,h,S),h=c.allocateUniformBuffer(i.F3DEX_Program.ub_CombineParams,12);const f=c.mapUniformBufferF32(i.F3DEX_Program.ub_CombineParams);l.vec4.copy(b,this.drawCall.DP_PrimColor),null===(s=this.material)||void 0===s||s.getColor(b,0),h+=p.fillVec4v(f,h,b),l.vec4.copy(b,this.drawCall.DP_EnvColor),null===(o=this.material)||void 0===o||o.getColor(b,1),h+=p.fillVec4v(f,h,b);let v=this.drawCall.DP_PrimLOD;this.material&&24&this.material.data.flags&&(v=this.material.getPrimLOD()),h+=p.fillVec4(f,h,v)}}function w(e,t,a,r){f.computeModelMatrixSRT(e,r[0],r[1],r[2],a[0],a[1],a[2],t[0],t[1],t[2])}t.buildTransform=w;const x=[{numUniformBuffers:3,numSamplers:2}],T=l.vec3.create(),y=l.vec3.fromValues(0,1,0),C=l.vec3.create();class M{constructor(e,t,a,r=!1){this.node=t,this.parent=a,this.isSkybox=r,this.visible=!0,this.modelMatrix=l.mat4.create(),this.transform=l.mat4.create(),this.children=[],this.drawCalls=[],this.translation=l.vec3.create(),this.euler=l.vec3.create(),this.scale=l.vec3.clone(f.Vec3One),this.animator=new o.Animator,this.materials=[];const n=[this.modelMatrix,a];for(let a=0;a<t.materials.length;a++)this.materials.push(new o.Material(t.materials[a],e.textures));if(void 0!==t.model&&null!==t.model.rspOutput)for(let a=0;a<t.model.rspOutput.drawCalls.length;a++)this.drawCalls.push(new v(e,t.model.rspOutput.drawCalls[a],n,this.node.billboard,this.materials));this.setTransfromFromNode()}setTransfromFromNode(){l.vec3.copy(this.translation,this.node.translation),l.vec3.copy(this.euler,this.node.euler),l.vec3.copy(this.scale,this.node.scale),w(this.transform,this.translation,this.euler,this.scale)}animate(e){if(this.animator.update(e)){for(let t=0;t<=9;t++){if(0===this.animator.interpolators[t].op)continue;const a=this.animator.compute(t,e);switch(t){case 0:this.euler[0]=a;break;case 1:this.euler[1]=a;break;case 2:this.euler[2]=a;break;case 3:{const e=c.assertExists(this.animator.interpolators[t].path);o.getPathPoint(this.translation,e,f.clamp(a,0,1),!0)}break;case 4:this.translation[0]=a;break;case 5:this.translation[1]=a;break;case 6:this.translation[2]=a;break;case 7:this.scale[0]=a;break;case 8:this.scale[1]=a;break;case 9:this.scale[2]=a}}w(this.transform,this.translation,this.euler,this.scale)}for(let t=0;t<this.materials.length;t++)this.materials[t].update(e)}prepareToRender(e,t,a){if(this.visible){if(l.mat4.mul(this.modelMatrix,this.parent,this.transform),!(1&this.animator.stateFlags))for(let r=0;r<this.drawCalls.length;r++)this.drawCalls[r].prepareToRender(e,t,a,this.isSkybox);for(let r=0;r<this.children.length;r++)this.children[r].prepareToRender(e,t,a)}}}t.NodeRenderer=M;t.ModelRenderer=class{constructor(e,t,a,r=!1){this.renderData=e,this.nodes=t,this.animations=a,this.isSkybox=r,this.visible=!0,this.hidden=!1,this.animationPaused=!1,this.modelMatrix=l.mat4.create(),this.renderers=[],this.animationController=new i.AdjustableAnimationController(30),this.currAnimation=-1,this.headAnimationIndex=-1;for(let a=0;a<t.length;a++){const n=t[a].parent;-1===n?this.renderers.push(new M(e,t[a],this.modelMatrix,r)):(this.renderers.push(new M(e,t[a],this.renderers[n].modelMatrix,r)),this.renderers[n].children.push(this.renderers[a]))}this.animations.length>0&&this.setAnimation(0)}setBackfaceCullingEnabled(e){for(let t=0;t<this.renderers.length;t++)for(let a=0;a<this.renderers[t].drawCalls.length;a++)this.renderers[t].drawCalls[a].setBackfaceCullingEnabled(e)}setVertexColorsEnabled(e){for(let t=0;t<this.renderers.length;t++)for(let a=0;a<this.renderers[t].drawCalls.length;a++)this.renderers[t].drawCalls[a].setVertexColorsEnabled(e)}setTexturesEnabled(e){for(let t=0;t<this.renderers.length;t++)for(let a=0;a<this.renderers[t].drawCalls.length;a++)this.renderers[t].drawCalls[a].setTexturesEnabled(e)}setMonochromeVertexColorsEnabled(e){for(let t=0;t<this.renderers.length;t++)for(let a=0;a<this.renderers[t].drawCalls.length;a++)this.renderers[t].drawCalls[a].setMonochromeVertexColorsEnabled(e)}setAlphaVisualizerEnabled(e){for(let t=0;t<this.renderers.length;t++)for(let a=0;a<this.renderers[t].drawCalls.length;a++)this.renderers[t].drawCalls[a].setAlphaVisualizerEnabled(e)}forceLoop(){for(let e=0;e<this.renderers.length;e++){this.renderers[e].animator.forceLoop=!0;for(let t=0;t<this.renderers[e].materials.length;t++)this.renderers[e].materials[t].forceLoop()}}setAnimation(e){this.currAnimation=e,this.animationController.init(this.animations[e].fps);const t=this.animations[e];this.headAnimationIndex=t.tracks.findIndex(e=>null!==e);for(let e=0;e<this.renderers.length;e++){if(this.renderers[e].animator.setTrack(t.tracks[e]),null===t.tracks[e]&&this.renderers[e].setTransfromFromNode(),0==t.materialTracks.length||0===t.materialTracks[e].length)for(let t=0;t<this.renderers[e].materials.length;t++)this.renderers[e].materials[t].setTrack(null);else for(let a=0;a<this.renderers[e].materials.length;a++)this.renderers[e].materials[a].setTrack(t.materialTracks[e][a]);this.renderers[e].animate(0),l.mat4.mul(this.renderers[e].modelMatrix,this.renderers[e].parent,this.renderers[e].transform)}}motion(e,t){}animate(){if(this.animationPaused)return;const e=this.animationController.getTimeInFrames();for(let t=0;t<this.renderers.length;t++)this.renderers[t].animate(e)}prepareToRender(e,t,a,r){if(!this.visible)return;if(this.animationController.setTimeFromViewerInput(a),this.motion(a,r),this.animate(),this.hidden)return;const n=t.pushTemplateRenderInst();n.setBindingLayouts(x),n.setInputLayoutAndState(this.renderData.inputLayout,this.renderData.inputState),n.filterKey=this.isSkybox?2:1;let s=n.allocateUniformBuffer(i.F3DEX_Program.ub_SceneParams,24);const o=n.mapUniformBufferF32(i.F3DEX_Program.ub_SceneParams);s+=p.fillMatrix4x4(o,s,a.camera.projectionMatrix),l.mat4.getTranslation(T,this.modelMatrix),l.vec3.transformMat4(T,T,a.camera.viewMatrix),l.mat4.lookAt(_,C,T,y),s+=p.fillVec4(o,s,_[0],_[4],_[8]),s+=p.fillVec4(o,s,_[1],_[5],_[9]),this.renderers[0].prepareToRender(e,t,a),t.popTemplateRenderInst()}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.NaiveInterpreter=class{constructor(){this.regs=r.nArray(32,()=>({value:0,lastOp:0})),this.fregs=r.nArray(32,()=>({value:0,lastOp:0})),this.stackArgs=r.nArray(10,()=>({value:0,lastOp:0})),this.done=!1,this.valid=!0,this.lastInstr=0}reset(){for(let e=0;e<this.regs.length;e++)this.regs[e].value=0,this.regs[e].lastOp=0;for(let e=0;e<this.fregs.length;e++)this.fregs[e].value=0,this.fregs[e].lastOp=0;for(let e=0;e<this.stackArgs.length;e++)this.stackArgs[e].value=0,this.stackArgs[e].lastOp=0;this.done=!1,this.valid=!0,this.lastInstr=0}parseFromView(e,t=0){this.reset();const a=[];let n=0,s=null,i=0;for(;!this.done;){const o=e.getUint32(t+0);this.lastInstr=o;let l=o>>>26;const c=o>>>21&31;0===l&&0!==o?l=63&o|256:17===l&&(l=16===c||17===c?768|63&o:512|c);const h=o>>>16&31,d=o>>>11&31,u=o>>>6&31,m=e.getInt16(t+2),p=o>>>0&65535;switch(l){case 0:break;case 4:if(0===c&&0===h&&m>0){i=Math.max(i,t+4*(m+1)),null!==s&&(r.assert(!this.valid||-1===s.end||s.end===t+8,"unconditional branch in the middle of if block"),s.end=t+8);break}case 5:case 21:case 20:{if(m<=0){this.handleLoop(l,this.regs[c],this.regs[h],m);break}if(null!==s){this.handleUnknown(l);break}r.assert(0!==c||0!==h,"bad trivial branch");let e=this.regs[h];(0===h||0!==c&&this.seemsLikeLiteral(c))&&(e=this.regs[c]);const n={lastOp:e.lastOp,value:e.value};let o=t+8,d=t+4*(m+1);i=Math.max(i,d),0===c||0===h||4!==l&&20!==l||(o=d,d=-1),a.push({op:l,start:o,end:d,comparator:n})}break;case 40:case 41:case 43:if(29!==c)this.handleStore(l,this.regs[h],this.regs[c],m);else if(31!==h&&43===l){const e=(p>>>2)-4;e>=0&&e<this.stackArgs.length&&(this.stackArgs[e].lastOp=this.regs[h].lastOp,this.stackArgs[e].value=this.regs[h].value)}break;case 57:if(29!==c)this.handleStore(l,this.fregs[h],this.regs[c],m);else{const e=(p>>>2)-4;e>=0&&e<this.stackArgs.length&&(this.stackArgs[e].lastOp=this.fregs[h].lastOp,this.stackArgs[e].value=this.fregs[h].value)}break;case 35:const e=(m>>>2)-4;if(29===c&&e>=0&&e<this.stackArgs.length){const t=this.stackArgs[e];if(null!==t){this.regs[h].value=t.value,this.regs[h].lastOp=t.lastOp;break}}case 32:case 36:case 33:case 37:case 49:{const e=49===l?this.fregs[h]:this.regs[h];0===m?e.value=this.guessValue(c):0==(65535&this.regs[c].value)?e.value=this.guessValue(c)+m:e.value=m,e.lastOp=l}break;case 289:this.regs[d].value=this.guessValue(c)+this.guessValue(h),this.regs[d].lastOp=l;break;case 292:this.regs[d].value=this.guessValue(c,h),293!==this.regs[c].lastOp&&13!==this.regs[c].lastOp||(this.regs[d].value=this.guessValue(h)),this.regs[d].lastOp=l;break;case 293:0===h?(this.regs[d].value=this.regs[c].value,this.regs[d].lastOp=this.regs[c].lastOp):(this.regs[d].value=this.guessValue(c,h),this.regs[d].lastOp=l);break;case 13:this.regs[h].value=this.guessValue(c)|p,this.regs[h].lastOp=l;break;case 12:this.regs[h].value=p,this.regs[h].lastOp=l;break;case 9:29!==h&&(this.regs[h].value=this.guessValue(c)+m,this.regs[h].lastOp=l);break;case 15:this.regs[h].value=p<<16>>>0,this.regs[h].lastOp=l;break;case 3:n=(16777215&o)<<2;break;case 264:if(31===c)return this.finish(),this.valid;this.handleUnknown(l);break;case 512:this.regs[h].lastOp=this.fregs[d].lastOp,this.regs[h].value=this.fregs[d].value;break;case 516:this.fregs[d].lastOp=this.regs[h].lastOp,this.fregs[d].value=this.regs[h].value;break;case 769:case 768:case 770:this.fregs[u].lastOp=l,this.fregs[u].value=this.fregs[d].value,(0===this.fregs[d].value||49===this.fregs[d].lastOp&&this.fregs[d].value<2147483648)&&(this.fregs[u].value=this.fregs[h].value);break;case 774:this.fregs[u].lastOp=this.fregs[d].lastOp;break;default:this.handleUnknown(l)}if(20!==l&&21!==l||(t+=4),0!==n&&3!==l){const e=this.handleFunction(n,this.regs[4],this.regs[5],this.regs[6],this.regs[7],this.stackArgs,s);this.regs[2].lastOp=3,this.regs[2].value=e,this.fregs[0].lastOp=3,this.fregs[0].value=e,n=0}t+=4,null!==s&&(s.end>=0&&t>=s.end||t>=i)&&(s=null);for(let e=0;e<a.length;e++)if(a[e].start===t){s=a[e];break}}return this.finish(),this.valid}guessValue(e,t=0){return this.seemsLikeLiteral(e)?this.regs[e].value:this.seemsLikeLiteral(t)?this.regs[t].value:0}seemsLikeLiteral(e){switch(this.regs[e].lastOp){case 3:return 0!==this.regs[e].value;case 292:case 293:case 9:case 12:case 13:case 15:return!0}return!1}handleFunction(e,t,a,r,n,s,i){return 0}handleStore(e,t,a,r){}handleUnknown(e){this.valid=!1}handleLoop(e,t,a,r){this.valid=!1}finish(){}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(201)),s=a(124),i=a(2),o=a(1),l=a(123),c=a(0);function h(e,t){return"number"==typeof t?t:e.storedValues[t.index]}t.MotionData=class{constructor(){this.currMotion=[],this.storedValues=c.nArray(3,()=>0),this.start=-1,this.auxStart=-1,this.startPos=o.vec3.create(),this.refPosition=o.vec3.create(),this.destination=o.vec3.create(),this.lastImpact=o.vec3.create(),this.groundType=0,this.groundHeight=0,this.reset()}reset(){this.stateFlags=0,this.currMotion=[],this.currBlock=0,this.pathParam=0,this.start=-1,this.auxStart=-1,o.vec3.copy(this.startPos,i.Vec3Zero),this.movingYaw=0,this.ySpeed=0,this.forwardSpeed=0,this.ignoreGround=!1,o.vec3.copy(this.refPosition,i.Vec3Zero),o.vec3.copy(this.destination,i.Vec3Zero),o.vec3.copy(this.lastImpact,i.Vec3Zero)}};class d extends n.NaiveInterpreter{constructor(){super(...arguments),this.blocks=[],this.startAddress=0,this.timer=0,this.ySpeed=0,this.yawDirection=0,this.movingYaw=0,this.positionOffset=o.vec3.create(),this.yawOffset=0}reset(){super.reset(),this.blocks=[],this.timer=0,this.ySpeed=0,this.movingYaw=0,o.vec3.copy(this.positionOffset,i.Vec3Zero),this.yawOffset=0}parse(e,t,a){return this.dataMap=e,this.animations=a,this.startAddress=t,super.parseFromView(e.getView(t))}getFloatValue(e){let t=0;return t=e.value>2147483648&&e.value<2151677952?i.bitsAsFloat32(this.dataMap.deref(e.value)):i.bitsAsFloat32(e.value),c.assert((0===t||Math.abs(t)>1e-6)&&Math.abs(t)<1e6,`bad float value ${c.hexzero(e.value,8)}}`),t}getFloatParam(e){if(e.value<256){const t=e.value-176>>>2;return t>=3?(console.warn("bad stored value index",t),{index:0}):{index:t}}return this.getFloatValue(e)}handleFunction(e,t,a,r,n,s,o){switch(e){case 3547216:break;case 3535196:case 3535160:{const t=3535196===e;if(9!==a.lastOp||a.value<2147483648){this.valid=!1,console.warn("bad animation address in motion",c.hexzero(a.value,8));break}let r=this.animations.findIndex(e=>e==a.value);-1===r&&(r=this.animations.length,this.animations.push(a.value)),this.blocks.push({kind:"animation",index:r,force:t})}break;case 3547336:{let e=0;35===a.lastOp?236===a.value?e=2:4===a.value?e=3:0===a.value?e=5:console.warn("unknown path start",a.value):3===a.lastOp?e=1:(512!==a.lastOp&&9!==a.lastOp&&0!==a.lastOp||0!==a.value)&&console.warn("unknown path start",a.lastOp,a.value);let t=0;35===r.lastOp&&4===r.value?e=4:5!==e&&(t=this.getFloatValue(r)),this.blocks.push({kind:"path",start:e,end:t,speed:this.getFloatParam(n),maxTurn:this.getFloatValue(s[0]),flags:s[1].value})}break;case 3541688:this.blocks.push({kind:"projectile",g:this.getFloatValue(a),moveForward:1===r.value,ySpeed:this.ySpeed,direction:this.yawDirection,yaw:this.movingYaw});break;case 3539712:case 3540044:case 3540368:case 3540712:{const t=3539712===e||3540368===e,i=3540368===e||3540712===e?-1:1;this.blocks.push({kind:"vertical",asDelta:t,startSpeed:this.ySpeed,target:this.getFloatParam(a),g:this.getFloatValue(r),minVel:this.getFloatValue(n),maxVel:this.getFloatValue(s[0]),direction:i})}break;case 3543312:this.blocks.push({kind:"random",radius:this.getFloatValue(a),maxTurn:this.getFloatValue(r)});break;case 3544904:case 3545420:this.blocks.push({kind:"walkToTarget",radius:this.getFloatValue(a),maxTurn:this.getFloatValue(r),flags:1|n.value,away:3545420===e});break;case 3544204:this.blocks.push({kind:"faceTarget",maxTurn:this.getFloatValue(a),flags:r.value});break;case 3544128:this.blocks.push({kind:"basic",subtype:2,param:0});break;case 3545960:if(this.blocks.length>0&&"point"===this.blocks[this.blocks.length-1].kind)break;this.blocks.push({kind:"point",goal:0,maxTurn:this.getFloatValue(a),destination:0,flags:r.value});break;case 3546712:this.blocks.push({kind:"point",goal:0,maxTurn:this.getFloatValue(a),destination:0,flags:1});break;case 3542812:case 2977300:this.blocks.push({kind:"forward",stopIfBlocked:!1});break;case 3531124:case 3531220:this.blocks.push({kind:"splash",onImpact:!1,index:-1,scale:i.Vec3One});break;case 3531416:this.blocks.push({kind:"splash",onImpact:!0,index:8,scale:i.Vec3One});break;case 3537904:c.assert(4===a.value&&this.timer>0),this.blocks.push({kind:"basic",subtype:1,param:this.timer}),this.timer=0;break;case 48296:t.value>1&&this.blocks.push({kind:"basic",subtype:1,param:t.value/30})}return 0}handleStore(e,t,a,r){if(43===e||57===e)switch(r){case 4:case 8:case 12:{if(768!==t.lastOp&&769!==t.lastOp||t.value<256)break;let e=this.getFloatValue(t);769===t.lastOp&&(e*=-1),9===a.lastOp&&4===a.value?this.positionOffset[r-4>>>2]=e:9===a.lastOp&&20===a.value&&(c.assert(12===r),this.yawOffset=e)}break;case 28:case 32:case 36:{if(57!==e||35!==a.lastOp||72!==a.value)break;if(768!==t.lastOp&&769!==t.lastOp||t.value<256)break;let n=this.getFloatValue(t);769===t.lastOp&&(n*=-1),this.positionOffset[r-28>>2]=n}break;case 144:c.assert(43===e&&9===t.lastOp),this.timer=t.value/30;break;case 152:c.assert(57===e),this.blocks.push({kind:"basic",subtype:3,param:this.getFloatValue(t)});break;case 156:c.assert(57===e),this.ySpeed=this.getFloatValue(t);break;case 160:3===t.lastOp?this.yawDirection=3:768===t.lastOp?this.yawDirection=1:(49===t.lastOp&&t.value>2147483648||0===t.lastOp)&&(this.yawDirection=2,this.movingYaw=this.getFloatValue(t))}}handleLoop(e,t,a,r){let n=0;if(5!==e&&21!==e||9!==t.lastOp&&0!==t.lastOp||9!==a.lastOp&&0!==a.lastOp)return;t.value>15&&0===a.value?n=t.value+1:1===t.value&&a.value>15&&(n=a.value);const s=o.vec3.clone(this.positionOffset);o.vec3.scale(s,s,30),this.blocks.push({kind:"linear",duration:n/30,velocity:s,turnSpeed:30*this.yawOffset,matchTarget:!1})}finish(){0===this.blocks.length&&this.blocks.push({kind:"basic",subtype:0,param:0}),function(e,a){switch(e){case 2150416864:c.assert("path"===a[0].kind),a[0].flags=3;break;case 2150415324:c.assert("linear"===a[0].kind),a[0].velocity[1]=-60;break;case 2150415580:c.assert("linear"===a[0].kind),a[0].velocity[1]=-15;break;case 2150497336:c.assert("linear"===a[0].kind),a[0].velocity[1]=-150;break;case 2150472320:c.assert("point"===a[0].kind),a[0].goal=1,a[0].destination=2;break;case 2150535816:c.assert("point"===a[0].kind),a[0].destination=1;break;case 2150530524:c.assert("faceTarget"===a[0].kind),a[0].flags|=8;break;case 2150367092:c.assert("splash"===a[1].kind),a[1].scale=o.vec3.fromValues(2,2,2);break;case 2150409268:case 2150442024:case 2150478448:c.assert("splash"===a[1].kind),a[1].onImpact=!0,a[1].index=13;break;case 2150481328:c.assert("splash"===a[1].kind),a[1].onImpact=!0,a[1].index=4;break;case 2150484520:case 2150366340:c.assert("linear"===a[0].kind),a[0].matchTarget=!0;break;case 2150440268:c.assert("projectile"===a[1].kind),a[1].direction=5;break;case 2150440896:c.assert("projectile"===a[1].kind),a[1].direction=4,a.push({kind:"basic",subtype:4,param:0});break;case 2150488588:c.assert("basic"===a[0].kind),a[0].subtype=0;break;case 2150420080:c.assert("point"===a[1].kind),a[1].destination=3,a[1].goal=2,a.splice(2,0,{kind:"basic",subtype:0,param:1}),c.assert("basic"===a[3].kind&&3===a[3].subtype),a[3].param=8e3,c.assert("point"===a[4].kind),t.staryuApproach=a[4],a[4]={kind:"basic",subtype:0,param:2};break;case 2150420908:a[0]={kind:"basic",subtype:0,param:3};break;case 2150421244:a.unshift({kind:"basic",subtype:0,param:4})}}(this.startAddress,this.blocks)}}t.MotionParser=d;const u=o.vec3.create();function m(e,t){return Math.atan2(e[0]-t[0],e[2]-t[2])}t.motionBlockInit=function(e,t,a,r,n){e.start=r.time,o.vec3.copy(e.startPos,t);const s=e.currMotion[e.currBlock];switch(s.kind){case"path":switch(s.start){case 2:break;case 0:case 4:e.pathParam=0;break;case 1:e.pathParam=Math.random();break;case 3:e.pathParam=e.path.times[1];break;case 5:e.pathParam=e.path.times[e.storedValues[0]]}break;case"projectile":switch(s.direction){case 0:break;case 1:e.movingYaw=a[1]+Math.PI;break;case 2:e.movingYaw=s.yaw,a[1]=s.yaw;break;case 3:e.movingYaw=Math.atan2(e.lastImpact[0],e.lastImpact[2]);break;case 5:case 4:l.getPathPoint(u,c.assertExists(e.path),5===s.direction?0:1),4===s.direction?e.movingYaw=m(u,t):(o.vec3.copy(t,u),o.vec3.copy(e.startPos,u))}break;case"vertical":e.ySpeed=s.startSpeed;break;case"random":{const r=a[1]+Math.PI*(1+2/3*Math.floor(3*Math.random()));e.refPosition[0]=t[0]+s.radius*Math.sin(r),e.refPosition[2]=t[2]+s.radius*Math.cos(r),e.movingYaw=r-Math.PI}break;case"walkToTarget":if(null===n)return 2;o.vec3.copy(e.refPosition,n.translation);break;case"faceTarget":if(32&s.flags)o.mat4.getTranslation(e.refPosition,r.camera.worldMatrix);else{if(null===n)return 2;o.vec3.copy(e.refPosition,n.translation)}break;case"point":2===s.destination?o.vec3.copy(e.destination,c.assertExists(n).translation):1===s.destination&&l.getPathPoint(e.destination,c.assertExists(e.path),0)}return 0},t.yawTowards=m;const p=o.vec3.create();function f(e,t,a,r,n){if(!a.ignoreGround&&!A(r.collision,t[0],t[2]))return!0;if(o.vec3.sub(p,t,e),o.vec3.normalize(p,p),!a.ignoreGround&&!A(r.collision,e[0]+p[0],e[2]+p[2]))return!0;const i=s.findGroundPlane(r.collision,t[0],t[2]);return a.groundType=i.type,a.groundHeight=s.computePlaneHeight(i,t[0],t[2]),!!(16&n&&e[1]!==a.groundHeight)||(e[0]=t[0],e[2]=t[2],1&n&&(e[1]=a.groundHeight),!1)}function A(e,t,a){switch(s.findGroundPlane(e,t,a).type){case 32614:case 65280:case 3375026:case 5033164:case 8349235:case 8349311:case 16711680:case 16731161:case 16744370:return!1}return!0}function g(e,t){return 0!==t.currentSong&&o.vec3.dist(e,t.translation)<2500}function _(e,t,a,r){const n=i.angleDist(e[1],t);return e[1]+=i.clampRange(n,a*r*30),Math.abs(n)<a*r*30}t.attemptMove=f,t.canHearSong=g;const S=o.vec3.create(),b=o.vec3.create();t.followPath=function(e,t,a,r,n,i){if(32&a.stateFlags||!a.path)return 0;a.pathParam+=30*h(a,r.speed)*n/a.path.duration;let o=r.end;if(5===r.start?o=a.path.times[a.storedValues[1]]:4===r.start&&(o=a.path.times[1]),o>0&&a.pathParam>o)return 2;a.pathParam=a.pathParam%1;const c=e[1];if(l.getPathPoint(e,a.path,a.pathParam),16&r.flags?e[1]=c:1&r.flags&&(e[1]=s.findGroundHeight(i.collision,e[0],e[2])),130&r.flags){l.getPathTangent(S,a.path,a.pathParam);const e=Math.atan2(S[0],S[2]);2&r.flags?t[1]=e:_(t,e,r.maxTurn,n)}return 1},t.projectile=function(e,t,a,r,n){return r=(r-t.start)/1e3,o.vec3.set(S,Math.sin(t.movingYaw)*t.forwardSpeed,a.ySpeed,Math.cos(t.movingYaw)*t.forwardSpeed),o.vec3.scaleAndAdd(b,t.startPos,S,r),b[1]+=a.g*r*r*15,a.moveForward&&f(e,b,t,n,0),e[1]=b[1],30*r*a.g+a.ySpeed<0&&e[1]<t.groundHeight?(e[1]=t.groundHeight,2):1},t.vertical=function(e,t,a,r,n){if(32&a.stateFlags)return 0;e[0]+=Math.sin(t[1])*a.forwardSpeed*n,e[1]+=a.ySpeed*n*r.direction,e[2]+=Math.cos(t[1])*a.forwardSpeed*n,0!==r.g&&(a.ySpeed+=30*r.g*n,a.ySpeed=i.clamp(a.ySpeed,r.minVel,r.maxVel));const s=h(a,r.target);return r.asDelta&&Math.abs(a.startPos[1]-e[1])>=s||!r.asDelta&&e[1]>s==r.direction>0?2:1},t.randomCircle=function(e,t,a,r,n,s){return a.movingYaw+=n*a.forwardSpeed/r.radius,b[0]=a.refPosition[0]+r.radius*Math.sin(a.movingYaw),b[2]=a.refPosition[2]+r.radius*Math.cos(a.movingYaw),f(e,b,a,s,1)?2:(_(t,a.movingYaw+Math.PI/2,r.maxTurn,n),1)};const v=o.vec3.create();t.linear=function(e,t,a,r,n,s,i){return o.vec3.scaleAndAdd(e,e,r.velocity,s),r.matchTarget&&n&&(o.vec3.lerp(v,a.startPos,n.translation,(i-a.start)/1e3/r.duration),e[0]=v[0],e[2]=v[2]),t[1]+=r.turnSpeed*s,(i-a.start)/1e3>=r.duration?2:1},t.walkToTarget=function(e,t,a,r,n,s,i){if(2&r.flags){if(null===n)return 2;o.vec3.copy(a.refPosition,n.translation)}const l=m(a.refPosition,e)+(r.away?Math.PI:0);return o.vec3.copy(b,e),b[0]+=a.forwardSpeed*s*Math.sin(l),b[2]+=a.forwardSpeed*s*Math.cos(l),f(e,b,a,i,r.flags)?2:(_(t,l,r.maxTurn,s),o.vec3.dist(a.refPosition,e)<r.radius!==r.away?(a.stateFlags|=16,2):1)},t.faceTarget=function(e,t,a,r,n,s,i){if(2&r.flags)if(32&r.flags)o.vec3.copy(a.refPosition,i.translation);else{if(null===n)return 2;o.vec3.copy(a.refPosition,n.translation)}if(4&r.flags&&!g(e,i))return 2;let l=m(a.refPosition,e);return 64&r.flags&&(l+=Math.PI),!_(t,l,r.maxTurn,s)||8&r.flags?1:2};const w=o.vec3.create();t.approachPoint=function(e,t,a,r,n,l){3===n.destination&&o.vec3.copy(a.destination,r.translation);const c=Math.hypot(e[0]-a.destination[0],e[2]-a.destination[2]),h=c<a.forwardSpeed*l;h&&(a.stateFlags|=16);let d=!1;switch(n.goal){case 0:d=h,d&&(o.vec3.copy(e,a.destination),1&n.flags&&(e[1]=s.findGroundHeight(r.collision,e[0],e[2])));break;case 1:d=8349235!==a.groundType;break;case 2:d=c<500}if(d)return 2;o.vec3.sub(w,a.destination,e),w[1]=0;const u=Math.atan2(w[0],w[2]);return i.normToLength(w,l*a.forwardSpeed),o.vec3.add(w,w,e),f(e,w,a,r,n.flags)?0:(_(t,u,n.maxTurn,l),1)};const x=o.vec3.create();t.forward=function(e,t,a,r,n,s){if(o.vec3.set(x,Math.sin(t[1]),0,Math.cos(t[1])),o.vec3.scaleAndAdd(x,e,x,s*a.forwardSpeed),n.stopIfBlocked){if(f(e,x,a,r,1))return 2}else o.vec3.copy(e,x);return 1}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var r=function(){function e(){this._hasWeakSet="function"==typeof WeakSet,this._inner=this._hasWeakSet?new WeakSet:[]}return e.prototype.memoize=function(e){if(this._hasWeakSet)return!!this._inner.has(e)||(this._inner.add(e),!1);for(var t=0;t<this._inner.length;t++){if(this._inner[t]===e)return!0}return this._inner.push(e),!1},e.prototype.unmemoize=function(e){if(this._hasWeakSet)this._inner.delete(e);else for(var t=0;t<this._inner.length;t++)if(this._inner[t]===e){this._inner.splice(t,1);break}},e}()},function(e,t,a){"use strict";
/* @preserve The source code to this website is under the MIT license and can be found at https://github.com/magcius/noclip.website */var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=a(73),i=r(a(15)),o=n(a(205)),l=n(a(213)),c=n(a(214)),h=n(a(215)),d=n(a(141)),u=n(a(218)),m=n(a(219)),p=n(a(227)),f=n(a(228)),A=n(a(231)),g=n(a(167)),_=n(a(234)),S=n(a(235)),b=n(a(237)),v=n(a(168)),w=n(a(255)),x=n(a(256)),T=n(a(115)),y=n(a(259)),C=n(a(260)),M=n(a(261)),U=n(a(262)),k=n(a(267)),D=n(a(271)),I=n(a(275)),R=n(a(284)),B=n(a(287)),P=n(a(294)),E=n(a(295)),F=n(a(296)),V=n(a(297)),O=n(a(119)),N=n(a(298)),L=n(a(299)),G=n(a(300)),H=n(a(301)),j=n(a(302)),W=n(a(303)),Z=n(a(304)),z=n(a(308)),K=n(a(310)),X=n(a(149)),Y=n(a(320)),$=n(a(324)),q=n(a(330)),Q=n(a(335)),J=n(a(339)),ee=n(a(342)),te=n(a(346)),ae=n(a(347)),re=a(125),ne=a(11),se=a(8),ie=a(0),oe=a(99),le=a(183),ce=a(198),he=a(1),de=a(74),ue=a(9),me=n(a(355)),pe=a(42),fe=a(349),Ae=a(37),ge=a(182),_e=a(154),Se=a(350),be=["Wii",O.sceneGroup,E.sceneGroup,F.sceneGroup,W.sceneGroup,N.sceneGroup,m.sceneGroup,p.sceneGroup,y.sceneGroup,G.sceneGroup,j.sceneGroup,"GameCube",x.sceneGroup,c.sceneGroup,v.sceneGroupMP1,v.sceneGroupMP2,T.sceneGroup,u.sceneGroup,d.sceneGroup,l.sceneGroup,h.sceneGroup,"Nintendo 3DS",_.sceneGroup,g.sceneGroup,"Nintendo DS",C.sceneGroup,M.sceneGroup,f.sceneGroup,"Nintendo 64",o.sceneGroup,B.sceneGroup,z.sceneGroup,J.sceneGroup,"PlayStation 2",$.sceneGroup.iii,R.sceneGroup,U.sceneGroup,k.sceneGroup,"Xbox",q.sceneGroup,"Experimental",I.sceneGroup,b.sceneGroup,w.sceneGroup,P.sceneGroup,K.sceneGroup,$.sceneGroup.vc,$.sceneGroup.sa,S.sceneGroup,V.sceneGroup,v.sceneGroupMP3,ee.sceneGroup,te.sceneGroup,D.sceneGroup,L.sceneGroup,X.sceneGroup,Y.sceneGroup,Q.sceneGroup,ae.sceneGroup,A.sceneGroup,H.sceneGroup,Z.sceneGroup];function ve(e){return new Response(e).arrayBuffer()}function we(e){return new Promise(t=>e.toBlob(e=>t(ie.assertExists(e)),"image/png"))}class xe{constructor(){this.time=0,this.webXRContext=null,this.useRequestPostAnimationFrame=!0,this._timeoutCallback=()=>{this.onupdate(this)},this.requestPostAnimationFrame=()=>{this.time=window.performance.now(),this.useRequestPostAnimationFrame?setTimeout(this._timeoutCallback,0):this.onupdate(this)}}}window.main=new class{constructor(){this.saveManager=de.GlobalSaveManager,this.paused=!1,this.currentSceneGroup=null,this.currentSceneDesc=null,this.loadingSceneDesc=null,this.destroyablePool=[],this.dataShare=new _e.DataShare,this.lastUpdatedURLTimeSeconds=-1,this.postAnimFrameCanvas=new xe,this.postAnimFrameWebXR=new xe,this.sceneTimeScale=1,this._onPostAnimFrameUpdate=e=>{this.checkKeyShortcuts(),Ae.prepareFrameDebugOverlayCanvas2D();const t=this.viewer.inputManager.isKeyDownEventTriggered("Numpad7");this.viewer.sceneTimeScale=this.ui.isPlaying?this.sceneTimeScale:0,this.viewer.update(e),t&&this._takeScreenshot(),this.ui.update()},this._onRequestAnimationFrameCanvas=()=>{null!==this.webXRContext.xrSession||this.postAnimFrameCanvas.requestPostAnimationFrame(),window.requestAnimationFrame(this._onRequestAnimationFrameCanvas)},this._saveStateTmp=new Uint8Array(512),this._saveStateView=new DataView(this._saveStateTmp.buffer),this.init()}async init(){this.toplevel=document.createElement("div"),document.body.appendChild(this.toplevel),this.canvas=document.createElement("canvas");const e=await s.initializeViewer(this,this.canvas);if(0===e){if(this.webXRContext=new Se.WebXRContext(this.viewer.gfxSwapChain),this.webXRContext.onframe=this.postAnimFrameWebXR.requestPostAnimationFrame,this.postAnimFrameCanvas.onupdate=this._onPostAnimFrameUpdate,this.postAnimFrameWebXR.webXRContext=this.webXRContext,this.postAnimFrameWebXR.useRequestPostAnimationFrame=!1,this.postAnimFrameWebXR.onupdate=this._onPostAnimFrameUpdate,this.toplevel.ondragover=e=>{e.dataTransfer&&e.dataTransfer.types.includes("Files")&&(this.ui.dragHighlight.style.display="block",e.preventDefault())},this.toplevel.ondragleave=e=>{this.ui.dragHighlight.style.display="none",e.preventDefault()},this.toplevel.ondrop=this._onDrop.bind(this),this.toplevel.appendChild(this.canvas),window.onresize=this._onResize.bind(this),this._onResize(),this.viewer.onstatistics=e=>{this.ui.statisticsPanel.addRenderStatistics(e)},this.viewer.oncamerachanged=()=>{this._saveState()},this.viewer.inputManager.onisdraggingchanged=()=>{this.ui.setIsDragging(this.viewer.inputManager.isDragging())},this._makeUI(),this.dataFetcher=new oe.DataFetcher(this.ui.sceneSelect),await this.dataFetcher.init(),this.groups=be,this.droppedFileGroup={id:"drops",name:"Dropped Files",sceneDescs:[]},this.groups.push("Other"),this.groups.push(this.droppedFileGroup),this._loadSceneGroups(),window.onhashchange=this._onHashChange.bind(this),null===this.currentSceneDesc&&this._onHashChange(),null===this.currentSceneDesc){const e=this.saveManager.getCurrentSceneDescId();if(null!==e){const t=this.saveManager.getSaveStateSlotKey(e,0),a=this.saveManager.loadState(t);this._loadSceneDescById(e,a)}}null===this.currentSceneDesc&&this.ui.sceneSelect.setExpanded(!0),this._onRequestAnimationFrameCanvas(),pe.IS_DEVELOPMENT||(me.init({dsn:"https://a3b5f6c50bc04555835f9a83d6e76b23@sentry.io/1448331",beforeSend:e=>{if(e.exception.values.length){if("AbortedError"===e.exception.values[0].type)return null}return e}}),me.configureScope(e=>{e.setExtra("git-revision",pe.GIT_REVISION)}))}else this.toplevel.appendChild(s.makeErrorUI(e))}_onHashChange(){const e=window.location.hash;e.startsWith("#")&&this._loadState(decodeURIComponent(e.slice(1)))}_exportSaveData(){const e=this.saveManager.export(),t=new Date;ge.downloadBlob(`noclip_export_${t.toISOString()}.nclsp`,new Blob([e]))}pickSaveStatesAction(e){return e.isKeyDown("ShiftLeft")?2:e.isKeyDown("AltLeft")?3:0}checkKeyShortcuts(){const e=this.viewer.inputManager;e.isKeyDownEventTriggered("KeyZ")&&this._toggleUI(),e.isKeyDownEventTriggered("Numpad9")&&this._downloadTextures(),e.isKeyDownEventTriggered("KeyT")&&this.ui.sceneSelect.expandAndFocus();for(let t=1;t<=9;t++)if(e.isKeyDownEventTriggered("Digit"+t)&&this.currentSceneDesc){const a=this._getSaveStateSlotKey(t),r=this.pickSaveStatesAction(e);this.doSaveStatesAction(r,a)}e.isKeyDownEventTriggered("Numpad3")&&this._exportSaveData(),e.isKeyDownEventTriggered("Period")&&this.ui.togglePlayPause()}async _onWebXRStateRequested(e){if(this.webXRContext)if(e)try{if(await this.webXRContext.start(),!this.webXRContext.xrSession)return;he.mat4.getTranslation(this.viewer.xrCameraController.offset,this.viewer.camera.worldMatrix),this.webXRContext.xrSession.addEventListener("end",()=>{this.ui.toggleWebXRCheckbox(!1)})}catch(e){console.error("Failed to start XR"),this.ui.toggleWebXRCheckbox(!1)}else this.webXRContext.end()}setPaused(e){this.paused=e}async _onDrop(e){if(this.ui.dragHighlight.style.display="none",!e.dataTransfer||0===e.dataTransfer.files.length)return;e.preventDefault();const t=e.dataTransfer,a=await re.traverseFileSystemDataTransfer(t),r=new re.DroppedFileSceneDesc(a);this.droppedFileGroup.sceneDescs.push(r),this._loadSceneGroups(),this._loadSceneDesc(this.droppedFileGroup,r)}_onResize(){s.resizeCanvas(this.canvas,window.innerWidth,window.innerHeight,window.devicePixelRatio)}_getSceneSaveState(){let e=0;return this._saveStateView.setUint8(e,0),e++,e+=se.serializeCamera(this._saveStateView,e,this.viewer.camera),null!==this.viewer.scene&&this.viewer.scene.serializeSaveState&&(e=this.viewer.scene.serializeSaveState(this._saveStateTmp.buffer,e)),`ShareData=${ce.btoa(this._saveStateTmp,e)}`}_loadSceneSaveStateVersion2(e){const t=ce.atob(this._saveStateTmp,0,e);let a=0;return this.viewer.sceneTime=this._saveStateView.getFloat32(a+0,!0),a+=4,a+=se.deserializeCamera(this.viewer.camera,this._saveStateView,a),null!==this.viewer.scene&&this.viewer.scene.deserializeSaveState&&(a=this.viewer.scene.deserializeSaveState(this._saveStateTmp.buffer,a,t)),null!==this.viewer.cameraController&&this.viewer.cameraController.cameraUpdateForced(),!0}_loadSceneSaveStateVersion3(e){const t=ce.atob(this._saveStateTmp,0,e);let a=0;const r=this._saveStateView.getUint8(a+0);return ie.assert(0===r),a++,a+=se.deserializeCamera(this.viewer.camera,this._saveStateView,a),null!==this.viewer.scene&&this.viewer.scene.deserializeSaveState&&(a=this.viewer.scene.deserializeSaveState(this._saveStateTmp.buffer,a,t)),null!==this.viewer.cameraController&&this.viewer.cameraController.cameraUpdateForced(),!0}_tryLoadSceneSaveState(e){return e.startsWith("ZNCA8")&&e.endsWith("=")?this._loadSceneSaveStateVersion2(e.slice(5,-1)):e.startsWith("A")?this._loadSceneSaveStateVersion3(e.slice(1)):!!e.startsWith("ShareData=")&&this._loadSceneSaveStateVersion3(e.slice(10))}_loadSceneSaveState(e){return""!==e&&null!==e&&(!!this._tryLoadSceneSaveState(e)&&(this._saveStateAndUpdateURL(),!0))}_loadSceneDescById(e,t){const[a,...r]=e.split("/");let n=decodeURIComponent(r.join("/"));const s=this.groups.find(e=>"string"!=typeof e&&e.id===a);if(!s)return;void 0!==s.sceneIdMap&&s.sceneIdMap.has(n)&&(n=s.sceneIdMap.get(n));const i=fe.getSceneDescs(s).find(e=>e.id===n);i&&this._loadSceneDesc(s,i,t)}_loadState(e){let t="",a="";const r=e.indexOf(";");return r>=0?(t=e.slice(0,r),a=e.slice(r+1)):t=e,this._loadSceneDescById(t,a)}_getCurrentSceneDescId(){if(null===this.currentSceneGroup||null===this.currentSceneDesc)return null;return`${this.currentSceneGroup.id}/${this.currentSceneDesc.id}`}_saveState(e=!1){if(null===this.currentSceneGroup||null===this.currentSceneDesc)return;const t=this._getSceneSaveState(),a=this._getCurrentSceneDescId(),r=this.saveManager.getSaveStateSlotKey(a,0);this.saveManager.saveTemporaryState(r,t);const n=`${a};${t}`;this.ui.setSaveState(n);let s=e;if(!s){window.performance.now()/1e3-this.lastUpdatedURLTimeSeconds>=2&&(s=!0)}if(s){window.history.replaceState("",document.title,`#${n}`);const e=window.performance.now()/1e3;this.lastUpdatedURLTimeSeconds=e}}_saveStateAndUpdateURL(){this._saveState(!0)}_getSaveStateSlotKey(e){return this.saveManager.getSaveStateSlotKey(ie.assertExists(this._getCurrentSceneDescId()),e)}_onSceneChanged(e,t){e.onstatechanged=()=>{this._saveStateAndUpdateURL()};let a=[];e.createPanels&&(a=e.createPanels()),this.ui.setScenePanels(a),this.ui.togglePlayPause(!0);const r=ie.fallbackUndefined(e.isInteractive,!0);this.viewer.inputManager.isInteractive=r,this._toggleUI(r);const n=this._getCurrentSceneDescId();if(this.saveManager.setCurrentSceneDescId(n),void 0!==e.createCameraController&&this.viewer.setCameraController(e.createCameraController()),null===this.viewer.cameraController&&this.viewer.setCameraController(new se.FPSCameraController),!this._loadSceneSaveState(t)){const e=this.viewer.camera,t=this.saveManager.getSaveStateSlotKey(n,1);this._loadSceneSaveState(this.saveManager.loadState(t))||he.mat4.identity(e.worldMatrix),he.mat4.getTranslation(this.viewer.xrCameraController.offset,e.worldMatrix)}this.ui.sceneChanged()}_onSceneDescSelected(e,t){this._loadSceneDesc(e,t)}doSaveStatesAction(e,t){if(2===e)this.saveManager.saveState(t,this._getSceneSaveState());else if(3===e)this.saveManager.deleteState(t);else if(0===e){const e=this.saveManager.loadState(t);this._loadSceneSaveState(e)}else if(1===e){const e=this.saveManager.loadStateFromLocation(t,2);this._loadSceneSaveState(e)}}_loadSceneDesc(e,t,a=null){if(this.currentSceneDesc===t)return void this._loadSceneSaveState(a);const r=this.viewer.gfxDevice;null!==this.dataFetcher&&this.dataFetcher.abort(),this.ui.destroyScene(),this.viewer.scene&&!this.destroyablePool.includes(this.viewer.scene)&&this.destroyablePool.push(this.viewer.scene),this.viewer.setScene(null);for(let e=0;e<this.destroyablePool.length;e++)this.destroyablePool[e].destroy(r);this.destroyablePool.length=0,e.hidden&&(e.hidden=!1),this.currentSceneGroup=e,this.currentSceneDesc=t,this.ui.sceneSelect.setCurrentDesc(this.currentSceneGroup,this.currentSceneDesc),this.ui.sceneSelect.setProgress(0);const n=this.dataShare,s=this.dataFetcher;s.reset();const i=document.createElement("div");this.ui.sceneUIContainer.appendChild(i);const o=this.destroyablePool,l={device:r,dataFetcher:s,dataShare:n,uiContainer:i,destroyablePool:o};this.dataShare.pruneOldObjects(r,1),this.dataShare.loadNewScene(),this.loadingSceneDesc=t;const c=t.createScene(r,l);if(null===c)throw console.error(`Cannot load ${t.id}. Probably an unsupported file extension.`),"whoops";c.then(e=>{this.loadingSceneDesc===t&&(s.setProgress(),this.loadingSceneDesc=null,this.viewer.setScene(e),this._onSceneChanged(e,a))}),document.title=`${t.name} - ${e.name} - noclip`;const h=this._getCurrentSceneDescId();"undefined"!=typeof gtag&&gtag("event","loadScene",{event_category:"Scenes",event_label:h}),me.addBreadcrumb({category:"loadScene",message:h}),me.configureScope(e=>{e.setExtra("sceneDescId",h)})}_loadSceneGroups(){this.ui.sceneSelect.setSceneGroups(this.groups)}_makeUI(){this.ui=new ne.UI(this.viewer),this.toplevel.appendChild(this.ui.elem),this.ui.sceneSelect.onscenedescselected=this._onSceneDescSelected.bind(this),this.ui.xrSettings.onWebXRStateRequested=this._onWebXRStateRequested.bind(this),this.webXRContext.onsupportedchanged=()=>{this._syncWebXRSettingsVisible()},this._syncWebXRSettingsVisible()}_syncWebXRSettingsVisible(){this.ui.xrSettings.setVisible(this.webXRContext.isSupported)}_toggleUI(e){this.ui.toggleUI(e)}_getSceneDownloadPrefix(){return`${this.currentSceneGroup.id}_${this.currentSceneDesc.id}_${(new Date).toISOString()}`}_takeScreenshot(e=!0){const t=this.viewer.takeScreenshotToCanvas(e),a=`${this._getSceneDownloadPrefix()}.png`;we(t).then(e=>ge.downloadBlob(a,e))}async _makeTextureZipFile(){const e=await this.ui.textureViewer.getViewerTextureList(),t=[],a=[];for(let r=0;r<e.length;r++){const n=e[r];for(let e=0;e<n.surfaces.length;e++){const r=`${n.name}_${e}.png`;a.push(we(n.surfaces[e]).then(e=>ve(e)).then(e=>{t.push({filename:r,data:e})}))}}return await Promise.all(a),t}_downloadTextures(){this._makeTextureZipFile().then(e=>{if(0===e.length)return;const t=le.makeZipFile(e),a=`${this._getSceneDownloadPrefix()}_Textures.zip`;ge.downloadBuffer(a,t,"application/zip")})}getStandardClearColor(){return ue.standardFullClearRenderPassDescriptor.colorClearColor}get scene(){return this.viewer.scene}},window.hexdump=ie.hexdump,window.magicstr=ie.magicstr,window.downloadBuffer=(e,t)=>{t instanceof i.default?ge.downloadBufferSlice(e,t):e.name&&e.buffer?window.downloadBuffer(e.name,e.buffer):t instanceof ArrayBuffer&&ge.downloadBuffer(e,t)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(11)),s=r(a(155)),i=r(a(206)),o=r(a(64)),l=r(a(156)),c=a(10),h=a(77),d=a(1),u=a(9),m=a(23),p=a(7),f=a(51),A=a(0),g=a(137);class _{constructor(e,t,a){this.textureHolder=t,this.objectData=a,this.geoRenderers=[],this.flipbookRenderers=[],this.geoDatas=[],this.rails=[],this.renderTarget=new u.BasicRenderTarget,this.renderHelper=new m.GfxRenderHelper(e),this.sceneEmitters=new g.SceneEmitterHolder(e,a)}adjustCameraController(e){e.setSceneMoveSpeedMult(.5)}createPanels(){const e=new n.Panel;e.customHeaderBackgroundColor=n.COOL_BLUE_COLOR,e.setTitle(n.RENDER_HACKS_ICON,"Render Hacks");const t=new n.Checkbox("Enable Culling",!0);t.onchanged=()=>{for(let e=0;e<this.geoRenderers.length;e++)this.geoRenderers[e].setBackfaceCullingEnabled(t.checked);for(let e=0;e<this.flipbookRenderers.length;e++)this.flipbookRenderers[e].setBackfaceCullingEnabled(t.checked)},e.contents.appendChild(t.elem);const a=new n.Checkbox("Enable Vertex Colors",!0);a.onchanged=()=>{for(let e=0;e<this.geoRenderers.length;e++)this.geoRenderers[e].setVertexColorsEnabled(a.checked);for(let e=0;e<this.flipbookRenderers.length;e++)this.flipbookRenderers[e].setVertexColorsEnabled(a.checked);this.sceneEmitters.setVertexColorsEnabled(a.checked)},e.contents.appendChild(a.elem);const r=new n.Checkbox("Enable Textures",!0);r.onchanged=()=>{for(let e=0;e<this.geoRenderers.length;e++)this.geoRenderers[e].setTexturesEnabled(r.checked);for(let e=0;e<this.flipbookRenderers.length;e++)this.flipbookRenderers[e].setTexturesEnabled(r.checked);this.sceneEmitters.setTexturesEnabled(r.checked)},e.contents.appendChild(r.elem);const s=new n.Checkbox("Grayscale Vertex Colors",!1);s.onchanged=()=>{for(let e=0;e<this.geoRenderers.length;e++)this.geoRenderers[e].setMonochromeVertexColorsEnabled(s.checked);for(let e=0;e<this.flipbookRenderers.length;e++)this.flipbookRenderers[e].setMonochromeVertexColorsEnabled(s.checked);this.sceneEmitters.setMonochromeVertexColorsEnabled(s.checked)},e.contents.appendChild(s.elem);const i=new n.Checkbox("Visualize Vertex Alpha",!1);return i.onchanged=()=>{for(let e=0;e<this.geoRenderers.length;e++)this.geoRenderers[e].setAlphaVisualizerEnabled(i.checked);for(let e=0;e<this.flipbookRenderers.length;e++)this.flipbookRenderers[e].setAlphaVisualizerEnabled(i.checked);this.sceneEmitters.setAlphaVisualizerEnabled(i.checked)},e.contents.appendChild(i.elem),[e]}prepareToRender(e,t,a){this.renderHelper.pushTemplateRenderInst();for(let t=0;t<this.geoRenderers.length;t++)this.geoRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a);for(let t=0;t<this.flipbookRenderers.length;t++)this.flipbookRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.sceneEmitters.prepareToRender(e,this.renderHelper.renderInstManager,a),this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderHelper.renderInstManager,n=this.renderTarget.createRenderPass(e,t.viewport,u.transparentBlackFullClearRenderPassDescriptor);p.executeOnPass(r,e,n,2),e.submitPass(n);const s=this.renderTarget.createRenderPass(e,t.viewport,u.depthClearRenderPassDescriptor);return p.executeOnPass(r,e,s,1),r.resetRenderInsts(),s}destroy(e){this.renderTarget.destroy(e),this.renderHelper.destroy(e);for(let t=0;t<this.geoDatas.length;t++)this.geoDatas[t].destroy(e);this.textureHolder.destroy(e)}}function S(e,t){if(-1===t)return null;const a=e.Files.find(e=>e.FileID===t);return void 0===a?null:a}const b=new Map([[1,[[1,1],[2,0]]],[18,[[1,1],[2,0],[5,1]]],[20,[[5,1]]],[29,[[1,1]]],[14,[[1,1],[5,1]]],[71,[[1,2],[5,2]]],[72,[[1,3],[5,3]]],[48,[[1,4],[5,4]]],[74,[[1,5],[5,5]]],[75,[[1,6],[5,6]]],[76,[[1,7],[5,7]]],[77,[[1,8],[5,8]]],[94,[[1,1],[2,0]]],[95,[[1,1],[2,0]]],[96,[[1,1],[2,0]]],[97,[[1,0],[2,1]]],[123,[[4,0],[5,0],[6,0]]],[124,[[5,2]]],[129,[[4,0],[5,0],[6,0]]],[130,[[4,1],[5,1],[6,1]]],[131,[[4,1],[5,1],[6,1]]],[132,[[4,1],[5,1],[6,1]]],[136,[[1,1],[2,0]]],[137,[[5,1]]],[138,[[5,1]]],[140,[[5,1]]],[145,[[5,1]]],[147,[[4,1],[5,1],[6,1]]]]);function v(e){const t=e.createDataView(),a=t.getUint16(0),r=t.getUint16(2),n=t.getUint16(4);A.assert(0===t.getUint16(6));let s=8;const i=[];for(let e=0;e<n;e++){const e=t.getUint16(s+0),a=e>>>4,r=15&e,n=t.getUint16(s+2);s+=4;const o=[];for(let e=0;e<n;e++){const e=t.getUint16(s+0),a=e>>>14,r=e>>>0&16383,n=t.getInt16(s+2)/64;o.push({unk:a,time:r,value:n}),s+=4}i.push({boneID:a,trackType:r,frames:o})}return{startFrame:a,endFrame:r,tracks:i}}class w{constructor(e){this.objectSetupData=e,this.geoData=[],this.gfxCache=new f.GfxRenderCache}ensureGeoData(e,t){if(void 0===this.geoData[t]){if(50===t||51===t||52===t)return null;const a=S(this.objectSetupData,t);if(null===a)return console.log("missing file",t.toString(16)),null;const r=a.Data;if(11!==r.createDataView().getUint32(0))return this.ensureFlipbookData(e,t);{const a=s.parse(r,1,!1);this.geoData[t]=new h.GeometryData(e,this.gfxCache,a)}}return this.geoData[t]}ensureFlipbookData(e,t){if(void 0===this.geoData[t]){const a=S(this.objectSetupData,t);if(null===a)return console.log("missing file",t.toString(16)),null;const r=i.parse(a.Data);this.geoData[t]=new h.FlipbookData(e,this.gfxCache,r)}const a=this.geoData[t];if(a instanceof h.GeometryData)throw`not a flipbook ${t}`;return a}spawnFlipbookByFileID(e,t,a,r,n=0,s=!1,i=1){const o=this.ensureFlipbookData(e,a);if(null===o)return console.warn(`Unsupported geo data for file ID ${A.hexzero(a,4)}`),null;const l=new h.FlipbookRenderer(o,n,s);return l.sortKeyBase=p.makeSortKey(129),d.mat4.fromTranslation(l.modelMatrix,r),d.mat4.scale(l.modelMatrix,l.modelMatrix,[i,i,i]),l}spawnObjectByFileID(e,t,a,r,n=0,s=0,i=1){return this.baseSpawnObject(e,t,-1,a,r,n,s,i)}baseSpawnObject(e,t,a,r,n,s=0,i=0,o=1){const c=this.ensureGeoData(e,r);if(null===c)return console.warn(`Unsupported geo data for file ID ${A.hexzero(r,4)}`),null;const u=c instanceof h.FlipbookData?new h.FlipbookRenderer(c):l.createRenderer(e,t,a,c);return u.sortKeyBase=p.makeSortKey(129),d.mat4.fromTranslation(u.modelMatrix,n),d.mat4.rotateY(u.modelMatrix,u.modelMatrix,.01745*s),d.mat4.rotateZ(u.modelMatrix,u.modelMatrix,.01745*i),d.mat4.scale(u.modelMatrix,u.modelMatrix,[o,o,o]),u}spawnDependentObjects(e,t,a,r,n=0){const s=w.pairedIDs.get(a),i=[],o=d.vec3.clone(r);switch(a){case 17:for(let a=0;a<3;a++)i.push(...this.spawnObject(e,t,s,o,n)),d.vec3.add(o,o,[0,250,0]);return i;case 892:if(1===n)return[];const a=new g.ConfigurableEmitter(g.quicksandConfig);return d.mat4.fromTranslation(a.modelMatrix,r),t.flipbookManager.emitters.push(a),[];case 899:const l=new g.ScaledEmitter(.5,g.torchSmokeConfig);d.mat4.fromTranslation(l.modelMatrix,r);const c=new g.ScaledEmitter(.5,g.torchSparkleConfig);return d.mat4.fromTranslation(c.modelMatrix,r),t.flipbookManager.emitters.push(l,c),[];case 887:const h=new g.LavaRockEmitter(r,t.lavaRockManager.emitters);t.lavaRockManager.emitters.push(h)}return void 0===s?[]:this.spawnObject(e,t,s,r,n)}getObjectAnimations(e){switch(e.SpawnID){case 230:return[2,4];case 291:return[1,2,3,4];case 292:return[1,2]}return[e.AnimationStartIndex]}spawnObject(e,t,a,r,n=0,s=0){const i=this.objectSetupData.ObjectSetupTable.find(e=>e.SpawnID===a);if(void 0===i)return console.warn(`Unknown object ID ${A.hexzero(a,4)}`),[];const o=[],l=0!==i.GeoFileID?this.baseSpawnObject(e,t,a,i.GeoFileID,r,n):null;if(null!==l){if(l.spawnEntry=i,l.sortKeyBase=p.makeSortKey(128+h.layerFromFlags(i.Flags)),i.AnimationTable.length>0)if(l instanceof h.GeometryRenderer){const e=this.getObjectAnimations(i);for(let t=0;t<e.length;t++){const a=i.AnimationTable[e[t]];if(void 0===a)continue;const r=S(this.objectSetupData,a.FileID);if(null===r)continue;const n=v(r.Data);l.boneAnimators.push(new h.BoneAnimator(n,a.Duration))}}else console.warn(`animation data for flipbook object ${A.hexzero(a,4)}`);if(o.push(l),l instanceof h.GeometryRenderer){l.objectFlags=i.Flags;const n=a=>this.spawnObject(e,t,a,r);l.additionalSetup(n,a,s)}}return o.push(...this.spawnDependentObjects(e,t,a,r,n)),o}spawnDebugSphere(e,t){return this.baseSpawnObject(e,null,648,1026,t)}destroy(e){for(let t=0;t<this.geoData.length;t++){const a=this.geoData[t];null!=a&&a.renderData.destroy(e)}this.gfxCache.destroy(e)}}function x(e,t,a=500){let r=null,n=a;const s=d.vec3.create();for(let a=0;a<e.length;a++){d.mat4.getTranslation(s,e[a].modelMatrix);const i=d.vec3.dist(s,t);i<n&&(r=e[a],n=i)}return r}w.pairedIDs=new Map([[17,89],[299,300],[890,300],[738,735]]);class T{constructor(e,t){this.id=e,this.name=t}addGeo(e,t,a,r,n){for(let e=0;e<n.sharedOutput.textureCache.textures.length;e++)a.push(h.textureToCanvas(n.sharedOutput.textureCache.textures[e]));const s=new h.GeometryData(e,t,n);r.geoDatas.push(s.renderData);const i=new h.GeometryRenderer(e,s);return r.geoRenderers.push(i),i}addObjects(e,t,a,r){const n=t.createDataView();A.assert(257===n.getInt16(0));let s=2;const i=[],o=[],c=[],u=[];for(let e=0;e<6;e++)u.push(n.getInt32(s)),s+=4;const m=(u[3]+1-u[0])*(u[4]+1-u[1])*(u[5]+1-u[2]);for(let t=0;t<m;t++){let t=n.getInt8(s++);for(;1!==t;){if(3===t){A.assert(10===n.getInt8(s++));const t=n.getUint8(s++);t>0&&A.assert(11===n.getInt8(s++));for(let u=0;u<t;u++){const t=d.vec3.fromValues(n.getInt16(s+0),n.getInt16(s+2),n.getInt16(s+4)),u=n.getUint16(s+6)>>>7&511,m=n.getUint8(s+7)>>>1&63,p=n.getUint16(s+8),f=n.getUint16(s+12)>>>7;let A=!1;const g=n.getUint16(s+16)>>>4;if(g>0){A=!!(1&n.getUint16(s+6));const e=4095&n.getUint16(s+17),a=A?l.buildKeyframeData(n,s):t;i[g]={next:e,data:a}}if(s+=20,!A&&6===m)if(19===p)o.push({pos:t,movementType:l.SinkingBobber});else if(47===p||48===p)c.push(t);else if(55===p)o.push({pos:t,movementType:l.WaterBobber});else{if(56===p)continue;if(p>=249&&p<=256)continue;{const n=a.spawnObject(e,r.sceneEmitters,p,t,f,u);for(let e of n)e instanceof h.GeometryRenderer?r.geoRenderers.push(e):e instanceof h.FlipbookRenderer&&r.flipbookRenderers.push(e)}}}A.assert(8===n.getInt8(s++));const u=n.getUint8(s++);if(u>0){A.assert(9===n.getInt8(s++));for(let t=0;t<u;t++){const t=n.getUint16(s+0)>>>4,i=d.vec3.fromValues(n.getInt16(s+4),n.getInt16(s+6),n.getInt16(s+8)),o=3&n.getUint8(s+11);if(0===o){const o=n.getUint32(s+0),l=1-16*(o>>>16&7)/255,c=1-16*(o>>>13&7)/255,h=1-16*(o>>>10&7)/255,u=(o>>>2&255)/100,m=o>>>1&1,p=(n.getUint8(s+10),n.getUint16(s+10)>>>6&31),f=a.spawnFlipbookByFileID(e,r.sceneEmitters,t+1394,i,p,!!m,u);f&&(f.primColor=d.vec4.fromValues(l,c,h,1),r.flipbookRenderers.push(f))}else if(2===o){const o=2*n.getUint8(s+2),l=2*n.getUint8(s+3),c=n.getUint8(s+10)/100,d=a.spawnObjectByFileID(e,r.sceneEmitters,t+721,i,o,l,c);if(null!==d){if(!(d instanceof h.GeometryRenderer))throw"flipbook for normal setup object";r.geoRenderers.push(d)}}s+=12}}}else s+=12;t=n.getInt8(s++)}}for(let e of o){const t=x(r.geoRenderers,e.pos);null!==t?t.movementController=new e.movementType(t):console.warn("unpaired movement indicator",e.pos)}r.rails=l.buildRails(i);for(let e of r.geoRenderers)e instanceof l.RailRider&&e.setRail(r.rails);2===c.length&&g.emitAlongLine(r.sceneEmitters.flipbookManager,new g.WaterfallEmitter,c[0],c[1],10)}async createScene(e,t){const a=await t.dataShare.ensureObject("BanjoKazooie/ObjectData",async()=>await async function(e,t){const a=await e.fetchData("BanjoKazooie/objectSetup_arc.crg1?cache_bust=10"),r=o.parse(a,1);return new w(r)}(t.dataFetcher));return t.dataFetcher.fetchData(`BanjoKazooie/${this.id}_arc.crg1?cache_bust=2`).then(t=>{const r=o.parse(t,1),n=[],i=new c.FakeTextureHolder(n),h=new _(e,i,a),u=h.renderHelper.getCache(),m=S(r,r.OpaGeoFileId);if(null!==m){const t=s.parse(m.Data,1,!0),a=this.addGeo(e,u,n,h,t);a.sortKeyBase=p.makeSortKey(0),function(e,t){const a=b.get(t);if(void 0!==a)for(let t=0;t<a.length;t++)e.selectorState.values[a[t][0]]=a[t][1]}(a,r.SceneID)}const f=S(r,r.XluGeoFileId);if(null!==f){const t=s.parse(f.Data,2,!1);this.addGeo(e,u,n,h,t).sortKeyBase=p.makeSortKey(130)}const g=S(r,r.OpaSkyboxFileId);if(null!==g){const t=s.parse(g.Data,1,!0),a=this.addGeo(e,u,n,h,t);a.isSkybox=!0,d.mat4.scale(a.modelMatrix,a.modelMatrix,[r.OpaSkyboxScale,r.OpaSkyboxScale,r.OpaSkyboxScale])}const v=S(r,r.XluSkyboxFileId);if(null!==v){const t=s.parse(v.Data,2,!1),a=this.addGeo(e,u,n,h,t);a.isSkybox=!0,d.mat4.scale(a.modelMatrix,a.modelMatrix,[r.XluSkyboxScale,r.XluSkyboxScale,r.XluSkyboxScale])}const w=A.assertExists(S(r,r.SetupFileId));if(this.addObjects(e,w.Data,a,h),11==r.SceneID){const t=a.spawnObject(e,h.sceneEmitters,l.clankerID,d.vec3.fromValues(5500,1100,0))[0];t.animationController.init(15);for(let e of h.geoRenderers)e instanceof l.ClankerBolt?e.clankerVector=A.assertExists(t.modelPointArray[5]):e instanceof l.ClankerTooth&&(e.movementController=new l.ModelPin(t.modelPointArray,e.index));h.geoRenderers.push(t)}return h})}}const y=["Spiral Mountain",new T("01","Spiral Mountain"),new T("8C","Banjo's House"),"Grunty's Lair",new T("69","Floor 1 / Entrance to Mumbo's Mountain"),new T("6A","Floor 2"),new T("6C","Dingpot Teleport Room"),new T("6B","Floor 3"),new T("6D","Entrance to Treasure Trove Cove"),new T("70","Entrance to Clanker's Cavern"),new T("71","Floor 4"),new T("72","Entrance to Bubblegloomp Swamp"),new T("6E","Floor 5 / Entrance to Gobi's Valley"),new T("6F","Floor 6 / Entrance to Freezeezy Peak"),new T("75","Entrance to Mad Monster Mansion"),new T("74","Gobi's Valley Puzzle Room"),new T("79","Floor 7 / Entrance to Click Clock Wood"),new T("76","Water Switch Area"),new T("78","Mad Monster Mansion & Rusty Bucket Bay Puzzle Room"),new T("77","Entrance to Rusty Bucket Bay"),new T("93","Floor 8"),new T("7A","Coffin Room"),new T("80","Entrance to Grunty's Furnace Fun"),new T("8E","Grunty's Furnace Fun"),new T("90","Boss"),"Mumbo's Mountain",new T("02","Mumbo's Mountain"),new T("0C","Ticker's Tower"),new T("0E","Mumbo's Skull"),"Treasure Trove Cove",new T("07","Treasure Trove Cove"),new T("05","Blubber's Ship"),new T("06","Nipper's Shell"),new T("0A","Sandcastle"),new T("8F","Sharkfood Island"),"Clanker's Cavern",new T("0B","Clanker's Cavern"),new T("22","Inside Clanker"),new T("21","Inside Clanker - Witch Switch"),new T("23","Inside Clanker - Gold Feathers"),"Bubblegloop Swamp",new T("0D","Bubblegloop Swamp"),new T("10","Mr. Vile"),new T("11","Tip-Tup Choir"),new T("47","Mumbo's Skull"),"Freezeezy Peak",new T("27","Freezeezy Peak"),new T("41","Boggy's Igloo"),new T("48","Mumbo's Skull"),new T("53","Christmas Tree"),new T("7F","Wozza's Cave"),"Gobi's Valley",new T("12","Gobi's Valley"),new T("13","Puzzle Room"),new T("14","King Sandybutt's Tomb"),new T("15","Water Room"),new T("16","Rupee"),new T("1A","Jinxy"),new T("92","Secret Blue Egg"),"Mad Monster Mansion",new T("1B","Mad Monster Mansion"),new T("8D","Septic Tank"),new T("1C","Church"),new T("1D","Cellar"),new T("24","Tumblar's Shed"),new T("25","Well"),new T("26","Dining Room"),new T("28","Egg Room"),new T("29","Note Room"),new T("2A","Feather Room"),new T("2B","Secret Church Room"),new T("2C","Bathroom"),new T("2D","Bedroom"),new T("2E","Gold Feather Room"),new T("2F","Drainpipe"),new T("30","Mumbo's Hut"),"Rusty Bucket Bay",new T("31","Rusty Bucket Bay"),new T("8B","Anchor Room"),new T("34","Machine Room"),new T("35","Big Fish Warehouse"),new T("36","Boat Room"),new T("37","First Blue Container"),new T("38","Third Blue Container"),new T("39","Sea-Grublin's Cabin"),new T("3A","Kaboom's Room"),new T("3B","Mini Kaboom's Room"),new T("3C","Kitchen"),new T("3D","Navigation Room"),new T("3E","Second Blue Container"),new T("3F","Captain's Room"),"Click Clock Wood",new T("40","Click Clock Wood"),new T("43","Spring"),new T("44","Summer"),new T("45","Fall"),new T("46","Winter"),new T("4A","Mumbo - Spring"),new T("4B","Mumbo - Summer"),new T("4C","Mumbo - Fall"),new T("4D","Mumbo - Winter"),new T("5A","Beehive - Summer"),new T("5B","Beehive - Spring"),new T("5C","Beehive - Fall"),new T("5E","Nabnuts House - Spring"),new T("5F","Nabnuts House - Summer"),new T("60","Nabnuts House - Fall"),new T("61","Nabnuts House - Winter"),new T("62","Nabnut's Attic - Winter"),new T("63","Nabnut's Attic - Fall"),new T("64","Nabnut's Attic 2 - Winter"),new T("65","Whipcrack Room - Spring"),new T("66","Whipcrack Room - Summer"),new T("67","Whipcrack Room - Fall"),new T("68","Whipcrack Room - Winter")];t.sceneGroup={id:"bk",name:"Banjo-Kazooie",sceneDescs:y}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(48),n=a(58),s=a(0),i=a(76);t.parse=function(e){const t=e.createDataView(),a=t.getUint16(0),o=t.getUint16(2),l=t.getInt16(8),c=t.getInt16(10),h=t.getUint8(12)>>>4,d=h>0?30/h:0,u=t.getUint8(12)>>>1&7,m=function(e,t){const a=[];for(let t=0;t<e;t++)a.push(t);switch(t){case 0:case 3:break;case 4:for(let t=0;t<e;t++)a.push(t);break;case 1:case 2:for(let t=e-2;t>0;t--)a.push(t);break;default:throw`bad loop mode ${t}`}return a}(a,u),p=t.getUint16(12)>>>7&3,f=t.getUint16(12)>>>5&3,A=2816&o?0:2;s.assert(3!==p);const g=4*a+16,_=new n.RSPSharedOutput;let S=0,b=0;for(let e=0;e<a;e++){const a=t.getInt32(16+4*e)+g,n=t.getInt16(a+0),h=t.getInt16(a+2),d=t.getInt16(a+4),u=t.getInt16(a+6),m=t.getUint16(a+8);0===e&&(S=n*l/d,b=c-h*c/u);let p=a+20;const f=s.align(p,8);1&o?p=f+32:4&o&&(p=f+512);const A=new Uint8Array(d*u*4);for(let e=0;e<m;e++){const e=t.getInt16(p+0),a=t.getInt16(p+2),r=t.getInt16(p+4),n=t.getInt16(p+6);let l=0;const c=s.align(p+8,8),h=new Uint8Array(r*n*4);if(1024&o)l=2,i.decodeTex_RGBA16(h,t,c,r,n);else if(2048&o)l=4,i.decodeTex_RGBA32(h,t,c,r,n);else if(1&o){l=.5;const e=new Uint8Array(64);i.parseTLUT(e,t,f,0,2),i.decodeTex_CI4(h,t,c,r,n,e)}else if(4&o){l=1;const e=new Uint8Array(1024);i.parseTLUT(e,t,f,1,2)}else{if(!(64&o))throw`bad frame format ${o.toString(16)}`;l=1,i.decodeTex_I8(h,t,c,r,n)}for(let t=0;t<n;t++)A.set(h.subarray(4*t*r,4*(t*r+Math.min(r,d-e))),4*(d*(a+t)+e));p=c+r*n*l}_.textureCache.textures.push(new r.Texture(new r.TileState,a,f,d,u,A))}for(let e=0;e<4;e++){const t=new n.Vertex;t.c2=127,t.a=128,e%2&&(t.x=l,t.tx=1),e>=2?t.y=c:t.ty=1,t.x-=S,t.y-=b,_.vertices.push(t)}return _.indices.push(0,1,3),_.indices.push(0,3,2),{sharedOutput:_,width:l,height:c,frameRate:d,rawFrames:a,frameSequence:m,loopMode:u,reverseMode:p,mirrorMode:f,renderMode:A}}},function(e,t,a){"use strict";var r=a(208).Buffer,n=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=h,this.end=d,t=3;break;default:return this.write=u,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function i(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,a=function(e,t,a){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==a?a:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var a=e.toString("utf16le",t);if(a){var r=a.charCodeAt(a.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],a.slice(0,-1)}return a}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var a=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,a)}return t}function h(e,t){var a=(e.length-t)%3;return 0===a?e.toString("base64",t):(this.lastNeed=3-a,this.lastTotal=3,1===a?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-a))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function u(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}t.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,a;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";a=this.lastNeed,this.lastNeed=0}else a=0;return a<e.length?t?t+this.text(e,a):this.text(e,a):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var a=function(e,t,a){var r=t.length-1;if(r<a)return 0;var n=i(t[r]);if(n>=0)return n>0&&(e.lastNeed=n-1),n;if(--r<a||-2===n)return 0;if((n=i(t[r]))>=0)return n>0&&(e.lastNeed=n-2),n;if(--r<a||-2===n)return 0;if((n=i(t[r]))>=0)return n>0&&(2===n?n=0:e.lastNeed=n-3),n;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=a;var r=e.length-(a-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,a){var r=a(209),n=r.Buffer;function s(e,t){for(var a in e)t[a]=e[a]}function i(e,t,a){return n(e,t,a)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(s(r,t),t.Buffer=i),i.prototype=Object.create(n.prototype),s(n,i),i.from=function(e,t,a){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,a)},i.alloc=function(e,t,a){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=n(e);return void 0!==t?"string"==typeof a?r.fill(t,a):r.fill(t):r.fill(0),r},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,a){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=a(210),n=a(211),s=a(212);function i(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,a){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,a);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,a)}function c(e,t,a,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,a,r){if(t.byteLength,a<0||t.byteLength<a)throw new RangeError("'offset' is out of bounds");if(t.byteLength<a+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===a&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,a):new Uint8Array(t,a,r);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=u(e,t);return e}(e,t,a,r):"string"==typeof t?function(e,t,a){"string"==typeof a&&""!==a||(a="utf8");if(!l.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,a),n=(e=o(e,r)).write(t,a);n!==r&&(e=e.slice(0,n));return e}(e,t,a):function(e,t){if(l.isBuffer(t)){var a=0|m(t.length);return 0===(e=o(e,a)).length?e:(t.copy(e,0,0,a),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?o(e,0):u(e,t);if("Buffer"===t.type&&s(t.data))return u(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(h(t),e=o(e,t<0?0:0|m(t)),!l.TYPED_ARRAY_SUPPORT)for(var a=0;a<t;++a)e[a]=0;return e}function u(e,t){var a=t.length<0?0:0|m(t.length);e=o(e,a);for(var r=0;r<a;r+=1)e[r]=255&t[r];return e}function m(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var a=e.length;if(0===a)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":case void 0:return L(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return G(e).length;default:if(r)return L(e).length;t=(""+t).toLowerCase(),r=!0}}function f(e,t,a){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),a<=0)return"";if((a>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,a);case"utf8":case"utf-8":return C(this,t,a);case"ascii":return M(this,t,a);case"latin1":case"binary":return U(this,t,a);case"base64":return y(this,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,a);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function A(e,t,a){var r=e[t];e[t]=e[a],e[a]=r}function g(e,t,a,r,n){if(0===e.length)return-1;if("string"==typeof a?(r=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,isNaN(a)&&(a=n?0:e.length-1),a<0&&(a=e.length+a),a>=e.length){if(n)return-1;a=e.length-1}else if(a<0){if(!n)return-1;a=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:_(e,t,a,r,n);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,a):Uint8Array.prototype.lastIndexOf.call(e,t,a):_(e,[t],a,r,n);throw new TypeError("val must be string, number or Buffer")}function _(e,t,a,r,n){var s,i=1,o=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;i=2,o/=2,l/=2,a/=2}function c(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(n){var h=-1;for(s=a;s<o;s++)if(c(e,s)===c(t,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===l)return h*i}else-1!==h&&(s-=s-h),h=-1}else for(a+l>o&&(a=o-l),s=a;s>=0;s--){for(var d=!0,u=0;u<l;u++)if(c(e,s+u)!==c(t,u)){d=!1;break}if(d)return s}return-1}function S(e,t,a,r){a=Number(a)||0;var n=e.length-a;r?(r=Number(r))>n&&(r=n):r=n;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var i=0;i<r;++i){var o=parseInt(t.substr(2*i,2),16);if(isNaN(o))return i;e[a+i]=o}return i}function b(e,t,a,r){return H(L(t,e.length-a),e,a,r)}function v(e,t,a,r){return H(function(e){for(var t=[],a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}(t),e,a,r)}function w(e,t,a,r){return v(e,t,a,r)}function x(e,t,a,r){return H(G(t),e,a,r)}function T(e,t,a,r){return H(function(e,t){for(var a,r,n,s=[],i=0;i<e.length&&!((t-=2)<0);++i)a=e.charCodeAt(i),r=a>>8,n=a%256,s.push(n),s.push(r);return s}(t,e.length-a),e,a,r)}function y(e,t,a){return 0===t&&a===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,a))}function C(e,t,a){a=Math.min(e.length,a);for(var r=[],n=t;n<a;){var s,i,o,l,c=e[n],h=null,d=c>239?4:c>223?3:c>191?2:1;if(n+d<=a)switch(d){case 1:c<128&&(h=c);break;case 2:128==(192&(s=e[n+1]))&&(l=(31&c)<<6|63&s)>127&&(h=l);break;case 3:s=e[n+1],i=e[n+2],128==(192&s)&&128==(192&i)&&(l=(15&c)<<12|(63&s)<<6|63&i)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:s=e[n+1],i=e[n+2],o=e[n+3],128==(192&s)&&128==(192&i)&&128==(192&o)&&(l=(15&c)<<18|(63&s)<<12|(63&i)<<6|63&o)>65535&&l<1114112&&(h=l)}null===h?(h=65533,d=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),n+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var a="",r=0;for(;r<t;)a+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return a}(r)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=i(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,a){return c(null,e,t,a)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,a){return function(e,t,a,r){return h(t),t<=0?o(e,t):void 0!==a?"string"==typeof r?o(e,t).fill(a,r):o(e,t).fill(a):o(e,t)}(null,e,t,a)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var a=e.length,r=t.length,n=0,s=Math.min(a,r);n<s;++n)if(e[n]!==t[n]){a=e[n],r=t[n];break}return a<r?-1:r<a?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var a;if(void 0===t)for(t=0,a=0;a<e.length;++a)t+=e[a].length;var r=l.allocUnsafe(t),n=0;for(a=0;a<e.length;++a){var i=e[a];if(!l.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,n),n+=i.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)A(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)A(this,t,t+3),A(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)A(this,t,t+7),A(this,t+1,t+6),A(this,t+2,t+5),A(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):f.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",a=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,a).match(/.{2}/g).join(" "),this.length>a&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,a,r,n){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===a&&(a=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||a>e.length||r<0||n>this.length)throw new RangeError("out of range index");if(r>=n&&t>=a)return 0;if(r>=n)return-1;if(t>=a)return 1;if(this===e)return 0;for(var s=(n>>>=0)-(r>>>=0),i=(a>>>=0)-(t>>>=0),o=Math.min(s,i),c=this.slice(r,n),h=e.slice(t,a),d=0;d<o;++d)if(c[d]!==h[d]){s=c[d],i=h[d];break}return s<i?-1:i<s?1:0},l.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},l.prototype.indexOf=function(e,t,a){return g(this,e,t,a,!0)},l.prototype.lastIndexOf=function(e,t,a){return g(this,e,t,a,!1)},l.prototype.write=function(e,t,a,r){if(void 0===t)r="utf8",a=this.length,t=0;else if(void 0===a&&"string"==typeof t)r=t,a=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(a)?(a|=0,void 0===r&&(r="utf8")):(r=a,a=void 0)}var n=this.length-t;if((void 0===a||a>n)&&(a=n),e.length>0&&(a<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return S(this,e,t,a);case"utf8":case"utf-8":return b(this,e,t,a);case"ascii":return v(this,e,t,a);case"latin1":case"binary":return w(this,e,t,a);case"base64":return x(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,a);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(e,t,a){var r="";a=Math.min(e.length,a);for(var n=t;n<a;++n)r+=String.fromCharCode(127&e[n]);return r}function U(e,t,a){var r="";a=Math.min(e.length,a);for(var n=t;n<a;++n)r+=String.fromCharCode(e[n]);return r}function k(e,t,a){var r=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>r)&&(a=r);for(var n="",s=t;s<a;++s)n+=N(e[s]);return n}function D(e,t,a){for(var r=e.slice(t,a),n="",s=0;s<r.length;s+=2)n+=String.fromCharCode(r[s]+256*r[s+1]);return n}function I(e,t,a){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>a)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,a,r,n,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(a+r>e.length)throw new RangeError("Index out of range")}function B(e,t,a,r){t<0&&(t=65535+t+1);for(var n=0,s=Math.min(e.length-a,2);n<s;++n)e[a+n]=(t&255<<8*(r?n:1-n))>>>8*(r?n:1-n)}function P(e,t,a,r){t<0&&(t=4294967295+t+1);for(var n=0,s=Math.min(e.length-a,4);n<s;++n)e[a+n]=t>>>8*(r?n:3-n)&255}function E(e,t,a,r,n,s){if(a+r>e.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function F(e,t,a,r,s){return s||E(e,0,a,4),n.write(e,t,a,r,23,4),a+4}function V(e,t,a,r,s){return s||E(e,0,a,8),n.write(e,t,a,r,52,8),a+8}l.prototype.slice=function(e,t){var a,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(a=this.subarray(e,t)).__proto__=l.prototype;else{var n=t-e;a=new l(n,void 0);for(var s=0;s<n;++s)a[s]=this[s+e]}return a},l.prototype.readUIntLE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var r=this[e],n=1,s=0;++s<t&&(n*=256);)r+=this[e+s]*n;return r},l.prototype.readUIntBE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var r=this[e+--t],n=1;t>0&&(n*=256);)r+=this[e+--t]*n;return r},l.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var r=this[e],n=1,s=0;++s<t&&(n*=256);)r+=this[e+s]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var r=t,n=1,s=this[e+--r];r>0&&(n*=256);)s+=this[e+--r]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},l.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},l.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),n.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),n.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),n.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),n.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,a,r){(e=+e,t|=0,a|=0,r)||R(this,e,t,a,Math.pow(2,8*a)-1,0);var n=1,s=0;for(this[t]=255&e;++s<a&&(n*=256);)this[t+s]=e/n&255;return t+a},l.prototype.writeUIntBE=function(e,t,a,r){(e=+e,t|=0,a|=0,r)||R(this,e,t,a,Math.pow(2,8*a)-1,0);var n=a-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+a},l.prototype.writeUInt8=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):P(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,a,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*a-1);R(this,e,t,a,n-1,-n)}var s=0,i=1,o=0;for(this[t]=255&e;++s<a&&(i*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+a},l.prototype.writeIntBE=function(e,t,a,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*a-1);R(this,e,t,a,n-1,-n)}var s=a-1,i=1,o=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+a},l.prototype.writeInt8=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):P(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,a){return e=+e,t|=0,a||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,a){return F(this,e,t,!0,a)},l.prototype.writeFloatBE=function(e,t,a){return F(this,e,t,!1,a)},l.prototype.writeDoubleLE=function(e,t,a){return V(this,e,t,!0,a)},l.prototype.writeDoubleBE=function(e,t,a){return V(this,e,t,!1,a)},l.prototype.copy=function(e,t,a,r){if(a||(a=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<a&&(r=a),r===a)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-a&&(r=e.length-t+a);var n,s=r-a;if(this===e&&a<t&&t<r)for(n=s-1;n>=0;--n)e[n+t]=this[n+a];else if(s<1e3||!l.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)e[n+t]=this[n+a];else Uint8Array.prototype.set.call(e,this.subarray(a,a+s),t);return s},l.prototype.fill=function(e,t,a,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,a=this.length):"string"==typeof a&&(r=a,a=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<a)throw new RangeError("Out of range index");if(a<=t)return this;var s;if(t>>>=0,a=void 0===a?this.length:a>>>0,e||(e=0),"number"==typeof e)for(s=t;s<a;++s)this[s]=e;else{var i=l.isBuffer(e)?e:L(new l(e,r).toString()),o=i.length;for(s=0;s<a-t;++s)this[s+t]=i[s%o]}return this};var O=/[^+\/0-9A-Za-z-_]/g;function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function L(e,t){var a;t=t||1/0;for(var r=e.length,n=null,s=[],i=0;i<r;++i){if((a=e.charCodeAt(i))>55295&&a<57344){if(!n){if(a>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&s.push(239,191,189);continue}n=a;continue}if(a<56320){(t-=3)>-1&&s.push(239,191,189),n=a;continue}a=65536+(n-55296<<10|a-56320)}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,a<128){if((t-=1)<0)break;s.push(a)}else if(a<2048){if((t-=2)<0)break;s.push(a>>6|192,63&a|128)}else if(a<65536){if((t-=3)<0)break;s.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return s}function G(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(O,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,a,r){for(var n=0;n<r&&!(n+a>=t.length||n>=e.length);++n)t[n+a]=e[n];return n}}).call(this,a(57))},function(e,t,a){"use strict";t.byteLength=function(e){var t=c(e),a=t[0],r=t[1];return 3*(a+r)/4-r},t.toByteArray=function(e){var t,a,r=c(e),i=r[0],o=r[1],l=new s(function(e,t,a){return 3*(t+a)/4-a}(0,i,o)),h=0,d=o>0?i-4:i;for(a=0;a<d;a+=4)t=n[e.charCodeAt(a)]<<18|n[e.charCodeAt(a+1)]<<12|n[e.charCodeAt(a+2)]<<6|n[e.charCodeAt(a+3)],l[h++]=t>>16&255,l[h++]=t>>8&255,l[h++]=255&t;2===o&&(t=n[e.charCodeAt(a)]<<2|n[e.charCodeAt(a+1)]>>4,l[h++]=255&t);1===o&&(t=n[e.charCodeAt(a)]<<10|n[e.charCodeAt(a+1)]<<4|n[e.charCodeAt(a+2)]>>2,l[h++]=t>>8&255,l[h++]=255&t);return l},t.fromByteArray=function(e){for(var t,a=e.length,n=a%3,s=[],i=0,o=a-n;i<o;i+=16383)s.push(h(e,i,i+16383>o?o:i+16383));1===n?(t=e[a-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===n&&(t=(e[a-2]<<8)+e[a-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return s.join("")};for(var r=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=i.length;o<l;++o)r[o]=i[o],n[i.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.indexOf("=");return-1===a&&(a=t),[a,a===t?0:4-a%4]}function h(e,t,a){for(var n,s,i=[],o=t;o<a;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(r[(s=n)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return i.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,a,r,n){var s,i,o=8*n-r-1,l=(1<<o)-1,c=l>>1,h=-7,d=a?n-1:0,u=a?-1:1,m=e[t+d];for(d+=u,s=m&(1<<-h)-1,m>>=-h,h+=o;h>0;s=256*s+e[t+d],d+=u,h-=8);for(i=s&(1<<-h)-1,s>>=-h,h+=r;h>0;i=256*i+e[t+d],d+=u,h-=8);if(0===s)s=1-c;else{if(s===l)return i?NaN:1/0*(m?-1:1);i+=Math.pow(2,r),s-=c}return(m?-1:1)*i*Math.pow(2,s-r)},t.write=function(e,t,a,r,n,s){var i,o,l,c=8*s-n-1,h=(1<<c)-1,d=h>>1,u=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,m=r?0:s-1,p=r?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=h):(i=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-i))<1&&(i--,l*=2),(t+=i+d>=1?u/l:u*Math.pow(2,1-d))*l>=2&&(i++,l/=2),i+d>=h?(o=0,i=h):i+d>=1?(o=(t*l-1)*Math.pow(2,n),i+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,n),i=0));n>=8;e[a+m]=255&o,m+=p,o/=256,n-=8);for(i=i<<n|o,c+=n;c>0;e[a+m]=255&i,m+=p,i/=256,c-=8);e[a+m-p]|=128*f}},function(e,t){var a={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==a.call(e)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(27)),s=r(a(11)),i=a(26),o=a(25),l=a(36),c=r(a(39)),h=a(16),d=a(0),u=a(6),m=a(5),p=a(9),f=a(2),A=a(1);class g{constructor(){this.extraTextures=[],this.fillTextureMapping=(e,t)=>{const a=t.toLowerCase().replace(".tga",""),r=this.extraTextures.find(e=>e.btiTexture.name===a);return void 0!==r&&r.fillTextureMapping(e)}}addBTI(e,t,a){this.extraTextures.push(new l.BTIData(e,t,a))}destroy(e){for(let t=0;t<this.extraTextures.length;t++)this.extraTextures[t].destroy(e)}}const _={lightingFudge:e=>`(0.5 * (${e.ambSource} + 0.6) * ${e.matSource})`};function S(e,t,a,r,n,s,l,c){const h=i.BMD.parse(r.buffer),d=c?i.BMT.parse(c.buffer):null,u=new o.J3DModelData(e,t,h),m=new o.J3DModelInstanceSimple(u,_);null!==d&&m.setModelMaterialData(new o.BMDModelMaterialData(e,t,d));for(let e=0;e<u.modelMaterialData.tex1Data.tex1.samplers.length;e++){const t=u.modelMaterialData.tex1Data.tex1.samplers[e],r=m.materialInstanceState.textureMappings[e];null===r.gfxTexture&&a.fillTextureMapping(r,t.name)}if(null!==n){const e=i.BTK.parse(n.buffer);m.bindTTK1(e)}if(null!==s){const e=i.BRK.parse(s.buffer);m.bindTRK1(e)}if(null!==l){const e=i.BCK.parse(l.buffer);m.bindANK1(e)}return m}class b{constructor(e,t,a){this.extraTextures=t,this.stageRarc=a,this.mainRenderTarget=new p.BasicRenderTarget,this.opaqueSceneTexture=new p.ColorTexture,this.modelInstances=[],this.renderHelper=new m.GXRenderHelperGfx(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(.6)}setMirrored(e){const t=A.mat4.create();f.computeModelMatrixS(t,-1,1,1);for(let a=0;a<this.modelInstances.length;a++){A.mat4.mul(this.modelInstances[a].modelMatrix,t,this.modelInstances[a].modelMatrix);for(let t=0;t<this.modelInstances[a].materialInstances.length;t++)this.modelInstances[a].materialInstances[t].materialHelper.megaStateFlags.frontFace=e?u.GfxFrontFaceMode.CCW:u.GfxFrontFaceMode.CW}}createPanels(){const e=new s.LayerPanel;e.setLayers(this.modelInstances);const t=new s.Panel;t.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,t.setTitle(s.RENDER_HACKS_ICON,"Render Hacks");const a=new s.Checkbox("Mirror Levels (Like Wii)");a.onchanged=()=>{this.setMirrored(a.checked)},t.contents.appendChild(a.elem);const r=new s.Checkbox("Enable Vertex Colors",!0);r.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setVertexColorsEnabled(r.checked)},t.contents.appendChild(r.elem);const n=new s.Checkbox("Enable Textures",!0);return n.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setTexturesEnabled(n.checked)},t.contents.appendChild(n.elem),[e,t]}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();m.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}setIndirectTextureOverride(){for(let e=0;e<this.modelInstances.length;e++){const t=this.modelInstances[e].getTextureMappingReference("fbtex_dummy");null!==t&&(t.gfxTexture=this.opaqueSceneTexture.gfxTexture,t.width=h.EFB_WIDTH,t.height=h.EFB_HEIGHT,t.flipY=!0)}}render(e,t){const a=this.renderHelper.renderInstManager;this.mainRenderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.opaqueSceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.setIndirectTextureOverride();const r=e.createHostAccessPass();this.prepareToRender(e,r,t),e.submitPass(r);const n=this.mainRenderTarget.createRenderPass(e,t.viewport,p.standardFullClearRenderPassDescriptor);a.setVisibleByFilterKeyExact(1),a.drawOnPassRenderer(e,n),e.submitPass(n);const s=this.mainRenderTarget.createRenderPass(e,t.viewport,p.depthClearRenderPassDescriptor,this.opaqueSceneTexture.gfxTexture);let i;if(a.setVisibleByFilterKeyExact(2),a.drawOnPassRenderer(e,s),a.setVisibleByFilterKeyExact(4),a.hasAnyVisible()){e.submitPass(s);const r=this.mainRenderTarget.createRenderPass(e,t.viewport,p.noClearRenderPassDescriptor);a.drawOnPassRenderer(e,r),i=r}else i=s;return a.setVisibleByFilterKeyExact(8),a.drawOnPassRenderer(e,i),a.resetRenderInsts(),i}destroy(e){this.renderHelper.destroy(e),this.extraTextures.destroy(e),this.mainRenderTarget.destroy(e),this.opaqueSceneTexture.destroy(e),this.modelInstances.forEach(t=>t.destroy(e))}}class v{constructor(e,t,a=null){this.name=e,this.stageId=t,this.roomNames=a,this.id=null!==a?`${this.stageId}/${a[0]}`:this.stageId}createRoomScenes(e,t,a,r){a.files.filter(e=>e.name.endsWith(".bmd")||e.name.endsWith(".bdl")).forEach(n=>{const s=n.name.split(".")[0],i=a.files.find(e=>e.name===`${s}.btk`)||null,o=a.files.find(e=>e.name===`${s}.brk`)||null,l=a.files.find(e=>e.name===`${s}.bck`)||null,c=a.files.find(e=>e.name===`${s}.bmt`)||null,h=t.renderHelper.renderInstManager.gfxRenderCache,d=S(e,h,t.extraTextures,n,i,o,l,c);d.name=`${r}/${s}`;let u=0;if("model"===s)u=2;else if("model1"===s){u=(m=d.modelData,p="fbtex_dummy",m.bmd.tex1.samplers.some(e=>e.name===p))?4:2}else"model2"===s?u=8:"model3"===s?u=8:"model4"!==s&&"model5"!==s||(u=8);var m,p;d.passMask=u,t.modelInstances.push(d)})}createScene(e,t){const a=t.dataFetcher,r=`j3d/ztp/res/Stage/${this.stageId}`,n=new g;return this.fetchRarc(`${r}/STG_00.arc`,a).then(t=>{const s=d.assertExists(t),i=s.findDir("texc"),o=null!==i?i.files:[],c=new b(e,n,s),h=c.renderHelper.renderInstManager.gfxRenderCache;for(let t=0;t<o.length;t++){const a=o[t],r=a.name.split(".")[0],s=l.BTI.parse(a.buffer,r).texture;n.addBTI(e,h,s)}["vrbox_sora","vrbox_kasumim"].forEach(t=>{const a=s.findFile(`bmdp/${t}.bmd`);if(!a)return;const r=s.findFile(`btk/${t}.btk`),i=s.findFile(`brk/${t}.brk`),o=s.findFile(`bck/${t}.bck`),l=S(e,h,n,a,r,i,o,null);l.name=`stage/${t}`,l.isSkybox=!0,c.modelInstances.push(l)});const u=s.findFile("dzs/stage.dzs").buffer;let m;if(null!==this.roomNames)m=this.roomNames;else{const e=function(e){const t=e.createDataView(),a=t.getUint32(0),r=new Map;let n=4;for(let s=0;s<a;s++){const a=d.readString(e,n+0,4),s=t.getUint32(n+4),i=t.getUint32(n+8);r.set(a,{offs:i,count:s}),n+=12}const{offs:s,count:i}=r.get("RTBL");let o=new Set;for(let e=0;e<i;e++){const a=t.getUint32(s+4*e);if(0===t.getUint8(a+0))continue;const r=t.getUint32(a+4);o.add(63&t.getUint8(r+0))}return[...o.values()]}(u);m=e.map(e=>`R${d.leftPad(""+e,2)}_00`)}return Promise.all(m.map(e=>this.fetchRarc(`${r}/${e}.arc`,a))).then(t=>(t.forEach((t,a)=>{null!==t&&this.createRoomScenes(e,c,t,m[a])}),c))})}async fetchRarc(e,t){const a=await t.fetchData(e,1);if(0===a.byteLength)return null;const r=await n.decompress(a);return c.parse(r)}}const w=["Overworld Maps",new v("Hyrule Field Map 1","F_SP102"),new v("Hyrule Field Map 2","F_SP121"),new v("Hyrule Field Map 3","F_SP122"),new v("Lake Hylia","F_SP123"),new v("Ordon Ranch","F_SP00"),new v("Ordon Village","F_SP103",["R00_00"]),new v("Link's House Area","F_SP103",["R01_00"]),new v("Ordon Woods","F_SP104"),new v("Faron Woods","F_SP108"),new v("Kakariko Village","F_SP109"),new v("Death Mountain Trail","F_SP110"),new v("Kakariko Graveyard","F_SP111"),new v("Rapids Ride","F_SP112"),new v("Zora's Domain","F_SP113"),new v("Snowpeak Mountain","F_SP114"),new v("Lanayru's Spring","F_SP115"),new v("Castle Town","F_SP116"),new v("Sacred Grove","F_SP117"),new v("Gerudo Desert Bulblin Base","F_SP118"),new v("Gerudo Desert","F_SP124"),new v("Arbiter's Grounds Mirror Chamber","F_SP125"),new v("Zora's River","F_SP126"),new v("Fishing Pond","F_SP127"),new v("Hidden Village","F_SP128"),new v("Wolf Howling Cutscene Map","F_SP200"),"Dungeons",new v("Forest Temple","D_MN05"),new v("Forest Temple Boss Arena","D_MN05A"),new v("Forest Temple Mini-Boss Arena","D_MN05B"),new v("Goron Mines","D_MN04"),new v("Goron Mines Boss Arena","D_MN04A"),new v("Goron Mines Mini-Boss Arena","D_MN04B"),new v("Lakebed Temple","D_MN01"),new v("Lakebed Temple Boss Arena","D_MN01A"),new v("Lakebed Temple Mini-Boss Arena","D_MN01B"),new v("Arbiter's Grounds","D_MN10"),new v("Arbiter's Grounds Boss Arena","D_MN10A"),new v("Arbiter's Grounds Mini-Boss Arena","D_MN10B"),new v("Snowpeak Ruins","D_MN11"),new v("Snowpeak Ruins Boss Arena","D_MN11A"),new v("Snowpeak Ruins Mini-Boss Arena","D_MN11B"),new v("Temple of Time","D_MN06"),new v("Temple of Time Boss Arena","D_MN06A"),new v("Temple of Time Mini-Boss Arena","D_MN06B"),new v("City in the Sky","D_MN07"),new v("City in the Sky Boss Arena","D_MN07A"),new v("City in the Sky Mini-Boss Arena","D_MN07B"),new v("Palace of Twilight","D_MN08"),new v("Palace of Twilight Boss Arena 1","D_MN08A"),new v("Palace of Twilight Mini-Boss Arena 1","D_MN08B"),new v("Palace of Twilight Mini-Boss Arena 2","D_MN08C"),new v("Palace of Twilight Boss Rush Arena","D_MN08D"),new v("Hyrule Castle","D_MN09"),new v("Hyrule Castle Boss Arena","D_MN09A"),new v("Final Boss Arena (On Horseback)","D_MN09B"),new v("Final Boss Arena","D_MN09C"),"Mini-Dungeons and Grottos",new v("Ice Cavern","D_SB00"),new v("Cave Of Ordeals","D_SB01"),new v("Kakariko Lantern Cavern","D_SB02"),new v("Lake Hylia Lantern Cavern","D_SB03"),new v("Goron Mines Lantern Cavern","D_SB04"),new v("Faron Woods Lantern Cavern","D_SB10"),new v("Faron Woods Cave 1","D_SB05"),new v("Faron Woods Cave 2","D_SB06"),new v("Snow Cave 1","D_SB07"),new v("Snow Cave 2","D_SB08"),new v("Water Cave","D_SB09"),"Ordon Village",new v("Mayor's House","R_SP01",["R00_00"]),new v("Sera's Sundries","R_SP01",["R01_00"]),new v("Talo and Malo's House","R_SP01",["R02_00"]),new v("Link's House","R_SP01",["R04_00","R07_00"]),new v("Rusl's House","R_SP01",["R05_00"]),"Houses / Indoors",new v("Hyrule Castle Wolf Escape","R_SP107"),new v("Caro's House","R_SP108"),new v("Kakariko Village Houses","R_SP109"),new v("Goron Mines Entrance","R_SP110"),new v("Telma's Bar + Castle Town Sewers","R_SP116"),new v("Fishing Hole Interior","R_SP127"),new v("Impaz's House","R_SP128"),new v("Castle Town Houses","R_SP160"),new v("Star Tent","R_SP161"),new v("Kakariko Sanctuary","R_SP209"),new v("Cutscene: Light Arrow Area","R_SP300"),new v("Cutscene: Hyrule Castle Throne Room","R_SP301")];t.sceneGroup={id:"ztp",name:"The Legend of Zelda: Twilight Princess",sceneDescs:w}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(11)),s=a(0),i=a(1),o=r(a(39)),l=a(9),c=a(5),h=a(6),d=a(25),u=a(26),m=a(2);class p{constructor(e){this.renderTarget=new l.BasicRenderTarget,this.modelInstances=[],this.rarc=[],this.renderHelper=new c.GXRenderHelperGfx(e)}setMirrored(e){const t=i.mat4.create();m.computeModelMatrixS(t,-1,1,1);for(let a=0;a<this.modelInstances.length;a++){i.mat4.mul(this.modelInstances[a].modelMatrix,t,this.modelInstances[a].modelMatrix);for(let t=0;t<this.modelInstances[a].materialInstances.length;t++)this.modelInstances[a].materialInstances[t].materialHelper.megaStateFlags.frontFace=e?h.GfxFrontFaceMode.CCW:h.GfxFrontFaceMode.CW}}adjustCameraController(e){e.setSceneMoveSpeedMult(200/60)}createPanels(){const e=new n.Panel;e.customHeaderBackgroundColor=n.COOL_BLUE_COLOR,e.setTitle(n.RENDER_HACKS_ICON,"Render Hacks");const t=new n.Checkbox("Mirror Courses");t.onchanged=()=>{this.setMirrored(t.checked)},e.contents.appendChild(t.elem);const a=new n.Checkbox("Enable Vertex Colors",!0);a.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setVertexColorsEnabled(a.checked)},e.contents.appendChild(a.elem);const r=new n.Checkbox("Enable Textures",!0);return r.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setTexturesEnabled(r.checked)},e.contents.appendChild(r.elem),[new n.LayerPanel(this.modelInstances),e]}addModelInstance(e){this.modelInstances.push(e)}prepareToRender(e,t,a){const r=this.renderHelper.renderInstManager,n=this.renderHelper.pushTemplateRenderInst();c.fillSceneParamsDataOnTemplate(n,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,r,a);r.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,l.standardFullClearRenderPassDescriptor);return this.renderHelper.renderInstManager.drawOnPassRenderer(e,r),this.renderHelper.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e)}}class f{constructor(e,t){this.name=e,this.path=t,this.id=this.path}spawnBMD(e,t,a,r,n=null){const o=s.assertExists(a.findFileData(`${r}.bmd`)),l=new d.J3DModelData(e,t.renderHelper.renderInstManager.gfxRenderCache,u.BMD.parse(o)),c=new d.J3DModelInstanceSimple(l),h=a.findFileData(`${r}.btk`);null!==h&&c.bindTTK1(u.BTK.parse(h));const m=a.findFileData(`${r}.brk`);null!==m&&c.bindTRK1(u.BRK.parse(m));const p=a.findFileData(`${r}.btp`);return null!==p&&c.bindTPT1(u.BTP.parse(p)),c.name=r,null!==n&&i.mat4.copy(c.modelMatrix,n),c}createScene(e,t){const a=t.dataFetcher,r=`j3d/mkdd/Course/${this.path}`;return a.fetchData(r).then(t=>{const a=o.parse(t),r=s.assertExists(a.files.find(e=>e.name.endsWith("_course.bol"))),n=r.name.replace("_course.bol",""),l=new p(e);a.findFile(`${n}_sky.bmd`)&&l.addModelInstance(this.spawnBMD(e,l,a,`${n}_sky`)),l.addModelInstance(this.spawnBMD(e,l,a,`${n}_course`));const c=(t,r,n=null)=>{const i=this.spawnBMD(e,l,a,r,t.modelMatrix);let o;if(l.addModelInstance(i),o=null!==n?s.assertExists(a.findFile(n)):a.findFile(`${r}_wait.bck`),null!==o){const e=u.BCK.parse(o.buffer);i.bindANK1(e)}},h=function(e){const t=e.createDataView();s.assert("0015"==s.readString(e,0,4));const a=t.getUint16(30),r=[];let n=t.getUint32(84);for(let e=0;e<a;e++){const e=t.getFloat32(n+0),a=t.getFloat32(n+4),s=t.getFloat32(n+8),o=t.getFloat32(n+12),l=t.getFloat32(n+16),c=t.getFloat32(n+20),h=t.getInt32(n+24),d=t.getInt32(n+28),u=(t.getInt32(n+32),t.getUint16(n+36)),m=t.getInt16(n+38),p=i.mat4.create(),f=i.quat.create(),A=Math.atan2(d,h);i.quat.fromEuler(f,0,-180*A/Math.PI+90,0),i.mat4.fromRotationTranslationScale(p,f,[e,a,s],[o,l,c]),r.push({id:u,routeId:m,modelMatrix:p}),n+=64}return{objects:r}}(r.buffer);console.log(n,a,h);for(const e of h.objects)switch(e.id){case 1:case 9:break;case 3401:c(e,"objects/sea1_spc"),c(e,"objects/sea2_tex"),c(e,"objects/sea3_dark"),c(e,"objects/sea4_nami"),c(e,"objects/sea5_sand");break;case 3402:c(e,"objects/poihana1");break;case 3405:c(e,"objects/peachtree1");break;case 3406:c(e,"objects/peachfountain");break;case 3407:c(e,"objects/marel_a");break;case 3701:c(e,"objects/mariotree1");break;case 3703:c(e,"objects/marioflower1","objects/marioflower1.bck");break;case 3704:break;case 3710:c(e,"objects/skyship1");break;case 3711:c(e,"objects/kuribo1");break;case 4506:break;default:console.warn(`Unknown object ID ${e.id.toString(16)}`);continue}return l})}}const A=["Mushroom Cup",new f("Luigi Circuit","Luigi.arc"),new f("Peach Beach","Peach.arc"),new f("Baby Park","BabyLuigi.arc"),new f("Dry Dry Desert","Desert.arc"),"Flower Cup",new f("Mushroom Bridge","Nokonoko.arc"),new f("Mario Circuit","Mario.arc"),new f("Daisy Cruiser","Daisy.arc"),new f("Waluigi Stadium","Waluigi.arc"),"Star Cup",new f("Sherbet Land","Snow.arc"),new f("Mushroom City","Patapata.arc"),new f("Yoshi Circuit","Yoshi.arc"),new f("DK Mountain","Donkey.arc"),"Special Cup",new f("Wario Colosseum","Wario.arc"),new f("Dino Dino Jungle","Diddy.arc"),new f("Bowser's Castle","Koopa.arc"),new f("Rainbow Road","Rainbow.arc"),"Battle Courses",new f("Cookie Land","Mini7.arc"),new f("Block City","Mini3.arc"),new f("Luigi's Mansion","Mini1.arc"),new f("Nintendo GameCube","Mini2.arc"),new f("Pipe Plaza","Mini8.arc"),new f("Tilt-a-Kart","Mini5.arc")];t.sceneGroup={id:"mkdd",name:"Mario Kart: Double Dash!!",sceneDescs:A}},function(e,t,a){"use strict";var r=this&&this.__decorate||function(e,t,a,r){var n,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,r);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(s<3?n(i):s>3?n(t,a,i):n(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=a(1),i=a(0),o=n(a(64)),l=n(a(39)),c=n(a(27)),h=n(a(11)),d=n(a(90)),u=a(8),m=a(5),p=a(5),f=a(6),A=a(7),g=a(9),_=a(51),S=a(2),b=a(10),v=a(16),w=a(157),x=a(160),T=a(158),y=a(61),C=a(105),M=a(65),U=a(140),k=a(217),D=a(161),I=a(91);class R{constructor(){this.vertexColorsEnabled=!0,this.texturesEnabled=!0,this.objectsVisible=!0,this.renderHacksChanged=!1}}class B{constructor(){this.sky=[new A.GfxRenderInstList(A.gfxRenderInstCompareNone,1),new A.GfxRenderInstList(A.gfxRenderInstCompareNone,1)],this.sea=new A.GfxRenderInstList(A.gfxRenderInstCompareNone,1),this.main=[new A.GfxRenderInstList(A.gfxRenderInstCompareSortKey,0),new A.GfxRenderInstList(A.gfxRenderInstCompareSortKey,0)],this.wetherEffect=new A.GfxRenderInstList(A.gfxRenderInstCompareNone,1),this.effect=[new A.GfxRenderInstList(A.gfxRenderInstCompareSortKey,1),new A.GfxRenderInstList(A.gfxRenderInstCompareSortKey,1)],this.peekZ=new D.PeekZManager}reset(){this.sky[0].reset(),this.sky[1].reset(),this.sea.reset(),this.main[0].reset(),this.main[1].reset(),this.wetherEffect.reset();for(let e=0;e<this.effect.length;e++)this.effect[e].reset()}destroy(e){this.peekZ.destroy(e)}}t.dDlst_list_c=B;class P{constructor(e,t,a){this.modelCache=e,this.extraSymbolData=t,this.frameworkGlobals=a,this.g_env_light=new y.dScnKy_env_light_c,this.dlst=new B,this.dStage_dt=new T.dStage_stageDt_c,this.roomStatus=i.nArray(64,()=>new T.dStage_roomStatus_c),this.mStayNo=0,this.playerPosition=s.vec3.create(),this.cameraPosition=s.vec3.create(),this.cameraFwd=s.vec3.create(),this.renderHacks=new R,this.resCtrl=this.modelCache.resCtrl,this.relNameTable=function(e){const t=i.assertExists(e.SymbolData.find(e=>"c_dylink.o"===e.Filename&&"DynamicNameTable"===e.SymbolName)),a=i.assertExists(e.SymbolData.find(e=>"c_dylink.o"===e.Filename&&"@stringBase0"===e.SymbolName)),r=new TextDecoder("utf8"),n=t.Data.createDataView(),s=a.Data.createTypedArray(Uint8Array),o=n.byteLength/8,l={};for(let e=0;e<o;e++){const t=8*e,a=n.getUint16(t+0),i=n.getUint32(t+4)-2150868552,o=s.indexOf(0,i),c=r.decode(s.subarray(i,o));l[a]=c}return l}(t),this.objectNameTable=function(e){const t=i.assertExists(e.SymbolData.find(e=>"d_stage.o"===e.Filename&&"l_objectName"===e.SymbolName)).Data,a=t.createDataView(),r=t.byteLength/12,n={};for(let e=0;e<r;e++){const r=12*e,s=i.readString(t,r+0,12),o=a.getUint16(r+8,!1),l=a.getUint8(r+10),c=a.getUint8(r+11);n[s]={pcName:o,subtype:l,gbaName:c}}return n}(t);for(let e=0;e<this.roomStatus.length;e++)this.roomStatus[e].roomNo=e,y.dKy_tevstr_init(this.roomStatus[e].tevStr,e)}dStage_searchName(e){const t=this.objectNameTable[e];return void 0!==t?t:null}dStage__searchNameRev(e,t){for(const a in this.objectNameTable){const r=this.objectNameTable[a];if(r.pcName===e&&r.subtype===t)return a}return null}objNameGetDbgName(e){const t=`0x${i.hexzero(e.pcName,4)}`;return`${this.relNameTable[e.pcName]||"built-in"} (${t})`}findExtraSymbolData(e,t){return i.assertExists(this.extraSymbolData.SymbolData.find(a=>a.Filename===e&&a.SymbolName===t)).Data}destroy(e){this.dlst.destroy(e)}}function E(e,t){const a=.5*Math.pow(2*(e<.5?e:1-e),t);return e<.5?a:1-a}t.dGlobals=P;class F{constructor(e){this.desiredPower=0,this.texPower=0,this.textureData=[new Uint8Array(512)],this.gfxTexture=e.createTexture(f.makeTextureDescriptor2D(f.GfxFormat.U8_RG_NORM,256,1,1)),e.setResourceName(this.gfxTexture,"DynToonTex")}fillTextureData(e){let t=0;const a=this.textureData[0];for(let r=0;r<256;r++){const n=r/255;a[t++]=255*E(n,e),a[t++]=0}}prepareToRender(e){if(this.texPower!==this.desiredPower){this.texPower=this.desiredPower,this.fillTextureData(this.texPower);const t=e.createHostAccessPass();t.uploadTextureData(this.gfxTexture,0,this.textureData),e.submitPass(t)}}destroy(e){e.destroyTexture(this.gfxTexture)}}class V{constructor(e,t,a){this.textureMapping=i.nArray(2,()=>new b.TextureMapping),this.toonTexPower=15,t.fillTextureMapping(this.textureMapping[0]),a.fillTextureMapping(this.textureMapping[1]),this.dynToonTex=new F(e)}powerPopup(){this.textureMapping[0].gfxTexture=this.dynToonTex.gfxTexture,this.textureMapping[1].gfxTexture=this.dynToonTex.gfxTexture,window.main.ui.bindSliders(this)}prepareToRender(e){this.dynToonTex.desiredPower=this.toonTexPower,this.dynToonTex.prepareToRender(e)}fillExtraTextures(e){const t=e.getTextureMappingReference("ZAtoon");null!==t&&t.copy(this.textureMapping[0]);const a=e.getTextureMappingReference("ZBtoonEX");null!==a&&a.copy(this.textureMapping[1])}destroy(e){this.dynToonTex.destroy(e)}}r([h.dfRange(1,15,.01)],V.prototype,"toonTexPower",void 0),t.ZWWExtraTextures=V;class O{constructor(e,t){this.roomNo=e,this.visible=t,this.name=`Room ${e}`}setVisible(e){this.visible=e}}function N(e,t){e.gfxTexture=t,e.width=v.EFB_WIDTH,e.height=v.EFB_HEIGHT,e.flipY=!0}t.WindWakerRoom=O;class L{constructor(e,t){this.jpac=t,this.drawInfo=new d.JPADrawInfo,this.jpacData=[],this.resourceDatas=new Map,this.emitterManager=new d.JPAEmitterManager(e,6e3,300);for(let e=0;e<this.jpac.length;e++)this.jpacData.push(new d.JPACData(this.jpac[e]))}findResourceData(e){for(let t=0;t<this.jpacData.length;t++){const a=this.jpacData[t].jpac.effects.find(t=>t.resourceId===e);if(void 0!==a)return[this.jpacData[t],a]}return null}getResourceData(e,t,a){if(!this.resourceDatas.has(a)){const r=this.findResourceData(a);if(null!==r){const[n,s]=r,i=new d.JPAResourceData(e,t,n,s);this.resourceDatas.set(a,i)}}return this.resourceDatas.get(a)}setOpaqueSceneTexture(e){for(let t=0;t<this.jpacData.length;t++){const a=this.jpacData[t].getTextureMappingReference("AK_kagerouSwap00");null!==a&&N(a,e)}}setDrawInfo(e,t,a){this.drawInfo.posCamMtx=e,this.drawInfo.prjMtx=t,this.drawInfo.texPrjMtx=a}calc(e){const t=30*e.deltaTime/1e3;this.emitterManager.calc(t)}draw(e,t,a){this.emitterManager.draw(e,t,this.drawInfo,a)}createBaseEmitter(e,t,a){const r=i.assertExists(this.getResourceData(e,t,a)),n=this.emitterManager.createEmitter(r);return n.drawGroupId=16384&a?1:0,n}createEmitterTest(e=20){const t=window.main.viewer.gfxDevice,a=window.main.scene.renderHelper.getCache(),r=this.createBaseEmitter(t,a,e);if(null!==r){r.globalTranslation[0]=-275,r.globalTranslation[1]=150,r.globalTranslation[2]=2130;const e=s.vec3.clone(r.globalTranslation);let t=0;requestAnimationFrame((function a(){t+=.1,r.globalTranslation[0]=e[0]+50*Math.sin(t),r.globalTranslation[1]=e[1]+50*Math.sin(.777*t),r.globalTranslation[2]=e[2]+50*Math.cos(t),requestAnimationFrame(a)}))}return r}destroy(e){for(let t=0;t<this.jpacData.length;t++)this.jpacData[t].destroy(e);this.emitterManager.destroy(e)}}const G=s.mat4.create();class H{constructor(e,t){this.device=e,this.globals=t,this.renderTarget=new g.BasicRenderTarget,this.opaqueSceneTexture=new g.ColorTexture,this.rooms=[],this.roomLayerMask=0,this.cameraFrozen=!1,this.renderHelper=new p.GXRenderHelperGfx(e),this.renderHelper.renderInstManager.disableSimpleMode(),this.renderCache=this.renderHelper.renderInstManager.gfxRenderCache}setVisibleLayerMask(e){this.roomLayerMask=e}createPanels(){const e=new h.Panel;e.customHeaderBackgroundColor=h.COOL_BLUE_COLOR,e.setTitle(h.LAYER_ICON,"Layer Select");const t=new h.MultiSelect;t.onitemchanged=()=>{this.setVisibleLayerMask((()=>{let e=0;for(let a=0;a<t.getNumItems();a++)t.itemIsOn[a]&&(e|=1<<a);return e})())},t.setStrings(S.range(0,12).map(e=>`Layer ${e}`)),t.setItemsSelected(S.range(0,12).map(e=>0===e)),this.setVisibleLayerMask(1),e.contents.append(t.elem);const a=new h.LayerPanel;a.customHeaderBackgroundColor=h.COOL_BLUE_COLOR,a.setTitle(h.LAYER_ICON,"Rooms"),a.setLayers(this.rooms);const r=new h.Panel;r.customHeaderBackgroundColor=h.COOL_BLUE_COLOR,r.setTitle(h.RENDER_HACKS_ICON,"Render Hacks");const n=new h.Checkbox("Enable Vertex Colors",!0);n.onchanged=()=>{this.globals.renderHacks.vertexColorsEnabled=n.checked,this.globals.renderHacks.renderHacksChanged=!0},r.contents.appendChild(n.elem);const s=new h.Checkbox("Enable Textures",!0);s.onchanged=()=>{this.globals.renderHacks.texturesEnabled=s.checked,this.globals.renderHacks.renderHacksChanged=!0},r.contents.appendChild(s.elem);const i=new h.Checkbox("Enable Objects",!0);return i.onchanged=()=>{this.globals.renderHacks.objectsVisible=i.checked},r.contents.appendChild(i.elem),[a,e,r]}getRoomVisible(e){if(-1===e)return!0;for(let t=0;t<this.rooms.length;t++)if(this.rooms[t].roomNo===e)return this.rooms[t].visible;throw"whoops"}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst(),n=this.renderHelper.renderInstManager;this.time=a.time,this.cameraFrozen||(s.mat4.getTranslation(this.globals.cameraPosition,a.camera.worldMatrix),S.getMatrixAxisZ(this.globals.cameraFwd,a.camera.worldMatrix),s.vec3.negate(this.globals.cameraFwd,this.globals.cameraFwd),s.vec3.copy(this.globals.playerPosition,this.globals.cameraPosition));const i=this.globals.frameworkGlobals;for(let e=0;e<i.dwQueue.length;e++)for(let t=0;t<i.dwQueue[e].length;t++){const a=i.dwQueue[e][t];a instanceof M.fopAc_ac_c&&(a.visible=this.getRoomVisible(a.roomNo)&&(o=this.roomLayerMask,(l=a.roomLayer)<0||!!(o&1<<l)),a.visible&&!this.globals.renderHacks.objectsVisible&&444!==a.processName&&(a.visible=!1))}var o,l;this.globals.camera=a.camera,y.dKy_setLight(this.globals),m.fillSceneParamsDataOnTemplate(r,a),this.extraTextures.prepareToRender(e),M.fpcM_Management(this.globals.frameworkGlobals,this.globals,n,a);const c=this.globals.dlst;n.setCurrentRenderInstList(c.main[0]),this.effectSystem.calc(a),this.effectSystem.setOpaqueSceneTexture(this.opaqueSceneTexture.gfxTexture);for(let t=0;t<=1;t++){let r=null;1===t&&(r=G,u.texProjCameraSceneTex(r,a.camera,a.viewport,1)),this.effectSystem.setDrawInfo(a.camera.viewMatrix,a.camera.projectionMatrix,r),n.setCurrentRenderInstList(c.effect[t]),this.effectSystem.draw(e,this.renderHelper.renderInstManager,t)}this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t),this.globals.renderHacks.renderHacksChanged=!1}executeList(e,t,a,r){r.drawOnPassRenderer(e,t.gfxRenderCache,a)}executeListSet(e,t,a,r){this.executeList(e,t,a,r[0]),this.executeList(e,t,a,r[1])}render(e,t){const a=this.globals.dlst;this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.opaqueSceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight),a.peekZ.setParameters(e,this.renderTarget.depthStencilAttachment.width,this.renderTarget.depthStencilAttachment.height);const r=this.renderHelper.renderInstManager,n=e.createHostAccessPass();this.prepareToRender(e,n,t),e.submitPass(n);const s=this.renderTarget.createRenderPass(e,t.viewport,g.standardFullClearRenderPassDescriptor);this.executeListSet(e,r,s,a.sky),e.submitPass(s);const i=this.renderTarget.createRenderPass(e,t.viewport,g.depthClearRenderPassDescriptor,this.opaqueSceneTexture.gfxTexture);this.executeList(e,r,i,a.sea),this.executeListSet(e,r,i,a.main),this.executeList(e,r,i,a.effect[0]),this.executeList(e,r,i,a.wetherEffect),e.submitPass(i),a.peekZ.submitFrame(e,this.renderTarget.depthStencilAttachment.gfxAttachment),a.peekZ.peekData(e);const o=this.renderTarget.createRenderPass(e,t.viewport,g.noClearRenderPassDescriptor,t.onscreenTexture);return this.executeList(e,r,i,a.effect[1]),e.submitPass(o),a.reset(),r.resetRenderInsts(),null}destroy(e){this.renderHelper.destroy(e),this.opaqueSceneTexture.destroy(e),this.extraTextures.destroy(e),this.renderTarget.destroy(e),this.globals.destroy(e),null!==this.effectSystem&&this.effectSystem.destroy(e),this.globals.frameworkGlobals.delete(this.globals)}}t.WindWakerRenderer=H;class j{constructor(e,t,a){this.device=e,this.dataFetcher=t,this.yaz0Decompressor=a,this.filePromiseCache=new Map,this.fileDataCache=new Map,this.archivePromiseCache=new Map,this.archiveCache=new Map,this.cache=new _.GfxRenderCache,this.resCtrl=new x.dRes_control_c,this.onloadedcallback=null}waitForLoad(){const e=[...this.filePromiseCache.values(),...this.archivePromiseCache.values()];return Promise.all(e)}fetchFile(e,t=0){i.assert(!this.filePromiseCache.has(e));let a=e;t>0&&(a=`${e}?cache_bust=${t}`);const r=this.dataFetcher.fetchData(a,0,()=>{this.filePromiseCache.delete(e)});return this.filePromiseCache.set(e,r),r}fetchFileData(e,t=0){const a=this.filePromiseCache.get(e);return void 0!==a?a.then(()=>this.getFileData(e)):this.fetchFile(e,t).then(t=>(this.fileDataCache.set(e,t),null!==this.onloadedcallback&&this.onloadedcallback(),t))}getFileData(e){return i.assertExists(this.fileDataCache.get(e))}async requestArchiveDataInternal(e){let t=await this.dataFetcher.fetchData(e);"Yaz0"===i.readString(t,0,4)&&(t=c.decompressSync(this.yaz0Decompressor,t));const a=l.parse(t,this.yaz0Decompressor);return this.archiveCache.set(e,a),a}fetchArchive(e){if(this.archivePromiseCache.has(e))return this.archivePromiseCache.get(e);const t=this.requestArchiveDataInternal(e);return this.archivePromiseCache.set(e,t),t}setCurrentStage(e){this.currentStage=e,this.resCtrl.destroyList(this.device,this.resCtrl.resStg)}async fetchObjectData(e){const a=await this.fetchArchive(`${t.pathBase}/Object/${e}.arc`);return this.resCtrl.mountRes(this.device,this.cache,e,a,this.resCtrl.resObj),a}requestObjectData(e){const a=`${t.pathBase}/Object/${e}.arc`;return this.archiveCache.has(a)?3:(this.archivePromiseCache.has(a)||this.fetchObjectData(e),1)}async fetchStageData(e){const a=await this.fetchArchive(`${t.pathBase}/Stage/${this.currentStage}/${e}.arc`);this.resCtrl.mountRes(this.device,this.cache,e,a,this.resCtrl.resStg)}destroy(e){this.cache.destroy(e),this.resCtrl.destroy(e)}}t.ModelCache=j,t.pathBase="j3d/ww";class W extends M.fopScn{constructor(){super(...arguments),this.bgS=new I.dBgS,this.vrboxLoaded=!1}load(e,t){return super.load(e,t),this.treePacket=new w.TreePacket(e),this.flowerPacket=new w.FlowerPacket(e),this.grassPacket=new w.GrassPacket(e),e.scnPlay=this,3}draw(e,t,a){super.draw(e,t,a);const r=a.time/1e3*30;this.flowerPacket.calc(r),this.treePacket.calc(r),this.grassPacket.calc(r),this.flowerPacket.update(e),this.treePacket.update(e),this.grassPacket.update(e),M.fopDw_Draw(e.frameworkGlobals,e,t,a),this.flowerPacket.draw(e,t,a),this.treePacket.draw(e,t,a),this.grassPacket.draw(e,t,a)}delete(e){super.delete(e);const t=e.modelCache.device;this.flowerPacket.destroy(t),this.treePacket.destroy(t),this.grassPacket.destroy(t)}}class Z{constructor(e,t,a=[0]){this.stageDir=e,this.name=t,this.rooms=a,this.id=e,"sea"===this.stageDir&&1===a.length&&(this.id=`Room${a[0]}.arc`)}async createScene(e,a){const r=await a.dataShare.ensureObject(`${t.pathBase}/ModelCache`,async()=>{const e=await c.decompressor();return new j(a.device,a.dataFetcher,e)});r.onloadedcallback=null,r.setCurrentStage(this.stageDir),r.fetchObjectData("System"),r.fetchObjectData("Always"),r.fetchStageData("Stage"),r.fetchFileData(`${t.pathBase}/extra.crg1_arc`,6),r.fetchFileData(`${t.pathBase}/f_pc_profiles.crg1_arc`);const n=[`${t.pathBase}/Particle/common.jpc`];for(let e=0;e<n.length;e++)r.fetchFileData(n[e]);for(let e=0;e<this.rooms.length;e++){const t=Math.abs(this.rooms[e]);r.fetchStageData(`Room${t}`)}await r.waitForLoad();const s=o.parse(r.getFileData(`${t.pathBase}/f_pc_profiles.crg1_arc`),1),l=new M.fGlobals(s);M.fpcPf__Register(l,7,W),y.dKy__RegisterConstructors(l),C.dKyw__RegisterConstructors(l),U.d_a__RegisterConstructors(l),k.LegacyActor__RegisterFallbackConstructor(l);const h=o.parse(r.getFileData(`${t.pathBase}/extra.crg1_arc`),1),u=new P(r,h,l);u.stageName=this.stageDir;const m=new H(e,u);a.destroyablePool.push(m),u.renderer=m,r.onloadedcallback=()=>{M.fpcCt_Handler(u.frameworkGlobals,u)};const p=M.fpcSCtRq_Request(l,null,7,null);i.assert(p),M.fpcCt_Handler(u.frameworkGlobals,u),i.assert(void 0!==u.scnPlay),M.fpcLy_SetCurrentLayer(u.frameworkGlobals,u.scnPlay.layer);const f=r.resCtrl,A=i.assertExists(f.findResInfo("System",f.resObj)),g=A.getResByIndex(7,3),_=A.getResByIndex(7,4),S=i.assertExists(f.getStageResByName(9,"Stage","stage.dzs"));T.dStage_dt_c_stageInitLoader(u,u.dStage_dt,S),T.dStage_dt_c_stageLoader(u,u.dStage_dt,S),1===this.rooms.length&&(u.mStayNo=Math.abs(this.rooms[0])),m.extraTextures=new V(e,g,_);const b=[];for(let e=0;e<n.length;e++){const t=r.getFileData(n[e]);b.push(d.parse(t))}m.effectSystem=new L(e,b),y.dKankyo_create(u),null!==f.getStageResByName(0,"Stage","vr_sky.bdl")&&(M.fpcSCtRq_Request(l,null,442,null),M.fpcSCtRq_Request(l,null,443,null));for(let e=0;e<this.rooms.length;e++){const t=Math.abs(this.rooms[e]),a=this.rooms[e]>=0;m.rooms.push(new O(t,a)),M.fopAcM_create(l,444,t,null,t,null,null,255,-1);const r=i.assertExists(f.getStageResByName(9,`Room${t}`,"room.dzr"));T.dStage_dt_c_roomLoader(u,u.roomStatus[t],r),T.dStage_dt_c_roomReLoader(u,u.roomStatus[t],r)}return m}}const z=["The Great Sea",new Z("sea","The Great Sea",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49]),new Z("Asoko","Tetra's Ship"),new Z("Abship","Submarine"),new Z("Abesso","Cabana"),new Z("Ocean","Boating Course"),new Z("ShipD","Islet of Steel"),new Z("PShip","Ghost Ship"),new Z("Obshop","Beedle's Shop",[1]),"Outset Island",new Z("sea","Outset Island",[44]),new Z("LinkRM","Link's House"),new Z("LinkUG","Under Link's House"),new Z("A_mori","Forest of Fairies"),new Z("Ojhous","Orca's House",[0]),new Z("Omasao","Mesa's House"),new Z("Onobuta","Abe and Rose's House"),new Z("Pjavdou","Jabun's Cavern"),"Forsaken Fortress",new Z("MajyuE","Forsaken Fortress Exterior (First Visit)"),new Z("majroom","Interior (First Visit)",[0,1,2,3,4]),new Z("ma2room","Interior (Second Visit)",[0,1,2,3,4]),new Z("ma3room","Interior (Third  Visit)",[0,1,2,3,4]),new Z("Mjtower","The Tower (First Visit)"),new Z("M2tower","The Tower (Second Visit)"),new Z("M2ganon","Ganondorf's Room"),"Windfall Island",new Z("sea","Windfall Island",[11]),new Z("Kaisen","Battleship Game Room"),new Z("Nitiyou","School of Joy"),new Z("Obombh","Bomb Shop"),new Z("Ocmera","Lenzo's House"),new Z("Opub","Cafe Bar"),new Z("Orichh","House of Wealth"),new Z("Pdrgsh","Chu Jelly Juice Shop"),new Z("Pnezumi","Jail"),"Dragon Roost",new Z("sea","Dragon Roost Island",[13]),new Z("Adanmae","Pond"),new Z("Comori","Komali's Room"),new Z("Atorizk","Postal Service"),new Z("M_NewD2","Dragon Roost Cavern",[0,1,2,-3,4,-5,6,7,8,10,11,12,13,14,15,16]),new Z("M_DragB","Boss Room"),new Z("M_Dra09","Mini Boss Room",[9]),"Forest Haven",new Z("sea","Forest Haven Island",[41]),new Z("Omori","Forest Haven Interior"),new Z("Ocrogh","Potion Room"),new Z("Otkura","Makar's Hiding Place"),"Forbidden Woods",new Z("kindan","Forbidden Woods",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),new Z("kinBOSS","Boss Room"),new Z("kinMB","Mini Boss Room",[10]),"Tower of the Gods",new Z("Siren","Tower of the Gods",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,-15,16,17,-18,19,20,21,22,-23]),new Z("SirenB","Boss Room"),new Z("SirenMB","Mini Boss Room",[23]),"Hyrule",new Z("Hyrule","Hyrule Field"),new Z("Hyroom","Hyrule Castle"),new Z("kenroom","Master Sword Chamber"),"Earth Temple",new Z("Edaichi","Entrance"),new Z("M_Dai","Earth Temple",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),new Z("M_DaiB","Boss Room"),new Z("M_DaiMB","Mini Boss Room",[12]),"Wind Temple",new Z("Ekaze","Wind Temple Entrance"),new Z("kaze","Wind Temple",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),new Z("kazeB","Boss Room"),new Z("kazeMB","Mini Boss Room",[6]),"Ganon's Tower",new Z("GanonA","Entrance"),new Z("GanonB","Room Towards Gohma"),new Z("GanonC","Room Towards Molgera"),new Z("GanonD","Room Towards Kalle Demos"),new Z("GanonE","Room Towards Jalhalla"),new Z("GanonJ","Phantom Ganon's Maze"),new Z("GanonK","Puppet Ganon Fight"),new Z("GanonL","Staircase Towards Puppet Ganon"),new Z("GanonM","Main Room"),new Z("GanonN","Starcase to Main Room"),new Z("GTower","Tower"),new Z("Xboss0","Gohma Refight"),new Z("Xboss1","Kalle Demos Refight"),new Z("Xboss2","Jalhalla Refight"),new Z("Xboss3","Molgera Refight"),"Grottos and Caverns",new Z("Cave01","Bomb Island",[0,1]),new Z("Cave02","Star Island"),new Z("Cave03","Cliff Plateau Isles"),new Z("Cave04","Rock Spire Isle"),new Z("Cave05","Horseshoe Island"),new Z("Cave07","Pawprint Isle Wizzrobe"),new Z("ITest63","Shark Island"),new Z("MiniHyo","Ice Ring Isle"),new Z("MiniKaz","Fire Mountain"),new Z("SubD42","Needle Rock Isle"),new Z("SubD43","Angular Isles"),new Z("SubD71","Boating Course"),new Z("TF_01","Stone Watcher Island",[0,1,2,3,4,5,6]),new Z("TF_02","Overlook Island",[0,1,2,3,4,5,6]),new Z("TF_03","Birds Peak Rock",[0,-1,-2,-3,-4,-5,-6]),new Z("TF_04","Cabana Maze"),new Z("TF_06","Dragon Roost Island"),new Z("TyuTyu","Pawprint Isle Chuchu"),new Z("WarpD","Diamond Steppe Island"),"Savage Labryinth",new Z("Cave09","Entrance",[0]),new Z("Cave10","Room 11"),new Z("Cave11","Room 32"),new Z("Cave06","End"),"Great Fairy Fountains",new Z("Fairy01","North Fairy Fountain"),new Z("Fairy02","East Fairy Fountain"),new Z("Fairy03","West Fairy Fountain"),new Z("Fairy04","Forest of Fairies"),new Z("Fairy05","Thorned Fairy Fountain"),new Z("Fairy06","South Fairy Fountain"),"Nintendo Gallery",new Z("Pfigure","Main Room"),new Z("figureA","Great Sea"),new Z("figureB","Windfall Island"),new Z("figureC","Outset Island"),new Z("figureD","Forsaken Fortress"),new Z("figureE","Secret Cavern"),new Z("figureF","Dragon Roost Island"),new Z("figureG","Forest Haven"),"Unused Test Maps",new Z("Cave08","Early Wind Temple",[1,2,3]),new Z("H_test","Pig Chamber"),new Z("Ebesso","Island with House"),new Z("KATA_HB","Bridge Room"),new Z("KATA_RM","Large Empty Room"),new Z("Msmoke","Smoke Test Room",[0,1]),new Z("Mukao","Early Headstone Island"),new Z("tincle","Tingle's Room"),new Z("VrTest","Early Environment Art Test"),new Z("Ojhous2","Early Orca's House",[0,1]),new Z("SubD44","Early Stone Watcher Island Cavern",[0,1,2,3,4,5,6]),new Z("SubD51","Early Bomb Island Cavern",[0,1]),new Z("TF_07","Stone Watcher Island Scenario Test",[1]),new Z("TF_05","Early Battle Grotto",[0,1,2,3,4,5,6]),new Z("sea_T","sea_T"),new Z("sea_E","sea_E"),new Z("ITest61","ITest61"),new Z("ITest62","ITest62"),new Z("K_Test2","K_Test2"),new Z("K_Test3","K_Test3"),new Z("K_Test4","K_Test4"),new Z("K_Test5","K_Test5"),new Z("K_Test6","K_Test6"),new Z("K_Test8","K_Test8"),new Z("K_Test9","K_Test9"),new Z("K_Testa","K_Testa"),new Z("K_Testb","K_Testb"),new Z("K_Testc","K_Testc"),new Z("K_Testd","K_Testd"),new Z("K_Teste","K_Teste")];t.sceneGroup={id:"zww",name:"The Legend of Zelda: The Wind Waker",sceneDescs:z}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(2),n=a(0),s=a(1),i=a(65),o=a(106),l=a(5),c=a(34),h=a(61),d=a(4),u=a(105),m=s.vec2.create(),p=s.vec2.create(),f=s.vec2.create();class A{parse(e){const t=e.createDataView();return this.height=t.getFloat32(0),this.km=t.getFloat32(4),this.phase=t.getInt16(8),this.thetaScaleX=t.getFloat32(12),this.thetaScaleZ=t.getFloat32(16),this.counterMax=t.getUint32(20),24}}class g{constructor(e){this.waveParam=n.nArray(4,()=>new A),this.counters=n.nArray(4,()=>0),this.curScale=1;const t=e.findExtraSymbolData("d_a_sea.o","wi_prm_ocean");let a=0;for(let e=0;e<4;e++)a+=this.waveParam[e].parse(t.slice(a))}AddCounter(e){for(let t=0;t<this.counters.length;t++)this.counters[t]=(this.counters[t]+e)%this.waveParam[t].counterMax}GetRatio(e){return this.counters[e]/this.waveParam[e].counterMax}GetKm(e){return 6.283*this.waveParam[e].km}GetScale(e){return this.curScale+=(e-this.curScale)/100,this.curScale}}class _{constructor(){this.height=n.nArray(81,()=>-1)}get_wave_max(e,t){const a=e.dStage_dt.mult;if(null!==a)for(let e=0;e<a.length;e++)if(a[e].roomNo===t)return a[e].waveMax;return 10}SetInf(e){let t=1;for(let a=1;a<8;a++)for(let r=1;r<8;r++)this.height[9*a+r]=this.get_wave_max(e,t++)}Pos2Index(e){return(e+45e4)/1e5|0}calcMinMax(e,t){e[0]=1e5*t-45e4,e[1]=1e5+e[0]}GetArea(e,t,a,r){this.calcMinMax(a,e);const n=a[0],s=a[1];this.calcMinMax(a,t);const i=a[0],o=a[1];a[0]=n,a[1]=i,r[0]=s,r[1]=o}GetHeightIdx(e,t,a){if(t<0||t>8||a<0||a>8)return 10;const r=e.dStage_dt.stag.roomTypeAndSchBit>>>16&7,n=e.renderer.rooms.length>1;return 7===r&&n?this.height[9*a+t]:this.get_wave_max(e,e.mStayNo)}GetHeightPos(e,t,a){const r=this.Pos2Index(t),n=this.Pos2Index(a);return this.GetHeightIdx(e,r,n)}}function S(e,t,a){const r=a[0],s=a[1],i=e[0],o=e[1],l=t[0],c=t[1],h=r>=i,d=r<=l,u=s>=o,m=s<=c;return h&&d&&u&&m?0:h&&d?u?s-c:o-s:u&&m?h?r-l:i-r:(n.assert(h!==d),n.assert(u!==m),h&&u?Math.hypot(r-l,s-c):h?Math.hypot(r-l,s-o):u?Math.hypot(r-i,s-c):Math.hypot(r-i,s-o))}const b=new l.MaterialParams,v=new l.PacketParams;class w extends i.fopAc_ac_c{constructor(){super(...arguments),this.waterHeightMng=new _,this.baseHeight=0,this.playerPos=s.vec3.create(),this.idxX=-1,this.idxZ=-1,this.flatFlag=!1,this.flatInter=0,this.flatInterCounter=0,this.flatTarget=0,this.drawMinX=-1,this.drawMaxX=-1,this.drawMinZ=-1,this.drawMaxZ=-1,this.cullStopFlag=!1,this.heightTable=new Float32Array(4225),this.animCounter=0,this.ddraw=new o.TDDraw,this.pos_around=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]],this.scratchThetaX=n.nArray(4,()=>0),this.scratchThetaZ=n.nArray(4,()=>0),this.scratchOffsAnim=n.nArray(4,()=>0),this.scratchHeight=n.nArray(4,()=>0),this.fadeTable=n.nArray(65,()=>0),this.copyPos=!0}subload(e){this.waveInfo=new g(e);const t=e.resCtrl;this.texSeaBTI=t.getObjectRes(7,"Always",111),this.texWyurayura=t.getObjectRes(7,"Always",112),this.baseHeight=1+this.pos[1],this.waterHeightMng.SetInf(e),this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1);const a=new c.GXMaterialBuilder("d_a_sea");return a.setCullMode(2),a.setTexCoordGen(0,1,4,30),a.setTexCoordGen(1,1,4,33),a.setTexCoordGen(2,1,4,36),a.setTevOrder(0,0,0,7),a.setTevColorIn(0,2,14,8,15),a.setTevColorOp(0,0,0,0,!0,3),a.setTevAlphaIn(0,7,6,4,7),a.setTevAlphaOp(0,0,0,0,!0,0),a.setTevOrder(1,2,2,7),a.setTevColorIn(1,2,14,8,15),a.setTevColorOp(1,0,0,0,!0,0),a.setTevAlphaIn(1,0,7,7,7),a.setTevAlphaOp(1,0,0,0,!0,0),a.setTevOrder(2,255,255,7),a.setTevColorIn(2,0,6,1,15),a.setTevColorOp(2,0,0,0,!0,0),a.setTevAlphaIn(2,7,6,0,7),a.setTevAlphaOp(2,0,0,0,!0,0),a.setIndTexOrder(0,1,1),a.setTevIndWarp(0,0,!0,!1,1),a.setAlphaCompare(7,0,1,7,0),a.setZMode(!0,3,!0),a.setBlendMode(0,0,0),a.setFog(2,!0),a.setTevKColorSel(0,12),a.setTevKColorSel(1,13),this.materialHelper=new l.GXMaterialHelperGfx(a.finish()),2}ClrFlat(){this.flatFlag=!1,this.flatInterCounter=150}SetFlat(){this.flatFlag=!0,this.flatInterCounter=150}CheckRoomChange(e){this.roomNo=e.mStayNo;this.flatFlag&&this.ClrFlat()}CalcFlatInterTarget(e,t){let a=this.waterHeightMng.GetHeightIdx(e,this.idxX,this.idxZ);if(0!==a){a=1,f[0]=t[0],f[1]=t[2];for(let t=0;t<8;t++){const r=this.idxX+this.pos_around[t][0],n=this.idxZ+this.pos_around[t][1];if(0===this.waterHeightMng.GetHeightIdx(e,r,n)){this.waterHeightMng.GetArea(r,n,m,p),m[0]-=12800,m[1]-=12800,p[0]+=12800,p[1]+=12800;const e=S(m,p,f)/12800;e<a&&(a=e)}}}return a}CalcFlatInter(e){const t=this.flatFlag?this.flatTarget:this.CalcFlatInterTarget(e,this.playerPos);0===this.flatInterCounter?this.flatInter=t:(this.flatInter+=(t-this.flatInter)/this.flatInterCounter,this.flatInterCounter--)}SetCullStopFlag(e){if("A_umikz"===e.stageName)this.cullStopFlag=!1;else{if(0===this.waterHeightMng.GetHeightIdx(e,this.idxX,this.idxZ)){this.waterHeightMng.GetArea(this.idxX,this.idxZ,m,p);const e=this.playerPos[0],t=this.playerPos[2],a=m[0],r=m[1],n=p[0],s=p[1];this.cullStopFlag=!(e<=a+25600||e>=n-25600||t<=r+25600||t>=s-25600)}else this.cullStopFlag=!1}}draw(e,t,a){t.setCurrentRenderInstList(e.dlst.sea),this.ddraw.beginDraw();if(!this.cullStopFlag)for(let e=0;e<64;e++){const t=this.drawMinZ+800*e,a=t+800;this.ddraw.begin(152);const r=5e-4*t,n=5e-4*a;for(let s=0;s<65;s++){const i=this.drawMinX+800*s,o=this.heightTable[65*(e+0)+s],l=this.heightTable[65*(e+1)+s],c=5e-4*i;this.ddraw.position3f32(i,l,a),this.ddraw.texCoord2f32(13,c,n),this.ddraw.position3f32(i,o,t),this.ddraw.texCoord2f32(13,c,r)}this.ddraw.end()}if(this.drawMinZ>-45e4){const e=-45e4,t=45e4,a=-45e4,r=this.drawMinZ;this.ddraw.begin(152),this.ddraw.position3f32(e,this.baseHeight,r),this.ddraw.texCoord2f32(13,5e-4*e,5e-4*r),this.ddraw.position3f32(e,this.baseHeight,a),this.ddraw.texCoord2f32(13,5e-4*e,5e-4*a),this.ddraw.position3f32(t,this.baseHeight,r),this.ddraw.texCoord2f32(13,5e-4*t,5e-4*r),this.ddraw.position3f32(t,this.baseHeight,a),this.ddraw.texCoord2f32(13,5e-4*t,5e-4*a),this.ddraw.end()}if(this.drawMaxZ<45e4){const e=-45e4,t=45e4,a=this.drawMaxZ,r=45e4;this.ddraw.begin(152),this.ddraw.position3f32(e,this.baseHeight,r),this.ddraw.texCoord2f32(13,5e-4*e,5e-4*r),this.ddraw.position3f32(e,this.baseHeight,a),this.ddraw.texCoord2f32(13,5e-4*e,5e-4*a),this.ddraw.position3f32(t,this.baseHeight,r),this.ddraw.texCoord2f32(13,5e-4*t,5e-4*r),this.ddraw.position3f32(t,this.baseHeight,a),this.ddraw.texCoord2f32(13,5e-4*t,5e-4*a),this.ddraw.end()}if(this.drawMinZ>-45e4&&this.drawMaxZ<45e4){const e=this.drawMinZ,t=this.drawMaxZ;if(this.drawMinX>-45e4){const a=-45e4,r=this.drawMinX;this.ddraw.begin(152),this.ddraw.position3f32(a,this.baseHeight,t),this.ddraw.texCoord2f32(13,5e-4*a,5e-4*t),this.ddraw.position3f32(a,this.baseHeight,e),this.ddraw.texCoord2f32(13,5e-4*a,5e-4*e),this.ddraw.position3f32(r,this.baseHeight,t),this.ddraw.texCoord2f32(13,5e-4*r,5e-4*t),this.ddraw.position3f32(r,this.baseHeight,e),this.ddraw.texCoord2f32(13,5e-4*r,5e-4*e),this.ddraw.end()}if(this.drawMaxX<45e4){const a=this.drawMaxX,r=45e4;this.ddraw.begin(152),this.ddraw.position3f32(a,this.baseHeight,t),this.ddraw.texCoord2f32(13,5e-4*a,5e-4*t),this.ddraw.position3f32(a,this.baseHeight,e),this.ddraw.texCoord2f32(13,5e-4*a,5e-4*e),this.ddraw.position3f32(r,this.baseHeight,t),this.ddraw.texCoord2f32(13,5e-4*r,5e-4*t),this.ddraw.position3f32(r,this.baseHeight,e),this.ddraw.texCoord2f32(13,5e-4*r,5e-4*e),this.ddraw.end()}}const n=e.modelCache.device,i=this.materialHelper;r.computeModelMatrixS(b.u_TexMtx[0],1.5,1.5,1),r.computeModelMatrixSRT(b.u_TexMtx[1],1,1,1,0,0,0,0,this.animCounter/300,0),r.computeModelMatrixSRT(b.u_TexMtx[2],1,1,1,0,0,0,.2,.2,0),r.computeModelMatrixS(b.u_IndTexMtx[0],.3,.3,.3);const o=e.g_env_light,c=b.u_Color[l.ColorKind.K3],u=b.u_Color[l.ColorKind.C0];h.dKy_get_seacolor(o,c,u);const m=this.flatInter*this.flatInter;d.colorLerp(b.u_Color[l.ColorKind.K0],u,c,m),d.colorLerp(b.u_Color[l.ColorKind.K1],d.OpaqueBlack,u,1-.1*m),this.texSeaBTI.fillTextureMapping(b.m_TextureMapping[0]),b.m_TextureMapping[0].lodBias=-.9,this.texWyurayura.fillTextureMapping(b.m_TextureMapping[1]),this.texSeaBTI.fillTextureMapping(b.m_TextureMapping[2]),b.m_TextureMapping[2].lodBias=1,h.dKy_GxFog_sea_set(o,b.u_FogBlock,a.camera);const p=this.ddraw.endDraw(n,t);i.setOnRenderInst(n,t.gfxRenderCache,p),p.setSamplerBindingsFromTextureMappings(b.m_TextureMapping);const f=i.allocateMaterialParams(p);i.fillMaterialParamsDataOnInst(p,f,b),p.allocateUniformBuffer(l.ub_PacketParams,l.u_PacketParamsBufferSize),s.mat4.copy(v.u_PosMtx[0],a.camera.viewMatrix),l.fillPacketParamsData(p.mapUniformBufferF32(l.ub_PacketParams),p.getUniformBufferOffset(l.ub_PacketParams),v),t.submitRenderInst(p)}execute(e,t){this.copyPos&&s.vec3.copy(this.playerPos,e.playerPosition),this.idxX=this.waterHeightMng.Pos2Index(this.playerPos[0]),this.idxZ=this.waterHeightMng.Pos2Index(this.playerPos[2]),"ADMumi"===e.stageName&&(this.flatInter=0);const a=e.renderer.rooms.length>1;if("sea"===e.stageName&&a){const t=r.clamp(7*(this.idxZ-1)+this.idxX,1,49);e.mStayNo=t}if(this.roomNo!==e.mStayNo&&0!==e.mStayNo&&this.CheckRoomChange(e),this.CalcFlatInter(e),u.dKy_usonami_set(e,this.flatInter),this.drawMinX=this.playerPos[0]-25600,this.drawMaxX=this.playerPos[0]+25600,this.drawMinZ=this.playerPos[2]-25600,this.drawMaxZ=this.playerPos[2]+25600,this.SetCullStopFlag(e),this.cullStopFlag)return;const n=this.waterHeightMng.GetHeightPos(e,this.playerPos[0],this.playerPos[2]),i=r.lerp(1,2,r.saturate(r.invlerp(1e3,5e3,this.playerPos[1]))),o=this.waveInfo.GetScale(n)*this.flatInter*i;for(let e=0;e<4;e++){const t=this.waveInfo.waveParam[e],a=this.waveInfo.GetKm(e);this.scratchThetaX[e]=t.thetaScaleX*a,this.scratchThetaZ[e]=t.thetaScaleZ*a,this.scratchOffsAnim[e]=6.283*(this.waveInfo.GetRatio(e)-.5),this.scratchHeight[e]=t.height*o}this.fadeTable.fill(1),this.fadeTable[64]=0,this.fadeTable[0]=0,this.fadeTable[63]=1/6,this.fadeTable[1]=1/6,this.fadeTable[62]=2/6,this.fadeTable[2]=2/6,this.fadeTable[61]=.5,this.fadeTable[3]=.5,this.fadeTable[60]=4/6,this.fadeTable[4]=4/6,this.fadeTable[59]=5/6,this.fadeTable[5]=5/6;const l=800+this.drawMinX,c=800+this.drawMinZ;let h=this.scratchThetaX[0]*l+(this.scratchThetaZ[0]*c-this.scratchOffsAnim[0])+this.waveInfo.waveParam[0].phase,d=this.scratchThetaX[1]*l+(this.scratchThetaZ[1]*c-this.scratchOffsAnim[1])+this.waveInfo.waveParam[1].phase,m=this.scratchThetaX[2]*l+(this.scratchThetaZ[2]*c-this.scratchOffsAnim[2])+this.waveInfo.waveParam[2].phase,p=this.scratchThetaX[3]*l+(this.scratchThetaZ[3]*c-this.scratchOffsAnim[3])+this.waveInfo.waveParam[3].phase,f=65;for(let e=1;e<64;e++){let t=h,a=d,r=m,n=p;for(let s=0;s<64;s++)this.heightTable[f++]=(this.baseHeight+this.scratchHeight[0]*Math.cos(t)+this.scratchHeight[1]*Math.cos(a)+this.scratchHeight[2]*Math.cos(r)+this.scratchHeight[3]*Math.cos(n))*this.fadeTable[e]*this.fadeTable[s],t+=800*this.scratchThetaX[0],a+=800*this.scratchThetaX[1],r+=800*this.scratchThetaX[2],n+=800*this.scratchThetaX[3];h+=800*this.scratchThetaZ[0],d+=800*this.scratchThetaZ[1],m+=800*this.scratchThetaZ[2],p+=800*this.scratchThetaZ[3],f++}this.waveInfo.AddCounter(t),this.animCounter+=t}delete(e){const t=e.modelCache.device;this.ddraw.destroy(t)}}t.d_a_sea=w,w.PROCESS_NAME=40},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=a(25),i=a(0),o=r(a(18)),l=a(12),c=a(2),h=a(61),d=a(65),u=a(8),m=a(91),p=a(140),f=n.mat4.create(),A=n.vec3.create();function g(e){const t=new o.default;return t.setTimeInFrames(e),t}const _=new m.cBgS_GndChk;class S extends d.fopAc_ac_c{constructor(){super(...arguments),this.phase=0,this.objectRenderers=[]}subload(e,t){return 0===this.phase&&(this.phase=1,function(e,t,a){const r=e.modelCache,o=e.renderer,d=r.resCtrl,u=e.dStage__searchNameRev(t.processName,t.subtype);if(null===u)throw new Error("wtf! could not find actor name");const m=[];function S(e){const t=r.fetchObjectData(e);return m.push(t),t}function b(e,t,a){const r=i.assertExists(d.findResInfoByArchive(t,d.resObj));return i.assertExists(r.res.find(e=>a.endsWith(e.file.name))).res}function v(e){const t=new s.J3DModelInstanceSimple(e);p.initModelForZelda(t),o.extraTextures.fillExtraTextures(t),t.name=u,t.setSortKeyLayer(33);const r=new w(t);return h.dKy_tevstr_init(r.tevstr,a.roomNo),r.layer=a.layer,r}function x(e,t){return v(b(0,e,t))}function T(e){!function(e,t){const a=t.rot[1]/32767*Math.PI;c.computeModelMatrixSRT(e,t.scale[0],t.scale[1],t.scale[2],0,a,0,t.pos[0],t.pos[1],t.pos[2])}(e,a)}function y(e,a){const r=x(e,a);return T(r.modelMatrix),t.objectRenderers.push(r),r}function C(e){const a=v(e);return T(a.modelMatrix),t.objectRenderers.push(a),a}function M(e,t,a){const r=y(e,t);return r.modelInstance.setModelMaterialData(b(0,e,a)),o.extraTextures.fillExtraTextures(r.modelInstance),r}function U(t,a){_.Reset(),n.mat4.getTranslation(_.pos,a),_.pos[1]+=10;const r=e.scnPlay.bgS.GroundCross(_);t[13]=r}function k(e,t){const a=i.assertExists(d.findResInfoByArchive(e,d.resObj)),r=a.lazyLoadResource(2,i.assertExists(a.res.find(e=>t.endsWith(e.file.name))));return r.loopMode=2,r}function D(e,t){const a=i.assertExists(d.findResInfoByArchive(e,d.resObj));return a.lazyLoadResource(4,i.assertExists(a.res.find(e=>t.endsWith(e.file.name))))}function I(e,t){const a=i.assertExists(d.findResInfoByArchive(e,d.resObj));return a.lazyLoadResource(6,i.assertExists(a.res.find(e=>t.endsWith(e.file.name))))}function R(e,t){return e.effectSystem.createBaseEmitter(e.device,e.renderCache,t)}const B=i.assertExists(e.dStage_searchName(u));if(294===B.pcName)S("Dalways").then(()=>{const t=a.parameters>>>20&15;if(0===t){C(e.resCtrl.getObjectRes(0,"Dalways",14))}else if(1===t){C(e.resCtrl.getObjectRes(0,"Dalways",15))}else if(2===t){const t=C(e.resCtrl.getObjectRes(0,"Dalways",16)),a=e.resCtrl.getObjectRes(4,"Dalways",29);a.loopMode=0,t.bindTRK1(a)}else if(3===t){C(e.resCtrl.getObjectRes(0,"Dalways",20))}else console.warn(`Unknown chest type: ${u} / Room ${a.roomNo} Layer ${a.layer} / ${i.hexzero(a.parameters,8)}`)});else if("item"===u){const e=255&a.parameters;0===e?S("Always").then(e=>y(e,"bdl/vhrtl.bdl")):1===e?S("Always").then(e=>{const t=y(e,"bdlm/vlupl.bdl");t.bindTRK1(D(e,"brk/vlupl.brk"),g(0)),t.bindTTK1(I(e,"btk/vlupl.btk"))}):2===e?S("Always").then(e=>{const t=y(e,"bdlm/vlupl.bdl");t.bindTRK1(D(e,"brk/vlupl.brk"),g(1)),t.bindTTK1(I(e,"btk/vlupl.btk"))}):3===e?S("Always").then(e=>{const t=y(e,"bdlm/vlupl.bdl");t.bindTRK1(D(e,"brk/vlupl.brk"),g(2)),t.bindTTK1(I(e,"btk/vlupl.btk"))}):4===e?S("Always").then(e=>{const t=y(e,"bdlm/vlupl.bdl");t.bindTRK1(D(e,"brk/vlupl.brk"),g(3)),t.bindTTK1(I(e,"btk/vlupl.btk"))}):5===e?S("Always").then(e=>{const t=y(e,"bdlm/vlupl.bdl");t.bindTRK1(D(e,"brk/vlupl.brk"),g(4)),t.bindTTK1(I(e,"btk/vlupl.btk"))}):9===e?S("Always").then(e=>y(e,"bdlm/mpoda.bdl")):10===e?S("Always").then(e=>y(e,"bdlm/mpodb.bdl")):21===e?S("Always").then(e=>y(e,"bdl/vkeyl.bdl")):31===e?S("Always").then(e=>y(e,"bdl/vhapl.bdl")):console.warn(`Unknown item: ${i.hexzero(e,2)}`)}else if("Bitem"===u)S("Always").then(e=>y(e,"bdlm/vhutl.bdl").bindTTK1(I(e,"btk/vhutl.btk")));else if("Warpmj"===u)S("Gmjwp").then(e=>{y(e,"bdlm/gmjwp00.bdl").bindTTK1(I(e,"btk/gmjwp00.btk"))});else if("Ls"===u||"Ls1"===u)S("Ls").then(e=>{const t=y(e,"bdlm/ls.bdl");x(e,"bdl/lshand.bdl").setParentJoint(t,"handL"),x(e,"bdl/lshand.bdl").setParentJoint(t,"handR"),t.bindANK1(k(e,"bcks/ls_wait01.bck"))});else if("Bs1"===u)S("Bs").then(e=>{y(e,"bdlm/bs.bdl").bindANK1(k(e,"bcks/bs_wait01.bck"))});else if("Bs2"===u)S("Bs").then(e=>{const t=y(e,"bdlm/bs.bdl");x(e,"bdlm/bs_met.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/bs_wait01.bck"))});else if("Tc"===u)S("Tc").then(e=>y(e,"bdlm/tc.bdl").bindANK1(k(e,"bcks/wait01.bck")));else if("Ba1"===u)3===a.parameters&&S("Ba").then(e=>{y(e,"bdlm/ba.bdl").bindANK1(k(e,"bcks/wait02.bck"))});else if("Kg1"===u||"Kg2"===u)S("Kg").then(e=>y(e,"bdlm/kg.bdl").bindANK1(k(e,"bcks/kg_wait01.bck")));else if("Ji1"===u)S("Ji").then(e=>y(e,"bdlm/ji.bdl").bindANK1(k(e,"bck/ji_wait01.bck")));else if("Md1"===u)S("Md").then(e=>{const t=y(e,"bdlm/md.bdl");t.bindANK1(k(e,"bcks/md_wait01.bck"));const a=x(e,"bdlm/mdarm.bdl");a.bindANK1(k(e,"bcks/mdarm_wait01.bck")),a.modelInstance.setShapeVisible(1,!1),a.setParentJoint(t,"armL");const r=x(e,"bdlm/mdarm.bdl");r.bindANK1(k(e,"bcks/mdarm_wait01.bck")),r.modelInstance.setShapeVisible(0,!1),r.setParentJoint(t,"armR")});else if("Cb1"===u)S("Cb").then(e=>{const t=y(e,"bdl/cb.bdl");x(e,"bdl/cb_face.bdl").setParentJoint(t,"backbone"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Hi1"===u)S("Hi").then(e=>y(e,"bdlm/hi.bdl").bindANK1(k(e,"bcks/hi_wait01.bck")));else if("p_zelda"===u)S("Pz").then(e=>{const t=y(e,"bdlm/pz.bdl");t.setMaterialColorWriteEnabled("m_pz_eyeLdamA",!1),t.setMaterialColorWriteEnabled("m_pz_eyeLdamB",!1),t.setMaterialColorWriteEnabled("m_pz_mayuLdamA",!1),t.setMaterialColorWriteEnabled("m_pz_mayuLdamB",!1),t.setMaterialColorWriteEnabled("m_pz_eyeRdamA",!1),t.setMaterialColorWriteEnabled("m_pz_eyeRdamB",!1),t.setMaterialColorWriteEnabled("m_pz_mayuRdamA",!1),t.setMaterialColorWriteEnabled("m_pz_mayuRdamB",!1),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("De1"===u)S("De").then(e=>y(e,"bdl/de.bdl").bindANK1(k(e,"bcks/wait01.bck")));else if("Co1"===u)S("Co").then(e=>y(e,"bdlm/co.bdl").bindANK1(k(e,"bcks/co_wait00.bck")));else if("Ac1"===u)S("Ac").then(e=>{const t=y(e,"bdlm/ac.bdl"),a=x(e,"bdl/acarm.bdl");a.setParentJoint(t,"armL"),a.bindANK1(k(e,"bcks/acarm_wait01.bck"));const r=x(e,"bdl/acarm.bdl");r.setParentJoint(t,"armR"),r.bindANK1(k(e,"bcks/acarm_wait01.bck")),t.bindANK1(k(e,"bcks/ac_wait01.bck"))});else if("Zk1"===u)S("Zk").then(e=>y(e,"bdlm/zk.bdl").bindANK1(k(e,"bcks/zk_wait01.bck")));else if("Ob1"===u)S("Ob").then(e=>{const t=y(e,"bdl/ob.bdl");x(e,"bdlm/oba_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait.bck"))});else if("Ym1"===u)S("Ym").then(e=>{const t=y(e,"bdlm/ym.bdl");x(e,"bdlm/ymhead01.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Ym2"===u)S("Ym").then(e=>{const t=M(e,"bdlm/ym.bdl","bmt/ym2.bmt");x(e,"bdlm/ymhead02.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Aj1"===u)S("Aj").then(e=>{y(e,"bdlm/aj.bdl").bindANK1(k(e,"bcks/wait01.bck"))});else if("Bm1"===u)S("Bm").then(e=>{const t=y(e,"bdlm/bm.bdl"),a=x(e,"bdlm/bmhead01.bdl");a.setParentJoint(t,"head"),a.bindANK1(k(e,"bcks/bmhead01_wait01.bck"));const r=x(e,"bdlm/bmarm.bdl");r.setParentJoint(t,"armL"),r.bindANK1(k(e,"bcks/bmarm_wait01.bck"));const n=x(e,"bdlm/bmarm.bdl");n.setParentJoint(t,"armR"),n.bindANK1(k(e,"bcks/bmarm_wait01.bck")),t.bindANK1(k(e,"bcks/bm_wait01.bck"))});else if("Bm2"===u)S("Bm").then(e=>{const t=y(e,"bdlm/bm.bdl"),a=x(e,"bdlm/bmhead02.bdl");a.setParentJoint(t,"head"),a.bindANK1(k(e,"bcks/bmhead01_wait01.bck"));const r=x(e,"bdlm/bmarm.bdl");r.setParentJoint(t,"armL"),r.bindANK1(k(e,"bcks/bmarm_wait01.bck"));const n=x(e,"bdlm/bmarm.bdl");n.setParentJoint(t,"armR"),n.bindANK1(k(e,"bcks/bmarm_wait01.bck")),t.bindANK1(k(e,"bcks/bm_wait01.bck"))});else if("Bm3"===u)S("Bm").then(e=>{const t=y(e,"bdlm/bm.bdl"),a=x(e,"bdlm/bmhead03.bdl");a.setParentJoint(t,"head"),a.bindANK1(k(e,"bcks/bmhead01_wait01.bck"));const r=x(e,"bdlm/bmarm.bdl");r.setParentJoint(t,"armL"),r.bindANK1(k(e,"bcks/bmarm_wait01.bck"));const n=x(e,"bdlm/bmarm.bdl");n.setParentJoint(t,"armR"),n.bindANK1(k(e,"bcks/bmarm_wait01.bck")),t.bindANK1(k(e,"bcks/bm_wait01.bck"))});else if("Bm4"===u)S("Bm").then(e=>{const t=y(e,"bdlm/bm.bdl"),a=x(e,"bdlm/bmhead04.bdl");a.setParentJoint(t,"head"),a.bindANK1(k(e,"bcks/bmhead01_wait01.bck"));const r=x(e,"bdlm/bmarm.bdl");r.setParentJoint(t,"armL"),r.bindANK1(k(e,"bcks/bmarm_wait01.bck"));const n=x(e,"bdlm/bmarm.bdl");n.setParentJoint(t,"armR"),n.bindANK1(k(e,"bcks/bmarm_wait01.bck")),t.bindANK1(k(e,"bcks/bm_wait01.bck"))});else if("Bm5"===u)S("Bm").then(e=>{const t=y(e,"bdlm/bm.bdl"),a=x(e,"bdlm/bmhead05.bdl");a.setParentJoint(t,"head"),a.bindANK1(k(e,"bcks/bmhead01_wait01.bck"));const r=x(e,"bdlm/bmarm.bdl");r.setParentJoint(t,"armL"),r.bindANK1(k(e,"bcks/bmarm_wait01.bck"));const n=x(e,"bdlm/bmarm.bdl");n.setParentJoint(t,"armR"),n.bindANK1(k(e,"bcks/bmarm_wait01.bck")),t.bindANK1(k(e,"bcks/bm_wait01.bck"))});else if("Btsw2"===u)S("Btsw").then(e=>y(e,"bdlm/bn.bdl").bindANK1(k(e,"bcks/bn_wait01.bck")));else if("Bmsw"===u)S("Bmsw").then(e=>{const t=y(e,"bdlm/bm.bdl");x(e,"bdlm/bmhead11.bdl").setParentJoint(t,"head");const a=x(e,"bdlm/bmarm.bdl");a.setParentJoint(t,"armL"),a.bindANK1(k(e,"bcks/bmarm_wait01.bck"));const r=x(e,"bdlm/bmarm.bdl");r.setParentJoint(t,"armR"),r.bindANK1(k(e,"bcks/bmarm_wait01.bck")),t.bindANK1(k(e,"bcks/bm_wait01.bck"))});else if("Bmcon1"===u)S("Bmcon1").then(e=>{const t=y(e,"bdl/bm.bdl");x(e,"bdlm/bmhead08.bdl").setParentJoint(t,"head");const a=x(e,"bdl/bmarm.bdl");a.setParentJoint(t,"armL"),a.bindANK1(k(e,"bcks/bmarm_wait01.bck"));const r=x(e,"bdl/bmarm.bdl");r.setParentJoint(t,"armR"),r.bindANK1(k(e,"bcks/bmarm_wait01.bck")),t.bindANK1(k(e,"bcks/bm_wait01.bck"))});else if("Bmcon2"===u)S("Bmcon1").then(e=>{const t=y(e,"bdl/bm.bdl");x(e,"bdlm/bmhead10.bdl").setParentJoint(t,"head");const a=x(e,"bdl/bmarm.bdl");a.setParentJoint(t,"armL"),a.bindANK1(k(e,"bcks/bmarm_wait01.bck"));const r=x(e,"bdl/bmarm.bdl");r.setParentJoint(t,"armR"),r.bindANK1(k(e,"bcks/bmarm_wait01.bck")),t.bindANK1(k(e,"bcks/bm_wait01.bck"))});else if("Ko1"===u)S("Ko").then(e=>{const t=y(e,"bdlm/ko.bdl");x(e,"bdlm/kohead01.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ko_wait01.bck"))});else if("Ko2"===u)S("Ko").then(e=>{const t=M(e,"bdlm/ko.bdl","bmt/ko02.bmt");x(e,"bdlm/kohead02.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ko_wait01.bck"))});else if("Yw1"===u)S("Yw").then(e=>{const t=y(e,"bdl/yw.bdl");x(e,"bdlm/ywhead01.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Zl1"===u)S("Zl").then(e=>{const t=y(e,"bdlm/zl.bdl");t.setMaterialColorWriteEnabled("eyeLdamA",!1),t.setMaterialColorWriteEnabled("eyeLdamB",!1),t.setMaterialColorWriteEnabled("mayuLdamA",!1),t.setMaterialColorWriteEnabled("mayuLdamB",!1),t.setMaterialColorWriteEnabled("eyeRdamA",!1),t.setMaterialColorWriteEnabled("eyeRdamB",!1),t.setMaterialColorWriteEnabled("mayuRdamA",!1),t.setMaterialColorWriteEnabled("mayuRdamB",!1),t.bindANK1(k(e,"bcks/wait.bck"))});else if("P1a"===u)S("P1").then(e=>{const t=y(e,"bdl/p1.bdl");x(e,"bdlm/p1a_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait.bck"))});else if("P1b"===u)S("P1").then(e=>{const t=M(e,"bdl/p1.bdl","bmt/p1b_body.bmt");x(e,"bdlm/p1b_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait.bck"))});else if("P1c"===u)S("P1").then(e=>{const t=M(e,"bdl/p1.bdl","bmt/p1c_body.bmt");x(e,"bdlm/p1c_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait.bck"))});else if("P2a"===u)S("P2").then(e=>{const t=y(e,"bdl/p2.bdl");x(e,"bdlm/p2head01.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/p2_wait01.bck"))});else if("P2b"===u)S("P2").then(e=>{const t=M(e,"bdl/p2.bdl","bmt/p2b.bmt");x(e,"bdlm/p2head02.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/p2_wait01.bck"))});else if("P2c"===u)S("P2").then(e=>{const t=M(e,"bdl/p2.bdl","bmt/p2c.bmt");x(e,"bdlm/p2head03.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/p2_wait01.bck"))});else if("Ah"===u)S("Ah").then(e=>{y(e,"bdlm/ah.bdl").bindANK1(k(e,"bcks/ah_wait01.bck"))});else if("Dk"===u)S("Dk").then(e=>{y(e,"bdl/dk.bdl").bindANK1(k(e,"bcks/fly1.bck"))});else if("Rsh1"===u)S("Rsh").then(e=>{y(e,"bdlm/rs.bdl").bindANK1(k(e,"bck/rs_wait01.bck"))});else if("Sa1"===u)S("Sa").then(e=>{const t=y(e,"bdl/sa.bdl");x(e,"bdlm/sa01_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/sa_wait01.bck"))});else if("Sa2"===u)S("Sa").then(e=>{const t=M(e,"bdl/sa.bdl","bmt/sa02.bmt");x(e,"bdlm/sa02_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/sa_wait01.bck"))});else if("Sa3"===u)S("Sa").then(e=>{const t=M(e,"bdl/sa.bdl","bmt/sa03.bmt");x(e,"bdlm/sa03_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/sa_wait01.bck"))});else if("Sa4"===u)S("Sa").then(e=>{const t=M(e,"bdl/sa.bdl","bmt/sa04.bmt");x(e,"bdlm/sa04_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/sa_wait01.bck"))});else if("Sa5"===u)S("Sa").then(e=>{const t=M(e,"bdl/sa.bdl","bmt/sa05.bmt");x(e,"bdlm/sa05_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/sa_wait01.bck"))});else if("Ug1"===u)S("Ug").then(e=>{const t=y(e,"bdl/ug.bdl");x(e,"bdlm/ug01_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ug_wait01.bck"))});else if("Ug2"===u)S("Ug").then(e=>{const t=M(e,"bdl/ug.bdl","bmt/ug02.bmt");x(e,"bdlm/ug02_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ug_wait01.bck"))});else if("UkB"===u)S("Uk").then(e=>{const t=y(e,"bdlm/uk.bdl");x(e,"bdl/ukhead_b.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/uk_wait.bck"))});else if("UkC"===u)S("Uk").then(e=>{const t=M(e,"bdlm/uk.bdl","bmt/uk_c.bmt");x(e,"bdlm/ukhead_c.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/uk_wait.bck"))});else if("UkD"===u)S("Uk").then(e=>{const t=M(e,"bdlm/uk.bdl","bmt/uk_d.bmt");x(e,"bdl/ukhead_d.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/uk_wait.bck"))});else if("Uw1"===u)S("Uw").then(e=>{const t=y(e,"bdl/uw.bdl");x(e,"bdlm/uw01_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/uw_wait01.bck"))});else if("Uw2"===u)S("Uw").then(e=>{const t=M(e,"bdl/uw.bdl","bmt/uw02.bmt");x(e,"bdlm/uw02_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/uw_wait01.bck"))});else if("Um1"===u)S("Um").then(e=>{const t=y(e,"bdl/um.bdl");x(e,"bdlm/um01_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/um_wait01.bck"))});else if("Um2"===u)S("Um").then(e=>{const t=M(e,"bdl/um.bdl","bmt/um02.bmt");x(e,"bdlm/um02_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/um_wait01.bck"))});else if("Um3"===u)S("Um").then(e=>{const t=M(e,"bdl/um.bdl","bmt/um03.bmt");x(e,"bdlm/um03_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/um_wait01.bck"))});else if("Uo1"===u)S("Uo").then(e=>{const t=y(e,"bdl/uo.bdl");x(e,"bdlm/uo01_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/uo_wait01.bck"))});else if("Uo2"===u)S("Uo").then(e=>{const t=M(e,"bdl/uo.bdl","bmt/uo02.bmt");x(e,"bdlm/uo02_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/uo_wait01.bck"))});else if("Uo3"===u)S("Uo").then(e=>{const t=M(e,"bdl/uo.bdl","bmt/uo03.bmt");x(e,"bdlm/uo03_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/uo_wait01.bck"))});else if("Ub1"===u)S("Ub").then(e=>{const t=y(e,"bdl/ub.bdl");x(e,"bdlm/ub01_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ub_wait01.bck"))});else if("Ub2"===u)S("Ub").then(e=>{const t=M(e,"bdl/ub.bdl","bmt/ub02.bmt");x(e,"bdlm/ub02_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ub_wait01.bck"))});else if("Ub3"===u)S("Ub").then(e=>{const t=M(e,"bdl/ub.bdl","bmt/ub03.bmt");x(e,"bdlm/ub03_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ub_wait01.bck"))});else if("Ub4"===u)S("Ub").then(e=>{const t=M(e,"bdl/ub.bdl","bmt/ub04.bmt");x(e,"bdlm/ub04_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ub_wait01.bck"))});else if("Bms1"===u)S("Bms").then(e=>{const t=y(e,"bdl/by1.bdl");x(e,"bdlm/by_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/by1_wait01.bck"))});else if("Bms2"===u)S("Bms").then(e=>{const t=y(e,"bdl/by2.bdl");x(e,"bdlm/by_head.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/by2_wait00.bck"))});else if("Ho"===u)S("Ho").then(e=>{const t=y(e,"bdlm/ho.bdl");x(e,"bdl/ho_pend.bdl").setParentJoint(t,"backbone"),t.bindANK1(k(e,"bcks/ho_wait01.bck"))});else if("Tt"===u)S("Tt").then(e=>y(e,"bdlm/tt.bdl").bindANK1(k(e,"bck/wait01.bck")));else if("Gp1"===u)S("Gp").then(e=>y(e,"bdlm/gp.bdl").bindANK1(k(e,"bcks/wait01.bck")));else if("Pf1"===u)S("Pf").then(e=>y(e,"bdlm/pf.bdl").bindANK1(k(e,"bcks/wait01.bck")));else if("Kp1"===u)S("Kp").then(e=>y(e,"bdlm/kp.bdl").bindANK1(k(e,"bcks/wait01.bck")));else if("Kk1"===u)S("Kk").then(e=>y(e,"bdlm/kk.bdl").bindANK1(k(e,"bcks/kk_wait01.bck")));else if("Kf1"===u)S("Kf").then(e=>y(e,"bdlm/kf.bdl").bindANK1(k(e,"bcks/kf_wait01.bck")));else if("Gk1"===u)S("Gk").then(e=>y(e,"bdlm/gk.bdl").bindANK1(k(e,"bcks/gk_wait01.bck")));else if("Mk"===u)S("Mk").then(e=>y(e,"bdlm/mk.bdl").bindANK1(k(e,"bcks/mk_wait.bck")));else if("Po"===u)S("Po").then(e=>y(e,"bdlm/po.bdl").bindANK1(k(e,"bcks/wait01.bck")));else if("Ds1"===u)S("Ds").then(e=>y(e,"bdlm/ck.bdl").bindANK1(k(e,"bcks/wait01.bck")));else if("Jb1"===u)S("Jb").then(e=>y(e,"bdlm/jb.bdl").bindANK1(k(e,"bcks/jb_wait01.bck")));else if("Hr"===u)S("Hr").then(e=>y(e,"bdlm/hr.bdl").bindANK1(k(e,"bcks/r_wait01.bck")));else if("Hr2"===u)S("Hr").then(e=>y(e,"bdlm/hr.bdl").bindANK1(k(e,"bcks/r_wait01.bck")));else if("dragon"===u)S("Dr").then(e=>y(e,"bmd/dr1.bmd").bindANK1(k(e,"bck/dr_wait1.bck")));else if("Bj1"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj1_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Bj2"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj2_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Bj3"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj3_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Bj4"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj4_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Bj5"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj5_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Bj6"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj6_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Bj7"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj7_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Bj8"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj8_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Bj9"===u)S("Bj").then(e=>{const t=y(e,"bdlm/bj.bdl");x(e,"bdl/bj9_face.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/wait01.bck"))});else if("Mn"===u)S("Mn").then(e=>y(e,"bdlm/mn.bdl").bindANK1(k(e,"bcks/mn_wait01.bck")));else if("Mt"===u)S("Niten").then(e=>y(e,"bdlm/mt.bdl").bindANK1(k(e,"bcks/mt_wait01.bck")));else if("BigElf"===u)S("bigelf").then(e=>y(e,"bdlm/dy.bdl").bindANK1(k(e,"bcks/wait01.bck")));else if("Sfairy"===u)S("Always").then(e=>y(e,"bdl/fa.bdl").bindANK1(k(e,"bck/fa.bck")));else if("RotenA"===u)S("Ro").then(e=>{const t=y(e,"bdlm/ro.bdl");x(e,"bdl/ro_hat.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ro_wait01.bck"))});else if("RotenB"===u)S("Ro").then(e=>{const t=y(e,"bdlm/ro.bdl");x(e,"bdl/ro_hat2.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ro_wait01.bck"))});else if("RotenC"===u)S("Ro").then(e=>{const t=y(e,"bdlm/ro.bdl");x(e,"bdl/ro_hat3.bdl").setParentJoint(t,"head"),t.bindANK1(k(e,"bcks/ro_wait01.bck"))});else if("Ghrwp"===u)S("Ghrwp").then(e=>{y(e,"bdlm/ghrwpa00.bdl").bindTTK1(I(e,"btk/ghrwpa00.btk"));const t=y(e,"bdlm/ghrwpb00.bdl");t.bindTTK1(I(e,"btk/ghrwpb00.btk")),t.bindTRK1(D(e,"brk/ghrwpb00.brk"))});else if("kotubo"===u||"ootubo1"===u||"Kmtub"===u||"Ktaru"===u||"Ostool"===u||"Odokuro"===u||"Okioke"===u||"Kmi02"===u||"Ptubo"===u||"KkibaB"===u||"Kmi00"===u||"Hbox2S"===u){let e;switch((251658240&a.parameters)>>24){case 0:S("Always").then(t=>{e=y(t,"bdl/obm_kotubo1.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 1:S("Always").then(t=>{e=y(t,"bdl/obm_ootubo1.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 2:S("Kmtub_00").then(t=>{e=y(t,"bdl/kmtub_00.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 3:S("Ktaru_01").then(t=>{e=y(t,"bdl/ktaru_01.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 4:S("Okmono").then(t=>{e=y(t,"bdl/ostool.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 5:S("Odokuro").then(t=>{e=y(t,"bdl/odokuro.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 6:S("Okioke").then(t=>{e=y(t,"bdl/okioke.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 7:S("Kmi00x").then(t=>{e=y(t,"bdl/kmi_00x.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 8:S("Hbox2").then(t=>{e=y(t,"bdl/hbox2.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 13:S("Sitem").then(t=>{e=y(t,"bdl/kmi_02.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 14:S("Ptubo").then(t=>{e=y(t,"bdl/ptubo.bdl"),U(e.modelMatrix,e.modelMatrix)});break;case 15:S("Kkiba_00").then(t=>{e=y(t,"bdl/kkiba_00.bdl"),U(e.modelMatrix,e.modelMatrix)});break;default:S("Hseki").then(t=>{e=y(t,"bdlm/hmon1.bdl"),U(e.modelMatrix,e.modelMatrix)})}}else if("Ajav"===u)S("Ajav").then(e=>{const t=y(e,"bdl/ajava.bdl").modelInstance.getTextureMappingReference("Txa_jav_a");y(e,"bdl/ajavb.bdl").modelInstance.getTextureMappingReference("dmTxa_jav_a").copy(t),y(e,"bdl/ajavc.bdl").modelInstance.getTextureMappingReference("dmTxa_jav_a").copy(t),y(e,"bdl/ajavd.bdl").modelInstance.getTextureMappingReference("dmTxa_jav_a").copy(t),y(e,"bdl/ajave.bdl").modelInstance.getTextureMappingReference("dmTxa_jav_a").copy(t),y(e,"bdl/ajavf.bdl").modelInstance.getTextureMappingReference("dmTxa_jav_a").copy(t)});else if("koisi1"===u)S("Always").then(e=>y(e,"bdl/obm_koisi1.bdl"));else if("lwood"===u)S("Lwood").then(e=>{y(e,"bdl/alwd.bdl").lightTevColorType=1});else if("Oyashi"===u)S("Oyashi").then(e=>{y(e,"bdl/oyashi.bdl").lightTevColorType=1});else if("Vyasi"===u)S("Vyasi").then(e=>y(e,"bdl/vyasi.bdl"));else if("Ktarux"===u)S("Ktaru_01").then(e=>y(e,"bdl/ktaru_01.bdl"));else if("Ktaruo"===u)S("Ktaru_01").then(e=>y(e,"bdl/ktaru_01.bdl"));else if("Otana"===u)S("Otana").then(e=>y(e,"bdl/otana.bdl"));else if("Tpost"===u)S("Toripost").then(e=>y(e,"bdl/vpost.bdl").bindANK1(k(e,"bcks/post_wait.bck")));else if("Kanban"===u)S("Kanban").then(e=>{y(e,"bdl/kanban.bdl").lightTevColorType=1});else if("SMBdor"===u)S("Mbdoor").then(e=>{y(e,"bdl/s_mbdfu.bdl").lightTevColorType=1,y(e,"bdl/s_mbd_l.bdl").lightTevColorType=1,y(e,"bdl/s_mbd_r.bdl").lightTevColorType=1,y(e,"bdl/s_mbdto.bdl").lightTevColorType=1});else if("MjDoor"===u)S("S_MSPDo").then(e=>y(e,"bdl/s_mspdo.bdl"));else if("Pitfall"===u)S("Aana").then(e=>y(e,"bdl/aana.bdl"));else if("Warpt"===u||"Warpnt"===u||"Warpts1"===u||"Warpts2"===u||"Warpts3"===u)S("ltubw").then(e=>y(e,"bdl/itubw.bdl"));else if("Warpgm"===u)S("Gmjwp").then(e=>{const t=y(e,"bdlm/gmjwp00.bdl");t.bindANK1(k(e,"bck/gmjwp01.bck")),t.bindTTK1(I(e,"btk/gmjwp00.btk")),t.bindTRK1(D(e,"brk/gmjwp01.brk"))});else if("Hfuck1"===u)S("Hfuck1").then(e=>y(e,"bdl/hfuck1.bdl"));else if("Mhsg4h"===u)S("Mhsg").then(e=>y(e,"bdl/mhsg4h.bdl"));else if("Mhsg9"===u)S("Mhsg").then(e=>y(e,"bdl/mhsg9.bdl"));else if("Mhsg15"===u)S("Mhsg").then(e=>y(e,"bdl/mhsg15.bdl"));else if("Ebrock"===u)S("Ebrock").then(e=>y(e,"bdl/ebrock.bdl"));else if("Ebrock2"===u)S("Ebrock").then(e=>y(e,"bdl/ebrock2.bdl"));else if("Eskban"===u)S("Eskban").then(e=>y(e,"bdl/eskban.bdl"));else if("Esekh"===u)S("Esekh").then(e=>y(e,"bdl/esekh.bdl"));else if("Esekh2"===u)S("Esekh").then(e=>y(e,"bdl/esekh2.bdl"));else if("Ebomzo"===u)S("Ebomzo").then(e=>y(e,"bdl/ebomzo.bdl"));else if("Ekao"===u)S("Ekao").then(e=>y(e,"bdl/ekao.bdl"));else if("Auzu"===u)S("Auzu").then(e=>y(e,"bdlm/auzu.bdl").bindTTK1(I(e,"btk/auzu.btk")));else if("Kbota_A"===u||"Kbota_B"===u||"KbotaC"===u)S("Kbota_00").then(e=>y(e,"bdl/kbota_00.bdl"));else if("Hhbot1"===u||"Hhbot1N"===u)S("Hhbot").then(e=>{y(e,"bdl/hhbot1.bdl"),y(e,"bdl/hhbot2.bdl")});else if("Trap"===u)S("Trap").then(e=>y(e,"bdlm/htora1.bdl"));else if("Htoge1"===u)S("Htoge1").then(e=>y(e,"bdl/htoge1.bdl"));else if("Kui"===u)S("Kui").then(e=>y(e,"bdl/obi_ropetag.bdl"));else if("osiBLK0"===u||"osiBLK1"===u||"Kkiba"===u||"Hseki2"===u||"Hseki7"===u||"Mmrr"===u||"MkieBB"===u||"Ecube"===u||"Hjump1"===u||"Hbox1"===u||"MpwrB"===u||"DBLK0"===u||"DBLK1"===u||"DKkiba"===u||"Hbox2"===u){switch((251658240&a.parameters)>>24){case 0:case 4:case 8:case 9:S("Kkiba_00").then(e=>{y(e,"bdl/kkiba_00.bdl")});break;case 1:case 11:S("Osiblk").then(e=>{y(e,"bdl/obm_osihikiblk1.bdl")});break;case 2:S("Osiblk").then(e=>{y(e,"bdl/obm_osihikiblk2.bdl")});break;case 3:S("MpwrB").then(e=>{y(e,"bdl/mpwrb.bdl")});break;case 5:S("Hbox2").then(e=>{y(e,"bdl/hbox2.bdl")});break;case 6:S("Hjump").then(e=>{y(e,"bdl/hbox1.bdl")});break;case 7:S("Hjump").then(e=>{y(e,"bdl/hjump1.bdl")});break;case 10:S("Mmirror").then(e=>{y(e,"bdlm/mmrr.bdl").bindTTK1(I(e,"btk/mmrr.btk"))});break;case 12:S("Ecube").then(e=>{y(e,"bdl/ecube.bdl")})}}else if("FTree"===u)S("Vmr").then(e=>y(e,"bdlm/vmrty.bdl").bindANK1(k(e,"bck/vmrty.bck")));else if("DmKmm"===u)S("Demo_Kmm").then(e=>y(e,"bmd/ka.bmd").bindANK1(k(e,"bcks/ka_wait1.bck")));else if("kani"===u)S("Kn").then(e=>y(e,"bdl/kn.bdl"));else if("Pig"===u)S("Kb").then(e=>y(e,"bdlm/pg.bdl"));else if("kani"===u)S("Kn").then(e=>y(e,"bdl/kn.bdl").bindANK1(k(e,"bck/wait01.bck")));else if("NpcSo"===u)S("So").then(e=>y(e,"bdlm/so.bdl").bindANK1(k(e,"bcks/so_wait01.bck")));else if("Fganon"===u)S("Fganon").then(e=>y(e,"bdlm/bpg.bdl").bindANK1(k(e,"bck/wait1.bck")));else if("Btd"===u)S("Btd").then(e=>{const t=y(e,"bmdm/btd.bmd");t.bindANK1(k(e,"bck/btd_pose.bck")),t.bindTRK1(D(e,"brk/btd.brk")),t.bindTTK1(I(e,"btk/btd.btk"))});else if("Bkm"===u)S("Bmd").then(e=>{y(e,"bmdm/bkm.bmd").bindANK1(k(e,"bck/hiraku_wait.bck")),y(e,"bmdm/bkm_coa.bmd").bindANK1(k(e,"bck/coa_wait.bck"))});else if("Bst"===u)S("Bst").then(e=>{switch(255&a.parameters){case 0:y(e,"bdlm/bst.bdl").bindTTK1(I(e,"btk/bst.btk"));break;case 1:y(e,"bdlm/lhand.bdl").bindTTK1(I(e,"btk/lhand.btk"));break;case 2:y(e,"bdlm/rhand.bdl").bindTTK1(I(e,"btk/rhand.btk"))}});else if("big_pow"===u)S("Bpw").then(e=>{const t=y(e,"bdlm/bpw.bdl");t.bindANK1(k(e,"bck/wait1.bck")),n.mat4.translate(t.modelMatrix,t.modelMatrix,[0,400,0]);const a=x(e,"bdlm/bpw_kan1.bdl");a.setParentJoint(t,"j_bpw_item"),n.mat4.rotateZ(a.modelMatrix,a.modelMatrix,Math.PI)});else if("Bwd"===u)S("Bwd").then(e=>{const t=y(e,"bdlm/bwd.bdl");t.bindTRK1(D(e,"brk/bwd.brk"),g(0));let a=t;for(let t=0;t<20;t++){let r;19==t?(r=x(e,"bdlm/bwd_shippob.bdl"),r.bindTRK1(D(e,"brk/bwd_shippob.brk"),g(0))):(r=x(e,"bdlm/bwd_shippoa.bdl"),r.bindTRK1(D(e,"brk/bwd_shippoa.brk"),g(0))),0==t?(r.setParentJoint(a,"hara"),n.mat4.rotateY(r.modelMatrix,r.modelMatrix,1.5*Math.PI)):r.setParentJoint(a,"bwd"),n.mat4.rotateX(r.modelMatrix,r.modelMatrix,-Math.PI/40),n.mat4.translate(r.modelMatrix,r.modelMatrix,[0,0,-200]),a=r}});else if("keeth"===u)S("Ki").then(e=>y(e,"bdlm/ki.bdl").bindANK1(k(e,"bck/wait1.bck")));else if("Fkeeth"===u)S("Ki").then(e=>y(e,"bdlm/fk.bdl").bindANK1(k(e,"bck/wait1.bck")));else if("Puti"===u)S("Pt").then(e=>y(e,"bdlm/pt.bdl").bindANK1(k(e,"bck/wait.bck")));else if("Rdead1"===u||"Rdead2"===u)S("Rd").then(e=>{const t=y(e,"bdlm/rd.bdl");0==(1&a.parameters)?t.bindANK1(k(e,"bcks/tachip.bck")):t.bindANK1(k(e,"bcks/suwarip.bck"))});else if("wiz_r"===u)S("Wz").then(e=>y(e,"bdlm/wz.bdl").bindANK1(k(e,"bck/s_demo_wait1.bck")));else if("gmos"===u)S("Gm").then(e=>y(e,"bdlm/gm.bdl").bindANK1(k(e,"bck/fly.bck")));else if("mo2"===u)S("Mo2").then(e=>y(e,"bdlm/mo.bdl").bindANK1(k(e,"bck/wait.bck")));else if("pow"===u)S("Pw").then(async e=>{let t=(65024&a.parameters)>>9;t>5&&(t=0);const r=y(e,"bdlm/pw.bdl");r.bindANK1(k(e,"bck/wait1.bck")),r.bindTPT1(function(e,t){const a=i.assertExists(d.findResInfoByArchive(e,d.resObj));return a.lazyLoadResource(5,i.assertExists(a.res.find(e=>t.endsWith(e.file.name))))}(e,"btp/irogae1.btp"),g(t));const s=await S("Kantera"),o=x(s,"bmdm/mk_kantera.bmd");o.bindTRK1(D(s,"brk/mk_kantera.brk")),o.setParentJoint(r,"j_pw_item_r1"),n.mat4.rotateX(o.modelMatrix,o.modelMatrix,Math.PI/4)});else if("Bb"===u)S("Bb").then(e=>y(e,"bdlm/bb.bdl").bindANK1(k(e,"bck/wait.bck")));else if("Bk"===u)S("Bk").then(e=>y(e,"bdlm/bk.bdl").bindANK1(k(e,"bck/bk_wait.bck")));else if("Oq"===u)S("Oq").then(e=>y(e,"bmdm/oq.bmd").bindANK1(k(e,"bck/nom_wait.bck")));else if("Oqw"===u)S("Oq").then(e=>y(e,"bmdm/red_oq.bmd").bindANK1(k(e,"bck/umi_new_wait.bck")));else if("Daiocta"===u)S("Daiocta").then(e=>y(e,"bdlm/do_main1.bdl").bindANK1(k(e,"bck/wait1.bck")));else if("Fmastr1"===u||"Fmastr2"==name)S("fm").then(e=>{y(e,"bdl/fm.bdl").bindANK1(k(e,"bcks/wait.bck"));const t=y(e,"bdlm/ypit00.bdl");t.bindTTK1(I(e,"btk/ypit00.btk")),n.mat4.translate(t.modelMatrix,t.modelMatrix,[0,.1,0])});else if("magtail"===u)S("Mt").then(e=>y(e,"bdlm/mg_head.bdl").bindANK1(k(e,"bck/wait1.bck")));else if("bable"===name)S("Bl").then(e=>{const t=y(e,"bdlm/bl.bdl");128==(255&a.parameters)?t.bindTTK1(I(e,"btk/off.btk")):t.bindANK1(k(e,"bck/fly.bck"))});else if("nezumi"===u)S("Nz").then(e=>y(e,"bdlm/nz.bdl"));else if("moZOU"===u)S("Mozo").then(e=>y(e,"bdlm/moz.bdl"));else if("MtoriSU"===u)S("MtoriSU").then(e=>y(e,"bdl/mtorisu.bdl"));else if("Tn"===u)S("Tn").then(async e=>{const t=(224&a.rot[0])>>>5,r=(240&a.parameters)>>>4,s=y(e,"bmdm/tn_main.bmd"),i=k(e,"bck/aniou1.bck");s.bindTRK1(D(e,"brk/tn_main.brk"),g(r));const o=x(await S("Tkwn"),"bdlc/tn_ken1.bdl");o.setParentJoint(s,"j_tn_item_r1"),n.mat4.translate(o.modelMatrix,o.modelMatrix,[0,0,85]);const l=x(e,"bmdm/tn_yoroi1.bmd");if(l.setParentJoint(s,"j_tn_mune1"),l.bindTRK1(D(e,"brk/tn_yoroi1.brk"),g(r)),n.mat4.translate(l.modelMatrix,l.modelMatrix,[-120,0,0]),n.mat4.rotateZ(l.modelMatrix,l.modelMatrix,1.5*Math.PI),[30,32].forEach(e=>{const t=i.jointAnimationEntries[e];for(let e=0;e<t.rotationY.frames.length;e++){t.rotationY.frames[e].value+=Math.PI}}),t>=2){const t=x(e,"bmdm/tn_tate1.bmd");t.setParentJoint(s,"j_tn_item_l1"),t.bindTRK1(D(e,"brk/tn_tate1.brk"),g(r));const a=k(e,"bck/atate_on1.bck");for(let e=11;e<18;e++)i.jointAnimationEntries[e]=a.jointAnimationEntries[e]}let c;s.bindANK1(i),1==t||3==t||t>=5?(c=x(e,"bmdm/tn_kabuto2.bmd"),c.bindTRK1(D(e,"brk/tn_kabuto2.brk"),g(r))):(c=x(e,"bmdm/tn_kabuto1.bmd"),c.bindTRK1(D(e,"brk/tn_kabuto1.brk"),g(r))),c.setParentJoint(s,"j_tn_atama1")});else if("Stal"===u)S("St").then(e=>{const t=y(e,"bdlm/st.bdl");t.bindANK1(k(e,"bck/wait.bck")),x(e,"bdlm/st_hara.bdl").setParentJoint(t,"hara"),x(e,"bdlm/st_mune.bdl").setParentJoint(t,"mune"),x(e,"bdlm/st_katal.bdl").setParentJoint(t,"kataL"),x(e,"bdlm/st_udel.bdl").setParentJoint(t,"udeL"),x(e,"bdlm/st_handl.bdl").setParentJoint(t,"handL"),x(e,"bdlm/st_yubi1l.bdl").setParentJoint(t,"yubi1L"),x(e,"bdlm/st_yubi2l.bdl").setParentJoint(t,"yubi2L"),x(e,"bdlm/st_katar.bdl").setParentJoint(t,"kataR"),x(e,"bdlm/st_uder.bdl").setParentJoint(t,"udeR"),x(e,"bdlm/st_handr.bdl").setParentJoint(t,"handR"),x(e,"bdlm/st_buki.bdl").setParentJoint(t,"buki"),x(e,"bdlm/st_yubi1r.bdl").setParentJoint(t,"yubi1R"),x(e,"bdlm/st_yubi2r.bdl").setParentJoint(t,"yubi2R"),x(e,"bdlm/st_kubi.bdl").setParentJoint(t,"kubi"),x(e,"bdlm/st_head.bdl").setParentJoint(t,"head"),x(e,"bdlm/st_ago.bdl").setParentJoint(t,"ago"),x(e,"bdlm/st_hat.bdl").setParentJoint(t,"hat"),x(e,"bdlm/st_kotuban.bdl").setParentJoint(t,"kotuban"),x(e,"bdlm/st_momol.bdl").setParentJoint(t,"momoL"),x(e,"bdlm/st_sunel.bdl").setParentJoint(t,"suneL"),x(e,"bdlm/st_asil.bdl").setParentJoint(t,"asiL"),x(e,"bdlm/st_momor.bdl").setParentJoint(t,"momoR"),x(e,"bdlm/st_suner.bdl").setParentJoint(t,"suneR"),x(e,"bdlm/st_asir.bdl").setParentJoint(t,"asiR"),t.modelInstance.modelData.bbox=new l.AABB(-80,-80,-80,80,80,80)});else if("p_hat"===u){1==(255&a.parameters)?S("Sh").then(e=>{const t=y(e,"bmdm/shb.bmd");t.bindANK1(k(e,"bck/bfly.bck")),n.mat4.scale(t.modelMatrix,t.modelMatrix,[9,9,9]);const a=y(e,"bmdm/shp.bmd");a.bindANK1(k(e,"bck/pfly.bck")),n.mat4.scale(a.modelMatrix,a.modelMatrix,[9,9,9]),n.mat4.translate(a.modelMatrix,a.modelMatrix,[0,50,0])}):S("Ph").then(e=>{y(e,"bdlm/phb.bdl").bindANK1(k(e,"bck/bfly.bck"));const t=y(e,"bdlm/php.bdl");t.bindANK1(k(e,"bck/pfly.bck")),n.mat4.translate(t.modelMatrix,t.modelMatrix,[0,50,0])})}else if("bbaba"===u)S("Bo").then(e=>{y(e,"bdlm/bo_sita1.bdl")});else if("c_green"===u||"c_red"===u||"c_blue"===u||"c_black"==name||"c_kiiro"==name)S("Cc").then(e=>{const t=y(e,"bmdm/cc.bmd");let r;switch(t.bindANK1(k(e,"bck/tachi_walk.bck")),(65280&a.parameters)>>>8){case 0:case 10:r=0;break;case 1:case 11:case 15:r=1;break;case 2:case 12:r=2;break;case 3:case 13:r=3;break;case 4:case 14:r=4;break;default:r=0}t.bindTRK1(D(e,"brk/cc.brk"),g(r))});else if("ikada_h"===u)S("IkadaH").then(e=>y(e,"bdl/vtsp.bdl"));else if("ikada_u"===u)S("IkadaH").then(e=>y(e,"bdl/vtsp2.bdl"));else if("Svsp"===u)S("IkadaH").then(e=>y(e,"bdl/vsvsp.bdl"));else if("Vtil1"===u)S("Vtil").then(e=>y(e,"bdl/vtil1.bdl"));else if("Vtil2"===u)S("Vtil").then(e=>y(e,"bdl/vtil2.bdl"));else if("Vtil3"===u)S("Vtil").then(e=>y(e,"bdl/vtil3.bdl"));else if("Vtil4"===u)S("Vtil").then(e=>y(e,"bdl/vtil4.bdl"));else if("Vtil5"===u)S("Vtil").then(e=>y(e,"bdl/vtil5.bdl"));else if("Ekskz"===u)S("Ekskz").then(e=>{y(e,"bdl/ekskz.bdl");const t=y(e,"bdlm/yocwd00.bdl");t.bindANK1(k(e,"bck/yocwd00.bck")),t.bindTRK1(D(e,"brk/yocwd00.brk")),t.bindTTK1(I(e,"btk/yocwd00.btk"))});else if("Ocanon"===u)S("WallBom").then(e=>y(e,"bdl/wallbom.bdl"));else if("Canon"===u)S("Bomber").then(e=>y(e,"bdl/vcank.bdl"));else if("Aygr"===u)S("Aygr").then(e=>{y(e,"bdl/aygr.bdl"),y(e,"bdl/aygrh.bdl")});else if("Ayush"===u)S("Ayush").then(e=>y(e,"bdlm/ayush.bdl").bindTTK1(I(e,"btk/ayush.btk")));else if("Ikada"===u)S("IkadaH").then(e=>y(e,"bdl/vikae.bdl"));else if("ikadaS"===u)S("IkadaH").then(e=>y(e,"bdl/vikah.bdl"));else if("Oship"===u)S("Oship").then(e=>y(e,"bdl/vbtsp.bdl"));else if("GiceL"===u)S("GiceL").then(e=>{const t=y(e,"bdli/gicel00.bdl");t.bindTTK1(I(e,"btk/gicel00_01.btk")),t.bindTRK1(D(e,"brk/gicel00.brk"))});else if("Qdghd"===u)S("Qdghd").then(e=>y(e,"bdl/qdghd.bdl"));else if("Qtkhd"===u)S("Qtkhd").then(e=>y(e,"bdl/qtkhd.bdl"));else if("Ylsic"===u)S("Ylsic").then(e=>y(e,"bdl/ylsic.bdl"));else if("Yllic"===u)S("Yllic").then(e=>y(e,"bdl/yllic.bdl"));else if("Ykzyg"===u)S("Ykzyg").then(e=>{const t=y(e,"bdlm/qkzyg.bdl");t.bindTTK1(I(e,"btk/qkzyg.btk")),t.lightTevColorType=1});else if("Yboil00"===u)S("Yboil").then(e=>y(e,"bdlm/yboil00.bdl").bindTTK1(I(e,"btk/yboil00.btk")));else if("Ytrnd00"===u)S("Trnd").then(e=>{y(e,"bdlm/ytrnd00.bdl").bindTTK1(I(e,"btk/ytrnd00.btk")),y(e,"bdlm/ywuwt00.bdl").bindTTK1(I(e,"btk/ywuwt00.btk"))});else if("Sarace"===u)S("Sarace").then(e=>y(e,"bdl/sa.bdl"));else if("Ocloud"===u||"Rcloud"===u)S("BVkumo").then(e=>{const t=y(e,"bdlm/bvkumo.bdl");t.bindTTK1(I(e,"btk/bvkumo.btk")),t.lightTevColorType=1});else if("Doguu"===u)S("Doguu").then(e=>{const t=255&a.parameters;M(e,"bdlm/vgsma.bdl",["bmt/vgsmd.bmt","bmt/vgsmf.bmt","bmt/vgsmn.bmt"][t]).bindTRK1(D(e,["brk/vgsmd.brk","brk/vgsmf.brk","brk/vgsmn.brk"][t]))});else if("Lamp"===u)S("Lamp").then(e=>{const t=y(e,"bmd/lamp_00.bmd");n.mat4.scale(t.modelMatrix,t.modelMatrix,[.5,.5,.5])});else if("MKoppu"===u)S("Mshokki").then(e=>y(e,"bdl/koppu.bdl"));else if("MOsara"===u)S("Mshokki").then(e=>y(e,"bdl/osara.bdl"));else if("MPot"===u)S("Mshokki").then(e=>y(e,"bdl/pot.bdl"));else if("Branch"===u)S("Kwood_00").then(e=>y(e,"bmdc/ws.bmd"));else if("Otble"===u)S("Okmono").then(e=>y(e,"bdl/otable.bdl"));else if("OtbleL"===u)S("Okmono").then(e=>y(e,"bdl/otablel.bdl"));else if("AjavW"===u)S("AjavW").then(e=>{const t=y(e,"bdlm/ajavw.bdl");t.lightTevColorType=2,t.bindTTK1(I(e,"btk/ajavw.btk"))});else if("Vdora"===u)S("Vdora").then(e=>y(e,"bdl/vdora.bdl"));else if("Roten2"===u)S("Roten").then(e=>y(e,"bdl/roten02.bdl"));else if("Roten3"===u)S("Roten").then(e=>y(e,"bdl/roten03.bdl"));else if("Roten4"===u)S("Roten").then(e=>y(e,"bdl/roten04.bdl"));else if("Fdai"===u)S("Fdai").then(e=>y(e,"bdl/fdai.bdl"));else if("GBoard"===u)S("Kaisen_e").then(e=>y(e,"bdl/akbod.bdl"));else if("Nzfall"===u)S("Pfall").then(e=>y(e,"bdl/nz.bdl").bindANK1(k(e,"bcks/nz_wait.bck")));else if("Paper"===u)S("Opaper").then(e=>{const t=y(e,"bdl/opaper.bdl");n.mat4.rotateX(t.modelMatrix,t.modelMatrix,Math.PI/2)});else if("Cafelmp"===u)S("Cafelmp").then(e=>y(e,"bdl/ylamp.bdl"));else if("Pbka"===u)S("Pbka").then(e=>y(e,"bdl/pbka.bdl"));else if("Plant"===u)S("Plant").then(e=>y(e,"bdl/yrmwd.bdl"));else if("Table"===u)S("Table").then(e=>{0==(255&a.parameters)?y(e,"bdl/ytble.bdl"):y(e,"bdl/qcfis.bdl")});else if("Ppos"===u)S("Ppos").then(e=>y(e,"bdl/ppos.bdl"));else if("Rflw"===u)S("Rflw").then(e=>y(e,"bdl/phana.bdl"));else if("Skanran"===u)S("Skanran").then(e=>y(e,"bdl/skanran.bdl"));else if("Stoudai"===u)S("Skanran").then(e=>y(e,"bdl/stoudai.bdl"));else if("Pirates"===u)S("Kaizokusen").then(e=>y(e,"bdl/oba_kaizoku_a.bdl"));else if("Ashut"===u)S("Ashut").then(e=>y(e,"bdl/ashut.bdl"));else if("Ospbox"===u)S("Ospbox").then(e=>y(e,"bdl/ospbox.bdl"));else if("Hlift"===u)S("Hlift").then(e=>{y(e,"bdl/hlift.bdl").modelMatrix[13]+=350});else if("Hliftb"===u)S("Hlift").then(e=>{y(e,"bdl/hliftb.bdl").modelMatrix[13]+=300});else if("Ptco"===u)S("Ptc").then(e=>y(e,"bdl/ptco.bdl"));else if("Ptcu"===u)S("Ptc").then(e=>y(e,"bdl/ptcu.bdl"));else if("Gaship1"===u)S("GaShip").then(e=>y(e,"bdl/gaship.bdl"));else if("Gaship2"===u)S("YakeRom").then(e=>y(e,"bdl/yakerom.bdl"));else if("dmgroom"===u)S("dmgroom").then(e=>y(e,"bdlm/dmgroom.bdl"));else if("nezuana"===u)S("Nzg").then(e=>y(e,"bdl/kana_00.bdl"));else if("Shmrgrd"===u)S("Shmrgrd").then(e=>y(e,"bdl/shmrgrd.bdl"));else if("ATdoor"===u)S("Atdoor").then(e=>y(e,"bdl/sdoor01.bdl"));else if("Search"===u)S("Search").then(e=>y(e,"bdl/s_search.bdl"));else if("Ikari"===u)S("Ikari").then(e=>y(e,"bdl/s_ikari2.bdl"));else if("SMtoge"===u)S("Mtoge").then(e=>y(e,"bmd/s_mtoge.bmd"));else if("BFlower"===u||"VbakH"===u)S("VbakH").then(e=>{y(e,"bdlm/vbakh.bdl"),y(e,"bdlm/vbakm.bdl")});else if("TrFlag"===u)S("Trflag").then(e=>y(e,"bdl/ethata.bdl"));else if("Piwa"===u)S("Piwa").then(e=>y(e,"bdl/piwa.bdl"));else if("Gryw00"===u)S("Gryw00").then(e=>y(e,"bdlm/gryw00.bdl"));else if("Eayogn"===u)S("Eayogn").then(e=>y(e,"bdl/eayogn.bdl"));else if("Mswing"===u)S("Msw").then(e=>y(e,"bdl/mswng.bdl"));else if("Dsaku"===u)S("Knsak_00").then(e=>y(e,"bdl/knsak_00.bdl"));else if("Ksaku"===u)S("Ksaku_00").then(e=>y(e,"bdl/ksaku_00.bdl"));else if("Mflft"===u)S("Mflft").then(e=>y(e,"bdl/mflft.bdl"));else if("Yfire00"===u)S("Yfire_00").then(e=>{y(e,"bmdm/yfire_00.bmd"),y(e,"bmdm/yfirb_00.bmd").bindTTK1(I(e,"btk/yfirb_00.btk"))});else if("Zenfire"===u){const e=R(o,1121),t=R(o,1122);T(f),n.vec3.set(A,0,0,0),n.vec3.transformMat4(A,A,f),n.vec3.copy(e.globalTranslation,A),n.vec3.copy(t.globalTranslation,A)}else if("Ohatch"===u)S("Ohatch").then(e=>y(e,"bdl/ohatch.bdl"));else if("Ojtree"===u)S("Ojtree").then(e=>y(e,"bdl/ojtree.bdl"));else if("Olift"===u)S("Olift").then(e=>y(e,"bdl/olift.bdl"));else if("itemDek"===u)S("Deku").then(e=>y(e,"bdlm/vlfdm.bdl"));else if("ho"===u)S("Ff").then(e=>{const t=y(e,"bmd/ho.bmd");t.bindTRK1(D(e,"brk/ho.brk"));const a=x(e,"bmd/hop.bmd");a.setParentJoint(t,"ho_B"),a.bindTRK1(D(e,"brk/hop.brk")),n.mat4.translate(t.modelMatrix,t.modelMatrix,[0,50,0])});else if("jbaba"===u)S("Jbo").then(e=>y(e,"bmdm/jh.bmd"));else if("VigaH"===u)S("VigaH").then(e=>y(e,"bdl/vigah.bdl"));else if("Ss"===u)S("Ss").then(e=>y(e,"bdl/sw.bdl"));else if("Sss"===u)S("Sss").then(e=>y(e,"bmd/sss_hand.bmd"));else if("Turu"===u)S("Sk").then(e=>y(e,"bdl/turu_00.bdl"));else if("s_turu"===u)S("Ssk").then(e=>y(e,"bdl/turu_02.bdl"));else if("Turu2"===u)S("Sk2").then(e=>y(e,"bdlm/ksylf_00.bdl"));else if("Turu3"===u)S("Sk2").then(e=>y(e,"bdlm/ksylf_01.bdl"));else if("Kita"===u)S("kita").then(e=>y(e,"bdl/vhlif_00.bdl"));else if("Klft"===u)S("Klft").then(e=>y(e,"bdlm/lift_00.bdl"));else if("Kokiie"===u)S("Kokiie").then(e=>y(e,"bdl/koki_00.bdl"));else if("Vpbot"===u)S("Vpbot_00").then(e=>y(e,"bdl/vpbot_00.bdl"));else if("Vochi"===u)S("Vochi").then(e=>y(e,"bdl/vochi.bdl"));else if("Kanat"===u)S("Kanat").then(e=>y(e,"bdl/kanat.bdl"));else if("Kryu00"===u)S("Kryu").then(e=>y(e,"bdl/ryu_00.bdl"));else if("X_tower"===u)S("X_tower").then(e=>y(e,"bdl/x_tower.bdl"));else if("Wall"===u)S("Hbw1").then(e=>y(e,"bdl/hbw1.bdl"));else if("Hmon1d"===u)S("Hseki").then(e=>y(e,"bdlm/hmon1.bdl").bindTRK1(D(e,"brk/hmon1.brk")));else if("Hmon2d"===u)S("Hseki").then(e=>y(e,"bdlm/hmon2.bdl").bindTRK1(D(e,"brk/hmon2.brk")));else if("Hmos1"===u)S("Hmos").then(e=>y(e,"bdl/hmos1.bdl"));else if("Hmos2"===u)S("Hmos").then(e=>y(e,"bdl/hmos2.bdl"));else if("Hmos3"===u)S("Hmos").then(e=>y(e,"bdl/hmos3.bdl"));else if("amos"===u)S("Am").then(e=>y(e,"bdl/am.bdl"));else if("amos2"===u)S("Am2").then(e=>{const t=y(e,"bdlm/am2.bdl");t.bindANK1(k(e,"bck/wait.bck")),t.bindTTK1(I(e,"btk/am2.btk")),t.bindTRK1(D(e,"brk/am2.brk"))});else if("Hha"===u)S("Hha").then(e=>{y(e,"bdlm/hha1.bdl"),y(e,"bdlm/hha2.bdl")});else if("Gkai00"===u)S("Gkai00").then(e=>{const t=y(e,"bdlm/gkai00.bdl");t.bindANK1(k(e,"bck/gkai00.bck")),t.bindTRK1(D(e,"brk/gkai00.brk")),t.bindTTK1(I(e,"btk/gkai00.btk"))});else if("Gbrg00"===u)S("Gbrg00").then(e=>{const t=y(e,"bdlm/gbrg00.bdl");t.bindTRK1(D(e,"brk/gbrg00.brk")),t.bindTTK1(I(e,"btk/gbrg00.btk"))});else if("Humi0z"===u)S("Humi").then(e=>y(e,"bdlm/humi0.bdl").bindTTK1(I(e,"btk/humi0.btk")));else if("Humi2z"===u)S("Humi").then(e=>y(e,"bdlm/humi2.bdl").bindTTK1(I(e,"btk/humi2.btk")));else if("Humi3z"===u)S("Humi").then(e=>y(e,"bdlm/humi3.bdl").bindTTK1(I(e,"btk/humi3.btk")));else if("Humi4z"===u)S("Humi").then(e=>y(e,"bdlm/humi4.bdl").bindTTK1(I(e,"btk/humi4.btk")));else if("Humi5z"===u)S("Humi").then(e=>y(e,"bdlm/humi5.bdl").bindTTK1(I(e,"btk/humi5.btk")));else if("Htetu1"===u)S("Htetu1").then(e=>y(e,"bdl/htetu1.bdl"));else if("Htobi1"===u)S("Htobi1").then(e=>y(e,"bdl/htobi1.bdl"));else if("Hmlif"===u)S("Hmlif").then(e=>y(e,"bdlm/hmlif.bdl"));else if("Hdai1"===u)S("Hdai1").then(e=>y(e,"bdlm/hdai1.bdl"));else if("Hdai2"===u)S("Hdai1").then(e=>y(e,"bdlm/hdai1.bdl"));else if("Hdai3"===u)S("Hdai1").then(e=>y(e,"bdlm/hdai1.bdl"));else if("Hsh"===u)S("Hsehi1").then(e=>y(e,"bdl/hsehi1.bdl"));else if("Hsh2"===u)S("Hsehi2").then(e=>y(e,"bdl/hsehi2.bdl"));else if("Hyuf1"===u)S("Hyuf1").then(e=>y(e,"bdlm/hyuf1.bdl"));else if("Hyuf2"===u)S("Hyuf2").then(e=>y(e,"bdlm/hyuf2.bdl"));else if("Blift"===u)S("Hten1").then(e=>y(e,"bdl/hten1.bdl"));else if("Hcbh"===u)S("Hcbh").then(e=>{y(e,"bdl/hcbh1a.bdl"),y(e,"bdl/hcbh1b.bdl"),y(e,"bdl/hcbh1c.bdl"),y(e,"bdl/hcbh1d.bdl"),y(e,"bdl/hcbh2.bdl")});else if("Hfbot1B"===u)S("Hfbot").then(e=>y(e,"bdlm/hfbot1.bdl").bindTRK1(D(e,"brk/hfbot1.brk")));else if("Hfbot1C"===u)S("Hfbot").then(e=>y(e,"bdlm/hfbot1.bdl").bindTRK1(D(e,"brk/hfbot1.brk")));else if("Hys"===u)S("Hys").then(e=>y(e,"bdlm/hys.bdl"));else if("Hys2"===u)S("Hys").then(e=>y(e,"bdlm/hys.bdl"));else if("Ywarp00"===u)S("Ywarp00").then(e=>{const t=y(e,"bmdm/ywarp00.bmd");t.bindANK1(k(e,"bck/ywarp00.bck")),t.bindTRK1(D(e,"brk/ywarp00.brk"))});else if("YLzou"===u)S("YLzou").then(e=>y(e,"bdl/ylzou.bdl"));else if("MtryB"===u)S("MtryB").then(e=>y(e,"bdl/mtryb.bdl"));else if("zouK"===u||"zouK1"===u||"zouK2"===u||"zouK3"===u||"zouK4"===u)S("VzouK").then(e=>y(e,"bdl/vzouk.bdl"));else if("VmsDZ"===u)S("VmsDZ").then(e=>y(e,"bdl/vmsdz.bdl"));else if("VmsMS"===u)S("VmsMS").then(e=>y(e,"bdl/vmsms.bdl"));else if("Yswdr00"===u)S("Yswdr00").then(e=>y(e,"bdlm/yswdr00.bdl").bindTTK1(I(e,"btk/yswdr00.btk")));else if("MhmrSW0"===u)S("MhmrSW").then(e=>y(e,"bdl/mhmrsw.bdl"));else if("Vds"===u)S("Vds").then(e=>{const t=y(e,"bdlm/vdswt0.bdl");t.bindANK1(k(e,"bck/vdswt0.bck")),t.bindTRK1(D(e,"brk/vdswt0.brk"));const a=y(e,"bdlm/vdswt1.bdl");a.bindANK1(k(e,"bck/vdswt1.bck")),a.bindTRK1(D(e,"brk/vdswt1.brk"))});else if("MsuSWB"===u)S("Mmirror").then(e=>{const t=y(e,"bdlm/msusw.bdl");t.bindANK1(k(e,"bck/msusw.bck")),t.bindTTK1(I(e,"btk/msusw.btk"))});else if("Figure"===u){S("Figure").then(e=>y(e,"bdlm/vf_bs.bdl"));const e=255&a.parameters,t=`vf_${i.leftPad(""+e,3)}`,r=`bdl/${t}`;e>=0&&e<=13?S("Figure0").then(e=>{y(e,`${r}.bdl`).modelMatrix[13]+=100}):e>=14&&e<=40?S("Figure1").then(t=>{16===e||18===e?y(t,`${r}b.bdl`).modelMatrix[13]+=100:y(t,`${r}.bdl`).modelMatrix[13]+=100}):e>=41&&e<=64?S("Figure2").then(a=>{61===e?y(a,`bdlm/${t}.bdl`).modelMatrix[13]+=100:y(a,`${r}.bdl`).modelMatrix[13]+=100}):e>=65&&e<=82?S("Figure3").then(e=>{y(e,`${r}.bdl`).modelMatrix[13]+=100}):e>=83&&e<=96?S("Figure4").then(e=>{y(e,`${r}.bdl`).modelMatrix[13]+=100}):e>=97&&e<=115?S("Figure5").then(e=>{y(e,`${r}.bdl`).modelMatrix[13]+=100}):e>=116&&e<255&&S("Figure6").then(e=>{y(e,`${r}.bdl`).modelMatrix[13]+=100})}else if("KNOB00"===u);else if("Salvage"===u||"Salvag2"===u||"SalvagE"===u||"SalvagN"===u||"SalvFM"===u);else if("woodb"===u||"woodbx"===u);else if("RopeR"===u);else if("bridge"===u);else if("GyCtrl"===u||"GyCtrlB"===u);else if("agbTBOX"===u||"agbMARK"===u||"agbF"===u||"agbA"===u||"agbAT"===u||"agbA2"===u||"agbR"===u||"agbB"===u||"agbFA"===u||"agbCSW"===u);else if("AND_SW0"===u||"AND_SW1"===u||"AND_SW2"===u||"SW_HIT0"===u||"ALLdie"===u||"SW_C00"===u);else if("SwSlvg"===u);else if("Evsw"===u);else if("TagSo"===u||"TagMSo"===u);else if("TagPo"===u);else if("LTag0"===u||"LTag1"===u||"LTagR0"===u);else if(u.startsWith("ky"));else if("TagEv"===u||"TagKb"===u||"TagIsl"===u||"TagMk"===u||"TagWp"===u||"TagMd"===u||"TagHt"===u||"TagMsg"===u||"TagMsg2"===u||"ReTag0"===u||"AttTag"===u||"AttTagB"===u||"VolTag"===u||"WindTag"===u);else if("HyoiKam"===u);else if("MtFlag"===u||"SieFlag"===u||"Gflag"===u||"MjFlag"===u);else if("Akabe"===u);else{const t=e.objNameGetDbgName(B);console.warn(`Unknown obj: ${u} / ${t} / Room ${a.roomNo} Layer ${a.layer}`)}return Promise.all(m)}(e,this,t).then(()=>{this.phase=2})),this.phase}draw(e,t,a){const r=e.modelCache.device;t.setCurrentRenderInstList(e.dlst.main[0]);for(let n=0;n<this.objectRenderers.length;n++)this.objectRenderers[n].prepareToRender(e,r,t,a)}delete(e){super.delete(e);const t=e.modelCache.device;for(let e=0;e<this.objectRenderers.length;e++)this.objectRenderers[e].destroy(t)}}const b=new l.AABB,v=new u.ScreenSpaceProjection;class w{constructor(e){this.modelInstance=e,this.visible=!0,this.modelMatrix=n.mat4.create(),this.lightTevColorType=0,this.tevstr=new h.dKy_tevstr_c,this.childObjects=[],this.parentJointMatrix=null}bindANK1(e,t){this.modelInstance.bindANK1(e,t)}bindTTK1(e,t){this.modelInstance.bindTTK1(e,t)}bindTRK1(e,t){this.modelInstance.bindTRK1(e,t)}bindTPT1(e,t){this.modelInstance.bindTPT1(e,t)}setParentJoint(e,t){this.parentJointMatrix=e.modelInstance.getJointToWorldMatrixReference(t),e.childObjects.push(this)}setMaterialColorWriteEnabled(e,t){this.modelInstance.setMaterialColorWriteEnabled(e,t)}setExtraTextures(e){e.fillExtraTextures(this.modelInstance);for(let t=0;t<this.childObjects.length;t++)this.childObjects[t].setExtraTextures(e)}prepareToRender(e,t,a,r){if(this.visible){if(e.renderHacks.renderHacksChanged&&(this.modelInstance.setVertexColorsEnabled(e.renderHacks.vertexColorsEnabled),this.modelInstance.setTexturesEnabled(e.renderHacks.texturesEnabled)),null!==this.parentJointMatrix)n.mat4.mul(this.modelInstance.modelMatrix,this.parentJointMatrix,this.modelMatrix);else if(n.mat4.copy(this.modelInstance.modelMatrix,this.modelMatrix),b.transform(this.modelInstance.modelData.bbox,this.modelInstance.modelMatrix),u.computeScreenSpaceProjectionFromWorldSpaceAABB(v,r.camera,b),v.getScreenArea()<=2e-4)return;n.mat4.getTranslation(A,this.modelMatrix),h.settingTevStruct(e,this.lightTevColorType,A,this.tevstr),h.setLightTevColorType(e,this.modelInstance,this.tevstr,r.camera),this.setExtraTextures(e.renderer.extraTextures),this.modelInstance.prepareToRender(t,a,r);for(let n=0;n<this.childObjects.length;n++)this.childObjects[n].prepareToRender(e,t,a,r)}}destroy(e){for(let t=0;t<this.childObjects.length;t++)this.childObjects[t].destroy(e)}}t.BMDObjectRenderer=w,t.LegacyActor__RegisterFallbackConstructor=function(e){d.fpcPf__RegisterFallback(e,S)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(78),s=r(a(27)),i=a(0),o=a(1),l=r(a(39)),c=a(26);class h{constructor(e,t){this.name=e,this.path=t,this.id=this.path}spawnBMD(e,t,a,r,s=null){const l=i.assertExists(a.findFile(`${r}.bmd`)),c=a.findFile(`${r}.btk`),h=a.findFile(`${r}.brk`),d=a.findFile(`${r}.bmt`),u=n.createModelInstance(e,t.renderHelper.renderInstManager.gfxRenderCache,l,c,h,null,d);return u.name=r,null!==s&&o.mat4.copy(u.modelMatrix,s),u}createScene(e,t){const a=t.dataFetcher,r=`j3d/pik2/${this.path}`;return a.fetchData(r).then(e=>s.decompress(e)).then(t=>{const a=l.parse(t);console.log(a);const r=new n.BasicRenderer(e);if(a.findFile("model.bmd")){const t=this.spawnBMD(e,r,a,"model"),n=a.findFileData("texanm_1.btk");null!==n&&t.bindTTK1(c.BTK.parse(n)),r.addModelInstance(t)}return a.findFile("opening.bmd")&&r.addModelInstance(this.spawnBMD(e,r,a,"opening")),r})}}const d=["Areas",new h("Valley of Repose","user/Kando/map/tutorial/arc.szs"),new h("Awakening Wood","user/Kando/map/forest/arc.szs"),new h("Perplexing Pool","user/Kando/map/yakushima/arc.szs"),new h("Wistful Wild","user/Kando/map/last/arc.szs"),"Piklopedia / Treasure Hoard",new h("Piklopedia - Spring","user/Kando/map/zukan/forest/arc.szs"),new h("Piklopedia - Summer","user/Kando/map/zukan/yakushima/arc.szs"),new h("Piklopedia - Autumn","user/Kando/map/zukan/last/arc.szs"),new h("Piklopedia - Winter","user/Kando/map/zukan/tutorial/arc.szs"),"Title Screen Backgrounds",new h("Title Screen - Spring","user/Ebisawa/title/bg_spring.szs"),new h("Title Screen - Summer","user/Ebisawa/title/bg_summer.szs"),new h("Title Screen - Autumn","user/Ebisawa/title/bg_autumn.szs"),new h("Title Screen - Winter","user/Ebisawa/title/bg_winter.szs"),"Cave Skyboxes",new h("build","user/Kando/map/vrbox/build.szs"),new h("flooring","user/Kando/map/vrbox/flooring.szs"),new h("hiroba","user/Kando/map/vrbox/hiroba.szs"),new h("ice","user/Kando/map/vrbox/ice.szs"),new h("tatami","user/Kando/map/vrbox/tatami.szs"),new h("test","user/Kando/map/vrbox/test.szs"),"Unused Test Maps",new h("TestMap","user/Kando/map/newtest/arc.szs")];t.sceneGroup={id:"pik2",name:"Pikmin 2",sceneDescs:d}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(52),n=a(28),s=a(40),i=a(43),o=a(1);class l extends r.SMGSceneDescBase{constructor(){super(...arguments),this.pathBase="SuperMarioGalaxy"}getLightData(e){const t=e.getArchive("ObjectData/LightData.arc");return n.createCsvParser(t.findFileData("LightData.bcsv"))}getZoneLightData(e,t){const a=e.getArchive("ObjectData/LightData.arc");return n.createCsvParser(a.findFileData(`Light${t}.bcsv`))}getZoneMapArchive(e,t){return e.getArchive(`StageData/${t}.arc`)}requestGlobalArchives(e){e.requestArchiveData("ObjectData/LightData.arc")}requestZoneArchives(e,t){e.requestArchiveData(`StageData/${t}.arc`)}}function c(e,t,a){e[0]+=(t[0]-e[0])*a,e[1]+=(t[1]-e[1])*a,e[2]+=(t[2]-e[2])*a}const h=o.vec3.create(),d=o.vec3.create(),u=o.vec3.create();class m extends s.NameObj{constructor(e){super(e,"DayInTheLifeOfALumaController"),this.ticos=[],this.ticoIndex=-1,this.cameraCenter=o.vec3.create(),this.cameraEye=o.vec3.create(),this.cameraK=1/8,i.connectToScene(e,this,1,-1,-1,-1)}pickNewTico(){for(;;){this.ticoIndex=i.getRandomInt(0,this.ticos.length);const e=this.ticos[this.ticoIndex];if(e.visibleAlive&&e.visibleScenario&&!e.isStopped(0))break}const e=this.ticos[this.ticoIndex],t=i.getRailTotalLength(e)<1e4;this.currentZoom=t?i.getRandomFloat(500,2500):i.getRandomFloat(1e3,3500),this.switchCounter=t?2e3:-1}initAfterPlacement(e){super.initAfterPlacement(e),this.ticos=e.nameObjHolder.nameObjs.filter(e=>"TicoRail"===e.name),this.pickNewTico(),this.camera(1)}camera(e=this.cameraK){const t=this.ticos[this.ticoIndex];o.vec3.copy(h,t.direction),o.vec3.set(d,0,1,0),i.vecKillElement(u,h,d),o.vec3.scaleAndAdd(h,h,u,1),o.vec3.normalize(h,h),o.vec3.scaleAndAdd(h,t.translation,h,-this.currentZoom),h[1]+=500,c(this.cameraEye,h,e),c(this.cameraCenter,t.translation,e)}tryPickNewTico(e){const t=this.ticos[this.ticoIndex];if(t.visibleScenario&&t.visibleAlive||this.pickNewTico(),t.isStopped(0)){0===i.getRandomInt(0,200)&&this.pickNewTico()}this.switchCounter>=0&&(this.switchCounter-=e,this.switchCounter<=0&&this.pickNewTico())}movement(e,t){super.movement(e,t),this.tryPickNewTico(r.getDeltaTimeFrames(t)),this.camera();const a=t.camera;o.mat4.lookAt(a.viewMatrix,this.cameraEye,this.cameraCenter,d),o.mat4.invert(a.worldMatrix,a.viewMatrix),a.worldMatrixUpdated()}}const p=["Observatory",new l("Comet Observatory","AstroGalaxy"),new l("Peach's Castle Gardens","PeachCastleGardenGalaxy"),new l("Gateway Galaxy","HeavensDoorGalaxy"),new l("Boo's Boneyard Galaxy","TeresaMario2DGalaxy"),"Terrace",new l("Good Egg Galaxy","EggStarGalaxy"),new l("Honeyhive Galaxy","HoneyBeeKingdomGalaxy"),new l("Loopdeeloop Galaxy","SurfingLv1Galaxy"),new l("Flipswitch Galaxy","FlipPanelExGalaxy"),new l("Sweet Sweet Galaxy","BeltConveyerExGalaxy"),new l("Bowser Jr.'s Robot Reactor","TriLegLv1Galaxy"),"Fountain",new l("Space Junk Galaxy","StarDustGalaxy"),new l("Battlerock Galaxy","BattleShipGalaxy"),new l("Rolling Green Galaxy","TamakoroExLv1Galaxy"),new l("Hurry-Scurry Galaxy","BreakDownPlanetGalaxy"),new l("Sling Pod Galaxy","CocoonExGalaxy"),new l("Bowser's Star Reactor","KoopaBattleVs1Galaxy"),"Kitchen",new l("Beach Bowl Galaxy","HeavenlyBeachGalaxy"),new l("Ghostly Galaxy","PhantomGalaxy"),new l("Bubble Breeze Galaxy","CubeBubbleExLv1Galaxy"),new l("Buoy Base Galaxy","OceanFloaterLandGalaxy"),new l("Drip Drop Galaxy","TearDropGalaxy"),new l("Bowser Jr.'s Airship Armada","KoopaJrShipLv1Galaxy"),"Bedroom",new l("Gusty Garden Galaxy","CosmosGardenGalaxy"),new l("Freezeflame Galaxy","IceVolcanoGalaxy"),new l("Dusty Dune Galaxy","SandClockGalaxy"),new l("Honeyclimb Galaxy","HoneyBeeExGalaxy"),new l("Bigmouth Galaxy","FishTunnelGalaxy"),new l("Bowser's Dark Matter Plant","KoopaBattleVs2Galaxy"),"Engine Room",new l("Gold Leaf Galaxy","ReverseKingdomGalaxy"),new l("Sea Slide Galaxy","OceanRingGalaxy"),new l("Toy Time Galaxy","FactoryGalaxy"),new l("Bonefin Galaxy","SkullSharkGalaxy"),new l("Sand Spiral Galaxy","TransformationExGalaxy"),new l("Bowser Jr.'s Lava Reactor","FloaterOtaKingGalaxy"),"Garden",new l("Deep Dark Galaxy","OceanPhantomCaveGalaxy"),new l("Dreadnought Galaxy","CannonFleetGalaxy"),new l("Melty Molten Galaxy","HellProminenceGalaxy"),new l("Matter Splatter Galaxy","DarkRoomGalaxy"),new l("Snow Cap Galaxy","SnowCapsuleGalaxy"),"Center of the Universe",new l("Bowser's Galaxy Reactor","KoopaBattleVs3Galaxy"),"Planet of Trials",new l("Rolling Gizmo Galaxy","TamakoroExLv2Galaxy"),new l("Bubble Blast Galaxy","CubeBubbleExLv2Galaxy"),new l("Loopdeeswoop Galaxy","SurfingLv2Galaxy"),new l("Grand Finale Galaxy","PeachCastleFinalGalaxy"),"?",new class extends l{placeExtra(e){this.controller=new m(e)}patchRenderer(e){e.isInteractive=!1}}("Day in the Life of a Luma","AstroGalaxy","DayInTheLifeOfALuma")];t.sceneGroup={id:"smg",name:"Super Mario Galaxy",sceneDescs:p}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(20),n=a(10),s=a(0),i=a(6),o=a(4),l=a(9),c=a(13),h=a(14);class d extends r.DeviceProgram{constructor(){super(...arguments),this.vert=`\n${d.BindingsDefinition}\n\nout vec2 v_TexCoord;\n\nvoid main() {\n    vec2 p;\n    p.x = (gl_VertexID == 1) ? 2.0 : 0.0;\n    p.y = (gl_VertexID == 2) ? 2.0 : 0.0;\n    gl_Position.xy = p * vec2(2) - vec2(1);\n    gl_Position.zw = vec2(-1, 1);\n    v_TexCoord = p;\n}\n`}}d.BindingsDefinition="\nuniform sampler2D u_Texture;\n\nlayout(std140) uniform ub_Params {\n    vec4 u_Misc0;\n};\n#define u_Threshold      (u_Misc0.x)\n#define u_Intensity1     (u_Misc0.y)\n#define u_Intensity2     (u_Misc0.z)\n#define u_BloomIntensity (u_Misc0.w)\n";class u extends d{constructor(){super(...arguments),this.frag=`\n${d.BindingsDefinition}\n\nin vec2 v_TexCoord;\n\nvoid main() {\n    gl_FragColor = texture(u_Texture, v_TexCoord);\n}\n`}}class m extends d{constructor(){super(...arguments),this.frag=`\n${d.BindingsDefinition}\n\nin vec2 v_TexCoord;\n\nfloat Monochrome(vec3 t_Color) {\n    // NTSC primaries.\n    return dot(t_Color.rgb, vec3(0.299, 0.587, 0.114));\n}\n\nvoid main() {\n    vec4 c = texture(u_Texture, v_TexCoord);\n    gl_FragColor = (Monochrome(c.rgb) > u_Threshold) ? c : vec4(0.0);\n}\n`}}class p extends d{constructor(e,t,a,r){super(),s.assert(e.length===t.length),this.frag=`\n${d.BindingsDefinition}\n\nin vec2 v_TexCoord;\n\nfloat TevOverflow(float a) { return float(int(a * 255.0) & 255) / 255.0; }\nvec3 TevOverflow(vec3 a) { return vec3(TevOverflow(a.r), TevOverflow(a.g), TevOverflow(a.b)); }\nvoid main() {\n    vec3 c;\n    vec3 f = vec3(0.0);\n`;for(let n=0;n<e.length;n++){const s=e[n],i=t[n];this.frag+=`\n    // Pass ${n+1}\n    c = vec3(0.0);`;for(let e=0;e<a;e++){const t=i+e/a*6.283,n=.5625*s*Math.cos(t),o=s*Math.sin(t);this.frag+=`\n    c += (texture(u_Texture, v_TexCoord + vec2(${n.toFixed(5)}, -1.0 * ${o.toFixed(5)})).rgb * ${r});`}this.frag+="\n    f += TevOverflow(c);"}}}class f extends p{constructor(){super([.01,.02],[0,.52],6,"u_Intensity1"),this.frag+="\n    f = clamp(f, 0.0, 1.0);\n    gl_FragColor = vec4(f.rgb, 1.0);\n}\n"}}class A extends p{constructor(){super([.04,.07,.09],[0,0,0],12,"u_Intensity2"),this.frag+="\n    f = clamp(f, 0.0, 1.0);\n    // Combine pass.\n    f += texture(u_Texture, v_TexCoord).rgb;\n    f *= u_BloomIntensity;\n    gl_FragColor = vec4(f, 1.0);\n}\n"}}class g{constructor(e){this.depthStencilAttachment=e,this.colorAttachment=new l.ColorAttachment,this.renderPassDescriptor=l.makeEmptyRenderPassDescriptor()}setParameters(e,t,a,r=l.DEFAULT_NUM_SAMPLES){this.colorAttachment.setParameters(e,t,a,r)}destroy(e){this.colorAttachment.destroy(e)}createRenderPass(e,t,a,r=null){l.copyRenderPassDescriptor(this.renderPassDescriptor,a),this.renderPassDescriptor.colorAttachment=this.colorAttachment.gfxAttachment,this.renderPassDescriptor.colorResolveTo=r,this.renderPassDescriptor.depthStencilAttachment=this.depthStencilAttachment.gfxAttachment;const n=e.createRenderPass(this.renderPassDescriptor);return l.setViewportOnRenderPass(n,t,this.colorAttachment),n}}t.WeirdFancyRenderTarget=g;const _={colorAttachment:null,colorResolveTo:null,depthStencilAttachment:null,colorClearColor:o.TransparentBlack,depthStencilResolveTo:null,colorLoadDisposition:0,depthClearValue:1,depthLoadDisposition:1,stencilClearValue:0,stencilLoadDisposition:1};t.BloomPostFXParameters=class{constructor(){this.threshold=0,this.intensity1=50/256,this.intensity2=25/256,this.bloomIntensity=25/256}};const S=[{numUniformBuffers:1,numSamplers:1}];function b(e,t,a,r=h.fullscreenMegaState,n=l.DEFAULT_NUM_SAMPLES){const s=t.createProgram(e,a);return t.createRenderPipeline(e,{bindingLayouts:S,inputLayout:null,megaStateDescriptor:r,topology:0,program:s,sampleCount:n})}t.BloomPostFXRenderer=class{constructor(e,t,a){this.textureMapping=s.nArray(1,()=>new n.TextureMapping),this.bloomObjectsTexture=new l.ColorTexture,this.scratch1ColorTarget=new l.PostFXRenderTarget,this.scratch1ColorTexture=new l.ColorTexture,this.scratch2ColorTarget=new l.PostFXRenderTarget,this.scratch2ColorTexture=new l.ColorTexture,this.bloomSampler=t.createSampler(e,{wrapS:0,wrapT:0,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:100}),this.textureMapping[0].gfxSampler=this.bloomSampler,this.bloomObjectsTarget=new g(a.depthStencilAttachment),this.thresholdPipeline=b(e,t,new m),this.blur1Pipeline=b(e,t,new f),this.blur2Pipeline=b(e,t,new A),this.combinePipeline=b(e,t,new u,h.makeMegaState(h.setAttachmentStateSimple({},{blendMode:i.GfxBlendMode.ADD,blendSrcFactor:i.GfxBlendFactor.ONE,blendDstFactor:i.GfxBlendFactor.ONE}),h.fullscreenMegaState))}allocateParameterBuffer(e,t){const a=e.getTemplateRenderInst().getUniformBuffer(),r=a.allocateChunk(4),n=a.mapBufferF32(r,4);let s=r;return s+=c.fillVec4(n,s,t.threshold,t.intensity1,t.intensity2,t.bloomIntensity),r}pipelinesReady(e){return!!e.queryPipelineReady(this.thresholdPipeline)&&(!!e.queryPipelineReady(this.blur1Pipeline)&&(!!e.queryPipelineReady(this.blur2Pipeline)&&!!e.queryPipelineReady(this.combinePipeline)))}renderBeginObjects(e,t){return s.assert(this.pipelinesReady(e)),this.bloomObjectsTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.bloomObjectsTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.bloomObjectsTarget.createRenderPass(e,t.viewport,_,this.bloomObjectsTexture.gfxTexture)}renderEndObjects(e,t,a,r,n,s,i){e.submitPass(t);const o=n.backbufferWidth>>2,c=n.backbufferHeight>>2,d=this.scratch1ColorTarget,u=this.scratch1ColorTexture;d.setParameters(e,o,c,1),u.setParameters(e,o,c);const m=a.newRenderInst();m.setFromTemplate(s),m.setMegaStateFlags(h.fullscreenMegaState),m.setBindingLayouts(S),m.setUniformBufferOffset(0,i,4),m.drawPrimitives(3);const p=d.createRenderPass(e,l.IdentityViewportCoords,l.noClearRenderPassDescriptor,u.gfxTexture);m.setGfxRenderPipeline(this.thresholdPipeline),this.textureMapping[0].gfxTexture=this.bloomObjectsTexture.gfxTexture,m.setSamplerBindingsFromTextureMappings(this.textureMapping),m.drawOnPass(e,a.gfxRenderCache,p),e.submitPass(p);const f=this.scratch2ColorTarget,A=this.scratch2ColorTexture;f.setParameters(e,o,c,1),A.setParameters(e,o,c);const g=f.createRenderPass(e,l.IdentityViewportCoords,l.noClearRenderPassDescriptor,A.gfxTexture);m.setGfxRenderPipeline(this.blur1Pipeline),this.textureMapping[0].gfxTexture=u.gfxTexture,m.setSamplerBindingsFromTextureMappings(this.textureMapping),m.drawOnPass(e,a.gfxRenderCache,g),e.submitPass(g);const _=this.scratch1ColorTarget,b=this.scratch1ColorTexture,v=_.createRenderPass(e,l.IdentityViewportCoords,l.noClearRenderPassDescriptor,b.gfxTexture);m.setGfxRenderPipeline(this.blur2Pipeline),this.textureMapping[0].gfxTexture=A.gfxTexture,m.setSamplerBindingsFromTextureMappings(this.textureMapping),m.drawOnPass(e,a.gfxRenderCache,v),e.submitPass(v);const w=r.createRenderPass(e,l.IdentityViewportCoords,l.noClearRenderPassDescriptor);return l.setScissorOnRenderPass(w,n.viewport,r.colorAttachment),m.setGfxRenderPipeline(this.combinePipeline),this.textureMapping[0].gfxTexture=b.gfxTexture,m.setSamplerBindingsFromTextureMappings(this.textureMapping),m.drawOnPass(e,a.gfxRenderCache,w),a.returnRenderInst(m),w}destroy(e){this.bloomObjectsTexture.destroy(e),this.bloomObjectsTarget.destroy(e),this.scratch1ColorTarget.destroy(e),this.scratch1ColorTexture.destroy(e),this.scratch2ColorTarget.destroy(e),this.scratch2ColorTexture.destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(40),n=a(2);t.drawBufferInitialTable=[{DrawBufferType:38,Flags:16,LightType:-1,DrawCameraType:0},{DrawBufferType:4,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:29,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:20,Flags:4,LightType:0,DrawCameraType:0},{DrawBufferType:21,Flags:8,LightType:0,DrawCameraType:0},{DrawBufferType:22,Flags:8,LightType:0,DrawCameraType:0},{DrawBufferType:23,Flags:1,LightType:2,DrawCameraType:0},{DrawBufferType:16,Flags:80,LightType:1,DrawCameraType:0},{DrawBufferType:18,Flags:64,LightType:1,DrawCameraType:0},{DrawBufferType:19,Flags:64,LightType:1,DrawCameraType:0},{DrawBufferType:31,Flags:64,LightType:1,DrawCameraType:0},{DrawBufferType:0,Flags:32,LightType:3,DrawCameraType:0},{DrawBufferType:24,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:25,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:26,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:27,Flags:16,LightType:1,DrawCameraType:0},{DrawBufferType:40,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:17,Flags:32,LightType:1,DrawCameraType:0},{DrawBufferType:11,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:12,Flags:64,LightType:1,DrawCameraType:0},{DrawBufferType:13,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:14,Flags:64,LightType:2,DrawCameraType:0},{DrawBufferType:15,Flags:64,LightType:1,DrawCameraType:0},{DrawBufferType:8,Flags:256,LightType:3,DrawCameraType:0},{DrawBufferType:9,Flags:32,LightType:2,DrawCameraType:0},{DrawBufferType:10,Flags:64,LightType:1,DrawCameraType:0},{DrawBufferType:39,Flags:256,LightType:3,DrawCameraType:2},{DrawBufferType:32,Flags:8,LightType:3,DrawCameraType:0},{DrawBufferType:33,Flags:8,LightType:1,DrawCameraType:0},{DrawBufferType:34,Flags:8,LightType:3,DrawCameraType:0},{DrawBufferType:5,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:1,Flags:4,LightType:3,DrawCameraType:0},{DrawBufferType:2,Flags:8,LightType:3,DrawCameraType:0},{DrawBufferType:3,Flags:4,LightType:3,DrawCameraType:0},{DrawBufferType:6,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:7,Flags:64,LightType:3,DrawCameraType:0},{DrawBufferType:35,Flags:1,LightType:3,DrawCameraType:0},{DrawBufferType:30,Flags:16,LightType:3,DrawCameraType:0},{DrawBufferType:36,Flags:16,LightType:-1,DrawCameraType:1},{DrawBufferType:37,Flags:16,LightType:-1,DrawCameraType:1}];class s{constructor(e){this.modelInstance=e,this.shapeOrderOpa=[],this.shapeOrderXlu=[];const t=this.modelInstance.modelData,a=n.range(0,t.shapeData.length);a.sort((e,a)=>{const r=t.modelMaterialData.materialData[t.shapeData[e].shape.materialIndex].material,n=t.modelMaterialData.materialData[t.shapeData[a].shape.materialIndex].material;return r.name.localeCompare(n.name)});for(let e=0;e<a.length;e++){const r=t.shapeData[a[e]].shape;t.modelMaterialData.materialData[r.materialIndex].material.translucent?this.shapeOrderXlu.push(a[e]):this.shapeOrderOpa.push(a[e])}}draw(e,t,a,r,n,s){if(this.modelInstance.visible&&this.modelInstance.isAnyShapeVisible())for(let i=0;i<n.length;i++){const o=this.modelInstance.shapeInstances[n[i]];o.visible&&o.prepareToRender(e,t,s,a,r,this.modelInstance.modelData,this.modelInstance.materialInstanceState,this.modelInstance.shapeInstanceState)}}drawOpa(e,t,a,r){this.draw(e,t,a,r,this.shapeOrderOpa,-1)}drawXlu(e,t,a,r){const n=this.modelInstance.computeDepth(a);this.draw(e,t,a,r,this.shapeOrderXlu,n)}}class i{constructor(e){this.tableEntry=e,this.drawBufferExecuters=[]}drawOpa(e,t,a,r){for(let n=0;n<this.drawBufferExecuters.length;n++)this.drawBufferExecuters[n].drawOpa(e,t,a,r)}drawXlu(e,t,a,r){for(let n=0;n<this.drawBufferExecuters.length;n++)this.drawBufferExecuters[n].drawXlu(e,t,a,r)}registerDrawBuffer(e){return this.drawBufferExecuters.push(new s(e.modelInstance)),this.drawBufferExecuters.length-1}findLightInfo(e,t){e.actorLightCtrl.lightType=this.tableEntry.LightType}hasVisible(){for(let e=0;e<this.drawBufferExecuters.length;e++)if(this.drawBufferExecuters[e].modelInstance.visible)return!0;return!1}}t.DrawBufferGroup=i;t.DrawBufferHolder=class{constructor(e){this.groups=[];for(let t=0;t<e.length;t++){const a=e[t];this.groups[a.DrawBufferType]=new i(a)}}registerDrawBuffer(e,t){return this.groups[t].registerDrawBuffer(e)}findLightInfo(e,t,a){this.groups[t].findLightInfo(e,a)}findLightType(e){return e<0?-1:this.groups[e].tableEntry.LightType}drawAllBuffers(e,t,a,r){for(let n=0;n<this.groups.length;n++){void 0!==this.groups[n]&&(this.drawOpa(e,t,a,r,n),this.drawXlu(e,t,a,r,n))}}drawOpa(e,t,a,n,s){t.pushTemplateRenderInst().filterKey=r.createFilterKeyForDrawBufferType(0,s),this.groups[s].drawOpa(e,t,a,n),t.popTemplateRenderInst()}drawXlu(e,t,a,n,s){t.pushTemplateRenderInst().filterKey=r.createFilterKeyForDrawBufferType(1,s),this.groups[s].drawXlu(e,t,a,n),t.popTemplateRenderInst()}drawBufferHasVisible(e){return this.groups[e].hasVisible()}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(0),s=a(2),i=a(28);class o{constructor(){this.length=0,this.posIdx=0,this.faceNrmIdx=0,this.edge0NrmIdx=0,this.edge1NrmIdx=0,this.edge2NrmIdx=0,this.attrib=0}}t.KC_PrismData=o;const l=r.vec3.create(),c=r.vec3.create(),h=r.vec3.create(),d=r.vec3.create();t.CheckArrowResult=class{constructor(){this.prisms=n.nArray(32,()=>null),this.distances=n.nArray(32,()=>-1)}reset(){for(let e=0;e<this.prisms.length;e++)this.prisms[e]=null;for(let e=0;e<this.distances.length;e++)this.distances[e]=-1}};const u=new class{constructor(){this.prismListOffs=-1,this.shiftR=-1}},m=new class{constructor(){this.dist=-1}};t.KCollisionServer=class{constructor(e,t){this.blocksTrans=r.vec3.create(),this.prisms=[],this.params=null,this.view=e.createDataView(),this.positionsOffs=this.view.getUint32(0),this.normalsOffs=this.view.getUint32(4);const a=this.view.getUint32(8);this.blocksOffs=this.view.getUint32(12),this.maxDistMul=this.view.getFloat32(16);for(let e=a+16;e<this.blocksOffs;e+=16){const t=new o;t.length=this.view.getFloat32(e+0),t.posIdx=this.view.getUint16(e+4),t.faceNrmIdx=this.view.getUint16(e+6),t.edge0NrmIdx=this.view.getUint16(e+8),t.edge1NrmIdx=this.view.getUint16(e+10),t.edge2NrmIdx=this.view.getUint16(e+12),t.attrib=this.view.getUint16(e+14),this.prisms.push(t)}const n=this.view.getFloat32(20),s=this.view.getFloat32(24),l=this.view.getFloat32(28);r.vec3.set(this.blocksTrans,n,s,l),this.maskX=this.view.getUint32(32),this.maskY=this.view.getUint32(36),this.maskZ=this.view.getUint32(40),this.shiftR=this.view.getInt32(44),this.shiftLY=this.view.getInt32(48),this.shiftLZ=this.view.getInt32(52),null!==t&&(this.params=i.createCsvParser(t))}getAttributes(e){return null!==this.params?(this.params.setRecord(this.prisms[e].attrib),this.params):null}toIndex(e){return this.prisms.indexOf(e)}getPrismData(e){return this.prisms[e]}getFaceNormal(e,t){this.loadNormal(e,t.faceNrmIdx)}getEdgeNormal1(e,t){this.loadNormal(e,t.edge0NrmIdx)}getEdgeNormal2(e,t){this.loadNormal(e,t.edge1NrmIdx)}getEdgeNormal3(e,t){this.loadNormal(e,t.edge2NrmIdx)}getPos(e,t,a){if(0===a)this.loadPosition(e,t.posIdx);else{1===a?(this.loadNormal(l,t.edge1NrmIdx),this.loadNormal(c,t.faceNrmIdx)):2===a&&(this.loadNormal(l,t.faceNrmIdx),this.loadNormal(c,t.edge0NrmIdx)),r.vec3.cross(l,l,c),this.loadNormal(c,t.edge2NrmIdx);const n=t.length/r.vec3.dot(l,c);this.loadPosition(c,t.posIdx),r.vec3.scaleAndAdd(e,c,l,n)}}loadPosition(e,t){const a=this.positionsOffs+12*t;e[0]=this.view.getFloat32(a+0),e[1]=this.view.getFloat32(a+4),e[2]=this.view.getFloat32(a+8)}loadNormal(e,t){const a=this.normalsOffs+12*t;e[0]=this.view.getFloat32(a+0),e[1]=this.view.getFloat32(a+4),e[2]=this.view.getFloat32(a+8)}loadPrismListIdx(e){const t=this.view.getUint16(e);return t>0?n.assertExists(this.prisms[t-1]):null}checkPoint(e,t,a){a*=this.maxDistMul;const n=t[0]-this.blocksTrans[0]|0,s=t[1]-this.blocksTrans[1]|0,i=t[2]-this.blocksTrans[2]|0;if(0!=(n&this.maskX)||0!=(s&this.maskY)||0!=(i&this.maskZ))return!1;this.searchBlock(u,n,s,i);let o=u.prismListOffs;for(;;){o+=2;const n=this.loadPrismListIdx(o);if(null===n)return!1;if(n.length<=0)continue;if(this.loadPosition(l,n.posIdx),r.vec3.sub(l,t,l),this.loadNormal(c,n.edge0NrmIdx),r.vec3.dot(l,c)<0)continue;if(this.loadNormal(c,n.edge1NrmIdx),r.vec3.dot(l,c)<0)continue;if(this.loadNormal(c,n.edge2NrmIdx),r.vec3.dot(l,c)<n.length)continue;this.loadNormal(c,n.faceNrmIdx);const s=-r.vec3.dot(c,t);if(!(s<0||s>a))return e.dist=s,!0}}isInsideMinMaxInLocalSpace(e){const t=0|e[0],a=0|e[1],r=0|e[2];return 0==(t&this.maskX)&&0==(a&this.maskY)&&0==(r&this.maskZ)}KCHitArrow(e,t,a,n){this.loadNormal(h,t.faceNrmIdx),this.loadPosition(d,t.posIdx),r.vec3.sub(d,a,d);const s=r.vec3.dot(h,d);if(s<0)return!1;const i=r.vec3.dot(h,n);if(s+i>=0)return!1;const o=s/-i;return r.vec3.scaleAndAdd(h,d,n,o),this.loadNormal(d,t.edge0NrmIdx),!(r.vec3.dot(h,d)>=.01)&&(this.loadNormal(d,t.edge1NrmIdx),!(r.vec3.dot(h,d)>=.01)&&(this.loadNormal(d,t.edge2NrmIdx),!(r.vec3.dot(h,d)>=.01+t.length)&&(e.dist=o,!0)))}checkArrow(e,t,a,n){const i=r.vec3.copy(l,n),o=r.vec3.copy(c,a);let h=r.vec3.length(i);if(r.vec3.normalize(i,i),r.vec3.sub(o,o,this.blocksTrans),!this.isInsideMinMaxInLocalSpace(o)){if(0!==i[0]){const e=((i[0]>0?~this.maskX>>>0:0)-o[0])/i[0];if(!(e>=0&&e<=h))return!1;r.vec3.scaleAndAdd(o,o,i,e),h-=e}if(0!==i[1]){const e=((i[1]>0?~this.maskY>>>0:0)-o[1])/i[1];if(!(e>=0&&e<=h))return!1;r.vec3.scaleAndAdd(o,o,i,e),h-=e}if(0!==i[2]){const e=((i[2]>0?~this.maskZ>>>0:0)-o[2])/i[2];if(!(e>=0&&e<=h))return!1;r.vec3.scaleAndAdd(o,o,i,e),h-=e}}let d=0;for(;;){if(h<0)return!1;if(!this.isInsideMinMaxInLocalSpace(o))return!1;let l=0|o[0],c=0|o[1],p=0|o[2];this.searchBlock(u,l,c,p);let f=u.prismListOffs,A=1;for(;;){f+=2;const r=this.loadPrismListIdx(f);if(null===r)break;if(this.KCHitArrow(m,r,a,n)&&(m.dist<A&&(A=m.dist),null!==e.prisms&&(e.distances[d]=m.dist,e.prisms[d]=r,d++,d>=t)))return!0}if(null===e.prisms)return!0;{const e=(1<<u.shiftR)-1;let t=1e9;if(!s.isNearZero(i[0],.001)){let a;a=i[0]>=0?e+1-(l&e)+1:-(l&e)-1;const r=a/i[0];r<t&&(t=r)}if(!s.isNearZero(i[1],.001)){let a;a=i[1]>=0?e+1-(c&e)+1:-(c&e)-1;const r=a/i[1];r<t&&(t=r)}if(!s.isNearZero(i[2],.001)){let a;a=i[2]>=0?e+1-(p&e)+1:-(p&e)-1;const r=a/i[2];r<t&&(t=r)}r.vec3.scaleAndAdd(o,o,i,t),h-=t}}}searchBlock(e,t,a,r){let n;e.shiftR=this.shiftR,n=-1===this.shiftLY&&-1===this.shiftLZ?0:t>>>e.shiftR|a>>e.shiftR<<this.shiftLY|r>>e.shiftR<<this.shiftLZ;let s=this.blocksOffs;for(;;){const i=this.view.getInt32(s+4*n);if(i<-1)return void(e.prismListOffs=s+(2147483647&i));e.shiftR--,s+=i,n=t>>>e.shiftR&1|(a>>>e.shiftR&1)<<1|(r>>>e.shiftR&1)<<2}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(109),s=a(40),i=a(1),o=a(2),l=a(52),c=a(43);function h(e){return r.fallback(e.getValueNumberNoInit("MoveConditionType"),0)}function d(e){return r.fallback(e.getValueNumberNoInit("SignMotionType"),0)}function u(e){return 1===e||2===e}function m(e){return c.getCurrentRailPointArg0(e)}function p(e){return c.getCurrentRailPointArg5(e)}t.getMapPartsArgMoveConditionType=h;const f=i.vec3.create();class A extends s.NameObj{constructor(e,t,a){if(super(e,"MapPartsRotator"),this.actor=t,this.targetAngle=0,this.velocity=0,this.isOnReverse=!1,this.angle=0,this.baseHostMtx=i.mat4.create(),this.mtx=i.mat4.create(),this.spine=new n.Spine,this.rotateAngle=r.assertExists(a.getValueNumber("RotateSpeed")),this.rotateAxis=r.assertExists(a.getValueNumber("RotateAxis")),this.rotateAccelType=r.assertExists(a.getValueNumber("RotateAccelType")),this.rotateStopTime=r.assertExists(a.getValueNumber("RotateStopTime")),this.rotateType=r.assertExists(a.getValueNumber("RotateType")),this.signMotionType=d(a),2===this.rotateAccelType){const e=r.assertExists(a.getValueNumber("RotateSpeed"));this.rotateSpeed=this.rotateAngle/e}else this.rotateSpeed=.01*r.assertExists(a.getValueNumber("RotateSpeed"));0!==this.rotateSpeed?this.spine.setNerve(1):this.spine.setNerve(0),this.updateBaseHostMtx()}isWorking(){return 0!==this.spine.getCurrentNerve()&&1!==this.spine.getCurrentNerve()}updateTargetAngle(){this.rotateSpeed>0?this.targetAngle=this.angle+this.rotateAngle:this.targetAngle=this.angle-this.rotateAngle}updateBaseHostMtx(){o.computeModelMatrixR(this.baseHostMtx,this.actor.rotation[0],this.actor.rotation[1],this.actor.rotation[2])}calcRotateAxisDir(e,t){0===t?i.vec3.set(e,this.baseHostMtx[0],this.baseHostMtx[1],this.baseHostMtx[2]):1===t?i.vec3.set(e,this.baseHostMtx[4],this.baseHostMtx[5],this.baseHostMtx[6]):2===t&&i.vec3.set(e,this.baseHostMtx[8],this.baseHostMtx[9],this.baseHostMtx[10])}updateRotateMtx(){this.calcRotateAxisDir(f,this.rotateAxis),i.vec3.normalize(f,f),i.mat4.identity(this.mtx),i.mat4.rotate(this.mtx,this.mtx,.01745*this.angle,f),i.mat4.mul(this.mtx,this.mtx,this.baseHostMtx)}start(){this.updateTargetAngle(),this.updateRotateMtx(),this.spine.setNerve(3)}updateVelocity(){0!==this.rotateAngle&&this.rotateAccelType,this.isOnReverse=!1,this.velocity=this.rotateSpeed}updateAngle(e){for(this.angle=this.angle+this.velocity*e;this.angle>360;)this.angle-=360;for(;this.angle<0;)this.angle+=360}isReachedTargetAngle(){return!1}restartAtEnd(){0!==this.rotateType&&(1===this.rotateType&&(this.rotateSpeed=-1*this.rotateSpeed),this.updateTargetAngle(),u(this.signMotionType)?this.spine.setNerve(2):this.spine.setNerve(3))}movement(e,t){3===this.spine.getCurrentNerve()&&(this.updateVelocity(),this.updateAngle(l.getDeltaTimeFrames(t)),0!==this.rotateAccelType&&2!==this.rotateAccelType||!this.isReachedTargetAngle()?1===this.rotateAccelType&&0===this.velocity?this.spine.setNerve(4):this.updateRotateMtx():(this.angle=this.targetAngle,this.updateRotateMtx(),this.rotateStopTime<1?this.restartAtEnd():this.spine.setNerve(4))),super.movement(e,t)}}t.MapPartsRotator=A;class g{constructor(e){this.actor=e,this.currentRailPointId=-1}getCurrentPointId(){return this.actor.railRider.currentPointId}start(){this.currentRailPointId=this.getCurrentPointId()}isPassed(){return this.currentRailPointId!==this.getCurrentPointId()}isReachedEnd(){return this.actor.railRider.isReachedGoal()}movement(){this.currentRailPointId=this.getCurrentPointId()}}function _(e,t,a){const r=t.actor.getSensor("body");return t.actor.receiveMessage(e,a,r,r)}class S extends s.NameObj{constructor(e,t,a){super(e,"MapPartsRailMover"),this.actor=t,this.translation=i.vec3.create(),this.stopTime=0,this.accelTime=0,this.accel=0,this.moveSpeed=0,this.startMoveCoord=0,this.mtx=i.mat4.create(),this.passChecker=new g(this.actor),this.spine=new n.Spine,this.moveConditionType=h(a),this.moveStopType=function(e){return r.fallback(e.railRider.bezierRail.railIter.getValueNumberNoInit("path_arg1"),1)}(this.actor),this.signMotionType=d(a);const s=function(e){const t=r.assertExists(e.railRider);return r.fallback(t.bezierRail.railIter.getValueNumberNoInit("path_arg4"),0)}(this.actor);0===s?c.moveCoordAndTransToNearestRailPos(this.actor):1===s?c.moveCoordAndTransToNearestRailPoint(this.actor):2===s&&c.moveCoordAndTransToRailStartPoint(this.actor),i.vec3.copy(this.translation,this.actor.translation),this.startRailCoord=c.getRailCoord(this.actor),this.spine.setNerve(0)}isWorking(){return 2===this.spine.getCurrentNerve()||1===this.spine.getCurrentNerve()}isReachedEnd(){const e=this.spine.getCurrentNerve();return(2===e||1===e)&&this.passChecker.isReachedEnd()}isDone(){return(0===this.moveStopType||3===this.moveStopType)&&this.isReachedEnd()}start(){this.moveToInitPos(),u(this.signMotionType)?this.spine.setNerve(1):this.spine.setNerve(2)}moveToInitPos(){o.isNearZero(this.startRailCoord-c.getRailCoord(this.actor),.001)&&(c.setRailCoord(this.actor,this.startRailCoord),c.getRailPos(this.translation,this.actor),c.isRailGoingToEnd(this.actor)||c.reverseRailDirection(this.actor))}calcMoveSpeedTime(){const e=r.fallback((t=this.actor,c.getCurrentRailPointArg0(t)),-1);var t;if(e>=0){let t=c.getCurrentRailPointNo(this.actor);return c.isRailGoingToEnd(this.actor)||(t-=1),c.getRailPartLength(this.actor,t)/e}throw"whoops"}calcMoveSpeedDirect(){return r.assertExists(m(this.actor))}calcMoveSpeed(){if(o.isNearZero(this.accel,1e-4)){return 1===r.fallback((e=this.actor,c.getCurrentRailPointArg7(e)),0)?this.calcMoveSpeedTime():this.calcMoveSpeedDirect()}return c.getRailCoordSpeed(this.actor);var e}updateAccel(){var e;if(this.accelTime=r.fallback((e=this.actor,c.getCurrentRailPointArg1(e)),0),this.accelTime<1)this.accel=0;else{const e=r.fallback(m(this.actor),-1);this.accel=e>=0?(e-this.moveSpeed)/this.accelTime:0}}movement(e,t){const a=this.spine.getCurrentNerve();if(2===a||1===a?this.tryPassPoint(e):this.tryRestartAtEnd(),this.passChecker.movement(),this.spine.changeNerve(),this.spine.updateTick(l.getDeltaTimeFrames(t)),2===a)n.isFirstStep(this)&&(this.updateAccel(),this.moveSpeed=this.calcMoveSpeed(),_(e,this,205)),!o.isNearZero(this.accel,1e-4)&&n.getStep(this)<this.accelTime&&(this.moveSpeed+=this.accel),c.moveCoordAndFollowTrans(this.actor,this.moveSpeed);else if(1===a)if(n.isFirstStep(this)&&(this.startMoveCoord=c.getRailCoord(this.actor)),n.isGreaterStep(this,50))c.setRailCoord(this.actor,this.startMoveCoord),c.getRailPos(this.actor.translation,this.actor),this.spine.setNerve(1);else{const e=n.getStep(this),t=(c.isRailGoingToEnd(this.actor)?-1:1)*(0==(e/3&1)?-1:1);c.setRailCoord(this.actor,this.startMoveCoord+7*t*(e%3)),c.getRailPos(this.actor.translation,this.actor)}else 3===a||5===a?(n.isFirstStep(this)&&(this.moveSpeed=0,this.accel=0,c.setRailCoordSpeed(this.actor,0)),n.isGreaterStep(this,this.stopTime)&&(3===a?_(e,this,203)?this.spine.setNerve(4):this.spine.setNerve(5):this.spine.setNerve(2))):6===a||8===a?!this.tryRestartAtEnd()&&n.isGreaterStep(this,this.stopTime)&&(6===a?_(e,this,203)?this.spine.setNerve(7):this.spine.setNerve(8):this.restartAtEnd()):9===a&&n.isFirstStep(this)&&_(e,this,207);this.spine.changeNerve(),super.movement(e,t)}reachedEndPlayerOn(){}setStateStopAtEndBeforeRotate(e){this.moveSpeed=0,this.accel=0,c.setRailCoordSpeed(this.actor,0),this.stopTime=r.fallback(p(this.actor),0),this.stopTime<1?_(e,this,203)?this.spine.setNerve(7):this.restartAtEnd():this.spine.setNerve(3)}reachedEnd(e){1===this.moveStopType&&c.reverseRailDirection(this.actor),1===this.moveConditionType?this.reachedEndPlayerOn():this.setStateStopAtEndBeforeRotate(e)}tryPassPoint(e){return this.passChecker.isReachedEnd()?0===this.moveStopType?(this.spine.setNerve(0),!0):(this.reachedEnd(e),!0):!!this.passChecker.isPassed()&&(this.passPoint(e),!0)}passPoint(e){this.stopTime=r.fallback(p(this.actor),0),this.stopTime<1?_(e,this,205)||(_(e,this,203)?this.spine.setNerve(4):this.spine.setNerve(2)):this.spine.setNerve(3)}tryRestartAtEnd(){const e=this.spine.getCurrentNerve();return 2===e||1===e}restartAtEnd(){0===this.moveStopType?this.spine.setNerve(0):1===this.moveStopType?u(this.signMotionType)?this.spine.setNerve(1):this.spine.setNerve(2):2===this.moveStopType?(c.moveCoordToStartPos(this.actor),c.getRailPos(this.actor.translation,this.actor),this.spine.setNerve(2)):3===this.moveStopType&&this.spine.setNerve(9)}}t.MapPartsRailMover=S},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(28),n=a(93),s=a(225),i=a(142),o=a(166),l=a(79);function c(e){return function(t,a){for(let a=0;a<e.length;a++)t.modelCache.requestObjectData(e[a])}}function h(e,t,a=null,r=3){return{objName:e,factoryFunc:t,requestArchivesFunc:a,gameBits:r}}function d(e,t=3){return{objName:e,factoryFunc:null,requestArchivesFunc:null,gameBits:t}}function u(e,t,a=null,r=3){let n;return n=null!==a?function(e,r){t.requestArchives(e,r),a(e,r)}:t.requestArchives,{objName:e,factoryFunc:function(e,a,r){return new t(e,a,r)},requestArchivesFunc:n,gameBits:r}}const m=[u("FishGroupA",n.FishGroup),u("FishGroupB",n.FishGroup),u("FishGroupC",n.FishGroup),u("FishGroupD",n.FishGroup),u("FishGroupE",n.FishGroup),u("FishGroupF",n.FishGroup),u("SeaGullGroup",n.SeaGullGroup),u("AsteroidA",n.SimpleEnvironmentObj),u("AsteroidB",n.SimpleEnvironmentObj),u("AsteroidC",n.SimpleEnvironmentObj),u("AsteroidD",n.SimpleEnvironmentObj),u("SpaceStickA",n.SimpleEnvironmentObj),u("SpaceStickB",n.SimpleEnvironmentObj),u("KillerGunnerDouble",n.SimpleEnvironmentObj),u("KillerGunnerTriple",n.SimpleEnvironmentObj),u("LavaSpaceStickA",n.SimpleEnvironmentObj),u("LavaSpaceStickB",n.SimpleEnvironmentObj),u("LavaBlackUFO",n.SimpleEnvironmentObj),u("SpaceDustWoodA",n.SimpleEnvironmentObj),u("SpaceDustWoodB",n.SimpleEnvironmentObj),u("PhantomDecoratePartsA",n.SimpleEnvironmentObj),u("PhantomDecoratePartsB",n.SimpleEnvironmentObj),u("PhantomDecoratePartsHole",n.SimpleEnvironmentObj),u("DeathSandEnvironmentSapotenA",n.SimpleEnvironmentObj),u("DeathSandEnvironmentSapotenB",n.SimpleEnvironmentObj),u("DeathSandEnvironmentRock",n.SimpleEnvironmentObj),u("DeathSandEnvironmentPyramid",n.SimpleEnvironmentObj),u("SweetDecoratePartsOrange",n.SimpleEnvironmentObj),u("Dossun",n.Dossun),u("Tsukidashikun",n.Tsukidashikun),u("Onimasu",n.OnimasuJump),u("Butler",n.Butler),u("Kinopio",n.Kinopio),u("KinopioAstro",n.KinopioAstro),u("Peach",n.Peach),u("Penguin",n.Penguin),u("PenguinRacer",n.PenguinRacer),u("PenguinRacerLeader",n.PenguinRacer),u("Rosetta",n.Rosetta),u("SignBoard",n.SignBoard),u("Tico",n.Tico),u("TicoAstro",n.TicoAstro),u("TicoComet",n.TicoComet),u("TicoRail",n.TicoRail),h("Coin",n.createCoin,n.requestArchivesCoin),h("PurpleCoin",n.createPurpleCoin,n.requestArchivesPurpleCoin),h("RailCoin",n.createRailCoin,n.requestArchivesCoin),h("PurpleRailCoin",n.createPurpleRailCoin,n.requestArchivesPurpleCoin),h("CircleCoinGroup",n.createCircleCoinGroup,n.requestArchivesCoin),h("CirclePurpleCoinGroup",n.createPurpleCircleCoinGroup,n.requestArchivesPurpleCoin),u("QuestionCoin",n.QuestionCoin),u("AirBubble",n.AirBubble),u("AirBubbleGenerator",n.AirBubbleGenerator),u("BlackHole",n.BlackHole),u("BlackHoleCube",n.BlackHole),u("BlueChip",n.BlueChip),u("ChooChooTrain",n.ChooChooTrain),u("CoconutTreeLeaf",n.CoconutTreeLeafGroup),u("CollapsePlane",n.CollapsePlane),u("CrystalCageS",n.CrystalCage),u("CrystalCageM",n.CrystalCage),u("CrystalCageL",n.CrystalCage),u("EarthenPipe",n.EarthenPipe),u("EarthenPipeInWater",n.EarthenPipe),u("ElectricRail",n.ElectricRail),u("ElectricRailMoving",n.ElectricRailMoving),u("FlagKoopaA",n.Flag),u("FlagKoopaB",n.Flag),u("FlagKoopaCastle",n.Flag),u("FlagPeachCastleA",n.Flag),u("FlagPeachCastleB",n.Flag),u("FlagPeachCastleC",n.Flag),u("FlagRaceA",n.Flag),u("FluffWind",n.FluffWind),u("Fountain",n.Fountain),u("FountainBig",n.FountainBig),u("GCaptureTarget",n.GCaptureTarget),u("OceanBowl",s.OceanBowl),u("OceanPierFloaterA",n.OceanWaveFloater),u("OceanHexagonFloater",n.OceanWaveFloater),u("OceanRing",n.OceanRing),u("OceanRingAndFlag",n.OceanRing),u("PalmIsland",n.PalmIsland),u("PhantomBonfire",n.PhantomTorch),u("PhantomTorch",n.PhantomTorch),u("PunchBox",n.PunchBox),u("ShellfishCoin",n.Shellfish),u("ShellfishYellowChip",n.Shellfish),u("ShootingStar",n.ShootingStar),u("StarPiece",n.StarPiece),u("StarPieceGroup",n.StarPieceGroup),u("SubmarineSteam",n.SubmarineSteam),u("SubmarineVolcano",n.SubmarineSteam),h("SuperSpinDriver",n.createSuperSpinDriverYellow,n.requestArchivesSuperSpinDriver),h("SuperSpinDriverGreen",n.createSuperSpinDriverGreen,n.requestArchivesSuperSpinDriver),h("SuperSpinDriverPink",n.createSuperSpinDriverPink,n.requestArchivesSuperSpinDriver),u("SwingRope",n.SwingRope),u("Trapeze",n.Trapeze),u("TreasureBoxCrackedEmpty",n.TreasureBoxCracked),u("TreasureBoxCrackedCoin",n.TreasureBoxCracked),u("TreasureBoxCrackedYellowChip",n.TreasureBoxCracked),u("TreasureBoxCrackedBlueChip",n.TreasureBoxCracked),u("TreasureBoxCrackedKinokoOneUp",n.TreasureBoxCracked),u("TreasureBoxCrackedKinokoLifeUp",n.TreasureBoxCracked),u("TreasureBoxCrackedAirBubble",n.TreasureBoxCracked),u("TreasureBoxCrackedPowerStar",n.TreasureBoxCracked),u("TreasureBoxEmpty",n.TreasureBoxCracked),u("TreasureBoxCoin",n.TreasureBoxCracked),u("TreasureBoxYellowChip",n.TreasureBoxCracked),u("TreasureBoxBlueChip",n.TreasureBoxCracked),u("TreasureBoxKinokoOneUp",n.TreasureBoxCracked),u("TreasureBoxKinokoLifeUp",n.TreasureBoxCracked),u("TreasureBoxGoldEmpty",n.TreasureBoxCracked),u("WarpPod",n.WarpPod),u("WaterLeakPipe",n.WaterLeakPipe),u("WaterPlant",n.WaterPlant),u("WoodBox",n.WoodBox),u("YellowChip",n.YellowChip),u("FlowerGroup",n.PlantGroup,c(["Flower"]),1),u("FlowerBlueGroup",n.PlantGroup,c(["FlowerBlue"]),1),u("CutBushGroup",n.PlantGroup,c(["CutBush"]),1),d("FlowerGroup",2),d("FlowerBlueGroup",2),d("CutBushGroup",2),u("AstroDomeSky",n.Sky),u("AstroDomeSkyA",n.Sky),u("AuroraSky",n.Sky),u("BigFallSky",n.Sky),u("Blue2DSky",n.Sky),u("BrightGalaxySky",n.Sky),u("ChildRoomSky",n.Sky),u("CloudSky",n.Sky),u("DarkSpaceStormSky",n.Sky),u("DesertSky",n.Sky),u("DotPatternSky",n.Sky),u("FamicomMarioSky",n.Sky),u("GalaxySky",n.Sky),u("GoodWeatherSky",n.Sky),u("GreenPlanetOrbitSky",n.Sky),u("HalfGalaxySky",n.Sky),u("HolePlanetInsideSky",n.Sky),u("KoopaVS1Sky",n.Sky),u("KoopaVS2Sky",n.Sky),u("KoopaJrLv3Sky",n.Sky),u("MagmaMonsterSky",n.Sky),u("MemoryRoadSky",n.Sky),u("MilkyWaySky",n.Sky),u("OmoteuLandSky",n.Sky),u("PhantomSky",n.Sky),u("RockPlanetOrbitSky",n.Sky),u("SummerSky",n.Sky),u("VRDarkSpace",n.Sky),u("VROrbit",n.Sky),u("VRSandwichSun",n.Sky),u("VsKoopaLv3Sky",n.Sky),u("HomeAir",n.Air),u("SphereAir",n.PriorDrawAir),u("SunsetAir",n.Air),u("FineAir",n.Air),u("DimensionAir",n.Air),u("DarknessRoomAir",n.Air),u("TwilightAir",n.Air),u("BeyondGalaxySky",n.Sky),u("BeyondHellValleySky",n.Sky),u("BeyondHorizonSky",n.Sky),u("BeyondOrbitSky",n.Sky),u("BeyondPhantomSky",n.Sky),u("BeyondSandSky",n.Sky),u("BeyondSandNightSky",n.Sky),u("BeyondSummerSky",n.Sky),u("BeyondTitleSky",n.Sky),u("FineAndStormSky",n.Sky),u("BeyondDimensionAir",n.Air),u("FloaterLandPartsFrame",n.SimpleMapObj),u("TemplateStageGeometry",n.SimpleMapObj),u("WaterfallCaveNoBreakCover",n.SimpleMapObj),u("SeaBottomTriplePropellerStand",n.SimpleMapObj),u("FlipPanelFrame",n.SimpleMapObj),u("SpaceMineRailA",n.SimpleMapObj),u("SpaceMineRail5m",n.SimpleMapObj),u("SandUpDownKillerGunnerBase",n.SimpleMapObj),u("CaretakerGarbage",n.SimpleMapObj),u("GlassBottleTall",n.SimpleMapObj),u("PhantomFirewood",n.SimpleMapObj),u("ArrowBoard",n.SimpleMapObj),u("ReverseGravityTowerInside",n.SimpleMapObj),u("DropOfWaterCore",n.SimpleMapObj),u("ForestAppearStepA",n.SimpleMapObj),u("ForestWoodCover",n.SimpleMapObj),u("StarDustStepA",n.SimpleMapObj),u("StarDustStepB",n.SimpleMapObj),u("StarPieceCluster",n.SimpleMapObj),u("SpaceSeparatorA",n.SimpleMapObj),u("SpaceSeparatorB",n.SimpleMapObj),u("ForestNarrowStepA",n.SimpleMapObj),u("ForestHomeGate",n.SimpleMapObj),u("WeatherVane",n.SimpleMapObj),u("ForestPoihanaFenceA",n.SimpleMapObj),u("ForestPoihanaFenceB",n.SimpleMapObj),u("TeresaMansionBridgeA",n.SimpleMapObj),u("TeresaMansionBridgeB",n.SimpleMapObj),u("ForestHomeBridge",n.SimpleMapObj),u("ForestBarricadeRockA",n.SimpleMapObj),u("BattleShipElevatorCover",n.SimpleMapObj),u("TeresaRaceSpaceStickA",n.SimpleMapObj),u("TeresaRaceSpaceStickB",n.SimpleMapObj),u("TeresaRaceSpaceStickC",n.SimpleMapObj),u("PeachCastleTownAfterAttack",n.SimpleMapObj),u("PeachCastleTownBeforeAttack",n.SimpleMapObj,c(["PeachCastleTownBeforeAttackBloom"])),u("PeachCastleTownGate",n.SimpleMapObj),u("CocoonStepA",n.SimpleMapObj),u("CocoonStepB",n.SimpleMapObj),u("SpaceCannonLauncher",n.SimpleMapObj),u("TrapBaseA",n.SimpleMapObj),u("ColorPencil",n.SimpleMapObj),u("TeresaRacePartsBallA",n.SimpleMapObj),u("BreakDownFixStepA",n.SimpleMapObj),u("DeathSandLandPartsA",n.SimpleMapObj),u("DeathSandLandPartsB",n.SimpleMapObj),u("DeathSandLandPlatformStepA",n.SimpleMapObj),u("UFOSandObstacleA",n.SimpleMapObj),u("UFOSandObstacleB",n.SimpleMapObj),u("UFOSandObstacleC",n.SimpleMapObj),u("KameckShipLv1",n.SimpleMapObj),u("StrongBlock",n.SimpleMapObj),u("ChoConveyorChocoA",n.SimpleMapObj),u("ForestHomePartsTree",n.SimpleMapObj),u("ForestHomePartsTreeTower",n.SimpleMapObj),u("PoltaBattlePlanetPartsA",n.SimpleMapObj),u("ReverseKingdomTreeA",n.SimpleMapObj),u("HugeBattleShipPlanetEntrance",n.SimpleMapObj),u("MysteryGravityRoomBridgeA",n.SimpleMapObj),u("DarkHopperPlanetPartsA",n.SimpleMapObj),u("DarkHopperPlanetPartsC",n.SimpleMapObj),u("DarkHopperPlanetPartsD",n.SimpleMapObj),u("MiniMechaKoopaPartsFan",n.SimpleMapObj),u("RockRoadCirclA",n.SimpleMapObj),u("HellBallGuidePartsA",n.SimpleMapObj),u("IceSlipRoad",n.SimpleMapObj),u("SurfingRaceTutorialParts",n.SimpleMapObj),u("SurfingRaceMiniGate",n.SimpleMapObj),u("SurfingRaceSubGate",n.SimpleMapObj),u("SurfingRaceStep",n.SimpleMapObj),u("SurfingRaceSignBoard",n.SimpleMapObj),u("SurfingRaceVictoryStand",n.SimpleMapObj),u("HeavensDoorHouseDoor",n.SimpleMapObj),u("HeavensDoorAppearStepAAfter",n.SimpleMapObj),u("MechaKoopaPartsBody",n.SimpleMapObj),u("MechaKoopaPartsRollerA",n.SimpleMapObj),u("MechaKoopaPartsWreckA",n.SimpleMapObj),u("IceRingBumpPartsA",n.SimpleMapObj),u("IceLavaIslandSnowStepA",n.SimpleMapObj),u("ChallengeBallVanishingRoadA",n.SimpleMapObj),u("CubeBubbleExHomeStep",n.SimpleMapObj),u("CubeBubbleExStartStep",n.SimpleMapObj),u("CubeBubbleExPartsA",n.SimpleMapObj),u("UFOKinokoLanding",n.SimpleMapObj),u("KoopaShipA",n.SimpleMapObj),u("KoopaShipB",n.SimpleMapObj),u("KoopaShipC",n.SimpleMapObj),u("KoopaShipD",n.SimpleMapObj),u("KoopaShipE",n.SimpleMapObj),u("KoopaJrSmallShipAGuidePoint",n.SimpleMapObj),u("KoopaJrKillerShipA",n.SimpleMapObj),u("KoopaJrNormalShipA",n.SimpleMapObj),u("WaterRoadCaveStepB",n.SimpleMapObj),u("SubmarineVolcanoInside",n.SimpleMapObj),u("OnimasuPlanetPartsGoal",n.SimpleMapObj),u("OnimasuPlanetObstaclePartsA",n.SimpleMapObj),u("TakoBarrelB",n.SimpleMapObj),u("KoopaVS1PartsSpiralRoad",n.SimpleMapObj),u("KoopaVS1PartsReverseGRoad",n.SimpleMapObj),u("KoopaVS1PartsStairRoad",n.SimpleMapObj),u("KoopaVS1PartsBattleStage",n.SimpleMapObj),u("KoopaVS2PartsReverseGRoadA",n.SimpleMapObj),u("KoopaVS2PartsReverseGRoadB",n.SimpleMapObj),u("KoopaVS2PartsStartRestStep",n.SimpleMapObj),u("KoopaVS2PartsRestStepA",n.SimpleMapObj),u("KoopaVS2PartsRestStepB",n.SimpleMapObj),u("KoopaVS2PartsRestStepC",n.SimpleMapObj),u("KoopaVS2PartsRestStepD",n.SimpleMapObj),u("KoopaVS2PartsRestStepE",n.SimpleMapObj),u("KoopaVS2PartsRestStepF",n.SimpleMapObj),u("KoopaVS2PartsRestStepG",n.SimpleMapObj),u("KoopaVS2PartsDarkMatterA",n.SimpleMapObj),u("KoopaVS2PartsDarkMatterB",n.SimpleMapObj),u("KoopaVS2PartsDarkMatterC",n.SimpleMapObj),u("KoopaVS2PartsDarkMatterD",n.SimpleMapObj),u("KoopaVS2PartsDarkMatterE",n.SimpleMapObj),u("KoopaVS2PartsStairBig",n.SimpleMapObj),u("KoopaVS2Parts2DRailGuideA",n.SimpleMapObj),u("KoopaVS3Parts2DWallA",n.SimpleMapObj),u("OceanRingRuinsColumn",n.SimpleMapObj),u("OceanRingRuinsBase",n.SimpleMapObj),u("KameckShip",n.SimpleMapObj),u("BeachParasol",n.SimpleMapObj),u("BeachChair",n.SimpleMapObj),u("PhantomCaveStepA",n.SimpleMapObj),u("GhostShipCaveClosedRockA",n.SimpleMapObj),u("GhostShipBrokenHead",n.SimpleMapObj),u("CannonUnderConstructionA",n.SimpleMapObj),u("CannonUnderConstructionB",n.SimpleMapObj),u("AstroRoomLibrary",n.SimpleMapObj),u("UFOKinokoLandingAstro",n.SimpleMapObj),u("WhiteRoom",n.SimpleMapObj),u("OceanFloaterTowerRotateStepA",n.RotateMoveObj),u("OceanFloaterTowerRotateStepB",n.RotateMoveObj),u("OceanFloaterTowerRotateStepC",n.RotateMoveObj),u("OceanFloaterTowerRotateStepD",n.RotateMoveObj),u("HopperBeltConveyerRotatePartsA",n.RotateMoveObj),u("StarDustRollingStepA",n.RotateMoveObj),u("PowerStarKeeperA",n.RotateMoveObj),u("PowerStarKeeperB",n.RotateMoveObj),u("PowerStarKeeperC",n.RotateMoveObj),u("WaterBazookaTowerMoveStepA",n.RotateMoveObj),u("RollingOvalPlanetParts",n.RotateMoveObj),u("BattleShipMovePartsA",n.RotateMoveObj),u("BattleShipMovePartsB",n.RotateMoveObj),u("TeresaRacePartsA",n.RotateMoveObj),u("SweetsDecoratePartsSpoon",n.RotateMoveObj),u("SweetsDecoratePartsFork",n.RotateMoveObj),u("SandStreamMoveStepsA",n.RotateMoveObj),u("SandStreamMoveStepsB",n.RotateMoveObj),u("RayGunPlanetPartsGear",n.RotateMoveObj),u("ToyFactoryDecoratePartsGearA",n.RotateMoveObj),u("MiniMechaKoopaPartsGear",n.RotateMoveObj),u("MiniMechaKoopaPartsCage",n.RotateMoveObj),u("AsteroidBlockRotateStepA",n.RotateMoveObj),u("WindMillPropeller",n.RotateMoveObj),u("WindMillPropellerMini",n.RotateMoveObj),u("LavaRotateStepsRotatePartsA",n.RotateMoveObj),u("LavaRotateStepsRotatePartsB",n.RotateMoveObj),u("LavaRotateStepsRotatePartsC",n.RotateMoveObj),u("LavaRotateStepsRotatePartsD",n.RotateMoveObj),u("QuickSand2DMovePartsA",n.RotateMoveObj),u("DeathPromenadeRotateCircleL",n.RotateMoveObj),u("DeathPromenadeRotateCircleS",n.RotateMoveObj),u("HellBallRotatePartsA",n.RotateMoveObj),u("HellBallRotatePartsB",n.RotateMoveObj),u("HellBallRotatePartsC",n.RotateMoveObj),u("HellBallRotatePartsD",n.RotateMoveObj),u("HellBallRotatePartsE",n.RotateMoveObj),u("HellBallRotatePartsF",n.RotateMoveObj),u("HellBallRotatePartsG",n.RotateMoveObj),u("CandyLiftA",n.RotateMoveObj),u("CandyLiftB",n.RotateMoveObj),u("HeavensDoorMiddleRotatePartsA",n.RotateMoveObj),u("HeavensDoorMiddleRotatePartsB",n.RotateMoveObj),u("HeavensDoorInsideRotatePartsA",n.RotateMoveObj),u("HeavensDoorInsideRotatePartsB",n.RotateMoveObj),u("HeavensDoorInsideRotatePartsC",n.RotateMoveObj),u("MechaKoopaPartsCollar",n.RotateMoveObj),u("HoleBeltConveyerPartsG",n.RotateMoveObj),u("ChallengeBallAccelCylinderA",n.RotateMoveObj),u("ChallengeBallGearA",n.RotateMoveObj),u("ChallengeBallRotateBridgeA",n.RotateMoveObj),u("TrialBubbleRotateWallA",n.RotateMoveObj),u("TrialBubbleRevolvingPartsA",n.RotateMoveObj),u("CubeBubbleExRotateWallS",n.RotateMoveObj),u("CubeBubbleExRotateWallL",n.RotateMoveObj),u("WaterRoadCaveRotateGround",n.RotateMoveObj),u("OnimasuPlanetRotatePartsA",n.RotateMoveObj),u("OnimasuPlanetRotatePartsB",n.RotateMoveObj),u("KoopaVS2PartsStartMoveStepA",n.RotateMoveObj),u("KoopaVS2PartsStartMoveStepB",n.RotateMoveObj),u("KoopaVS2PartsRollingStep",n.RotateMoveObj),u("KoopaVS3RotateStepA",n.RotateMoveObj),u("KoopaVS3RotateStepB",n.RotateMoveObj),u("KoopaVS3RotateStepD",n.RotateMoveObj),u("KoopaVS3RotateStepsA",n.RotateMoveObj),u("OceanRingRuinsGearSmall",n.RotateMoveObj),u("OceanRingRuinsGearBig",n.RotateMoveObj),u("LavaHomeVolcanoInnerFlow",n.RailMoveObj),u("LavaRotatePlanetStartStep",n.RailMoveObj),u("ShutterDoorB",n.RailMoveObj),u("PhantomTowerMoveStepA",n.RailMoveObj),u("HopperBeltConveyerMovePartsA",n.RailMoveObj),u("AsteroidMoveA",n.RailMoveObj),u("WaterBazookaTowerMoveStepB",n.RailMoveObj),u("WaterBazookaTowerMoveStepC",n.RailMoveObj),u("BeeWallClimbPartsA",n.RailMoveObj),u("BroadBeanMoveStepA",n.RailMoveObj),u("BroadBeanMoveStepB",n.RailMoveObj),u("SandStreamHighTowerMoveStepA",n.RailMoveObj),u("MiniMechaKoopaPartsMoveStepA",n.RailMoveObj),u("HoleDeathSandMoveStepA",n.RailMoveObj),u("SandUpDownTowerMoveStepA",n.RailMoveObj),u("ChoConveyorMoveChocoA",n.RailMoveObj),u("BiriBiriBegomanSpikePistonA",n.RailMoveObj),u("DeathPromenadeMovePartsSpuareA",n.RailMoveObj),u("IceVolcanoMoveStepA",n.RailMoveObj),u("IceLavaIslandIceMovableStepA",n.RailMoveObj),u("IceLavaIslandLavaMovableStepA",n.RailMoveObj),u("HoleBeltConveyerPartsA",n.RailMoveObj),u("HoleBeltConveyerPartsB",n.RailMoveObj),u("HoleBeltConveyerPartsC",n.RailMoveObj),u("HoleBeltConveyerPartsD",n.RailMoveObj),u("HoleBeltConveyerPartsE",n.RailMoveObj),u("HoleBeltConveyerPartsF",n.RailMoveObj),u("HoleBeltConveyerPartsH",n.RailMoveObj),u("ChallengeBallMoveGroundA",n.RailMoveObj),u("ChallengeBallMoveGroundB",n.RailMoveObj),u("TrialBubbleMoveWallA",n.RailMoveObj),u("KoopaJrSmallShipA",n.RailMoveObj),u("WaterRoadCaveStepA",n.RailMoveObj),u("OnimasuPlanetRailMovePartsA",n.RailMoveObj),u("KoopaVS1PartsMoveStepA",n.RailMoveObj),u("KoopaVS1PartsMoveStepB",n.RailMoveObj),u("KoopaVS2PartsStartMoveStepC",n.RailMoveObj),u("KoopaVS2Parts2DMoveStepBarA",n.RailMoveObj),u("KoopaVS2Parts2DMoveStepBarB",n.RailMoveObj),u("KoopaVS2Parts2DMoveStepSBarB",n.RailMoveObj),u("KoopaVS2Parts2DMoveStepLShape",n.RailMoveObj),u("KoopaVS2Parts2DMoveStepCross",n.RailMoveObj),u("KoopaVS2PartsJoinedMoveStep",n.RailMoveObj),u("KoopaVS2PartsSquareMoveStepA",n.RailMoveObj),u("KoopaVS2PartsSquareMoveStepB",n.RailMoveObj),u("OceanRingRuinsMove",n.RailMoveObj),u("GhostShipCaveMoveGroundA",n.RailMoveObj),u("GhostShipCaveMoveGroundB",n.RailMoveObj),u("OceanFloaterTypeU",n.OceanFloaterLandParts),u("AstroCore",n.AstroCore),u("AstroCountDownPlate",n.AstroCountDownPlate),u("AstroDomeEntrance",n.AstroMapObj),u("AstroStarPlate",n.AstroMapObj),u("AstroBaseA",n.AstroMapObj),u("AstroBaseB",n.AstroMapObj),u("AstroBaseC",n.AstroMapObj),u("AstroBaseKitchen",n.AstroMapObj),u("AstroBaseCenterA",n.AstroMapObj),u("AstroBaseCenterB",n.AstroMapObj),u("AstroBaseCenterC",n.AstroMapObj),u("AstroBaseCenterTop",n.AstroMapObj),u("AstroRotateStepA",n.AstroMapObj),u("AstroRotateStepB",n.AstroMapObj),u("AstroDecoratePartsA",n.AstroMapObj),u("AstroDecoratePartsGearA",n.AstroMapObj),u("AstroChildRoom",n.AstroMapObj),u("AstroParking",n.AstroMapObj),u("AstroLibrary",n.AstroMapObj),d("AstroOverlookObj"),u("UFOKinokoUnderConstruction",n.UFOKinokoUnderConstruction),u("SurpBeltConveyerExGalaxy",n.SurprisedGalaxy),u("SurpCocoonExGalaxy",n.SurprisedGalaxy),u("SurpTearDropGalaxy",n.SurprisedGalaxy),u("SurpTeresaMario2DGalaxy",n.SurprisedGalaxy),u("SurpSnowCapsuleGalaxy",n.SurprisedGalaxy),u("SurpTransformationExGalaxy",n.SurprisedGalaxy),u("SurpFishTunnelGalaxy",n.SurprisedGalaxy),u("SurpTamakoroExLv2Galaxy",n.SurprisedGalaxy),u("SurpSurfingLv2Galaxy",n.SurprisedGalaxy),u("SurpCubeBubbleExLv2Galaxy",n.SurprisedGalaxy),u("SurpPeachCastleFinalGalaxy",n.SurprisedGalaxy),u("AstroTorchLightBlue",n.SimpleEffectObj),u("AstroTorchLightRed",n.SimpleEffectObj),u("BattleShipExplosionMetal",n.EffectObjR500F50),u("BattleShipExplosionRock",n.EffectObjR500F50),u("BirdLouseS",n.EffectObj20x20x10SyncClipping),u("BirdLouseL",n.EffectObj50x50x10SyncClipping),u("EffectTeresa",n.EffectObj50x50x10SyncClipping),u("EffectTicoS",n.AstroEffectObj),u("EffectTicoL",n.AstroEffectObj),u("FallGreenLeaf",n.EffectObj10x10x10SyncClipping),u("FallRedLeaf",n.EffectObj10x10x10SyncClipping),u("FireworksA",n.RandomEffectObj),u("ForestWaterfallL",n.EffectObjR1000F50),u("ForestWaterfallS",n.EffectObjR1000F50),u("IceLayerBreak",n.EffectObjR500F50),u("IcePlanetLight",n.EffectObjR100F50SyncClipping),u("IcicleRockLight",n.EffectObjR100F50SyncClipping),u("LavaSparksS",n.EffectObj20x20x10SyncClipping),u("LavaSparksL",n.EffectObj50x50x10SyncClipping),u("LavaSteam",n.LavaSteam),u("SandBreezeS",n.EffectObj10x10x10SyncClipping),u("SandBreezeL",n.EffectObj50x50x10SyncClipping),u("ShootingStarArea",n.RandomEffectObj),u("SnowS",n.EffectObj10x10x10SyncClipping),u("SpaceDustS",n.EffectObj20x20x10SyncClipping),u("SpaceDustL",n.EffectObj50x50x10SyncClipping),u("Steam",n.SimpleEffectObj),u("TwinFallLakeWaterFall",n.EffectObjR1000F50),u("WaterDropBottom",n.EffectObjR1000F50),u("WaterDropMiddle",n.EffectObjR1000F50),u("WaterDropTop",n.EffectObjR1000F50),u("WaterfallL",n.EffectObjR1000F50),u("WaterfallS",n.EffectObj20x20x10SyncClipping),u("WaterLayerBreak",n.EffectObjR500F50),u("UFOKinokoLandingBlackSmoke",n.EffectObjR500F50),d("CollisionBlocker"),d("GhostShipCavePipeCollision"),d("InvisibleWall10x10"),d("InvisibleWall10x20"),d("InvisibleWallJump10x20"),d("InvisibleWallGCapture10x20"),d("InvisibleWaterfallTwinFallLake"),d("PoleSquareNoModel"),d("TimerSwitch"),d("ClipFieldSwitch"),d("SoundSyncSwitch"),d("ExterminationSwitch"),d("RepeartTimerSwitch"),d("ExterminationCheckerWoodBox"),d("ExterminationCheckerLuribo"),d("ExterminationKuriboKeySwitch"),d("ExterminationPowerStar"),u("SwitchSynchronizerReverse",l.SwitchSynchronizer),d("PrologueDirector"),u("MovieStarter",n.MovieStarter),d("ScenarioStarter"),d("LuigiEvent"),d("MameMuimuiScorer"),d("MameMuimuiScorerLv2"),d("ScoreAttackCounter"),d("FlipPanelObserver"),d("PurpleCoinStarter"),d("PurpleCoinCompleteWatcher"),d("RunawayRabbitCollect"),d("GroupSwitchWatcher"),d("BlueChipGroup"),d("RockCreator"),d("OpeningDemoObj"),d("NormalEndingDemoObj"),d("MeetKoopaDemoObj"),d("StarReturnDemoStarter"),d("GrandStarReturnDemoStarter"),d("SimpleDemoExecutor"),d("DemoGroup"),d("DemoSubGroup"),d("GhostPlayer"),d("PowerStarAppearPoint"),h("GlobalConeGravity",o.createGlobalConeGravityObj),h("GlobalCubeGravity",o.createGlobalCubeGravityObj),d("GlobalDiskGravity"),d("GlobalDiskTorusGravity"),h("GlobalPointGravity",o.createGlobalPointGravityObj),h("GlobalPlaneGravity",o.createGlobalPlaneGravityObj),h("GlobalPlaneGravityInBox",o.createGlobalPlaneInBoxGravityObj),h("GlobalPlaneGravityInCylinder",o.createGlobalPlaneInCylinderGravityObj),h("GlobalSegmentGravity",o.createGlobalSegmentGravityObj),d("GlobalWireGravity"),d("WaterArea"),d("WaterCube"),d("WaterCylinder"),d("WaterSphere"),d("SwitchArea"),d("SwitchCube"),d("SwitchSphere"),d("SwitchCylinder"),d("ClipAreaSphere"),d("CameraArea"),d("CubeCameraBowl"),d("CubeCameraBox"),d("CubeCameraCylinder"),d("CubeCameraSphere"),d("DeathCube"),d("DeathArea"),d("BloomCube"),d("SimpleBloomCube"),d("PostFogArea"),d("HazeCube"),d("MessageArea"),d("MessageAreaCube"),d("MessageAreaCylinder"),d("AudioEffectCube"),d("AudioEffectCylinder"),d("AudioEffectSphere"),d("SoundEmitter"),d("SoundEmitterCube"),d("SoundEmitterSphere"),d("PlayerSeCylinder"),d("ViewGroupCtrlArea"),d("ViewGroupCtrlCube"),d("PullBackArea"),d("PullBackCube"),d("PullBackCylinder"),d("NonSleepArea"),d("NonSleepCube"),d("DemoPlayerForbidUpdateArea"),d("CelestrialSphere"),d("AstroOverlookAreaCylinder"),d("AstroChangeStageCube"),d("RasterScrollCube"),d("ChangeBgmCube"),d("CollisionArea"),d("ForbidTriangleJumpCube"),d("MirrorAreaCube"),d("FallsCube"),d("RestartCube"),d("DepthOfFieldCube"),d("ShootingStarArea"),d("GlaringLightAreaCylinder"),d("LensFlareArea"),d("BigBubbleCameraBox"),d("BigBubbleCameraCylinder"),d("BigBubbleMoveLimitterPlane"),d("BigBubbleMoveLimitterCylinder"),d("PlaneCollisionCube"),d("PlaneModeCube"),d("PlaneModeArea"),d("HipDropGuidanceCube"),d("SpinGuidanceArea"),d("SpinGuidanceCube"),d("SceneChangeArea"),d("StoryBookAreaText"),d("StoryBookAreaWarp"),d("SlopeRunningCancelArea"),d("BeeWallShortDistAreaCube"),d("EffectCylinder"),d("ExtraWallCheckArea"),d("ExtraWallCheckCylinder"),d("DodoryuClosedCylinder"),h("LightCtrlCube",i.createLightCtrlCube),h("LightCtrlCylinder",i.createLightCtrlCylinder),d("IronCannonLauncherPoint")];function p(e,t,a=m){const r=a.find(a=>a.objName===e&&!!(a.gameBits&t));return void 0!==r?r:null}t.getNameObjFactoryTableEntry=p;const f=[u("ChoConveyorPlanetB",n.RailPlanetMap),u("ChoConveyorPlanetD",n.RotateMoveObj),u("FlagDiscPlanetD",n.RotateMoveObj),u("HatchWaterPlanet",n.HatchWaterPlanet),u("HeavensDoorInsidePlanet",n.SimpleMapObj),u("PeachCastleGardenPlanet",n.PeachCastleGardenPlanet),u("TridentPlanet",n.AstroMapObj),u("Quicksand2DPlanet",n.RailPlanetMap),u("SandStreamHighTowerPlanet",n.RailPlanetMap),u("SandStreamJointPlanetA",n.RailPlanetMap),u("SandStreamJointPlanetB",n.RailPlanetMap),u("StarDustStartPlanet",n.RotateMoveObj)],A=u("PlanetMap",n.PlanetMap);t.PlanetMapCreator=class{constructor(e){this.planetMapDataTable=r.createCsvParser(e.findFileData("PlanetMapDataTable.bcsv"))}setPlanetRecordFromName(e){for(let t=0;t<this.planetMapDataTable.getNumRecords();t++)if(this.planetMapDataTable.setRecord(t),this.planetMapDataTable.getValueString("PlanetName")===e)return!0;return!1}isRegisteredObj(e){return this.setPlanetRecordFromName(e)}getActorTableEntry(e,t){const a=p(e,t,f);return null!==a?a:this.isRegisteredObj(e)?A:null}requestArchive(e,t){const a=e.modelCache;this.setPlanetRecordFromName(t),a.requestObjectData(t),0!==this.planetMapDataTable.getValueNumber("BloomFlag")&&a.requestObjectData(`${t}Bloom`),0!==this.planetMapDataTable.getValueNumber("IndirectFlag")&&a.requestObjectData(`${t}Indirect`),0!==this.planetMapDataTable.getValueNumber("WaterFlag")&&a.requestObjectData(`${t}Water`)}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=a(52),i=a(6),o=a(2),l=r(a(18)),c=a(4),h=a(0),d=a(17),u=a(16),m=a(5),p=a(5),f=a(7),A=a(53),g=a(34),_=a(43),S=a(93);class b{constructor(){this.drawPosition=n.vec3.create(),this.gridPosition=n.vec3.create(),this.heightScale=1}updatePos(e,t){const a=this.heightScale*function(e,t,a,r){return 40*Math.sin(e+.003*r)+30*Math.sin(t+.003*a+.003*r)}(e,t,this.gridPosition[0],this.gridPosition[2]);n.vec3.copy(this.drawPosition,this.gridPosition),this.drawPosition[1]+=a}}const v=n.vec3.create(),w=new p.MaterialParams,x=new p.PacketParams;class T extends A.LiveActor{constructor(e,t,a){super(e,t,s.getObjectName(a)),this.points=[],this.animationController=new l.default(60),this.tex0Trans=n.vec2.create(),this.tex1Trans=n.vec2.create(),this.tex2Trans=n.vec2.create(),this.tex4Scale=.04,this.axisX=n.vec3.create(),this.axisY=n.vec3.create(),this.axisZ=n.vec3.create(),_.connectToScene(t,this,34,-1,-1,7),_.initDefaultPos(t,this,a),S.calcActorAxis(this.axisX,this.axisY,this.axisZ,this);const r=t.modelCache.device,i=t.modelCache.cache;this.initPoints(r,i);const o=t.modelCache.getObjectData("WaterWave");this.water=_.loadBTIData(t,o,"Water.bti"),this.waterIndirect=_.loadBTIData(t,o,"WaterIndirect.bti"),this.mask=_.loadBTIData(t,o,"Mask.bti"),t.create(98),t.waterAreaHolder.entryOceanBowl(this)}isInWater(e){n.vec3.sub(v,e,this.translation);const t=n.vec3.squaredLength(v),a=100*this.scale[0];if(t<a*a){if(n.vec3.dot(v,this.axisY)<0)return!0}return!1}initPoints(e,t){const a=100*Math.ceil(this.scale[0]),r=2*a/200;this.gridSpacing=200,this.gridAxisPointCount=r;for(let e=0;e<r;e++)for(let t=0;t<r;t++){const s=200*t-200*r/2+100,i=200*e-200*r/2+100,l=new b;n.vec3.copy(l.gridPosition,this.translation),n.vec3.scaleAndAdd(l.gridPosition,l.gridPosition,this.axisX,s),n.vec3.scaleAndAdd(l.gridPosition,l.gridPosition,this.axisZ,i);const c=o.clamp((a-n.vec3.distance(l.gridPosition,this.translation))/500,0,1);l.heightScale=c,this.points.push(l)}const s=this.points.length;this.positionBuffer=e.createBuffer(3*s,2,2),this.positionDataF32=new Float32Array(3*s),this.positionDataU8=new Uint8Array(this.positionDataF32.buffer);const l=new Uint8Array(4*s);let c=0;for(let e=0;e<this.points.length;e++)l[c++]=255,l[c++]=255,l[c++]=255,l[c++]=255*this.points[e].heightScale;this.colorBuffer=d.makeStaticDataBuffer(e,2,l.buffer);const p=new Int16Array(2*this.points.length);let f=0;for(let e=0;e<r;e++)for(let t=0;t<r;t++)p[f++]=e/(r-1)*32767,p[f++]=t/(r-1)*32767;this.texCoord0Buffer=d.makeStaticDataBuffer(e,2,p.buffer),h.assert(f===p.length);const A=(r-1)*(r-1)*6;this.indexCount=A;const _=new Uint16Array(A);let S=0;for(let e=1;e<r;e++)for(let t=1;t<r;t++){const a=t-1,n=e-1,s=n*r+a,i=e*r+a,o=n*r+t,l=e*r+t;_[S++]=s,_[S++]=i,_[S++]=o,_[S++]=o,_[S++]=i,_[S++]=l}h.assert(S===A),this.indexBuffer=d.makeStaticDataBuffer(e,1,_.buffer);const v=[{location:u.getVertexInputLocation(2),format:i.GfxFormat.F32_RGB,bufferIndex:0,bufferByteOffset:0},{location:u.getVertexInputLocation(6),format:i.GfxFormat.U8_RGBA_NORM,bufferIndex:1,bufferByteOffset:0},{location:u.getVertexInputLocation(8),format:i.GfxFormat.S16_RG_NORM,bufferIndex:2,bufferByteOffset:0}];this.inputLayout=t.createInputLayout(e,{indexBufferFormat:i.GfxFormat.U16_R,vertexAttributeDescriptors:v,vertexBufferDescriptors:[{byteStride:12,frequency:1},{byteStride:4,frequency:1},{byteStride:4,frequency:1}]}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.positionBuffer,byteOffset:0},{buffer:this.colorBuffer,byteOffset:0},{buffer:this.texCoord0Buffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0});const w=new g.GXMaterialBuilder("OceanBowl");w.setChanCtrl(4,!1,1,1,0,0,2),w.setTexCoordGen(0,1,4,30),w.setTexCoordGen(1,1,4,33),w.setTexCoordGen(2,1,4,36),w.setTexCoordGen(3,0,0,39),w.setTexCoordGen(4,1,4,42,!0),w.setTevOrder(0,0,0,7),w.setTevColorIn(0,8,15,15,15),w.setTevColorOp(0,0,0,0,!1,0),w.setTevAlphaIn(0,4,7,7,7),w.setTevAlphaOp(0,0,0,0,!1,0),w.setTevOrder(1,1,0,7),w.setTevColorIn(1,15,8,0,15),w.setTevColorOp(1,0,0,3,!1,0),w.setTevAlphaIn(1,7,4,0,7),w.setTevAlphaOp(1,0,0,1,!1,0),w.setTevOrder(2,4,3,0),w.setTevColorIn(2,0,3,2,0),w.setTevColorOp(2,9,0,0,!1,0),w.setTevAlphaIn(2,7,5,4,7),w.setTevAlphaOp(2,0,0,0,!1,0),w.setTevOrder(3,3,1,7),w.setTevColorIn(3,15,8,4,0),w.setTevColorOp(3,0,0,0,!0,0),w.setTevAlphaIn(3,0,7,7,7),w.setTevAlphaOp(3,0,0,0,!1,0),w.setIndTexOrder(0,2,2),w.setTevIndWarp(3,0,!0,!1,1),w.setBlendMode(1,4,5),w.setZMode(!0,3,!1),w.setUsePnMtxIdx(!1),this.materialHelper=new m.GXMaterialHelperGfx(w.finish())}movement(e,t){this.animationController.setTimeFromViewerInput(t);const a=this.animationController.getTimeInFrames(),r=-.04*a;for(let e=0;e<this.points.length;e++)this.points[e].updatePos(r,r);this.tex0Trans[0]=(1+-8e-4*a)%1,this.tex0Trans[1]=(1+-8e-4*a)%1,this.tex1Trans[0]=(1+-.001*a)%1,this.tex1Trans[1]=(1+8e-4*a)%1,this.tex2Trans[0]=(1+-.003*a)%1,this.tex2Trans[1]=(1+-.001*a)%1}draw(e,t,a){if(super.draw(e,t,a),!_.isValidDraw(this))return;const r=e.modelCache.device,s=e.modelCache.cache,i=r.createHostAccessPass();for(let e=0;e<this.points.length;e++){const t=this.points[e];let a=3*e;this.positionDataF32[a++]=t.drawPosition[0],this.positionDataF32[a++]=t.drawPosition[1],this.positionDataF32[a++]=t.drawPosition[2]}i.uploadBufferData(this.positionBuffer,0,this.positionDataU8),r.submitPass(i),this.water.fillTextureMapping(w.m_TextureMapping[0]),e.captureSceneDirector.fillTextureMappingOpaqueSceneTexture(w.m_TextureMapping[1]),this.waterIndirect.fillTextureMapping(w.m_TextureMapping[2]),this.mask.fillTextureMapping(w.m_TextureMapping[3]),c.colorFromRGBA8(w.u_Color[p.ColorKind.C0],673720340),c.colorFromRGBA8(w.u_Color[p.ColorKind.C1],3370570495);const o=.05*this.gridAxisPointCount,l=.1*this.gridAxisPointCount,h=this.tex4Scale*this.gridAxisPointCount,d=a.camera;_.setTextureMatrixST(w.u_TexMtx[0],o,this.tex0Trans),_.setTextureMatrixST(w.u_TexMtx[1],o,this.tex1Trans),_.setTextureMatrixST(w.u_TexMtx[2],l,this.tex2Trans),_.loadTexProjectionMtx(w.u_TexMtx[3],d,a.viewport),_.setTextureMatrixST(w.u_IndTexMtx[0],.1,null),_.setTextureMatrixST(w.u_TexMtx[4],h,null);const u=d.worldMatrix[12],m=d.worldMatrix[14],A=this.points[0].gridPosition[0],g=this.points[0].gridPosition[2],S=this.gridAxisPointCount*this.gridSpacing,b=(u-A)/S,v=(m-g)/S;w.u_TexMtx[4][12]=-v*h+.5,w.u_TexMtx[4][13]=-b*h+.5;const T=t.newRenderInst();T.setInputLayoutAndState(this.inputLayout,this.inputState),T.drawIndexes(this.indexCount),this.materialHelper.setOnRenderInst(r,s,T),T.sortKey=f.makeSortKey(128,this.materialHelper.programKey);const y=T.allocateUniformBuffer(p.ub_MaterialParams,this.materialHelper.materialParamsBufferSize);this.materialHelper.fillMaterialParamsDataOnInst(T,y,w),T.setSamplerBindingsFromTextureMappings(w.m_TextureMapping),T.allocateUniformBuffer(p.ub_PacketParams,p.u_PacketParamsBufferSize),n.mat4.copy(x.u_PosMtx[0],d.viewMatrix),p.fillPacketParamsData(T.mapUniformBufferF32(p.ub_PacketParams),T.getUniformBufferOffset(p.ub_PacketParams),x),t.submitRenderInst(T)}destroy(e){this.water.destroy(e),this.waterIndirect.destroy(e),this.mask.destroy(e),e.destroyBuffer(this.positionBuffer),e.destroyBuffer(this.colorBuffer),e.destroyBuffer(this.texCoord0Buffer),e.destroyBuffer(this.indexBuffer),e.destroyInputState(this.inputState)}static requestArchives(e,t){e.modelCache.requestObjectData("WaterWave")}}t.OceanBowl=T},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(0),s=a(53),i=a(52),o=a(28),l=a(43),c=a(93),h=a(109);class d extends s.LiveActor{constructor(e,t,a,n,s,o){super(e,a,i.getObjectName(n)),this.objinfo=o,this.rotateSpeed=0,this.rotatePhase=0,this.rotateAxis=1,this.isSkybox=!1,this.firstStepCallback=null,l.initDefaultPos(a,this,n),this.initModelManagerWithAnm(a,t),l.isExistIndirectTexture(this)&&(s=3),1===s?l.connectToSceneMapObjStrongLight(a,this):0===s?l.connectToSceneSky(a,this):3===s?l.connectToSceneIndirectMapObjStrongLight(a,this):2===s&&l.connectToSceneBloom(a,this),0===s&&(r.mat4.scale(o.modelMatrix,o.modelMatrix,[.5,.5,.5]),o.modelMatrix[12]=0,o.modelMatrix[13]=0,o.modelMatrix[14]=0,this.isSkybox=!0),this.initEffectKeeper(a,null),this.initNerve(0)}setRotateSpeed(e,t=1){this.rotatePhase=this.objinfo.modelMatrix[12]+this.objinfo.modelMatrix[13]+this.objinfo.modelMatrix[14],this.rotateSpeed=e,this.rotateAxis=t}updateMapPartsRotation(e,t){if(0!==this.rotateSpeed){const a=this.rotateSpeed*Math.PI/100;0===this.rotateAxis?r.mat4.rotateX(e,e,(t+this.rotatePhase)*a):1===this.rotateAxis?r.mat4.rotateY(e,e,(t+this.rotatePhase)*a):2===this.rotateAxis&&r.mat4.rotateZ(e,e,(t+this.rotatePhase)*a)}}calcAndSetBaseMtx(e,t){const a=t.time/1e3;super.calcAndSetBaseMtx(e,t),this.updateMapPartsRotation(this.modelInstance.modelMatrix,a)}calcAnim(e,t){this.isSkybox&&c.getCamPos(this.translation,t.camera),super.calcAnim(e,t)}updateSpine(e,t,a){super.updateSpine(e,t,a),h.isFirstStep(this)&&null!==this.firstStepCallback&&this.firstStepCallback()}}t.NoclipLegacyActor=d;t.NoclipLegacyActorSpawner=class{constructor(e){this.sceneObjHolder=e,this.isSMG1=!1,this.isSMG2=!1,this.isWorldMap=!1,this.isSMG1="SuperMarioGalaxy"===this.sceneObjHolder.sceneDesc.pathBase,this.isSMG2="SuperMarioGalaxy2"===this.sceneObjHolder.sceneDesc.pathBase,this.isWorldMap=this.isSMG2&&this.sceneObjHolder.sceneDesc.galaxyName.startsWith("WorldMap")}async spawnObjectLegacy(e,t,a){const r=this.sceneObjHolder.modelCache,s=this.sceneObjHolder.sceneDesc.galaxyName,i=async(n,s=1,i)=>{if(null===await r.requestObjectData(n))return null;const o=new d(e,n,this.sceneObjHolder,t,s,a);return o.firstStepCallback=()=>{((e,t)=>{if(null!==t)if(void 0!==t)void 0!==t.bck&&l.startBck(e,t.bck.slice(0,-4)),void 0!==t.brk&&l.startBrk(e,t.brk.slice(0,-4)),void 0!==t.btk&&l.startBtk(e,t.btk.slice(0,-4));else{let t=!1;if(t=l.startBckIfExist(e,"Wait")||t,t=l.startBrkIfExist(e,"Wait")||t,t=l.startBtkIfExist(e,"Wait")||t,!t){const t=e.resourceHolder.arc.files.find(e=>e.name.endsWith(".bck"))||null;if(null!==t){const a=t.name.slice(0,-4);l.startBck(e,a)}const a=e.resourceHolder.arc.files.find(e=>e.name.endsWith(".brk")&&"colorchange.brk"!==e.name.toLowerCase())||null;if(null!==a){const t=a.name.slice(0,-4);l.startBrkIfExist(e,t)}const r=e.resourceHolder.arc.files.find(e=>e.name.endsWith(".btk")&&"texchange.btk"!==e.name.toLowerCase())||null;if(null!==r){const t=r.name.slice(0,-4);l.startBtkIfExist(e,t)}}}null!==e.modelManager.xanimePlayer&&l.setBckFrameAtRandom(e)})(o,i)},o.scenarioChanged(this.sceneObjHolder),[o,o.resourceHolder.arc]},o=async(e,t=1,a)=>n.assertExists(await i(e,t,a)),h=a.objName;switch(h){case"MeteorCannon":case"Plant":case"Creeper":case"TrampleStar":case"Flag":case"FlagKoopaC":case"FlagRaceA":case"FlagTamakoro":case"WoodLogBridge":case"SandBird":case"RingBeamerAreaObj":case"StatusFloor":return;case"StarPieceFollowGroup":case"StarPieceGroup":case"StarPieceSpot":case"StarPieceFlow":case"WingBlockStarPiece":case"YellowChipGroup":case"CoinAppearSpot":case"LuigiIntrusively":case"MameMuimuiAttackMan":case"SuperDreamer":case"PetitPorterWarpPoint":case"TimerCoinBlock":case"CoinLinkGroup":case"CollectTico":case"BrightSun":case"InstantInferno":case"FireRing":case"FireBar":case"JumpBeamer":case"WaterFortressRain":case"BringEnemy":case"HeadLight":case"TereboGroup":case"NoteFairy":case"Tongari2D":case"Grapyon":case"GliderShooter":case"CaveInCube":case"RaceRail":case"GliBirdNpc":case"SecretGateCounter":case"HammerHeadPackun":case"Hanachan":case"MarinePlant":case"Nyoropon":case"WaterStream":case"BallRail":case"SphereRailDash":case"HammerHeadPackunSpike":return;case"SplashCoinBlock":case"TimerCoinBlock":case"SplashPieceBlock":case"TimerPieceBlock":case"ItemBlockSwitch":o("CoinBlock",1);break;case"AssemblyBlockPartsTimerA":case"AstroDomeComet":case"HeavensDoorInsidePlanetPartsA":case"LavaProminence":case"LavaProminenceEnvironment":case"LavaProminenceTriple":o(h,1),o(`${h}Bloom`,2);break;case"Rabbit":o("TrickRabbit");break;case"TicoShop":o("TicoShop").then(([e,t])=>{l.startBva(e,"Small0")});break;case"OtaKing":o("OtaKing"),o("OtaKingMagma"),o("OtaKingMagmaBloom",2);break;case"UFOKinoko":o(h,1,null).then(([e,t])=>{var r,n;r=e,n=a.objArg0,l.isBrkExist(r,"ColorChange")&&(l.startBrk(r,"ColorChange"),l.setBrkFrameAndStop(r,n)),l.isBtkExist(r,"TexChange")&&(l.startBtk(r,"TexChange"),l.setBtkFrameAndStop(r,n)),l.isBtpExist(r,"TexChange")&&(l.startBtp(r,"TexChange"),l.setBtpFrameAndStop(r,n))});break;case"PlantA":o(`PlantA${n.hexzero(n.assertExists(t.getValueNumber("ShapeModelNo")),2)}`);break;case"PlantB":o(`PlantB${n.hexzero(n.assertExists(t.getValueNumber("ShapeModelNo")),2)}`);break;case"PlantC":o(`PlantC${n.hexzero(n.assertExists(t.getValueNumber("ShapeModelNo")),2)}`);break;case"PlantD":o(`PlantD${n.hexzero(n.assertExists(t.getValueNumber("ShapeModelNo")),2)}`);break;case"BenefitItemOneUp":o("KinokoOneUp");break;case"BenefitItemLifeUp":o("KinokoLifeUp");break;case"BenefitItemInvincible":o("PowerUpInvincible");break;case"MorphItemNeoHopper":o("PowerUpHopper");break;case"MorphItemNeoBee":o("PowerUpBee");break;case"MorphItemNeoFire":o("PowerUpFire");break;case"MorphItemNeoFoo":o("PowerUpFoo");break;case"MorphItemNeoIce":o("PowerUpIce");break;case"MorphItemNeoTeresa":o("PowerUpTeresa");break;case"SpinCloudItem":o("PowerUpCloud");break;case"PukupukuWaterSurface":o("Pukupuku");break;case"JetTurtle":break;case"HeavensDoorAppearStepA":return;case"GreenStar":case"PowerStar":return void o("PowerStar",1,{}).then(([e,t])=>{if(this.isSMG1){const t="HeavensDoorGalaxy"===s&&2===e.objinfo.objArg0,a="GreenStar"===h,r=t?5:a?2:0;l.startBtp(e,"PowerStar"),l.setBtpFrameAndStop(e,r)}else{const t="GreenStar"===h?2:0;l.startBtp(e,"PowerStarColor"),l.setBtpFrameAndStop(e,t)}e.modelInstance.setMaterialVisible("Empty",!1),e.setRotateSpeed(140)});case"GrandStar":return void o(h).then(([e,t])=>{e.modelInstance.setMaterialVisible("GrandStarEmpty",!1),e.setRotateSpeed(3)});case"Moc":o(h,1,{bck:"turn.bck"}).then(([e,t])=>{l.startBva(e,"FaceA")});break;case"CareTakerHunter":o("CaretakerHunter");break;case"WorldMapSyncSky":o("WorldMap03Sky",0);break;case"DinoPackunVs1":case"DinoPackunVs2":o("DinoPackun");break;case"Mogucchi":return void o(h,1,{bck:"walk.bck"});case"Dodoryu":o(h,1,{bck:"swoon.bck"});break;case"Karikari":o("Karipon");break;case"YoshiCapture":o("YCaptureTarget");break;case"Patakuri":o("Kuribo",1,{bck:"patakuriwait.bck"}),o("PatakuriWing");break;case"ShellfishCoin":o("Shellfish");break;case"TogeBegomanLauncher":case"BegomanBabyLauncher":o("BegomanLauncher");break;case"MarioFacePlanetPrevious":return;case"RedBlueTurnBlock":o("RedBlueTurnBlock"),o("RedBlueTurnBlockBase");break;case"TicoCoin":o(h).then(([e,t])=>{e.modelInstance.setMaterialVisible("TicoCoinEmpty_v",!1)});break;case"WanwanRolling":o(h,1,{});break;case"PhantomCandlestand":o(h).then(([e,t])=>{c.emitEffect(this.sceneObjHolder,e,"Fire")});default:null===await i(h)&&console.warn(`Unable to spawn ${h}`,e,t);break}}requestArchives(e){this.isWorldMap&&this.requestArchivesWorldMap(e)}requestArchivesWorldMap(e){const t=e.modelCache,a=e.sceneDesc.galaxyName;t.requestObjectData("MiniRoutePoint"),t.requestObjectData("MiniRouteLine"),t.requestObjectData("MiniWorldWarpPoint"),t.requestObjectData("MiniEarthenPipe"),t.requestObjectData("MiniStarPieceMine"),t.requestObjectData("MiniTicoMasterMark"),t.requestObjectData("MiniStarCheckPointMark");const r=this.sceneObjHolder.modelCache.getObjectData(a.substr(0,10));o.createCsvParser(r.findFileData("ActorInfo/Galaxy.bcsv")).mapRecords(e=>{t.requestObjectData(n.assertExists(e.getValueString("MiniatureName")))})}place(){this.isWorldMap&&(this.placeWorldMap(),this.sceneObjHolder.spawner.zones[1].visible=!1)}placeWorldMap(){const e=this.sceneObjHolder.sceneDesc.galaxyName,t=[],a=this.sceneObjHolder.modelCache.getObjectData(e.substr(0,10)),i=o.createCsvParser(a.findFileData("ActorInfo/PointPos.bcsv")),l=s.dynamicSpawnZoneAndLayer;i.mapRecords(e=>{const a={position:r.vec3.fromValues(n.assertExists(e.getValueNumber("PointPosX")),n.assertExists(e.getValueNumber("PointPosY")),n.assertExists(e.getValueNumber("PointPosZ"))),isPink:"o"==e.getValueString("ColorChange"),isSmall:!0};t.push(a)}),o.createCsvParser(a.findFileData("ActorInfo/Galaxy.bcsv")).mapRecords(e=>{const a=n.assertExists(e.getValueNumber("PointPosIndex"));t[a].isSmall=!1;new c.MiniRouteGalaxy(l,this.sceneObjHolder,e,t[a])}),o.createCsvParser(a.files.find(e=>"pointparts.bcsv"===e.name.toLowerCase()).buffer).mapRecords(e=>{const a=n.assertExists(e.getValueNumber("PointIndex"));t[a].isSmall=!1;new c.MiniRoutePart(l,this.sceneObjHolder,e,t[a])}),i.mapRecords((e,a)=>{if("o"===e.getValueString("Valid")){new c.MiniRoutePoint(l,this.sceneObjHolder,t[a])}}),o.createCsvParser(a.findFileData("ActorInfo/PointLink.bcsv")).mapRecords(e=>{const a="o"===e.getValueString("IsColorChange"),r=t[n.assertExists(e.getValueNumber("PointIndexA"))],s=t[n.assertExists(e.getValueNumber("PointIndexB"))];this.spawnWorldMapLine(l,r,s,a)})}spawnWorldMapLine(e,t,a,n){const s=r.mat4.create();r.mat4.fromTranslation(s,t.position);const i=r.vec3.create();r.vec3.sub(i,a.position,t.position),s[0]=i[0]/1e3,s[1]=i[1]/1e3,s[2]=i[2]/1e3,r.vec3.normalize(i,i);const o=r.vec3.fromValues(0,1,0);s[4]=0,s[5]=1,s[6]=0;const h=r.vec3.create();r.vec3.cross(h,i,o),s[8]=2*h[0],s[9]=h[1],s[10]=2*h[2];const d=c.createModelObjMapObj(e,this.sceneObjHolder,"MiniRouteLine","MiniRouteLine",s);l.startBva(d,"Open"),n?l.startBrk(d,"TicoBuild"):l.startBrk(d,"Normal")}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(52),n=a(28);class s extends r.SMGSceneDescBase{constructor(){super(...arguments),this.pathBase="SuperMarioGalaxy2"}getLightData(e){const t=e.getArchive("LightData/LightData.arc");return n.createCsvParser(t.findFileData("LightData.bcsv"))}getZoneLightData(e,t){const a=e.getArchive(`StageData/${t}/${t}Light.arc`);return n.createCsvParser(a.findFileData(`csv/${t}Light.bcsv`))}getZoneMapArchive(e,t){return e.getArchive(`StageData/${t}/${t}Map.arc`)}requestGlobalArchives(e){e.requestArchiveData("LightData/LightData.arc")}requestZoneArchives(e,t){e.requestArchiveData(`StageData/${t}/${t}Map.arc`),e.requestArchiveData(`StageData/${t}/${t}Light.arc`),t.startsWith("WorldMap")&&e.requestObjectData(t.slice(0,10))}}const i=["Other Maps",new s("Mushroom Kingdom","PeachCastleGalaxy"),new s("Mario's Faceship","MarioFaceShipGalaxy"),new s("Credits","StaffRollGalaxy"),new s("Library","ChildRoomGalaxy"),"World One",new s("World One Map","WorldMap01Galaxy"),new s("Sky Station Galaxy","IslandFleetGalaxy"),new s("Yoshi Star Galaxy","YosshiHomeGalaxy"),new s("Spin-Dig Galaxy","DigMineGalaxy"),new s("Fluffy Bluff Galaxy","MokumokuValleyGalaxy"),new s("Flip-Swap Galaxy","RedBlueExGalaxy"),new s("Rightside-Down Galaxy","AbekobeGalaxy"),new s("Bowser Jr.'s Fiery Flotilla","VsKoopaJrLv1Galaxy"),"World Two",new s("World Two Map","WorldMap02Galaxy"),new s("Puzzle Plank Galaxy","HomeCenterGalaxy"),new s("Hightail Falls Galaxy","BigWaterFallGalaxy"),new s("Boulder Bowl Galaxy","GoroRockGalaxy"),new s("Cosmic Cove Galaxy","StarCreekGalaxy"),new s("Wild Glide Galaxy","JungleGliderGalaxy"),new s("Honeybloom Galaxy","FlowerHighlandGalaxy"),new s("Bowser's Lava Lair","VsKoopaLv1Galaxy"),"World Three",new s("World Three Map","WorldMap03Galaxy"),new s("Tall Trunk Galaxy","BigTree2Galaxy"),new s("Cloudy Court Galaxy","CloudGardenGalaxy"),new s("Haunty Halls Galaxy","GhostConveyorGalaxy"),new s("Freezy Flake Galaxy","WhiteSnowGalaxy"),new s("Rolling Masterpiece Galaxy","TamakoroPlanetGalaxy"),new s("Beat Block Galaxy","TimerSwitchingPlatformGalaxy"),new s("Bowser Jr.'s Fearsome Fleet","KoopaJrLv2Galaxy"),"World Four",new s("World Four Map","WorldMap04Galaxy"),new s("Supermassive Galaxy","BigGalaxy"),new s("Flipsville Galaxy","OmoteuLandGalaxy"),new s("Starshine Beach Galaxy","TropicalResortGalaxy"),new s("Chompworks Galaxy","WanwanFactoryGalaxy"),new s("Sweet Mystery Galaxy","MysteryCandyGalaxy"),new s("Honeyhop Galaxy","HoneyBeeVillageGalaxy"),new s("Bowser's Gravity Gauntlet","VsKoopaGravityGalaxy"),"World Five",new s("World Five Map","WorldMap05Galaxy"),new s("Space Storm Galaxy","ThunderFleetGalaxy"),new s("Slipsand Galaxy","QuicksandGalaxy"),new s("Shiverburn Galaxy","KachikochiLavaGalaxy"),new s("Boo Moon Galaxy","TeresaLabyrinthGalaxy"),new s("Upside Dizzy Galaxy","ChaosGravityGalaxy"),new s("Fleet Glide Galaxy","ChallengeGliderGalaxy"),new s("Bowser Jr.'s Boom Bunker","VsKoopaJrLv3Galaxy"),"World Six",new s("World Six Map","WorldMap06Galaxy"),new s("Melty Monster Galaxy","TwisterTowerGalaxy"),new s("Clockwork Ruins Galaxy","AncientExcavationGalaxy"),new s("Throwback Galaxy","LongForCastleGalaxy"),new s("Battle Belt Galaxy","MagicGalaxy"),new s("Flash Black Galaxy","MemoryRoadGalaxy"),new s("Slimy Spring Galaxy","UnderGroundDangeonGalaxy"),new s("Bowser's Galaxy Generator","VsKoopaLv3Galaxy"),"World S",new s("World S Map","WorldMap07Galaxy"),new s("Mario Squared Galaxy","MarioOnMarioGalaxy"),new s("Rolling Coaster Galaxy","TamakoroSliderGalaxy"),new s("Twisty Trials Galaxy","SecretAthleticGalaxy"),new s("Stone Cyclone Galaxy","MadnessOnimasuGalaxy"),new s("Boss Blitz Galaxy","KingOfKingsGalaxy"),new s("Flip-Out Galaxy","SwitchMoveBlockGalaxy"),new s("Grandmaster Galaxy","DimensionBigCastleGalaxy")];t.sceneGroup={id:"smg2",name:"Super Mario Galaxy 2",sceneDescs:i}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(11)),i=r(a(111)),o=r(a(64)),l=r(a(229)),c=r(a(230)),h=r(a(112)),d=a(94),u=a(9),m=a(1),p=a(0),f=n(a(18)),A=a(33),g=a(7),_=a(13),S=a(2),b=a(51);var v;!function(e){e[e.PLAYER=0]="PLAYER",e[e.EWB_ICE_A=1]="EWB_ICE_A",e[e.EWB_ICE_B=2]="EWB_ICE_B",e[e.EWB_ICE_C=3]="EWB_ICE_C",e[e.EWM_ICE_BLOCK=4]="EWM_ICE_BLOCK",e[e.EMM_LOG=5]="EMM_LOG",e[e.EMM_YUKA=6]="EMM_YUKA",e[e.UPDOWN_LIFT=7]="UPDOWN_LIFT",e[e.HS_UPDOWN_LIFT=8]="HS_UPDOWN_LIFT",e[e.PATH_LIFT=9]="PATH_LIFT",e[e.WANWAN=10]="WANWAN",e[e.CAMERA_TAG=11]="CAMERA_TAG",e[e.SEESAW=12]="SEESAW",e[e.IRONBALL=13]="IRONBALL",e[e.GORO_ROCK=14]="GORO_ROCK",e[e.KURIBO=15]="KURIBO",e[e.KURIBO_S=16]="KURIBO_S",e[e.KURIBO_L=17]="KURIBO_L",e[e.KURIKING=18]="KURIKING",e[e.BOMBHEI=19]="BOMBHEI",e[e.RED_BOMBHEI=20]="RED_BOMBHEI",e[e.NOKONOKO=21]="NOKONOKO",e[e.NOKONOKO_S=22]="NOKONOKO_S",e[e.BLOCK_L=23]="BLOCK_L",e[e.DP_BLOCK_L=24]="DP_BLOCK_L",e[e.SW_BLOCK_L=25]="SW_BLOCK_L",e[e.POWER_UP_ITEM=26]="POWER_UP_ITEM",e[e.HATENA_SWITCH=27]="HATENA_SWITCH",e[e.BLOCK_S=28]="BLOCK_S",e[e.CANNON_SHUTTER=29]="CANNON_SHUTTER",e[e.HATENA_BLOCK=30]="HATENA_BLOCK",e[e.ITEM_BLOCK=31]="ITEM_BLOCK",e[e.VS_ITEM_BLOCK=32]="VS_ITEM_BLOCK",e[e.CAP_BLOCK_M=33]="CAP_BLOCK_M",e[e.CAP_BLOCK_W=34]="CAP_BLOCK_W",e[e.CAP_BLOCK_L=35]="CAP_BLOCK_L",e[e.PILE=36]="PILE",e[e.COIN=37]="COIN",e[e.RED_COIN=38]="RED_COIN",e[e.BLUE_COIN=39]="BLUE_COIN",e[e.KOOPA=40]="KOOPA",e[e.TREE=41]="TREE",e[e.PICTURE_GATE=42]="PICTURE_GATE",e[e.HANSWITCH=43]="HANSWITCH",e[e.STAR_SWITCH=44]="STAR_SWITCH",e[e.SWITCHDOOR=45]="SWITCHDOOR",e[e.CV_SHUTTER=46]="CV_SHUTTER",e[e.CV_NEWS_LIFT=47]="CV_NEWS_LIFT",e[e.WANWAN2=48]="WANWAN2",e[e.ONEUPKINOKO=49]="ONEUPKINOKO",e[e.CANNON=50]="CANNON",e[e.WANWAN_SHUTTER=51]="WANWAN_SHUTTER",e[e.WATERBOMB=52]="WATERBOMB",e[e.SBIRD=53]="SBIRD",e[e.FISH=54]="FISH",e[e.BUTTERFLY=55]="BUTTERFLY",e[e.BOMBKING=56]="BOMBKING",e[e.SNOWMAN=57]="SNOWMAN",e[e.PIANO=58]="PIANO",e[e.PAKUN=59]="PAKUN",e[e.STAR_CAMERA=60]="STAR_CAMERA",e[e.STAR=61]="STAR",e[e.SILVER_STAR=62]="SILVER_STAR",e[e.STARBASE=63]="STARBASE",e[e.BATAN=64]="BATAN",e[e.BATANKING=65]="BATANKING",e[e.DOSUN=66]="DOSUN",e[e.TERESA=67]="TERESA",e[e.BOSS_TERESA=68]="BOSS_TERESA",e[e.ICON_TERESA=69]="ICON_TERESA",e[e.KAIDAN=70]="KAIDAN",e[e.BOOKSHELF=71]="BOOKSHELF",e[e.MERRYGOROUND=72]="MERRYGOROUND",e[e.TERESAPIT=73]="TERESAPIT",e[e.PL_CLOSET=74]="PL_CLOSET",e[e.KANBAN=75]="KANBAN",e[e.TATEFUDA=76]="TATEFUDA",e[e.ICE_BOARD=77]="ICE_BOARD",e[e.WAKAME=78]="WAKAME",e[e.HEART=79]="HEART",e[e.KINOPIO=80]="KINOPIO",e[e.PEACH_PRINCESS=81]="PEACH_PRINCESS",e[e.KOOPA2BG=82]="KOOPA2BG",e[e.KOOPA3BG=83]="KOOPA3BG",e[e.SHELL=84]="SHELL",e[e.SHARK=85]="SHARK",e[e.CT_MECHA01=86]="CT_MECHA01",e[e.CT_MECHA02=87]="CT_MECHA02",e[e.CT_MECHA03=88]="CT_MECHA03",e[e.CT_MECHA04L=89]="CT_MECHA04L",e[e.CT_MECHA04S=90]="CT_MECHA04S",e[e.CT_MECHA05=91]="CT_MECHA05",e[e.CT_MECHA06=92]="CT_MECHA06",e[e.CT_MECHA07=93]="CT_MECHA07",e[e.CT_MECHA08A=94]="CT_MECHA08A",e[e.CT_MECHA08B=95]="CT_MECHA08B",e[e.CT_MECHA09=96]="CT_MECHA09",e[e.CT_MECHA10=97]="CT_MECHA10",e[e.CT_MECHA11=98]="CT_MECHA11",e[e.CT_MECHA12L=99]="CT_MECHA12L",e[e.CT_MECHA12S=100]="CT_MECHA12S",e[e.DP_BROCK=101]="DP_BROCK",e[e.DP_LIFT=102]="DP_LIFT",e[e.DL_PYRAMID=103]="DL_PYRAMID",e[e.DL_PYRAMID_DUMMY=104]="DL_PYRAMID_DUMMY",e[e.WL_POLELIFT=105]="WL_POLELIFT",e[e.WL_SUBMARINE=106]="WL_SUBMARINE",e[e.WL_KOOPA_SHUTTER=107]="WL_KOOPA_SHUTTER",e[e.RC_DORIFU=108]="RC_DORIFU",e[e.RC_RIFT01=109]="RC_RIFT01",e[e.RC_HANE=110]="RC_HANE",e[e.RC_TIKUWA=111]="RC_TIKUWA",e[e.RC_BURANKO=112]="RC_BURANKO",e[e.RC_SEESAW=113]="RC_SEESAW",e[e.RC_KAITEN=114]="RC_KAITEN",e[e.RC_GURUGURU=115]="RC_GURUGURU",e[e.SL_ICEBLOCK=116]="SL_ICEBLOCK",e[e.HM_MARUTA=117]="HM_MARUTA",e[e.TT_FUTA=118]="TT_FUTA",e[e.TT_WATER=119]="TT_WATER",e[e.TD_FUTA=120]="TD_FUTA",e[e.TD_WATER=121]="TD_WATER",e[e.WC_UKISIMA=122]="WC_UKISIMA",e[e.WC_OBJ01=123]="WC_OBJ01",e[e.WC_OBJ02=124]="WC_OBJ02",e[e.WC_OBJ03=125]="WC_OBJ03",e[e.WC_OBJ04=126]="WC_OBJ04",e[e.WC_OBJ05=127]="WC_OBJ05",e[e.WC_OBJ06=128]="WC_OBJ06",e[e.WC_MIZU=129]="WC_MIZU",e[e.FL_MARUTA=130]="FL_MARUTA",e[e.FL_RING=131]="FL_RING",e[e.FL_GURA=132]="FL_GURA",e[e.FL_LONDON=133]="FL_LONDON",e[e.FL_BLOCK=134]="FL_BLOCK",e[e.FL_UKIYUKA=135]="FL_UKIYUKA",e[e.FL_UKIYUKA_L=136]="FL_UKIYUKA_L",e[e.FL_SEESAW=137]="FL_SEESAW",e[e.FL_KOMA_D=138]="FL_KOMA_D",e[e.FL_KOMA_U=139]="FL_KOMA_U",e[e.FL_UKI_KI=140]="FL_UKI_KI",e[e.FL_KUZURE=141]="FL_KUZURE",e[e.FM_BATTAN=142]="FM_BATTAN",e[e.LAVA=143]="LAVA",e[e.WATERFALL=144]="WATERFALL",e[e.MANTA=145]="MANTA",e[e.SPIDER=146]="SPIDER",e[e.TOGEZO=147]="TOGEZO",e[e.JUGEM=148]="JUGEM",e[e.GAMAGUCHI=149]="GAMAGUCHI",e[e.EYEKUN=150]="EYEKUN",e[e.EYEKUN_BOSS=151]="EYEKUN_BOSS",e[e.BATTA_BLOCK=152]="BATTA_BLOCK",e[e.BIRIKYU=153]="BIRIKYU",e[e.HM_BASKET=154]="HM_BASKET",e[e.MONKEY_THIEF=155]="MONKEY_THIEF",e[e.MONKEY_STAR=156]="MONKEY_STAR",e[e.PENGUIN_BABY=157]="PENGUIN_BABY",e[e.PENGUIN_MOTHER=158]="PENGUIN_MOTHER",e[e.PENGUIN_DEFENDER=159]="PENGUIN_DEFENDER",e[e.PENGUIN_RACER=160]="PENGUIN_RACER",e[e.KERONPA=161]="KERONPA",e[e.BIG_SNOWMAN=162]="BIG_SNOWMAN",e[e.BIG_SNOWMAN_HEAD=163]="BIG_SNOWMAN_HEAD",e[e.BIG_SNOWMAN_BODY=164]="BIG_SNOWMAN_BODY",e[e.SNOWMAN_BREATH=165]="SNOWMAN_BREATH",e[e.PUKUPUKU=166]="PUKUPUKU",e[e.CLOCK_SHORT=167]="CLOCK_SHORT",e[e.CLOCK_LONG=168]="CLOCK_LONG",e[e.CLOCK_HURIKO=169]="CLOCK_HURIKO",e[e.MENBO=170]="MENBO",e[e.CASKET=171]="CASKET",e[e.HYUHYU=172]="HYUHYU",e[e.BOMB_SEESAW=173]="BOMB_SEESAW",e[e.KM1_SEESAW=174]="KM1_SEESAW",e[e.KM1_DORIFU=175]="KM1_DORIFU",e[e.KM1_UKISHIMA=176]="KM1_UKISHIMA",e[e.KM1_KURUMAJIKU=177]="KM1_KURUMAJIKU",e[e.KM1_DERU=178]="KM1_DERU",e[e.KI_FUNE=179]="KI_FUNE",e[e.KI_FUNE_UP=180]="KI_FUNE_UP",e[e.KI_HASIRA=181]="KI_HASIRA",e[e.KI_HASIRA_DAI=182]="KI_HASIRA_DAI",e[e.KI_ITA=183]="KI_ITA",e[e.KI_IWA=184]="KI_IWA",e[e.KS_MIZU=185]="KS_MIZU",e[e.DOKAN=186]="DOKAN",e[e.YAJIRUSI_L=187]="YAJIRUSI_L",e[e.YAJIRUSI_R=188]="YAJIRUSI_R",e[e.PROPELLER_HEYHO=189]="PROPELLER_HEYHO",e[e.KILLER=190]="KILLER",e[e.KB1_BILLBOARD=191]="KB1_BILLBOARD",e[e.HS_MOON=192]="HS_MOON",e[e.HS_STAR=193]="HS_STAR",e[e.HS_Y_STAR=194]="HS_Y_STAR",e[e.HS_B_STAR=195]="HS_B_STAR",e[e.BK_BILLBOARD=196]="BK_BILLBOARD",e[e.BK_KILLER_DAI=197]="BK_KILLER_DAI",e[e.BK_BOTAOSI=198]="BK_BOTAOSI",e[e.BK_DOWN_B=199]="BK_DOWN_B",e[e.BK_FUTA=200]="BK_FUTA",e[e.BK_KABE01=201]="BK_KABE01",e[e.BK_KABE00=202]="BK_KABE00",e[e.BK_TOWER=203]="BK_TOWER",e[e.BK_UKISIMA=204]="BK_UKISIMA",e[e.BK_ROTEBAR=205]="BK_ROTEBAR",e[e.BK_LIFT01=206]="BK_LIFT01",e[e.BK_DOSSUNBAR_S=207]="BK_DOSSUNBAR_S",e[e.BK_DOSSUNBAR_L=208]="BK_DOSSUNBAR_L",e[e.BK_TRANSBAR=209]="BK_TRANSBAR",e[e.TH_DOWN_B=210]="TH_DOWN_B",e[e.KM2_KUZURE=211]="KM2_KUZURE",e[e.KM2_AGARU=212]="KM2_AGARU",e[e.KM2_GURA=213]="KM2_GURA",e[e.KM2_AMI_BOU=214]="KM2_AMI_BOU",e[e.KM2_YOKOSEESAW=215]="KM2_YOKOSEESAW",e[e.KM2_SUSUMU=216]="KM2_SUSUMU",e[e.KM2_UKISHIMA=217]="KM2_UKISHIMA",e[e.KM2_RIFUT02=218]="KM2_RIFUT02",e[e.KM2_RIFUT01=219]="KM2_RIFUT01",e[e.KM2_NOBIRU=220]="KM2_NOBIRU",e[e.KM3_SEESAW=221]="KM3_SEESAW",e[e.KM3_YOKOSEESAW=222]="KM3_YOKOSEESAW",e[e.KM3_KURUMAJIKU=223]="KM3_KURUMAJIKU",e[e.KM3_DORIFU=224]="KM3_DORIFU",e[e.KM3_DERU01=225]="KM3_DERU01",e[e.KM3_DERU02=226]="KM3_DERU02",e[e.KM3_KAITENDAI=227]="KM3_KAITENDAI",e[e.C0_SWITCH=228]="C0_SWITCH",e[e.SM_LIFT=229]="SM_LIFT",e[e.PROPELLER_HEYHO_FIRE=230]="PROPELLER_HEYHO_FIRE",e[e.UDLIFT_TERESA=231]="UDLIFT_TERESA",e[e.UDLIFT=232]="UDLIFT",e[e.RC_RIFT02=233]="RC_RIFT02",e[e.BAKUBAKU=234]="BAKUBAKU",e[e.KM3_LIFT=235]="KM3_LIFT",e[e.KIRAI=236]="KIRAI",e[e.MIP=237]="MIP",e[e.OBJ_MIP_KEY=238]="OBJ_MIP_KEY",e[e.OWL=239]="OWL",e[e.DONKETU=240]="DONKETU",e[e.BOSS_DONKETU=241]="BOSS_DONKETU",e[e.ONIMASU=242]="ONIMASU",e[e.BAR=243]="BAR",e[e.C_JUGEM=244]="C_JUGEM",e[e.PUSHBLOCK=245]="PUSHBLOCK",e[e.FL_AMILIFT=246]="FL_AMILIFT",e[e.YUREI_MUCHO=247]="YUREI_MUCHO",e[e.CHOROPU=248]="CHOROPU",e[e.CHORO_ROCK=249]="CHORO_ROCK",e[e.BASABASA=250]="BASABASA",e[e.POPOI=251]="POPOI",e[e.JANGO=252]="JANGO",e[e.SANBO=253]="SANBO",e[e.OBJ_MARIO_CAP=254]="OBJ_MARIO_CAP",e[e.FL_PUZZLE=255]="FL_PUZZLE",e[e.FL_COIN=256]="FL_COIN",e[e.DOSSY=257]="DOSSY",e[e.DOSSY_CAP=258]="DOSSY_CAP",e[e.HUWAHUWA=259]="HUWAHUWA",e[e.SLIDE_BOX=260]="SLIDE_BOX",e[e.MORAY=261]="MORAY",e[e.OBJ_KUMO=262]="OBJ_KUMO",e[e.OBJ_SHELL=263]="OBJ_SHELL",e[e.OBJ_RED_FIRE=264]="OBJ_RED_FIRE",e[e.OBJ_BLUE_FIRE=265]="OBJ_BLUE_FIRE",e[e.OBJ_FLAMETHROWER=266]="OBJ_FLAMETHROWER",e[e.KINOKO_CREATE_TAG=267]="KINOKO_CREATE_TAG",e[e.KINOKO_TAG=268]="KINOKO_TAG",e[e.BLK_OKINOKO_TAG=269]="BLK_OKINOKO_TAG",e[e.BLK_SKINOKO_TAG=270]="BLK_SKINOKO_TAG",e[e.BLK_GNSHELL_TAG=271]="BLK_GNSHELL_TAG",e[e.BLK_SLVSTAR_TAG=272]="BLK_SLVSTAR_TAG",e[e.C1_TRAP=273]="C1_TRAP",e[e.C1_HIKARI=274]="C1_HIKARI",e[e.C1_PEACH=275]="C1_PEACH",e[e.RC_CARPET=276]="RC_CARPET",e[e.OBJ_KEY=277]="OBJ_KEY",e[e.LAST_STAR=278]="LAST_STAR",e[e.IWANTE=279]="IWANTE",e[e.HANACHAN=280]="HANACHAN",e[e.RACE_NOKO=281]="RACE_NOKO",e[e.RACE_FLAG=282]="RACE_FLAG",e[e.T_BASKET=283]="T_BASKET",e[e.BLOCK_LL=284]="BLOCK_LL",e[e.ICE_BLOCK_LL=285]="ICE_BLOCK_LL",e[e.SHOOT_BOOK=286]="SHOOT_BOOK",e[e.KILLER_BOOK=287]="KILLER_BOOK",e[e.BOOK_GENERATOR=288]="BOOK_GENERATOR",e[e.BOOK_SWITCH=289]="BOOK_SWITCH",e[e.ICE_DONKETU=290]="ICE_DONKETU",e[e.KING_DONKETU=291]="KING_DONKETU",e[e.TREASURE_BOX=292]="TREASURE_BOX",e[e.MC_WATER=293]="MC_WATER",e[e.CHAIR=294]="CHAIR",e[e.MC_METALNET=295]="MC_METALNET",e[e.MC_DODAI=296]="MC_DODAI",e[e.MC_HAZAD=297]="MC_HAZAD",e[e.MC_FLAG=298]="MC_FLAG",e[e.DONKAKU=299]="DONKAKU",e[e.DONGURU=300]="DONGURU",e[e.HOLHEI=301]="HOLHEI",e[e.SCALEUP_KINOKO=302]="SCALEUP_KINOKO",e[e.C0_WATER=303]="C0_WATER",e[e.SECRET_COIN=304]="SECRET_COIN",e[e.BC_SWITCH=305]="BC_SWITCH",e[e.OBJ_NUMBER=306]="OBJ_NUMBER",e[e.BUBBLE=307]="BUBBLE",e[e.STAR_CREATE=308]="STAR_CREATE",e[e.SLIDER_MANAGER=309]="SLIDER_MANAGER",e[e.OBJ_VOLCANO_CANNON=310]="OBJ_VOLCANO_CANNON",e[e.WATER_RING=311]="WATER_RING",e[e.FIREPAKUN=312]="FIREPAKUN",e[e.FIREPAKUN_S=313]="FIREPAKUN_S",e[e.PAKUN2=314]="PAKUN2",e[e.ENEMY_SWITCH=315]="ENEMY_SWITCH",e[e.ENEMY_CREATE=316]="ENEMY_CREATE",e[e.WATER_HAKIDASI=317]="WATER_HAKIDASI",e[e.WATER_TATUMAKI=318]="WATER_TATUMAKI",e[e.WATER_SUIKOMI=319]="WATER_SUIKOMI",e[e.TORNADO=320]="TORNADO",e[e.FIRERING=321]="FIRERING",e[e.LUIGI=322]="LUIGI",e[e.SET_SE=323]="SET_SE",e[e.MUGEN_BGM=324]="MUGEN_BGM",e[e.SOUND_OBJ=325]="SOUND_OBJ",e[e.TRG_MINIMAP_CHANGE=511]="TRG_MINIMAP_CHANGE"}(v||(v={}));class w{constructor(e){this.dataFetcher=e,this.filePromiseCache=new Map,this.fileDataCache=new Map,this.modelCache=new Map,this.gfxRenderCache=new b.GfxRenderCache}waitForLoad(){const e=[...this.filePromiseCache.values()];return Promise.all(e)}mountNARC(e){for(let t=0;t<e.files.length;t++){const a=e.files[t];this.fileDataCache.set(p.assertExists(a.path),a.buffer)}}fetchFile(e){p.assert(!this.filePromiseCache.has(e)),p.assert(e.startsWith("/data"));const t=this.dataFetcher.fetchData(`sm64ds${e}`,0,()=>{this.filePromiseCache.delete(e)});return this.filePromiseCache.set(e,t),t}fetchFileData(e){const t=this.fileDataCache.get(e);if(void 0!==t)return Promise.resolve(t);const a=this.filePromiseCache.get(e);return void 0!==a?a.then(()=>this.getFileData(e)):this.fetchFile(e).then(t=>(this.fileDataCache.set(e,t),t))}getFileData(e){return p.assertExists(this.fileDataCache.get(e))}getModel(e,t){let a=this.modelCache.get(t);if(void 0===a){const r=p.assertExists(this.fileDataCache.get(t)),n=l.maybeDecompress(r),s=c.parse(n);a=new d.BMDData(e,this.gfxRenderCache,s),this.modelCache.set(t,a)}return a}async fetchModel(e,t){return await this.fetchFileData(t),this.getModel(e,t)}destroy(e){for(const t of this.modelCache.values())t.destroy(e);this.gfxRenderCache.destroy(e)}}const x=[{numUniformBuffers:3,numSamplers:1}];class T{constructor(e,t,a){this.modelCache=t,this.crg1Level=a,this.renderTarget=new u.BasicRenderTarget,this.objectRenderers=[],this.bmdRenderers=[],this.animationController=new f.default,this.renderInstManager=new g.GfxRenderInstManager,this.currentScenarioIndex=-1,this.uniformBuffer=new A.GfxRenderDynamicUniformBuffer(e)}prepareToRender(e,t,a){this.animationController.setTimeFromViewerInput(a);const r=this.renderInstManager.pushTemplateRenderInst();r.setUniformBuffer(this.uniformBuffer),r.setBindingLayouts(x);let n=r.allocateUniformBuffer(d.NITRO_Program.ub_SceneParams,16);const s=r.mapUniformBufferF32(d.NITRO_Program.ub_SceneParams);n+=_.fillMatrix4x4(s,n,a.camera.projectionMatrix);for(let t=0;t<this.bmdRenderers.length;t++)this.bmdRenderers[t].prepareToRender(e,this.renderInstManager,a);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].prepareToRender(e,this.renderInstManager,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,u.transparentBlackFullClearRenderPassDescriptor);this.renderInstManager.setVisibleByFilterKeyExact(2),this.renderInstManager.drawOnPassRenderer(e,r),e.submitPass(r);const n=this.renderTarget.createRenderPass(e,t.viewport,u.depthClearRenderPassDescriptor);return this.renderInstManager.setVisibleByFilterKeyExact(1),this.renderInstManager.drawOnPassRenderer(e,n),this.renderInstManager.resetRenderInsts(),n}setCurrentScenario(e){if(this.currentScenarioIndex===e)return;this.currentScenarioIndex=e;const t=e+1,a=e===this.crg1Level.SetupNames.length;for(let e=0;e<this.objectRenderers.length;e++){const r=this.objectRenderers[e];r.visible=0===r.setup||r.setup===t||a}this.onstatechanged(),this.scenarioSelect.selectItem(e)}createPanels(){const e=new s.Panel;e.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,e.setTitle(s.TIME_OF_DAY_ICON,"Scenario");const t=this.crg1Level.SetupNames.slice();t.length>0&&t.push("All Scenarios"),this.scenarioSelect=new s.SingleSelect,this.scenarioSelect.setStrings(t),this.scenarioSelect.onselectionchange=e=>{this.setCurrentScenario(e)},this.scenarioSelect.selectItem(0),e.contents.appendChild(this.scenarioSelect.elem),e.setVisible(t.length>0);const a=new s.Panel;a.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,a.setTitle(s.RENDER_HACKS_ICON,"Render Hacks");const r=new s.Checkbox("Enable Vertex Colors",!0);r.onchanged=()=>{const e=r.checked;for(let t=0;t<this.bmdRenderers.length;t++)this.bmdRenderers[t].setVertexColorsEnabled(e)},a.contents.appendChild(r.elem);const n=new s.Checkbox("Enable Textures",!0);return n.onchanged=()=>{const e=n.checked;for(let t=0;t<this.bmdRenderers.length;t++)this.bmdRenderers[t].setTexturesEnabled(e)},a.contents.appendChild(n.elem),[e,a]}serializeSaveState(e,t){return new DataView(e).setUint8(t++,this.currentScenarioIndex),t}deserializeSaveState(e,t,a){const r=new DataView(e);return t<a&&this.setCurrentScenario(r.getUint8(t++)),t}destroy(e){this.renderInstManager.destroy(e),this.uniformBuffer.destroy(e),this.renderTarget.destroy(e)}}class y{constructor(e,t){this.speed=e,this.phase=t}updateNormalMatrix(e,t){const a=this.phase+e/30*this.speed;m.mat4.rotateY(t,t,a)}updateModelMatrix(e,t){this.updateNormalMatrix(e,t)}}class C{constructor(e){this.modelInstance=e,this.animationController=new f.default,this.animation=null,this.visible=!0,this.setup=0,this.modelMatrix=m.mat4.create()}calcAnim(e){this.animationController.setTimeFromViewerInput(e),m.mat4.copy(this.modelInstance.modelMatrix,this.modelMatrix),null!==this.animation&&this.animation.updateModelMatrix(e.time,this.modelInstance.modelMatrix)}prepareToRender(e,t,a){this.visible&&(this.calcAnim(a),this.modelInstance.prepareToRender(e,t,a))}}const M=m.vec3.create();class U{constructor(e,t){this.visible=!0,this.setup=0,this.modelMatrix=m.mat4.create(),this.animationPhase=0,this.body0=new d.BMDModelInstance(e),this.body1=new d.BMDModelInstance(e),this.body2=new d.BMDModelInstance(e),this.body3=new d.BMDModelInstance(e),this.head=new d.BMDModelInstance(t),this.animationPhase=Math.random()}calcAnim(e){m.mat4.copy(this.body0.modelMatrix,this.modelMatrix),m.mat4.copy(this.body1.modelMatrix,this.modelMatrix),m.mat4.copy(this.body2.modelMatrix,this.modelMatrix),m.mat4.copy(this.body3.modelMatrix,this.modelMatrix),m.mat4.copy(this.head.modelMatrix,this.modelMatrix),m.vec3.set(M,0,5,0);const t=e.time+400*this.animationPhase;M[0]+=4*Math.sin(t/400),M[2]+=4*Math.cos(t/400),m.mat4.translate(this.body0.modelMatrix,this.body0.modelMatrix,M),M[1]+=15,M[0]+=3*Math.sin(t/420),M[2]+=3*Math.cos(t/420),m.mat4.translate(this.body1.modelMatrix,this.body1.modelMatrix,M),M[1]+=15,M[0]+=2*Math.sin(t/-320),M[2]+=2*Math.cos(t/-320),m.mat4.translate(this.body2.modelMatrix,this.body2.modelMatrix,M),M[1]+=15,M[0]+=1*Math.sin(t/200),M[2]+=1*Math.cos(t/200),m.mat4.translate(this.body3.modelMatrix,this.body3.modelMatrix,M),M[1]+=15,m.mat4.translate(this.head.modelMatrix,this.head.modelMatrix,M)}prepareToRender(e,t,a){this.visible&&(this.calcAnim(a),this.head.prepareToRender(e,t,a),this.body0.prepareToRender(e,t,a),this.body1.prepareToRender(e,t,a),this.body2.prepareToRender(e,t,a),this.body3.prepareToRender(e,t,a))}}class k{constructor(e,t){this.crg1=e,this.modelCache=t}destroy(e){this.modelCache.destroy(e)}}class D{constructor(e,t){this.levelId=e,this.name=t,this.id=""+this.levelId}async _createBMDRenderer(e,t,a,r,n,s){const i=t.modelCache,o=await i.fetchModel(e,a),l=new d.BMDModelInstance(o,n);return m.mat4.scale(l.modelMatrix,l.modelMatrix,[r,r,r]),l.isSkybox=s,t.bmdRenderers.push(l),l}async _createBMDObjRenderer(e,t,a){const r=t.modelCache,n=await r.fetchModel(e,a),s=new d.BMDModelInstance(n),i=new C(s);return t.objectRenderers.push(i),i.modelInstance.name=a,i}modelMatrixFromObjectAndScale(e,t,a,r=0){const n=m.vec3.fromValues(t.Position.X,t.Position.Y,t.Position.Z),s=.01745*(t.Rotation.Y+r);m.vec3.scale(n,n,1500),m.mat4.translate(e,e,n),m.mat4.rotateY(e,e,s),a*=15,m.mat4.scale(e,e,[a,a,a])}async _createBMDRendererForStandardObject(e,t,a){const r=t.modelCache,n=async(r,n=.8,s=0)=>{const i=await this._createBMDObjRenderer(e,t,r);return this.modelMatrixFromObjectAndScale(i.modelMatrix,a,n),s>0&&(i.animation=new y(s,0)),i.setup=a.Setup,i},s=async(e,a)=>{const r=await t.modelCache.fetchFileData(a),n=h.parse(l.maybeDecompress(r));n.loopMode=1,e.animationController.phaseFrames+=Math.random()*n.duration,e.modelInstance.bindBCA(e.animationController,n)},i=a.ObjectId;if(i===v.EWB_ICE_A){await n("/data/special_obj/ewb_ice/ewb_ice_a.bmd")}else if(i===v.EWB_ICE_B){await n("/data/special_obj/ewb_ice/ewb_ice_b.bmd")}else if(i===v.EWB_ICE_C){await n("/data/special_obj/ewb_ice/ewb_ice_c.bmd")}else if(i===v.EWM_ICE_BLOCK){await n("/data/special_obj/ewm_ice_brock/ewm_ice_brock.bmd")}else if(i===v.EMM_LOG){await n("/data/special_obj/emm_log/emm_log.bmd")}else if(i===v.EMM_YUKA){await n("/data/special_obj/emm_yuka/emm_yuka.bmd")}else if(i===v.UPDOWN_LIFT){await n("/data/normal_obj/obj_updnlift/obj_updnlift.bmd")}else if(i===v.HS_UPDOWN_LIFT){await n("/data/special_obj/hs_updown_lift/hs_updown_lift.bmd")}else if(i===v.PATH_LIFT){await n("/data/normal_obj/obj_pathlift/obj_pathlift.bmd")}else if(i===v.WANWAN){const e=await n("/data/enemy/wanwan/wanwan.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,32,0]),await s(e,"/data/enemy/wanwan/wanwan_wait.bca")}else if(i===v.CAMERA_TAG);else if(i===v.SEESAW){await n("/data/normal_obj/obj_seesaw/obj_seesaw.bmd")}else if(i===v.IRONBALL){const e=await n("/data/enemy/iron_ball/iron_ball.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,16,0])}else if(i===v.GORO_ROCK){await n("/data/special_obj/cv_goro_rock/cv_goro_rock.bmd")}else if(i===v.KURIBO){const e=await n("/data/enemy/kuribo/kuribo_model.bmd");await s(e,"/data/enemy/kuribo/kuribo_wait.bca")}else if(i===v.KURIBO_S){const e=await n("/data/enemy/kuribo/kuribo_model.bmd",.2);await s(e,"/data/enemy/kuribo/kuribo_wait.bca")}else if(i===v.KURIBO_L){const e=await n("/data/enemy/kuribo/kuribo_model.bmd",1.6);await s(e,"/data/enemy/kuribo/kuribo_wait.bca")}else if(i===v.KURIKING){const e=await n("/data/enemy/kuriking/kuriking_model.bmd");await s(e,"/data/enemy/kuriking/kuriking_wait.bca")}else if(i===v.BOMBHEI){const e=await n("/data/enemy/bombhei/bombhei.bmd");await s(e,"/data/enemy/bombhei/bombhei_walk.bca")}else if(i===v.RED_BOMBHEI){const e=await n("/data/enemy/bombhei/red_bombhei.bmd");await s(e,"/data/enemy/bombhei/red_wait.bca")}else if(i===v.NOKONOKO){const e=await n("/data/enemy/nokonoko/nokonoko.bmd");await s(e,"/data/enemy/nokonoko/nokonoko_walk.bca")}else if(i===v.NOKONOKO_S){await n("/data/enemy/nokonoko/shell_green.bmd")}else if(i===v.BLOCK_L){await n("/data/normal_obj/obj_block/broken_block_l.bmd")}else if(i===v.DP_BLOCK_L){await n("/data/normal_obj/obj_block/broken_block_l.bmd",1.2)}else if(i===v.SW_BLOCK_L){await n("/data/normal_obj/obj_block/broken_block_l.bmd")}else if(i===v.POWER_UP_ITEM){await n("/data/normal_obj/obj_power_flower/p_flower_open.bmd")}else if(i===v.HATENA_SWITCH){await n("/data/normal_obj/obj_hatena_switch/hatena_switch.bmd")}else if(i===v.BLOCK_S){await n("/data/normal_obj/obj_block/broken_block_s.bmd")}else if(i===v.CANNON_SHUTTER){await n("/data/normal_obj/obj_cannon_shutter/cannon_shutter.bmd")}else if(i===v.HATENA_BLOCK){await n("/data/normal_obj/obj_hatena_box/hatena_box.bmd")}else if(i===v.ITEM_BLOCK){await n("/data/normal_obj/obj_hatena_box/obj_hatena_y_box.bmd")}else if(i===v.VS_ITEM_BLOCK){await n("/data/normal_obj/obj_hatena_box/obj_hatena_y_box.bmd")}else if(i===v.CAP_BLOCK_M){await n("/data/normal_obj/obj_hatena_box/obj_cap_box_m.bmd")}else if(i===v.CAP_BLOCK_W){await n("/data/normal_obj/obj_hatena_box/obj_cap_box_w.bmd")}else if(i===v.CAP_BLOCK_L){await n("/data/normal_obj/obj_hatena_box/obj_cap_box_l.bmd")}else if(i===v.PILE){await n("/data/normal_obj/obj_pile/pile.bmd")}else if(i===v.COIN){await n("/data/normal_obj/coin/coin_poly32.bmd",.7,.1)}else if(i===v.RED_COIN){await n("/data/normal_obj/coin/coin_red_poly32.bmd",.7,.1)}else if(i===v.BLUE_COIN){await n("/data/normal_obj/coin/coin_blue_poly32.bmd",.7,.1)}else if(i===v.KOOPA){const e=await n("/data/enemy/koopa/koopa_model.bmd");await s(e,"/data/enemy/koopa/koopa_wait1.bca")}else if(i===v.TREE){const e=`/data/normal_obj/tree/${["bomb","toge","yuki","yashi","castle","castle","castle","castle"][a.Parameters[0]>>>4&7]}_tree.bmd`;await n(e)}else if(i===v.PICTURE_GATE){const e=`/data/picture/${["for_bh","for_bk","for_ki","for_sm","for_cv_ex5","for_fl","for_dl","for_wl","for_sl","for_wc","for_hm","for_hs","for_td_tt","for_ct","for_ex_mario","for_ex_luigi","for_ex_wario","for_vs_cross","for_vs_island"][a.Parameters[0]>>>8&31]}.bmd`,t=1+(15&a.Parameters[0]),r=1+(a.Parameters[0]>>4&15),s=a.Parameters[1]/32767*Math.PI,i=3==(a.Parameters[0]>>13&3),o=await n(e);m.mat4.rotateX(o.modelMatrix,o.modelMatrix,s),m.mat4.scale(o.modelMatrix,o.modelMatrix,[t,r,1]),m.mat4.translate(o.modelMatrix,o.modelMatrix,[0,6.25,0]),i&&(o.modelInstance.extraTexCoordMat=m.mat2d.create(),o.modelInstance.extraTexCoordMat[0]*=-1)}else if(i===v.HANSWITCH){await n("/data/normal_obj/obj_box_switch/obj_box_switch.bmd")}else if(i===v.STAR_SWITCH){await n("/data/normal_obj/obj_star_switch/obj_star_switch.bmd")}else if(i===v.SWITCHDOOR){await n("/data/special_obj/b_ana_shutter/b_ana_shutter.bmd")}else if(i===v.CV_SHUTTER){await n("/data/special_obj/cv_shutter/cv_shutter.bmd")}else if(i===v.CV_NEWS_LIFT){await n("/data/special_obj/cv_news_lift/cv_news_lift.bmd")}else if(i===v.WANWAN2){const e=await n("/data/enemy/wanwan/wanwan.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,32,0]),await s(e,"/data/enemy/wanwan/wanwan_wait.bca")}else if(i===v.ONEUPKINOKO){await n("/data/normal_obj/oneup_kinoko/oneup_kinoko.bmd")}else if(i===v.CANNON){await n("/data/normal_obj/obj_cannon/houdai.bmd")}else if(i===v.WANWAN_SHUTTER){await n("/data/special_obj/b_wan_shutter/b_wan_shutter.bmd")}else if(i===v.WATERBOMB){await n("/data/enemy/water_bomb/water_bomb.bmd")}else if(i===v.SBIRD){await n("/data/normal_obj/bird/bird.bmd")}else if(i===v.FISH){const e=await n("/data/normal_obj/fish/fish.bmd");await s(e,"/data/normal_obj/fish/fish_wait.bca")}else if(i===v.BUTTERFLY){await n("/data/normal_obj/butterfly/butterfly.bmd")}else if(i===v.BOMBKING){const e=await n("/data/enemy/bombking/bomb_king.bmd");await s(e,"/data/enemy/bombking/bombking_wait1.bca")}else if(i===v.SNOWMAN){const e=await n("/data/enemy/snowman/snowman_model.bmd");await s(e,"/data/enemy/snowman/snowman_wait.bca")}else if(i===v.PIANO){const e=await n("/data/enemy/piano/piano.bmd");await s(e,"/data/enemy/piano/piano_attack.bca")}else if(i===v.PAKUN){const e=await n("/data/enemy/pakkun/pakkun_model.bmd");await s(e,"/data/enemy/pakkun/pakkun_sleep_loop.bca")}else{if(i===v.STAR_CAMERA)return;if(i===v.STAR){await n("/data/normal_obj/star/obj_star.bmd",.8,.08)}else if(i===v.SILVER_STAR){await n("/data/normal_obj/star/obj_star_silver.bmd",.8,.08)}else if(i===v.STARBASE){let e="/data/normal_obj/star/obj_star.bmd",t=.08;switch(a.Parameters[0]>>>4&15){case 0:e="/data/normal_obj/star/star_base.bmd";break;case 1:case 4:case 6:e="/data/normal_obj/star_box/star_box.bmd",t=0}await n(e,.8,t)}else if(i===v.BATAN){const e=await n("/data/enemy/battan/battan.bmd");await s(e,"/data/enemy/battan/battan_walk.bca")}else if(i===v.BATANKING){const e=await n("/data/enemy/battan_king/battan_king.bmd");await s(e,"/data/enemy/battan_king/battan_king_walk.bca")}else if(i===v.DOSUN){await n("/data/enemy/dosune/dosune.bmd")}else if(i===v.TERESA){const e=await n("/data/enemy/teresa/teresa.bmd");await s(e,"/data/enemy/teresa/teresa_wait.bca")}else if(i===v.BOSS_TERESA){const e=await n("/data/enemy/boss_teresa/boss_teresa.bmd");await s(e,"/data/enemy/boss_teresa/boss_teresa_wait.bca")}else if(i===v.ICON_TERESA);else if(i===v.KAIDAN);else if(i===v.BOOKSHELF){await n("/data/special_obj/th_hondana/th_hondana.bmd")}else if(i===v.MERRYGOROUND){await n("/data/special_obj/th_mery_go/th_mery_go.bmd")}else if(i===v.TERESAPIT){await n("/data/special_obj/th_trap/th_trap.bmd")}else if(i===v.PL_CLOSET);else if(i===v.KANBAN){await n("/data/normal_obj/obj_kanban/obj_kanban.bmd")}else if(i===v.TATEFUDA){await n("/data/normal_obj/obj_tatefuda/obj_tatefuda.bmd")}else if(i===v.ICE_BOARD){await n("/data/normal_obj/obj_ice_board/obj_ice_board.bmd")}else if(i===v.WAKAME){const e=await n("/data/normal_obj/obj_wakame/obj_wakame.bmd");await s(e,"/data/normal_obj/obj_wakame/obj_wakame_wait.bca")}else if(i===v.HEART){await n("/data/normal_obj/obj_heart/obj_heart.bmd",.8,.05)}else if(i===v.KINOPIO){const e=await n("/data/enemy/kinopio/kinopio.bmd");await s(e,"/data/enemy/kinopio/kinopio_wait1.bca")}else if(i===v.KOOPA2BG){await n("/data/special_obj/kb2_stage/kb2_stage.bmd")}else if(i===v.KOOPA3BG){await n("/data/special_obj/kb3_stage/kb3_a.bmd");await n("/data/special_obj/kb3_stage/kb3_b.bmd"),await n("/data/special_obj/kb3_stage/kb3_c.bmd"),await n("/data/special_obj/kb3_stage/kb3_d.bmd"),await n("/data/special_obj/kb3_stage/kb3_e.bmd"),await n("/data/special_obj/kb3_stage/kb3_f.bmd"),await n("/data/special_obj/kb3_stage/kb3_g.bmd"),await n("/data/special_obj/kb3_stage/kb3_h.bmd"),await n("/data/special_obj/kb3_stage/kb3_i.bmd"),await n("/data/special_obj/kb3_stage/kb3_j.bmd")}else if(i===v.SHELL){await n("/data/enemy/nokonoko/shell_green.bmd")}else if(i===v.SHARK){const e=await n("/data/enemy/hojiro/hojiro.bmd");await s(e,"/data/enemy/hojiro/hojiro_swim.bca")}else if(i===v.CT_MECHA01){await n("/data/special_obj/ct_mecha_obj01/ct_mecha_obj01.bmd")}else if(i===v.CT_MECHA03){await n("/data/special_obj/ct_mecha_obj03/ct_mecha_obj03.bmd")}else if(i===v.CT_MECHA04L){await n("/data/special_obj/ct_mecha_obj04l/ct_mecha_obj04l.bmd")}else if(i===v.CT_MECHA04S){await n("/data/special_obj/ct_mecha_obj04s/ct_mecha_obj04s.bmd")}else if(i===v.CT_MECHA05){await n("/data/special_obj/ct_mecha_obj05/ct_mecha_obj05.bmd")}else if(i===v.CT_MECHA06){await n("/data/special_obj/ct_mecha_obj06/ct_mecha_obj06.bmd")}else if(i===v.CT_MECHA09){await n("/data/special_obj/ct_mecha_obj09/ct_mecha_obj09.bmd")}else if(i===v.CT_MECHA10){await n("/data/special_obj/ct_mecha_obj10/ct_mecha_obj10.bmd")}else if(i===v.CT_MECHA11){await n("/data/special_obj/ct_mecha_obj11/ct_mecha_obj11.bmd")}else if(i===v.CT_MECHA12L){await n("/data/special_obj/ct_mecha_obj12l/ct_mecha_obj12l.bmd")}else if(i===v.CT_MECHA12S){await n("/data/special_obj/ct_mecha_obj12s/ct_mecha_obj12s.bmd")}else if(i===v.DP_BROCK){await n("/data/special_obj/dp_brock/dp_brock.bmd")}else if(i===v.DP_LIFT){await n("/data/special_obj/dp_lift/dp_lift.bmd")}else if(i===v.DL_PYRAMID){await n("/data/special_obj/dl_pyramid/dl_pyramid.bmd")}else if(i===v.DL_PYRAMID_DUMMY);else if(i===v.WL_POLELIFT){await n("/data/special_obj/wl_pole_lift/wl_pole_lift.bmd")}else if(i===v.WL_SUBMARINE){await n("/data/special_obj/wl_submarine/wl_submarine.bmd")}else if(i===v.WL_KOOPA_SHUTTER){await n("/data/special_obj/wl_kupa_shutter/wl_kupa_shutter.bmd")}else if(i===v.RC_DORIFU){await n("/data/special_obj/rc_dorifu/rc_dorifu0.bmd")}else if(i===v.RC_RIFT01){await n("/data/special_obj/rc_rift01/rc_rift01.bmd")}else if(i===v.RC_HANE){await n("/data/special_obj/rc_hane/rc_hane.bmd")}else if(i===v.RC_TIKUWA){await n("/data/special_obj/rc_tikuwa/rc_tikuwa.bmd")}else if(i===v.RC_BURANKO){await n("/data/special_obj/rc_buranko/rc_buranko.bmd")}else if(i===v.RC_SEESAW){await n("/data/special_obj/rc_shiso/rc_shiso.bmd")}else if(i===v.RC_KAITEN){await n("/data/special_obj/rc_kaiten/rc_kaiten.bmd")}else if(i===v.RC_GURUGURU){await n("/data/special_obj/rc_guruguru/rc_guruguru.bmd")}else if(i===v.SL_ICEBLOCK){await n("/data/special_obj/sl_ice_brock/sl_ice_brock.bmd")}else if(i===v.HM_MARUTA){await n("/data/special_obj/hm_maruta/hm_maruta.bmd")}else if(i===v.TT_FUTA){await n("/data/special_obj/tt_obj_futa/tt_obj_futa.bmd")}else if(i===v.TT_WATER){await n("/data/special_obj/tt_obj_water/tt_obj_water.bmd")}else if(i===v.TD_FUTA){await n("/data/special_obj/td_obj_futa/td_obj_futa.bmd")}else if(i===v.TD_WATER){await n("/data/special_obj/td_obj_water/td_obj_water.bmd")}else if(i===v.WC_UKISIMA){await n("/data/special_obj/wc_obj07/wc_obj07.bmd",1,.05)}else if(i===v.WC_OBJ01){await n("/data/special_obj/wc_obj01/wc_obj01.bmd")}else if(i===v.WC_OBJ02){await n("/data/special_obj/wc_obj02/wc_obj02.bmd")}else if(i===v.WC_OBJ03){await n("/data/special_obj/wc_obj03/wc_obj03.bmd")}else if(i===v.WC_OBJ04){await n("/data/special_obj/wc_obj04/wc_obj04.bmd")}else if(i===v.WC_OBJ05){await n("/data/special_obj/wc_obj05/wc_obj05.bmd")}else if(i===v.WC_OBJ06){await n("/data/special_obj/wc_obj06/wc_obj06.bmd")}else if(i===v.WC_MIZU){await n("/data/special_obj/wc_mizu/wc_mizu.bmd")}else if(i===v.FL_RING){await n("/data/special_obj/fl_ring/fl_ring.bmd")}else if(i===v.FL_GURA){await n("/data/special_obj/fl_gura/fl_gura.bmd")}else if(i===v.FL_LONDON){await n("/data/special_obj/fl_london/fl_london.bmd")}else if(i===v.FL_BLOCK){await n("/data/special_obj/fl_block/fl_block.bmd")}else if(i===v.FL_UKIYUKA){await n("/data/special_obj/fl_uki_yuka/fl_uki_yuka.bmd")}else if(i===v.FL_UKIYUKA_L){await n("/data/special_obj/fl_shiso/fl_shiso.bmd")}else if(i===v.FL_SEESAW){await n("/data/special_obj/fl_shiso/fl_shiso.bmd")}else if(i===v.FL_KOMA_D){await n("/data/special_obj/fl_koma_d/fl_koma_d.bmd")}else if(i===v.FL_KOMA_U){await n("/data/special_obj/fl_koma_u/fl_koma_u.bmd")}else if(i===v.FL_UKI_KI){await n("/data/special_obj/fl_uki_ki/fl_uki_ki.bmd")}else if(i===v.FL_KUZURE){await n("/data/special_obj/fl_kuzure/fl_kuzure.bmd")}else if(i===v.FM_BATTAN){await n("/data/special_obj/fm_battan/fm_battan.bmd")}else if(i===v.LAVA);else if(i===v.WATERFALL);else if(i===v.MANTA){const e=await n("/data/enemy/manta/manta.bmd");await s(e,"/data/enemy/manta/manta_swim.bca")}else if(i===v.SPIDER){const e=await n("/data/enemy/spider/spider.bmd");await s(e,"/data/enemy/spider/spider_walk.bca")}else if(i===v.JUGEM){const e=await n("/data/enemy/jugem/jugem.bmd");await s(e,"/data/enemy/jugem/jugem_wait.bca")}else if(i===v.GAMAGUCHI){const e=await n("/data/enemy/gamaguchi/gamaguchi.bmd");await s(e,"/data/enemy/gamaguchi/gamaguchi_walk.bca")}else if(i===v.EYEKUN){await n("/data/enemy/eyekun/eyekun.bmd")}else if(i===v.EYEKUN_BOSS){await n("/data/enemy/eyekun/eyekun.bmd",2)}else if(i===v.BATTA_BLOCK){await n("/data/enemy/batta_block/batta_block.bmd")}else if(i===v.BIRIKYU){const e=await n("/data/enemy/birikyu/birikyu.bmd");await n("/data/enemy/birikyu/birikyu_elec.bmd"),await s(e,"/data/enemy/birikyu/birikyu_elec.bca")}else if(i===v.HM_BASKET){await n("/data/special_obj/hm_basket/hm_basket.bmd")}else if(i===v.MONKEY_THIEF){const e=await n("/data/enemy/monkey/monkey.bmd");await s(e,"/data/enemy/monkey/monkey_wait1.bca")}else if(i===v.MONKEY_STAR);else if(i===v.PENGUIN_BABY){const e=await n("/data/enemy/penguin/penguin_child.bmd",.25);await s(e,"/data/enemy/penguin/penguin_walk2.bca")}else if(i===v.PENGUIN_MOTHER){const e=await n("/data/enemy/penguin/penguin.bmd");await s(e,"/data/enemy/penguin/penguin_wait1.bca")}else if(i===v.PENGUIN_RACER){const e=await n("/data/enemy/penguin/penguin.bmd");await s(e,"/data/enemy/penguin/penguin_wait1.bca")}else if(i===v.PENGUIN_DEFENDER){const e=await n("/data/enemy/penguin/penguin.bmd");await s(e,"/data/enemy/penguin/penguin_walk.bca")}else if(i===v.KERONPA){await n("/data/enemy/keronpa/keronpa.bmd")}else if(i===v.BIG_SNOWMAN){const e=await n("/data/enemy/big_snowman/big_snowman_body.bmd",1.25);await n("/data/enemy/big_snowman/big_snowman_head.bmd",1.25);m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,5,0])}else if(i===v.BIG_SNOWMAN_BODY){await n("/data/enemy/big_snowman/big_snowman_body.bmd")}else if(i===v.BIG_SNOWMAN_HEAD){await n("/data/enemy/big_snowman/big_snowman_head.bmd")}else if(i===v.SNOWMAN_BREATH);else if(i===v.PUKUPUKU){const e=await n("/data/enemy/pukupuku/pukupuku.bmd");await s(e,"/data/enemy/pukupuku/pukupuku_swim.bca")}else if(i===v.CLOCK_SHORT){await n("/data/special_obj/c2_hari_short/c2_hari_short.bmd")}else if(i===v.CLOCK_LONG){await n("/data/special_obj/c2_hari_long/c2_hari_long.bmd")}else if(i===v.CLOCK_HURIKO){await n("/data/special_obj/c2_huriko/c2_huriko.bmd"),await n("/data/enemy/wanwan/chain.bmd")}else if(i===v.MENBO){const e=await n("/data/enemy/menbo/menbo.bmd");await s(e,"/data/enemy/menbo/menbo_wait1.bca")}else if(i===v.CASKET);else if(i===v.HYUHYU){const e=await n("/data/enemy/hyuhyu/hyuhyu.bmd");await s(e,"/data/enemy/hyuhyu/hyuhyu_wait.bca")}else if(i===v.BOMB_SEESAW){await n("/data/special_obj/b_si_so/b_si_so.bmd")}else if(i===v.KM1_SEESAW){await n("/data/special_obj/km1_shiso/km1_shiso.bmd")}else if(i===v.KM1_DORIFU){await n("/data/special_obj/km1_dorifu/km1_dorifu0.bmd")}else if(i===v.KM1_UKISHIMA){await n("/data/special_obj/km1_ukishima/km1_ukishima.bmd")}else if(i===v.KM1_KURUMAJIKU){await n("/data/special_obj/km1_kuruma/km1_kurumajiku.bmd");const e=await n("/data/special_obj/km1_kuruma/km1_kuruma.bmd"),t=await n("/data/special_obj/km1_kuruma/km1_kuruma.bmd"),a=await n("/data/special_obj/km1_kuruma/km1_kuruma.bmd"),r=await n("/data/special_obj/km1_kuruma/km1_kuruma.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,50,37.5]),m.mat4.translate(r.modelMatrix,r.modelMatrix,[50,0,37.5]),m.mat4.translate(a.modelMatrix,a.modelMatrix,[-50,0,37.5]),m.mat4.translate(t.modelMatrix,t.modelMatrix,[0,-50,37.5])}else if(i===v.KM1_DERU){await n("/data/special_obj/km1_deru/km1_deru.bmd")}else if(i===v.KI_FUNE);else if(i===v.KI_FUNE_UP){await n("/data/special_obj/ki_fune/ki_fune_up.bmd")}else if(i===v.KI_HASIRA){await n("/data/special_obj/ki_hasira/ki_hasira.bmd")}else if(i===v.KI_ITA){await n("/data/special_obj/ki_ita/ki_ita.bmd")}else if(i===v.KI_IWA){await n("/data/special_obj/ki_iwa/ki_iwa.bmd")}else if(i===v.KS_MIZU);else if(i===v.DOKAN){await n("/data/normal_obj/obj_dokan/obj_dokan.bmd")}else if(i===v.YAJIRUSI_L){await n("/data/normal_obj/obj_yajirusi_l/yajirusi_l.bmd")}else if(i===v.YAJIRUSI_R){await n("/data/normal_obj/obj_yajirusi_r/yajirusi_r.bmd")}else if(i===v.PROPELLER_HEYHO){const e=await n("/data/enemy/propeller_heyho/propeller_heyho.bmd");await s(e,"/data/enemy/propeller_heyho/propeller_heyho_wait.bca")}else if(i===v.KB1_BILLBOARD){await n("/data/special_obj/kb1_ball/kb1_ball.bmd")}else if(i===v.HS_MOON){await n("/data/special_obj/hs_moon/hs_moon.bmd")}else if(i===v.HS_STAR){await n("/data/special_obj/hs_star/hs_star.bmd")}else if(i===v.HS_Y_STAR){await n("/data/special_obj/hs_y_star/hs_y_star.bmd")}else if(i===v.HS_B_STAR){await n("/data/special_obj/hs_b_star/hs_b_star.bmd")}else if(i===v.BK_BILLBOARD){await n("/data/special_obj/bk_billbord/bk_billbord.bmd")}else if(i===v.BK_KILLER_DAI){await n("/data/special_obj/bk_killer_dai/bk_killer_dai.bmd")}else if(i===v.BK_BOTAOSI){await n("/data/special_obj/bk_botaosi/bk_botaosi.bmd")}else if(i===v.BK_DOWN_B){await n("/data/special_obj/bk_down_b/bk_down_b.bmd")}else if(i===v.BK_FUTA){await n("/data/special_obj/bk_futa/bk_futa.bmd")}else if(i===v.BK_KABE01){await n("/data/special_obj/bk_kabe01/bk_kabe01.bmd")}else if(i===v.BK_KABE00){await n("/data/special_obj/bk_kabe00/bk_kabe00.bmd")}else if(i===v.BK_TOWER){await n("/data/special_obj/bk_tower/bk_tower.bmd")}else if(i===v.BK_UKISIMA){await n("/data/special_obj/bk_ukisima/bk_ukisima.bmd",1,.05)}else if(i===v.BK_ROTEBAR){await n("/data/special_obj/bk_rotebar/bk_rotebar.bmd")}else if(i===v.BK_LIFT01){await n("/data/special_obj/bk_lift01/bk_lift01.bmd")}else if(i===v.BK_DOSSUNBAR_S){await n("/data/special_obj/bk_dossunbar_s/bk_dossunbar_s.bmd")}else if(i===v.BK_DOSSUNBAR_L){await n("/data/special_obj/bk_dossunbar_l/bk_dossunbar_l.bmd")}else if(i===v.BK_TRANSBAR){await n("/data/special_obj/bk_transbar/bk_transbar.bmd")}else if(i===v.TH_DOWN_B){await n("/data/special_obj/th_down_b/th_down_b.bmd")}else if(i===v.KM2_KUZURE){await n("/data/special_obj/km2_kuzure/km2_kuzure.bmd")}else if(i===v.KM2_AGARU){await n("/data/special_obj/km2_agaru/km2_agaru.bmd")}else if(i===v.KM2_GURA){await n("/data/special_obj/km2_gura/km2_gura.bmd")}else if(i===v.KM2_AMI_BOU){await n("/data/special_obj/km2_ami_bou/km2_ami_bou.bmd")}else if(i===v.KM2_YOKOSEESAW){await n("/data/special_obj/km2_yokoshiso/km2_yokoshiso.bmd")}else if(i===v.KM2_SUSUMU){await n("/data/special_obj/km2_susumu/km2_susumu.bmd")}else if(i===v.KM2_UKISHIMA){await n("/data/special_obj/km2_ukishima/km2_ukishima.bmd")}else if(i===v.KM2_RIFUT02){await n("/data/special_obj/km2_rift02/km2_rift02.bmd")}else if(i===v.KM2_RIFUT01){await n("/data/special_obj/km2_rift01/km2_rift01.bmd")}else if(i===v.KM2_NOBIRU){await n("/data/special_obj/km2_nobiru/km2_nobiru.bmd")}else if(i===v.KM3_SEESAW){await n("/data/special_obj/km3_shiso/km3_shiso.bmd")}else if(i===v.KM3_YOKOSEESAW){await n("/data/special_obj/km3_yokoshiso/km3_yokoshiso.bmd")}else if(i===v.KM3_KURUMAJIKU){await n("/data/special_obj/km3_kuruma/km3_kurumajiku.bmd");const e=await n("/data/special_obj/km3_kuruma/km3_kuruma.bmd"),t=await n("/data/special_obj/km3_kuruma/km3_kuruma.bmd"),a=await n("/data/special_obj/km3_kuruma/km3_kuruma.bmd"),r=await n("/data/special_obj/km3_kuruma/km3_kuruma.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,50,37.5]),m.mat4.translate(r.modelMatrix,r.modelMatrix,[50,0,37.5]),m.mat4.translate(a.modelMatrix,a.modelMatrix,[-50,0,37.5]),m.mat4.translate(t.modelMatrix,t.modelMatrix,[0,-50,37.5])}else if(i===v.KM3_DORIFU){await n("/data/special_obj/km3_dan/km3_dan0.bmd")}else if(i===v.KM3_DERU01){await n("/data/special_obj/km3_deru01/km3_deru01.bmd")}else if(i===v.KM3_DERU02){await n("/data/special_obj/km3_deru02/km3_deru02.bmd")}else if(i===v.KM3_KAITENDAI){await n("/data/special_obj/km3_kaitendai/km3_kaitendai.bmd")}else if(i===v.C0_SWITCH){await n("/data/special_obj/c0_switch/c0_switch.bmd")}else if(i===v.SM_LIFT){await n("/data/special_obj/sm_lift/sm_lift.bmd")}else if(i===v.FL_MARUTA){await n("/data/special_obj/fl_log/fl_log.bmd")}else if(i===v.UDLIFT_TERESA){await n("/data/special_obj/th_lift/th_lift.bmd")}else if(i===v.UDLIFT){await n("/data/special_obj/cv_ud_lift/cv_ud_lift.bmd")}else if(i===v.RC_RIFT02){await n("/data/special_obj/rc_rift02/rc_rift02.bmd")}else if(i===v.BAKUBAKU){const e=await n("/data/enemy/bakubaku/bakubaku.bmd");await s(e,"/data/enemy/bakubaku/bakubaku_swim.bca")}else if(i===v.KM3_LIFT){await n("/data/special_obj/km3_rift/km3_rift.bmd")}else if(i===v.KIRAI){await n("/data/enemy/koopa_bomb/koopa_bomb.bmd")}else if(i===v.MIP){const e=await n("/data/enemy/mip/mip.bmd");await s(e,"/data/enemy/mip/mip_wait.bca")}else if(i===v.OWL){const e=await n("/data/enemy/owl/owl.bmd");await s(e,"/data/enemy/owl/owl_fly_free.bca")}else if(i===v.DONKETU){const e=await n("/data/enemy/donketu/donketu.bmd");await s(e,"/data/enemy/donketu/donketu_walk.bca")}else if(i===v.BOSS_DONKETU){const e=await n("/data/enemy/donketu/boss_donketu.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,10,0]),await s(e,"/data/enemy/donketu/donketu_walk.bca")}else if(i===v.ONIMASU){const e=await n("/data/enemy/onimasu/onimasu.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,32,0])}else if(i===v.BAR);else if(i===v.C_JUGEM){const e=await n("/data/enemy/c_jugem/c_jugem.bmd");await s(e,"/data/enemy/c_jugem/c_jugem_wait.bca")}else if(i===v.PUSHBLOCK){await n("/data/normal_obj/obj_pushblock/obj_pushblock.bmd")}else if(i===v.FL_AMILIFT){await n("/data/special_obj/fl_amilift/fl_amilift.bmd")}else if(i===v.YUREI_MUCHO){const e=await n("/data/enemy/yurei_mucho/yurei_mucho.bmd");await s(e,"/data/enemy/yurei_mucho/yurei_mucho_wait.bca")}else if(i===v.CHOROPU){const e=await n("/data/enemy/choropu/choropu.bmd");await s(e,"/data/enemy/choropu/choropu_search.bca")}else if(i===v.BASABASA){const e=await n("/data/enemy/basabasa/basabasa.bmd");await s(e,"/data/enemy/basabasa/basabasa_wait.bca")}else if(i===v.POPOI){const e=await n("/data/enemy/popoi/popoi.bmd");await s(e,"/data/enemy/popoi/popoi_move1.bca")}else if(i===v.JANGO){const e=await n("/data/enemy/jango/jango.bmd");await s(e,"/data/enemy/jango/jango_fly.bca")}else if(i===v.SANBO){const n=await r.fetchModel(e,"/data/enemy/sanbo/sanbo_body.bmd"),s=await r.fetchModel(e,"/data/enemy/sanbo/sanbo_head.bmd"),i=new U(n,s);this.modelMatrixFromObjectAndScale(i.modelMatrix,a,.8),t.objectRenderers.push(i)}else if(i===v.OBJ_MARIO_CAP);else if(i===v.FL_PUZZLE){const e=S.clamp(255&a.Parameters[0],0,13);await n(`/data/special_obj/fl_puzzle/fl_14_${p.leftPad(""+e,2)}.bmd`)}else if(i===v.FL_COIN);else if(i===v.DOSSY){const e=await n("/data/enemy/dossy/dossy.bmd");await s(e,"/data/enemy/dossy/dossy_swim.bca")}else if(i===v.DOSSY_CAP);else if(i===v.HUWAHUWA){const e=await n("/data/enemy/huwahuwa/huwahuwa_model.bmd");await s(e,"/data/enemy/huwahuwa/huwahuwa_move.bca")}else if(i===v.SLIDE_BOX){await n("/data/special_obj/ki_slide_box/ki_slide_box.bmd")}else if(i===v.MORAY){const e=await n("/data/enemy/moray/moray.bmd");await s(e,"/data/enemy/moray/moray_swim.bca")}else if(i===v.OBJ_KUMO){await n("/data/normal_obj/obj_kumo/obj_kumo.bmd")}else if(i===v.OBJ_SHELL){const e=await n("/data/normal_obj/obj_shell/obj_shell.bmd");await s(e,"/data/normal_obj/obj_shell/obj_shell_open.bca")}else if(i===v.OBJ_RED_FIRE);else if(i===v.OBJ_BLUE_FIRE);else if(i===v.OBJ_FLAMETHROWER);else if(i===v.KINOKO_CREATE_TAG);else if(i===v.KINOKO_TAG);else if(i===v.BLK_OKINOKO_TAG);else if(i===v.BLK_SKINOKO_TAG);else if(i===v.BLK_GNSHELL_TAG);else if(i===v.BLK_SLVSTAR_TAG);else if(i===v.C1_TRAP){await n("/data/special_obj/c1_trap/c1_trap.bmd");const e=await n("/data/special_obj/c1_trap/c1_trap.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[-44,0,0])}else if(i===v.C1_PEACH){await n("/data/special_obj/c1_peach/c1_peach.bmd")}else if(i===v.RC_CARPET){const e=await n("/data/special_obj/rc_carpet/rc_carpet.bmd");await s(e,"/data/special_obj/rc_carpet/rc_carpet_wait.bca")}else if(i===v.IWANTE){await n("/data/enemy/iwante/iwante_dummy.bmd")}else if(i===v.HANACHAN){const e=await n("/data/enemy/hanachan/hanachan_head.bmd"),t=await n("/data/enemy/hanachan/hanachan_body01.bmd"),a=await n("/data/enemy/hanachan/hanachan_body02.bmd"),r=await n("/data/enemy/hanachan/hanachan_body03.bmd"),s=await n("/data/enemy/hanachan/hanachan_body04.bmd");m.mat4.translate(e.modelMatrix,e.modelMatrix,[0,16,-5]),m.mat4.translate(t.modelMatrix,t.modelMatrix,[0,16,-15]),m.mat4.translate(a.modelMatrix,a.modelMatrix,[0,16,-30]),m.mat4.translate(r.modelMatrix,r.modelMatrix,[0,16,-45]),m.mat4.translate(s.modelMatrix,s.modelMatrix,[0,16,-60])}else if(i===v.RACE_NOKO){const e=await n("/data/enemy/nokonoko/nokonoko.bmd",1);await s(e,"/data/enemy/nokonoko/nokonoko_wait1.bca")}else if(i===v.RACE_FLAG){const e=await n("/data/normal_obj/obj_race_flag/obj_race_flag.bmd");await s(e,"/data/normal_obj/obj_race_flag/obj_race_flag_wait.bca")}else if(i===v.BLOCK_LL){await n("/data/normal_obj/obj_block/broken_block_ll.bmd")}else if(i===v.ICE_BLOCK_LL){await n("/data/normal_obj/obj_block/ice_block_ll.bmd")}else if(i===v.KILLER_BOOK);else if(i===v.BOOK_GENERATOR);else if(i===v.ICE_DONKETU){const e=await n("/data/enemy/donketu/ice_donketu.bmd");await s(e,"/data/enemy/donketu/ice_donketu_walk.bca")}else if(i===v.KING_DONKETU){const e=await n("/data/enemy/king_ice_donketu/king_ice_donketu_model.bmd");await s(e,"/data/enemy/king_ice_donketu/king_ice_donketu_wait.bca")}else if(i===v.TREASURE_BOX){const e=await n("/data/normal_obj/t_box/t_box.bmd");await s(e,"/data/normal_obj/t_box/t_box_open.bca")}else if(i===v.MC_WATER){await n("/data/special_obj/mc_water/mc_water.bmd")}else if(i===v.CHAIR){await n("/data/enemy/chair/chair.bmd")}else if(i===v.MC_METALNET){await n("/data/special_obj/mc_metalnet/mc_metalnet.bmd")}else if(i===v.MC_DODAI){await n("/data/special_obj/mc_dodai/mc_dodai.bmd")}else if(i===v.MC_HAZAD){await n("/data/special_obj/mc_hazad/mc_hazad.bmd")}else if(i===v.MC_FLAG){const e=await n("/data/special_obj/mc_flag/mc_flag.bmd");await s(e,"/data/special_obj/mc_flag/mc_flag_wait.bca")}else if(i===v.DONKAKU){await n("/data/enemy/donkaku/donkaku.bmd")}else if(i===v.DONGURU){await n("/data/enemy/donguru/donguru.bmd")}else if(i===v.HOLHEI){const e=await n("/data/enemy/horuhei/horuhei.bmd");await s(e,"/data/enemy/horuhei/horuhei_walk.bca")}else if(i===v.SCALEUP_KINOKO){await n("/data/normal_obj/scale_up_kinoko/scale_up_kinoko.bmd")}else if(i===v.C0_WATER){await n("/data/special_obj/c0_water/c0_water.bmd")}else if(i===v.SECRET_COIN);else if(i===v.BC_SWITCH){await n("/data/normal_obj/b_coin_switch/b_coin_switch.bmd")}else if(i===v.BUBBLE);else if(i===v.STAR_CREATE);else if(i===v.SLIDER_MANAGER);else if(i===v.FIREPAKUN){const e=await n("/data/enemy/pakkun/pakkun_model.bmd",2);await s(e,"/data/enemy/pakkun/pakkun_attack.bca")}else if(i===v.FIREPAKUN_S){const e=await n("/data/enemy/pakkun/pakkun_model.bmd",.5);await s(e,"/data/enemy/pakkun/pakkun_attack.bca")}else if(i===v.PAKUN2){const e=await n("/data/enemy/pakkun/pakkun_model.bmd");await s(e,"/data/enemy/pakkun/pakkun_attack.bca")}else if(i===v.ENEMY_SWITCH);else if(i===v.ENEMY_CREATE);else if(i===v.WATER_HAKIDASI);else if(i===v.WATER_TATUMAKI){const e=await n("/data/normal_obj/water_tatumaki/water_tatumaki.bmd");await s(e,"/data/normal_obj/water_tatumaki/water_tatumaki.bca")}else if(i===v.TORNADO){const e=await n("/data/enemy/sand_tornado/sand_tornado.bmd");await s(e,"/data/enemy/sand_tornado/sand_tornado.bca")}else i===v.LUIGI||i===v.SET_SE||i===v.MUGEN_BGM||i===v.TRG_MINIMAP_CHANGE||console.warn(`Unknown object type ${a.ObjectId} / ${v[a.ObjectId]}`)}}async _createBMDRendererForDoorObject(e,t,a){const r=async(r,n=0)=>{const s=await this._createBMDObjRenderer(e,t,r);this.modelMatrixFromObjectAndScale(s.modelMatrix,a,.8,n)};0===a.DoorType||(1===a.DoorType?await r("/data/normal_obj/door/obj_door0.bmd"):2===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_star.bmd")):3===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_star1.bmd")):4===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_star3.bmd")):5===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_star10.bmd")):6===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_keyhole.bmd")):7===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_keyhole.bmd")):9===a.DoorType?(await r("/data/normal_obj/stargate/obj_stargate.bmd",0),await r("/data/normal_obj/stargate/obj_stargate.bmd",180)):10===a.DoorType?(await r("/data/normal_obj/stargate/obj_stargate.bmd",0),await r("/data/normal_obj/stargate/obj_stargate.bmd",180)):11===a.DoorType?(await r("/data/normal_obj/stargate/obj_stargate.bmd",0),await r("/data/normal_obj/stargate/obj_stargate.bmd",180)):12===a.DoorType?(await r("/data/normal_obj/stargate/obj_stargate.bmd",0),await r("/data/normal_obj/stargate/obj_stargate.bmd",180)):13===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_star1.bmd")):14===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_star3.bmd")):15===a.DoorType?await r("/data/normal_obj/door/obj_door2_boro.bmd"):16===a.DoorType?await r("/data/normal_obj/door/obj_door3_tetsu.bmd"):17===a.DoorType?await r("/data/normal_obj/door/obj_door4_yami.bmd"):18===a.DoorType?await r("/data/normal_obj/door/obj_door5_horror.bmd"):19===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_keyhole.bmd")):20===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_keyhole.bmd")):21===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_keyhole.bmd")):22===a.DoorType?(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_keyhole.bmd")):23===a.DoorType&&(await r("/data/normal_obj/door/obj_door0.bmd"),await r("/data/normal_obj/door/obj_door0_keyhole.bmd")))}async _createBMDRendererForObject(e,t,a){return"Standard"===a.Type||"Simple"===a.Type?this._createBMDRendererForStandardObject(e,t,a):"Door"===a.Type?this._createBMDRendererForDoorObject(e,t,a):void 0}async createScene(e,t){const a=await t.dataShare.ensureObject("sm64ds/DataHolder",async()=>{const e=t.dataFetcher,[a,...r]=await Promise.all([e.fetchData("sm64ds/sm64ds.crg1?cache_bust=0"),e.fetchData("sm64ds/ARCHIVE/ar1.narc"),e.fetchData("sm64ds/ARCHIVE/arc0.narc"),e.fetchData("sm64ds/ARCHIVE/vs1.narc"),e.fetchData("sm64ds/ARCHIVE/vs2.narc"),e.fetchData("sm64ds/ARCHIVE/vs3.narc"),e.fetchData("sm64ds/ARCHIVE/vs4.narc")]),n=new w(e),s=o.parse(a,1);for(let e=0;e<r.length;e++)n.mountNARC(i.parse(r[e]));return new k(s,n)}),r=a.crg1.Levels[this.levelId],n=new T(e,a.modelCache,r);if(t.destroyablePool.push(n),this._createBMDRenderer(e,n,r.MapBmdFile,1500,r,!1),r.Background){const t=`/data/vrbox/vr${p.leftPad(""+r.Background,2,"0")}.bmd`;this._createBMDRenderer(e,n,t,.8,r,!0)}const s=[];for(let t=0;t<r.Objects.length;t++)s.push(this._createBMDRendererForObject(e,n,r.Objects[t]));return await a.modelCache.waitForLoad(),await Promise.all(s),n}}t.SM64DSSceneDesc=D;const I=["Mushroom Castle",new D(1,"Outdoor Gardens"),new D(2,"Main Foyer"),new D(4,"Basement"),new D(5,"Upstairs"),new D(3,"Courtyard"),new D(50,"Rec Room"),"First Floor Courses",new D(6,"Bob-omb Battlefield"),new D(7,"Whomp's Fortress"),new D(8,"Jolly Roger Bay"),new D(9,"Jolly Roger Bay (Inside the Ship)"),new D(10,"Cool, Cool Mountain"),new D(11,"Cool, Cool Mountain (Inside the Slide)"),new D(12,"Big Boo's Haunt"),"Basement Courses",new D(13,"Hazy Maze Cave"),new D(14,"Lethal Lava Land"),new D(15,"Lethal Lava Land (Inside the Volcano)"),new D(16,"Shifting Sand Land"),new D(17,"Shifting Sand Land (Inside the Pyramid)"),new D(18,"Dire, Dire Docks"),"Second Floor Courses",new D(19,"Snowman's Land"),new D(20,"Snowman's Land (Inside the Igloo)"),new D(21,"Wet-Dry World"),new D(22,"Tall Tall Mountain"),new D(23,"Tall Tall Mountain (Inside the Slide)"),new D(25,"Tiny-Huge Island (Tiny)"),new D(24,"Tiny-Huge Island (Huge)"),new D(26,"Tiny-Huge Island (Inside Wiggler's Cavern)"),"Third Floor Courses",new D(27,"Tick Tock Clock"),new D(28,"Rainbow Ride"),"Bowser Levels",new D(35,"Bowser in the Dark World"),new D(36,"Bowser in the Dark World (Boss Arena)"),new D(37,"Bowser in the Fire Sea"),new D(38,"Bowser in the Fire Sea (Boss Arena)"),new D(39,"Bowser in the Sky"),new D(40,"Bowser in the Sky (Boss Arena)"),"Secret Levels",new D(29,"The Princess's Secret Slide"),new D(30,"The Secret Aquarium"),new D(34,"Wing Mario over the Rainbow"),new D(31,"Tower of the Wing Cap"),new D(32,"Vanish Cap Under the Moat"),new D(33,"Cavern of the Metal Cap"),"Extra DS Levels",new D(46,"Big Boo Battle"),new D(47,"Big Boo Battle (Boss Arena)"),new D(44,"Goomboss Battle"),new D(45,"Goomboss Battle (Boss Arena)"),new D(48,"Chief Chilly Challenge"),new D(49,"Chief Chilly Challenge (Boss Arena)"),"VS Maps",new D(42,"The Secret of Battle Fort"),new D(43,"Sunshine Isles"),new D(51,"Castle Gardens"),"Unused Test Maps",new D(0,"Test Map A"),new D(41,"Test Map B")];t.sceneGroup={id:"sm64ds",name:"Super Mario 64 DS",sceneDescs:I}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(47),n=a(0);function s(e){return"LZ77"===n.readString(e,0,5)}t.isLZ77=s,t.maybeDecompress=function(e){return s(e)?r.decompress(e.slice(4)):e}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=r(a(66)),i=r(a(44)),o=a(0),l=a(2);class c{}t.Material=c;class h{}function d(e,t,a){const r=e.modelOffsBase+64*a,i=t.createDataView(),c=new h,d=i.getUint32(r+0,!0);o.assert(a===d),c.name=o.readString(t,i.getUint32(r+4,!0),255);const u=i.getInt16(r+8,!0);c.parentJointIdx=u<0?a+u:-1;const m=i.getInt32(r+16,!0)/4096,p=i.getInt32(r+20,!0)/4096,f=i.getInt32(r+24,!0)/4096,A=i.getInt16(r+28,!0)/2048*Math.PI,g=i.getInt16(r+30,!0)/2048*Math.PI,_=i.getInt16(r+32,!0)/2048*Math.PI,S=i.getInt16(r+36,!0)/4096,b=i.getInt16(r+40,!0)/4096,v=i.getInt16(r+44,!0)/4096;c.modelMatrix=n.mat4.create(),l.computeModelMatrixSRT(c.modelMatrix,m,p,f,A,g,_,S,b,v);const w=i.getUint32(r+48,!0),x=i.getUint32(r+52,!0),T=i.getUint32(r+56,!0),y=i.getUint32(r+60,!0);c.billboard=!!(1&y),c.batches=[];for(let a=0;a<w;a++){const r=i.getUint8(x+a),n=e.materials[r],o={color:n.diffuse,alpha:n.alpha},l=i.getUint8(T+a),h=i.getUint32(e.polyOffsBase+8*l+4,!0),d=i.getUint32(h+0,!0),u=i.getUint32(h+4,!0),m=t.createTypedArray(Uint8Array,u,d),p=i.getUint32(h+8,!0),f=i.getUint32(h+12,!0),A=t.slice(f,f+p),g=s.readCmds(A,o,e.scaleFactor);c.batches.push({materialIdx:r,matrixTable:m,vertexData:g})}return c}function u(e,t,a){const r=t.createDataView(),l=e.materialOffsBase+48*a,h=new c;h.name=o.readString(t,r.getUint32(l+0,!0),255),h.texCoordMat=n.mat2d.create();const d=r.getUint32(l+4,!0);if(4294967295!==d){const a=r.getUint32(l+8,!0),s=new m(d,a);h.texture=function(e,t,a){if(e.textureCache.has(a.toString()))return e.textureCache.get(a.toString());const r=t.createDataView(),n=e.textureOffsBase+20*a.texIdx,s=new p;s.id=a.texIdx,s.name=o.readString(t,r.getUint32(n+0,!0),255);const l=r.getUint32(n+4,!0),c=(r.getUint32(n+8,!0),t.slice(l));s.params=r.getUint32(n+16,!0);const h=i.parseTexImageParam(s.params);s.format=h.format,s.width=h.width,s.height=h.height;const d=h.color0;let u=null;if(4294967295!==a.palIdx){const n=e.paletteOffsBase+16*a.palIdx;s.paletteName=o.readString(t,r.getUint32(n+0,!0),255);const i=r.getUint32(n+4,!0),l=r.getUint32(n+8,!0);u=t.slice(i,i+l)}let m=null;s.format===i.Format.Tex_CMPR_4x4&&(m=c.slice(s.width*s.height/4));const f={format:s.format,width:s.width,height:s.height,texData:c,palData:u,palIdxData:m,color0:d};return s.pixels=i.readTexture(f),s.isTranslucent=i.textureFormatIsTranslucent(s.format),e.textures.push(s),e.textureCache.set(a.toString(),s),s}(e,t,s),h.texParams=h.texture.params|r.getUint32(l+32,!0);const c=r.getInt32(l+12,!0)/4096,u=r.getInt32(l+16,!0)/4096,f=r.getInt32(l+24,!0)/4096,A=r.getInt32(l+28,!0)/4096,g=1/h.texture.width,_=1/h.texture.height;n.mat2d.set(h.texCoordMat,c*g,0,0,u*_,f*g,A*_)}else h.texture=null,h.texParams=0;const u=r.getUint32(l+36,!0),f=u>>6&3;var A;h.cullMode=function(e){switch(e){case 0:return 3;case 1:return 1;case 2:return 2;case 3:return 0;default:throw new Error("Unknown renderWhichFaces")}}(f),h.alpha=(A=u>>16&31)<<3|A>>>2,h.isTranslucent=h.alpha<255||!(!h.texture||!h.texture.isTranslucent);const g=u>>>11&1;h.depthWrite=!!g||!h.isTranslucent;const _=r.getUint32(l+40,!0);return h.diffuse=32768&_?s.bgr5(_):{r:255,g:255,b:255},h}t.Joint=h;class m{constructor(e,t){this.texIdx=e,this.palIdx=t}toString(){return`TextureKey ${this.texIdx} ${this.palIdx}`}}class p{}t.Texture=p;class f{}t.BMD=f,t.parse=function(e){const t=e.createDataView(),a=new f;a.scaleFactor=1<<t.getUint32(0,!0);const r=t.getUint32(4,!0);a.modelOffsBase=t.getUint32(8,!0),t.getUint32(12,!0),a.polyOffsBase=t.getUint32(16,!0),t.getUint32(20,!0),a.textureOffsBase=t.getUint32(24,!0),t.getUint32(28,!0),a.paletteOffsBase=t.getUint32(32,!0);const n=t.getUint32(36,!0);a.materialOffsBase=t.getUint32(40,!0);const s=t.getUint32(44,!0);a.matrixToJointTable=e.createTypedArray(Uint16Array,s,r,0),a.textureCache=new Map,a.textures=[],a.materials=[],a.joints=[];for(let t=0;t<n;t++)a.materials.push(u(a,e,t));for(let t=0;t<r;t++)a.joints.push(d(a,e,t));return a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(9),n=a(23),s=a(4),i=a(232),o=a(233),l=a(113);class c{constructor(e){this.meshDatas=[],this.meshRenderers=[],this.renderTarget=new r.BasicRenderTarget,this.renderHelper=new n.GfxRenderHelper(e),this.clearRenderPassDescriptor=r.makeClearRenderPassDescriptor(!0,s.OpaqueBlack)}adjustCameraController(e){e.setSceneMoveSpeedMult(16/60)}prepareToRender(e,t,a){this.renderHelper.pushTemplateRenderInst();for(let t=0;t<this.meshRenderers.length;t++)this.meshRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a);const r=this.renderHelper.renderInstManager;this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,this.clearRenderPassDescriptor);return r.drawOnPassRenderer(e,n),r.resetRenderInsts(),n}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.meshDatas.length;t++)this.meshDatas[t].destroy(e);for(let t=0;t<this.meshRenderers.length;t++)this.meshRenderers[t].destroy(e)}}class h{constructor(e,t){this.id=e,this.name=t}async createScene(e,t){const a=t.dataFetcher,r=await a.fetchData(`zelview/${this.id}.zelview0`),n=new c(e),s=i.readZELVIEW0(r),h=s.loadMainScene();function d(t){if(!t)return;const a=n.renderHelper.getCache(),r={sharedOutput:s.sharedOutput,rspState:new l.RSPState(h.rom,s.sharedOutput),rspOutput:t},i=new o.MeshData(e,a,r),c=new o.RootMeshRenderer(e,a,i);n.meshDatas.push(i),n.meshRenderers.push(c)}return function e(t){if(t.mesh){for(let e=0;e<t.mesh.opaque.length;e++)d(t.mesh.opaque[e]);for(let e=0;e<t.mesh.transparent.length;e++)d(t.mesh.transparent[e])}else for(let a=0;a<t.rooms.length;a++)console.log(`Loading ${t.filename} room ${a}...`),e(t.rooms[a])}(h),n}}const d=["Kokiri Forest",new h("spot04_scene","Kokiri Forest"),new h("ydan_scene","Inside the Deku Tree"),new h("ydan_boss_scene","Inside the Deku Tree (Boss)"),new h("spot10_scene","Lost Woods"),new h("spot05_scene","Sacred Forest Meadow"),new h("Bmori1_scene","Forest Temple"),new h("moribossroom_scene","Forest Temple (Boss)"),"Kakariko Village",new h("spot01_scene","Kakariko Village"),new h("kinsuta_scene","Skulltula House"),new h("mahouya_scene","Granny's Potion Shop"),new h("spot02_scene","Kakariko Graveyard"),new h("hakasitarelay_scene","Damp's Grave & Kakariko Windmill"),new h("hakaana_ouke_scene","Royal Family's Tomb"),new h("HAKAdan_scene","Shadow Temple"),new h("HAKAdan_bs_scene","Shadow Temple (Boss)"),new h("HAKAdanCH_scene","Bottom of the Well"),new h("hakaana_scene","Heart Piece Grave"),new h("hakaana2_scene","Fairy Fountain Grave"),new h("syatekijyou_scene","Shooting Gallery"),"Death Mountain",new h("spot16_scene","Death Mountain"),new h("spot17_scene","Death Mountain Crater"),new h("spot18_scene","Goron City"),new h("ddan_scene","Dodongo's Cavern"),new h("ddan_boss_scene","Dodongo's Cavern (Boss)"),new h("HIDAN_scene","Fire Temple"),new h("FIRE_bs_scene","Fire Temple (Boss)"),"Hyrule Field",new h("spot00_scene","Hyrule Field"),new h("spot20_scene","Lon Lon Ranch"),new h("spot03_scene","Zora's River"),new h("daiyousei_izumi_scene","Great Fairy Fountain"),new h("yousei_izumi_tate_scene","Small Fairy Fountain"),new h("yousei_izumi_yoko_scene","Magic Fairy Fountain"),new h("kakusiana_scene","Grottos"),new h("hiral_demo_scene","Cutscene Map"),"Hyrule Castle / Town",new h("spot15_scene","Hyrule Castle"),new h("hairal_niwa_scene","Castle Courtyard"),new h("hairal_niwa_n_scene","Castle Courtyard (Night)"),new h("nakaniwa_scene","Zelda's Courtyard"),new h("miharigoya_scene","Lots'o'Pots"),new h("bowling_scene","Bombchu Bowling Alley"),new h("takaraya_scene","Treasure Chest Game"),new h("tokinoma_scene","Temple of Time (Interior)"),new h("kenjyanoma_scene","Chamber of Sages"),"Lake Hylia",new h("spot06_scene","Lake Hylia"),new h("hylia_labo_scene","Hylia Lakeside Laboratory"),new h("turibori_scene","Fishing Pond"),new h("MIZUsin_scene","Water Temple"),new h("MIZUsin_bs_scene","Water Temple (Boss)"),"Zora's Domain",new h("spot07_scene","Zora's Domain"),new h("spot08_scene","Zora's Fountain"),new h("bdan_scene","Jabu-Jabu's Belly"),new h("bdan_boss_scene","Jabu-Jabu's Belly (Boss)"),new h("ice_doukutu_scene","Ice Cavern"),"Gerudo Desert",new h("spot09_scene","Gerudo Valley"),new h("spot12_scene","Gerudo's Fortress"),new h("men_scene","Gerudo Training Grounds"),new h("gerudoway_scene","Thieves' Hideout"),new h("spot13_scene","Haunted Wasteland"),new h("spot11_scene","Desert Colossus"),new h("jyasinzou_scene","Spirit Temple"),new h("jyasinboss_scene","Spirit Temple (Mid-Boss)"),"Ganon's Castle",new h("ganontika_scene","Ganon's Castle"),new h("ganontikasonogo_scene","Ganon's Castle (Crumbling)"),new h("ganon_tou_scene","Ganon's Castle (Outside)"),new h("ganon_scene","Ganon's Castle Tower"),new h("ganon_sonogo_scene","Ganon's Castle Tower (Crumbling)"),new h("ganon_boss_scene","Second-To-Last Boss Ganondorf"),new h("ganon_demo_scene","Final Battle Against Ganon"),new h("ganon_final_scene","Ganondorf's Death"),"Unused Scenes",new h("test01_scene","Collision Testing Area"),new h("besitu_scene","Besitu / Treasure Chest Warp"),new h("depth_test_scene","Depth Test"),new h("syotes_scene","Stalfos Middle Room"),new h("syotes2_scene","Stalfos Boss Room"),new h("sutaru_scene","Dark Link Testing Area"),new h("hairal_niwa2_scene","Beta Castle Courtyard"),new h("sasatest_scene","Action Testing Room"),new h("testroom_scene","Item Testing Room")];t.sceneGroup={id:"zelview",name:"The Legend of Zelda: Ocarina of Time",sceneDescs:d}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});a(1);const n=r(a(113)),s=a(113),i=a(0);class o{}class l{lookupFile(e){for(const t of this.entries)if(t.pStart===e)return t;throw Error(`File containing 0x${e.toString(16)} not found`)}loadScene(e){return function(e,t){const a={scene:t};return e.sharedOutput=new n.RSPSharedOutput,function e(t,a,r,n){const o=new h;function l(e){const a=e>>>24,n=16777215&e;const s=function(){switch(a){case 2:return r.scene;case 3:if(void 0===r.room)throw Error("room is undefined");return r.room;default:throw console.error(`bank for 0x${i.hexzero(e,8)} not found`),Error("bank not found")}}();if(null===s)throw Error("null bank");const o=s.vStart+n;if(o>s.vEnd)throw Error("absOffs out of range");return{buffer:t.buffer,offs:o}}function u(e){const t=l(e);return t.buffer.createDataView().getUint32(t.offs)}function m(a){const s={scene:r.scene,room:a};return e(t,a.vStart,s,n)}function p(e,a){const r=[];for(let n=0;n<e;n++){const e=u(a);console.log(`room ${n} pStart 0x${i.hexzero(e,8)}`);const s=t.lookupFile(e),o=m(s);o.filename=s.filename,r.push(o),a+=8}return r}function f(e){const t=u(e),a=t>>24,r=t>>16&255;let i=u(e+4);const o=new c;function h(e){const t=u(e);if(0===t)return null;const a=new s.RSPState({lookupAddress:l},n);return s.runDL_F3DZEX(a,{lookupAddress:l},t),a.finish(),a.finish()}if(0===a)for(let e=0;e<r;e++)o.opaque.push(h(i)),o.transparent.push(h(i+4)),i+=8;else if(1===a){const t=l(u(e+12*(r-1)+8));t.buffer.slice(t.offs)}else if(2===a)for(let e=0;e<r;e++)o.opaque.push(h(i+8)),o.transparent.push(h(i+12)),i+=16;return o.opaque=o.opaque.filter(e=>!!e),o.transparent=o.transparent.filter(e=>!!e),o.textures=[],o}o.filename=t.sceneFile.filename,o.rom={lookupAddress:l},o.rooms=[],o.mesh=null,console.log(`Starting parsing at 0x${a.toString(16)}`);for(;;){const e=t.view.getUint32(a,!1),r=t.view.getUint32(a+4,!1);a+=8;const n=e>>24;if(n===d.End)break;switch(n){case d.Collision:break;case d.Rooms:const t=e>>16&255;o.rooms=p(t,r);break;case d.Mesh:o.mesh=f(r)}}return o}(e,t.vStart,a,e.sharedOutput)}(this,e)}loadMainScene(){return this.loadScene(this.sceneFile)}}t.ZELVIEW0=l;class c{constructor(){this.opaque=[],this.transparent=[]}}t.Mesh=c;class h{constructor(){this.rooms=[]}}var d;t.Headers=h,t.readZELVIEW0=function(e){const t=e.createDataView();if("ZELVIEW0"!==i.readString(e,0,"ZELVIEW0".length,!1))throw new Error("Invalid ZELVIEW0 file");let a=8;const r=t.getUint8(a);a+=4;const n=t.getUint8(a);function s(){const r=new o;return r.filename=i.readString(e,a,48),a+=48,r.pStart=t.getUint32(a,!0),r.pEnd=t.getUint32(a+4,!0),r.vStart=t.getUint32(a+8,!0),r.vEnd=t.getUint32(a+12,!0),a+=16,r}a+=4;const c=[];for(let e=0;e<r;e++)c.push(s());const h=new l;return h.entries=c,h.sceneFile=c[n],h.view=t,h.buffer=e,h},function(e){e[e.Spawns=0]="Spawns",e[e.Actors=1]="Actors",e[e.Camera=2]="Camera",e[e.Collision=3]="Collision",e[e.Rooms=4]="Rooms",e[e.WindSettings=5]="WindSettings",e[e.EntranceList=6]="EntranceList",e[e.SpecialObjects=7]="SpecialObjects",e[e.SpecialBehavior=8]="SpecialBehavior",e[e.Mesh=10]="Mesh",e[e.Objects=11]="Objects",e[e.Waypoints=13]="Waypoints",e[e.Transitions=14]="Transitions",e[e.Environment=15]="Environment",e[e.Time=16]="Time",e[e.Skybox=17]="Skybox",e[e.End=20]="End"}(d||(d={}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(20),n=a(113),s=a(6),i=a(17),o=a(0),l=a(13),c=a(1),h=a(8),d=a(10),u=a(14);class m extends r.DeviceProgram{constructor(e,t,a){super(),this.DP_OtherModeH=e,this.DP_OtherModeL=t,this.DP_Combine=a,this.both="\nprecision mediump float;\n\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n#ifdef TEXTURE_GEN\n    vec4 u_LookAtVectors[2];\n#endif\n};\n\nlayout(row_major, std140) uniform ub_DrawParams {\n    Mat4x3 u_ModelView;\n    Mat4x2 u_TexMatrix[2];\n};\n\nuniform ub_CombineParameters {\n    vec4 u_PrimColor;\n    vec4 u_EnvColor;\n    float u_Lighting;\n};\n\nuniform sampler2D u_Texture[2];\n\nvarying vec4 v_Color;\nvarying vec4 v_TexCoord;\n\nconst vec4 t_Zero = vec4(0.0);\nconst vec4 t_One = vec4(1.0);\n",this.vert=`\nlayout(location = ${m.a_Position}) in vec4 a_Position;\nlayout(location = ${m.a_Color}) in vec4 a_Color;\nlayout(location = ${m.a_TexCoord}) in vec2 a_TexCoord;\n\nvec3 Monochrome(vec3 t_Color) {\n    // NTSC primaries.\n    return vec3(dot(t_Color.rgb, vec3(0.299, 0.587, 0.114)));\n}\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_ModelView), vec4(a_Position.xyz, 1.0)));\n    v_Color = t_One;\n\n#ifdef USE_VERTEX_COLOR\n    v_Color = a_Color;\n#endif\n\n#ifdef USE_MONOCHROME_VERTEX_COLOR\n    v_Color.rgb = Monochrome(v_Color.rgb);\n#endif\n\n    if (u_Lighting != 0.0) {\n        // convert (unsigned) colors to normal vector components\n        vec3 t_Normal = 2.0*a_Color.rgb - 2.0*trunc(2.0*a_Color.rgb);\n        t_Normal = normalize(t_Normal);\n        // TODO: If the model matrix is non-identity, the normal must be transformed by the normal matrix:\n        // normalMatrix = transpose(inverse(modelMatrix))\n        // We don't use a model matrix right now, so the normal matrix is omitted.\n\n        vec3 lightDirection = normalize(vec3(1, 1, 1));\n        float intensity = max(0.0, dot(t_Normal, lightDirection));\n        vec3 ambient = vec3(0.25, 0.25, 0.25);\n        vec3 lightColor = vec3(1.0, 1.0, 1.0);\n        v_Color.rgb = ambient + intensity * lightColor;\n    }\n\n    v_TexCoord.xy = Mul(u_TexMatrix[0], vec4(a_TexCoord, 1.0, 1.0));\n    v_TexCoord.zw = Mul(u_TexMatrix[1], vec4(a_TexCoord, 1.0, 1.0));\n\n#ifdef TEXTURE_GEN\n    // generate texture coordinates based on the vertex normal in screen space\n\n    // convert (unsigned) colors to normal vector components\n    vec4 t_Normal = vec4(2.0*a_Color.rgb - 2.0*trunc(2.0*a_Color.rgb), 0.0);\n    t_Normal = normalize(t_Normal);\n    t_Normal.xy = vec2(dot(t_Normal, u_LookAtVectors[0]), dot(t_Normal, u_LookAtVectors[1]));\n\n    // shift and rescale to tex coordinates - straight towards the camera is the center\n#   ifdef TEXTURE_GEN_LINEAR\n        v_TexCoord.xy = acos(t_Normal.xy)/radians(180.0);\n#   else\n        v_TexCoord.xy = (t_Normal.xy + vec2(1.0))/2.0;\n#   endif\n\n    v_TexCoord.zw = v_TexCoord.xy;\n#endif\n}\n`,1===n.getCycleTypeFromOtherModeH(e)&&this.defines.set("TWO_CYCLE","1"),this.frag=this.generateFrag()}generateAlphaTest(){const e=this.DP_OtherModeL>>>0&3,t=this.DP_OtherModeL>>>12&1;let a=0;return 1===e?a=.5:0!=e?a=.0125:0!=t&&(a=.125),a>0?`\n    if (t_Color.a < ${a})\n        discard;\n`:""}generateFrag(){const e=n.getTextFiltFromOtherModeH(this.DP_OtherModeH);let t;if(0===e)t="Point";else if(3===e)t="Average";else{if(2!==e)throw"whoops";t="Bilerp"}const a=["t_CombColor.rgb","t_Tex0.rgb","t_Tex1.rgb","u_PrimColor.rgb","v_Color.rgb","u_EnvColor.rgb","t_One.rgb","t_Zero.rgb"],r=["t_CombColor.rgb","t_Tex0.rgb","t_Tex1.rgb","u_PrimColor.rgb","v_Color.rgb","u_EnvColor.rgb","t_Zero.rgb","t_CombColor.aaa","t_Tex0.aaa","t_Tex1.aaa","u_PrimColor.aaa","v_Color.aaa","u_EnvColor.aaa","t_Zero.rgb","t_Zero.rgb","t_Zero.rgb"],s=["combAlpha","t_Tex0","t_Tex1","u_PrimColor.a","v_Color.a","u_EnvColor.a","1.0","0.0"];function i(e){return`((${a[e.a]} - ${a[e.b]}) * ${r[e.c]} + ${a[e.d]})`}function o(e){return`((${s[e.a]} - ${s[e.b]}) * ${s[e.c]} + ${s[e.d]})`}return`\nvec4 Texture2D_N64_Point(sampler2D t_Texture, vec2 t_TexCoord) {\n    return texture(t_Texture, t_TexCoord);\n}\n\nvec4 Texture2D_N64_Average(sampler2D t_Texture, vec2 t_TexCoord) {\n    // Unimplemented.\n    return texture(t_Texture, t_TexCoord);\n}\n\n// Implements N64-style "triangle bilienar filtering" with three taps.\n// Based on ArthurCarvalho's implementation, modified by NEC and Jasper for noclip.\nvec4 Texture2D_N64_Bilerp(sampler2D t_Texture, vec2 t_TexCoord) {\n    vec2 t_Size = vec2(textureSize(t_Texture, 0));\n    vec2 t_Offs = fract(t_TexCoord*t_Size - vec2(0.5));\n    t_Offs -= step(1.0, t_Offs.x + t_Offs.y);\n    vec4 t_S0 = texture(t_Texture, t_TexCoord - t_Offs / t_Size);\n    vec4 t_S1 = texture(t_Texture, t_TexCoord - vec2(t_Offs.x - sign(t_Offs.x), t_Offs.y) / t_Size);\n    vec4 t_S2 = texture(t_Texture, t_TexCoord - vec2(t_Offs.x, t_Offs.y - sign(t_Offs.y)) / t_Size);\n    return t_S0 + abs(t_Offs.x)*(t_S1-t_S0) + abs(t_Offs.y)*(t_S2-t_S0);\n}\n\n#define Texture2D_N64 Texture2D_N64_${t}\n\nvec3 CombineColorCycle0(vec4 t_CombColor, vec4 t_Tex0, vec4 t_Tex1) {\n    return ${i(this.DP_Combine.c0)};\n}\n\nfloat CombineAlphaCycle0(float combAlpha, float t_Tex0, float t_Tex1) {\n    return ${o(this.DP_Combine.a0)};\n}\n\nvec3 CombineColorCycle1(vec4 t_CombColor, vec4 t_Tex0, vec4 t_Tex1) {\n    return ${i(this.DP_Combine.c1)};\n}\n\nfloat CombineAlphaCycle1(float combAlpha, float t_Tex0, float t_Tex1) {\n    return ${o(this.DP_Combine.a1)};\n}\n\nvoid main() {\n    vec4 t_Color = t_One;\n    vec4 t_Tex0 = t_One, t_Tex1 = t_One;\n\n#ifdef USE_TEXTURE\n    t_Tex0 = Texture2D_N64(u_Texture[0], v_TexCoord.xy);\n    t_Tex1 = Texture2D_N64(u_Texture[1], v_TexCoord.zw);\n#endif\n\n    t_Color = vec4(\n        CombineColorCycle0(t_Zero, t_Tex0, t_Tex1),\n        CombineAlphaCycle0(t_Zero.a, t_Tex0.a, t_Tex1.a)\n    );\n\n#ifdef TWO_CYCLE\n    t_Color = vec4(\n        CombineColorCycle1(t_Color, t_Tex0, t_Tex1),\n        CombineAlphaCycle1(t_Color.a, t_Tex0.a, t_Tex1.a)\n    );\n#endif\n\n#ifdef ONLY_VERTEX_COLOR\n    t_Color.rgba = v_Color.rgba;\n#endif\n\n#ifdef USE_ALPHA_VISUALIZER\n    t_Color.rgb = vec3(v_Color.a);\n    t_Color.a = 1.0;\n#endif\n\n${this.generateAlphaTest()}\n\n    gl_FragColor = t_Color;\n}\n`}}function p(e){switch(e){case 0:return 1;case 1:return 2;case 2:return 0;default:return console.warn(`Unknown TexCM ${e}`),0}}function f(e,t){const a=e.createTexture(s.makeTextureDescriptor2D(s.GfxFormat.U8_RGBA_NORM,t.width,t.height,1));e.setResourceName(a,t.name);const r=e.createHostAccessPass();return r.uploadTextureData(a,0,[t.pixels]),e.submitPass(r),a}function A(e,t,a){return t.createSampler(e,{wrapS:p(a.tile.cmS),wrapT:p(a.tile.cmT),minFilter:0,magFilter:0,mipFilter:0,minLOD:0,maxLOD:0})}t.F3DZEX_Program=m,m.a_Position=0,m.a_Color=1,m.a_TexCoord=2,m.ub_SceneParams=0,m.ub_DrawParams=1,m.ub_CombineParams=2,t.textureToCanvas=function(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.title=e.name;const a=t.getContext("2d"),r=a.createImageData(t.width,t.height);r.data.set(e.pixels),a.putImageData(r,0,0);const s=[t],i=new Map;return i.set("Format",n.getImageFormatString(e.tile.fmt,e.tile.siz)),{name:e.name,surfaces:s,extraInfo:i}};class g{constructor(e,t,a,r=!1){this.sharedOutput=a,this.vertexBufferData=function(e){const t=new Float32Array(10*e.length);let a=0;for(let r=0;r<e.length;r++)t[a++]=e[r].x,t[a++]=e[r].y,t[a++]=e[r].z,t[a++]=1,t[a++]=e[r].tx,t[a++]=e[r].ty,t[a++]=e[r].c0,t[a++]=e[r].c1,t[a++]=e[r].c2,t[a++]=e[r].a;return t}(a.vertices),this.vertexBuffer=r?e.createBuffer(o.align(this.vertexBufferData.byteLength,4)/4,2,2):i.makeStaticDataBuffer(e,2,this.vertexBufferData.buffer),o.assert(a.vertices.length<=4294967295);const n=new Uint32Array(a.indices);this.indexBuffer=i.makeStaticDataBuffer(e,1,n.buffer);const l=[{location:m.a_Position,bufferIndex:0,format:s.GfxFormat.F32_RGBA,bufferByteOffset:0},{location:m.a_TexCoord,bufferIndex:0,format:s.GfxFormat.F32_RG,bufferByteOffset:16},{location:m.a_Color,bufferIndex:0,format:s.GfxFormat.F32_RGBA,bufferByteOffset:24}];this.inputLayout=e.createInputLayout({indexBufferFormat:s.GfxFormat.U32_R,vertexBufferDescriptors:[{byteStride:40,frequency:1}],vertexAttributeDescriptors:l}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}destroy(e){e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}function _(e){return e<=10?1/(1<<e):1<<16-e}t.RenderData=g;const S=c.mat4.create(),b=(c.mat4.create(),c.mat4.create());class v{constructor(e,t,a,r,s){this.drawMatrix=r,this.drawCall=s,this.textureEntry=[],this.vertexColorsEnabled=!0,this.texturesEnabled=!0,this.monochromeVertexColorsEnabled=!1,this.alphaVisualizerEnabled=!1,this.gfxProgram=null,this.textureMappings=o.nArray(2,()=>new d.TextureMapping),this.visible=!0;for(let a=0;a<this.textureMappings.length;a++){const r=s.textures[a];r&&(this.textureEntry[a]=r,this.textureMappings[a].gfxTexture=f(e,r),this.textureMappings[a].gfxSampler=A(e,t,r))}this.megaStateFlags=n.translateBlendMode(this.drawCall.SP_GeometryMode,this.drawCall.DP_OtherModeL),this.setBackfaceCullingEnabled(!0),this.createProgram()}createProgram(){const e=new m(this.drawCall.DP_OtherModeH,this.drawCall.DP_OtherModeL,this.drawCall.DP_Combine);this.texturesEnabled&&this.textureEntry.length&&e.defines.set("USE_TEXTURE","1");this.vertexColorsEnabled&&e.defines.set("USE_VERTEX_COLOR","1"),262144&this.drawCall.SP_GeometryMode&&e.defines.set("TEXTURE_GEN","1"),524288&this.drawCall.SP_GeometryMode&&e.defines.set("TEXTURE_GEN_LINEAR","1"),this.monochromeVertexColorsEnabled&&e.defines.set("USE_MONOCHROME_VERTEX_COLOR","1"),this.alphaVisualizerEnabled&&e.defines.set("USE_ALPHA_VISUALIZER","1"),this.program=e,this.gfxProgram=null}setBackfaceCullingEnabled(e){const t=e?function(e){const t=!!(512&e),a=!!(1024&e);return t&&a?3:t?1:a?2:0}(this.drawCall.SP_GeometryMode):0;this.megaStateFlags.cullMode=t}setVertexColorsEnabled(e){this.vertexColorsEnabled=e,this.createProgram()}setTexturesEnabled(e){this.texturesEnabled=e,this.createProgram()}setMonochromeVertexColorsEnabled(e){this.monochromeVertexColorsEnabled=e,this.createProgram()}setAlphaVisualizerEnabled(e){this.alphaVisualizerEnabled=e,this.createProgram()}computeTextureMatrix(e,t){if(void 0!==this.textureEntry[t]){const a=this.textureEntry[t],r=_(a.tile.shiftS),n=_(a.tile.shiftT);c.mat4.fromScaling(e,[r/a.width,n/a.height,1])}else c.mat4.identity(e)}prepareToRender(e,t,a,r){if(!this.visible)return;null===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program));const n=t.pushRenderInst();n.setGfxProgram(this.gfxProgram),n.setSamplerBindingsFromTextureMappings(this.textureMappings),n.setMegaStateFlags(this.megaStateFlags),n.drawIndexes(this.drawCall.indexCount,this.drawCall.firstIndex);let s=n.allocateUniformBuffer(m.ub_DrawParams,28);const i=n.mapUniformBufferF32(m.ub_DrawParams);r?h.computeViewMatrixSkybox(S,a.camera):h.computeViewMatrix(S,a.camera),s+=l.fillMatrix4x3(i,s,S),this.computeTextureMatrix(b,0),s+=l.fillMatrix4x2(i,s,b),this.computeTextureMatrix(b,1),s+=l.fillMatrix4x2(i,s,b),s=n.allocateUniformBuffer(m.ub_CombineParams,9);const o=n.mapUniformBufferF32(m.ub_CombineParams);s+=l.fillVec4v(o,s,this.drawCall.primColor),s+=l.fillVec4v(o,s,this.drawCall.envColor),o[s]=131072&this.drawCall.SP_GeometryMode?1:0,s++}destroy(e){for(let t=0;t<this.textureMappings.length;t++)null!==this.textureMappings[t].gfxTexture&&e.destroyTexture(this.textureMappings[t].gfxTexture)}}const w=[{numUniformBuffers:3,numSamplers:2}];t.MeshData=class{constructor(e,t,a){this.mesh=a,this.renderData=new g(e,t,a.sharedOutput,!1)}destroy(e){this.renderData.destroy(e)}};class x{constructor(){this.drawCallInstances=[]}prepareToRender(e,t,a,r){for(let n=0;n<this.drawCallInstances.length;n++)this.drawCallInstances[n].prepareToRender(e,t,a,r)}setBackfaceCullingEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setBackfaceCullingEnabled(e)}setVertexColorsEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setVertexColorsEnabled(e)}setTexturesEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setTexturesEnabled(e)}setMonochromeVertexColorsEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setMonochromeVertexColorsEnabled(e)}setAlphaVisualizerEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setAlphaVisualizerEnabled(e)}destroy(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].destroy(e)}}c.vec3.create(),c.vec3.fromValues(0,1,0),c.vec3.create();t.RootMeshRenderer=class{constructor(e,t,a){this.geometryData=a,this.visible=!0,this.isSkybox=!1,this.modelMatrix=c.mat4.create(),this.objectFlags=0,this.megaStateFlags={},u.setAttachmentStateSimple(this.megaStateFlags,{blendMode:s.GfxBlendMode.ADD,blendSrcFactor:s.GfxBlendFactor.SRC_ALPHA,blendDstFactor:s.GfxBlendFactor.ONE_MINUS_SRC_ALPHA});const r=this.geometryData.mesh;this.rootNodeRenderer=this.buildGeoNodeRenderer(e,t,r)}buildGeoNodeRenderer(e,t,a){const r=new x;if(null!==a.rspOutput)for(let n=0;n<a.rspOutput.drawCalls.length;n++){const s=[c.mat4.create()],i=new v(e,t,this.geometryData.renderData,s,a.rspOutput.drawCalls[n]);r.drawCallInstances.push(i)}return r}setBackfaceCullingEnabled(e){this.rootNodeRenderer.setBackfaceCullingEnabled(e)}setVertexColorsEnabled(e){this.rootNodeRenderer.setVertexColorsEnabled(e)}setTexturesEnabled(e){this.rootNodeRenderer.setTexturesEnabled(e)}setMonochromeVertexColorsEnabled(e){this.rootNodeRenderer.setMonochromeVertexColorsEnabled(e)}setAlphaVisualizerEnabled(e){this.rootNodeRenderer.setAlphaVisualizerEnabled(e)}prepareToRender(e,t,a){if(!this.visible)return;const r=this.geometryData.renderData,n=t.pushTemplateRenderInst();n.setBindingLayouts(w),n.setInputLayoutAndState(r.inputLayout,r.inputState),n.setMegaStateFlags(this.megaStateFlags),n.filterKey=this.isSkybox?2:1,n.sortKey=this.sortKeyBase;let s=n.allocateUniformBuffer(m.ub_SceneParams,16);const i=n.mapUniformBufferF32(m.ub_SceneParams);s+=l.fillMatrix4x4(i,s,a.camera.projectionMatrix),this.rootNodeRenderer.prepareToRender(e,t,a,this.isSkybox),t.popTemplateRenderInst()}destroy(e){this.rootNodeRenderer.destroy(e)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(62)),i=r(a(67)),o=r(a(80)),l=r(a(95)),c=a(68),h=a(0),d=a(167),u=a(4),m=a(1),p=(n(a(18)),a(96));var f;!function(e){e[e.Player=0]="Player",e[e.En_Test=1]="En_Test",e[e.En_GirlA=2]="En_GirlA",e[e.En_Part=3]="En_Part",e[e.En_Light=4]="En_Light",e[e.En_Door=5]="En_Door",e[e.En_Box=6]="En_Box",e[e.En_Pametfrog=7]="En_Pametfrog",e[e.En_Okuta=8]="En_Okuta",e[e.En_Bom=9]="En_Bom",e[e.En_Wallmas=10]="En_Wallmas",e[e.En_Dodongo=11]="En_Dodongo",e[e.En_Firefly=12]="En_Firefly",e[e.En_Horse=13]="En_Horse",e[e.En_Item00=14]="En_Item00",e[e.En_Arrow=15]="En_Arrow",e[e.En_Elf=16]="En_Elf",e[e.En_Niw=17]="En_Niw",e[e.En_Tite=18]="En_Tite",e[e.En_Peehat=19]="En_Peehat",e[e.En_Butte=20]="En_Butte",e[e.En_Insect=21]="En_Insect",e[e.En_Fish=22]="En_Fish",e[e.En_Holl=23]="En_Holl",e[e.En_Dinofos=24]="En_Dinofos",e[e.En_Hata=25]="En_Hata",e[e.En_Zl1=26]="En_Zl1",e[e.En_Viewer=27]="En_Viewer",e[e.En_Bubble=28]="En_Bubble",e[e.Door_Shutter=29]="Door_Shutter",e[e.En_Boom=30]="En_Boom",e[e.En_Torch2=31]="En_Torch2",e[e.En_Minifrog=32]="En_Minifrog",e[e.En_St=33]="En_St",e[e.En_A_Obj=34]="En_A_Obj",e[e.Obj_Wturn=35]="Obj_Wturn",e[e.En_River_Sound=36]="En_River_Sound",e[e.En_Ossan=37]="En_Ossan",e[e.En_Famos=38]="En_Famos",e[e.En_Bombf=39]="En_Bombf",e[e.En_Am=40]="En_Am",e[e.En_Dekubaba=41]="En_Dekubaba",e[e.En_M_Fire1=42]="En_M_Fire1",e[e.En_M_Thunder=43]="En_M_Thunder",e[e.Bg_Breakwall=44]="Bg_Breakwall",e[e.Door_Warp1=45]="Door_Warp1",e[e.Obj_Syokudai=46]="Obj_Syokudai",e[e.Item_B_Heart=47]="Item_B_Heart",e[e.En_Dekunuts=48]="En_Dekunuts",e[e.En_Bbfall=49]="En_Bbfall",e[e.Arms_Hook=50]="Arms_Hook",e[e.En_Bb=51]="En_Bb",e[e.Bg_Keikoku_Spr=52]="Bg_Keikoku_Spr",e[e.En_Wood02=53]="En_Wood02",e[e.En_Death=54]="En_Death",e[e.En_Minideath=55]="En_Minideath",e[e.En_Vm=56]="En_Vm",e[e.Demo_Effect=57]="Demo_Effect",e[e.Demo_Kankyo=58]="Demo_Kankyo",e[e.En_Floormas=59]="En_Floormas",e[e.En_Rd=60]="En_Rd",e[e.Bg_F40_Flift=61]="Bg_F40_Flift",e[e.Obj_Mure=63]="Obj_Mure",e[e.En_Sw=64]="En_Sw",e[e.Object_Kankyo=65]="Object_Kankyo",e[e.En_Horse_Link_Child=66]="En_Horse_Link_Child",e[e.Door_Ana=67]="Door_Ana",e[e.En_Encount1=68]="En_Encount1",e[e.Demo_Tre_Lgt=69]="Demo_Tre_Lgt",e[e.En_Encount2=70]="En_Encount2",e[e.En_Fire_Rock=71]="En_Fire_Rock",e[e.Bg_Ctower_Rot=72]="Bg_Ctower_Rot",e[e.Mir_Ray=73]="Mir_Ray",e[e.En_Sb=74]="En_Sb",e[e.En_Bigslime=75]="En_Bigslime",e[e.En_Karebaba=76]="En_Karebaba",e[e.En_In=77]="En_In",e[e.En_Ru=78]="En_Ru",e[e.En_Bom_Chu=79]="En_Bom_Chu",e[e.En_Horse_Game_Check=80]="En_Horse_Game_Check",e[e.En_Rr=81]="En_Rr",e[e.En_Fr=82]="En_Fr",e[e.Obj_Oshihiki=84]="Obj_Oshihiki",e[e.Eff_Dust=85]="Eff_Dust",e[e.Bg_Umajump=86]="Bg_Umajump",e[e.Arrow_Fire=87]="Arrow_Fire",e[e.Arrow_Ice=88]="Arrow_Ice",e[e.Arrow_Light=89]="Arrow_Light",e[e.Item_Etcetera=90]="Item_Etcetera",e[e.Obj_Kibako=91]="Obj_Kibako",e[e.Obj_Tsubo=92]="Obj_Tsubo",e[e.En_Ik=93]="En_Ik",e[e.Demo_Shd=94]="Demo_Shd",e[e.En_Dns=95]="En_Dns",e[e.Elf_Msg=96]="Elf_Msg",e[e.En_Honotrap=97]="En_Honotrap",e[e.En_Tubo_Trap=98]="En_Tubo_Trap",e[e.Obj_Ice_Poly=99]="Obj_Ice_Poly",e[e.En_Fz=100]="En_Fz",e[e.En_Kusa=101]="En_Kusa",e[e.Obj_Bean=102]="Obj_Bean",e[e.Obj_Bombiwa=103]="Obj_Bombiwa",e[e.Obj_Switch=104]="Obj_Switch",e[e.Obj_Lift=105]="Obj_Lift",e[e.Obj_Hsblock=106]="Obj_Hsblock",e[e.En_Okarina_Tag=107]="En_Okarina_Tag",e[e.En_Goroiwa=108]="En_Goroiwa",e[e.En_Daiku=109]="En_Daiku",e[e.En_Nwc=110]="En_Nwc",e[e.Item_Inbox=111]="Item_Inbox",e[e.En_Ge1=112]="En_Ge1",e[e.Obj_Blockstop=113]="Obj_Blockstop",e[e.En_Sda=114]="En_Sda",e[e.En_Clear_Tag=115]="En_Clear_Tag",e[e.En_Gm=116]="En_Gm",e[e.En_Ms=117]="En_Ms",e[e.En_Hs=118]="En_Hs",e[e.Bg_Ingate=119]="Bg_Ingate",e[e.En_Kanban=120]="En_Kanban",e[e.En_Attack_Niw=121]="En_Attack_Niw",e[e.En_Mk=122]="En_Mk",e[e.En_Owl=123]="En_Owl",e[e.En_Ishi=124]="En_Ishi",e[e.Obj_Hana=125]="Obj_Hana",e[e.Obj_Lightswitch=126]="Obj_Lightswitch",e[e.Obj_Mure2=127]="Obj_Mure2",e[e.En_Fu=128]="En_Fu",e[e.En_Stream=129]="En_Stream",e[e.En_Mm=130]="En_Mm",e[e.En_Weather_Tag=131]="En_Weather_Tag",e[e.En_Ani=132]="En_Ani",e[e.En_Js=133]="En_Js",e[e.En_Okarina_Effect=134]="En_Okarina_Effect",e[e.En_Mag=135]="En_Mag",e[e.Elf_Msg2=136]="Elf_Msg2",e[e.Bg_F40_Swlift=137]="Bg_F40_Swlift",e[e.En_Kakasi=138]="En_Kakasi",e[e.Obj_Makeoshihiki=139]="Obj_Makeoshihiki",e[e.Oceff_Spot=140]="Oceff_Spot",e[e.En_Torch=141]="En_Torch",e[e.Shot_Sun=142]="Shot_Sun",e[e.Obj_Roomtimer=143]="Obj_Roomtimer",e[e.En_Ssh=144]="En_Ssh",e[e.Oceff_Wipe=145]="Oceff_Wipe",e[e.Oceff_Storm=146]="Oceff_Storm",e[e.Obj_Demo=147]="Obj_Demo",e[e.En_Minislime=148]="En_Minislime",e[e.En_Nutsball=149]="En_Nutsball",e[e.Oceff_Wipe2=150]="Oceff_Wipe2",e[e.Oceff_Wipe3=151]="Oceff_Wipe3",e[e.En_Dg=152]="En_Dg",e[e.En_Si=153]="En_Si",e[e.Obj_Comb=154]="Obj_Comb",e[e.Obj_Kibako2=155]="Obj_Kibako2",e[e.En_Hs2=156]="En_Hs2",e[e.Obj_Mure3=157]="Obj_Mure3",e[e.En_Tg=158]="En_Tg",e[e.En_Wf=159]="En_Wf",e[e.En_Skb=160]="En_Skb",e[e.En_Gs=161]="En_Gs",e[e.Obj_Sound=162]="Obj_Sound",e[e.En_Crow=163]="En_Crow",e[e.En_Cow=164]="En_Cow",e[e.Oceff_Wipe4=165]="Oceff_Wipe4",e[e.En_Zo=166]="En_Zo",e[e.Obj_Makekinsuta=167]="Obj_Makekinsuta",e[e.En_Ge3=168]="En_Ge3",e[e.Obj_Hamishi=169]="Obj_Hamishi",e[e.En_Zl4=170]="En_Zl4",e[e.En_Mm2=171]="En_Mm2",e[e.Door_Spiral=172]="Door_Spiral",e[e.Obj_Pzlblock=173]="Obj_Pzlblock",e[e.Obj_Toge=174]="Obj_Toge",e[e.Obj_Armos=175]="Obj_Armos",e[e.Obj_Boyo=176]="Obj_Boyo",e[e.En_Grasshopper=177]="En_Grasshopper",e[e.Obj_Grass=178]="Obj_Grass",e[e.Obj_Grass_Carry=179]="Obj_Grass_Carry",e[e.Obj_Grass_Unit=180]="Obj_Grass_Unit",e[e.Bg_Fire_Wall=181]="Bg_Fire_Wall",e[e.En_Bu=182]="En_Bu",e[e.En_Encount3=183]="En_Encount3",e[e.En_Jso=184]="En_Jso",e[e.Obj_Chikuwa=185]="Obj_Chikuwa",e[e.En_Knight=186]="En_Knight",e[e.En_Warp_tag=187]="En_Warp_tag",e[e.En_Aob_01=188]="En_Aob_01",e[e.En_Boj_01=189]="En_Boj_01",e[e.En_Boj_02=190]="En_Boj_02",e[e.En_Boj_03=191]="En_Boj_03",e[e.En_Encount4=192]="En_Encount4",e[e.En_Bom_Bowl_Man=193]="En_Bom_Bowl_Man",e[e.En_Syateki_Man=194]="En_Syateki_Man",e[e.Bg_Icicle=195]="Bg_Icicle",e[e.En_Syateki_Crow=196]="En_Syateki_Crow",e[e.En_Boj_04=197]="En_Boj_04",e[e.En_Cne_01=198]="En_Cne_01",e[e.En_Bba_01=199]="En_Bba_01",e[e.En_Bji_01=200]="En_Bji_01",e[e.Bg_Spdweb=201]="Bg_Spdweb",e[e.En_Mt_tag=202]="En_Mt_tag",e[e.Boss_01=203]="Boss_01",e[e.Boss_02=204]="Boss_02",e[e.Boss_03=205]="Boss_03",e[e.Boss_04=206]="Boss_04",e[e.Boss_05=207]="Boss_05",e[e.Boss_06=208]="Boss_06",e[e.Boss_07=209]="Boss_07",e[e.Bg_Dy_Yoseizo=210]="Bg_Dy_Yoseizo",e[e.En_Boj_05=211]="En_Boj_05",e[e.En_Sob1=212]="En_Sob1",e[e.En_Go=213]="En_Go",e[e.En_Raf=214]="En_Raf",e[e.Obj_Funen=215]="Obj_Funen",e[e.Obj_Raillift=216]="Obj_Raillift",e[e.Bg_Numa_Hana=217]="Bg_Numa_Hana",e[e.Obj_Flowerpot=218]="Obj_Flowerpot",e[e.Obj_Spinyroll=219]="Obj_Spinyroll",e[e.Dm_Hina=220]="Dm_Hina",e[e.En_Syateki_Wf=221]="En_Syateki_Wf",e[e.Obj_Skateblock=222]="Obj_Skateblock",e[e.Obj_Iceblock=223]="Obj_Iceblock",e[e.En_Bigpamet=224]="En_Bigpamet",e[e.En_Syateki_Dekunuts=225]="En_Syateki_Dekunuts",e[e.Elf_Msg3=226]="Elf_Msg3",e[e.En_Fg=227]="En_Fg",e[e.Dm_Ravine=228]="Dm_Ravine",e[e.Dm_Sa=229]="Dm_Sa",e[e.En_Slime=230]="En_Slime",e[e.En_Pr=231]="En_Pr",e[e.Obj_Toudai=232]="Obj_Toudai",e[e.Obj_Entotu=233]="Obj_Entotu",e[e.Obj_Bell=234]="Obj_Bell",e[e.En_Syateki_Okuta=235]="En_Syateki_Okuta",e[e.Obj_Shutter=236]="Obj_Shutter",e[e.Dm_Zl=237]="Dm_Zl",e[e.En_Elfgrp=238]="En_Elfgrp",e[e.Dm_Tsg=239]="Dm_Tsg",e[e.En_Baguo=240]="En_Baguo",e[e.Obj_Vspinyroll=241]="Obj_Vspinyroll",e[e.Obj_Smork=242]="Obj_Smork",e[e.En_Test2=243]="En_Test2",e[e.En_Test3=244]="En_Test3",e[e.En_Test4=245]="En_Test4",e[e.En_Bat=246]="En_Bat",e[e.En_Sekihi=247]="En_Sekihi",e[e.En_Wiz=248]="En_Wiz",e[e.En_Wiz_Brock=249]="En_Wiz_Brock",e[e.En_Wiz_Fire=250]="En_Wiz_Fire",e[e.Eff_Change=251]="Eff_Change",e[e.Dm_Statue=252]="Dm_Statue",e[e.Obj_Fireshield=253]="Obj_Fireshield",e[e.Bg_Ladder=254]="Bg_Ladder",e[e.En_Mkk=255]="En_Mkk",e[e.Demo_Getitem=256]="Demo_Getitem",e[e.En_Dnb=257]="En_Dnb",e[e.En_Dnh=258]="En_Dnh",e[e.En_Dnk=259]="En_Dnk",e[e.En_Dnq=260]="En_Dnq",e[e.Bg_Keikoku_Saku=261]="Bg_Keikoku_Saku",e[e.Obj_Hugebombiwa=262]="Obj_Hugebombiwa",e[e.En_Firefly2=263]="En_Firefly2",e[e.En_Rat=264]="En_Rat",e[e.En_Water_Effect=265]="En_Water_Effect",e[e.En_Kusa2=266]="En_Kusa2",e[e.Bg_Spout_Fire=267]="Bg_Spout_Fire",e[e.Bg_Dblue_Movebg=268]="Bg_Dblue_Movebg",e[e.En_Dy_Extra=269]="En_Dy_Extra",e[e.En_Bal=270]="En_Bal",e[e.En_Ginko_Man=271]="En_Ginko_Man",e[e.En_Warp_Uzu=272]="En_Warp_Uzu",e[e.Obj_Driftice=273]="Obj_Driftice",e[e.En_Look_Nuts=274]="En_Look_Nuts",e[e.En_Mushi2=275]="En_Mushi2",e[e.En_Fall=276]="En_Fall",e[e.En_Mm3=277]="En_Mm3",e[e.Bg_Crace_Movebg=278]="Bg_Crace_Movebg",e[e.En_Dno=279]="En_Dno",e[e.En_Pr2=280]="En_Pr2",e[e.En_Prz=281]="En_Prz",e[e.En_Jso2=282]="En_Jso2",e[e.Obj_Etcetera=283]="Obj_Etcetera",e[e.En_Egol=284]="En_Egol",e[e.Obj_Mine=285]="Obj_Mine",e[e.Obj_Purify=286]="Obj_Purify",e[e.En_Tru=287]="En_Tru",e[e.En_Trt=288]="En_Trt",e[e.En_Test5=289]="En_Test5",e[e.En_Test6=290]="En_Test6",e[e.En_Az=291]="En_Az",e[e.En_Estone=292]="En_Estone",e[e.Bg_Hakugin_Post=293]="Bg_Hakugin_Post",e[e.Dm_Opstage=294]="Dm_Opstage",e[e.Dm_Stk=295]="Dm_Stk",e[e.Dm_Char00=296]="Dm_Char00",e[e.Dm_Char01=297]="Dm_Char01",e[e.Dm_Char02=298]="Dm_Char02",e[e.Dm_Char03=299]="Dm_Char03",e[e.Dm_Char04=300]="Dm_Char04",e[e.Dm_Char05=301]="Dm_Char05",e[e.Dm_Char06=302]="Dm_Char06",e[e.Dm_Char07=303]="Dm_Char07",e[e.Dm_Char08=304]="Dm_Char08",e[e.Dm_Char09=305]="Dm_Char09",e[e.Obj_Tokeidai=306]="Obj_Tokeidai",e[e.En_Mnk=307]="En_Mnk",e[e.En_Egblock=308]="En_Egblock",e[e.En_Guard_Nuts=309]="En_Guard_Nuts",e[e.Bg_Hakugin_Bombwall=310]="Bg_Hakugin_Bombwall",e[e.Obj_Tokei_Tobira=311]="Obj_Tokei_Tobira",e[e.Bg_Hakugin_Elvpole=312]="Bg_Hakugin_Elvpole",e[e.En_Ma4=313]="En_Ma4",e[e.En_Twig=314]="En_Twig",e[e.En_Po_Fusen=315]="En_Po_Fusen",e[e.En_Door_Etc=316]="En_Door_Etc",e[e.En_Bigokuta=317]="En_Bigokuta",e[e.Bg_Icefloe=318]="Bg_Icefloe",e[e.Obj_Ocarinalift=319]="Obj_Ocarinalift",e[e.En_Time_Tag=320]="En_Time_Tag",e[e.Bg_Open_Shutter=321]="Bg_Open_Shutter",e[e.Bg_Open_Spot=322]="Bg_Open_Spot",e[e.Bg_Fu_Kaiten=323]="Bg_Fu_Kaiten",e[e.Obj_Aqua=324]="Obj_Aqua",e[e.En_Elforg=325]="En_Elforg",e[e.En_Elfbub=326]="En_Elfbub",e[e.En_Fu_Mato=327]="En_Fu_Mato",e[e.En_Fu_Kago=328]="En_Fu_Kago",e[e.En_Osn=329]="En_Osn",e[e.Bg_Ctower_Gear=330]="Bg_Ctower_Gear",e[e.En_Trt2=331]="En_Trt2",e[e.Obj_Tokei_Step=332]="Obj_Tokei_Step",e[e.Bg_Lotus=333]="Bg_Lotus",e[e.En_Kame=334]="En_Kame",e[e.Obj_Takaraya_Wall=335]="Obj_Takaraya_Wall",e[e.Bg_Fu_Mizu=336]="Bg_Fu_Mizu",e[e.En_Sellnuts=337]="En_Sellnuts",e[e.Bg_Dkjail_Ivy=338]="Bg_Dkjail_Ivy",e[e.Obj_Visiblock=339]="Obj_Visiblock",e[e.En_Takaraya=340]="En_Takaraya",e[e.En_Tsn=341]="En_Tsn",e[e.En_Ds2n=342]="En_Ds2n",e[e.En_Fsn=343]="En_Fsn",e[e.En_Shn=344]="En_Shn",e[e.En_Stop_heishi=345]="En_Stop_heishi",e[e.Obj_Bigicicle=346]="Obj_Bigicicle",e[e.En_Lift_Nuts=347]="En_Lift_Nuts",e[e.En_Tk=348]="En_Tk",e[e.Bg_Market_Step=349]="Bg_Market_Step",e[e.Obj_Lupygamelift=350]="Obj_Lupygamelift",e[e.En_Test7=351]="En_Test7",e[e.Obj_Lightblock=352]="Obj_Lightblock",e[e.Mir_Ray2=353]="Mir_Ray2",e[e.En_Wdhand=354]="En_Wdhand",e[e.En_Gamelupy=355]="En_Gamelupy",e[e.Bg_Danpei_Movebg=356]="Bg_Danpei_Movebg",e[e.En_Snowwd=357]="En_Snowwd",e[e.En_Pm=358]="En_Pm",e[e.En_Gakufu=359]="En_Gakufu",e[e.Elf_Msg4=360]="Elf_Msg4",e[e.Elf_Msg5=361]="Elf_Msg5",e[e.En_Col_Man=362]="En_Col_Man",e[e.En_Talk_Gibud=363]="En_Talk_Gibud",e[e.En_Giant=364]="En_Giant",e[e.Obj_Snowball=365]="Obj_Snowball",e[e.Boss_Hakugin=366]="Boss_Hakugin",e[e.En_Gb2=367]="En_Gb2",e[e.En_Onpuman=368]="En_Onpuman",e[e.Bg_Tobira01=369]="Bg_Tobira01",e[e.En_Tag_Obj=370]="En_Tag_Obj",e[e.Obj_Dhouse=371]="Obj_Dhouse",e[e.Obj_Hakaisi=372]="Obj_Hakaisi",e[e.Bg_Hakugin_Switch=373]="Bg_Hakugin_Switch",e[e.En_Snowman=374]="En_Snowman",e[e.TG_Sw=375]="TG_Sw",e[e.En_Po_Sisters=376]="En_Po_Sisters",e[e.En_Pp=377]="En_Pp",e[e.En_Hakurock=378]="En_Hakurock",e[e.En_Hanabi=379]="En_Hanabi",e[e.Obj_Dowsing=380]="Obj_Dowsing",e[e.Obj_Wind=381]="Obj_Wind",e[e.En_Racedog=382]="En_Racedog",e[e.En_Kendo_Js=383]="En_Kendo_Js",e[e.Bg_Botihasira=384]="Bg_Botihasira",e[e.En_Fish2=385]="En_Fish2",e[e.En_Pst=386]="En_Pst",e[e.En_Poh=387]="En_Poh",e[e.Obj_Spidertent=388]="Obj_Spidertent",e[e.En_Zoraegg=389]="En_Zoraegg",e[e.En_Kbt=390]="En_Kbt",e[e.En_Gg=391]="En_Gg",e[e.En_Maruta=392]="En_Maruta",e[e.Obj_Snowball2=393]="Obj_Snowball2",e[e.En_Gg2=394]="En_Gg2",e[e.Obj_Ghaka=395]="Obj_Ghaka",e[e.En_Dnp=396]="En_Dnp",e[e.En_Dai=397]="En_Dai",e[e.Bg_Goron_Oyu=398]="Bg_Goron_Oyu",e[e.En_Kgy=399]="En_Kgy",e[e.En_Invadepoh=400]="En_Invadepoh",e[e.En_Gk=401]="En_Gk",e[e.En_An=402]="En_An",e[e.En_Bee=403]="En_Bee",e[e.En_Ot=404]="En_Ot",e[e.En_Dragon=405]="En_Dragon",e[e.Obj_Dora=406]="Obj_Dora",e[e.En_Bigpo=407]="En_Bigpo",e[e.Obj_Kendo_Kanban=408]="Obj_Kendo_Kanban",e[e.Obj_Hariko=409]="Obj_Hariko",e[e.En_Sth=410]="En_Sth",e[e.Bg_Sinkai_Kabe=411]="Bg_Sinkai_Kabe",e[e.Bg_Haka_Curtain=412]="Bg_Haka_Curtain",e[e.Bg_Kin2_Bombwall=413]="Bg_Kin2_Bombwall",e[e.Bg_Kin2_Fence=414]="Bg_Kin2_Fence",e[e.Bg_Kin2_Picture=415]="Bg_Kin2_Picture",e[e.Bg_Kin2_Shelf=416]="Bg_Kin2_Shelf",e[e.En_Rail_Skb=417]="En_Rail_Skb",e[e.En_Jg=418]="En_Jg",e[e.En_Tru_Mt=419]="En_Tru_Mt",e[e.Obj_Um=420]="Obj_Um",e[e.En_Neo_Reeba=421]="En_Neo_Reeba",e[e.Bg_Mbar_Chair=422]="Bg_Mbar_Chair",e[e.Bg_Ikana_Block=423]="Bg_Ikana_Block",e[e.Bg_Ikana_Mirror=424]="Bg_Ikana_Mirror",e[e.Bg_Ikana_Rotaryroom=425]="Bg_Ikana_Rotaryroom",e[e.Bg_Dblue_Balance=426]="Bg_Dblue_Balance",e[e.Bg_Dblue_Waterfall=427]="Bg_Dblue_Waterfall",e[e.En_Kaizoku=428]="En_Kaizoku",e[e.En_Ge2=429]="En_Ge2",e[e.En_Ma_Yts=430]="En_Ma_Yts",e[e.En_Ma_Yto=431]="En_Ma_Yto",e[e.Obj_Tokei_Turret=432]="Obj_Tokei_Turret",e[e.Bg_Dblue_Elevator=433]="Bg_Dblue_Elevator",e[e.Obj_Warpstone=434]="Obj_Warpstone",e[e.En_Zog=435]="En_Zog",e[e.Obj_Rotlift=436]="Obj_Rotlift",e[e.Obj_Jg_Gakki=437]="Obj_Jg_Gakki",e[e.Bg_Inibs_Movebg=438]="Bg_Inibs_Movebg",e[e.En_Zot=439]="En_Zot",e[e.Obj_Tree=440]="Obj_Tree",e[e.Obj_Y2lift=441]="Obj_Y2lift",e[e.Obj_Y2shutter=442]="Obj_Y2shutter",e[e.Obj_Boat=443]="Obj_Boat",e[e.Obj_Taru=444]="Obj_Taru",e[e.Obj_Hunsui=445]="Obj_Hunsui",e[e.En_Jc_Mato=446]="En_Jc_Mato",e[e.Mir_Ray3=447]="Mir_Ray3",e[e.En_Zob=448]="En_Zob",e[e.Elf_Msg6=449]="Elf_Msg6",e[e.Obj_Nozoki=450]="Obj_Nozoki",e[e.En_Toto=451]="En_Toto",e[e.En_Railgibud=452]="En_Railgibud",e[e.En_Baba=453]="En_Baba",e[e.En_Suttari=454]="En_Suttari",e[e.En_Zod=455]="En_Zod",e[e.En_Kujiya=456]="En_Kujiya",e[e.En_Geg=457]="En_Geg",e[e.Obj_Kinoko=458]="Obj_Kinoko",e[e.Obj_Yasi=459]="Obj_Yasi",e[e.En_Tanron1=460]="En_Tanron1",e[e.En_Tanron2=461]="En_Tanron2",e[e.En_Tanron3=462]="En_Tanron3",e[e.Obj_Chan=463]="Obj_Chan",e[e.En_Zos=464]="En_Zos",e[e.En_S_Goro=465]="En_S_Goro",e[e.En_Nb=466]="En_Nb",e[e.En_Ja=467]="En_Ja",e[e.Bg_F40_Block=468]="Bg_F40_Block",e[e.Bg_F40_Switch=469]="Bg_F40_Switch",e[e.En_Po_Composer=470]="En_Po_Composer",e[e.En_Guruguru=471]="En_Guruguru",e[e.Oceff_Wipe5=472]="Oceff_Wipe5",e[e.En_Stone_heishi=473]="En_Stone_heishi",e[e.Oceff_Wipe6=474]="Oceff_Wipe6",e[e.En_Scopenuts=475]="En_Scopenuts",e[e.En_Scopecrow=476]="En_Scopecrow",e[e.Oceff_Wipe7=477]="Oceff_Wipe7",e[e.Eff_Kamejima_Wave=478]="Eff_Kamejima_Wave",e[e.En_Hg=479]="En_Hg",e[e.En_Hgo=480]="En_Hgo",e[e.En_Zov=481]="En_Zov",e[e.En_Ah=482]="En_Ah",e[e.Obj_Hgdoor=483]="Obj_Hgdoor",e[e.Bg_Ikana_Bombwall=484]="Bg_Ikana_Bombwall",e[e.Bg_Ikana_Ray=485]="Bg_Ikana_Ray",e[e.Bg_Ikana_Shutter=486]="Bg_Ikana_Shutter",e[e.Bg_Haka_Bombwall=487]="Bg_Haka_Bombwall",e[e.Bg_Haka_Tomb=488]="Bg_Haka_Tomb",e[e.En_Sc_Ruppe=489]="En_Sc_Ruppe",e[e.Bg_Iknv_Doukutu=490]="Bg_Iknv_Doukutu",e[e.Bg_Iknv_Obj=491]="Bg_Iknv_Obj",e[e.En_Pamera=492]="En_Pamera",e[e.Obj_HsStump=493]="Obj_HsStump",e[e.En_Hidden_Nuts=494]="En_Hidden_Nuts",e[e.En_Zow=495]="En_Zow",e[e.En_Talk=496]="En_Talk",e[e.En_Al=497]="En_Al",e[e.En_Tab=498]="En_Tab",e[e.En_Nimotsu=499]="En_Nimotsu",e[e.En_Hit_Tag=500]="En_Hit_Tag",e[e.En_Ruppecrow=501]="En_Ruppecrow",e[e.En_Tanron4=502]="En_Tanron4",e[e.En_Tanron5=503]="En_Tanron5",e[e.En_Tanron6=504]="En_Tanron6",e[e.En_Daiku2=505]="En_Daiku2",e[e.En_Muto=506]="En_Muto",e[e.En_Baisen=507]="En_Baisen",e[e.En_Heishi=508]="En_Heishi",e[e.En_Demo_heishi=509]="En_Demo_heishi",e[e.En_Dt=510]="En_Dt",e[e.En_Cha=511]="En_Cha",e[e.Obj_Dinner=512]="Obj_Dinner",e[e.Eff_Lastday=513]="Eff_Lastday",e[e.Bg_Ikana_Dharma=514]="Bg_Ikana_Dharma",e[e.En_Akindonuts=515]="En_Akindonuts",e[e.Eff_Stk=516]="Eff_Stk",e[e.En_Ig=517]="En_Ig",e[e.En_Rg=518]="En_Rg",e[e.En_Osk=519]="En_Osk",e[e.En_Sth2=520]="En_Sth2",e[e.En_Yb=521]="En_Yb",e[e.En_Rz=522]="En_Rz",e[e.En_Scopecoin=523]="En_Scopecoin",e[e.En_Bjt=524]="En_Bjt",e[e.En_Bomjima=525]="En_Bomjima",e[e.En_Bomjimb=526]="En_Bomjimb",e[e.En_Bombers=527]="En_Bombers",e[e.En_Bombers2=528]="En_Bombers2",e[e.En_Bombal=529]="En_Bombal",e[e.Obj_Moon_Stone=530]="Obj_Moon_Stone",e[e.Obj_Mu_Pict=531]="Obj_Mu_Pict",e[e.Bg_Ikninside=532]="Bg_Ikninside",e[e.Eff_Zoraband=533]="Eff_Zoraband",e[e.Obj_Kepn_Koya=534]="Obj_Kepn_Koya",e[e.Obj_Usiyane=535]="Obj_Usiyane",e[e.En_Nnh=536]="En_Nnh",e[e.Obj_Kzsaku=537]="Obj_Kzsaku",e[e.Obj_Milk_Bin=538]="Obj_Milk_Bin",e[e.En_Kitan=539]="En_Kitan",e[e.Bg_Astr_Bombwall=540]="Bg_Astr_Bombwall",e[e.Bg_Iknin_Susceil=541]="Bg_Iknin_Susceil",e[e.En_Bsb=542]="En_Bsb",e[e.En_Recepgirl=543]="En_Recepgirl",e[e.En_Thiefbird=544]="En_Thiefbird",e[e.En_Jgame_Tsn=545]="En_Jgame_Tsn",e[e.Obj_Jgame_Light=546]="Obj_Jgame_Light",e[e.Obj_Yado=547]="Obj_Yado",e[e.Demo_Syoten=548]="Demo_Syoten",e[e.Demo_Moonend=549]="Demo_Moonend",e[e.Bg_Lbfshot=550]="Bg_Lbfshot",e[e.Bg_Last_Bwall=551]="Bg_Last_Bwall",e[e.En_And=552]="En_And",e[e.En_Invadepoh_Demo=553]="En_Invadepoh_Demo",e[e.Obj_Danpeilift=554]="Obj_Danpeilift",e[e.En_Fall2=555]="En_Fall2",e[e.Dm_Al=556]="Dm_Al",e[e.Dm_An=557]="Dm_An",e[e.Dm_Ah=558]="Dm_Ah",e[e.Dm_Nb=559]="Dm_Nb",e[e.En_Drs=560]="En_Drs",e[e.En_Ending_Hero=561]="En_Ending_Hero",e[e.Dm_Bal=562]="Dm_Bal",e[e.En_Paper=563]="En_Paper",e[e.En_Hint_Skb=564]="En_Hint_Skb",e[e.Dm_Tag=565]="Dm_Tag"}(f||(f={}));class A{constructor(e,t=e,a=[]){this.id=e,this.name=t,this.disabledRooms=a,this.name=t,this.id=e}async spawnActorForRoom(e,t,a,r,n){function l(e){return t.modelCache.fetchArchive(`mm3d/actors/${e}`)}function d(n,s,i=.01){const o=t.modelCache.getModel(e,t,n,s),l=new c.CmbInstance(e,t.textureHolder,o);return l.animationController.fps=20,l.setConstantColor(1,u.TransparentBlack),l.name=`${h.hexzero(r.actorId,4)} / ${h.hexzero(r.variable,4)} / ${s}`,m.mat4.scale(l.modelMatrix,r.modelMatrix,[i,i,i]),a.objectRenderers.push(l),l}function p(e,t){return i.parse(1,h.assertExists(o.findFileData(e,t)))}function A(a,r){const n=s.parse(1,h.assertExists(o.findFileData(a,r)));return t.textureHolder.addTextures(e,n.textures),n}if(r.actorId===f.En_Dno){const e=await l("zelda2_dnj.gar.lzs");d(e,"model/deknuts_butler.cmb").bindCSAB(p(e,"anim/dnj_wait.csab"))}else if(r.actorId===f.En_Slime){d(await l("zelda2_slime.gar.lzs"),"model/chuchu.cmb").setVertexColorScale(.5)}else if(r.actorId===f.En_Snowman){const e=await l("zelda2_snowman.gar.lzs");d(e,"model/snowman.cmb").bindCSAB(p(e,"anim/sm_wait.csab"))}else if(r.actorId===f.En_Bb){const e=await l("zelda_bb.gar.lzs"),t=d(e,"model/bubble.cmb");t.bindCSAB(p(e,"anim/bb_fly.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Bombf){const e=await l("zelda_bombf.gar.lzs"),t=d(e,"model/bm_flower_model.cmb");t.modelMatrix[13]+=10,t.setVertexColorScale(.5),d(e,"model/bm_leaf_model.cmb").setVertexColorScale(.5),d(e,"model/bm_leaf2_model.cmb").setVertexColorScale(.5)}else if(r.actorId===f.En_Bubble){d(await l("zelda_bubble.gar.lzs"),"model/syabom.cmb").setVertexColorScale(.5)}else if(r.actorId===f.En_Cow){const e=await l("zelda_cow.gar.lzs"),t=d(e,"model/cow2.cmb");t.bindCSAB(p(e,"anim/ust_daran.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Crow){const e=await l("zelda_crow.gar.lzs"),t=d(e,"model/gue.cmb");t.bindCSAB(p(e,"anim/df_flygue.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Daiku){const e=await l("zelda_daiku.gar.lzs"),t=d(e,"model/disciple.cmb");t.bindCSAB(p(e,"anim/dk2_turuwait.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Karebaba){const e=await l("zelda_dekubaba.gar.lzs"),t=d(e,"model/dekubaba.cmb",.01);t.bindCSAB(p(e,"anim/db_P_kougeki.csab")),t.modelMatrix[13]+=60,t.modelMatrix[14]+=3,t.setVertexColorScale(.5),d(e,"model/db_ha_model.cmb",.01).setVertexColorScale(.5);const a=d(e,"model/db_miki1_model.cmb",.01);a.modelMatrix[13]+=40,m.mat4.rotateX(a.modelMatrix,a.modelMatrix,-1.5705),a.setVertexColorScale(.5);const r=d(e,"model/db_miki2_model.cmb",.01);r.modelMatrix[13]+=20,m.mat4.rotateX(r.modelMatrix,r.modelMatrix,-1.5705),r.setVertexColorScale(.5);const n=d(e,"model/db_miki3_model.cmb",.01);m.mat4.rotateX(n.modelMatrix,n.modelMatrix,-1.5705),n.setVertexColorScale(.5)}else if(r.actorId===f.En_Dekubaba){d(await l("zelda_dekubaba.gar.lzs"),"model/db_ha_model.cmb")}else if(r.actorId===f.En_Dodongo){const e=await l("zelda_dodongo.gar.lzs"),t=d(e,"model/dodongo.cmb",.03);t.bindCSAB(p(e,"anim/da_wait.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Firefly){const e=await l("zelda_ff.gar.lzs"),t=d(e,"model/keith.cmb");t.bindCSAB(p(e,"anim/firefly_wait.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Guruguru){const e=await l("zelda_fu.gar.lzs"),t=d(e,"model/windmillman.cmb");t.bindCSAB(p(e,"anim/fu_mawasu.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Fz){d(await l("zelda_fz.gar.lzs"),"model/frezad.cmb").setVertexColorScale(.5)}else if(r.actorId===f.En_Hs){const e=await l("zelda_hs.gar.lzs"),t=d(e,"model/nadekuro.cmb");t.bindCSAB(p(e,"anim/hs_matsu.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Kakasi){const e=await l("zelda_ka.gar.lzs"),t=d(e,"model/strawman.cmb");t.bindCSAB(p(e,"anim/ka_newwait.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Kanban){const e=await l("zelda_kanban.gar.lzs");d(e,"model/kanban_bo_bottom_model.cmb"),d(e,"model/kanban_bo_center_model.cmb"),d(e,"model/kanban_bo_top_model.cmb"),d(e,"model/kanban_L_bottom_L_model.cmb"),d(e,"model/kanban_L_bottom_R_model.cmb"),d(e,"model/kanban_L_top_L_model.cmb"),d(e,"model/kanban_L_top_R_model.cmb"),d(e,"model/kanban_R_bottom_L_model.cmb"),d(e,"model/kanban_R_bottom_R_model.cmb"),d(e,"model/kanban_R_top_L_model.cmb"),d(e,"model/kanban_R_top_R_model.cmb")}else if(r.actorId===f.Obj_Lightswitch){const e=await l("zelda_lightswitch.gar.lzs"),t=d(e,"model/switch_8_model.cmb",.1);t.bindCMAB(A(e,"misc/switch_8_model.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Ms){const e=await l("zelda_ms.gar.lzs"),t=d(e,"model/beanmaster.cmb");t.bindCSAB(p(e,"anim/ms_matsu.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Niw){const e=await l("zelda_nw.gar.lzs"),t=d(e,"model/chicken.cmb");t.bindCSAB(p(e,"anim/nw_wait.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Peehat){const e=await l("zelda_ph.gar.lzs");d(e,"model/peehat.cmb").setVertexColorScale(.5),d(e,"model/peehat_tail.cmb").setVertexColorScale(.5)}else if(r.actorId===f.En_Poh){const e=await l("zelda_po.gar.lzs"),t=d(e,"model/poh.cmb");t.bindCSAB(p(e,"anim/po_wait.csab")),t.setVertexColorScale(.5);const a=d(e,"model/kantera.cmb");a.bindCSAB(p(e,"anim/po_wait.csab")),a.setVertexColorScale(.5);const r=d(e,"model/poh_soul_modelT.cmb");r.bindCMAB(A(e,"anim/poh_soul_modelT.cmab")),r.setVertexColorScale(.5)}else if(r.actorId===f.En_Rr){const e=await l("zelda_rr.gar.lzs"),t=d(e,"model/likelike.cmb",.02);t.bindCMAB(A(e,"misc/likelike.cmab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Sb){const e=await l("zelda_sb.gar.lzs"),t=d(e,"model/shellblade.cmb");t.bindCSAB(p(e,"anim/sb_wait.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_St){const e=await l("zelda_st.gar.lzs"),t=d(e,"model/staltula.cmb");t.bindCSAB(p(e,"anim/st_matsu.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.Obj_Makekinsuta){const e=await l("zelda_st.gar.lzs"),t=d(e,"model/staltula_gold.cmb");t.bindCSAB(p(e,"anim/st_matsu.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.Obj_Syokudai){d(await l("zelda_syokudai.gar.lzs"),"model/syokudai_model.cmb")}else if(r.actorId===f.Obj_Tsubo){d(await l("zelda_tsubo.gar.lzs"),"model/tubo2_model.cmb",.15)}else if(r.actorId===f.En_Tite){const e=await l("zelda_tt.gar.lzs"),t=d(e,"model/tectite.cmb");t.bindCSAB(p(e,"anim/tt_wait.csab")),t.setVertexColorScale(.5)}else if(r.actorId===f.En_Vm){const e=await l("zelda_vm.gar.lzs"),t=d(e,"model/beamos.cmb");t.bindCSAB(p(e,"anim/vm_akesime.csab")),t.setVertexColorScale(.5)}else console.warn(`Unknown actor ${n} / ${h.hexzero(r.actorId,2)} / ${g=r.actorId,f[g]} / ${h.hexzero(r.variable,4)}`);var g}async createScene(e,t){const a=`mm3d/scenes/${this.id}_info.gar`,r=`mm3d/scenes/${this.id}_info.zsi`,n=t.dataFetcher,[i,u]=await Promise.all([n.fetchData(a,1),n.fetchData(r)]),m=new c.CtrTextureHolder;t.destroyablePool.push(m);const f=new d.ModelCache(n);t.destroyablePool.push(f);const A=o.parse(p.maybeDecompress(i)),g=l.parseScene(p.maybeDecompress(u));h.assert(null!==g.rooms);const _=new d.OoT3DRenderer(e,m,g,f);t.destroyablePool.push(_);const S=[];for(let e=0;e<g.rooms.length;e++){const t=`mm3d/scenes/${g.rooms[e].split("/").pop()}`;S.push(t),f.fetchFileData(t)}return f.waitForLoad().then(()=>{for(let t=0;t<S.length;t++){const a=l.parseRooms(p.maybeDecompress(f.getFileData(S[t]))),r=h.assertExists(a.find(e=>null!==e.mesh));h.assert(null!==r.mesh);const n=S[t].split("/").pop(),i=new c.RoomRenderer(e,m,r.mesh,n);if(i.roomSetups=a,null!==A){const a=A.files.find(e=>e.name.startsWith(`ROOM${t}/`)&&e.name.endsWith(".cmab")&&!e.name.endsWith("_t.cmab"));if(a){const t=s.parse(1,a.buffer);m.addTextures(e,t.textures),i.bindCMAB(t)}}_.roomRenderers.push(i);for(let t=0;t<r.actors.length;t++)this.spawnActorForRoom(e,_,i,r.actors[t],t);this.disabledRooms.includes(t)&&i.setVisible(!1)}return f.waitForLoad().then(()=>(_.setEnvironmentSettingsIndex(0),_))})}}const g=["Intro",new A("z2_lost_woods","The Lost Woods"),new A("z2_openingdan","Road to Termina"),"Termina",new A("z2_00keikoku","Termina Field"),new A("z2_01keikoku","Termina Field (Telescope)"),new A("z2_02keikoku","Termina Field (?)"),new A("z2_kyojinnoma","Giant's Realm"),new A("z2_yousei_izumi","Fairy Fountains"),new A("kakusiana","Underground Caves"),"Clock Town",new A("z2_backtown","North Clock Town"),new A("z2_town","East Clock Town"),new A("z2_clocktower","South Clock Town"),new A("z2_ichiba","West Clock Town"),new A("z2_tenmon_dai","Clock Town Sewers"),new A("z2_alley","Laundry Pool"),new A("z2_8itemshop","Trading Post"),new A("z2_ayashiishop","Kafei's Hideout"),new A("z2_bomya","Bomb Shop"),new A("z2_bowling","Honey & Darling's Shop"),new A("z2_doujou","Swordsman's School"),new A("z2_insidetower","Clock Tower"),new A("z2_milk_bar","Milk Bar"),new A("z2_okujou","Top of Clock Tower"),new A("z2_posthouse","Postman's Office"),new A("z2_sonchonoie","Mayor's Office"),new A("z2_syateki_mizu","Town Shooting Gallery"),new A("z2_takarakuji","Lottery Shop"),new A("z2_takaraya","Treasure Chest Minigame"),new A("z2_yadoya","Stock Pot Inn"),"Milk Road",new A("z2_romanymae","Milk Road"),new A("z2_f01","Romani Ranch"),new A("z2_omoya","Romani's House & Barn"),new A("z2_koeponarace","Gorman Track"),new A("z2_f01_b","Doggy Racetrack"),new A("z2_f01c","Cucco Shack"),"Southern Swamp",new A("z2_20sichitai","Southern Swamp"),new A("z2_20sichitai2","Southern Swamp (Clear)"),new A("z2_24kemonomiti","Southern Swamp Trail"),new A("z2_26sarunomori","Woods of Mystery"),new A("z2_21miturinmae","Woodfall"),new A("z2_22dekucity","Deku Palace"),new A("z2_danpei","Deku Shrine"),new A("z2_deku_king","Deku King's Chamber"),new A("z2_dekutes","Deku Scrub Playground"),new A("z2_kinsta1","Swamp Spider House"),new A("z2_map_shop","Tourist Information"),new A("z2_syateki_mori","Swamp Shooting Gallery"),new A("z2_turibori","Swamp Fishing Hole"),new A("z2_witch_shop","Magic Hags' Potion Shop"),new A("z2_miturin","Woodfall Temple"),new A("z2_miturin_bs","Woodfall Temple (Boss)"),"Snowhead",new A("z2_10yukiyamanomura","Mountain Village"),new A("z2_10yukiyamanomura2","Mountain Village (Spring)"),new A("z2_11goronnosato","Goron Village"),new A("z2_11goronnosato2","Goron Village (Spring)"),new A("z2_12hakuginmae","Snowhead"),new A("z2_13hubukinomiti","Mountain Village Trail"),new A("z2_14yukidamanomiti","Snowhead Trail"),new A("z2_16goron_house","Goron Shrine"),new A("z2_17setugen","Mountain Pond"),new A("z2_17setugen2","Mountain Pond (Spring)"),new A("z2_goron_haka","Goron Graveyard"),new A("z2_goronrace","Goron Racetrack"),new A("z2_goronshop","Goron Shop"),new A("z2_kajiya","Mountain Smithy"),new A("z2_hakugin","Snowhead Temple"),new A("z2_hakugin_bs","Snowhead Temple (Boss)"),"Great Bay",new A("z2_30gyoson","Great Bay Coast"),new A("z2_35taki","Waterfall Rapids"),new A("z2_31misaki","Zora Cape"),new A("z2_33zoracity","Zora Hall"),new A("z2_bandroom","Zora Band Rooms"),new A("z2_fisherman","Fisherman's Hut"),new A("z2_labo","Marine Research Lab"),new A("z2_kaizoku","Pirates' Fortress (Central)"),new A("z2_pirate","Pirates' Fortress (Inside)"),new A("z2_toride","Pirates' Fortress Entrance"),new A("z2_sinkai","Pinnacle Rock"),new A("z2_kindan2","Oceanside Spider House"),new A("z2_turibori2","Ocean Fishing Hole"),new A("z2_konpeki_ent","Great Bay Temple (Outside)"),new A("z2_sea","Great Bay Temple"),new A("z2_sea_bs","Great Bay Temple (Boss)"),"Ikana Canyon",new A("z2_ikanamae","Ikana Trail"),new A("z2_ikana","Ikana Canyon"),new A("z2_boti","Ikana Graveyard"),new A("z2_castle","Ancient Castle of Ikana"),new A("z2_hakashita","Ikana Grave (Night One & Two)"),new A("z2_danpei2test","Ikana Grave (Night Three)"),new A("z2_ikninside","Ancient Castle of Ikana Throne Room"),new A("z2_tougites","Poe Battle Arena"),new A("z2_musichouse","Music Box House"),new A("z2_random","Secret Shrine"),new A("z2_redead","Beneath the Well"),new A("z2_secom","Sakon's Hideout"),new A("z2_f40","Stone Tower"),new A("z2_f41","Stone Tower (Upside Down)"),new A("z2_inisie_n","Stone Tower Temple",[5,6,11]),new A("z2_inisie_r","Stone Tower Temple (Upside Down)",[7,9]),"The Moon",new A("z2_sougen","The Moon"),new A("z2_last_link","Link's Trial"),new A("z2_last_deku","Deku Link's Trial"),new A("z2_last_goron","Goron Link's Trial"),new A("z2_last_zora","Zora Link's Trial"),new A("z2_last_bs","Majora's Mask (Boss)"),"Test Maps",new A("test01","Test Map 1"),new A("test02","Test Map 2"),new A("spot00"),new A("z2_32kamejimamae"),new A("z2_inisie_bs"),new A("z2_meganeana"),new A("z2_zolashop")];t.sceneGroup={id:"mm3d",name:"The Legend of Zelda: Majora's Mask 3D",sceneDescs:g}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(45)),s=r(a(62)),i=r(a(80)),o=r(a(108)),l=r(a(236)),c=a(68),h=a(0),d=a(114),u=a(2);class m{constructor(e,t){this.mapNumber=e,this.name=t,this.id=`map${e}`}createScene(e,t){const a=`lm3d/map/map${h.leftPad(""+this.mapNumber,2,"0")}.gar`,r=`lm3d/mapmdl/map${this.mapNumber}`,m=new d.GrezzoTextureHolder,p=t.dataFetcher;return p.fetchData(a).then(t=>{const a=i.parse(t),f=h.assertExists(a.files.find(e=>"JMP.gar"===e.name)),A=i.parse(f.buffer),g=h.assertExists(A.files.find(e=>"RoomInfo.gseb"===e.name)),_=o.parse(g.buffer,!0),S=h.assertExists(A.files.find(e=>"FurnitureInfo.gseb"===e.name)),b=o.parse(S.buffer,!0),v=new Map,w=new d.MultiCmbScene(e,m),x=[];for(let t=0;t<_.records.length;t++)x.push(p.fetchData(`${r}/room_${h.leftPad(""+t,2,"0")}.gar`).then(a=>{const r=i.parse(a),d=r.files.find(e=>"room.gar"===e.name);if(void 0===d)return;const p=i.parse(d.buffer),f=h.assertExists(p.files.find(e=>e.name.endsWith(".cmb"))),A=n.parse(f.buffer),g=p.files.filter(e=>e.name.endsWith(".ctxb"));for(let t=0;t<g.length;t++){const a=l.parse(g[t].buffer);m.addCTXB(e,a)}const _=new c.CmbData(e,A);m.addCMB(e,A),w.cmbData.push(_);const S=new c.CmbInstance(e,m,_,A.name);w.cmbRenderers.push(S);const x=f.name.split(".")[0],T=p.files.find(e=>e.name===`${x}.cmab`);if(T){const t=s.parse(2,T.buffer);m.addTextures(e,t.textures),S.bindCMAB(t)}const y=o.getEntriesWithField(b,"room_no",t);for(let t=0;t<y.records.length;t++){const a=y.records[t],s=a[6],i=r.files.find(e=>e.name==`${s}.cmb`);if(void 0===i)continue;let l=v.get(s);if(void 0===l){const t=n.parse(i.buffer);l=new c.CmbData(e,t),m.addTextures(e,t.textures),w.cmbData.push(l),v.set(s,l)}const d=new c.CmbInstance(e,m,l,A.name),p=h.assertExists(o.getField(y,a,"dir_x"))/180*Math.PI,f=h.assertExists(o.getField(y,a,"dir_y"))/180*Math.PI,g=h.assertExists(o.getField(y,a,"dir_z"))/180*Math.PI,_=h.assertExists(o.getField(y,a,"pos_x")),S=h.assertExists(o.getField(y,a,"pos_y")),b=h.assertExists(o.getField(y,a,"pos_z"));u.computeModelMatrixSRT(d.modelMatrix,1,1,1,p,f,g,_,S,b),w.cmbRenderers.push(d)}}));return p.waitForLoad().then(()=>w)})}}const p=[{mapNumber:2,name:"Main Mansion"},{mapNumber:1,name:"E Gadd's Garage"},{mapNumber:3,name:"Training Room"},{mapNumber:4,name:"Ghost Portrificationizer"},{mapNumber:5,name:"Gallery"},{mapNumber:9,name:"King Boo Boss Arena"},{mapNumber:10,name:"Chauncey Boss Arena"},{mapNumber:11,name:"Boolossus Boss Arena"},{mapNumber:13,name:"Bogmire Boss Arena"},{mapNumber:12,name:"Ghost Portrificationizer (End Credits)"}].map(e=>new m(e.mapNumber,e.name));t.sceneGroup={id:"lm3d",name:"Luigi's Mansion 3D",sceneDescs:p}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(45);t.parse=function(e){const t=e.createDataView();r.assert("ctxb"===r.readString(e,0,4)),t.getUint32(4,!0),r.assert(1===t.getUint32(8,!0));const a=t.getUint32(16,!0),s=t.getUint32(20,!0);return{textures:n.parseTexChunk(e.slice(a),e.slice(s),"ctxb")}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(238),n=a(239);class s{constructor(e,t,a){this.id=e,this.name=t,this.paths=a}async createScene(e,t){const a=t.dataFetcher,s=(await Promise.all(this.paths.map(e=>a.fetchData(e)))).map(e=>r.parseIV(e));return new n.Scene(e,s)}}const i=[new s("dks1","Dark Souls 1",["dksiv/dks1/15-0 Sens Fortress.iv","dksiv/dks1/15-1 Anor Londo.iv","dksiv/dks1/16-0 New Londo Ruins+Valley of Drakes.iv","dksiv/dks1/17-0 Duke's Archive+Crystal Caves.iv","dksiv/dks1/18-0 Kiln of the first Flame.iv","dksiv/dks1/18-1 Undead Asylum.iv","dksiv/dks1/10-0 Depths.iv","dksiv/dks1/10-1 Undead Burg.iv","dksiv/dks1/10-2 Firelink Shrine.iv","dksiv/dks1/11-0 Painted World of Ariamis.iv","dksiv/dks1/12-0 Darkroot Garden+Basin.iv","dksiv/dks1/12-1 Oolacile.iv","dksiv/dks1/13-0 Catacombs.iv","dksiv/dks1/13-1 Tomb of the Giants.iv","dksiv/dks1/13-2 Ash Lake.iv","dksiv/dks1/14-0 Blighttown+Quelaags Domain.iv","dksiv/dks1/14-1 Demon Ruins+Lost Izalith.iv"]),new s("dks2","Dark Souls 2",["dksiv/dks2/10_25_The Gutter & Black Gulch.iv","dksiv/dks2/10_27_Dragon Aerie & Dragon Shrine.iv","dksiv/dks2/10_29_Majula.iv","dksiv/dks2/10_30_Heide's Tower of Flame.iv","dksiv/dks2/10_31_Heide's Tower of Flame & Cathedral of Blue.iv","dksiv/dks2/10_32_Shaded Woods & Shrine of Winter.iv","dksiv/dks2/10_33_Doors of Pharros.iv","dksiv/dks2/10_34_Grave of Saints.iv","dksiv/dks2/20_10_Memory of Vammar, Orro, Jeigh.iv","dksiv/dks2/20_11_Shrine of Amana.iv","dksiv/dks2/20_21_Drangleic Castle & King's Passage & Throne of Want.iv","dksiv/dks2/20_24_Undead Crypt.iv","dksiv/dks2/20_26_Dragon Memories.iv","dksiv/dks2/40_03_Dark Chasm of Old.iv","dksiv/dks2/10_02_Things Betwixt.iv","dksiv/dks2/10_04_Majula.iv","dksiv/dks2/10_10_Forest of Fallen Giants.iv","dksiv/dks2/10_14_Brightstone Cove Tseldora & Lord's Private Chamber.iv","dksiv/dks2/10_15_Aldia's Keep.iv","dksiv/dks2/10_16_The Lost Bastille & Sinners' Rise & Belfry Luna.iv","dksiv/dks2/10_17_Harvest Valley & Earthen Peak.iv","dksiv/dks2/10_18_No-man's Wharf.iv","dksiv/dks2/10_19_Iron Keep & Belfry Sol.iv","dksiv/dks2/10_23_Huntsman's Copse & Undead Purgatory.iv"])];t.sceneGroup={id:"dksiv",name:"Dark Souls Collision Data",sceneDescs:i}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(4);t.parseIV=function(e){const t=e.createDataView(),a=e.name.split("/").pop(),n=t.getUint32(0,!0),s=t.getFloat32(4,!0),i=t.getFloat32(8,!0),o=t.getFloat32(12,!0),l=r.colorNewFromRGBA(s,i,o),c=[];let h=16;for(let a=0;a<n;a++){const a=t.getUint32(h+0,!0),r=t.getUint32(h+4,!0),n=t.getUint32(h+8,!0),s=t.getUint32(h+12,!0),i=e.createTypedArray(Uint16Array,a,r),o=e.createTypedArray(Float32Array,n,3*s);c.push({indexData:i,positionData:o}),h+=16}return{name:a,color:l,chunks:c}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=a(20),i=r(a(11)),o=a(6),l=a(13),c=a(9),h=a(17),d=a(23);class u extends s.DeviceProgram{constructor(){super(...arguments),this.both=`\nprecision mediump float;\n\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n    Mat4x4 u_ModelView;\n};\n\nlayout(row_major, std140) uniform ub_ObjectParams {\n    vec4 u_Color;\n};\n\nvarying vec2 v_LightIntensity;\n\n#ifdef VERT\nlayout(location = ${u.a_Position}) attribute vec3 a_Position;\nlayout(location = ${u.a_Normal}) attribute vec3 a_Normal;\n\nvoid mainVS() {\n    const float t_ModelScale = 20.0;\n    gl_Position = Mul(u_Projection, Mul(u_ModelView, vec4(a_Position * t_ModelScale, 1.0)));\n    vec3 t_LightDirection = normalize(vec3(.2, -1, .5));\n    float t_LightIntensityF = dot(-a_Normal, t_LightDirection);\n    float t_LightIntensityB = dot( a_Normal, t_LightDirection);\n    v_LightIntensity = vec2(t_LightIntensityF, t_LightIntensityB);\n}\n#endif\n\n#ifdef FRAG\nvoid mainPS() {\n    float t_LightIntensity = gl_FrontFacing ? v_LightIntensity.x : v_LightIntensity.y;\n    float t_LightTint = 0.3 * t_LightIntensity;\n    gl_FragColor = u_Color + vec4(t_LightTint, t_LightTint, t_LightTint, 0.0);\n}\n#endif\n`}}u.a_Position=0,u.a_Normal=1,u.ub_SceneParams=0,u.ub_ObjectParams=1;class m{constructor(e,t,a){this.chunk=t,this.inputLayout=a;const r=n.vec3.create(),s=new Float32Array(3*t.indexData.length),i=new Float32Array(3*t.indexData.length);for(let e=0;e<t.indexData.length;e+=3){const a=t.indexData[e+0],o=t.indexData[e+1],l=t.indexData[e+2],c=t.positionData[3*a+0],h=t.positionData[3*a+1],d=t.positionData[3*a+2],u=t.positionData[3*o+0],m=t.positionData[3*o+1],p=t.positionData[3*o+2],f=t.positionData[3*l+0],A=t.positionData[3*l+1],g=t.positionData[3*l+2];n.vec3.cross(r,[c-u,h-m,d-p],[c-f,h-A,d-g]),n.vec3.normalize(r,r),s[3*(e+0)+0]=c,s[3*(e+0)+1]=h,s[3*(e+0)+2]=d,s[3*(e+1)+0]=u,s[3*(e+1)+1]=m,s[3*(e+1)+2]=p,s[3*(e+2)+0]=f,s[3*(e+2)+1]=A,s[3*(e+2)+2]=g,i[3*(e+0)+0]=r[0],i[3*(e+0)+1]=r[1],i[3*(e+0)+2]=r[2],i[3*(e+1)+0]=r[0],i[3*(e+1)+1]=r[1],i[3*(e+1)+2]=r[2],i[3*(e+2)+0]=r[0],i[3*(e+2)+1]=r[1],i[3*(e+2)+2]=r[2]}this.posBuffer=h.makeStaticDataBuffer(e,2,s.buffer),this.nrmBuffer=h.makeStaticDataBuffer(e,2,i.buffer),this.inputState=e.createInputState(a,[{buffer:this.posBuffer,byteOffset:0},{buffer:this.nrmBuffer,byteOffset:0}],null),this.numVertices=t.indexData.length}prepareToRender(e){const t=e.pushRenderInst();t.setInputLayoutAndState(this.inputLayout,this.inputState),t.drawPrimitives(this.numVertices)}destroy(e){e.destroyBuffer(this.posBuffer),e.destroyBuffer(this.nrmBuffer),e.destroyInputState(this.inputState)}}class p{constructor(e,t,a){this.iv=t,this.visible=!0,this.name=t.name,this.chunks=this.iv.chunks.map(t=>new m(e,t,a))}setVisible(e){this.visible=e}prepareToRender(e){if(!this.visible)return;const t=e.pushTemplateRenderInst();let a=t.allocateUniformBuffer(u.ub_ObjectParams,4);const r=t.mapUniformBufferF32(u.ub_ObjectParams);a+=l.fillColor(r,a,this.iv.color);for(let t=0;t<this.chunks.length;t++)this.chunks[t].prepareToRender(e);e.popTemplateRenderInst()}destroy(e){this.chunks.forEach(t=>t.destroy(e))}}t.IVRenderer=p;const f=[{numUniformBuffers:2,numSamplers:0}];t.Scene=class{constructor(e,t){this.ivs=t,this.renderTarget=new c.BasicRenderTarget,this.ivRenderers=[],this.program=e.createProgram(new u);const a=[{location:u.a_Position,bufferIndex:0,bufferByteOffset:0,format:o.GfxFormat.F32_RGB},{location:u.a_Normal,bufferIndex:1,bufferByteOffset:0,format:o.GfxFormat.F32_RGB}];this.inputLayout=e.createInputLayout({vertexAttributeDescriptors:a,vertexBufferDescriptors:[{byteStride:12,frequency:1},{byteStride:12,frequency:1}],indexBufferFormat:null}),this.ivRenderers=this.ivs.map(t=>new p(e,t,this.inputLayout)),this.renderHelper=new d.GfxRenderHelper(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(16/60)}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();r.setBindingLayouts(f),r.setGfxProgram(this.program);let n=r.allocateUniformBuffer(u.ub_SceneParams,32);const s=r.mapUniformBufferF32(n);n+=l.fillMatrix4x4(s,n,a.camera.projectionMatrix),n+=l.fillMatrix4x4(s,n,a.camera.viewMatrix);for(let e=0;e<this.ivRenderers.length;e++)this.ivRenderers[e].prepareToRender(this.renderHelper.renderInstManager);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,c.standardFullClearRenderPassDescriptor);return this.renderHelper.renderInstManager.drawOnPassRenderer(e,r),this.renderHelper.renderInstManager.resetRenderInsts(),r}destroy(e){e.destroyInputLayout(this.inputLayout),e.destroyProgram(this.program),this.ivRenderers.forEach(t=>t.destroy(e)),this.renderHelper.destroy(e),this.renderTarget.destroy(e)}createPanels(){const e=new i.LayerPanel;return e.setLayers(this.ivRenderers),[e]}}},function(e,t,a){"use strict";var r=a(241),n=a(63),s=a(173),i=a(146),o=a(174),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=n.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var a=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==a)throw new Error(i[a]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var h;if(h="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(a=r.deflateSetDictionary(this.strm,h)))throw new Error(i[a]);this._dict_set=!0}}function h(e,t){var a=new c(t);if(a.push(e,!0),a.err)throw a.msg||i[a.err];return a.result}c.prototype.push=function(e,t){var a,i,o=this.strm,c=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new n.Buf8(c),o.next_out=0,o.avail_out=c),1!==(a=r.deflate(o,i))&&0!==a)return this.onEnd(a),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(s.buf2binstring(n.shrinkBuf(o.output,o.next_out))):this.onData(n.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==a);return 4===i?(a=r.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,0===a):2!==i||(this.onEnd(0),o.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=c,t.deflate=h,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,h(e,t)}},function(e,t,a){"use strict";var r,n=a(63),s=a(242),i=a(171),o=a(172),l=a(146);function c(e,t){return e.msg=l[t],t}function h(e){return(e<<1)-(e>4?9:0)}function d(e){for(var t=e.length;--t>=0;)e[t]=0}function u(e){var t=e.state,a=t.pending;a>e.avail_out&&(a=e.avail_out),0!==a&&(n.arraySet(e.output,t.pending_buf,t.pending_out,a,e.next_out),e.next_out+=a,t.pending_out+=a,e.total_out+=a,e.avail_out-=a,t.pending-=a,0===t.pending&&(t.pending_out=0))}function m(e,t){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,u(e.strm)}function p(e,t){e.pending_buf[e.pending++]=t}function f(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function A(e,t){var a,r,n=e.max_chain_length,s=e.strstart,i=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+258,m=c[s+i-1],p=c[s+i];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(c[(a=t)+i]===p&&c[a+i-1]===m&&c[a]===c[s]&&c[++a]===c[s+1]){s+=2,a++;do{}while(c[++s]===c[++a]&&c[++s]===c[++a]&&c[++s]===c[++a]&&c[++s]===c[++a]&&c[++s]===c[++a]&&c[++s]===c[++a]&&c[++s]===c[++a]&&c[++s]===c[++a]&&s<u);if(r=258-(u-s),s=u-258,r>i){if(e.match_start=t,i=r,r>=o)break;m=c[s+i-1],p=c[s+i]}}}while((t=d[t&h])>l&&0!=--n);return i<=e.lookahead?i:e.lookahead}function g(e){var t,a,r,s,l,c,h,d,u,m,p=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-262)){n.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=a=e.hash_size;do{r=e.head[--t],e.head[t]=r>=p?r-p:0}while(--a);t=a=p;do{r=e.prev[--t],e.prev[t]=r>=p?r-p:0}while(--a);s+=p}if(0===e.strm.avail_in)break;if(c=e.strm,h=e.window,d=e.strstart+e.lookahead,u=s,m=void 0,(m=c.avail_in)>u&&(m=u),a=0===m?0:(c.avail_in-=m,n.arraySet(h,c.input,c.next_in,m,d),1===c.state.wrap?c.adler=i(c.adler,h,m,d):2===c.state.wrap&&(c.adler=o(c.adler,h,m,d)),c.next_in+=m,c.total_in+=m,m),e.lookahead+=a,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function _(e,t){for(var a,r;;){if(e.lookahead<262){if(g(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(a=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==a&&e.strstart-a<=e.w_size-262&&(e.match_length=A(e,a)),e.match_length>=3)if(r=s._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(m(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(m(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(m(e,!1),0===e.strm.avail_out)?1:2}function S(e,t){for(var a,r,n;;){if(e.lookahead<262){if(g(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(a=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==a&&e.prev_length<e.max_lazy_match&&e.strstart-a<=e.w_size-262&&(e.match_length=A(e,a),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,r=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(m(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=s._tr_tally(e,0,e.window[e.strstart-1]))&&m(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(m(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(m(e,!1),0===e.strm.avail_out)?1:2}function b(e,t,a,r,n){this.good_length=e,this.max_lazy=t,this.nice_length=a,this.max_chain=r,this.func=n}function v(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),d(this.dyn_ltree),d(this.dyn_dtree),d(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),d(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),d(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,s._tr_init(t),0):c(e,-2)}function x(e){var t,a=w(e);return 0===a&&((t=e.state).window_size=2*t.w_size,d(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),a}function T(e,t,a,r,s,i){if(!e)return-2;var o=1;if(-1===t&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),s<1||s>9||8!==a||r<8||r>15||t<0||t>9||i<0||i>4)return c(e,-2);8===r&&(r=9);var l=new v;return e.state=l,l.strm=e,l.wrap=o,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=i,l.method=a,x(e)}r=[new b(0,0,0,0,(function(e,t){var a=65535;for(a>e.pending_buf_size-5&&(a=e.pending_buf_size-5);;){if(e.lookahead<=1){if(g(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+a;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,m(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(m(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(m(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(m(e,!1),e.strm.avail_out),1)})),new b(4,4,8,4,_),new b(4,5,16,8,_),new b(4,6,32,32,_),new b(4,4,16,16,S),new b(8,16,32,32,S),new b(8,16,128,128,S),new b(8,32,128,256,S),new b(32,128,258,1024,S),new b(32,258,258,4096,S)],t.deflateInit=function(e,t){return T(e,t,8,15,8,0)},t.deflateInit2=T,t.deflateReset=x,t.deflateResetKeep=w,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var a,n,i,l;if(!e||!e.state||t>5||t<0)return e?c(e,-2):-2;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return c(e,0===e.avail_out?-5:-2);if(n.strm=e,a=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)e.adler=0,p(n,31),p(n,139),p(n,8),n.gzhead?(p(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),p(n,255&n.gzhead.time),p(n,n.gzhead.time>>8&255),p(n,n.gzhead.time>>16&255),p(n,n.gzhead.time>>24&255),p(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),p(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(p(n,255&n.gzhead.extra.length),p(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=o(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(p(n,0),p(n,0),p(n,0),p(n,0),p(n,0),p(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),p(n,3),n.status=113);else{var A=8+(n.w_bits-8<<4)<<8;A|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(A|=32),A+=31-A%31,n.status=113,f(n,A),0!==n.strstart&&(f(n,e.adler>>>16),f(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=o(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending!==n.pending_buf_size));)p(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=o(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=o(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,p(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>i&&(e.adler=o(e.adler,n.pending_buf,n.pending-i,i)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=o(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,p(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>i&&(e.adler=o(e.adler,n.pending_buf,n.pending-i,i)),0===l&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&u(e),n.pending+2<=n.pending_buf_size&&(p(n,255&e.adler),p(n,e.adler>>8&255),e.adler=0,n.status=113)):n.status=113),0!==n.pending){if(u(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&h(t)<=h(a)&&4!==t)return c(e,-5);if(666===n.status&&0!==e.avail_in)return c(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&666!==n.status){var _=2===n.strategy?function(e,t){for(var a;;){if(0===e.lookahead&&(g(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,a=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,a&&(m(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(m(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(m(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var a,r,n,i,o=e.window;;){if(e.lookahead<=258){if(g(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=o[n=e.strstart-1])===o[++n]&&r===o[++n]&&r===o[++n]){i=e.strstart+258;do{}while(r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&n<i);e.match_length=258-(i-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(a=s._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(a=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),a&&(m(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(m(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(m(e,!1),0===e.strm.avail_out)?1:2}(n,t):r[n.level].func(n,t);if(3!==_&&4!==_||(n.status=666),1===_||3===_)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===_&&(1===t?s._tr_align(n):5!==t&&(s._tr_stored_block(n,0,0,!1),3===t&&(d(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),u(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(p(n,255&e.adler),p(n,e.adler>>8&255),p(n,e.adler>>16&255),p(n,e.adler>>24&255),p(n,255&e.total_in),p(n,e.total_in>>8&255),p(n,e.total_in>>16&255),p(n,e.total_in>>24&255)):(f(n,e.adler>>>16),f(n,65535&e.adler)),u(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?c(e,-2):(e.state=null,113===t?c(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var a,r,s,o,l,c,h,u,m=t.length;if(!e||!e.state)return-2;if(2===(o=(a=e.state).wrap)||1===o&&42!==a.status||a.lookahead)return-2;for(1===o&&(e.adler=i(e.adler,t,m,0)),a.wrap=0,m>=a.w_size&&(0===o&&(d(a.head),a.strstart=0,a.block_start=0,a.insert=0),u=new n.Buf8(a.w_size),n.arraySet(u,t,m-a.w_size,a.w_size,0),t=u,m=a.w_size),l=e.avail_in,c=e.next_in,h=e.input,e.avail_in=m,e.next_in=0,e.input=t,g(a);a.lookahead>=3;){r=a.strstart,s=a.lookahead-2;do{a.ins_h=(a.ins_h<<a.hash_shift^a.window[r+3-1])&a.hash_mask,a.prev[r&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=r,r++}while(--s);a.strstart=r,a.lookahead=2,g(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,e.next_in=c,e.input=h,e.avail_in=l,a.wrap=o,0},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,a){"use strict";var r=a(63);function n(e){for(var t=e.length;--t>=0;)e[t]=0}var s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],i=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576);n(c);var h=new Array(60);n(h);var d=new Array(512);n(d);var u=new Array(256);n(u);var m=new Array(29);n(m);var p,f,A,g=new Array(30);function _(e,t,a,r,n){this.static_tree=e,this.extra_bits=t,this.extra_base=a,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}function S(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function b(e){return e<256?d[e]:d[256+(e>>>7)]}function v(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function w(e,t,a){e.bi_valid>16-a?(e.bi_buf|=t<<e.bi_valid&65535,v(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=a-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=a)}function x(e,t,a){w(e,a[2*t],a[2*t+1])}function T(e,t){var a=0;do{a|=1&e,e>>>=1,a<<=1}while(--t>0);return a>>>1}function y(e,t,a){var r,n,s=new Array(16),i=0;for(r=1;r<=15;r++)s[r]=i=i+a[r-1]<<1;for(n=0;n<=t;n++){var o=e[2*n+1];0!==o&&(e[2*n]=T(s[o]++,o))}}function C(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function M(e){e.bi_valid>8?v(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function U(e,t,a,r){var n=2*t,s=2*a;return e[n]<e[s]||e[n]===e[s]&&r[t]<=r[a]}function k(e,t,a){for(var r=e.heap[a],n=a<<1;n<=e.heap_len&&(n<e.heap_len&&U(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!U(t,r,e.heap[n],e.depth));)e.heap[a]=e.heap[n],a=n,n<<=1;e.heap[a]=r}function D(e,t,a){var r,n,o,l,c=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],n=e.pending_buf[e.l_buf+c],c++,0===r?x(e,n,t):(x(e,(o=u[n])+256+1,t),0!==(l=s[o])&&w(e,n-=m[o],l),x(e,o=b(--r),a),0!==(l=i[o])&&w(e,r-=g[o],l))}while(c<e.last_lit);x(e,256,t)}function I(e,t){var a,r,n,s=t.dyn_tree,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<l;a++)0!==s[2*a]?(e.heap[++e.heap_len]=c=a,e.depth[a]=0):s[2*a+1]=0;for(;e.heap_len<2;)s[2*(n=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[n]=0,e.opt_len--,o&&(e.static_len-=i[2*n+1]);for(t.max_code=c,a=e.heap_len>>1;a>=1;a--)k(e,s,a);n=l;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],k(e,s,1),r=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=r,s[2*n]=s[2*a]+s[2*r],e.depth[n]=(e.depth[a]>=e.depth[r]?e.depth[a]:e.depth[r])+1,s[2*a+1]=s[2*r+1]=n,e.heap[1]=n++,k(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var a,r,n,s,i,o,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,p=t.stat_desc.max_length,f=0;for(s=0;s<=15;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,a=e.heap_max+1;a<573;a++)(s=l[2*l[2*(r=e.heap[a])+1]+1]+1)>p&&(s=p,f++),l[2*r+1]=s,r>c||(e.bl_count[s]++,i=0,r>=m&&(i=u[r-m]),o=l[2*r],e.opt_len+=o*(s+i),d&&(e.static_len+=o*(h[2*r+1]+i)));if(0!==f){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,f-=2}while(f>0);for(s=p;0!==s;s--)for(r=e.bl_count[s];0!==r;)(n=e.heap[--a])>c||(l[2*n+1]!==s&&(e.opt_len+=(s-l[2*n+1])*l[2*n],l[2*n+1]=s),r--)}}(e,t),y(s,c,e.bl_count)}function R(e,t,a){var r,n,s=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),t[2*(a+1)+1]=65535,r=0;r<=a;r++)n=i,i=t[2*(r+1)+1],++o<l&&n===i||(o<c?e.bl_tree[2*n]+=o:0!==n?(n!==s&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=n,0===i?(l=138,c=3):n===i?(l=6,c=3):(l=7,c=4))}function B(e,t,a){var r,n,s=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),r=0;r<=a;r++)if(n=i,i=t[2*(r+1)+1],!(++o<l&&n===i)){if(o<c)do{x(e,n,e.bl_tree)}while(0!=--o);else 0!==n?(n!==s&&(x(e,n,e.bl_tree),o--),x(e,16,e.bl_tree),w(e,o-3,2)):o<=10?(x(e,17,e.bl_tree),w(e,o-3,3)):(x(e,18,e.bl_tree),w(e,o-11,7));o=0,s=n,0===i?(l=138,c=3):n===i?(l=6,c=3):(l=7,c=4)}}n(g);var P=!1;function E(e,t,a,n){w(e,0+(n?1:0),3),function(e,t,a,n){M(e),n&&(v(e,a),v(e,~a)),r.arraySet(e.pending_buf,e.window,t,a,e.pending),e.pending+=a}(e,t,a,!0)}t._tr_init=function(e){P||(!function(){var e,t,a,r,n,l=new Array(16);for(a=0,r=0;r<28;r++)for(m[r]=a,e=0;e<1<<s[r];e++)u[a++]=r;for(u[a-1]=r,n=0,r=0;r<16;r++)for(g[r]=n,e=0;e<1<<i[r];e++)d[n++]=r;for(n>>=7;r<30;r++)for(g[r]=n<<7,e=0;e<1<<i[r]-7;e++)d[256+n++]=r;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)c[2*e+1]=8,e++,l[8]++;for(;e<=255;)c[2*e+1]=9,e++,l[9]++;for(;e<=279;)c[2*e+1]=7,e++,l[7]++;for(;e<=287;)c[2*e+1]=8,e++,l[8]++;for(y(c,287,l),e=0;e<30;e++)h[2*e+1]=5,h[2*e]=T(e,5);p=new _(c,s,257,286,15),f=new _(h,i,0,30,15),A=new _(new Array(0),o,0,19,7)}(),P=!0),e.l_desc=new S(e.dyn_ltree,p),e.d_desc=new S(e.dyn_dtree,f),e.bl_desc=new S(e.bl_tree,A),e.bi_buf=0,e.bi_valid=0,C(e)},t._tr_stored_block=E,t._tr_flush_block=function(e,t,a,r){var n,s,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,a=4093624447;for(t=0;t<=31;t++,a>>>=1)if(1&a&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),I(e,e.l_desc),I(e,e.d_desc),i=function(e){var t;for(R(e,e.dyn_ltree,e.l_desc.max_code),R(e,e.dyn_dtree,e.d_desc.max_code),I(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=n&&(n=s)):n=s=a+5,a+4<=n&&-1!==t?E(e,t,a,r):4===e.strategy||s===n?(w(e,2+(r?1:0),3),D(e,c,h)):(w(e,4+(r?1:0),3),function(e,t,a,r){var n;for(w(e,t-257,5),w(e,a-1,5),w(e,r-4,4),n=0;n<r;n++)w(e,e.bl_tree[2*l[n]+1],3);B(e,e.dyn_ltree,t-1),B(e,e.dyn_dtree,a-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),D(e,e.dyn_ltree,e.dyn_dtree)),C(e),r&&M(e)},t._tr_tally=function(e,t,a){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&a,e.last_lit++,0===t?e.dyn_ltree[2*a]++:(e.matches++,t--,e.dyn_ltree[2*(u[a]+256+1)]++,e.dyn_dtree[2*b(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){w(e,2,3),x(e,256,c),function(e){16===e.bi_valid?(v(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,a){"use strict";var r=a(244),n=a(63),s=a(173),i=a(175),o=a(146),l=a(174),c=a(247),h=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var a=r.inflateInit2(this.strm,t.windowBits);if(a!==i.Z_OK)throw new Error(o[a]);if(this.header=new c,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(a=r.inflateSetDictionary(this.strm,t.dictionary))!==i.Z_OK))throw new Error(o[a])}function u(e,t){var a=new d(t);if(a.push(e,!0),a.err)throw a.msg||o[a.err];return a.result}d.prototype.push=function(e,t){var a,o,l,c,d,u=this.strm,m=this.options.chunkSize,p=this.options.dictionary,f=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof e?u.input=s.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new n.Buf8(m),u.next_out=0,u.avail_out=m),(a=r.inflate(u,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&p&&(a=r.inflateSetDictionary(this.strm,p)),a===i.Z_BUF_ERROR&&!0===f&&(a=i.Z_OK,f=!1),a!==i.Z_STREAM_END&&a!==i.Z_OK)return this.onEnd(a),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&a!==i.Z_STREAM_END&&(0!==u.avail_in||o!==i.Z_FINISH&&o!==i.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(u.output,u.next_out),c=u.next_out-l,d=s.buf2string(u.output,l),u.next_out=c,u.avail_out=m-c,c&&n.arraySet(u.output,u.output,l,c,0),this.onData(d)):this.onData(n.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(f=!0)}while((u.avail_in>0||0===u.avail_out)&&a!==i.Z_STREAM_END);return a===i.Z_STREAM_END&&(o=i.Z_FINISH),o===i.Z_FINISH?(a=r.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===i.Z_OK):o!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),u.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=d,t.inflate=u,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},t.ungzip=u},function(e,t,a){"use strict";var r=a(63),n=a(171),s=a(172),i=a(245),o=a(246);function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):-2}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):-2}function u(e,t){var a,r;return e&&e.state?(r=e.state,t<0?(a=0,t=-t):(a=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=a,r.wbits=t,d(e))):-2}function m(e,t){var a,r;return e?(r=new c,e.state=r,r.window=null,0!==(a=u(e,t))&&(e.state=null),a):-2}var p,f,A=!0;function g(e){if(A){var t;for(p=new r.Buf32(512),f=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,p,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,f,0,e.work,{bits:5}),A=!1}e.lencode=p,e.lenbits=9,e.distcode=f,e.distbits=5}function _(e,t,a,n){var s,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new r.Buf8(i.wsize)),n>=i.wsize?(r.arraySet(i.window,t,a-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):((s=i.wsize-i.wnext)>n&&(s=n),r.arraySet(i.window,t,a-n,s,i.wnext),(n-=s)?(r.arraySet(i.window,t,a-n,n,0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0}t.inflateReset=d,t.inflateReset2=u,t.inflateResetKeep=h,t.inflateInit=function(e){return m(e,15)},t.inflateInit2=m,t.inflate=function(e,t){var a,c,h,d,u,m,p,f,A,S,b,v,w,x,T,y,C,M,U,k,D,I,R,B,P=0,E=new r.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(a=e.state).mode&&(a.mode=13),u=e.next_out,h=e.output,p=e.avail_out,d=e.next_in,c=e.input,m=e.avail_in,f=a.hold,A=a.bits,S=m,b=p,I=0;e:for(;;)switch(a.mode){case 1:if(0===a.wrap){a.mode=13;break}for(;A<16;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(2&a.wrap&&35615===f){a.check=0,E[0]=255&f,E[1]=f>>>8&255,a.check=s(a.check,E,2,0),f=0,A=0,a.mode=2;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&f)<<8)+(f>>8))%31){e.msg="incorrect header check",a.mode=30;break}if(8!=(15&f)){e.msg="unknown compression method",a.mode=30;break}if(A-=4,D=8+(15&(f>>>=4)),0===a.wbits)a.wbits=D;else if(D>a.wbits){e.msg="invalid window size",a.mode=30;break}a.dmax=1<<D,e.adler=a.check=1,a.mode=512&f?10:12,f=0,A=0;break;case 2:for(;A<16;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(a.flags=f,8!=(255&a.flags)){e.msg="unknown compression method",a.mode=30;break}if(57344&a.flags){e.msg="unknown header flags set",a.mode=30;break}a.head&&(a.head.text=f>>8&1),512&a.flags&&(E[0]=255&f,E[1]=f>>>8&255,a.check=s(a.check,E,2,0)),f=0,A=0,a.mode=3;case 3:for(;A<32;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}a.head&&(a.head.time=f),512&a.flags&&(E[0]=255&f,E[1]=f>>>8&255,E[2]=f>>>16&255,E[3]=f>>>24&255,a.check=s(a.check,E,4,0)),f=0,A=0,a.mode=4;case 4:for(;A<16;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}a.head&&(a.head.xflags=255&f,a.head.os=f>>8),512&a.flags&&(E[0]=255&f,E[1]=f>>>8&255,a.check=s(a.check,E,2,0)),f=0,A=0,a.mode=5;case 5:if(1024&a.flags){for(;A<16;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}a.length=f,a.head&&(a.head.extra_len=f),512&a.flags&&(E[0]=255&f,E[1]=f>>>8&255,a.check=s(a.check,E,2,0)),f=0,A=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(1024&a.flags&&((v=a.length)>m&&(v=m),v&&(a.head&&(D=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),r.arraySet(a.head.extra,c,d,v,D)),512&a.flags&&(a.check=s(a.check,c,v,d)),m-=v,d+=v,a.length-=v),a.length))break e;a.length=0,a.mode=7;case 7:if(2048&a.flags){if(0===m)break e;v=0;do{D=c[d+v++],a.head&&D&&a.length<65536&&(a.head.name+=String.fromCharCode(D))}while(D&&v<m);if(512&a.flags&&(a.check=s(a.check,c,v,d)),m-=v,d+=v,D)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=8;case 8:if(4096&a.flags){if(0===m)break e;v=0;do{D=c[d+v++],a.head&&D&&a.length<65536&&(a.head.comment+=String.fromCharCode(D))}while(D&&v<m);if(512&a.flags&&(a.check=s(a.check,c,v,d)),m-=v,d+=v,D)break e}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(512&a.flags){for(;A<16;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(f!==(65535&a.check)){e.msg="header crc mismatch",a.mode=30;break}f=0,A=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=12;break;case 10:for(;A<32;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}e.adler=a.check=l(f),f=0,A=0,a.mode=11;case 11:if(0===a.havedict)return e.next_out=u,e.avail_out=p,e.next_in=d,e.avail_in=m,a.hold=f,a.bits=A,2;e.adler=a.check=1,a.mode=12;case 12:if(5===t||6===t)break e;case 13:if(a.last){f>>>=7&A,A-=7&A,a.mode=27;break}for(;A<3;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}switch(a.last=1&f,A-=1,3&(f>>>=1)){case 0:a.mode=14;break;case 1:if(g(a),a.mode=20,6===t){f>>>=2,A-=2;break e}break;case 2:a.mode=17;break;case 3:e.msg="invalid block type",a.mode=30}f>>>=2,A-=2;break;case 14:for(f>>>=7&A,A-=7&A;A<32;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if((65535&f)!=(f>>>16^65535)){e.msg="invalid stored block lengths",a.mode=30;break}if(a.length=65535&f,f=0,A=0,a.mode=15,6===t)break e;case 15:a.mode=16;case 16:if(v=a.length){if(v>m&&(v=m),v>p&&(v=p),0===v)break e;r.arraySet(h,c,d,v,u),m-=v,d+=v,p-=v,u+=v,a.length-=v;break}a.mode=12;break;case 17:for(;A<14;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(a.nlen=257+(31&f),f>>>=5,A-=5,a.ndist=1+(31&f),f>>>=5,A-=5,a.ncode=4+(15&f),f>>>=4,A-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=30;break}a.have=0,a.mode=18;case 18:for(;a.have<a.ncode;){for(;A<3;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}a.lens[F[a.have++]]=7&f,f>>>=3,A-=3}for(;a.have<19;)a.lens[F[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,R={bits:a.lenbits},I=o(0,a.lens,0,19,a.lencode,0,a.work,R),a.lenbits=R.bits,I){e.msg="invalid code lengths set",a.mode=30;break}a.have=0,a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;y=(P=a.lencode[f&(1<<a.lenbits)-1])>>>16&255,C=65535&P,!((T=P>>>24)<=A);){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(C<16)f>>>=T,A-=T,a.lens[a.have++]=C;else{if(16===C){for(B=T+2;A<B;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(f>>>=T,A-=T,0===a.have){e.msg="invalid bit length repeat",a.mode=30;break}D=a.lens[a.have-1],v=3+(3&f),f>>>=2,A-=2}else if(17===C){for(B=T+3;A<B;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}A-=T,D=0,v=3+(7&(f>>>=T)),f>>>=3,A-=3}else{for(B=T+7;A<B;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}A-=T,D=0,v=11+(127&(f>>>=T)),f>>>=7,A-=7}if(a.have+v>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=30;break}for(;v--;)a.lens[a.have++]=D}}if(30===a.mode)break;if(0===a.lens[256]){e.msg="invalid code -- missing end-of-block",a.mode=30;break}if(a.lenbits=9,R={bits:a.lenbits},I=o(1,a.lens,0,a.nlen,a.lencode,0,a.work,R),a.lenbits=R.bits,I){e.msg="invalid literal/lengths set",a.mode=30;break}if(a.distbits=6,a.distcode=a.distdyn,R={bits:a.distbits},I=o(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,R),a.distbits=R.bits,I){e.msg="invalid distances set",a.mode=30;break}if(a.mode=20,6===t)break e;case 20:a.mode=21;case 21:if(m>=6&&p>=258){e.next_out=u,e.avail_out=p,e.next_in=d,e.avail_in=m,a.hold=f,a.bits=A,i(e,b),u=e.next_out,h=e.output,p=e.avail_out,d=e.next_in,c=e.input,m=e.avail_in,f=a.hold,A=a.bits,12===a.mode&&(a.back=-1);break}for(a.back=0;y=(P=a.lencode[f&(1<<a.lenbits)-1])>>>16&255,C=65535&P,!((T=P>>>24)<=A);){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(y&&0==(240&y)){for(M=T,U=y,k=C;y=(P=a.lencode[k+((f&(1<<M+U)-1)>>M)])>>>16&255,C=65535&P,!(M+(T=P>>>24)<=A);){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}f>>>=M,A-=M,a.back+=M}if(f>>>=T,A-=T,a.back+=T,a.length=C,0===y){a.mode=26;break}if(32&y){a.back=-1,a.mode=12;break}if(64&y){e.msg="invalid literal/length code",a.mode=30;break}a.extra=15&y,a.mode=22;case 22:if(a.extra){for(B=a.extra;A<B;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}a.length+=f&(1<<a.extra)-1,f>>>=a.extra,A-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=23;case 23:for(;y=(P=a.distcode[f&(1<<a.distbits)-1])>>>16&255,C=65535&P,!((T=P>>>24)<=A);){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(0==(240&y)){for(M=T,U=y,k=C;y=(P=a.distcode[k+((f&(1<<M+U)-1)>>M)])>>>16&255,C=65535&P,!(M+(T=P>>>24)<=A);){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}f>>>=M,A-=M,a.back+=M}if(f>>>=T,A-=T,a.back+=T,64&y){e.msg="invalid distance code",a.mode=30;break}a.offset=C,a.extra=15&y,a.mode=24;case 24:if(a.extra){for(B=a.extra;A<B;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}a.offset+=f&(1<<a.extra)-1,f>>>=a.extra,A-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=30;break}a.mode=25;case 25:if(0===p)break e;if(v=b-p,a.offset>v){if((v=a.offset-v)>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=30;break}v>a.wnext?(v-=a.wnext,w=a.wsize-v):w=a.wnext-v,v>a.length&&(v=a.length),x=a.window}else x=h,w=u-a.offset,v=a.length;v>p&&(v=p),p-=v,a.length-=v;do{h[u++]=x[w++]}while(--v);0===a.length&&(a.mode=21);break;case 26:if(0===p)break e;h[u++]=a.length,p--,a.mode=21;break;case 27:if(a.wrap){for(;A<32;){if(0===m)break e;m--,f|=c[d++]<<A,A+=8}if(b-=p,e.total_out+=b,a.total+=b,b&&(e.adler=a.check=a.flags?s(a.check,h,b,u-b):n(a.check,h,b,u-b)),b=p,(a.flags?f:l(f))!==a.check){e.msg="incorrect data check",a.mode=30;break}f=0,A=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;A<32;){if(0===m)break e;m--,f+=c[d++]<<A,A+=8}if(f!==(4294967295&a.total)){e.msg="incorrect length check",a.mode=30;break}f=0,A=0}a.mode=29;case 29:I=1;break e;case 30:I=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=u,e.avail_out=p,e.next_in=d,e.avail_in=m,a.hold=f,a.bits=A,(a.wsize||b!==e.avail_out&&a.mode<30&&(a.mode<27||4!==t))&&_(e,e.output,e.next_out,b-e.avail_out)?(a.mode=31,-4):(S-=e.avail_in,b-=e.avail_out,e.total_in+=S,e.total_out+=b,a.total+=b,a.wrap&&b&&(e.adler=a.check=a.flags?s(a.check,h,b,e.next_out-b):n(a.check,h,b,e.next_out-b)),e.data_type=a.bits+(a.last?64:0)+(12===a.mode?128:0)+(20===a.mode||15===a.mode?256:0),(0===S&&0===b||4===t)&&0===I&&(I=-5),I)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var a;return e&&e.state?0==(2&(a=e.state).wrap)?-2:(a.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var a,r=t.length;return e&&e.state?0!==(a=e.state).wrap&&11!==a.mode?-2:11===a.mode&&n(1,t,r,0)!==a.check?-3:_(e,t,r,r)?(a.mode=31,-4):(a.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,a){"use strict";e.exports=function(e,t){var a,r,n,s,i,o,l,c,h,d,u,m,p,f,A,g,_,S,b,v,w,x,T,y,C;a=e.state,r=e.next_in,y=e.input,n=r+(e.avail_in-5),s=e.next_out,C=e.output,i=s-(t-e.avail_out),o=s+(e.avail_out-257),l=a.dmax,c=a.wsize,h=a.whave,d=a.wnext,u=a.window,m=a.hold,p=a.bits,f=a.lencode,A=a.distcode,g=(1<<a.lenbits)-1,_=(1<<a.distbits)-1;e:do{p<15&&(m+=y[r++]<<p,p+=8,m+=y[r++]<<p,p+=8),S=f[m&g];t:for(;;){if(m>>>=b=S>>>24,p-=b,0===(b=S>>>16&255))C[s++]=65535&S;else{if(!(16&b)){if(0==(64&b)){S=f[(65535&S)+(m&(1<<b)-1)];continue t}if(32&b){a.mode=12;break e}e.msg="invalid literal/length code",a.mode=30;break e}v=65535&S,(b&=15)&&(p<b&&(m+=y[r++]<<p,p+=8),v+=m&(1<<b)-1,m>>>=b,p-=b),p<15&&(m+=y[r++]<<p,p+=8,m+=y[r++]<<p,p+=8),S=A[m&_];a:for(;;){if(m>>>=b=S>>>24,p-=b,!(16&(b=S>>>16&255))){if(0==(64&b)){S=A[(65535&S)+(m&(1<<b)-1)];continue a}e.msg="invalid distance code",a.mode=30;break e}if(w=65535&S,p<(b&=15)&&(m+=y[r++]<<p,(p+=8)<b&&(m+=y[r++]<<p,p+=8)),(w+=m&(1<<b)-1)>l){e.msg="invalid distance too far back",a.mode=30;break e}if(m>>>=b,p-=b,w>(b=s-i)){if((b=w-b)>h&&a.sane){e.msg="invalid distance too far back",a.mode=30;break e}if(x=0,T=u,0===d){if(x+=c-b,b<v){v-=b;do{C[s++]=u[x++]}while(--b);x=s-w,T=C}}else if(d<b){if(x+=c+d-b,(b-=d)<v){v-=b;do{C[s++]=u[x++]}while(--b);if(x=0,d<v){v-=b=d;do{C[s++]=u[x++]}while(--b);x=s-w,T=C}}}else if(x+=d-b,b<v){v-=b;do{C[s++]=u[x++]}while(--b);x=s-w,T=C}for(;v>2;)C[s++]=T[x++],C[s++]=T[x++],C[s++]=T[x++],v-=3;v&&(C[s++]=T[x++],v>1&&(C[s++]=T[x++]))}else{x=s-w;do{C[s++]=C[x++],C[s++]=C[x++],C[s++]=C[x++],v-=3}while(v>2);v&&(C[s++]=C[x++],v>1&&(C[s++]=C[x++]))}break}}break}}while(r<n&&s<o);r-=v=p>>3,m&=(1<<(p-=v<<3))-1,e.next_in=r,e.next_out=s,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=s<o?o-s+257:257-(s-o),a.hold=m,a.bits=p}},function(e,t,a){"use strict";var r=a(63),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,a,l,c,h,d,u){var m,p,f,A,g,_,S,b,v,w=u.bits,x=0,T=0,y=0,C=0,M=0,U=0,k=0,D=0,I=0,R=0,B=null,P=0,E=new r.Buf16(16),F=new r.Buf16(16),V=null,O=0;for(x=0;x<=15;x++)E[x]=0;for(T=0;T<l;T++)E[t[a+T]]++;for(M=w,C=15;C>=1&&0===E[C];C--);if(M>C&&(M=C),0===C)return c[h++]=20971520,c[h++]=20971520,u.bits=1,0;for(y=1;y<C&&0===E[y];y++);for(M<y&&(M=y),D=1,x=1;x<=15;x++)if(D<<=1,(D-=E[x])<0)return-1;if(D>0&&(0===e||1!==C))return-1;for(F[1]=0,x=1;x<15;x++)F[x+1]=F[x]+E[x];for(T=0;T<l;T++)0!==t[a+T]&&(d[F[t[a+T]]++]=T);if(0===e?(B=V=d,_=19):1===e?(B=n,P-=257,V=s,O-=257,_=256):(B=i,V=o,_=-1),R=0,T=0,x=y,g=h,U=M,k=0,f=-1,A=(I=1<<M)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){S=x-k,d[T]<_?(b=0,v=d[T]):d[T]>_?(b=V[O+d[T]],v=B[P+d[T]]):(b=96,v=0),m=1<<x-k,y=p=1<<U;do{c[g+(R>>k)+(p-=m)]=S<<24|b<<16|v|0}while(0!==p);for(m=1<<x-1;R&m;)m>>=1;if(0!==m?(R&=m-1,R+=m):R=0,T++,0==--E[x]){if(x===C)break;x=t[a+d[T]]}if(x>M&&(R&A)!==f){for(0===k&&(k=M),g+=y,D=1<<(U=x-k);U+k<C&&!((D-=E[U+k])<=0);)U++,D<<=1;if(I+=1<<U,1===e&&I>852||2===e&&I>592)return 1;c[f=R&A]=M<<24|U<<16|g-h|0}}return 0!==R&&(c[g+R]=x-k<<24|64<<16|0),u.bits=M,0}},function(e,t,a){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);var n;!function(e){e[e.MP1=17]="MP1",e[e.MP2=23]="MP2",e[e.MP3=25]="MP3",e[e.DKCR=27]="DKCR"}(n||(n={})),t.parse=function(e,t,a){r.assert(3736058558==e.readUint32());const s=e.readUint32();if(e.readAssetID(),s==n.MP2){e.readAssetID()}if(s>=n.MP2&&s<=n.MP3){e.readInt32()}if(s==n.DKCR){if(e.readBool()){e.readString(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32()}}e.readAssetID();const i=e.readAssetID();if(s==n.MP1){const t=e.readUint32();e.skip(11*t)}const o=e.readUint32();s==n.MP1&&r.assert(1==e.readInt32());const l=[];for(let a=0;a<o;a++){const a=e.readAssetID(),r=t.loadAssetByID(a,"STRG");let i=null!==r?r.strings[0]:"";e.skip(48),e.skip(24);const o=e.readAssetID();t.findResourceByID(o),e.readAssetID();if(s<=n.MP3){const t=e.readUint32();e.skip(2*t)}if(s<=n.MP2){e.skip(4);const t=e.readUint32();e.skip(8*t);const a=e.readUint32();e.skip(4*a)}if(s<=n.MP3){const t=e.readUint32();for(let a=0;a<t;a++){const t=e.readUint32();e.skip(8*t);const a=e.readUint32();e.skip(12*a)}}if(s==n.MP2){const t=e.readUint32();for(let a=0;a<t;a++)e.readString();const a=e.readUint32();e.skip(4*a)}if(s==n.DKCR&&e.skip(4),s>=n.MP2){const t=e.readString();0===i.length&&(i="!"+t)}l.push({areaName:i,areaMREAID:o})}return{areaTable:l,defaultSkyboxID:i}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(1),s=a(145),i=a(4),o=a(2);class l{}t.AnimationParameters=l;class c{constructor(){this.ambient=i.colorNewFromRGBA(1,1,1,1),this.options=1,this.layerIdx=0,this.maxAreaLights=4}}t.LightParameters=c;class h{constructor(e,t){this.type=e,this.entityId=t,this.active=!0,this.modelMatrix=n.mat4.create(),this.animParams=null,this.model=null,this.char=null,this.lightParams=new c,this.autoSpin=!1}readProperty_MP2(e,t,a){}getRenderModel(){if(null!==this.animParams){const e=this.animParams.charID,t=this.animParams.ancs;if(null!==t&&t.characters.length>e){const a=t.characters[e].model;if(null!==a)return a}}return null!==this.char&&null!==this.char.cmdl?this.char.cmdl:this.model}}t.Entity=h;class d extends h{constructor(){super(...arguments),this.needSky=!1,this.overrideSky=null}readProperty_MP2(e,t,a){switch(a){case 2513747687:this.needSky=e.readBool();break;case 3523791354:this.overrideSky=t.loadAssetByID(e.readAssetID(),"CMDL")}}}function u(e,t){switch(e){case"FISH":case"FSWM":case"GUCH":return null;case"REAA":return new d(e,t);default:return new h(e,t)}}function m(e,t,a){return a.name=r.readString(e,t),a.name.length+1}function p(e,t,a,r,s,i){const l=e.createDataView(),c=t;let h=n.vec3.fromValues(0,0,0),d=n.vec3.fromValues(0,0,0),u=n.vec3.fromValues(1,1,1);if(r){const e=l.getFloat32(t+0),a=l.getFloat32(t+4),r=l.getFloat32(t+8);n.vec3.set(h,e,a,r),t+=12}if(s){const e=.01745*l.getFloat32(t+0),a=.01745*l.getFloat32(t+4),r=.01745*l.getFloat32(t+8);n.vec3.set(d,e,a,r),t+=12}if(i){const e=l.getFloat32(t+0),a=l.getFloat32(t+4),r=l.getFloat32(t+8);n.vec3.set(u,e,a,r),t+=12}return o.computeModelMatrixSRT(a.modelMatrix,u[0],u[1],u[2],d[0],d[1],d[2],h[0],h[1],h[2]),t-c}function f(e,t,a,n,s){const i=r.readString(e,t,a,!1);return s.loadAssetByID(i,n)}function A(e,t,a,n){const s=e.createDataView();a.animParams=new l;const i=r.readString(e,t,4,!1);return a.animParams.ancs=n.loadAssetByID(i,"ANCS"),a.animParams.charID=s.getUint32(t+4),a.animParams.animID=s.getUint32(t+8),12}function g(e,t,a){const n=e.createDataView(),s=t,o=n.getUint32(t);r.assert(14==o),t+=4,t+=function(e,t,a){const n=e.createDataView(),s=n.getUint32(t+0);r.assert(14==s),n.getUint8(t+4),n.getFloat32(t+5),n.getUint32(t+9),n.getFloat32(t+13),n.getFloat32(t+17);const o=n.getFloat32(t+21),l=n.getFloat32(t+25),c=n.getFloat32(t+29),h=n.getFloat32(t+33),d=(n.getUint8(t+37),n.getUint32(t+38)),u=(n.getUint32(t+42),n.getFloat32(t+46),n.getFloat32(t+50),n.getFloat32(t+54),n.getUint32(t+58),n.getUint32(t+62)),m=(n.getUint8(t+66),n.getUint32(t+67));return i.colorFromRGBA(a.lightParams.ambient,o,l,c,h),a.lightParams.options=d,a.lightParams.maxAreaLights=u,a.lightParams.layerIdx=m,r.assert(m>=0&&m<2),71}(e,t,a),t+=4;n.getUint32(t+0),n.getUint32(t+4),n.getUint32(t+8),n.getUint32(t+12),n.getUint8(t+16),n.getFloat32(t+17),n.getFloat32(t+21);t+=25,t+=6;n.getUint8(t+0),n.getUint8(t+1),n.getUint8(t+2),n.getFloat32(t+3);return(t+=7)-s}function _(e,t,a,r){const n=e.readUint32(),o=e.readUint16(),l=e.tell()+o;switch(n){case 4294967295:case 626673024:case 2117697517:case 3010938704:case 1136374237:case 3578131307:{const n=e.readUint16();for(let s=0;s<n;s++)_(e,t,a,r);break}case 1229865293:m(e.getBuffer(),e.tell(),t);break;case 1481003597:p(e.getBuffer(),e.tell(),t,!0,!0,!0);break;case 1094931542:t.active=e.readBool();break;case 3263167119:t.model=f(e.getBuffer(),e.tell(),e.assetIDLength,"CMDL",r);break;case 3797921932:A(e.getBuffer(),e.tell(),t,r);break;case 2748727108:case 1078254053:case 2722417112:30===a?function(e,t,a,r){const n=new s.InputStream(e.slice(t),8),i=n.readAssetID();n.readUint32(),a.char=r.loadAssetByID(i,"CHAR")}(e.getBuffer(),e.tell(),t,r):function(e,t,a,r){const n=new s.InputStream(e.slice(t),8),i=n.readUint8();if(128&i)return;const o=n.readAssetID();a.char=r.loadAssetByID(o,"CHAR");if(32&i&&n.readUint32(),64&i){n.readUint32(),n.readUint32()}}(e.getBuffer(),e.tell(),t,r);break;case 2955467534:{const a=e.readUint16();for(let r=0;r<a;r++){const a=e.readUint32(),r=e.readUint16(),n=e.tell()+r;switch(a){case 2738772750:{const a=e.readFloat32(),r=e.readFloat32(),n=e.readFloat32(),s=e.readFloat32();i.colorFromRGBA(t.lightParams.ambient,a,r,n,s);break}case 1801352457:t.lightParams.options=e.readUint32();break;case 3401705336:t.lightParams.maxAreaLights=e.readUint32();break;case 527523795:t.lightParams.layerIdx=e.readUint32()}e.goTo(n)}break}case 2518420759:t.autoSpin=e.readBool();break;default:t.readProperty_MP2(e,r,n)}e.goTo(l)}t.AreaAttributes=d,t.parseScriptLayer_MP1=function(e,t,a){const r=e.createDataView(),n=[];let s=t;s+=1;const i=r.getUint32(s);s+=4;for(let t=0;t<i;t++){const t=r.getUint8(s+0),i=s+r.getUint32(s+1)+5,o=r.getUint32(s+5);switch(s+=17+12*r.getUint32(s+9),t){case 0:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),i.model=f(e,s+196,4,"CMDL",a),A(e,s+200,i,a),g(e,s+212,i),i.active=!!r.getUint8(s+341),n.push(i);break}case 3:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+36,i,a),g(e,s+48,i),i.model=f(e,s+131,4,"CMDL",a),i.active=!!r.getUint8(s+209),n.push(i);break}case 8:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),i.model=f(e,s+60,4,"CMDL",a),A(e,s+64,i,a),g(e,s+76,i),i.active=!!r.getUint8(s+205),n.push(i);break}case 14:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 17:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),i.model=f(e,s+84,4,"CMDL",a),A(e,s+88,i,a),g(e,s+100,i),i.active=!!r.getUint8(s+225),n.push(i);break}case 22:{const i=new h(t,o);s+=m(e,s,i),p(e,s+4,i,!0,!0,!0),A(e,s+288,i,a),i.active=!!r.getUint8(s+300),g(e,s+361,i),i.model=f(e,s+444,4,"CMDL",a),n.push(i);break}case 27:{const r=new h(t,o);s+=m(e,s,r),p(e,s+0,r,!0,!0,!0),r.model=f(e,s+85,4,"CMDL",a),g(e,s+89,r),n.push(r);break}case 33:{const i=new h(t,o);s+=m(e,s,i),p(e,s+4,i,!0,!0,!0),A(e,s+288,i,a),i.active=!!r.getUint8(s+300),g(e,s+361,i),i.model=f(e,s+444,4,"CMDL",a),n.push(i);break}case 36:case 37:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 38:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+667,4,"CMDL",a),n.push(i);break}case 39:case 40:case 45:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 46:case 49:case 52:{const i=new h(t,o);s+=m(e,s,i),p(e,s+4,i,!0,!0,!0),A(e,s+288,i,a),i.active=!!r.getUint8(s+300),g(e,s+361,i),i.model=f(e,s+444,4,"CMDL",a),n.push(i);break}case 54:case 55:case 59:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 61:case 63:{const i=new h(t,o);s+=m(e,s,i),p(e,s+4,i,!0,!0,!0),A(e,s+288,i,a),i.active=!!r.getUint8(s+300),g(e,s+361,i),i.model=f(e,s+444,4,"CMDL",a),n.push(i);break}case 67:{const i=new h(t,o);s+=m(e,s,i),p(e,s+4,i,!0,!0,!0),A(e,s+292,i,a),i.active=!!r.getUint8(s+304),g(e,s+365,i),i.model=f(e,s+448,4,"CMDL",a),n.push(i);break}case 68:{const i=new h(t,o);s+=m(e,s,i),p(e,s+4,i,!0,!0,!0),A(e,s+288,i,a),i.active=!!r.getUint8(s+300),g(e,s+361,i),i.model=f(e,s+444,4,"CMDL",a),n.push(i);break}case 69:{const r=new h(t,o);s+=m(e,s,r),p(e,s+0,r,!0,!0,!0),r.model=f(e,s+140,4,"CMDL",a),g(e,s+144,r),n.push(r);break}case 75:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 76:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),i.model=f(e,s+196,4,"CMDL",a),A(e,s+200,i,a),i.animParams.charID=2,g(e,s+212,i),i.active=!!r.getUint8(s+340),n.push(i);break}case 77:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),n.push(i);break}case 78:{const i=new d(t,o);i.active=1==r.getUint32(s),i.needSky=!!r.getUint8(s+4),i.overrideSky=f(e,s+25,4,"CMDL",a),n.push(i);break}case 79:{const r=new h(t,o);s+=m(e,s,r),p(e,s+0,r,!0,!0,!0),r.model=f(e,s+37,4,"CMDL",a),A(e,s+41,r,a),n.push(r);break}case 84:case 88:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 90:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),i.active=!!r.getUint8(s+36),g(e,s+37,i),i.model=f(e,s+120,4,"CMDL",a),A(e,s+166,i,a),n.push(i);break}case 92:case 95:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 100:{const r=new h(t,o);s+=m(e,s,r),p(e,s+4,r,!0,!0,!0),A(e,s+64,r,a),g(e,s+76,r),r.model=f(e,s+159,4,"CMDL",a),n.push(r);break}case 102:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 103:{const i=new h(t,o);s+=m(e,s,i),p(e,s+4,i,!0,!0,!0),A(e,s+288,i,a),i.active=!!r.getUint8(s+300),g(e,s+361,i),i.model=f(e,s+444,4,"CMDL",a),n.push(i);break}case 107:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 109:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!1,!0),i.active=!!r.getUint8(s+24),A(e,s+25,i,a),g(e,s+37,i),i.model=f(e,s+120,4,"CMDL",a),n.push(i);break}case 110:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+196,i,a),g(e,s+208,i),i.model=f(e,s+291,4,"CMDL",a),i.active=!!r.getUint8(s+357),n.push(i);break}case 111:case 112:case 114:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 117:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+192,i,a),g(e,s+204,i),i.model=f(e,s+287,4,"CMDL",a),i.active=!!r.getUint8(s+345),n.push(i);break}case 119:case 120:case 121:case 122:case 123:case 124:case 127:case 131:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}case 132:{const i=new h(t,o);s+=4,s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+586,i,a),i.active=!!r.getUint8(s+598),g(e,s+659,i),i.model=f(e,s+742,4,"CMDL",a),n.push(i);break}case 134:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+667,4,"CMDL",a),n.push(i);break}case 135:{const r=new h(t,o);s+=m(e,s,r),p(e,s+0,r,!0,!0,!0),r.model=f(e,s+37,4,"CMDL",a),n.push(r);break}case 136:case 139:{const i=new h(t,o);s+=m(e,s,i),p(e,s+0,i,!0,!0,!0),A(e,s+284,i,a),i.active=!!r.getUint8(s+296),g(e,s+357,i),i.model=f(e,s+440,4,"CMDL",a),n.push(i);break}}s=i}return{entities:n}},t.parseProperty_MP2=_,t.parseScriptLayer_MP2=function(e,t,a){const r=[];e.skip(1);const n=e.readUint32();for(let s=0;s<n;s++){const n=e.readFourCC(),s=e.readUint16(),i=e.tell()+s,o=e.readUint32(),l=e.readUint16();e.skip(12*l);const c=u(n,o);null!==c&&(_(e,c,t,a),r.push(c)),e.goTo(i)}return{entities:r}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=new TextDecoder("utf-16be");function s(e,t){const a=e.createTypedArray(Uint8Array,t,255),r=n.decode(a),s=r.indexOf("\0");let i;return i=s>=0?r.slice(0,s):r,i}function i(e){const t=e.readUint32(),a=e.readUint32(),n=e.tell();e.skip(a);const s=e.getBuffer().createDataView(n,a);let i=new Map;for(let a=0;a<t;a++){const t=8*a,n=s.getUint32(t+0),o=s.getUint32(t+4),l=r.readString(e.getBuffer(),s.byteOffset+n);i.set(l,o)}return i}const o=new TextDecoder("utf8");t.parse=function(e,t,a){r.assert(2271560481==e.readUint32());const n=e.readUint32();if(e.skip(-8),0===n||1==n)return function(e){r.assert(2271560481===e.readUint32());const t=e.readUint32(),a=e.readUint32(),n=e.readUint32();let o=new Map;for(let r=0;r<a;r++){const a=e.readFourCC(),r=e.readUint32();o.set(a,r),1===t&&e.skip(4)}1===t&&i(e);const l=[];if(o.has("ENGL")){const a=o.get("ENGL");e.skip(a),0===t&&e.skip(4);const r=e.tell();for(let t=0;t<n;t++){const t=r+e.readUint32(),a=s(e.getBuffer(),t);l.push(a)}}return{strings:l,nameTable:null}}(e);if(3===n)return function(e){r.assert(2271560481===e.readUint32()),r.assert(3===e.readUint32());const t=e.readUint32(),a=e.readUint32(),n=i(e),s=e.tell()+4*t,l=4+4*a,c=s+t*l,h=[],d=e.getBuffer().createDataView();for(let r=0;r<t;r++){if("ENGL"===e.readFourCC()){e.goTo(s+l*r),e.skip(4);for(let t=0;t<a;t++){const t=c+e.readUint32(),a=d.getUint32(t),r=o.decode(e.getBuffer().createTypedArray(Uint8Array,t+4,a-1));h.push(r)}break}}return{strings:h,nameTable:n}}(e);throw new Error(`Unrecognized STRG version: ${n}`)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(35)),s=[0,1,2,3,8,9,10,4,5,6,14];t.parse=function(e,t,a){const r=e.readUint32(),i=t.findResourceNameByID(a),o=s[r],l=e.readUint16(),c=e.readUint16(),h=e.readUint32();let d=0,u=null;switch(o){case 8:case 9:d=e.readUint32();e.readUint16(),e.readUint16();const t=n.calcPaletteSize(o,d);u=e.getBuffer().slice(e.tell(),e.tell()+t),e.skip(t);break;case 10:throw"whoops"}return{name:i,format:o,width:l,height:c,mipCount:h,data:e.getBuffer().slice(e.tell()),paletteFormat:d,paletteData:u}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(177),s=a(12);var i,o;function l(e){if(e===i.MP1)return n.GameVersion.MP1;if(e===i.MP2)return n.GameVersion.MP2;if(e===i.MP3)return n.GameVersion.MP3;if(e===i.DKCR)return n.GameVersion.DKCR;throw"whoops"}!function(e){e[e.MP1=2]="MP1",e[e.MP2=4]="MP2",e[e.MP3=5]="MP3",e[e.DKCR=10]="DKCR"}(i||(i={})),function(e){e[e.SKINNED=1]="SKINNED",e[e.NRM_SHORT=2]="NRM_SHORT",e[e.UV_SHORT=4]="UV_SHORT",e[e.VIS_GROUPS=16]="VIS_GROUPS",e[e.POS_SHORT=32]="POS_SHORT"}(o||(o={})),t.parse=function(e,t,a){const c=e.readUint32();let h;2474704906===c?h=i.DKCR:(r.assert(3735927486===c),h=e.readUint32(),r.assert(h===i.MP1||h===i.MP2||h===i.MP3,`Unsupported CMDL version: ${h}`));const d=e.readUint32(),u=e.readFloat32(),m=e.readFloat32(),p=e.readFloat32(),f=e.readFloat32(),A=e.readFloat32(),g=e.readFloat32(),_=new s.AABB(u,m,p,f,A,g),S=e.readUint32(),b=e.readUint32();if(h===i.DKCR&&d&o.VIS_GROUPS){e.skip(4);const t=e.readUint32();for(let a=0;a<t;a++){const t=e.readUint32();e.readString(t,!1)}e.skip(20)}const v=[];for(let t=0;t<S;t++){const t=e.readUint32();v.push(t)}e.align(32);const w=[e.tell()];for(let e=1;e<S;e++){const t=w[e-1],a=v[e-1];w.push(r.align(t+a,32))}let x=0;const T=[];e.goTo(w[x++]);for(let a=0;a<b;a++){const r=n.parseMaterialSet(e,t,l(h));T.push(r),h<=i.MP2&&a+1<b&&e.goTo(w[x++])}const y=!!(d&o.POS_SHORT),C=!!(d&o.UV_SHORT)||h===i.DKCR;let M;return[M,x]=n.parseGeometry(e,T[0],w,y,C,h>=i.MP2,h>=i.DKCR,x,-1),{bbox:_,assetID:a,materialSets:T,geometry:M}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.parse=function(e,t,a){r.assert(1==e.readUint16()),r.assert(1==e.readUint16());const n=e.readUint32(),s=[];for(let a=0;a<n;a++){const a=e.readUint32(),n=e.readUint16(),i=e.readString(),o=e.readAssetID(),l=e.readAssetID(),c=e.readAssetID(),h={charID:a,name:i,model:t.loadAssetByID(o,"CMDL"),skinID:l,skelID:c};s.push(h);const d=e.readUint32();for(let t=0;t<d;t++){e.readUint32();if(n<10){e.readString()}e.readString()}const u=e.readFourCC(),m=e.readUint32();e.readUint32();r.assert("PAS4"==u);for(let t=0;t<m;t++){e.skip(4);const t=e.readUint32(),a=e.readUint32();let n=0;for(let a=0;a<t;a++){const t=e.readUint32();r.assert(t>=0&&t<=4);const a=3==t?1:4;e.skip(8),e.skip(2*a),n+=a}e.skip(a*(4+n))}const p=e.readUint32();e.skip(4*p);const f=e.readUint32();e.skip(4*f),n>=6&&e.skip(4);const A=e.readUint32();if(e.skip(4*A),n>=10){const t=e.readUint32();e.skip(4*t)}if(e.skip(4),n>=10&&e.skip(4),n>=2){const t=e.readUint32();for(let a=0;a<t;a++){e.readString();e.skip(24)}const a=e.readUint32();for(let t=0;t<a;t++){e.readString();const t=e.readUint32();for(let a=0;a<t;a++){e.readString();if(e.skip(8),n>=10)e.skip(4);else{e.readString()}e.skip(12)}}if(n>=4){e.readAssetID(),e.readAssetID();if(n>=5){const t=e.readUint32();if(e.skip(4*t),n>=10){e.skip(5);const t=e.readUint32();e.skip(28*t)}}}}}return{characters:s}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.parse=function(e,t,a){return 22974===e.readUint16()?function(e,t,a){e.skip(21);const n=e.readString();e.readAssetID(),e.readAssetID(),e.skip(4);const s=e.readString();r.assert("SkinnedModel"===s||"FrozenModel"===s);const i=e.readAssetID();return e.readAssetID(),{name:n,cmdl:r.assertExists(t.loadAssetByID(i,"CMDL"))}}(e,t):function(e,t,a){const n=e.readString(),s=e.readAssetID();return{name:n,cmdl:r.assertExists(t.loadAssetByID(s,"CMDL"))}}(e,t)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(169)),s=a(170),i=a(179),o=a(0),l=a(168),c=a(4);class h extends l.RetroSceneRenderer{adjustCameraController(e){e.setSceneMoveSpeedMult(4/60*.1)}}class d{constructor(e,t,a=""){this.filename=e,this.name=t,this.worldName=a,this.id=a||e}createScene(e,t){return t.dataFetcher.fetchData(`dkcr/${this.filename}`).then(t=>{const a=n.parse(t,2),r=new s.ResourceSystem([a],null);for(const t of a.namedResourceTable.values()){if(0!==this.worldName.length&&this.worldName!=t.name)continue;const a=o.assertExists(r.loadAssetByID(t.fileID,"MLVL"));o.assert(1===a.areaTable.length);const n=a.areaTable[0],s=o.assertExists(r.loadAssetByID(n.areaMREAID,"MREA")),l=new i.RetroTextureHolder,d=new h(e,a,l);c.colorFromRGBA(d.worldAmbientColor,.5,.5,.5,1);const u=d.renderHelper.getCache(),m=new i.MREARenderer(e,d.modelCache,u,d.textureHolder,this.name,s);return d.areaRenderers.push(m),d}throw"whoops"})}}const u=["Overworld",new d("FrontEnd.pak","Main Menu","MWLD_frontend"),new d("FrontEnd.pak","World Map","MWLD_Map"),"World 1",new d("Worlds/W01_Jungle/L01_Jungle_Intro.pak","1-1 Jungle Hijinxs"),new d("Worlds/W01_Jungle/L02_Jungle_Cling.pak","1-2 King of Cling"),new d("Worlds/W01_Jungle/L03_Jungle_Rambi.pak","1-3 Tree Top Bop"),new d("Worlds/W01_Jungle/L04_Jungle_Silhouette.pak","1-4 Sunset Shore"),new d("Worlds/W01_Jungle/L05_Jungle_Barrelcannons.pak","1-5 Canopy Cannons"),new d("Worlds/W01_Jungle/L06_Jungle_MCTutorial.pak","1-6 Crazy Cart"),new d("Worlds/W01_Jungle/L07_Jungle_Boss_Mugly.pak","1-B Mugly's Mound"),new d("Worlds/W00_Trophy/L0X_Trophy_Equalizer.pak","1-K Platform Panic"),"World 2",new d("Worlds/W02_Beach/L01_Beach_Intro_v2.pak","2-1 Poppin' Planks"),new d("Worlds/W02_Beach/L02_Beach_SandCastles_V2.pak","2-2 Sloppy Sands"),new d("Worlds/W02_Beach/L03_Beach_RocketBarrelIntro.pak","2-3 Peaceful Pier"),new d("Worlds/W02_Beach/L04_Beach_CannonballAttack.pak","2-4 Cannon Cluster"),new d("Worlds/W02_Beach/L05_Beach_Squid.pak","2-5 Stormy Shore"),new d("Worlds/W02_Beach/L06_Beach_Blubbo.pak","2-6 Blowhole Bound"),new d("Worlds/W02_Beach/L07_Beach_Tidalwave.pak","2-7 Tidal Terror"),new d("Worlds/W02_Beach/L08_Crab_Boss_Arena.pak","2-B Pinchin' Pirates"),new d("Worlds/W00_Trophy/L0X_Trophy_Collapse.pak","2-K Tumblin' Temple"),"World 3",new d("Worlds/W03_Ruins/L01_Ruins_Introduction_v2.pak","3-1 Wonky Waterway"),new d("Worlds/W03_Ruins/L02_Ruins_BarrelButtons.pak","3-2 Button Bash"),new d("Worlds/W03_Ruins/L03_Ruins_ShipAttack.pak","3-3 Mast Blast"),new d("Worlds/W03_Ruins/L04_Ruins_WaterWheels.pak","3-4 Damp Dungeon"),new d("Worlds/W03_Ruins/L06_Ruins_BlueBiters.pak","3-5 Itty Bitty Biters"),new d("Worlds/W03_Ruins/L05_Ruins_Rambi.pak","3-6 Temple Topple"),new d("Worlds/W03_Ruins/L07_Ruins_Boss_Stu.pak","3-B Ruined Roost"),new d("Worlds/W00_Trophy/L0X_Trophy_Shift.pak","3-K Shifty Smashers"),"World 4",new d("Worlds/W04_Cave/L01_Cave_Introduction.pak","4-1 Rickety Rails"),new d("Worlds/W04_Cave/L04_Cave_ClingCarts.pak","4-2 Grip and Trip"),new d("Worlds/W04_Cave/L05_Cave_BombsAway_v2.pak","4-3 Bombs Away"),new d("Worlds/W04_Cave/L03_Cave_MolePatrol.pak","4-4 Mole Patrol"),new d("Worlds/W04_Cave/L02_Cave_BatAttack.pak","4-5 Crowded Cavern"),new d("Worlds/W04_Cave/L06_Cave_Boss_MoleTrain.pak","4-B Mole Train"),new d("Worlds/W00_Trophy/L0X_Trophy_Spikes.pak","4-K Jagged Jewels"),"World 5",new d("Worlds/W05_Forest/L01_Forest_Vines.pak","5-1 Vine Valley"),new d("Worlds/W05_Forest/L07_Forest_ClingSwing.pak","5-2 Clingy Swingy"),new d("Worlds/W05_Forest/L02_Forest_Movers.pak","5-3 Flutter Flyaway"),new d("Worlds/W05_Forest/L08_Forest_Totems.pak","5-4 Tippin' Totems"),new d("Worlds/W05_Forest/L04_Forest_Barrels.pak","5-5 Longshot Launch"),new d("Worlds/W05_Forest/L03_Forest_Bounce.pak","5-6 Springy Spores"),new d("Worlds/W05_Forest/L05_Forest_Vineride.pak","5-7 Wigglevine Launchers"),new d("Worlds/W05_Forest/L06_Forest_Chase.pak","5-8 Muncher Marathon"),new d("Worlds/W05_Forest/L09_Forest_Boss_MongoRuby.pak","5-B Mangoruby Run"),new d("Worlds/W00_Trophy/L0X_Trophy_Blast.pak","5-K Blast & Bounce"),"World 6",new d("Worlds/W06_Cliff/L02_Cliff_TarFalls.pak","6-1 Sticky Situation"),new d("Worlds/W06_Cliff/L03_Cliff_Minecart.pak","6-2 Prehistoric Path"),new d("Worlds/W06_Cliff/L04_Cliff_Counterweight.pak","6-3 Weighty Way"),new d("Worlds/W06_Cliff/L03_Cliff_Boulders.pak","6-4 Boulder Roller"),new d("Worlds/W06_Cliff/L05_Cliff_Rambi.pak","6-5 Precarious Plateau"),new d("Worlds/W06_Cliff/L07_Cliff_Avalanche.pak","6-6 Crumble Canyon"),new d("Worlds/W06_Cliff/L08_Cliff_ShipGraveyard.pak","6-7 Tippy Shippy"),new d("Worlds/W06_Cliff/L09_Cliff_Ascend_V2.pak","6-8 Clifftop Climb"),new d("Worlds/W06_Cliff/L10_Cliff_Boss_Thugly.pak","6-B Thugly's Highrise"),new d("Worlds/W00_Trophy/L0X_Trophy_Vertical.pak","6-K Perilous Passage"),"World 7",new d("Worlds/W07_Factory/L01_Factory_FoggyFumes.pak","7-1 Foggy Fumes"),new d("Worlds/W07_Factory/L02_Factory_Smashers.pak","7-2 Slammin' Steel"),new d("Worlds/W07_Factory/L03_Factory_RobotHands.pak","7-3 Handy Hazards"),new d("Worlds/W07_Factory/L04_Factory_RocketBarrel.pak","7-4 Gear Getaway"),new d("Worlds/W07_Factory/L05_Factory_Gears.pak","7-5 Cog Jog"),new d("Worlds/W07_Factory/L06_Factory_Switcheroo.pak","7-6 Switcheroo"),new d("Worlds/W07_Factory/L07_Factory_Musicmadness.pak","7-7 Music Madness"),new d("Worlds/W07_Factory/L08_Factory_Launch.pak","7-R Lift-off Launch"),new d("Worlds/W07_Factory/L10_Factory_Boss_RobotChicken.pak","7-B Feather Fiend"),new d("Worlds/W00_Trophy/L0X_Trophy_Ride.pak","7-K Treacherous Track"),"World 8",new d("Worlds/W08_Volcano/L01_Volcano_Fireballs.pak","8-1 Furious Fire"),new d("Worlds/W08_Volcano/L04_Volcano_Rocketbarrel.pak","8-2 Hot Rocket"),new d("Worlds/W08_Volcano/L02_Volcano_Minecart.pak","8-3 Roasting Rails"),new d("Worlds/W08_Volcano/L06_Volcano_Rambi_Silhouette.pak","8-4 Smokey Peak"),new d("Worlds/W08_Volcano/L03_Volcano_BobbingBasalt_v2.pak","8-5 Bobbing Basalt"),new d("Worlds/W08_Volcano/L05_Volcano_RiverRide.pak","8-6 Moving Melters"),new d("Worlds/W08_Volcano/L07_Volcano_Eruption.pak","8-7 Red Red Rising"),new d("Worlds/W08_Volcano/L08_Volcano_Boss_TikiTong.pak","8-B Tiki Kong Terror"),new d("Worlds/W00_Trophy/L0X_Trophy_Challenge.pak","8-K Five Monkey Trial"),"World 9",new d("Worlds/W00_Trophy/L0X_Trophy_Temple.pak","9-1 Golden Temple")];t.sceneGroup={id:"dkcr",name:"Donkey Kong Country Returns",sceneDescs:u}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(39)),s=r(a(257)),i=a(258),o=a(0);class l{constructor(e,t,a){this.id=e,this.name=t,this.paths=a}createScene(e,t){const a=t.dataFetcher,r=this.paths.map(e=>function(e,t){return t.fetchData(`luigis_mansion/${e}`).then(t=>{let a;if(e.endsWith(".bin"))a=t;else{if(!e.endsWith(".arc"))throw"whoops";{const e=n.parse(t);a=o.assertExists(e.findFile("room.bin")).buffer}}const r=e.split("/").pop();return s.parse(a,r)})}(e,a));return Promise.all(r).then(t=>new i.LuigisMansionRenderer(e,t))}}const c=[new l("map2","Main Mansion",["map2/room_00.arc","map2/room_01.arc","map2/room_02.arc","map2/room_03.arc","map2/room_04.arc","map2/room_05.arc","map2/room_06.arc","map2/room_07.arc","map2/room_08.arc","map2/room_09.arc","map2/room_10.arc","map2/room_11.arc","map2/room_12.arc","map2/room_13.arc","map2/room_14.arc","map2/room_15.arc","map2/room_16.arc","map2/room_17.arc","map2/room_18.arc","map2/room_19.arc","map2/room_20.arc","map2/room_21.arc","map2/room_22.arc","map2/room_23.arc","map2/room_24.arc","map2/room_25.arc","map2/room_26.arc","map2/room_27.arc","map2/room_28.arc","map2/room_28A.arc","map2/room_29.arc","map2/room_30.arc","map2/room_31.arc","map2/room_32.arc","map2/room_33.arc","map2/room_34.arc","map2/room_35.arc","map2/room_36.arc","map2/room_37.arc","map2/room_38.arc","map2/room_39.arc","map2/room_40.arc","map2/room_41.arc","map2/room_42.arc","map2/room_43.arc","map2/room_44.arc","map2/room_45.arc","map2/room_46.arc","map2/room_47.arc","map2/room_48.arc","map2/room_49.arc","map2/room_50.arc","map2/room_51.arc","map2/room_52.arc","map2/room_53.arc","map2/room_54.arc","map2/room_55.arc","map2/room_56.arc","map2/room_57.arc","map2/room_58.arc","map2/room_59.arc","map2/room_60.arc","map2/room_61.arc","map2/room_62.arc","map2/room_63.arc","map2/room_64.arc","map2/room_65.arc","map2/room_66.arc","map2/room_67.arc","map2/room_68.arc","map2/room_69.arc","map2/room_70.arc","map2/room_71.arc","map2/room_72.arc","map2/room_73.arc"]),new l("map1","E Gadd's Garage",["map1/h_02.bin","map1/hakase.arc"]),new l("map3","Training Room",["map3/h_07_00.arc"]),new l("map4","Ghost Portrificationizer",["map4/h_02.bin"]),new l("map6","Gallery",["map6/gyara_00.arc","map6/gyara_01.arc","map6/gyara_02.arc","map6/gyara_03.arc"]),new l("map5","Gallery (Unused)",["map5/h_03_00.bin","map5/h_03_01.bin","map5/h_03_02.bin","map5/h_03_03.bin"]),new l("map7","Gallery (Unused 2)",["map7/h_05_00.bin","map7/h_05_01.bin","map7/h_05_02.bin","map7/h_05_03.bin"]),new l("map8","Gallery (Unused 3)",["map8/h_06_00.bin","map8/h_06_01.bin","map8/h_06_02.bin","map8/h_06_03.bin"]),new l("map9","King Boo Boss Arena",["map9/lastroof.arc"]),new l("map10","Chauncey Boss Arena",["map10/roombed.arc"]),new l("map11","Boolossus Boss Arena",["map11/beranda.arc"]),new l("map13","Bogmire Boss Arena",["map13/tombboss.arc"]),new l("map12","Ghost Portrificationizer (End Credits)",["map12/h_02.bin"])];t.sceneGroup={id:"luigis_mansion",name:"Luigi's Mansion",sceneDescs:c}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(1),s=a(31),i=a(12);t.parse=function(e,t){const a=e.createDataView(),o=a.getUint8(0);r.assert(1===o||2===o),r.readString(e,1,11);const l=a.getUint32(12,!1),c=a.getUint32(16,!1),h=a.getUint32(52,!1),d=a.getUint32(56,!1),u=a.getUint32(60,!1),m=a.getUint32(20,!1),p=a.getUint32(36,!1);function f(t){const r=c+20*t;return{texture:function(t){const r=l+12*t,n=a.getUint16(r+0,!1),s=a.getUint16(r+2,!1),i=a.getUint8(r+4),o=a.getUint32(r+8,!1);return{width:n,height:s,format:i,data:e.slice(l+o)}}(a.getUint16(r+0)),wrapS:a.getUint8(r+4),wrapT:a.getUint8(r+4)}}const A=[];function g(e){A[e]||(A[e]=f(e))}function _(t){const n=d+24*t,i=(a.getUint16(n+0,!1),32*a.getUint16(n+2,!1)),o=a.getUint32(n+4,!1),l=(a.getUint8(n+8),a.getUint8(n+9),a.getUint8(n+10),a.getUint8(n+11)),c=d+a.getUint32(n+12,!1),h=[];if(r.assert(0!=(512&o)),h[9]={compCnt:1,compType:3,compShift:0},!(8192&o))return console.warn(`Batch ${t} does not have TEX0. WTF? / Attributes: ${o.toString(16)}`),null;h[13]={compCnt:1,compType:4,compShift:0},h[10]={compCnt:l?2:1,compType:4,compShift:0};const u=[];for(let e=0;e<=20;e++)if(0!=(o&1<<e)){const t=9===e||13===e;u[e]={type:3,enableOutput:t}}const f=s.compileVtxLoader(h,u),A=f.loadedVertexLayout,g=e.subarray(c,i),_=[];let S;_[9]={buffer:e,offs:m,stride:s.getAttributeByteSize(h,9)},_[13]={buffer:e,offs:p,stride:s.getAttributeByteSize(h,13)};try{S=f.runVertices(_,g)}catch(e){return console.warn(`Batch ${t} had parse error: ${e} / Attributes: ${o.toString(16)}`),null}return{vat:h,loadedVertexLayout:A,loadedVertexData:S}}function S(e){const r=h+40*e,n=[];for(let e=0;e<8;e++){const t=a.getInt16(r+8+2*e,!1);n.push(t),t>=0&&g(t)}const s={alphaChannel:{lightingEnabled:!1,ambColorSource:1,matColorSource:1,litMask:0,diffuseFunction:0,attenuationFunction:2},colorChannel:{lightingEnabled:!1,ambColorSource:1,matColorSource:1,litMask:0,diffuseFunction:0,attenuationFunction:2}};return{gxMaterial:{name:`${t} unknown material ${e}`,cullMode:2,lightChannels:[s,s],texGens:[{index:0,type:1,source:4,matrix:60,normalize:!1,postMatrix:125}],tevStages:[{channelId:0,alphaInA:7,alphaInB:7,alphaInC:7,alphaInD:4,alphaOp:0,alphaBias:0,alphaClamp:!1,alphaScale:0,alphaRegId:0,konstAlphaSel:0,colorInA:15,colorInB:15,colorInC:15,colorInD:8,colorOp:0,colorBias:0,colorClamp:!1,colorScale:0,colorRegId:0,konstColorSel:0,texCoordId:0,texMap:0,indTexStage:0,indTexMatrix:0,indTexFormat:0,indTexBiasSel:0,indTexWrapS:0,indTexWrapT:0,indTexAddPrev:!1,indTexUseOrigLOD:!1}],alphaTest:{op:0,compareA:6,compareB:7,referenceA:.1,referenceB:0},ropInfo:{fogType:0,fogAdjEnabled:!1,blendMode:0,blendSrcFactor:1,blendDstFactor:1,blendLogicOp:0,depthFunc:1,depthTest:!0,depthWrite:!0},indTexStages:[]},samplerIndexes:n}}const b={children:[],modelMatrix:n.mat4.create(),bbox:null,parts:[]};return function e(t,r){const s=u+140*r,o=(a.getInt16(s+0,!1),a.getInt16(s+2,!1)),l=a.getInt16(s+4,!1),c=(a.getInt16(s+6,!1),a.getUint8(s+9),n.mat4.create()),h=a.getFloat32(s+12,!1),d=a.getFloat32(s+16,!1),m=a.getFloat32(s+20,!1),p=a.getFloat32(s+24,!1),f=a.getFloat32(s+28,!1),A=a.getFloat32(s+32,!1),g=a.getFloat32(s+36,!1),b=a.getFloat32(s+40,!1),v=a.getFloat32(s+44,!1),w=a.getFloat32(s+48,!1),x=a.getFloat32(s+52,!1),T=a.getFloat32(s+56,!1),y=a.getFloat32(s+60,!1),C=a.getFloat32(s+64,!1),M=a.getFloat32(s+68,!1);let U=null;0===w&&0===x&&0===T&&0===y&&0===C&&0===M||(U=new i.AABB(w,x,T,y,C,M));const k=n.vec3.fromValues(h,d,m),D=n.quat.create();n.quat.fromEuler(D,p,f,A);const I=n.vec3.fromValues(g,b,v);n.mat4.fromRotationTranslationScale(c,D,I,k),n.mat4.mul(c,t.modelMatrix,c);const R=[],B=a.getUint16(s+76,!1);let P=u+a.getUint32(s+80,!1);for(let e=0;e<B;e++){const e=a.getUint16(P+0,!1),t=a.getUint16(P+2,!1);P+=4;const r=S(e),n=_(t);null!==n&&R.push({material:r,batch:n})}const E={children:[],modelMatrix:c,bbox:U,parts:R};t.children.push(E),o>=0&&e(E,o),l>=0&&e(t,l)}(b,0),{rootNode:b,samplers:A,name:t}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(11)),s=r(a(35)),i=a(5),o=a(0),l=a(1),c=a(12),h=a(8);class d{constructor(e,t){this.binCommand=e,this.material=t,this.materialHelper=new i.GXMaterialHelperGfx(t.gxMaterial)}fillMaterialParams(e){for(let t=0;t<this.material.samplerIndexes.length;t++){const a=this.material.samplerIndexes[t];e.m_TextureMapping[t].reset(),a>=0&&(e.m_TextureMapping[t].gfxTexture=this.binCommand.gfxTextures[a],e.m_TextureMapping[t].gfxSampler=this.binCommand.gfxSamplers[a])}}}const u=new c.AABB,m=new i.MaterialParams,p=new i.PacketParams;class f{constructor(e,t,a,r,n,s){this.materialCommand=a,this.sceneGraphNode=r,this.shapeHelper=new i.GXShapeHelperGfx(e,t,s,n.loadedVertexLayout,n.loadedVertexData)}computeModelView(e,t){h.computeViewMatrix(e,t),l.mat4.mul(e,e,this.sceneGraphNode.modelMatrix)}prepareToRender(e,t,a){if(null!==this.sceneGraphNode.bbox&&(u.transform(this.sceneGraphNode.bbox,this.sceneGraphNode.modelMatrix),!a.camera.frustum.contains(u)))return;const r=t.newRenderInst();this.shapeHelper.setOnRenderInst(r);const n=this.materialCommand.materialHelper.allocateMaterialParams(r);this.materialCommand.fillMaterialParams(m),r.setSamplerBindingsFromTextureMappings(m.m_TextureMapping),this.materialCommand.materialHelper.setOnRenderInst(e,t.gfxRenderCache,r),this.materialCommand.materialHelper.fillMaterialParamsDataOnInst(r,n,m),this.computeModelView(p.u_PosMtx[0],a.camera),this.shapeHelper.fillPacketParams(p,r),t.submitRenderInst(r)}destroy(e){this.shapeHelper.destroy(e)}}class A{constructor(e,t,a){this.bin=a,this.batchCommands=[],this.materialCommands=[],this.gfxSamplers=[],this.gfxTextures=[],this.visible=!0,this.name=a.name,this.translateModel(e,t,a)}prepareToRender(e,t,a){if(this.visible)for(let r=0;r<this.batchCommands.length;r++)this.batchCommands[r].prepareToRender(e,t,a)}setVisible(e){this.visible=e}destroy(e){this.gfxTextures.forEach(t=>e.destroyTexture(t)),this.gfxSamplers.forEach(t=>e.destroySampler(t)),this.batchCommands.forEach(t=>t.destroy(e)),this.bufferCoalescer.destroy(e)}translatePart(e,t,a,r){const n=new d(this,r.material);this.materialCommands.push(n);const s=r.batch,i=this.batches.indexOf(s);o.assert(i>=0);const l=t.renderInstManager.gfxRenderCache,c=new f(e,l,n,a,s,this.bufferCoalescer.coalescedBuffers[i]);this.batchCommands.push(c)}translateSceneGraph(e,t,a){for(const r of a.parts)this.translatePart(e,t,a,r);for(const r of a.children)this.translateSceneGraph(e,t,r)}collectBatches(e,t){for(const a of t.parts)e.push(a.batch);for(const a of t.children)this.collectBatches(e,a)}translateModel(e,t,a){for(let t=0;t<a.samplers.length;t++){const r=a.samplers[t],n=Object.assign(Object.assign({},r.texture),{name:`unknown ${t}`,mipCount:1}),o=s.calcMipChain(n,1),{gfxTexture:l,viewerTexture:c}=i.loadTextureFromMipChain(e,o),h=e.createSampler({wrapS:i.translateWrapModeGfx(r.wrapS),wrapT:i.translateWrapModeGfx(r.wrapT),minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:100});this.gfxTextures.push(l),this.gfxSamplers.push(h)}this.batches=[],this.collectBatches(this.batches,a.rootNode),this.bufferCoalescer=i.loadedDataCoalescerComboGfx(e,this.batches.map(e=>e.loadedVertexData)),this.translateSceneGraph(e,t,a.rootNode)}}class g extends i.BasicGXRendererHelper{constructor(e,t){super(e),this.bins=t,this.binCommands=[];for(let a=0;a<t.length;a++)this.binCommands.push(new A(e,this.renderHelper,t[a]))}adjustCameraController(e){e.setSceneMoveSpeedMult(16/60)}createPanels(){const e=new n.LayerPanel;return e.setLayers(this.binCommands),[e]}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();i.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.binCommands.length;t++)this.binCommands[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}destroy(e){super.destroy(e);for(let t=0;t<this.binCommands.length;t++)this.binCommands[t].destroy(e)}}t.LuigisMansionRenderer=g},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(47)),s=r(a(49)),i=r(a(117)),o=r(a(81)),l=a(116),c=a(0);class h extends l.WorldRenderer{adjustCameraController(e){e.setSceneMoveSpeedMult(.4)}}class d{constructor(e,t=e){this.id=e,this.name=t}createScene(e,t){return t.dataFetcher.fetchData(`spm/${this.id}.bin`).then(t=>{const a=n.decompress(t),r=s.parse(a),d=c.assertExists(r.findFileData("./dvd/map/*/map.dat")),u=o.parse(d),m=new l.TPLTextureHolder,p=c.assertExists(r.findFileData("./dvd/map/*/texture.tpl")),f=i.parse(p,u.textureNameTable);m.addTPLTextures(e,f);const A=r.findDir("./dvd/bg");let g=null;if(null!==A){const t=A.files[0];g=`bg_${this.id}`;const a=i.parse(t.buffer,[g]);m.addTPLTextures(e,a)}return new h(e,u,m,g)})}}const u=["Flipside / Flopside",new d("mac_22","Flipside Tower"),new d("mac_01","Flipside 3rd Floor"),new d("mac_02","Flipside 2nd Floor"),new d("mac_09","Flipside 1st Floor"),new d("mac_04","Flipside B1"),new d("mac_05","Flipside B2"),new d("mac_06","Flipside 1st Floor Outskirts"),new d("mac_08","Flipside Treasure Room"),new d("mac_07","Flipside B1 Outskirts"),new d("mac_30","Flipside Arcade"),new d("mac_03","Mirror Hall"),new d("mac_11","Flopside 3rd Floor"),new d("mac_12","Flopside 2nd Floor"),new d("mac_19","Flopside 1st Floor"),new d("mac_14","Flopside B1"),new d("mac_15","Flopside B2"),new d("mac_16","Flopside 1st Floor Outskirts"),new d("mac_18","Flopside Treasure Room"),new d("mac_17","Flopside B1 Outskirts"),"Chapter 1 - Lineland",new d("he1_01","Lineland Road 1"),new d("he1_03","Lineland Road 1 Secret Room"),new d("he1_06","Bestovius' House"),new d("he1_02","Lineland Road 2"),new d("he1_04","Lineland Road 3"),new d("he1_05","Lineland Road 4"),new d("he2_01","Mount Lineland 1"),new d("he2_02","Mount Lineland 2"),new d("he2_03","Yold Town"),new d("he2_08","Yold Town Secret Room"),new d("he2_04","Red's House"),new d("he2_05","Green's House"),new d("he2_06","Thowmp Hallway"),new d("he2_09","Transition Room"),new d("he2_07","Thoreau's Room"),new d("he3_01","Yold Desert 1"),new d("he3_02","Yold Desert 2"),new d("he3_03","Yold Desert 3"),new d("he3_05","Desert Secret Pipe"),new d("he3_04","O'Chunks Arena"),new d("he3_06","Yold Desert 4"),new d("he3_07","Yold Desert 5"),new d("he3_08","Yold Ruins Entrance"),new d("he4_01","Yold Ruins 1"),new d("he4_02","Yold Ruins 2"),new d("he4_03","Yold Ruins 3"),new d("he4_04","Yold Ruins 4"),new d("he4_05","Yold Ruins 5"),new d("he4_06","Yold Ruins 6"),new d("he4_12","Yold Ruins 7"),new d("he4_07","Yold Ruins 8"),new d("he4_08","Yold Ruins 9"),new d("he4_09","Yold Ruins 10"),new d("he4_10","Fracktail's Arena"),new d("he4_11","Merlumina's Chamber"),"Chapter 2 - Gloam Valley",new d("mi1_01","Gloam Valley 1"),new d("mi1_05","Gloam Valley 1 - Pipe Room 1"),new d("mi1_08","Gloam Valley 2"),new d("mi1_09","Gloam Valley 3"),new d("mi1_11","Gloam Valley 4"),new d("mi1_10","Gloam Valley 5"),new d("mi1_06","Gloam Valley 5 - Pipe Room 1"),new d("mi1_07","Gloam Valley 5 - Boomer's Room"),new d("mi1_02","Gloam Valley 5 - Maze Room 1"),new d("mi1_03","Gloam Valley 5 - Maze Room 2"),new d("mi1_04","Gloam Valley 6"),new d("mi2_01","Merlee's Mansion Exterior"),new d("mi2_02","Merlee's Mansion Foyer"),new d("mi2_03","Merlee's Mansion - Hub 1"),new d("mi2_04","Merlee's Mansion - Hanging Mushroom Trap 1"),new d("mi2_11","Merlee's Mansion - Hanging Mushroom Trap 2"),new d("mi2_05","Merlee's Mansion - Coin Trap 1"),new d("mi2_10","Merlee's Mansion - Coin Trap 2"),new d("mi2_06","Merlee's Mansion - Spike Trap"),new d("mi2_07","Merlee's Mansion - Mushroom Trap 1"),new d("mi2_09","Merlee's Mansion - Mushroom Trap 2"),new d("mi2_08","Merlee's Mansion - Ending Room"),new d("mi3_01","Merlee's Mansion - Hub 2"),new d("mi3_05","Merlee's Mansion - Mushroom Room"),new d("mi3_04","Merlee's Mansion - Standard Generator"),new d("mi3_02","Merlee's Mansion - Break Room"),new d("mi3_03","Merlee's Mansion - VIP Generator"),new d("mi3_06","Merlee's Mansion - Office"),new d("mi4_01","Merlee's Basement Entrance"),new d("mi4_02","Merlee's Basement - Room 1"),new d("mi4_03","Merlee's Basement - Room 2"),new d("mi4_04","Merlee's Basement - Room 3"),new d("mi4_05","Merlee's Basement - Room 4"),new d("mi4_06","Merlee's Basement - Pink Room"),new d("mi4_09","Merlee's Basement - Room 5"),new d("mi4_07","Merlee's Basement - Room 6"),new d("mi4_08","Merlee's Basement - Room 7"),new d("mi4_10","Merlee's Basement - Room 8"),new d("mi4_11","Merlee's Basement - Room 9"),new d("mi4_15","Merlee's Basement - Staircase Room"),new d("mi4_12","Merlee's Basement - Restroom Hall"),new d("mi4_13","Merlee's Basement - Male Restroom"),new d("mi4_14","Merlee's Basement - Female Restroom"),"Chapter 3 - The Bitlands",new d("ta1_01","The Bitlands 1"),new d("ta1_05","The Bitlands 1 - Pipe Room"),new d("ta1_02","The Bitlands 2"),new d("ta1_09","The Bitlands 3"),new d("ta1_03","SMB 1-2 Segment"),new d("ta1_06","SMB 1-2 Segment - Pipe Room 1"),new d("ta1_08","SMB 1-2 Segment - Pipe Room 2"),new d("ta1_07","SMB 1-2 Segment - Pipe Room 3"),new d("ta1_04","The Bitlands 4"),new d("ta2_01","The Tile Pool 1"),new d("ta2_02","The Tile Pool 2"),new d("ta2_03","The Tile Pool 3"),new d("ta2_04","The Tile Pool 4"),new d("ta2_05","The Tile Pool 5"),new d("ta2_06","The Tile Pool 6"),new d("ta3_01","The Dotwood Tree 1 - Exterior"),new d("ta3_05","The Dotwood Tree 1 - Pipe Room"),new d("ta3_02","The Dotwood Tree 2 - Interior"),new d("ta3_06","The Dotwood Tree 2 - Pipe Room 1"),new d("ta3_07","The Dotwood Tree 2 - Pipe Room 2"),new d("ta3_08","The Dotwood Tree 2 - Pipe Room 3"),new d("ta3_03","The Dotwood Tree 3 - Top"),new d("ta3_04","The Dotwood Tree 4 - Level End"),new d("ta4_01","Fort Francis - Exterior"),new d("ta4_02","Fort Francis - Pipe Room"),new d("ta4_03","Fort Francis - Entrance Room"),new d("ta4_04","Fort Francis - Cat Door Hallway"),new d("ta4_05","Fort Francis - Tower 1"),new d("ta4_06","Fort Francis - Hanging Door Hallway"),new d("ta4_07","Fort Francis - Tower 2"),new d("ta4_08","Fort Francis - Bridge"),new d("ta4_09","Fort Francis - Computer Room "),new d("ta4_15","Fort Francis - Dungeon Room 1"),new d("ta4_12","Fort Francis - Dungeon Room 2"),new d("ta4_14","Fort Francis - Spike Hallway"),new d("ta4_11","Fort Francis - Collectibles Room 1"),new d("ta4_10","Fort Francis - Collectibles Room 2"),new d("ta4_13","Fort Francis - Francis's Room"),"Chapter 4 - Outer Space",new d("sp1_01"),new d("sp1_02"),new d("sp1_03"),new d("sp1_04"),new d("sp1_05"),new d("sp1_06"),new d("sp1_07"),new d("sp2_01"),new d("sp2_02"),new d("sp2_03"),new d("sp2_04"),new d("sp2_05"),new d("sp2_06"),new d("sp2_07"),new d("sp2_08"),new d("sp2_09"),new d("sp2_10"),new d("sp3_01"),new d("sp3_02"),new d("sp3_03"),new d("sp3_04"),new d("sp3_05"),new d("sp3_06"),new d("sp3_07"),new d("sp4_01"),new d("sp4_02"),new d("sp4_03"),new d("sp4_04"),new d("sp4_05"),new d("sp4_06"),new d("sp4_07"),new d("sp4_08"),new d("sp4_09"),new d("sp4_10"),new d("sp4_11"),new d("sp4_12"),new d("sp4_13"),new d("sp4_14"),new d("sp4_15"),new d("sp4_16"),new d("sp4_17"),"Chapter 5 - Land of the Cragnons",new d("gn1_01"),new d("gn1_02"),new d("gn1_03"),new d("gn1_04"),new d("gn1_05"),new d("gn2_01"),new d("gn2_02"),new d("gn2_03"),new d("gn2_04"),new d("gn2_05"),new d("gn2_06"),new d("gn3_01"),new d("gn3_02"),new d("gn3_03"),new d("gn3_04"),new d("gn3_05"),new d("gn3_06"),new d("gn3_07"),new d("gn3_08"),new d("gn3_09"),new d("gn3_10"),new d("gn3_11"),new d("gn3_12"),new d("gn3_13"),new d("gn3_14"),new d("gn3_15"),new d("gn3_16"),new d("gn4_01"),new d("gn4_02"),new d("gn4_03"),new d("gn4_04"),new d("gn4_05"),new d("gn4_06"),new d("gn4_07"),new d("gn4_08"),new d("gn4_09"),new d("gn4_10"),new d("gn4_11"),new d("gn4_12"),new d("gn4_13"),new d("gn4_14"),new d("gn4_15"),new d("gn4_16"),new d("gn4_17"),"Chapter 6 - Sammer's Kingdom",new d("wa1_01"),new d("wa1_02"),new d("wa1_03"),new d("wa1_04"),new d("wa2_01"),new d("wa2_02"),new d("wa2_03"),new d("wa3_01"),new d("wa3_02"),new d("wa3_03"),new d("wa4_01"),new d("wa4_02"),new d("wa4_03"),"Chapter 7 - The Underwhere",new d("an1_01"),new d("an1_02"),new d("an1_03"),new d("an1_04"),new d("an1_05"),new d("an1_06"),new d("an1_07"),new d("an1_08"),new d("an1_09"),new d("an1_10"),new d("an1_11"),new d("an2_01"),new d("an2_02"),new d("an2_03"),new d("an2_04"),new d("an2_05"),new d("an2_06"),new d("an2_07"),new d("an2_08"),new d("an2_09"),new d("an2_10"),new d("an3_01"),new d("an3_02"),new d("an3_03"),new d("an3_04"),new d("an3_05"),new d("an3_06"),new d("an3_07"),new d("an3_08"),new d("an3_09"),new d("an3_10"),new d("an3_11"),new d("an3_12"),new d("an3_13"),new d("an3_14"),new d("an3_15"),new d("an3_16"),new d("an4_01"),new d("an4_02"),new d("an4_03"),new d("an4_04"),new d("an4_05"),new d("an4_06"),new d("an4_07"),new d("an4_08"),new d("an4_09"),new d("an4_10"),new d("an4_11"),new d("an4_12"),"Chapter 8 - Castle Bleck",new d("ls1_01"),new d("ls1_02"),new d("ls1_03"),new d("ls1_04"),new d("ls1_05"),new d("ls1_06"),new d("ls1_07"),new d("ls1_08"),new d("ls1_09"),new d("ls1_10"),new d("ls1_11"),new d("ls1_12"),new d("ls2_01"),new d("ls2_02"),new d("ls2_03"),new d("ls2_04"),new d("ls2_05"),new d("ls2_06"),new d("ls2_07"),new d("ls2_08"),new d("ls2_09"),new d("ls2_10"),new d("ls2_11"),new d("ls2_12"),new d("ls2_13"),new d("ls2_14"),new d("ls2_15"),new d("ls2_16"),new d("ls2_17"),new d("ls2_18"),new d("ls3_01"),new d("ls3_02"),new d("ls3_03"),new d("ls3_04"),new d("ls3_05"),new d("ls3_06"),new d("ls3_07"),new d("ls3_08"),new d("ls3_09"),new d("ls3_10"),new d("ls3_11"),new d("ls3_12"),new d("ls3_13"),new d("ls4_01"),new d("ls4_02"),new d("ls4_03"),new d("ls4_04"),new d("ls4_05"),new d("ls4_06"),new d("ls4_07"),new d("ls4_08"),new d("ls4_09"),new d("ls4_10"),new d("ls4_11"),new d("ls4_12"),new d("ls4_13"),"Pit of 100 Trials",new d("dan_01"),new d("dan_02"),new d("dan_03"),new d("dan_04"),new d("dan_11"),new d("dan_12"),new d("dan_13"),new d("dan_14"),new d("dan_21"),new d("dan_22"),new d("dan_23"),new d("dan_24"),new d("dan_30"),new d("dan_41"),new d("dan_42"),new d("dan_43"),new d("dan_44"),new d("dan_61"),new d("dan_62"),new d("dan_63"),new d("dan_64"),new d("dan_70"),"Storybook Pages",new d("mg1_01"),new d("mg2_01"),new d("mg2_02"),new d("mg2_03"),new d("mg2_04"),new d("mg2_05"),new d("mg3_01"),new d("mg3_02"),new d("mg3_03"),new d("mg3_04"),new d("mg3_05"),new d("mg4_01"),"Cutscenes",new d("aa1_01","Outside Mario's House"),new d("aa1_02","Inside Mario's House"),new d("aa2_01","Outside Bowser's Castle"),new d("aa2_02","Inside Bowser's Castle"),new d("aa3_01","The End"),new d("aa4_01","Magic Tome"),new d("go1_01","Game Over (Japanese)"),new d("go1_02","Game Over (English)"),new d("go1_03","Game Over (PAL)"),"Unused Maps",new d("bos_01"),new d("dos_01"),"Cat Adventure Prototype (Korean Exclusive)",new d("kri_00"),new d("kri_01"),new d("kri_02"),new d("kri_03"),new d("kri_04"),new d("kri_05"),new d("kri_06"),new d("kri_07"),new d("kri_08"),new d("kri_09"),new d("kri_10")];t.sceneGroup={id:"spm",name:"Super Paper Mario",sceneDescs:u}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(47)),i=r(a(111)),o=a(69),l=a(0),c=a(9),h=a(10),d=a(1),u=n(a(18)),m=a(2),p=a(7),f=a(33),A=a(55);class g{constructor(e){this.dataFetcher=e,this.filePromiseCache=new Map,this.fileDataCache=new Map}waitForLoad(){const e=[...this.filePromiseCache.values()];return Promise.all(e)}mountNARC(e){for(let t=0;t<e.files.length;t++){const a=e.files[t];this.fileDataCache.set(l.assertExists(a.path),a.buffer)}}fetchFile(e){l.assert(!this.filePromiseCache.has(e));const t=this.dataFetcher.fetchData(`mkds/${e}`);return this.filePromiseCache.set(e,t),t}async fetchNARC(e){const t=await this.fetchFile(e),a=i.parse(s.decompress(t));this.mountNARC(a)}getFileData(e){return this.fileDataCache.has(e)?this.fileDataCache.get(e):null}}class _{constructor(e,t,a){this.courseRenderer=t,this.skyboxRenderer=a,this.renderTarget=new c.BasicRenderTarget,this.renderInstManager=new p.GfxRenderInstManager,this.objectRenderers=[],this.uniformBuffer=new f.GfxRenderDynamicUniformBuffer(e),this.textureHolder=new h.FakeTextureHolder(this.courseRenderer.viewerTextures)}prepareToRender(e,t,a){this.renderInstManager.pushTemplateRenderInst().setUniformBuffer(this.uniformBuffer),this.courseRenderer.prepareToRender(this.renderInstManager,a),null!==this.skyboxRenderer&&this.skyboxRenderer.prepareToRender(this.renderInstManager,a);for(let e=0;e<this.objectRenderers.length;e++)this.objectRenderers[e].prepareToRender(this.renderInstManager,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,c.standardFullClearRenderPassDescriptor);this.renderInstManager.setVisibleByFilterKeyExact(2),this.renderInstManager.drawOnPassRenderer(e,r),e.submitPass(r);const n=this.renderTarget.createRenderPass(e,t.viewport,c.depthClearRenderPassDescriptor);return this.renderInstManager.setVisibleByFilterKeyExact(1),this.renderInstManager.drawOnPassRenderer(e,n),this.renderInstManager.resetRenderInsts(),n}destroy(e){this.renderInstManager.destroy(e),this.renderTarget.destroy(e),this.uniformBuffer.destroy(e),this.courseRenderer.destroy(e),null!==this.skyboxRenderer&&this.skyboxRenderer.destroy(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].destroy(e)}}t.MKDSRenderer=_;const S=d.mat4.create();class b{constructor(e,t){this.id=e,this.name=t}spawnObjectFromNKM(e,t,a,r){function n(e,t=!1){const a=t?0:r.rotationY;m.computeModelMatrixSRT(S,r.scaleX,r.scaleY,r.scaleZ,r.rotationX,a,r.rotationZ,r.translationX,r.translationY,r.translationZ);d.mat4.fromScaling(e.modelMatrix,[50,50,50]),d.mat4.mul(e.modelMatrix,e.modelMatrix,S)}function s(r){const s=l.assertExists(t.getFileData(r)),i=A.parseNSBMD(s);l.assert(1===i.models.length);const c=new o.MDL0Renderer(e,i.models[0],l.assertExists(i.tex0));return n(c),a.objectRenderers.push(c),c}function i(e){return A.parseNSBTA(l.assertExists(t.getFileData(e))).srt0}function c(e){const a=A.parseNSBTP(l.assertExists(t.getFileData(e)));return l.assert(1===a.pat0.length),a.pat0[0]}if(1===r.objectId){s("/MapObj/beach_waterC.nsbmd").modelMatrix[13]+=30}else if(3===r.objectId)s("/MapObj/town_waterC.nsbmd");else if(6===r.objectId)s("/MapObj/yoshi_waterC.nsbmd");else if(9===r.objectId)s("/MapObj/hyudoro_waterC.nsbmd");else if(12===r.objectId){s("/MapObj/mini_stage3_waterC.nsbmd").modelMatrix[13]+=150}else if(13===r.objectId){const e=s("/MapObj/puddle.nsbmd");d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,.01,0])}else if(103===r.objectId){s("/MapObj/woodbox1.nsbmd").modelMatrix[13]+=32}else if(202===r.objectId)null!==t.getFileData("/MapObj/koopa_block.nsbmd")&&s("/MapObj/koopa_block.nsbmd");else if(203===r.objectId)s("/MapObj/gear_black.nsbmd");else if(204===r.objectId)s("/MapObj/bridge.nsbmd");else if(205===r.objectId)s("/MapObj/second_hand.nsbmd");else if(206===r.objectId)s("/MapObj/test_cylinder.nsbmd");else if(207===r.objectId)s("/MapObj/pendulum.nsbmd");else if(208===r.objectId)s("/MapObj/rotary_room.nsbmd");else if(209===r.objectId)s("/MapObj/rotary_bridge.nsbmd");else if(210===r.objectId)s("/MapObj/dram.nsbmd");else if(302===r.objectId)s("/MapObj/BeachTree1.nsbmd");else if(303===r.objectId){const e=s("/MapObj/earthen_pipe1.nsbmd");n(e,!0),e.modelMatrix[13]+=40}else if(304===r.objectId)s("/MapObj/opa_tree1.nsbmd");else if(305===r.objectId){n(s("/MapObj/OlgPipe1.nsbmd"),!0)}else if(306===r.objectId){n(s("/MapObj/OlgMush1.nsbmd"),!0)}else if(307===r.objectId)s("/MapObj/of6yoshi1.nsbmd");else if(308===r.objectId){s("/MapObj/cow.nsbmd")}else if(310===r.objectId){n(s("/MapObj/mini_dokan.nsbmd"),!0)}else if(312===r.objectId)s("/MapObj/GardenTree1.nsbmd");else if(314===r.objectId){n(s("/MapObj/CrossTree1.nsbmd"),!0)}else if(318===r.objectId)s("/MapObj/Bank_Tree1.nsbmd");else if(319===r.objectId)s("/MapObj/GardenTree1.nsbmd");else if(322===r.objectId)s("/MapObj/MarioTree3.nsbmd");else if(325===r.objectId)s("/MapObj/TownTree1.nsbmd");else if(326===r.objectId)s("/MapObj/Snow_Tree1.nsbmd");else if(328===r.objectId){n(s("/MapObj/DeTree1.nsbmd"),!0)}else if(329===r.objectId){n(s("/MapObj/BankEgg1.nsbmd"),!0)}else if(331===r.objectId)s("/MapObj/KinoHouse1.nsbmd");else if(332===r.objectId)s("/MapObj/KinoHouse2.nsbmd");else if(333===r.objectId)s("/MapObj/KinoMount1.nsbmd");else if(334===r.objectId)s("/MapObj/KinoMount2.nsbmd");else if(335===r.objectId)s("/MapObj/olaTree1c.nsbmd");else if(336===r.objectId)s("/MapObj/osaTree1c.nsbmd");else if(339===r.objectId){n(s("/MapObj/om6Tree1.nsbmd"),!0)}else if(340===r.objectId){s("/MapObj/RainStar.nsbmd").bindSRT0(i("/MapObj/RainStar.nsbta"))}else if(342===r.objectId)s("/MapObj/Of6Tree1.nsbmd");else if(343===r.objectId){const t=r.objectArg0;s("/MapObj/TownMonte.nsbmd").bindPAT0(e,c("/MapObj/TownMonte.nsbtp"),function(e){const t=new u.default;return t.setTimeInFrames(e),t}(t))}else if(422===r.objectId){s("/MapObj/ob_pakkun_sf.nsbmd").modelMatrix[13]+=30}else if(424===r.objectId){s("/MapObj/bound.nsbmd").bindPAT0(e,c("/MapObj/bound.nsbtp"))}else if(425===r.objectId){if(null===t.getFileData("/MapObj/flipper.nsbmd"))return;const a=s("/MapObj/flipper.nsbmd");null!==t.getFileData("/MapObj/flipper.nsbtp")&&a.bindPAT0(e,c("/MapObj/flipper.nsbtp")),null!==t.getFileData("/MapObj/flipper.nsbta")&&a.bindSRT0(i("/MapObj/flipper.nsbta")),1===r.objectArg0&&d.mat4.rotateY(a.modelMatrix,a.modelMatrix,9*Math.PI/8)}else if(436===r.objectId)s("/MapObj/cream.nsbmd");else if(437===r.objectId)s("/MapObj/berry.nsbmd");else if(101===r.objectId){const e=s("/itembox.nsbmd");d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,1,0]),d.mat4.rotateY(e.modelMatrix,e.modelMatrix,3.141)}else if(313===r.objectId){s("/MapObj/kamome.nsbmd").bindPAT0(e,c("/MapObj/kamome.nsbtp"))}else if(5===r.objectId){s("/MapObj/water_efct.nsbmd")}else if(324===r.objectId){const e=s("/MapObj/pin1.nsbmd");d.mat4.rotateY(e.modelMatrix,e.modelMatrix,3.141)}else if(401===r.objectId){s("/MapObj/kuribo.nsbmd").bindPAT0(e,c("/MapObj/kuribo.nsbtp"))}else if(409===r.objectId){s("/MapObj/choropu.nsbmd")}else if(403===r.objectId){s("/MapObj/dossun.nsbmd")}else if(408===r.objectId){s("/MapObj/mkd_ef_bubble.nsbmd")}else if(421===r.objectId){const e=s("/MapObj/wanwan.nsbmd");d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,2,0])}else if(411===r.objectId){const e=s("/MapObj/pukupuku.nsbmd");d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,1,0])}else if(413===r.objectId){const e=s("/MapObj/sman_top.nsbmd");s("/MapObj/sman_bottom.nsbmd");d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,1,0])}else if(419===r.objectId){s("/MapObj/move_tree.nsbmd")}else if(320===r.objectId){s("/MapObj/chandelier.nsbmd")}else if(337===r.objectId){s("/MapObj/picture1.nsbmd")}else if(338===r.objectId){s("/MapObj/picture2.nsbmd")}else if(317===r.objectId){const e=s("/MapObj/teresa.nsbmd");d.mat4.rotateY(e.modelMatrix,e.modelMatrix,1.5705),d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,1,0])}else if(423===r.objectId){const e=s("/MapObj/cover.nsbmd");d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,.01,0])}else if(417===r.objectId){s("/MapObj/NsKiller1.nsbmd")}else if(420===r.objectId){const e=s("/MapObj/mkd_ef_burner.nsbmd");e.bindSRT0(i("/MapObj/mkd_ef_burner.nsbta")),d.mat4.rotateY(e.modelMatrix,e.modelMatrix,1.5705)}else if(309===r.objectId){s("/MapObj/NsCannon1.nsbmd")}else if(414===r.objectId){s("/MapObj/kanoke_64.nsbmd")}else if(416===r.objectId){s("/MapObj/basabasa.nsbmd").bindPAT0(e,c("/MapObj/basabasa.nsbtp"))}else if(316===r.objectId){s("/MapObj/bakubaku.nsbmd")}else if(405===r.objectId){s("/MapObj/bus_a.nsbmd")}else if(412===r.objectId){s("/MapObj/truck_a.nsbmd")}else if(410===r.objectId){s("/MapObj/car_a.nsbmd")}else if(426===r.objectId);else if(434===r.objectId){const e=s("/MapObj/sanbo_b.nsbmd"),t=s("/MapObj/sanbo_b.nsbmd"),a=s("/MapObj/sanbo_b.nsbmd"),r=s("/MapObj/sanbo_h.nsbmd");d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,1,0]),d.mat4.translate(t.modelMatrix,t.modelMatrix,[0,2.3,0]),d.mat4.translate(a.modelMatrix,a.modelMatrix,[0,3.6,0]),d.mat4.translate(r.modelMatrix,r.modelMatrix,[0,4.9,0])}else if(429===r.objectId){const e=s("/MapObj/sun.nsbmd");d.mat4.rotateY(e.modelMatrix,e.modelMatrix,3.141)}else if(340===r.objectId){s("/MapObj/RainStar.nsbmd")}else if(402===r.objectId){s("/MapObj/rock.nsbmd")}else if(428===r.objectId){s("/MapObj/crab.nsbmd")}else if(432===r.objectId){s("/MapObj/IronBall.nsbmd")}else if(431===r.objectId);else if(433===r.objectId){s("/MapObj/rock2.nsbmd")}else if(344===r.objectId){s("/MapObj/airship.nsbmd")}else if(107===r.objectId){if(null===t.getFileData("/MapObj/shine16.nsbmd")){const e=s("/MapObj/shine.nsbmd");d.mat4.translate(e.modelMatrix,e.modelMatrix,[0,1,0])}if(null!==t.getFileData("/MapObj/shine16.nsbmd")){const t=s("/MapObj/shine16.nsbmd");t.bindPAT0(e,c("/MapObj/shine16.nsbtp")),d.mat4.translate(t.modelMatrix,t.modelMatrix,[0,1,0])}}}async createScene(e,t){const a=t.dataFetcher,r=new g(a);r.fetchNARC("Main/MapObj.carc"),r.fetchNARC(`Course/${this.id}.carc`),r.fetchNARC(`Course/${this.id}Tex.carc`),await r.waitForLoad();const n=A.parseNSBMD(l.assertExists(r.getFileData("/course_model.nsbmd")));l.assert(1===n.models.length);const s=r.getFileData("/course_model.nsbtx"),i=null!==s?A.parseNSBTX(s):null,c=new o.MDL0Renderer(e,n.models[0],null!==n.tex0?n.tex0:l.assertExists(l.assertExists(i).tex0));let h=null;const d=r.getFileData("/course_model_V.nsbmd");if(null!==d){const t=A.parseNSBMD(d),a=r.getFileData("/course_model_V.nsbtx"),n=null!==a?A.parseNSBTX(a):null;l.assert(1===t.models.length),h=new o.MDL0Renderer(e,t.models[0],null!==n?n.tex0:l.assertExists(t.tex0)),h.isSkybox=!1;const s=r.getFileData("/course_model_V.nsbta");null!==s&&h.bindSRT0(A.parseNSBTA(s).srt0)}const u=new _(e,c,h),m=r.getFileData("/course_model.nsbta");null!==m&&c.bindSRT0(A.parseNSBTA(m).srt0);const p=r.getFileData("/course_model.nsbtp");if(null!==p){const t=A.parseNSBTP(p);l.assert(1===t.pat0.length),c.bindPAT0(e,t.pat0[0])}const f=r.getFileData("/course_map.nkm");if(null!==f){const t=function(e){const t=e.createDataView();l.assert("NKMD"===l.readString(e,0,4)),t.getUint16(4,!0);const a=t.getUint16(6,!0),r=t.getUint32(8,!0);l.assert(0===r);const n=a+r;l.assert("OBJI"===l.readString(e,n+0,4));const s=t.getUint32(n+4,!0);let i=n+8;const o=[];for(let e=0;e<s;e++){const e=A.fx32(t.getInt32(i+0,!0))/16,a=A.fx32(t.getInt32(i+4,!0))/16,r=A.fx32(t.getInt32(i+8,!0))/16,n=.01745*A.fx32(t.getInt32(i+12,!0)),s=.01745*A.fx32(t.getInt32(i+16,!0)),l=.01745*A.fx32(t.getInt32(i+20,!0)),c=A.fx32(t.getInt32(i+24,!0)),h=A.fx32(t.getInt32(i+28,!0)),d=A.fx32(t.getInt32(i+32,!0)),u=t.getUint16(i+36,!0),m=t.getUint16(i+38,!0),p=t.getUint32(i+40,!0),f=t.getUint32(i+44,!0),g=t.getUint32(i+48,!0),_=t.getUint32(i+52,!0),S=t.getUint32(i+56,!0);o.push({objectId:u,routeId:m,objectArg0:p,objectArg1:f,objectArg2:g,objectArg3:_,showInTimeTrials:S,translationX:e,translationY:a,translationZ:r,rotationX:n,rotationY:s,rotationZ:l,scaleX:c,scaleY:h,scaleZ:d}),i+=60}return{obji:o}}(f);u.nkm=t;for(let a=0;a<t.obji.length;a++)this.spawnObjectFromNKM(e,r,u,t.obji[a])}return u}}const v=["Mushroom Cup",new b("cross_course","Figure-8 Circuit"),new b("bank_course","Yoshi Falls"),new b("beach_course","Cheep Cheep Beach"),new b("mansion_course","Luigi's Mansion"),"Flower Cup",new b("desert_course","Desert Hills"),new b("town_course","Delfino Square"),new b("pinball_course","Waluigi Pinball"),new b("ridge_course","Shroom Ridge"),"Star Cup",new b("snow_course","DK Pass"),new b("clock_course","Tick Tock Clock"),new b("mario_course","Mario Circuit"),new b("airship_course","Airship Fortress"),"Special Cup",new b("stadium_course","Wario Stadium"),new b("garden_course","Peach Gardens"),new b("koopa_course","Bowser Castle"),new b("rainbow_course","Rainbow Road"),"Shell Cup",new b("old_mario_sfc","SNES Mario Circuit 1"),new b("old_momo_64","N64 Moo Moo Farm"),new b("old_peach_agb","GBA Peach Cup"),new b("old_luigi_gc","GCN Luigi Circuit"),"Banana Cup",new b("old_donut_sfc","SNES Donut Plains 1"),new b("old_frappe_64","N64 Frappe Snowland"),new b("old_koopa_agb","GBA Bowser Castle 2"),new b("old_baby_gc","GCN Baby Park"),"Leaf Cup",new b("old_noko_sfc","SNES Koopa Beach 2"),new b("old_choco_64","N64 Choco Mountain"),new b("old_luigi_agb","GBA Luigi Circuit"),new b("old_kinoko_gc","GCN Mushroom Bridge"),"Lightning Cup",new b("old_choco_sfc","SNES Choco Island 2"),new b("old_hyudoro_64","N64 Banshee Boardwalk"),new b("old_sky_agb","GBA Sky Garden"),new b("old_yoshi_gc","GCN Yoshi Circuit"),"Battle Stages",new b("mini_stage1","Nintendo DS"),new b("mini_stage2","Twilight House"),new b("mini_stage3","Palm Shore"),new b("mini_stage4","Tart Top"),new b("mini_block_64","N64 Block Fort"),new b("mini_dokan_gc","GCN Pipe Plaza"),"Mission Stages",new b("MR_stage1","Big Bully's Stage; Chief Chilly's Stage"),new b("MR_stage2","Eyerok's Stage; Big Bomb-omb's Stage"),new b("MR_stage3","King Boo's Stage"),"Other",new b("Award","Figure-8 Circuit (Award)"),new b("StaffRoll","Staff Roll"),"Unused Courses",new b("donkey_course","donkey_course (Waluigi Pinball Draft)"),new b("luigi_course","luigi_course (Waluigi Pinball Draft)"),new b("mini_block_course","mini_block_course (GCN Block City)"),new b("MR_stage4","MR_stage4 (GCN Mushroom Bridge Boss)"),new b("old_mario_gc","old_mario_gc (GCN Mario Circuit)"),new b("wario_course","wario_course (Wario Stadium Draft)"),new b("dokan_course","dokan_course"),new b("nokonoko_course","nokonoko_course"),new b("test_circle","test_circle"),new b("test1_course","test1_course"),"Kiosk Demo Courses (Used)",new b("kiosk_cross_course","Figure-Eight Circuit"),new b("kiosk_bank_course","Yoshi Falls"),new b("kiosk_beach_course","Cheep Cheep Beach"),new b("kiosk_mansion_course","Luigi's Mansion"),new b("kiosk_old_mario_sfc","SNES Mario Circuit 1"),"Kiosk Demo Courses (Unused)",new b("kiosk_desert_course","Desert Hills"),new b("kiosk_town_course","Delfino Square"),new b("kiosk_ridge_course","Shroom Ridge"),new b("kiosk_snow_course","DK Pass"),new b("kiosk_mario_course","Mario Circuit"),new b("kiosk_stadium_course","Wario Stadium"),new b("kiosk_old_donut_sfc","SNES Donut Plains 1"),new b("kiosk_old_baby_gc","GCN Baby Park"),new b("kiosk_old_choco_64","N64 Choco Mountain"),new b("kiosk_old_choco_sfc","SNES Choco Island 2"),new b("kiosk_mini_stage1","Nintendo DS"),new b("kiosk_mini_block_64","N64 Block Fort"),new b("kiosk_mini_dokan_gc","GCN Pipe Plaza"),new b("kiosk_donkey_course","donkey_course (DK Pass Draft)"),new b("kiosk_MR_stage1","MR_stage1 (Boss Room Draft)")];t.sceneGroup={id:"mkds",name:"Mario Kart DS",sceneDescs:v}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(69),n=a(0),s=a(1),i=a(9),o=a(10),l=a(7),c=a(33),h=a(55);class d{constructor(e,t){this.objectRenderers=t,this.renderTarget=new i.BasicRenderTarget,this.renderInstManager=new l.GfxRenderInstManager,this.uniformBuffer=new c.GfxRenderDynamicUniformBuffer(e);const a=[];for(let e=0;e<this.objectRenderers.length;e++){const t=this.objectRenderers[e];for(let e=0;e<t.viewerTextures.length;e++)a.push(t.viewerTextures[e])}this.textureHolder=new o.FakeTextureHolder(a)}adjustCameraController(e){e.setSceneMoveSpeedMult(8/60)}prepareToRender(e,t,a){this.renderInstManager.pushTemplateRenderInst().setUniformBuffer(this.uniformBuffer);for(let e=0;e<this.objectRenderers.length;e++)this.objectRenderers[e].prepareToRender(this.renderInstManager,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,i.transparentBlackFullClearRenderPassDescriptor);this.renderInstManager.setVisibleByFilterKeyExact(2),this.renderInstManager.drawOnPassRenderer(e,r),e.submitPass(r);const n=this.renderTarget.createRenderPass(e,t.viewport,i.depthClearRenderPassDescriptor);return this.renderInstManager.setVisibleByFilterKeyExact(1),this.renderInstManager.drawOnPassRenderer(e,n),this.renderInstManager.resetRenderInsts(),n}destroy(e){this.renderInstManager.destroy(e),this.renderTarget.destroy(e),this.uniformBuffer.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].destroy(e)}}t.WorldMapRenderer=d;class u{constructor(e,t,a=""+e){this.worldNumber=e,this.name=t,this.id=a}fetchBMD(e,t){return t.fetchData(e,1).then(e=>0===e.byteLength?null:h.parseNSBMD(e))}fetchBTX(e,t){return t.fetchData(e,1).then(e=>0===e.byteLength?null:h.parseNSBTX(e))}fetchBTA(e,t){return t.fetchData(e,1).then(e=>0===e.byteLength?null:h.parseNSBTA(e))}fetchBTP(e,t){return t.fetchData(e,1).then(e=>0===e.byteLength?null:h.parseNSBTP(e))}async fetchObjectData(e,t){const[a,r,s,i]=await Promise.all([this.fetchBMD(e+".nsbmd",t),this.fetchBTX(e+".nsbtx",t),this.fetchBTA(e+".nsbta",t),this.fetchBTP(e+".nsbtp",t)]);if(null===a)return null;const o=n.assertExists(a),l=r,c=s,h=i;return n.assert(1===o.models.length),new m(o,l,c,h)}createRendererFromData(e,t,a=null){const i=new r.MDL0Renderer(e,t.bmd.models[0],null!==t.btx?n.assertExists(t.btx.tex0):n.assertExists(t.bmd.tex0));return null!==a&&s.mat4.translate(i.modelMatrix,i.modelMatrix,a),s.mat4.scale(i.modelMatrix,i.modelMatrix,[1/16,1/16,1/16]),null!==t.bta&&i.bindSRT0(t.bta.srt0),null!==t.btp&&i.bindPAT0(e,t.btp.pat0[0]),i}createScene(e,t){const a=t.dataFetcher;return Promise.all([this.fetchObjectData(`nsmbds/map/w${this.worldNumber}`,a),this.fetchObjectData(`nsmbds/map/w${this.worldNumber}_tree`,a),this.fetchObjectData("nsmbds/map/w1_castle",a),this.fetchObjectData("nsmbds/map/w8_koppaC",a),this.fetchObjectData("nsmbds/map/w1_tower",a),this.fetchObjectData("nsmbds/map/map_point",a)]).then(([t,a,r,i,o,l])=>{s.mat4.fromTranslation(r.bmd.models[0].nodes[3].jointMatrix,[0,88,0]),s.mat4.fromTranslation(r.bmd.models[0].nodes[4].jointMatrix,[12,88,0]),s.mat4.fromTranslation(i.bmd.models[0].nodes[5].jointMatrix,[-40,0,-19]),s.mat4.fromTranslation(i.bmd.models[0].nodes[6].jointMatrix,[-40,84,-19]),s.mat4.fromTranslation(i.bmd.models[0].nodes[7].jointMatrix,[-26,84,-19]),s.mat4.fromTranslation(i.bmd.models[0].nodes[8].jointMatrix,[40,0,-19]),s.mat4.fromTranslation(i.bmd.models[0].nodes[9].jointMatrix,[40,84,-19]),s.mat4.fromTranslation(i.bmd.models[0].nodes[10].jointMatrix,[54,84,-19]),s.mat4.fromTranslation(o.bmd.models[0].nodes[2].jointMatrix,[0,88,0]),s.mat4.fromTranslation(o.bmd.models[0].nodes[3].jointMatrix,[12,88,0]);const c=p[this.worldNumber-1],h=[],u=this.createRendererFromData(e,n.assertExists(t));h.push(u);let m=null;null!==a&&(m=this.createRendererFromData(e,a),h.push(m));for(let t=0;t<c.length;t++){const a=c[t];if(0==a.type){const t=this.createRendererFromData(e,l,a.position);t.bindPAT0(e,n.assertExists(l.btp).pat0[3]),h.push(t)}else if(1==a.type){const t=this.createRendererFromData(e,l,a.position);t.bindPAT0(e,n.assertExists(l.btp).pat0[2]),h.push(t)}else 2==a.type?h.push(this.createRendererFromData(e,o,a.position)):3==a.type?h.push(this.createRendererFromData(e,r,a.position)):4==a.type&&h.push(this.createRendererFromData(e,i,a.position))}return 1===this.worldNumber?s.mat4.translate(u.modelMatrix,u.modelMatrix,[0,2.5,0]):3===this.worldNumber&&(s.mat4.translate(u.modelMatrix,u.modelMatrix,[30,3,0]),s.mat4.translate(n.assertExists(m).modelMatrix,m.modelMatrix,[-4,0,0])),new d(e,h)})}}class m{constructor(e,t,a,r){this.bmd=e,this.btx=t,this.bta=a,this.btp=r}}const p=[[{type:1,position:[-180,0,0]},{type:2,position:[2,0,-2]},{type:3,position:[34,0,-3]}],[{type:1,position:[-144,0,0]},{type:2,position:[10,0,-2]},{type:3,position:[34,0,-3]}],[{type:1,position:[-400,0,0]},{type:2,position:[-26,0,-2]},{type:3,position:[2,0,-2.5]}],[{type:1,position:[-144,0,0]},{type:2,position:[2,0,-2]},{type:3,position:[34,0,-3]}],[{type:1,position:[-144,0,0]},{type:2,position:[2,0,-2]},{type:3,position:[42,0,-3]}],[{type:1,position:[-144,0,0]},{type:2,position:[2,0,-2]},{type:2,position:[18,0,-2]},{type:3,position:[34,0,-3]}],[{type:1,position:[-144,0,0]},{type:2,position:[6,0,-2]},{type:3,position:[26,0,-3]}],[{type:1,position:[-144,0,0]},{type:2,position:[-2,0,-2]},{type:3,position:[14,0,-3]},{type:2,position:[50,0,-2]},{type:4,position:[66,0,0]}]],f=["World Maps",new u(1,"World 1"),new u(2,"World 2"),new u(3,"World 3"),new u(4,"World 4"),new u(5,"World 5"),new u(6,"World 6"),new u(7,"World 7"),new u(8,"World 8")];t.sceneGroup={id:"nsmbds",name:"New Super Mario Bros DS",sceneDescs:f}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(263)),s=a(10),i=a(265);class o{constructor(e,t=e){this.id=e,this.name=t}createScene(e,t){const a=t.dataFetcher,r=`kh/${this.id}.bin`,o=`kh/${this.id}.img`;return Promise.all([a.fetchData(r),a.fetchData(o)]).then(([t,a])=>{const r=n.parse(t,a),o=[];for(let e=0;e<r.mapTextureBlocks.length;e++)for(let t=0;t<r.mapTextureBlocks[e].textures.length;t++)o.push(i.textureToCanvas(r.mapTextureBlocks[e].textures[t]));for(let e=0;e<r.sky0TextureBlocks.length;e++)for(let t=0;t<r.sky0TextureBlocks[e].textures.length;t++){const a=i.textureToCanvas(r.sky0TextureBlocks[e].textures[t]);a.name=`sky_0_${e}`,o.push(a)}for(let e=0;e<r.sky1TextureBlocks.length;e++)for(let t=0;t<r.sky1TextureBlocks[e].textures.length;t++){const a=i.textureToCanvas(r.sky1TextureBlocks[e].textures[t]);a.name=`sky_1_${e}`,o.push(a)}o.sort((function(e,t){return e.name<t.name?-1:1}));const l=new s.FakeTextureHolder(o);return new i.KingdomHeartsRenderer(e,l,r)})}}t.KingdomHeartsSceneDesc=o;const l=["100 Acre Wood",new o("po00_01","Pooh's House"),new o("po00_02","Rabbit's House"),new o("po00_03","Hunny Tree"),new o("po00_04","Wood: Hill"),new o("po00_05","Wood: Meadow"),new o("po00_06","Bouncing Spot"),new o("po00_07","Muddy Path"),new o("po00_08","Wood: Hill (Night)"),new o("po00_09","100 Acre Wood"),"Agrabah",new o("al00_01","Desert"),new o("al00_02","Agrabah"),new o("al00_03","Agrabah: Storage"),new o("al00_04","Cave: Hall"),new o("al00_05","Treasure Room"),new o("al00_06","Chambers"),new o("al00_07","Cave: Core"),new o("al00_08","Aladdin's House"),new o("al00_09","Cave (Escape)"),"Atlantica",new o("lm00_01","Undersea Valley"),new o("lm00_02","Undersea Gorge"),new o("lm00_03","Sunken Ship"),new o("lm00_04","Ursula's Lair"),new o("lm00_05","Ariel's Grotto"),new o("lm00_06","Triton's Palace"),new o("lm00_07","Triton's Throne"),new o("lm00_08","Ursula (Boss)"),new o("lm00_09","Undersea Valley (Beta)"),"Deep Jungle",new o("tz00_01","Tree House"),new o("tz00_02","Camp"),new o("tz00_03","Jungle: Vines"),new o("tz00_04","Hippo's Lagoon"),new o("tz00_05","Climbing Trees"),new o("tz00_06","Waterfall Cavern"),new o("tz00_07","Jungle: Cliff"),new o("tz00_08","Jungle Slider"),"Destiny Islands",new o("di00_01","Seashore"),new o("di00_02","Cove"),new o("di00_03","Seashore (Sunset)"),new o("di00_04","Seashore (Night)"),new o("di00_05","Secret Place (Night)"),new o("di00_06","Sora's Room"),new o("di00_07","Secret Place"),new o("di00_08","Secret Place (Past)"),"Dive to the Heart",new o("dh00_01","Awakening"),new o("dh00_02","Awakening (Boss)"),new o("dh00_03","Seashore"),"Disney Castle",new o("dc00_01","Audience Chamber"),new o("dc00_02","Courtyard"),new o("dc00_03","Gummi Hangar"),new o("dc00_04","Epilogue"),"End of the World",new o("ew00_01","Gate to the Dark"),new o("ew00_02","Giant Crevasse"),new o("ew00_03","World Terminus"),new o("ew00_04","Traverse Town (World Terminus)"),new o("ew00_05","Wonderland (World Terminus)"),new o("ew00_06","Olympus Coliseum (World Terminus)"),new o("ew00_07","Deep Jungle (World Terminus)"),new o("ew00_08","Agrabah (World Terminus)"),new o("ew00_09","Atlantica (World Terminus)"),new o("ew00_10","Halloween Town (World Terminus)"),new o("ew00_11","Neverland (World Terminus)"),new o("ew00_12","100 Acre Wood (World Terminus)"),new o("ew00_13","Laboratory (World Terminus)"),new o("ew00_14","Volcanic Crater"),new o("ew00_15","Homecoming (Boss)"),new o("ew00_16","Crumbling Island"),new o("ew00_17","Door to Darkness"),new o("ew00_18","The Void (Final Boss)"),new o("ew00_19","Homecoming"),"Halloween Town",new o("nm00_01","Guillotine Square"),new o("nm00_02","Moonlight Hill"),new o("nm00_03","Oogie's Manor"),new o("nm00_04","Torture Chamber"),new o("nm00_05","Manor Ruins"),new o("nm00_06","Evil Playroom"),new o("nm00_07","Research Lab"),"Hollow Bastion",new o("pc00_01","Rising Falls"),new o("pc00_02","Castle Gates"),new o("pc00_03","Great Crest"),new o("pc00_04","High Tower"),new o("pc00_05","Entrance Hall"),new o("pc00_06","Library"),new o("pc00_07","Lift Stop"),new o("pc00_08","Base Level"),new o("pc00_09","Waterway"),new o("pc00_10","Castle Chapel"),new o("pc00_11","Grand Hall"),new o("pc00_12","Castle Chapel (Cutscene)"),"Monstro",new o("pi00_01","Mouth"),new o("pi00_02","Mouth (Revisit)"),new o("pi00_03","Stomach/Throat/Bowels"),new o("pi00_04","Chambers"),"Neverland",new o("pp00_01","Ship: Hold"),new o("pp00_02","Pirate Ship"),new o("pp00_03","Clock Tower"),new o("pp00_04","Clock Tower (Beta)"),"Olympus Coliseum",new o("he00_01","Coliseum Gates"),new o("he00_02","Coliseum: Arena"),new o("he00_03","Coliseum Gates (Night)"),new o("he00_04","Coliseum: Arena (Night)"),new o("he00_05","Coliseum: Arena (Boss)"),"Traverse Town",new o("tw00_01","1st District"),new o("tw00_02","2nd District"),new o("tw00_03","3rd District"),new o("tw00_04","Hotel and Alleyway"),new o("tw00_05","Mystical House"),new o("tw00_06","Item Shop"),new o("tw00_07","Accessory Shop"),new o("tw00_08","Geppetto's House"),new o("tw00_09","Dalmatian's Den"),new o("tw00_10","Gizmo Shop"),new o("tw00_11","Magician's Study"),new o("tw00_12","Secret Waterway"),new o("tw00_14","3rd District (Small House)"),"Wonderland",new o("aw00_01","Rabbit Hole"),new o("aw00_02","Bizarre Room"),new o("aw00_03","Queen's Castle"),new o("aw00_04","Lotus Forest"),new o("aw00_05","Bizarre Room (Right Wall)"),new o("aw00_06","Bizarre Room (Left Wall)"),new o("aw00_07","Bizarre Room (Ceiling)"),new o("aw00_08","Tea Party Garden")];t.sceneGroup={id:"kh",name:"Kingdom Hearts",sceneDescs:l}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(264)),s=a(12),i=a(1);class o{constructor(){this.textureBlock=null,this.textureIndex=-1,this.vtx=[],this.ind=[],this.vcol=[],this.uv=[],this.uvScrollIndex=[]}}t.Submesh=o;class l{constructor(){this.submeshes=[],this.layer=0}}function c(e,t,a){const r=[],n=[],i=[];for(let a=0;a<8;a++)r.push(e.getFloat32(t+16*a,!0)),n.push(e.getFloat32(t+16*a+4,!0)),i.push(e.getFloat32(t+16*a+8,!0));a.boundingBox=new s.AABB(Math.min.apply(null,r),Math.min.apply(null,n),Math.min.apply(null,i),Math.max.apply(null,r),Math.max.apply(null,n),Math.max.apply(null,i)),a.layer=Math.floor(e.getFloat32(t+76,!0))}function h(e,t,a){if(!a)return 0;const r=e.getUint8(t);t+=2;for(let n=0;n<r;n++){a.vtx.push(i.vec3.fromValues(e.getFloat32(t,!0),e.getFloat32(t+4,!0),e.getFloat32(t+8,!0)));const r=e.getFloat32(t+12,!0);if(n>0&&Math.abs(r)>1e-6){const s=2==e.getUint8(t+12);(r<0||s)&&(a.ind.push(n),a.ind.push(n-1),a.ind.push(n-2)),(r>0||s)&&(a.ind.push(n-2),a.ind.push(n-1),a.ind.push(n))}t+=16}return t}function d(e,t,a){if(!a)return 0;const r=e.getUint8(t);t+=2;for(let n=0;n<r;n++)a.vcol.push(i.vec4.fromValues(e.getUint8(t+4*n)/256,e.getUint8(t+4*n+1)/256,e.getUint8(t+4*n+2)/256,e.getUint8(t+4*n+3)/128));return t+4*r}function u(e,t,a){if(!a)return 0;const r=e.getUint8(t),n=(8&e.getUint8(t+1))>0,s=n?8:4;t+=2;for(let o=0;o<r;o++)a.uv.push(i.vec2.fromValues(e.getInt16(t+o*s,!0)/4096,e.getInt16(t+o*s+2,!0)/4096)),a.uvScrollIndex.push(i.vec2.fromValues(n?e.getUint16(t+o*s+4,!0):0,n?e.getUint16(t+o*s+6,!0):0));return t+r*s}function m(e,t,a,r,s){if(5==e.getUint8(t))return function(e,t,a,r,s){let i=0,o=0,l=0,c=0,h=0,d=!0;for(let u=0;u<3;u++){let u=e.getUint8(t);if(5===u){let a=e.getUint8(t+21);54===a?(i=t+104,l=2*e.getUint8(t+52),c=l*e.getUint8(t+56)*2,(16&e.getUint8(t+23))>0&&(d=!1,l/=2,c=Math.floor(c/((4&e.getUint8(t+23))>0?8:4)))):58===a&&(o=t+104);const r=16*(65534&e.getUint16(t+84,!0));t+=r+104}else if(4==u){let u=t+36,m=t+52;e.getUint8(t+44)>e.getUint8(t+60)&&(u=t+52,m=t+36),h=(64&e.getUint8(u+2))>0?4:8;const f=Math.floor(c/l)*(4==h?2:1),A=new n.TextureBlock(l,f,h,-1,i,d);s.push(A);const g=new n.Texture(0,A,o,a.translucent);p(e,m,g),A.textures.push(g),r.textureBlock=A,r.textureIndex=0,t+=68}}return t}(e,t,a,r,s);let i=t+20,o=t+36;e.getUint8(t+28)>e.getUint8(t+44)&&(i=t+36,o=t+20);const l=(128&e.getUint8(i+2))>0?1:0,c=256*e.getUint16(i,!0),h=0==l?c-2490368:c/4,d=128*((16368&e.getUint16(i+4,!0))>>4);let u=null;for(let e=0;e<s.length;e++)if(s[e].bank==l&&s[e].dataOffs==h){u=s[e];break}if(!u){const t=(64&e.getUint8(i+2))>0?4:8,a=0===l&&h>=1048576;u=new n.TextureBlock(8==t?256:512,256,t,l,h,a),s.push(u)}let m=0;for(let e=0;e<u.textures.length&&u.textures[e].colorTableOffs!=d;e++)m++;if(m==u.textures.length){const t=new n.Texture(m,u,d,a.translucent);p(e,o,t),u.textures.push(t)}return r.textureBlock=u,r.textureIndex=m,t+52}function p(e,t,a){a.tiledU=240==(240&e.getUint8(t)),a.tiledV=15==(15&e.getUint8(t+3)),a.tiledU?a.clipRight=16*(1+(15&e.getUint8(t+1)))-1:(a.clipLeft=16*(63&e.getUint8(t+1)),a.clipRight=4*(e.getUint8(t+2)+1)-1),a.tiledV?a.clipBottom=16*(1+((240&e.getUint8(t+3))>>4))-1:(a.clipTop=16*(e.getUint8(t+3)>>4&15),a.clipBottom=4*(1+(e.getUint16(t+4,!0)>>4))-1)}function f(e,t,a,r,n,s){let i=null,l=null,c=-1;for(;t<a;){let a=e.getUint16(t,!0);switch(t+=2,a){case 257:t+=2;break;case 32768:i=new o,n.submeshes.push(i),t+=r?18:22;break;case 32769:t=h(e,t,i);break;case 49154:t=d(e,t,i);break;case 32771:t=u(e,t,i);break;case 4352:t=m(e,t,n,i,s),l=i.textureBlock,c=i.textureIndex;break;case 0:break;case 5888:i.textureBlock||(i.textureBlock=l,i.textureIndex=c);break;default:return void console.error(`VIF parse error: Unknown command ${a.toString(16)} at offset ${t.toString(16)}`)}}}function A(e,t,a,r,n){const s=a?4:2*e.getUint16(t,!0)+2,i=t+(a?128:e.getUint32(t+4,!0)),o=t+(a?0:16),h=s/2;for(let a=0;a<s;a++){const s=a>=h?2*(a-h)+1:2*a,d=16*(268435455&e.getUint32(i+8*s,!0));if(0==d)continue;const u=t+e.getUint32(i+8*s+4,!0),m=u+d,p=new l;if(p.translucent=s%2==1,s>1){c(e,o+128*(Math.floor(s/2)-1),p)}f(e,u,m,0==s,p,n),r.push(p)}}t.Mesh=l,t.parse=function(e,t){const a=e.createDataView(),r=t.createDataView(),s=a.getUint32(24,!0),i=a.getUint32(32,!0),o=a.getUint32(40,!0),l=[],c=[];A(a,s,!1,l,c);const h=[],d=[];A(a,i,!0,h,d);const u=[],m=[];return A(a,o,!0,u,m),function(e,t,a,r,n){const s=e.createDataView(),i=t.createDataView(),o=i.getUint32(24,!0),l=i.getUint32(28,!0),c=i.getUint32(16,!0),h=i.getUint32(20,!0),d=Math.max(0,l-(t.byteLength-o)),u=s.getUint32(24,!0),m=s.getUint32(28,!0),p=t.createDataView(o,l-d),f=t.createDataView(c,h),A=e.createDataView(u+m-d,d);a.forEach((function(e){e.isOvf()?e.build(A,f):e.build(p,f)})),r.forEach((function(e){e.build(s,s)})),n.forEach((function(e){e.build(s,s)}))}(e,t,c,d,m),{mapMeshes:l,mapTextureBlocks:c,mapTextureAtlas:new n.TextureAtlas(c),sky0Meshes:h,sky0TextureBlocks:d,sky1Meshes:u,sky1TextureBlocks:m,uvAnimInfo:function(e,t){const a=e.getUint32(8,!0),r=e.getFloat32(a+52,!0),s=new Float32Array(34);for(let t=0;t<32;++t)s[t+2]=e.getFloat32(a+64+4*t,!0);const i=e.getUint32(0,!0),o=e.getUint32(4,!0)/160;for(let a=0;a<o;++a){const r=i+160*a,s=Math.min(32,e.getUint32(r,!0));if(0==s)continue;const o=e.getUint16(r+4,!0),l=e.getUint16(r+6,!0),c=e.getUint16(r+16,!0),h=(2048&e.getUint16(r+18,!0))>0?1:0,d=0==h?256*c-2490368:256*c/4;let u=null,m=null;for(let e=0;e<t.length&&!m;e++)if(t[e].bank==h&&t[e].dataOffs==d)for(let a=0;a<t[e].textures.length;a++){const r=t[e].textures[a];if(r.clipLeft==o&&r.clipTop==l){u=t[e],m=r;break}}if(!u||!m)continue;const p=e.getUint32(r+24,!0),f=e.getUint32(r+28,!0),A=e.getUint32(r+8,!0),g=new Uint16Array(s),_=new Uint16Array(s);for(let t=0;t<s;t++)g[t]=e.getUint16(r+32+4*t,!0),_[t]=e.getUint16(r+34+4*t,!0);m.spriteAnim=new n.TextureSpriteAnim(u,m,g,_,s,p,f,A)}return{uvScrollTable:s,sky1RotYFactor:r}}(r,c)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1);t.Texture=class{constructor(e,t,a,r){this.index=e,this.parent=t,this.colorTableOffs=a,this.translucent=r,this.clipLeft=0,this.clipRight=0,this.clipTop=0,this.clipBottom=0,this.tiledU=!1,this.tiledV=!1,this.spriteAnim=null}width(){return this.clipRight-this.clipLeft+1}height(){return this.clipBottom-this.clipTop+1}name(){return`${this.parent.bank}_${this.parent.dataOffs.toString(16)}_${this.index}`}pixels(){const e=this.clipRight-this.clipLeft+1,t=this.clipBottom-this.clipTop+1;if(e==this.parent.width&&t==this.parent.height)return new Uint8Array(this.parent.pixels);let a=new Uint8Array(e*t*4);for(let r=0;r<t;r++){const t=4*((r+this.clipTop)*this.parent.width+this.clipLeft),n=r*e*4;a.set(this.parent.pixels.slice(t,t+4*e),n)}return a}};t.TextureBlock=class{constructor(e,t,a,r,n,s){this.width=e,this.height=t,this.bitDepth=a,this.bank=r,this.dataOffs=n,this.deswizzle=s,this.textures=[],this.format=`Indexed${a}`}isOvf(){return 0==this.bank&&this.dataOffs>=1048576}build(e,t){if(this.deswizzle){let t=this.dataOffs;0==this.bank&&(t-=1048576),8==this.bitDepth?n(e,t,this.width,this.height):4==this.bitDepth&&s(e,t,this.width,this.height)}this.pixels=new Uint8Array(this.width*this.height*4),this.textures.forEach(a=>{this.fillFromTexture(a,e,t)})}key(){return`${this.bank}${this.dataOffs}`}fillFromTexture(e,t,a){if(e.colorTableOffs>=a.byteLength)return;let r=this.dataOffs;this.bank>=0&&(r+=1048576*(this.isOvf()?-1:this.bank));const n=4==this.bitDepth?2:1;for(let s=e.clipTop;s<=e.clipBottom;s++)for(let i=e.clipLeft;i<=e.clipRight;i++){const o=s*this.width+i;let l=t.getUint8(r+o/n);l=2==n?15&(i%2==0?l:l>>4):231&l|(8&l)<<1|(16&l)>>1,this.pixels[4*o]=a.getUint8(e.colorTableOffs+4*l),this.pixels[4*o+1]=a.getUint8(e.colorTableOffs+4*l+1),this.pixels[4*o+2]=a.getUint8(e.colorTableOffs+4*l+2),this.pixels[4*o+3]=Math.min(255,2*a.getUint8(e.colorTableOffs+4*l+3))}}};t.TextureAtlas=class{constructor(e){this.width=0,this.height=0,this.pixels=null,this.blockMap=new Map,this._buildAtlas(e)}getTextureBlockPos(e){const t=e.key();return this.blockMap.has(t)?this.blockMap.get(t):null}_buildAtlas(e){const t=e.slice(0).sort((e,t)=>e.bitDepth<t.bitDepth||e.bitDepth==t.bitDepth&&e.dataOffs<t.dataOffs?-1:1);let a=0;for(let e=0;e<t.length;e++)a+=4==t[e].bitDepth?2:1;const r=2*Math.round(Math.sqrt(a)/2),n=Math.floor(a/r)+1;this.width=256*r,this.height=256*n,this.pixels=new Uint8Array(this.width*this.height*4);let s=0;for(let e=0;e<t.length;e++){const a=t[e],n=s%r,i=Math.floor(s/r);this.blockMap.set(a.key(),[n,i]);for(let e=0;e<a.height;e++){const t=e*a.width*4,s=1024*((256*i+e)*r+n);this.pixels.set(a.pixels.slice(t,t+4*a.width),s)}s+=4==t[e].bitDepth?2:1}}};function n(e,t,a,r){const n=a*r,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.getUint8(t+a);for(let r=0;r<n;r++){const n=r%4*4+Math.floor(r/8)%2*2,i=32*Math.floor(r/16)%(4*a)+Math.floor(r/(4*a))*(4*a),o=(Math.floor(r/4)+Math.floor((r+2*a)/(4*a)))%2*16,l=Math.floor(r/(2*a))%2;e.setUint8(t+r,s[n+i+o+l])}}function s(e,t,a,r){if(a<32||r<22)return;const n=a*r/2,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.getUint8(t+a);const i=Math.min(r,128)/16,o=Math.min(4,a/32),l=i*a/128;for(let c=0;c<n;c++){let n=[0,0];for(let e=0;e<2;e++){const t=2*c+e,h=Math.floor(t/32)%o*l*512+Math.floor(t/128)%Math.floor(a/128)*Math.floor(Math.min(r,128)/16)*64+Math.floor(t/(16*l))%2*l*64+Math.floor(t/(64*l))%4*l*128+Math.floor(t/(32*l))%2+t%4*8+2*Math.floor(t%32/8)+32*Math.floor((t+Math.floor(Math.floor(t/(16*l)+2)/4)%2*4)%8/4)+Math.floor(t/(2048*l))*l*2048+Math.floor(t/(256*l))%i*64;let d=s[Math.floor(h/2)];h%2==1&&(d>>=4),n[e]=15&d}e.setUint8(t+c,n[0]|n[1]<<4)}}t.TextureSpriteAnim=class{constructor(e,t,a,r,n,s,i,o){this.numFrames=n,this.spriteWidth=s,this.spriteHeight=i,this.speed=o,this.uAnim=new Float32Array(this.numFrames),this.vAnim=new Float32Array(this.numFrames);for(let n=0;n<this.numFrames;n++)this.uAnim[n]=(a[n]-t.clipLeft)/e.width,this.vAnim[n]=(r[n]-t.clipTop)/e.height}getUVOffset(e,t){const a=Math.floor(.03*e/this.speed)%this.numFrames;return r.vec2.copy(t,[this.uAnim[a],this.vAnim[a]])}},t.deswizzleIndexed8=n,t.deswizzleIndexed4=s},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(266)),i=n(a(11)),o=a(9),l=a(20),c=a(13),h=a(6),d=a(17),u=a(1),m=a(10),p=a(0),f=a(7),A=a(33),g=a(22),_=a(14);t.textureToCanvas=function(e){const t=document.createElement("canvas"),a=e.width(),r=e.height(),n=e.name();t.width=a,t.height=r,t.title=n;const s=t.getContext("2d"),i=s.createImageData(t.width,t.height);i.data.set(e.pixels()),s.putImageData(i,0,0);const o=[t],l=new Map;return l.set("Format",e.parent.format),{name:n,surfaces:o,extraInfo:l}};class S extends l.DeviceProgram{constructor(){super(...arguments),this.both=S.program}}S.a_Position=0,S.a_Color=1,S.a_TexCoord=2,S.a_TexClip=3,S.a_TexRepeat=4,S.a_TexScaleOffs=5,S.a_TexScroll=6,S.ub_SceneParams=0,S.ub_DrawParams=1,S.program=s.default;class b{constructor(e){this.layerIndex=e,this.visible=!0}setVisible(e){this.visible=e}}class v{constructor(){this.firstIndex=0,this.indexCount=0,this.textureIndex=0,this.translucent=!1,this.cullBackfaces=!0,this.rotYFactor=0,this.layer=null,this.spriteAnim=null}}class w{constructor(e,t){this.textures=[],this.layers=[],this.mapDrawCalls=[],this.skyboxDrawCalls=[],this.vertices=0,this.indices=0,this.textures.push(this.translateTextureFromAtlas(e,t.mapTextureAtlas));const a=new Map;for(let r=0;r<t.sky0TextureBlocks.length;r++)this.textures.push(this.translateTexture(e,t.sky0TextureBlocks[r].textures[0])),a.set(t.sky0TextureBlocks[r].dataOffs,r+1);for(let r=0;r<t.sky1TextureBlocks.length;r++)this.textures.push(this.translateTexture(e,t.sky1TextureBlocks[r].textures[0])),a.set(t.sky1TextureBlocks[r].dataOffs,t.sky0TextureBlocks.length+r+1);this.sampler=this.createSampler(e);const r=[],n=[];this.mapDrawCalls=this.createBatchedDrawCalls(!1,t.mapMeshes,a,r,n),n.sort((e,t)=>e.layerIndex<t.layerIndex?-1:1),n.forEach(e=>{e.name=`map_${e.layerIndex}`});const s=[],i=this.createBatchedDrawCalls(!0,t.sky0Meshes,a,r,s);s[0].name="sky_0";const o=[],l=this.createBatchedDrawCalls(!0,t.sky1Meshes,a,r,o);o[0].name="sky_1",this.layers.push(s[0]),this.layers.push(o[0]);for(let e=0;e<n.length;e++)this.layers.push(n[e]);for(let e=0;e<i.length;e++)i[e].cullBackfaces=!1,i[e].translucent=!0,this.skyboxDrawCalls.push(i[e]);for(let e=0;e<l.length;e++)l[e].rotYFactor=t.uvAnimInfo.sky1RotYFactor,l[e].translucent=!0,this.skyboxDrawCalls.push(l[e]);const c=new Float32Array(21*this.vertices),m=new Uint32Array(this.indices);let p=0,f=0,A=0;r.forEach((function(e){if(null!=e.textureBlock){for(let a=0;a<e.vtx.length;a++){const r=u.vec4.create();r.set([1,1,0,0]);const n=t.mapTextureAtlas.getTextureBlockPos(e.textureBlock);n&&r.set([e.textureBlock.width/t.mapTextureAtlas.width,e.textureBlock.height/t.mapTextureAtlas.height,256*n[0]/t.mapTextureAtlas.width,256*n[1]/t.mapTextureAtlas.height]);const s=e.textureBlock.textures[e.textureIndex],i=u.vec4.create();let o=s.clipRight,l=s.clipBottom;const h=e.textureBlock.textures[e.textureIndex].spriteAnim;h&&(o=s.clipLeft+h.spriteWidth-1,l=s.clipTop+h.spriteHeight-1),i.set([(s.clipLeft+.5)/e.textureBlock.width,(o+.5)/e.textureBlock.width,(s.clipTop+.5)/e.textureBlock.height,(l+.5)/e.textureBlock.height]);const d=u.vec2.create();d.set([s.tiledU?e.textureBlock.width/s.width():.5,s.tiledV?e.textureBlock.height/s.height():.5]),c[p++]=e.vtx[a][0],c[p++]=e.vtx[a][1],c[p++]=e.vtx[a][2],c[p++]=e.vcol[a][0],c[p++]=e.vcol[a][1],c[p++]=e.vcol[a][2],c[p++]=e.vcol[a][3],c[p++]=e.uv[a][0],c[p++]=e.uv[a][1],c[p++]=i[0],c[p++]=i[1],c[p++]=i[2],c[p++]=i[3],c[p++]=d[0],c[p++]=d[1],c[p++]=r[0],c[p++]=r[1],c[p++]=r[2],c[p++]=r[3],c[p++]=t.uvAnimInfo.uvScrollTable[2*e.uvScrollIndex[a][0]],c[p++]=t.uvAnimInfo.uvScrollTable[2*e.uvScrollIndex[a][1]+1]}for(let t=0;t<e.ind.length;t++)m[f++]=e.ind[t]+A;A+=e.vtx.length}})),this.vertexBuffer=d.makeStaticDataBuffer(e,2,c.buffer),this.indexBuffer=d.makeStaticDataBuffer(e,1,m.buffer);const g=[{location:S.a_Position,bufferIndex:0,format:h.GfxFormat.F32_RGB,bufferByteOffset:0},{location:S.a_Color,bufferIndex:0,format:h.GfxFormat.F32_RGBA,bufferByteOffset:12},{location:S.a_TexCoord,bufferIndex:0,format:h.GfxFormat.F32_RG,bufferByteOffset:28},{location:S.a_TexClip,bufferIndex:0,format:h.GfxFormat.F32_RGBA,bufferByteOffset:36},{location:S.a_TexRepeat,bufferIndex:0,format:h.GfxFormat.F32_RG,bufferByteOffset:52},{location:S.a_TexScaleOffs,bufferIndex:0,format:h.GfxFormat.F32_RGBA,bufferByteOffset:60},{location:S.a_TexScroll,bufferIndex:0,format:h.GfxFormat.F32_RG,bufferByteOffset:76}];this.inputLayout=e.createInputLayout({indexBufferFormat:h.GfxFormat.U32_R,vertexAttributeDescriptors:g,vertexBufferDescriptors:[{byteStride:84,frequency:1}]}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}createBatchedDrawCalls(e,t,a,r,n){const s=new Map,i=[],o=new Map,l=[];let c=-1;for(let e=0;e<t.length;e++){const r=t[e].layer;s.has(r)||s.set(r,new b(r));for(let n=0;n<t[e].submeshes.length;n++){const s=t[e].submeshes[n];if(null==s.textureBlock)continue;let h=-1;const d=s.textureBlock.textures[s.textureIndex];d.spriteAnim&&(h=i.indexOf(d.spriteAnim),h<0&&(i.push(d.spriteAnim),h=i.length-1)),d.spriteAnim&&i.includes(d.spriteAnim);let u=0;s.textureBlock.bank<0&&a.has(s.textureBlock.dataOffs)&&(u=a.get(s.textureBlock.dataOffs));const m={layerIndex:r,textureIndex:u,spriteAnimIndex:h},p=JSON.stringify(m);t[e].translucent?c>=0&&l[c][0]==p?l[c][1].push(s):(l.push([p,[s]]),c++):(o.has(p)||o.set(p,[]),o.get(p).push(s))}}s.forEach(e=>{n.push(e)});const h=[];return o.forEach((e,t)=>{const a=JSON.parse(t),n=this.createDrawCall(a,!1,s,i);n.firstIndex=this.indices,e.forEach(e=>{r.push(e),this.vertices+=e.vtx.length,this.indices+=e.ind.length}),n.indexCount=this.indices-n.firstIndex,h.push(n)}),l.forEach(e=>{const t=JSON.parse(e[0]),a=this.createDrawCall(t,!0,s,i);a.firstIndex=this.indices,e[1].forEach(e=>{r.push(e),this.vertices+=e.vtx.length,this.indices+=e.ind.length}),a.indexCount=this.indices-a.firstIndex,h.push(a)}),h}createDrawCall(e,t,a,r){const n=new v;return a.has(e.layerIndex)&&(n.layer=a.get(e.layerIndex)),e.spriteAnimIndex>=0&&(n.spriteAnim=r[e.spriteAnimIndex]),n.textureIndex=e.textureIndex,n.translucent=t,n}translateTexture(e,t){const a=t.clipRight-t.clipLeft+1,r=t.clipBottom-t.clipTop+1,n=e.createTexture(h.makeTextureDescriptor2D(h.GfxFormat.U8_RGBA_NORM,a,r,1));e.setResourceName(n,t.name());const s=e.createHostAccessPass();return s.uploadTextureData(n,0,[t.pixels()]),e.submitPass(s),n}translateTextureFromAtlas(e,t){const a=e.createTexture(h.makeTextureDescriptor2D(h.GfxFormat.U8_RGBA_NORM,t.width,t.height,1)),r=e.createHostAccessPass();return r.uploadTextureData(a,0,[p.assertExists(t.pixels)]),e.submitPass(r),a}createSampler(e){return e.createSampler({wrapS:1,wrapT:1,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:0})}destroy(e){for(let t=0;t<this.textures.length;t++)e.destroyTexture(this.textures[t]);e.destroySampler(this.sampler),e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}t.MapData=w;const x=u.mat4.create(),T=u.vec2.create();class y{constructor(e,t,a){this.mapData=e,this.drawCall=t,this.drawCallIndex=a,this.vertexColorsEnabled=!0,this.texturesEnabled=!0,this.textureMappings=p.nArray(1,()=>new m.TextureMapping),this.gfxProgram=null,this.createProgram(),this.megaStateFlags={},t.cullBackfaces||(this.megaStateFlags.cullMode=0),t.translucent&&(_.setAttachmentStateSimple(this.megaStateFlags,{blendMode:h.GfxBlendMode.ADD,blendSrcFactor:h.GfxBlendFactor.SRC_ALPHA,blendDstFactor:h.GfxBlendFactor.ONE_MINUS_SRC_ALPHA}),this.megaStateFlags.depthWrite=!1);const r=this.textureMappings[0];r.gfxTexture=e.textures[t.textureIndex],r.gfxSampler=e.sampler}prepareToRender(e,t,a,r,n){if(!this.drawCall.layer.visible)return;const s=t.pushRenderInst();s.setInputLayoutAndState(this.mapData.inputLayout,this.mapData.inputState),s.sortKey=this.drawCallIndex,null===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program)),s.setGfxProgram(this.gfxProgram),s.setMegaStateFlags(this.megaStateFlags),s.setSamplerBindingsFromTextureMappings(this.textureMappings),s.drawIndexes(this.drawCall.indexCount,this.drawCall.firstIndex),u.mat4.copy(x,r),a&&(x[12]=n.camera.worldMatrix[12],x[13]=n.camera.worldMatrix[13],x[14]=n.camera.worldMatrix[14],u.mat4.rotateY(x,x,this.drawCall.rotYFactor*n.time/(6*Math.PI)));let i=s.allocateUniformBuffer(S.ub_DrawParams,32);const o=s.mapUniformBufferF32(S.ub_DrawParams);i+=c.fillMatrix4x4(o,i,x),i+=c.fillMatrix4x3(o,i,n.camera.viewMatrix),this.drawCall.spriteAnim&&(this.drawCall.spriteAnim.getUVOffset(n.time,T),o[i++]=T[0],o[i++]=T[1])}setVertexColorsEnabled(e){this.vertexColorsEnabled=e,this.createProgram()}setTexturesEnabled(e){this.texturesEnabled=e,this.createProgram()}createProgram(){const e=new S;this.vertexColorsEnabled&&e.defines.set("USE_VERTEX_COLOR","1"),this.texturesEnabled&&e.defines.set("USE_TEXTURE","1"),this.drawCall.translucent||e.defines.set("USE_ALPHA_MASK","1"),this.gfxProgram=null,this.program=e}}const C=[{numUniformBuffers:2,numSamplers:1}];class M{constructor(e,t,a,r){this.isSkybox=r,this.drawCallInstances=[],this.megaStateFlags={cullMode:2,depthWrite:!0,depthCompare:g.reverseDepthForCompareMode(h.GfxCompareMode.LEQUAL)};for(let e=0;e<a.length;e++)this.drawCallInstances.push(new y(t,a[e],e));this.worldTransform=u.mat4.create(),u.mat4.rotateZ(this.worldTransform,this.worldTransform,Math.PI)}prepareToRender(e,t,a){const r=t.pushTemplateRenderInst();r.setBindingLayouts(C),r.setMegaStateFlags(this.megaStateFlags),r.filterKey=this.isSkybox?2:1,a.camera.setClipPlanes(20,5e6);let n=r.allocateUniformBuffer(S.ub_SceneParams,20);const s=r.mapUniformBufferF32(S.ub_SceneParams);n+=c.fillMatrix4x4(s,n,a.camera.projectionMatrix),s[n]=a.time;for(let r=0;r<this.drawCallInstances.length;r++)this.drawCallInstances[r].prepareToRender(e,t,this.isSkybox,this.worldTransform,a);t.popTemplateRenderInst()}setVertexColorsEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setVertexColorsEnabled(e)}setTexturesEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setTexturesEnabled(e)}}t.SceneRenderer=M;t.KingdomHeartsRenderer=class{constructor(e,t,a){this.textureHolder=t,this.renderInstManager=new f.GfxRenderInstManager,this.renderTarget=new o.BasicRenderTarget,this.sceneRenderers=[],this.mapData=new w(e,a),this.uniformBuffer=new A.GfxRenderDynamicUniformBuffer(e);const r=new M(e,this.mapData,this.mapData.mapDrawCalls,!1);this.sceneRenderers.push(r);const n=new M(e,this.mapData,this.mapData.skyboxDrawCalls,!0);this.sceneRenderers.push(n)}createPanels(){const e=new i.Panel;e.customHeaderBackgroundColor=i.COOL_BLUE_COLOR,e.setTitle(i.RENDER_HACKS_ICON,"Render Hacks");const t=new i.Checkbox("Enable Vertex Colors",!0);t.onchanged=()=>{this.sceneRenderers.forEach(e=>{e.setVertexColorsEnabled(t.checked)})},e.contents.appendChild(t.elem);const a=new i.Checkbox("Enable Textures",!0);return a.onchanged=()=>{this.sceneRenderers.forEach(e=>{e.setTexturesEnabled(a.checked)})},e.contents.appendChild(a.elem),[e,new i.LayerPanel(this.mapData.layers)]}prepareToRender(e,t,a){this.renderInstManager.pushTemplateRenderInst().setUniformBuffer(this.uniformBuffer);for(let t=0;t<this.sceneRenderers.length;t++)this.sceneRenderers[t].prepareToRender(e,this.renderInstManager,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,o.transparentBlackFullClearRenderPassDescriptor);f.executeOnPass(this.renderInstManager,e,r,2),e.submitPass(r);const n=this.renderTarget.createRenderPass(e,t.viewport,o.depthClearRenderPassDescriptor);return f.executeOnPass(this.renderInstManager,e,n,1),this.renderInstManager.resetRenderInsts(),n}destroy(e){this.renderInstManager.destroy(e),this.renderTarget.destroy(e),this.uniformBuffer.destroy(e),this.textureHolder.destroy(e),this.mapData.destroy(e)}}},function(e,t,a){"use strict";a.r(t),t.default="\nprecision mediump float;\n\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n    float u_Time;\n};\n\nlayout(row_major, std140) uniform ub_DrawParams {\n    Mat4x4 u_Model;\n    Mat4x3 u_View;\n    vec4 u_AnimOffset;\n};\n\nuniform sampler2D u_Texture;\n\nvarying vec4 v_Color;\nvarying vec2 v_TexCoord;\nvarying vec4 v_TexClip;\nvarying vec2 v_TexRepeat;\nvarying vec4 v_TexScaleOffset;\nvarying vec2 v_TexScroll;\n\n#ifdef VERT\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec4 a_Color;\nlayout(location = 2) in vec2 a_TexCoord;\nlayout(location = 3) in vec4 a_TexClip;\nlayout(location = 4) in vec2 a_TexRepeat;\nlayout(location = 5) in vec4 a_TexScaleOffset;\nlayout(location = 6) in vec2 a_TexScroll;\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_View), Mul(u_Model, vec4(a_Position, 1.0))));\n    v_Color = a_Color;\n    v_TexCoord = a_TexCoord;\n    v_TexClip = a_TexClip;\n    v_TexRepeat = a_TexRepeat;\n    v_TexScaleOffset = a_TexScaleOffset;\n    v_TexScroll = a_TexScroll;\n}\n#endif\n\n#ifdef FRAG\nvoid main() {\n    vec4 t_Color = vec4(0.5, 0.5, 0.5, 1);\n\n#ifdef USE_TEXTURE\n    vec2 tc = v_TexCoord;\n    tc += v_TexScroll * u_Time * 0.000005f + u_AnimOffset.xy;\n    tc = fract(tc * v_TexRepeat) / v_TexRepeat;\n    tc = clamp(tc, v_TexClip.xz + u_AnimOffset.xy, v_TexClip.yw + u_AnimOffset.xy);\n    tc = tc * v_TexScaleOffset.xy + v_TexScaleOffset.zw;\n    t_Color = texture(u_Texture, tc);\n#endif\n\n#ifdef USE_VERTEX_COLOR\n    t_Color.rgb *= v_Color.rgb * 2.0f;\n    t_Color.a *= v_Color.a;\n#endif\n\n#ifdef USE_ALPHA_MASK\n    if (t_Color.a < 0.125) {\n        discard;\n    }\n#endif\n\n    gl_FragColor = t_Color;\n}\n#endif\n"},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(268)),s=a(10),i=a(269);class o{constructor(e,t=e){this.id=e,this.name=t}async createScene(e,t){const a=t.dataFetcher,r=await a.fetchData(`kh2fm/${this.id}.map`),o=n.parseMap(r),l=[];for(const e of o.mapGroup.textureBlocks)for(const t of e.textures)l.push(i.textureToCanvas(t,"map")),t.textureAnim&&l.push(i.textureAnimationToCanvas(t.textureAnim,t,"map"));for(const e of o.sky0Group.textureBlocks)for(const t of e.textures)l.push(i.textureToCanvas(t,"sky0")),t.textureAnim&&l.push(i.textureAnimationToCanvas(t.textureAnim,t,"sky0"));for(const e of o.sky1Group.textureBlocks)for(const t of e.textures)l.push(i.textureToCanvas(t,"sky1")),t.textureAnim&&l.push(i.textureAnimationToCanvas(t.textureAnim,t,"sky1"));l.sort((function(e,t){return e.name<t.name?-1:1}));const c=new s.FakeTextureHolder(l);return new i.KingdomHeartsIIRenderer(e,c,o)}}t.KingdomHeartsIISceneDesc=o;const l=["100 Acre Wood",new o("po00","The Hundred Acre Wood"),new o("po01","Starry Hill"),new o("po02","Pooh Bear's House"),new o("po03","Rabbit's House"),new o("po04","Piglet's House"),new o("po05","Kanga's House"),new o("po06","A Blustery Rescue"),new o("po07","Hunny Slider"),new o("po08","Balloon Bounce"),new o("po09","The Spooky Cave"),"Agrabah",new o("al00","Agrabah"),new o("al01","Bazaar"),new o("al02","The Peddler's Shop"),new o("al03","Palace Gates"),new o("al04","Palace Dungeon"),new o("al05","Agrabah (Boss)"),new o("al06","Palace Walls"),new o("al07","Cave of Wonders: Entrance"),new o("al09","Stone Guardians"),new o("al10","Treasure Room"),new o("al11","Ruined Chamber"),new o("al12","Valley of Stone"),new o("al13","Chasm of Challenges"),new o("al14","Sandswept Ruins"),new o("al15","The Peddler's Shop (Gold)"),"Atlantica",new o("lm00","Triton's Throne"),new o("lm01","Ariel's Grotto"),new o("lm02","Undersea Courtyard"),new o("lm03","Undersea Courtyard (Night)"),new o("lm04","Stage"),new o("lm05","Sunken Ship"),new o("lm06","The Shore"),new o("lm07","The Shore (Night)"),new o("lm08","The Shore (Sunset)"),new o("lm09","Wrath of the Sea"),new o("lm10","Wedding Ship"),"Beast's Castle",new o("bb00","Entrance Hall"),new o("bb01","Parlor"),new o("bb02","Belle's Room"),new o("bb03","Beast's Room"),new o("bb04","Ballroom"),new o("bb05","Ballroom (Boss)"),new o("bb06","Courtyard"),new o("bb07","The East Wing"),new o("bb08","The West Hall"),new o("bb09","The West Wing"),new o("bb10","Dungeon"),new o("bb11","Undercroft"),new o("bb12","Secret Passage"),new o("bb13","Bridge"),new o("bb14","Ballroom (Cutscene)"),new o("bb15","Bridge (Boss)"),"Destiny Islands",new o("di00","Secret Place"),new o("di01","Destiny Islands (Hill)"),new o("di02","Destiny Islands (Shore)"),"Disney Castle",new o("dc00","Audience Chamber"),new o("dc01","Library"),new o("dc02","Colonnade"),new o("dc03","Courtyard"),new o("dc04","Hall of the Cornerstone"),new o("dc05","Hall of the Cornerstone (Light)"),new o("dc06","Gummi Hangar"),new o("dc07","Lingering Will"),"Dive to the Heart",new o("tt32","Station of Serenity"),new o("tt33","Station of Calling"),new o("tt34","Station of Awakening"),"Halloween Town",new o("nm00","Halloween Town Square"),new o("nm01","Dr. Finkelstein's Lab"),new o("nm02","Graveyard"),new o("nm03","Curly Hill"),new o("nm04","Hinterlands"),new o("nm05","Yuletide Hill"),new o("nm06","Candy Cane Lane"),new o("nm07","Christmas Tree Plaza"),new o("nm08","Santa's House"),new o("nm09","Toy Factory: Shipping and Receiving"),new o("nm10","Toy Factory: The Wrapping Room"),"Hollow Bastion",new o("hb00","Villain's Vale"),new o("hb01","The Dark Depths"),new o("hb02","The Great Maw"),new o("hb03","Crystal Fissure"),new o("hb04","Castle Gate"),new o("hb05","Ansem's Study"),new o("hb06","Postern"),new o("hb07","Restoration Site"),new o("hb08","Bailey"),new o("hb09","Borough"),new o("hb10","Marketplace"),new o("hb11","Corridors"),new o("hb12","Hearless Manufactory"),new o("hb13","Merlin's House"),new o("hb14","Castle Oblivion"),new o("hb15","Ansem's Study (Past)"),new o("hb16","Ravine Trail"),new o("hb17","The Great Maw"),new o("hb18","Restoration Site"),new o("hb19","Bailey (Damaged)"),new o("hb20","Corridors (Cutscene)"),new o("hb21","Cavern of Remembrance: Depths"),new o("hb22","Cavern of Remembrance: Mining Area"),new o("hb23","Cavern of Remembrance: Engine Chamber"),new o("hb24","Cavern of Remembrance: Mineshaft"),new o("hb25","Transport to Remembrance"),new o("hb26","Garden of Assemblage"),new o("hb27","Chamber of Repose"),new o("hb32","The Old Mansion"),new o("hb33","Data Battle Arena"),new o("hb34","Destiny Islands Remnants"),new o("hb38","Station of Oblivion"),"The Land of Dragons",new o("mu00","Bamboo Grove"),new o("mu01","Encampment"),new o("mu02","Checkpoint"),new o("mu03","Mountain Trail"),new o("mu04","Village"),new o("mu05","Village Cave"),new o("mu06","Ridge"),new o("mu07","Summit"),new o("mu08","Imperial Square"),new o("mu09","Palace Gate"),new o("mu10","Antechamber"),new o("mu11","Throne Room"),new o("mu12","Village (Burned)"),"Mysterious Tower",new o("tt25","The Tower"),new o("tt26","Tower: Entryway"),new o("tt27","Tower: Sorcerer's Loft"),new o("tt28","Tower: Wardrobe"),new o("tt29","Tower: Star Chamber"),new o("tt30","Tower: Moon Chamber"),new o("tt31","Tower: Wayward Stairs"),new o("tt38","Tower: Wayward Stairs"),new o("tt39","Tower: Wayward Stairs"),"Olympus Coliseum",new o("he00","The Coliseum"),new o("he01","Coliseum Gates"),new o("he02","Coliseum Gates (Ruins)"),new o("he03","Underworld Entrance"),new o("he04","Coliseum Foyer"),new o("he05","Valley of the Dead"),new o("he06","Hades' Chamber"),new o("he07","Cave of the Dead: Entrance"),new o("he08","Well of Captivity"),new o("he09","The Underdrome"),new o("he10","Cave of the Dead: Inner Chamber"),new o("he11","Underworld Caverns: Entrance"),new o("he12","The Lock"),new o("he13","The Underdrome"),new o("he14","Coliseum Gates (Ruins, Night)"),new o("he15","Cave of the Dead: Passage"),new o("he16","Underworld Caverns: The Lost Road"),new o("he17","Underworld Caverns: Atrium"),new o("he18","Coliseum Gates (Ruins)"),new o("he19","The Underdrome"),"Port Royal",new o("ca00","Rampart"),new o("ca01","Harbor"),new o("ca02","Town"),new o("ca03","The Interceptor"),new o("ca04","The Interceptor: Ship's Hold"),new o("ca05","The Black Pearl"),new o("ca06","The Black Pearl: Captain's Stateroom"),new o("ca07","The Interceptor"),new o("ca08","Isla de Muerta: Rock Face"),new o("ca09","Isla de Muerta: Cave Mouth"),new o("ca10","Isla de Muerta: Treasure Heap"),new o("ca11","Ship Graveyard: The Interceptor's Hold"),new o("ca12","Isla de Muerta: Powder Store"),new o("ca13","Isla de Muerta: Moonlight Nook"),new o("ca14","Ship Graveyard: Seadrift Keep"),new o("ca15","Ship Graveyard: Seadrift Row"),new o("ca16","Isla de Muerta: Rock Face"),new o("ca17","Isla de Muerta: Treasure Heap (Cutscene)"),new o("ca18","The Black Pearl"),new o("ca19","The Black Pearl"),new o("ca20","The Black Pearl"),new o("ca21","The Black Pearl"),new o("ca22","The Black Pearl"),new o("ca23","The Black Pearl: Captain's Stateroom (Cutscene)"),new o("ca24","Harbor"),new o("ca25","Isla de Muerta: Rock Face"),"Pride Lands",new o("lk00","Pride Rock"),new o("lk01","Stone Hollow"),new o("lk02","The King's Den"),new o("lk03","Wildebeest Valley"),new o("lk04","The Savannah"),new o("lk05","Elephant Graveyard"),new o("lk06","Gorge"),new o("lk07","Wastelands"),new o("lk08","Jungle"),new o("lk09","Oasis"),new o("lk10","Pride Rock (Ending)"),new o("lk11","Oasis (Night)"),new o("lk12","Cliff Edge"),new o("lk13","Peak"),new o("lk14","Peak (Boss)"),new o("lk15","Savannah (Boss)"),new o("lk16","Wildebeest Valley (Past)"),"Realm of Darkness",new o("es00","Dark Meridian"),new o("es01","es01"),"Space Paranoids",new o("tr00","Pit Cell"),new o("tr01","Canyon"),new o("tr02","Light Cycle"),new o("tr03","Dataspace"),new o("tr04","I/O Tower: Hallway"),new o("tr05","I/O Tower: Communications Room"),new o("tr06","Simulation Hangar"),new o("tr07","Solar Sailer Simulation"),new o("tr08","Central Computer Mesa"),new o("tr09","Central Computer Core"),new o("tr10","Simulation Hangar"),new o("tr11","Central Computer Mesa"),"Timeless River",new o("wi00","Cornerstone Hill"),new o("wi01","Pier"),new o("wi02","Waterway"),new o("wi03","Wharf"),new o("wi04","Lilliput"),new o("wi05","Building Site"),new o("wi06","Scene of the Fire"),new o("wi07","Mickey's House"),new o("wi08","Villain's Vale"),"Twilight Town",new o("tt00","Realm of Nothingness"),new o("tt01","Roxas' Room"),new o("tt02","The Usual Spot"),new o("tt03","Back Alley"),new o("tt04","Sandlot"),new o("tt05","Sandlot (Struggle)"),new o("tt06","Market Street: Station Heights"),new o("tt07","Market Street: Tram Common"),new o("tt08","Station Plaza"),new o("tt09","Central Station"),new o("tt10","Sunset Terrace"),new o("tt11","Sunset Station"),new o("tt12","Sunset Hill"),new o("tt13","The Woods"),new o("tt14","The Old Mansion"),new o("tt15","Mansion: Foyer"),new o("tt16","Mansion: Dining Room"),new o("tt17","Mansion: Library"),new o("tt18","Mansion: The White Room"),new o("tt19","Mansion: Basement Hall"),new o("tt20","Mansion: Basement Hall"),new o("tt21","Mansion: Computer Room"),new o("tt22","Mansion: Basement Corridor"),new o("tt23","Mansion: Pod Room"),new o("tt24","Train (Twilight Town)"),new o("tt35","Train (Space)"),new o("tt36","Tunnelway"),new o("tt37","Underground Concourse"),new o("tt40","Betwixt and Between"),new o("tt41","The Old Mansion"),"The World That Never Was",new o("eh00","Where Nothing Gathers"),new o("eh01","Alley to Between"),new o("eh02","Fragment Crossing"),new o("eh03","Memory's Skyscraper"),new o("eh04","The Brink of Despair"),new o("eh05","Soundless Prison"),new o("eh06","Nothing's Call"),new o("eh07","Crooked Ascension"),new o("eh08","Crooked Ascension"),new o("eh09","Twilight's View"),new o("eh10","Hall of Empty Melodies"),new o("eh11","Hall of Empty Melodies"),new o("eh12","Naught's Skyway"),new o("eh13","Proof of Existence"),new o("eh14","Havoc's Divide"),new o("eh15","Addled Impasse"),new o("eh16","Naught's Approach"),new o("eh17","Ruin and Creation's Passage"),new o("eh18","The Altar of Naught"),new o("eh19","Memory's Contortion"),new o("eh20","Realm of Nothingness (Final Boss)"),new o("eh21","Dive to the Heart (Roxas)"),new o("eh22","Xemnas: Dragon"),new o("eh23","Xemnas: Armor II"),new o("eh24","Xemnas: Armor"),new o("eh25","Xemnas: Energy Core"),new o("eh26","Xemnas: Cannons"),new o("eh27","Xemnas: City"),new o("eh28","Xemnas: City II"),new o("eh29","The Altar of Naught (Pre-Boss)"),"Gummi Missions",new o("gm00","Asteroid Sweep"),new o("gm01","Stardust Sweep"),new o("gm02","Broken Highway"),new o("gm03","Ancient Highway"),new o("gm04","Phantom Storm"),new o("gm05","Sunlight Storm"),new o("gm06","Splash Island"),new o("gm07","Floating Island"),new o("gm08","Assault of the Dreadnought"),"World Map",new o("wm00","World Map")];t.sceneGroup={id:"kh2fm",name:"Kingdom Hearts II Final Mix",sceneDescs:l}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),s=r(a(15)),i=a(0),o=a(118);class l{constructor(){this.meshes=[],this.textureBlocks=[],this.uvScrollArray=new Float32Array(32),this.textureIndexMap=new Map}}t.MapGroup=l;class c{constructor(){this.textureBlock=null,this.texture=null,this.vtx=[],this.ind=[],this.vcol=[],this.uv=[],this.normal=[],this.layer=0,this.translucent=!1,this.uvScroll=n.vec2.fromValues(0,0),this.addAlpha=!1}}t.MapMesh=c;class h{constructor(){this.textures=[],this.width=0,this.height=0,this.atlasX=0,this.atlasY=0}}t.TextureBlock=h;class d{constructor(e,t){this.index=e,this.parent=t,this.clipLeft=0,this.clipRight=0,this.clipTop=0,this.clipBottom=0,this.tiledU=!1,this.tiledV=!1,this.textureAnim=null}width(){return this.clipRight-this.clipLeft+1}height(){return this.clipBottom-this.clipTop+1}pixels(){const e=this.clipRight-this.clipLeft+1,t=this.clipBottom-this.clipTop+1;if(e===this.parent.width&&t===this.parent.height)return new Uint8Array(this.parent.pixels);let a=new Uint8Array(e*t*4);for(let r=0;r<t;r++){const t=4*((r+this.clipTop)*this.parent.width+this.clipLeft),n=r*e*4;a.set(this.parent.pixels.slice(t,t+4*e),n)}return a}}t.Texture=d;class u{constructor(e,t,a,r,n){this.spriteWidth=e,this.spriteHeight=t,this.spriteOffsetX=a,this.spriteOffsetY=r,this.numSprites=n,this.frames=[],this.index=0,this.spriteIndex=0,this.frameIndex=0,this.frameTimer=0,this.spritesPerRow=Math.ceil(Math.sqrt(n)),this.sheetWidth=this.spritesPerRow*e,this.sheetHeight=Math.ceil(n/this.spritesPerRow)*t,this.pixels=new Uint8Array(this.sheetWidth*this.sheetHeight*4)}addSprite(e,t,a,r){i.assert(this.spriteIndex<this.numSprites,`Unexpected number of sprites added to TEXA: ${this.spriteIndex}`);const n=this.spriteIndex%this.spritesPerRow*this.spriteWidth,s=Math.floor(this.spriteIndex/this.spritesPerRow)*this.spriteHeight;for(let i=0;i<this.spriteHeight;i++)for(let o=0;o<this.spriteWidth;o++){const l=4*((i+s)*this.sheetWidth+o+n),c=4*((i+a)*r+o+t);this.pixels[l]=e[c],this.pixels[l+1]=e[c+1],this.pixels[l+2]=e[c+2],this.pixels[l+3]=e[c+3]}this.spriteIndex++}advanceTime(e){if(0===this.frames.length)return;if(this.frameTimer-=Math.abs(e)/1e3,this.frameTimer>0)return;const t=e<0?-1:1;for(;this.frameTimer<0;){this.frameIndex=((this.frameIndex+t)%this.frames.length+this.frames.length)%this.frames.length;const e=this.frames[this.frameIndex].minLength/60,a=this.frames[this.frameIndex].maxLength/60;this.frameTimer+=Math.random()*(a-e)+e}}fillUVOffset(e){0!==this.frames.length&&(e[0]=this.frames[this.frameIndex].spriteIndex%this.spritesPerRow/this.spritesPerRow,e[1]=Math.floor(this.frames[this.frameIndex].spriteIndex/this.spritesPerRow)*this.spriteHeight/this.sheetHeight)}}t.TextureAnimation=u;class m{addFile(e){5259597===e.filename?4===e.type?this.mapGeometry=e:7===e.type&&(this.mapTextures=e):3165011===e.filename?4===e.type?this.sky0Geometry=e:7===e.type&&(this.sky0Textures=e):3230547===e.filename?4===e.type?this.sky1Geometry=e:7===e.type&&(this.sky1Textures=e):5===e.type&&(this.mapDoct=e)}}function p(e,t,a,r,s){!function(e,t,a,r){const n=e.createDataView(t.offset),s=new Map,l=n.getUint32(8,!0),c=n.getUint32(12,!0),u=n.getUint32(16,!0);for(let e=0;e<l+1;e++)s.set(e,[]);for(let e=0;e<c;e++){const t=n.getUint8(u+e)+1;s.get(t).push(e)}const m=n.getUint32(20,!0),p=n.getUint32(24,!0);for(const l of s.entries()){const s=l[0];f(e,m+144*s,a,t);let c=null;for(const e of l[1]){const t=p+160*e,s=16383&n.getUint32(t+16,!0),l=n.getUint8(t+24);i.assert(7===s,"Expected GIFtag with nloop 7 for texture read"),i.assert(14===l,"Expected A+E register in GIFtag for texture read");let u=null,m=null;for(let e=0;e<s;e++){const a=n.getUint32(t+16*e+32,!0),r=n.getUint32(t+16*e+36,!0),s=n.getUint8(t+16*e+40);6===s?u=o.getGSRegisterTEX0(a,r):8===s&&(m=o.getGSRegisterCLAMP(a,r))}if(null===u||null===m)throw"whoops";c||(c=new h,c.format=o.psmToString(u.psm),c.width=1<<u.tw,c.height=1<<u.th,c.pixels=new Uint8Array(c.width*c.height*4),r.textureBlocks.push(c));const f=new d(e,c);3===m.wms?(f.tiledU=!0,f.clipLeft=m.maxu,f.clipRight=m.minu):(f.clipLeft=m.minu,f.clipRight=m.maxu),3===m.wmt?(f.tiledV=!0,f.clipTop=m.maxv,f.clipBottom=m.minv):(f.clipTop=m.minv,f.clipBottom=m.maxv),c.textures.push(f);const A=new Uint8Array(c.pixels.length),g=1===u.tcc?-1:128;19===u.psm?o.gsMemoryMapReadImagePSMT8_PSMCT32(A,a,u.tbp0,u.tbw,c.width,c.height,u.cbp,g):20===u.psm&&o.gsMemoryMapReadImagePSMT4_PSMCT32(A,a,u.tbp0,u.tbw,c.width,c.height,u.cbp,u.csa,g),f.tex0=u;for(let e=f.clipTop;e<=f.clipBottom;e++)for(let t=f.clipLeft;t<=f.clipRight;t++){const a=4*(e*c.width+t);c.pixels[a]=A[a],c.pixels[a+1]=A[a+1],c.pixels[a+2]=A[a+2],c.pixels[a+3]=A[a+3]}r.textureIndexMap.set(e,[c,f])}}}(e,a,r,s),function(e,t,a,r){const n=e.createDataView(t.offset);let s=4*n.getUint32(4,!0)+n.getUint32(32,!0);for(;s<t.bytesize;){const i=n.getUint32(s,!0),o=n.getUint32(s+4,!0);switch(i){case 1129535061:{const e=n.getUint32(s+8,!0);r.uvScrollArray[2*e]=n.getFloat32(s+12,!0),r.uvScrollArray[2*e+1]=n.getFloat32(s+16,!0);break}case 1096303956:A(e,t.offset+s+8,a,r);break;case 1498235999:case 894323551:break;default:return void console.error(`Unknown texture data tag ${i.toString(16)} at offset ${t.offset+s.toString(16)}`)}s+=o+8}}(e,a,r,s),function(e,t,a){const r=e.createDataView(t.offset+144),s=r.getUint32(16,!0);for(let e=0;e<s;e++){const t=new c,s=r.getUint32(16*e+32,!0),o=r.getUint16(16*e+36,!0);a.textureIndexMap.has(o)&&(t.textureBlock=a.textureIndexMap.get(o)[0],t.texture=a.textureIndexMap.get(o)[1]),t.translucent=1===r.getUint16(16*e+42,!0),t.addAlpha=(64&r.getUint8(16*e+44))>0;const l=r.getUint16(16*e+44,!0)>>1&15,h=i.assertExists(t.texture);l>0&&(h.tiledU||h.tiledV)&&(t.uvScroll=n.vec2.fromValues(a.uvScrollArray[2*(l-1)],a.uvScrollArray[2*(l-1)+1])),_(r,s,t),a.meshes.push(t)}}(e,t,s)}function f(e,t,a,r){const n=e.createDataView(r.offset),l=16383&n.getUint32(t+16,!0),c=n.getUint8(t+24);i.assert(4===l,"Expected GIFtag with nloop 4 for texture upload"),i.assert(14===c,"Expected A+E register in GIFtag for texture upload");let h=null,d=null,u=null;for(let e=0;e<l;e++){const a=n.getUint32(t+16*e+32,!0),r=n.getUint32(t+16*e+36,!0),s=n.getUint8(t+16*e+40);80===s?h=o.getGSRegisterBITBLTBUF(a,r):81===s?d=o.getGSRegisterTRXPOS(a,r):82===s&&(u=o.getGSRegisterTRXREG(a,r))}if(null===h||null===d||null===u)throw"whoops";const m=r.offset+n.getUint32(t+116,!0);let p=16*(268435455&n.getUint32(t+112,!0));if(m+p>e.byteLength){const t=new Uint8Array(p);return t.set(e.createTypedArray(Uint8Array,m)),void o.gsMemoryMapUploadImage(a,h.dpsm,h.dbp,h.dbw,d.dsax,d.dsay,u.rrw,u.rrh,new s.default(t.buffer))}o.gsMemoryMapUploadImage(a,h.dpsm,h.dbp,h.dbw,d.dsax,d.dsay,u.rrw,u.rrh,e.subarray(m,p))}function A(e,t,a,r){const n=e.createDataView(t),s=n.getUint16(2,!0);i.assert(r.textureIndexMap.has(s),`Failed to parse TEXA block due to missing texture index ${s}`);const l=r.textureIndexMap.get(s)[0],c=r.textureIndexMap.get(s)[1],h=n.getUint16(14,!0),d=n.getUint16(16,!0),m=n.getUint16(18,!0),p=n.getUint16(20,!0),f=n.getUint16(22,!0);n.getUint16(0,!0);c.textureAnim=new u(c.width(),c.height(),d,m,h+1),c.textureAnim.addSprite(l.pixels,c.clipLeft,c.clipTop,l.width);const A=c.tex0,g=n.getUint32(32,!0);let _=p*f;20===A.psm&&(_/=2);const S=1===A.tcc?-1:128;for(let r=0;r<h;r++){o.gsMemoryMapUploadImage(a,A.psm,A.tbp0,A.tbw,d,m,p,f,e.subarray(t+g+r*_,_));const n=new Uint8Array(l.width*l.height*4);19===A.psm?o.gsMemoryMapReadImagePSMT8_PSMCT32(n,a,A.tbp0,A.tbw,l.width,l.height,A.cbp,S):20===A.psm&&o.gsMemoryMapReadImagePSMT4_PSMCT32(n,a,A.tbp0,A.tbw,l.width,l.height,A.cbp,A.csa,S),c.textureAnim.addSprite(n,c.clipLeft,c.clipTop,l.width)}let b=n.getUint32(28,!0)+4;for(;b<g;){const e=n.getInt16(b,!0);if(e<0)break;const t=n.getUint16(b+2,!0),a=n.getUint16(b+4,!0),r=n.getUint16(b+6,!0);a>=t&&a>0&&c.textureAnim.frames.push({minLength:t,maxLength:a,spriteIndex:e>0?0:r+1}),b+=8}}t.parseMap=function(e){const t=e.createDataView(),a=t.getUint32(4,!0),r=new m;for(let e=0;e<a;e++)r.addFile({type:t.getUint32(16*e+16,!0),filename:t.getUint32(16*e+20,!0),offset:t.getUint32(16*e+24,!0),bytesize:t.getUint32(16*e+28,!0)});const n=o.gsMemoryMapNew();let s=new l,i=new l,c=new l;return r.mapGeometry&&r.mapTextures&&(p(e,r.mapGeometry,r.mapTextures,n,s),r.mapDoct&&function(e,t,a,r){const n=e.createDataView(a.offset+144),s=e.createDataView(t.offset),i=n.getUint16(22,!0),o=n.getUint32(24,!0),l=s.getUint32(28,!0);for(let e=0;e<i;e++){const t=s.getUint32(l+28*e,!0),a=n.getUint32(o+4*e,!0);let i=0;for(;;){const e=n.getUint16(a+2*i,!0);if(65535===e)break;e<r.meshes.length&&(r.meshes[e].layer=t),i++}}}(e,r.mapDoct,r.mapGeometry,s)),r.sky0Geometry&&r.sky0Textures&&p(e,r.sky0Geometry,r.sky0Textures,n,i),r.sky1Geometry&&r.sky1Textures&&p(e,r.sky1Geometry,r.sky1Textures,n,c),{mapGroup:s,sky0Group:i,sky1Group:c}};class g{constructor(){this.mask=0,this.header=new Uint32Array(20),this.flg=null,this.ind=null}reset(){this.mask=0,this.header.fill(0),this.flg=null,this.ind=null}}function _(e,t,a){let r=t,n=new g;for(;r<e.byteLength;){const t=e.getUint16(r,!0),s=e.getUint8(r+2),i=127&e.getUint8(r+3);if(r+=4,i>>5!=3)switch(i){case 32:n.mask=e.getUint32(r,!0),r+=4;break;case 23:n.reset();break;case 49:r+=16;break;case 0:case 1:case 16:case 17:case 19:break;default:return void console.error(`VIF parse error: Unhandled command ${i.toString(16)} at offset ${r.toString(16)}`)}else{if(96===i)break;r+=S(e,r,t,s,i,n,a)}}}function S(e,t,a,r,s,i,o){const l=(16&s)>0,c=511&a,h=15&s;switch(h){case 12:if(0===c&&!l)for(let a=0;a<4*r;a++)i.header[a]=e.getUint32(t+4*a,!0);return 16*r;case 8:if(c===i.header[g.a_vertexAddr]&&l)!function(e,t,a,r){if(!a.ind||!a.flg)return;const s=r.vtx.length;for(let i=0;i<a.header[g.a_uvIndFlagsCount];i++){r.vtx.push(n.vec3.fromValues(e.getFloat32(t+12*a.ind[i],!0),e.getFloat32(t+12*a.ind[i]+4,!0),e.getFloat32(t+12*a.ind[i]+8,!0)));const o=48&a.flg[i];16!=o&&(32!==o&&0!==o||(r.ind.push(s+i-2),r.ind.push(s+i-1),r.ind.push(s+i)),48!==o&&0!==o||(r.ind.push(s+i),r.ind.push(s+i-1),r.ind.push(s+i-2)))}}(e,t,i,o);else if(c===i.header[g.a_vertexNormalAddr]&&l)for(let a=0;a<i.header[g.a_vertexNormalCount];a++)o.normal.push(n.vec3.fromValues(e.getFloat32(t+12*a,!0),e.getFloat32(t+12*a+4,!0),e.getFloat32(t+12*a+8,!0)));return 12*r;case 2:if(c===i.header[g.a_uvIndFlagsAddr]&&l)if(3486502863===i.mask){i.ind=new Uint8Array(r);for(let a=0;a<r;a++)i.ind[a]=e.getUint8(t+a)}else if(1061109567===i.mask){i.flg=new Uint8Array(r);for(let a=0;a<r;a++)i.flg[a]=e.getUint8(t+a)}return 4*Math.ceil(r/4);case 5:if(c===i.header[g.a_uvIndFlagsAddr]&&!l)for(let a=0;a<i.header[g.a_uvIndFlagsCount];a++)o.uv.push(n.vec2.fromValues(e.getInt16(t+4*a,!0)/4096,e.getInt16(t+4*a+2,!0)/4096));return 4*r;case 14:if(c===i.header[g.a_vertexColorAddr])for(let a=0;a<i.header[g.a_vertexColorCount];a++)o.vcol.push(n.vec4.fromValues(e.getUint8(t+4*a)/256,e.getUint8(t+4*a+1)/256,e.getUint8(t+4*a+2)/256,e.getUint8(t+4*a+3)/128));return 4*r;case 0:break;default:console.error(`VIF parse error: Unhandled UNPACK vn/vl ${h.toString(16)} at offset ${t.toString(16)}`)}return 16*r}g.a_modelType=0,g.a_uvIndFlagsCount=4,g.a_uvIndFlagsAddr=5,g.a_vertexColorCount=8,g.a_vertexColorAddr=9,g.a_vertexCount=12,g.a_vertexAddr=13,g.a_vertexNormalCount=16,g.a_vertexNormalAddr=17},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(11)),i=n(a(270)),o=a(20),l=a(6),c=a(1),h=a(7),d=a(9),u=a(33),m=a(10),p=a(22),f=a(0),A=a(17),g=a(13);t.textureToCanvas=function(e,t){const a=document.createElement("canvas"),r=e.width(),n=e.height(),s=`${t}_tex_${("000"+e.index).slice(-3)}`;a.width=r,a.height=n,a.title=s;const i=a.getContext("2d"),o=i.createImageData(a.width,a.height);o.data.set(e.pixels()),i.putImageData(o,0,0);const l=[a],c=new Map;return c.set("Format",e.parent.format),{name:s,surfaces:l,extraInfo:c}},t.textureAnimationToCanvas=function(e,t,a){const r=document.createElement("canvas"),n=e.sheetWidth,s=e.sheetHeight,i=`${a}_tex_${("000"+t.index).slice(-3)}_texa`;r.width=n,r.height=s,r.title=i;const o=r.getContext("2d"),l=o.createImageData(r.width,r.height);l.data.set(e.pixels),o.putImageData(l,0,0);const c=[r],h=new Map;return h.set("Format",t.parent.format),h.set("Sprite Width",e.spriteWidth.toString()),h.set("Sprite Height",e.spriteHeight.toString()),h.set("Sprite Count",e.numSprites.toString()),{name:i,surfaces:c,extraInfo:h}};class _ extends o.DeviceProgram{constructor(){super(...arguments),this.both=_.program}}_.a_Position=0,_.a_Color=1,_.a_TexCoord=2,_.a_TexClip=3,_.a_TexRepeat=4,_.a_TexScaleOffs=5,_.a_TexScroll=6,_.ub_SceneParams=0,_.ub_DrawParams=1,_.program=i.default;class S{constructor(e,t){this.layerIndex=e,this.name=t,this.visible=!0}setVisible(e){this.visible=e}}class b{constructor(){this.firstIndex=0,this.indexCount=0,this.textureIndex=0,this.textureAnim=null,this.translucent=!1,this.addAlpha=!1,this.cullBackfaces=!0,this.layer=null}}class v{constructor(e,t){this.layers=[],this.drawCalls=[],this.textureAnimations=[],this.textures=[],this.vertices=0,this.indices=0,this.atlasWidth=0,this.atlasHeight=0,this.textures.push(this.buildTextureAtlas(e,t)),this.processTextureAnimations(e,t),this.sampler=this.createSampler(e);const a=[];this.createBatchedDrawCalls(t,a),this.buildBuffersAndInputState(e,a)}processTextureAnimations(e,t){let a=[];a=a.concat(t.mapGroup.textureBlocks),a=a.concat(t.sky0Group.textureBlocks),a=a.concat(t.sky1Group.textureBlocks);let r=0;for(const t of a)for(const a of t.textures)a.textureAnim&&(this.textures.push(this.translateTextureAnimation(e,a.textureAnim)),a.textureAnim.index=r++,this.textureAnimations.push(a.textureAnim))}translateTextureAnimation(e,t){const a=e.createTexture(l.makeTextureDescriptor2D(l.GfxFormat.U8_RGBA_NORM,t.sheetWidth,t.sheetHeight,1));e.setResourceName(a,`texa${t.index}`);const r=e.createHostAccessPass();return r.uploadTextureData(a,0,[t.pixels]),e.submitPass(r),a}buildTextureAtlas(e,t){const a=[];let r=0;for(const e of t.mapGroup.textureBlocks)a.push(e),r+=e.width*e.height;for(const e of t.sky0Group.textureBlocks)a.push(e),r+=e.width*e.height;for(const e of t.sky1Group.textureBlocks)a.push(e),r+=e.width*e.height;f.assert(a.length>0),a.sort((function(e,t){return e.height===t.height?e.width===t.width?e.textures[0].index<t.textures[0].index?1:-1:e.width<t.width?1:-1:e.height<t.height?1:-1})),this.atlasWidth=Math.min(2048,1<<Math.ceil(Math.log(Math.sqrt(r))/Math.log(2))),this.atlasHeight=a[0].height;let n=0,s=0;for(const e of a)e.width>this.atlasWidth-n&&(n=0,s=this.atlasHeight,this.atlasHeight+=e.height),e.atlasX=n,e.atlasY=s,n+=e.width;const i=new Uint8Array(this.atlasWidth*this.atlasHeight*4);for(const e of a)for(let t=0;t<e.height;t++)for(let a=0;a<e.width;a++){const r=4*(t*e.width+a),n=4*((t+e.atlasY)*this.atlasWidth+a+e.atlasX);i[n]=e.pixels[r],i[n+1]=e.pixels[r+1],i[n+2]=e.pixels[r+2],i[n+3]=e.pixels[r+3]}const o=e.createTexture(l.makeTextureDescriptor2D(l.GfxFormat.U8_RGBA_NORM,this.atlasWidth,this.atlasHeight,1));e.setResourceName(o,"textureAtlas");const c=e.createHostAccessPass();return c.uploadTextureData(o,0,[i]),e.submitPass(c),o}createBatchedDrawCalls(e,t){const a=new Map,r=[],n=[];for(const t of e.sky0Group.meshes)n.push({mesh:t,group:1});for(const t of e.sky1Group.meshes)n.push({mesh:t,group:2});for(const t of e.mapGroup.meshes)n.push({mesh:t,group:0});const s=this.buildLayerMap(e);s.forEach(e=>{this.layers.push(e)}),this.layers.sort((e,t)=>e.layerIndex<t.layerIndex?-1:1);let i=-1;for(const e of n){const t=e.mesh;if(null===t.textureBlock)continue;let n=0;const s=f.assertExists(t.texture);s.textureAnim&&(n=s.textureAnim.index+1);const o={group:e.group,layerIndex:t.layer,textureIndex:n,addAlpha:t.addAlpha},l=JSON.stringify(o);t.translucent?i>=0&&r[i][0]===l?r[i][1].push(t):(r.push([l,[t]]),i++):(a.has(l)||a.set(l,[]),a.get(l).push(t))}a.forEach((e,a)=>{const r=JSON.parse(a),n=this.createDrawCall(r,!1,s);n.firstIndex=this.indices;for(const a of e)t.push(a),this.vertices+=a.vtx.length,this.indices+=a.ind.length;n.indexCount=this.indices-n.firstIndex,this.drawCalls.push(n)}),r.forEach(e=>{const a=JSON.parse(e[0]),r=this.createDrawCall(a,!0,s);r.firstIndex=this.indices;for(const a of e[1])t.push(a),this.vertices+=a.vtx.length,this.indices+=a.ind.length;r.indexCount=this.indices-r.firstIndex,this.drawCalls.push(r)})}buildLayerMap(e){const t=new Map;for(const a of e.mapGroup.meshes)t.has(`0_${a.layer}`)||t.set(`0_${a.layer}`,new S(a.layer,`map_layer_${a.layer.toString(16)}`));for(const a of e.sky0Group.meshes)t.has(`1_${a.layer}`)||t.set(`1_${a.layer}`,new S(a.layer,`sky0_layer_${a.layer.toString(16)}`));for(const a of e.sky1Group.meshes)t.has(`2_${a.layer}`)||t.set(`2_${a.layer}`,new S(a.layer,`sky1_layer_${a.layer.toString(16)}`));return t}createDrawCall(e,t,a){const r=new b;return a.has(`${e.group}_${e.layerIndex}`)&&(r.layer=a.get(`${e.group}_${e.layerIndex}`)),r.textureIndex=e.textureIndex,r.translucent=t,r.addAlpha=e.addAlpha,e.textureIndex>0&&(r.textureAnim=this.textureAnimations[e.textureIndex-1]),r}createSampler(e){return e.createSampler({wrapS:1,wrapT:1,minFilter:1,magFilter:1,mipFilter:0,minLOD:0,maxLOD:0})}buildBuffersAndInputState(e,t){const a=new Float32Array(21*this.vertices),r=new Uint32Array(this.indices);let n=0,s=0,i=0;for(const e of t){if(!e.textureBlock)continue;const t=c.vec4.create(),o=c.vec4.create(),l=c.vec2.create(),h=f.assertExists(e.texture);h.textureAnim?t.set([e.textureBlock.width/h.textureAnim.sheetWidth,e.textureBlock.height/h.textureAnim.sheetHeight,-h.clipLeft/h.textureAnim.sheetWidth,-h.clipTop/h.textureAnim.sheetHeight]):t.set([e.textureBlock.width/this.atlasWidth,e.textureBlock.height/this.atlasHeight,e.textureBlock.atlasX/this.atlasWidth,e.textureBlock.atlasY/this.atlasHeight]),o.set([(h.clipLeft+.5)/e.textureBlock.width,(h.clipRight+.5)/e.textureBlock.width,(h.clipTop+.5)/e.textureBlock.height,(h.clipBottom+.5)/e.textureBlock.height]),l.set([h.tiledU?e.textureBlock.width/h.width():.5,h.tiledV?e.textureBlock.height/h.height():.5]);for(let r=0;r<e.vtx.length;r++)a[n++]=e.vtx[r][0],a[n++]=e.vtx[r][1],a[n++]=e.vtx[r][2],a[n++]=e.vcol[r][0],a[n++]=e.vcol[r][1],a[n++]=e.vcol[r][2],a[n++]=e.vcol[r][3],a[n++]=e.uv[r][0],a[n++]=e.uv[r][1],a[n++]=o[0],a[n++]=o[1],a[n++]=o[2],a[n++]=o[3],a[n++]=l[0],a[n++]=l[1],a[n++]=t[0],a[n++]=t[1],a[n++]=t[2],a[n++]=t[3],a[n++]=e.uvScroll[0],a[n++]=e.uvScroll[1];for(let t=0;t<e.ind.length;t++)r[s++]=e.ind[t]+i;i+=e.vtx.length}this.vertexBuffer=A.makeStaticDataBuffer(e,2,a.buffer),this.indexBuffer=A.makeStaticDataBuffer(e,1,r.buffer);const o=[{location:_.a_Position,bufferIndex:0,format:l.GfxFormat.F32_RGB,bufferByteOffset:0},{location:_.a_Color,bufferIndex:0,format:l.GfxFormat.F32_RGBA,bufferByteOffset:12},{location:_.a_TexCoord,bufferIndex:0,format:l.GfxFormat.F32_RG,bufferByteOffset:28},{location:_.a_TexClip,bufferIndex:0,format:l.GfxFormat.F32_RGBA,bufferByteOffset:36},{location:_.a_TexRepeat,bufferIndex:0,format:l.GfxFormat.F32_RG,bufferByteOffset:52},{location:_.a_TexScaleOffs,bufferIndex:0,format:l.GfxFormat.F32_RGBA,bufferByteOffset:60},{location:_.a_TexScroll,bufferIndex:0,format:l.GfxFormat.F32_RG,bufferByteOffset:76}];this.inputLayout=e.createInputLayout({indexBufferFormat:l.GfxFormat.U32_R,vertexAttributeDescriptors:o,vertexBufferDescriptors:[{byteStride:84,frequency:1}]});const h=[{buffer:this.vertexBuffer,byteOffset:0}],d={buffer:this.indexBuffer,byteOffset:0};this.inputState=e.createInputState(this.inputLayout,h,d)}destroy(e){for(let t=0;t<this.textures.length;t++)e.destroyTexture(this.textures[t]);e.destroySampler(this.sampler),e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}t.MapData=v;const w=c.vec2.create();class x{constructor(e,t,a){this.mapData=e,this.drawCall=t,this.drawCallIndex=a,this.vertexColorsEnabled=!0,this.texturesEnabled=!0,this.textureMappings=f.nArray(1,()=>new m.TextureMapping),this.gfxProgram=null,this.createProgram(),this.megaStateFlags={},t.cullBackfaces||(this.megaStateFlags.cullMode=0),t.translucent&&(this.megaStateFlags.depthWrite=!1,this.megaStateFlags.attachmentsState=[{colorWriteMask:15^(t.addAlpha?8:0),rgbBlendState:{blendMode:l.GfxBlendMode.ADD,blendSrcFactor:l.GfxBlendFactor.SRC_ALPHA,blendDstFactor:t.addAlpha?l.GfxBlendFactor.ONE:l.GfxBlendFactor.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:l.GfxBlendMode.ADD,blendSrcFactor:l.GfxBlendFactor.ONE,blendDstFactor:l.GfxBlendFactor.ZERO}}]);const r=this.textureMappings[0];r.gfxTexture=e.textures[t.textureIndex],r.gfxSampler=e.sampler}prepareToRender(e,t,a,r){if(!this.drawCall.layer.visible)return;const n=t.pushRenderInst();n.setInputLayoutAndState(this.mapData.inputLayout,this.mapData.inputState),n.sortKey=this.drawCallIndex,null===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program)),n.setGfxProgram(this.gfxProgram),n.setMegaStateFlags(this.megaStateFlags),n.setSamplerBindingsFromTextureMappings(this.textureMappings),n.drawIndexes(this.drawCall.indexCount,this.drawCall.firstIndex);let s=n.allocateUniformBuffer(_.ub_DrawParams,32);const i=n.mapUniformBufferF32(_.ub_DrawParams);s+=g.fillMatrix4x4(i,s,a),s+=g.fillMatrix4x3(i,s,r.camera.viewMatrix),this.drawCall.textureAnim?(this.drawCall.textureAnim.fillUVOffset(w),i[s++]=w[0],i[s++]=w[1]):(i[s++]=0,i[s++]=0)}setVertexColorsEnabled(e){this.vertexColorsEnabled=e,this.createProgram()}setTexturesEnabled(e){this.texturesEnabled=e,this.createProgram()}createProgram(){const e=new _;this.vertexColorsEnabled&&e.defines.set("USE_VERTEX_COLOR","1"),this.texturesEnabled&&e.defines.set("USE_TEXTURE","1"),this.drawCall.translucent||e.defines.set("USE_ALPHA_MASK","1"),this.gfxProgram=null,this.program=e}}const T=[{numUniformBuffers:2,numSamplers:1}];class y{constructor(e,t,a){this.drawCallInstances=[],this.megaStateFlags={cullMode:2,depthWrite:!0,depthCompare:p.reverseDepthForCompareMode(l.GfxCompareMode.LEQUAL)};for(let e=0;e<a.length;e++)this.drawCallInstances.push(new x(t,a[e],e));this.worldTransform=c.mat4.create()}prepareToRender(e,t,a){const r=t.pushTemplateRenderInst();r.setBindingLayouts(T),r.setMegaStateFlags(this.megaStateFlags),r.filterKey=1,a.camera.setClipPlanes(20,5e5);let n=r.allocateUniformBuffer(_.ub_SceneParams,20);const s=r.mapUniformBufferF32(_.ub_SceneParams);n+=g.fillMatrix4x4(s,n,a.camera.projectionMatrix),s[n]=a.time;for(const r of this.drawCallInstances)r.prepareToRender(e,t,this.worldTransform,a);t.popTemplateRenderInst()}setVertexColorsEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setVertexColorsEnabled(e)}setTexturesEnabled(e){for(let t=0;t<this.drawCallInstances.length;t++)this.drawCallInstances[t].setTexturesEnabled(e)}}t.KingdomHeartsIIRenderer=class{constructor(e,t,a){this.textureHolder=t,this.renderInstManager=new h.GfxRenderInstManager,this.renderTarget=new d.BasicRenderTarget,this.sceneRenderers=[],this.mapData=new v(e,a),this.uniformBuffer=new u.GfxRenderDynamicUniformBuffer(e),this.sceneRenderers.push(new y(e,this.mapData,this.mapData.drawCalls))}createPanels(){const e=new s.Panel;e.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,e.setTitle(s.RENDER_HACKS_ICON,"Render Hacks");const t=new s.Checkbox("Enable Vertex Colors",!0);t.onchanged=()=>{this.sceneRenderers.forEach(e=>{e.setVertexColorsEnabled(t.checked)})},e.contents.appendChild(t.elem);const a=new s.Checkbox("Enable Textures",!0);return a.onchanged=()=>{this.sceneRenderers.forEach(e=>{e.setTexturesEnabled(a.checked)})},e.contents.appendChild(a.elem),[e,new s.LayerPanel(this.mapData.layers)]}prepareToRender(e,t,a){this.renderInstManager.pushTemplateRenderInst().setUniformBuffer(this.uniformBuffer);for(let t=0;t<this.sceneRenderers.length;t++)this.sceneRenderers[t].prepareToRender(e,this.renderInstManager,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t);for(const e of this.mapData.textureAnimations)e.advanceTime(a.deltaTime)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,d.transparentBlackFullClearRenderPassDescriptor);return h.executeOnPass(this.renderInstManager,e,r,1),this.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderInstManager.destroy(e),this.uniformBuffer.destroy(e),this.renderTarget.destroy(e),this.textureHolder.destroy(e),this.mapData.destroy(e)}}},function(e,t,a){"use strict";a.r(t),t.default="precision mediump float;\n\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n    float u_Time;\n};\n\nlayout(row_major, std140) uniform ub_DrawParams {\n    Mat4x4 u_Model;\n    Mat4x3 u_View;\n    vec4 u_AnimOffset;\n};\n\nuniform sampler2D u_Texture;\n\nvarying vec4 v_Color;\nvarying vec2 v_TexCoord;\nvarying vec4 v_TexClip;\nvarying vec2 v_TexRepeat;\nvarying vec4 v_TexScaleOffset;\nvarying vec2 v_TexScroll;\n\n#ifdef VERT\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec4 a_Color;\nlayout(location = 2) in vec2 a_TexCoord;\nlayout(location = 3) in vec4 a_TexClip;\nlayout(location = 4) in vec2 a_TexRepeat;\nlayout(location = 5) in vec4 a_TexScaleOffset;\nlayout(location = 6) in vec2 a_TexScroll;\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_View), Mul(u_Model, vec4(a_Position, 1.0))));\n    v_Color = a_Color;\n    v_TexCoord = a_TexCoord;\n    v_TexClip = a_TexClip;\n    v_TexRepeat = a_TexRepeat;\n    v_TexScaleOffset = a_TexScaleOffset;\n    v_TexScroll = a_TexScroll;\n}\n#endif\n\n#ifdef FRAG\nvoid main() {\n    vec4 t_Color = vec4(0.5, 0.5, 0.5, 1);\n\n#ifdef USE_TEXTURE\n    vec2 tc = v_TexCoord;\n    tc += v_TexScroll * u_Time * 2e-10f;\n    tc = fract(tc * v_TexRepeat) / v_TexRepeat;\n    tc = clamp(tc, v_TexClip.xz, v_TexClip.yw);\n    tc = tc * v_TexScaleOffset.xy + v_TexScaleOffset.zw + u_AnimOffset.xy;\n    t_Color = texture(u_Texture, tc);\n#endif\n\n#ifdef USE_VERTEX_COLOR\n    t_Color.rgb *= v_Color.rgb * 2.0f;\n    t_Color.a *= v_Color.a;\n#endif\n\n#ifdef USE_ALPHA_MASK\n    if (t_Color.a < 0.125) {\n        discard;\n    }\n#endif\n\n    gl_FragColor = t_Color;\n}\n#endif\n"},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(148)),s=a(273),i=a(0);class o{constructor(e,t){this.id=e,this.name=t}fetchPPF(e,t,a){return t.fetchData(`psychonauts/${e}.ppf`).then(e=>n.parse(e,a))}createScene(e,t){const a=t.dataFetcher;return Promise.all([this.fetchPPF("common",a,!1),this.fetchPPF(this.id,a,!0)]).then(([t,a])=>{const r=new s.PsychonautsRenderer(e);r.textureHolder.addTextures(e,t.textures),r.textureHolder.addTextures(e,a.textures);const n=new s.SceneRenderer(e,r.textureHolder,i.assertExists(a.mainScene));return r.sceneRenderers.push(n),r})}}const l=[new o("STMU","Main Menu"),"Whispering Rock Summer Camp",new o("CARE","Reception Area and Wilderness"),new o("CARE_NIGHT","Reception Area and Wilderness (Night)"),new o("CAMA","Campgrounds Main"),new o("CAMA_NIGHT","Campgrounds Main (Night)"),new o("CAKC","Kids' Cabins"),new o("CAKC_NIGHT","Kids' Cabins (Night)"),new o("CABH","Boathouse and Beach"),new o("CABH_NIGHT","Boathouse and Beach (Night)"),new o("CALI","Lodge"),new o("CALI_NIGHT","Lodge (Night)"),new o("CAGP","GPC and Wilderness"),new o("CAGP_NIGHT","GPC and Wilderness (Night)"),new o("CAJA","Ford's Sanctuary"),new o("CASA","Sasha's Underground Lab"),new o("CABU","Bunkhouse File Select UI"),"Coach Oleander's Basic Braining",new o("BBA1","Obstacle Course 1"),new o("BBA2","Obstacle Course 2"),new o("BBLT","Obstacle Course Finale"),"Nightmare in the Brain Tumbler",new o("NIMP","The Woods"),new o("NIBA","The Braintank"),"Sasha's Shooting Gallery",new o("SACU","Sasha's Shooting Gallery"),"Milla's Dance Party",new o("MIFL","The Lounge"),new o("MIMM","The Race"),new o("MILL","The Party"),"Lair of the Lungfish",new o("LLLL","Lair of the Lungfish"),"Lungfishopolis",new o("LOMA","Lungfishopolis"),new o("LOCB","Kochamara"),"Thorney Towers Home for the Disturbed",new o("ASGR","Grounds"),new o("ASCO","Lower Floors"),new o("ASUP","Upper Floors"),new o("ASLB","The Lab of Dr. Lobato"),new o("ASRU","Ruins"),"The Milkman Conspiracy",new o("MMI1","The Neighborhood"),new o("MMDM","The Den Mother"),"Gloria's Theater",new o("THMS","The Stage"),new o("THCW","The Catwalks"),new o("THFB","Confrontation"),"Waterloo World",new o("WWMA","Waterloo World"),"Black Velvetopia",new o("BVES","Edgar's Sancuary"),new o("BVRB","Running Against the Bull"),new o("BVWT","Tiger"),new o("BVWE","Eagle"),new o("BVWD","Dragon"),new o("BVWC","Cobra"),new o("BVMA","Matador's Arena"),"Meat Circus",new o("MCTC","Tent City"),new o("MCBB","The Butcher")];t.sceneGroup={id:"psychonauts",name:"Psychonauts",sceneDescs:l}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(180),n=a(0),s=a(12),i=a(1),o=a(148);function l(e){return i.vec3.fromValues(e.readFloat32(),e.readFloat32(),e.readFloat32())}function c(e){return new s.AABB(e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32())}function h(e){let t=e.readStringStream_4b();if("PLANE"===t){l(e);t=e.readStringStream_4b()}return{name:t,v1:l(e),v2:l(e),v3:l(e),v4:l(e),bbox:c(e)}}function d(e){const t=e.readUint32(),a=e.readUint32();e.readStringStream_4b(),l(e),l(e),l(e);if(3===t){l(e)}else if(4===t){l(e),e.readFloat32(),e.readFloat32()}else if(5===t){e.readStringStream_4b();e.offs+=12,e.offs+=12,e.offs+=24}if(512&a){let a=3===t?1:6;const r=[],n=[];for(let t=0;t<a;t++)r[t]=e.readUint16();for(let t=0;t<a;t++)n[t]=e.readUint16();3===t&&(e.offs+=64,e.offs+=24);for(let s=0;s<a;s++)n[s]<=256?e.offs+=1*r[s]:e.offs+=2*r[s],e.offs+=3===t?16*n[s]:6*n[s]}}function u(e){const t=e.readUint16(),a=e.readStringStream_4b();l(e),l(e);return n.assert(!1),{index:t,name:a}}function m(e){const t=e.readStringStream_4b(),a=e.readUint32(),r=[];for(let t=0;t<a;t++)r.push(u(e));return{name:t,joints:r}}function p(e,t){const a=c(e);let r=0;t>317&&e.readUint32();const s=e.readUint32(),i=(e.readUint32(),e.readUint8(),e.readUint8(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readUint32()),o=[];for(let t=0;t<i;t++)o.push(e.readUint32());if(32&s){e.readUint32();if(4294967295!=e.readUint32()){e.readStringStream_4b()}}if(8&s){e.readUint32()}e.readUint32();if(131072&s){e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32()}e.readUint32(),e.readFloat32(),e.readFloat32(),e.readFloat32();if(1073741824&s){e.readUint32(),e.readFloat32(),e.readFloat32()}e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readUint32();const l=e.readUint32(),h=e.readSlice(16*l);let d=null;e.readUint32()&&(d=e.readSlice(4*l));const u=e.readUint32();let m=null,p=0;if(0!=u&&(p=e.readFloat32(),m=e.readSlice(4*u*l)),e.readUint32()){e.readSlice(12*l)}const f=e.readUint32();e.readUint32();let A,g;return 16777216&s?(g=1,A=e.readSlice(2*(f+2))):(g=0,A=e.readSlice(3*f*2)),4&s&&n.assert(!1),{bbox:a,textureIds:o,iVertCount:l,iPolyCount:f,streamPosNrm:h,streamColor:d,streamUVCount:u,uvCoordScale:p,streamUV:m,streamIdx:A,topology:g}}function f(e,t){const a=e.readStringStream_4b(),r=l(e),s=l(e),i=l(e),o=c(e),u=e.readUint32(),A=[];for(let t=0;t<u;t++)A.push(h(e));e.readUint32();const g=e.readUint32();for(let t=0;t<g;t++)d(e);const _=e.readUint32(),S=[];for(let t=0;t<_;t++)S.push(m(e));const b=e.readUint32(),v=[];for(let a=0;a<b;a++)v.push(p(e,t));const w=e.readUint32();for(let t=0;t<w;t++){const t=e.readUint32();n.assert(0===t),e.offs+=28}e.readUint32()&&function(e){const t=e.readUint32();for(let a=0;a<t;a++)e.readUint32(),e.readUint32(),e.readUint32(),e.readUint32(),e.readUint32();const a=e.readUint32();for(let t=0;t<a;t++)l(e);e.readUint32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32();const r=e.readUint32(),n=e.readUint32();for(let t=0;t<6*n;t++)e.readFloat32();e.readUint32();for(let t=0;t<r;t++)e.readUint32();const s=e.readUint32();for(let t=0;t<s;t++)e.readUint32();c(e)}(e);const x=e.readUint32(),T=[];for(let a=0;a<x;a++)T.push(f(e,t));return{name:a,translation:r,rotation:s,scale:i,bbox:o,modelTriggerOBB:A,skeleton:S,meshFrag:v,submesh:T}}t.parse=function(e,t){const a=new r.DataStream(e),s=a.readString(4);n.assert("CYSP"===s);const i=a.readUint32();n.assert(i>=317),a.readUint32();const l=a.readUint32(),h=[];for(let e=0;e<l;e++){const e=o.normalizeTextureName(a.readStringStream_4b()),t=a.readUint16();h.push({textureName:e,flags:t})}return{textureReferences:h,domain:function e(t,a){const r=t.readStringStream_4b(),s=c(t);n.assert("HSEM"===t.readString(4));const i=t.readUint32(),o=[];for(let e=0;e<i;e++)o.push(f(t,a));n.assert("TADE"===t.readString(4));const l=t.readUint32();for(let e=0;e<l;e++){t.readUint32();const e=t.readUint32();t.offs+=e}n.assert("PRCS"===t.readString(4));const h=t.readUint32();for(let e=0;e<h;e++){t.readStringStream_4b(),t.readStringStream_4b();if(t.readUint32()){t.readStringStream_4b()}t.offs+=12,t.offs+=12,t.offs+=12,t.offs+=4,t.offs+=4,t.offs+=4}n.assert("FRTR"===t.readString(4));const d=t.readUint32();for(let e=0;e<d;e++)t.readStringStream_4b();const u=t.readUint32(),m=[];for(let r=0;r<u;r++)m.push(e(t,a));return{name:r,bbox:s,meshes:o,subdomains:m}}(a,i)}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(274)),s=a(10),i=a(148),o=a(6),l=a(98),c=a(17),h=a(20),d=a(32),u=a(13),m=a(1),p=a(8),f=a(23),A=a(0),g=a(9);function _(e,t,a,r){switch(e){case 0:return{type:"RGBA",flag:"SRGB",width:t,height:a,depth:1,pixels:r};case 9:return l.decompressBC({type:"BC1",flag:"SRGB",width:t,height:a,pixels:r,depth:1});case 10:return l.decompressBC({type:"BC2",flag:"SRGB",width:t,height:a,pixels:r,depth:1});case 11:return l.decompressBC({type:"BC3",flag:"SRGB",width:t,height:a,pixels:r,depth:1});default:return console.error("Unknown texture format",e),{type:"RGBA",flag:"SRGB",width:t,height:a,depth:1,pixels:new Uint8Array(t*a*4)}}}class S extends s.TextureHolder{constructor(){super(...arguments),this.ppakTextures=[]}findPPAKTexture(e){return A.assertExists(this.ppakTextures.find(t=>t.name===e))}loadTexture(e,t){if(0===t.mipData.length)return null;const a=[],r=[];let n=t.width,s=t.height;for(let e=0;e<t.mipData.length;e++){const i=t.mipData[e].createTypedArray(Uint8Array),o=_(t.format,n,s,i);a.push(o.pixels);const c=document.createElement("canvas");l.surfaceToCanvas(c,o,0),r.push(c),n>1&&(n>>>=1),s>1&&(s>>>=1)}const c=e.createTexture(o.makeTextureDescriptor2D(o.GfxFormat.U8_RGBA_NORM,t.width,t.height,t.mipData.length)),h=e.createHostAccessPass();h.uploadTextureData(c,0,a),e.submitPass(h);const d=new Map;d.set("Format",i.getTextureFormatName(t.format));const u={name:t.name.split("/").pop(),surfaces:r,extraInfo:d};return this.ppakTextures.push(t),{gfxTexture:c,viewerTexture:u}}}t.PsychonautsTextureHolder=S;class b extends h.DeviceProgram{constructor(){super(...arguments),this.both=b.program}}b.a_Position=0,b.a_Color=1,b.a_TexCoord=2,b.ub_SceneParams=0,b.ub_MeshFragParams=1,b.program=n.default;class v{constructor(e,t){if(this.meshFrag=t,this.posNrmBuffer=c.makeStaticDataBufferFromSlice(e,2,t.streamPosNrm),this.colorBuffer=t.streamColor?c.makeStaticDataBufferFromSlice(e,2,t.streamColor):null,t.streamUVCount>0){const a=function(e,t,a,r){const n=e.createDataView(),s=new Float32Array(2*a*t);let i=0,o=0;for(let e=0;e<t;e++)for(let e=0;e<a;e++)s[i++]=n.getInt16(o+0,!0)/32767*r,s[i++]=n.getInt16(o+2,!0)/32767*r,o+=4;return s}(t.streamUV,t.iVertCount,t.streamUVCount,t.uvCoordScale);this.uvBuffer=c.makeStaticDataBuffer(e,2,a.buffer)}else this.uvBuffer=null;const a=t.streamIdx.byteLength/2,r=d.convertToTriangleIndexBuffer(t.topology,t.streamIdx.createTypedArray(Uint16Array,0,a)),n=d.filterDegenerateTriangleIndexBuffer(r);this.idxBuffer=c.makeStaticDataBuffer(e,1,n.buffer),this.indexCount=n.length;const s=[{location:b.a_Position,bufferIndex:0,bufferByteOffset:0,format:o.GfxFormat.F32_RGB},{location:b.a_Color,bufferIndex:1,bufferByteOffset:0,format:o.GfxFormat.U8_RGBA_NORM},{location:b.a_TexCoord,bufferIndex:2,bufferByteOffset:0,format:o.GfxFormat.F32_RG}],i=[{byteStride:16,frequency:1},this.colorBuffer?{byteStride:4,frequency:1}:null,this.uvBuffer?{byteStride:8*t.streamUVCount,frequency:1}:null];this.inputLayout=e.createInputLayout({vertexAttributeDescriptors:s,vertexBufferDescriptors:i,indexBufferFormat:o.GfxFormat.U16_R});const l=[{buffer:this.posNrmBuffer,byteOffset:0},this.colorBuffer?{buffer:this.colorBuffer,byteOffset:0}:null,this.uvBuffer?{buffer:this.uvBuffer,byteOffset:0}:null],h={buffer:this.idxBuffer,byteOffset:0};this.inputState=e.createInputState(this.inputLayout,l,h)}destroy(e){e.destroyBuffer(this.posNrmBuffer),null!==this.colorBuffer&&e.destroyBuffer(this.colorBuffer),null!==this.uvBuffer&&e.destroyBuffer(this.uvBuffer),e.destroyBuffer(this.idxBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}class w{constructor(e,t){this.mesh=t,this.meshFragData=[],this.submeshData=[];for(let t=0;t<this.mesh.meshFrag.length;t++)this.meshFragData[t]=new v(e,this.mesh.meshFrag[t]);for(let t=0;t<this.mesh.submesh.length;t++)this.submeshData[t]=new w(e,this.mesh.submesh[t])}destroy(e){for(let t=0;t<this.meshFragData.length;t++)this.meshFragData[t].destroy(e);for(let t=0;t<this.submeshData.length;t++)this.submeshData[t].destroy(e)}}class x{constructor(e,t){this.domain=t,this.meshData=[],this.subdomainData=[];for(let a=0;a<t.meshes.length;a++)this.meshData[a]=new w(e,t.meshes[a]);for(let a=0;a<t.subdomains.length;a++)this.subdomainData[a]=new x(e,t.subdomains[a])}destroy(e){for(let t=0;t<this.meshData.length;t++)this.meshData[t].destroy(e);for(let t=0;t<this.subdomainData.length;t++)this.subdomainData[t].destroy(e)}}const T=m.mat4.create();class y{constructor(e,t,a,r){if(this.meshFragData=r,this.gfxSamplers=[],this.gfxProgram=null,this.textureMapping=A.nArray(1,()=>new s.TextureMapping),this.program=new b,r.meshFrag.textureIds.length>=1){const n=this.textureMapping[0];this.program.defines.set("USE_TEXTURE","1");const s=r.meshFrag.textureIds[0],i=t.textureReferences[s];a.hasTexture(i.textureName)?a.fillTextureMapping(n,i.textureName):n.gfxTexture=null;const o=e.createSampler({magFilter:1,minFilter:1,mipFilter:2,minLOD:0,maxLOD:1e3,wrapS:1,wrapT:1});this.gfxSamplers.push(o),n.gfxSampler=o}null!==this.meshFragData.meshFrag.streamColor&&this.program.defines.set("USE_VERTEX_COLOR","1")}computeModelMatrix(e,t){return p.computeViewMatrix(T,e),m.mat4.mul(T,T,t),T}prepareToRender(e,t,a,r){const n=t.pushRenderInst();n.setInputLayoutAndState(this.meshFragData.inputLayout,this.meshFragData.inputState),n.drawIndexes(this.meshFragData.indexCount),null===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program)),n.setGfxProgram(this.gfxProgram),n.setSamplerBindingsFromTextureMappings(this.textureMapping);let s=n.allocateUniformBuffer(b.ub_MeshFragParams,12);const i=n.mapUniformBufferF32(b.ub_MeshFragParams);u.fillMatrix4x3(i,s,this.computeModelMatrix(r.camera,a))}destroy(e){for(let t=0;t<this.gfxSamplers.length;t++)e.destroySampler(this.gfxSamplers[t])}}class C{constructor(e,t,a,r){this.meshData=r,this.meshFragInstance=[],this.submeshInstance=[],this.modelMatrix=m.mat4.create();for(let r=0;r<this.meshData.meshFragData.length;r++)this.meshFragInstance[r]=new y(e,t,a,this.meshData.meshFragData[r]);for(let r=0;r<this.meshData.submeshData.length;r++)this.submeshInstance[r]=new C(e,t,a,this.meshData.submeshData[r])}prepareToRender(e,t,a){for(let r=0;r<this.meshFragInstance.length;r++)this.meshFragInstance[r].prepareToRender(e,t,this.modelMatrix,a);for(let r=0;r<this.submeshInstance.length;r++)this.submeshInstance[r].prepareToRender(e,t,a)}destroy(e){for(let t=0;t<this.meshFragInstance.length;t++)this.meshFragInstance[t].destroy(e);for(let t=0;t<this.submeshInstance.length;t++)this.submeshInstance[t].destroy(e)}}class M{constructor(e,t,a,r){this.domainData=r,this.meshInstance=[],this.subdomainInstance=[];for(let r=0;r<this.domainData.meshData.length;r++)this.meshInstance[r]=new C(e,t,a,this.domainData.meshData[r]);for(let r=0;r<this.domainData.subdomainData.length;r++)this.subdomainInstance[r]=new M(e,t,a,this.domainData.subdomainData[r])}prepareToRender(e,t,a){for(let r=0;r<this.meshInstance.length;r++)this.meshInstance[r].prepareToRender(e,t,a);for(let r=0;r<this.subdomainInstance.length;r++)this.subdomainInstance[r].prepareToRender(e,t,a)}destroy(e){for(let t=0;t<this.meshInstance.length;t++)this.meshInstance[t].destroy(e);for(let t=0;t<this.subdomainInstance.length;t++)this.subdomainInstance[t].destroy(e)}}const U=[{numUniformBuffers:2,numSamplers:1}];t.SceneRenderer=class{constructor(e,t,a){this.scene=a,this.domainData=new x(e,this.scene.domain),this.domainInstance=new M(e,a,t,this.domainData)}prepareToRender(e,t,a){const r=t.pushTemplateRenderInst();r.setBindingLayouts(U);let n=r.allocateUniformBuffer(b.ub_SceneParams,16);!function(e,t,a=0){a+=u.fillMatrix4x4(e,a,t.projectionMatrix)}(r.mapUniformBufferF32(b.ub_SceneParams),a.camera,n),this.domainInstance.prepareToRender(e,t,a),t.popTemplateRenderInst()}destroy(e){this.domainInstance.destroy(e),this.domainData.destroy(e)}};t.PsychonautsRenderer=class{constructor(e){this.renderTarget=new g.BasicRenderTarget,this.clearRenderPassDescriptor=g.standardFullClearRenderPassDescriptor,this.textureHolder=new S,this.sceneRenderers=[],this.renderHelper=new f.GfxRenderHelper(e)}addSceneRenderer(e){this.sceneRenderers.push(e)}prepareToRender(e,t,a){this.renderHelper.pushTemplateRenderInst();for(let t=0;t<this.sceneRenderers.length;t++)this.sceneRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,this.clearRenderPassDescriptor);return this.renderHelper.renderInstManager.drawOnPassRenderer(e,r),this.renderHelper.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e),this.textureHolder.destroy(e);for(let t=0;t<this.sceneRenderers.length;t++)this.sceneRenderers[t].destroy(e)}}},function(e,t,a){"use strict";a.r(t),t.default="\nprecision mediump float;\n\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n};\n\nlayout(row_major, std140) uniform ub_MeshFragParams {\n    Mat4x3 u_BoneMatrix[1];\n};\n\nuniform sampler2D u_Texture[1];\n\nvarying vec4 v_Color;\nvarying vec2 v_TexCoord;\n\n#ifdef VERT\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec4 a_Color;\nlayout(location = 2) in vec2 a_TexCoord;\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_BoneMatrix[0]), vec4(a_Position, 1.0)));\n    v_Color = a_Color;\n    v_TexCoord = a_TexCoord;\n}\n#endif\n\n#ifdef FRAG\nvoid main() {\n    vec4 t_Color = vec4(1.0);\n\n#ifdef USE_TEXTURE\n    t_Color *= texture(u_Texture[0], v_TexCoord);\n#endif\n\n#ifdef USE_VERTEX_COLOR\n    // TODO(jstpierre): How is the vertex color buffer used?\n    t_Color.rgb *= clamp(v_Color.rgb * 8.0, 0.0, 1.0);\n    t_Color.a *= v_Color.a;\n#endif\n\n    // TODO(jstpierre): Configurable alpha ref?\n    if (t_Color.a < 0.5)\n        discard;\n\n    gl_FragColor = t_Color;\n}\n#endif\n"},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(64)),i=r(a(276)),o=r(a(277)),l=r(a(278)),c=r(a(279)),h=r(a(280)),d=r(a(281)),u=n(a(15)),m=a(181),p=a(0),f=a(282),A=a(11),g=r(a(283)),_=a(7),S=a(33),b=a(9);class v{constructor(){this.files=new Map}mountCRG1(e){const t=Object.keys(e.Files);for(let a=0;a<t.length;a++)this.files.set(t[a],e.Files[t[a]])}mountFile(e,t){this.files.set(e,t)}lookupFile(e){return this.files.has(e)?this.files.get(e):null}}class w{constructor(e,t){this.textureHolder=t,this.msbRenderers=[],this.renderTarget=new b.BasicRenderTarget,this.renderInstManager=new _.GfxRenderInstManager,this.uniformBuffer=new S.GfxRenderDynamicUniformBuffer(e)}getCache(){return this.renderInstManager.gfxRenderCache}createPanels(){return[new A.LayerPanel(this.msbRenderers[0].flverInstances)]}prepareToRender(e,t,a){this.renderInstManager.pushTemplateRenderInst().setUniformBuffer(this.uniformBuffer);for(let t=0;t<this.msbRenderers.length;t++)this.msbRenderers[t].prepareToRender(e,this.renderInstManager,a);this.uniformBuffer.prepareToRender(e,t),this.renderInstManager.popTemplateRenderInst()}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,b.standardFullClearRenderPassDescriptor);return this.renderInstManager.drawOnPassRenderer(e,r),this.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderTarget.destroy(e),this.renderInstManager.destroy(e),this.uniformBuffer.destroy(e);for(let t=0;t<this.msbRenderers.length;t++)this.msbRenderers[t].destroy(e);this.textureHolder.destroy(e)}}class x{constructor(e,t,a){this.flverData=[];for(let r=0;r<a.length;r++)void 0!==a[r]&&(this.flverData[r]=new f.FLVERData(e,t,a[r]))}destroy(e){for(let t=0;t<this.flverData.length;t++)void 0!==this.flverData[t]&&this.flverData[t].destroy(e)}}t.ModelHolder=x;class T{constructor(e){this.mtdBnd=e,this.materialData=new Map}getMaterial(e){if(e=e.toLowerCase(),!this.materialData.has(e)){const t=p.assertExists(this.mtdBnd.files.find(t=>t.name.toLowerCase()===e));this.materialData.set(e,g.parse(t.data))}return this.materialData.get(e)}}t.MaterialDataHolder=T;async function y(e,t,a){const r=await t.fetchData(`dks/${a}`),n=s.parse(r,1);e.mountCRG1(n)}async function C(e,t,a){const r=await t.fetchData(`dks/${a}`);e.mountFile(a,r)}class M{constructor(e,t){this.id=e,this.name=t}loadTextureTPFDCX(e,t,a,r){const n=p.assertExists(a.lookupFile(`${r}.tpf.dcx`)),s=new u.default(o.decompressBuffer(n)),i=l.parse(s);t.addTextures(e,i.textures)}loadTextureBHD(e,t,a,r){const n=p.assertExists(a.lookupFile(`${r}.tpfbhd`)),s=p.assertExists(a.lookupFile(`${r}.tpfbdt`)),i=c.parse(n,s);for(let a=0;a<i.fileRecords.length;a++){const r=i.fileRecords[a];p.assert(r.name.endsWith(".tpf.dcx"));const n=new u.default(o.decompressBuffer(r.buffer)),s=l.parse(n);p.assert(1===s.textures.length);const c=r.name.replace(/\\/g,"").replace(".tpf.dcx","").toLowerCase(),h=s.textures[0].name.toLowerCase();p.assert(c===h),t.addTextures(e,s.textures)}}async createScene(e,t){const a=t.dataFetcher,r=new v;y(r,a,`${this.id}_arc.crg1`),C(r,a,"mtd/Mtd.mtdbnd"),await a.waitForLoad();const n=new m.DDSTextureHolder,s=new w(e,n),l=`/map/MapStudio/${this.id}.msb`,c=p.assertExists(r.lookupFile(l)),A=i.parse(c,this.id),g=h.parse(p.assertExists(r.lookupFile("mtd/Mtd.mtdbnd"))),_=new T(g),S=[];for(let e=0;e<A.models.length;e++)if(0===A.models[e].type){const t=p.assertExists(r.lookupFile(A.models[e].flverPath)),a=d.parse(new u.default(o.decompressBuffer(t)));a.batches.length>0&&(S[e]=a)}const b=new x(e,s.getCache(),S),M=this.id.slice(0,3);this.loadTextureBHD(e,n,r,`/map/${M}/${M}_0000`),this.loadTextureBHD(e,n,r,`/map/${M}/${M}_0001`),this.loadTextureBHD(e,n,r,`/map/${M}/${M}_0002`),this.loadTextureBHD(e,n,r,`/map/${M}/${M}_0003`),this.loadTextureTPFDCX(e,n,r,`/map/${M}/${M}_9999`);const U=new f.MSBRenderer(e,n,b,_,A);return s.msbRenderers.push(U),s}}const U=[new M("m18_01_00_00","Undead Asylum"),new M("m10_02_00_00","Firelink Shrine"),new M("m10_01_00_00","Undead Burg / Undead Parish"),new M("m10_00_00_00","The Depths"),new M("m14_00_00_00","Blighttown / Quelaag's Domain"),new M("m14_01_00_00","Demon Ruins / Lost Izalith"),new M("m12_00_00_01","Darkroot Forest / Darkroot Basin"),new M("m15_00_00_00","Sen's Fortress"),new M("m15_01_00_00","Anor Londo"),new M("m11_00_00_00","Painted World"),new M("m17_00_00_00","Duke's Archives / Crystal Caves"),new M("m13_00_00_00","The Catacombs"),new M("m13_01_00_00","Tomb of the Giants"),new M("m13_02_00_00","Great Hollow / Ash Lake"),new M("m16_00_00_00","New Londo Ruins / Valley of the Drakes"),new M("m18_00_00_00","Firelink Altar / Kiln of the First Flame"),new M("m12_01_00_00","Royal Wood / Oolacile Township / Chasm of the Abyss"),new class{constructor(e,t){this.id=e,this.name=t}loadTextureTPFDCX(e,t,a,r){const n=p.assertExists(a.lookupFile(`${r}.tpf.dcx`)),s=new u.default(o.decompressBuffer(n)),i=l.parse(s);t.addTextures(e,i.textures)}loadTextureBHD(e,t,a,r){const n=p.assertExists(a.lookupFile(`${r}.tpfbhd`)),s=p.assertExists(a.lookupFile(`${r}.tpfbdt`)),i=c.parse(n,s);for(let a=0;a<i.fileRecords.length;a++){const r=i.fileRecords[a];p.assert(r.name.endsWith(".tpf.dcx"));const n=new u.default(o.decompressBuffer(r.buffer)),s=l.parse(n);p.assert(1===s.textures.length);const c=r.name.replace(/\\/g,"").replace(".tpf.dcx","").toLowerCase(),h=s.textures[0].name.toLowerCase();p.assert(c===h),t.addTextures(e,s.textures)}}async createScene(e,t){const a=t.dataFetcher,r=new v,n=["m18_01_00_00","m10_02_00_00","m10_01_00_00","m10_00_00_00","m14_00_00_00","m14_01_00_00","m12_00_00_01","m15_00_00_00","m15_01_00_00","m11_00_00_00","m17_00_00_00","m13_00_00_00","m13_01_00_00","m13_02_00_00","m16_00_00_00","m18_00_00_00","m12_01_00_00"],s=new m.DDSTextureHolder,l=new w(e,s);C(r,a,"mtd/Mtd.mtdbnd");for(let e=0;e<n.length;e++){y(r,a,`${n[e]}_arc.crg1`)}await a.waitForLoad();for(let t=0;t<n.length;t++){const a=n[t],c=`/map/MapStudio/${a}.msb`,m=p.assertExists(r.lookupFile(c)),A=i.parse(m,a),g=h.parse(p.assertExists(r.lookupFile("mtd/Mtd.mtdbnd"))),_=new T(g),S=[];for(let e=0;e<A.models.length;e++)if(0===A.models[e].type){const t=p.assertExists(r.lookupFile(A.models[e].flverPath)),a=d.parse(new u.default(o.decompressBuffer(t)));a.batches.length>0&&(S[e]=a)}const b=l.getCache(),v=new x(e,b,S),w=a.slice(0,3);this.loadTextureBHD(e,s,r,`/map/${w}/${w}_0000`),this.loadTextureBHD(e,s,r,`/map/${w}/${w}_0001`),this.loadTextureBHD(e,s,r,`/map/${w}/${w}_0002`),this.loadTextureBHD(e,s,r,`/map/${w}/${w}_0003`),this.loadTextureTPFDCX(e,s,r,`/map/${w}/${w}_9999`);const y=new f.MSBRenderer(e,s,v,_,A);l.msbRenderers.push(y)}return l}}("hell yea bro","Click here to crash your browser")];t.sceneGroup={id:"dks",name:"Dark Souls",sceneDescs:U}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=a(1),i=r(a(60));t.parse=function(e,t){const a=e.createDataView();let r=0;n.assert(0==a.getUint32(r+0,!0)),n.assert("MODEL_PARAM_ST"==n.readString(e,a.getUint32(r+4,!0),-1,!0));const o=a.getUint32(r+8,!0)-1;let l=r+12;const c=[];for(let r=0;r<o;r++){const r=a.getUint32(l+0,!0),s=a.getUint32(r+0,!0),i=n.readString(e,r+s,-1,!0),o=a.getUint32(r+4,!0),h=a.getUint32(r+8,!0),d=a.getUint32(r+12,!0),u=n.readString(e,r+d,-1,!0),m=(a.getUint32(r+16,!0),t.slice(0,6)),p=m.slice(1,3),f=`/map/${m}_00_00/${i}A${p}.flver.dcx`;c.push({name:i,type:o,id:h,filename:u,flverPath:f}),l+=4}r=a.getUint32(l+0,!0),n.assert(0==a.getUint32(r+0,!0)),n.assert("EVENT_PARAM_ST"==n.readString(e,a.getUint32(r+4,!0),-1,!0));const h=a.getUint32(r+8,!0)-1;let d=r+12;for(let e=0;e<h;e++){a.getUint32(d+0,!0);d+=4}r=a.getUint32(d+0,!0),n.assert(0==a.getUint32(r+0,!0)),n.assert("POINT_PARAM_ST"==n.readString(e,a.getUint32(r+4,!0),-1,!0));const u=a.getUint32(r+8,!0)-1;let m=r+12;for(let e=0;e<u;e++){a.getUint32(m+0,!0);m+=4}r=a.getUint32(m+0,!0),n.assert(0==a.getUint32(r+0,!0)),n.assert("PARTS_PARAM_ST"==n.readString(e,a.getUint32(r+4,!0),-1,!0));const p=a.getUint32(r+8,!0)-1;function f(t){const r=t,o=a.getUint32(t,!0);t+=4;const l=n.readString(e,r+o,-1,!0),c=a.getUint32(t,!0);t+=4;a.getUint32(t,!0);t+=4;const h=a.getUint32(t,!0);t+=4;a.getUint32(t,!0);function d(){const e=a.getFloat32(t+0,!0),r=a.getFloat32(t+4,!0),n=a.getFloat32(t+8,!0);return t+=12,s.vec3.fromValues(e,r,n)}t+=4;const u=d(),m=d(),p=d(),f=a.getUint32(t+0,!0),A=a.getUint32(t+4,!0),g=a.getUint32(t+8,!0),_=a.getUint32(t+12,!0);t+=16;const S=new i.default(128);S.setWords([f,A,g,_]);const b=a.getUint32(t+0,!0),v=a.getUint32(t+4,!0),w=a.getUint32(t+8,!0),x=a.getUint32(t+12,!0);t+=16;const T=new i.default(128);return T.setWords([b,v,w,x]),{name:l,type:c,modelIndex:h,translation:u,rotation:m,scale:p,drawGroupBitMap:S,dispGroupBitMap:T}}let A=r+12;const g=[];for(let e=0;e<p;e++){const e=a.getUint32(A+0,!0);g.push(f(e)),A+=4}return{mapID:t,models:c,parts:g}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(97)),s=a(0);t.decompressBuffer=function(e){const t=e.createDataView();s.assert("DCX\0"==s.readString(e,0,4,!1)),s.assert(256==t.getUint32(4,!0)),s.assert(24==t.getUint32(8,!1)),s.assert(36==t.getUint32(12,!1)),s.assert(36==t.getUint32(16,!1)),s.assert(44==t.getUint32(20,!1)),s.assert("DCS\0"==s.readString(e,24,4,!1)),t.getUint32(28,!1);const a=t.getUint32(32,!1);s.assert("DCP\0DFLT"==s.readString(e,36,8,!1)),s.assert(32==t.getUint32(44,!1)),s.assert(9==t.getUint32(48,!0)),s.assert(0==t.getUint32(52,!0)),s.assert(0==t.getUint32(56,!0)),s.assert(0==t.getUint32(60,!0)),s.assert(65792==t.getUint32(64,!0)),s.assert("DCA\0"==s.readString(e,68,4,!1)),s.assert(8==t.getUint32(72,!1));const r=e.createTypedArray(Uint8Array,76,a);return n.inflate(r).buffer}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(181)),s=a(0);t.parse=function(e){const t=e.createDataView();s.assert("TPF\0"==s.readString(e,0,4,!1));const a=t.getUint32(8,!0);let r=16;const i=[];for(var o=0;o<a;o++){const a=t.getUint32(r,!0);r+=4;const o=t.getUint32(r,!0);r+=4;t.getUint32(r,!0);r+=4;const l=t.getUint32(r,!0);r+=4,r+=4;const c=s.readString(e,l,-1,!0),h=e.slice(a,a+o),d=n.parse(h,c);i.push(d)}return{textures:i}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.parse=function(e,t){const a=e.createDataView();r.assert("BHF307D7R6\0\0"==r.readString(e,0,12,!1)),r.assert("BDF307D7R6\0\0"==r.readString(t,0,12,!1));const n=a.getUint32(16,!0),s=[];let i=32;for(let o=0;o<n;o++){i+=4;const n=a.getUint32(i,!0);i+=4;const o=a.getUint32(i,!0);i+=4;const l=a.getUint32(i,!0);i+=4;const c=a.getUint32(i,!0);i+=4,i+=4;const h={name:r.readString(e,c,-1,!0),nameHash:l,buffer:t.subarray(o,n)};s.push(h)}return{fileRecords:s}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.parse=function(e){const t=e.createDataView(),a=r.readString(e,0,4,!1);r.assert("BND3"===a);const n=t.getUint32(16,!0);t.getUint32(20,!0);let s=32;const i=[];for(let a=0;a<n;a++){const a=t.getUint8(s+0);r.assert(64===a);const n=t.getUint32(s+4,!0),o=t.getUint32(s+8,!0),l=(t.getUint32(s+12,!0),t.getUint32(s+16,!0)),c=(t.getUint32(s+20,!0),r.readString(e,l,-1,!0)),h=e.subarray(o,n);i.push({name:c,data:h}),s+=24}return{files:i}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(1),s=a(12),i=new TextDecoder("utf-16le");function o(e,t){const a=e.createTypedArray(Uint8Array,t,Math.min(e.byteLength-t,256)),r=i.decode(a),n=r.indexOf("\0");let s;return s=n>=0?r.slice(0,n):r,s}t.parse=function(e){const t=e.createDataView();r.assert("FLVER\0"==r.readString(e,0,6,!1));const a=t.getUint32(12,!0),i=(t.getUint32(16,!0),t.getUint32(20,!0)),l=t.getUint32(24,!0),c=t.getUint32(28,!0),h=t.getUint32(32,!0),d=t.getUint32(36,!0),u=t.getFloat32(40,!0),m=t.getFloat32(44,!0),p=t.getFloat32(48,!0),f=t.getFloat32(52,!0),A=t.getFloat32(56,!0),g=t.getFloat32(60,!0),_=new s.AABB(u,m,p,f,A,g),S=t.getUint32(80,!0),b=t.getUint32(84,!0),v=t.getUint32(88,!0);let w=128;for(let e=0;e<i;e++)w+=64;const x=[];for(let a=0;a<l;a++){const a=t.getUint32(w+0,!0),r=o(e,a),n=t.getUint32(w+4,!0),s=o(e,n),i=t.getUint32(w+8,!0),l=t.getUint32(w+12,!0),c=t.getUint32(w+16,!0);x.push({name:r,mtdName:s,parameters:[],paramCount:i,paramStart:l,flags:c}),w+=32}const T=[];for(let a=0;a<c;a++){const a=t.getFloat32(w+0,!0),r=t.getFloat32(w+4,!0),s=t.getFloat32(w+8,!0);w+=12;const i=(y=void 0,y=t.getUint32(w+0,!0),w+=4,o(e,y)),l=t.getFloat32(w+0,!0),c=t.getFloat32(w+4,!0),h=t.getFloat32(w+8,!0);w+=12;t.getUint16(w,!0);w+=2;t.getUint16(w,!0);w+=2;const d=t.getFloat32(w+0,!0),u=t.getFloat32(w+4,!0),m=t.getFloat32(w+8,!0);w+=12;t.getUint16(w,!0);w+=2;t.getUint16(w,!0);w+=2,w+=80;const p=n.vec3.fromValues(a,r,s),f=n.vec3.fromValues(l,c,h),A=n.vec3.fromValues(d,u,m);T.push({name:i,translation:p,rotation:f,scale:A})}var y;const C=[];for(let e=0;e<d;e++){t.getUint32(w+0,!0);const e=t.getUint32(w+4,!0);w+=8,w+=8;t.getUint32(w+0,!0);const a=t.getUint32(w+4,!0);let n=t.getUint32(w+12,!0);const s=[];for(let e=0;e<a;e++){const e=t.getUint32(n+0,!0);s.push(e),n+=4}w+=16;const i=t.getUint32(w+0,!0),o=[];let l=t.getUint32(w+4,!0);for(let e=0;e<i;e++){const e=t.getUint32(l+0,!0);o.push(e),l+=4}w+=8;const c=t.getUint32(w+0,!0);r.assert(1===c);const h=t.getUint32(w+4,!0),d=t.getUint32(h+0,!0);C.push({materialIndex:e,jointIndexes:s,primitiveIndexes:o,inputStateIndex:d}),w+=8}const M=[];for(let n=0;n<S;n++){const n=t.getUint32(w+0,!0),s=t.getUint8(w+4);r.assert(1===s);const i=t.getUint8(w+5),o=t.getUint32(w+8,!0),l=t.getUint32(w+12,!0),c=t.getUint32(w+16,!0);r.assert(c/2===o);const h=e.subarray(a+l,c);M.push({flags:n,topology:s,cullMode:i,indexData:h,indexCount:o}),w+=32}const U=[];for(let r=0;r<h;r++){const r=t.getUint32(w+4,!0),n=t.getUint32(w+8,!0),s=(t.getUint32(w+12,!0),t.getUint32(w+24,!0)),i=t.getUint32(w+28,!0),o=e.subarray(a+i,s);U.push({inputLayoutIndex:r,vertexSize:n,vertexData:o}),w+=32}const k=[];for(let e=0;e<b;e++){const e=t.getUint32(w+0,!0);let a=t.getUint32(w+12,!0);const r=[];for(let n=0;n<e;n++){const e=t.getUint32(a+4,!0),n=t.getUint32(a+8,!0),s=t.getUint32(a+12,!0),i=t.getUint32(a+16,!0);r.push({offset:e,dataType:n,semantic:s,index:i}),a+=20}k.push({vertexAttributes:r}),w+=16}const D=[];for(let a=0;a<v;a++){const a=t.getUint32(w+0,!0),r=o(e,a),n=t.getUint32(w+4,!0),s=o(e,n);D.push({name:s,value:r}),w+=32}for(let e=0;e<x.length;e++){const t=x[e];t.parameters=D.slice(t.paramStart,t.paramStart+t.paramCount)}return{bbox:_,materials:x,joints:T,primitives:M,inputLayouts:k,inputStates:U,batches:C}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(6),s=r(a(15)),i=a(17),o=a(32),l=a(7),c=a(20),h=a(0),d=a(10),u=a(1),m=a(8),p=a(13),f=a(12),A=a(37),g=a(14);function _(e){return 0===e.flags}function S(e){return["m2000B1","m2380B1","m2430B1","m2410B1","m3301B1","m8000B1_0000","m8010B1_0000","m8020B1_0000","m8030B1_0000"].includes(e)}function b(e){switch(e.semantic){case 0:return T.a_Position;case 10:return T.a_Color;case 5:if(0===e.index)return T.a_TexCoord0;if(1===e.index)return T.a_TexCoord1;throw"whoops";case 3:return T.a_Normal;case 6:return T.a_Tangent;case 7:return T.a_Bitangent;default:return-1}}function v(e){switch(e){case 17:case 19:return n.GfxFormat.U8_RGBA_NORM;case 21:return n.GfxFormat.S16_RG;case 22:return n.GfxFormat.S16_RGBA;case 26:return n.GfxFormat.S16_RGBA_NORM;case 2:case 18:case 20:case 23:case 24:case 25:return n.GfxFormat.F32_RGBA;default:throw"whoops"}}class w{constructor(e,t,a,r,s,i){this.batch=r,this.inputStates=[];const o=a.flver.inputStates[r.inputStateIndex],l=a.flver.inputLayouts[o.inputLayoutIndex],c=[{buffer:s.buffer,byteOffset:4*s.wordOffset}],d=[];for(let e=0;e<l.vertexAttributes.length;e++){const t=l.vertexAttributes[e],a=b(t);a<0||d.push({location:a,format:v(t.dataType),bufferByteOffset:t.offset,bufferIndex:0})}const u=[{byteStride:o.vertexSize,frequency:1}];this.inputLayout=t.createInputLayout(e,{indexBufferFormat:n.GfxFormat.U16_R,vertexAttributeDescriptors:d,vertexBufferDescriptors:u});for(let t=0;t<r.primitiveIndexes.length;t++){const t=h.assertExists(i.shift()),a={buffer:t.buffer,byteOffset:4*t.wordOffset},r=e.createInputState(this.inputLayout,c,a);this.inputStates.push(r)}}destroy(e){for(let t=0;t<this.inputStates.length;t++)e.destroyInputState(this.inputStates[t])}}function x(e,t){return e.textures.findIndex(e=>e.name===t)}t.FLVERData=class{constructor(e,t,a){this.flver=a,this.batchData=[];const r=[],n=[];for(let e=0;e<a.inputStates.length;e++)r.push(a.inputStates[e].vertexData),a.inputStates[e].vertexData=null;const l=i.coalesceBuffer(e,2,r);this.vertexBuffer=l[0].buffer;for(let e=0;e<a.batches.length;e++){const t=a.batches[e];for(let e=0;e<t.primitiveIndexes.length;e++){const r=a.primitives[t.primitiveIndexes[e]],i=o.convertToTriangleIndexBuffer(1,r.indexData.createTypedArray(Uint16Array));n.push(new s.default(i.buffer)),r.indexData=null}}const c=i.coalesceBuffer(e,1,n);this.indexBuffer=c[0].buffer;for(let r=0;r<a.batches.length;r++){const n=a.batches[r],s=l[n.inputStateIndex],i=new w(e,t,this,n,s,c);this.batchData.push(i)}this.gfxSampler=e.createSampler({minFilter:1,magFilter:1,mipFilter:2,minLOD:0,maxLOD:100,wrapS:1,wrapT:1})}destroy(e){e.destroyBuffer(this.vertexBuffer),e.destroyBuffer(this.indexBuffer),e.destroySampler(this.gfxSampler);for(let t=0;t<this.batchData.length;t++)this.batchData[t].destroy(e)}};class T extends c.DeviceProgram{constructor(e){super(),this.mtd=e,this.both=`\nprecision mediump float;\n\n${T.BindingDefinitions}\n\nvarying vec4 v_Color;\nvarying vec2 v_TexCoord[3];\nvarying vec3 v_PositionView;\nvarying vec3 v_NormalView;\nvarying vec3 v_TangentView;\nvarying vec3 v_BitangentView;\n`,this.vert="\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec4 a_Color;\nlayout(location = 2) in vec4 a_TexCoord0;\nlayout(location = 3) in vec4 a_TexCoord1;\nlayout(location = 4) in vec4 a_Normal;\nlayout(location = 5) in vec4 a_Tangent;\nlayout(location = 6) in vec4 a_Bitangent;\n\n#define UNORM_TO_SNORM(xyz) ((xyz - 0.5) * 2.0)\n\nvoid main() {\n    vec4 t_PositionView = Mul(_Mat4x4(u_ViewFromLocal[0]), vec4(a_Position, 1.0));\n    v_PositionView = t_PositionView.xyz;\n    gl_Position = Mul(u_Projection, t_PositionView);\n    v_NormalView = normalize(Mul(_Mat4x4(u_ViewFromLocal[0]), vec4(UNORM_TO_SNORM(a_Normal.xyz), 0.0)).xyz);\n    v_TangentView = normalize(Mul(_Mat4x4(u_ViewFromLocal[0]), vec4(UNORM_TO_SNORM(a_Tangent.xyz), 0.0)).xyz);\n    v_BitangentView = normalize(Mul(_Mat4x4(u_ViewFromLocal[0]), vec4(UNORM_TO_SNORM(a_Bitangent.xyz), 0.0)).xyz);\n    v_Color = a_Color;\n    v_TexCoord[0] = ((a_TexCoord0.xy) / 1024.0) + u_TexScroll[0].xy;\n    v_TexCoord[1] = ((a_TexCoord0.zw) / 1024.0) + u_TexScroll[1].xy;\n    v_TexCoord[2] = ((a_TexCoord1.xy) / 1024.0) + u_TexScroll[2].xy;\n}\n",this.frag=this.genFrag()}getTexture(e){const t=this.mtd.textures.find(t=>t.name===e);return void 0!==t?t:null}buildTexAccess(e){const t=x(this.mtd,e.name);return h.assert(t>-1),`texture(u_Texture[${t}], v_TexCoord[${e.uvNumber}])`}genDiffuse(){const e=this.getTexture("g_Diffuse"),t=this.getTexture("g_Diffuse_2"),a="\n    t_Diffuse.rgb = t_Diffuse.rgb * u_DiffuseMapColor.rgb * u_DiffuseMapColor.w;\n";return null!==e&&null!==t?`\n    vec4 t_Diffuse1 = ${this.buildTexAccess(e)};\n    vec4 t_Diffuse2 = ${this.buildTexAccess(t)};\n    vec4 t_Diffuse = mix(t_Diffuse1, t_Diffuse2, v_Color.a);\n${a}\n`:null!==e?`\n    vec4 t_Diffuse1 = ${this.buildTexAccess(e)};\n    vec4 t_Diffuse = t_Diffuse1;\n${a}\n    `:"\n    vec4 t_Diffuse = vec4(1.0);\n"}genSpecular(){const e=this.getTexture("g_Specular"),t=this.getTexture("g_Specular_2"),a="\n    t_Specular.rgb = t_Specular.rgb * u_SpecularMapColor.rgb * u_SpecularMapColor.w;\n";return null!==e&&null!==t?`\n    vec3 t_Specular1 = ${this.buildTexAccess(e)}.rgb;\n    vec3 t_Specular2 = ${this.buildTexAccess(t)}.rgb;\n    vec3 t_Specular = mix(t_Specular1, t_Specular2, v_Color.a);\n${a}\n`:null!==e?`\n    vec3 t_Specular1 = ${this.buildTexAccess(e)}.rgb;\n    vec3 t_Specular = t_Specular1;\n${a}\n    `:"\n    vec3 t_Specular = vec3(0.0);\n"}genNormalDir(){const e=this.getTexture("g_Bumpmap"),t=this.getTexture("g_Bumpmap_2"),a="\n    vec3 t_Normal = v_NormalView.xyz;\n    vec3 t_Tangent = v_TangentView.xyz;\n    vec3 t_Bitangent = v_BitangentView.xyz;\n",r="\n    vec3 t_NormalDirView = (t_LocalNormal.x * t_Tangent + t_LocalNormal.y * t_Bitangent + t_LocalNormal.z * t_Normal);\n";return null!==e&&null!==t?`\n${a}\n    vec3 t_Bumpmap1 = ${this.buildTexAccess(e)}.rgb;\n    vec3 t_Bumpmap2 = ${this.buildTexAccess(t)}.rgb;\n    vec3 t_LocalNormal = mix(t_Bumpmap1, t_Bumpmap2, v_Color.a);\n${r}\n`:null!==e?`\n${a}\n    vec3 t_Bumpmap1 = ${this.buildTexAccess(e)}.rgb;\n    vec3 t_LocalNormal = t_Bumpmap1;\n${r}\n`:"\n    vec3 t_NormalDirView = v_NormalView;\n"}genLightMap(){const e=this.getTexture("g_Lightmap");return null!==e?`\n    t_IncomingDiffuseRadiance += ${this.buildTexAccess(e)}.rgb;\n`:""}genAlphaTest(){return 1===C(this.mtd)?"\n    if (t_Color.a < 0.1)\n        discard;\n":""}genFrag(){return`\nvoid main() {\n    vec4 t_Color = vec4(1.0);\n\n    t_Color *= v_Color;\n\n    ${this.genDiffuse()}\n\n#ifdef USE_LIGHTING\n    vec3 t_OutgoingLight = vec3(0.0);\n\n    vec3 t_IncomingDiffuseRadiance = vec3(0.0);\n    vec3 t_IncomingSpecularRadiance = vec3(0.0);\n    vec3 t_IncomingIndirectRadiance = vec3(0.0);\n\n    ${this.genNormalDir()}\n\n    // Basic fake directional.\n    // TODO(jstpierre): Read environment maps.\n\n    vec3 t_LightDirView = -u_LightDirView.xyz;\n    vec3 t_LightColor = vec3(0.9, 0.95, 0.95) * 2.0;\n\n    float t_DiffuseIntensity = max(dot(t_NormalDirView, t_LightDirView), 0.0);\n    t_IncomingDiffuseRadiance += t_LightColor * t_DiffuseIntensity;\n\n    vec3 t_ViewDir = normalize(-v_PositionView);\n\n    // Fake ambient with a sun color.\n    t_IncomingIndirectRadiance += vec3(0.92, 0.95, 0.85) * 0.4;\n\n    if (t_DiffuseIntensity > 0.0) {\n        vec3 t_ReflectanceDir = reflect(-t_LightDirView, t_NormalDirView);\n        float t_SpecularIntensity = pow(max(dot(t_ReflectanceDir, t_ViewDir), 0.0), u_SpecularPower);\n        t_IncomingSpecularRadiance += t_LightColor * t_SpecularIntensity;\n    }\n\n    ${this.genLightMap()}\n\n    ${this.genSpecular()}\n\n    t_OutgoingLight += t_Diffuse.rgb * (t_IncomingDiffuseRadiance + t_IncomingIndirectRadiance);\n    t_OutgoingLight += t_Specular * t_IncomingSpecularRadiance;\n\n    t_Color.rgb *= t_OutgoingLight;\n    t_Color.a *= t_Diffuse.a;\n#else\n    t_Color *= t_Diffuse;\n#endif\n\n    t_Color *= v_Color;\n\n    ${this.genAlphaTest()}\n\n#ifdef USE_LIGHTING\n    int t_Debug = int(u_Misc[0].y);\n\n    if (t_Debug == 1)\n        t_Color.rgb = vec3(t_ViewDir * 0.5 + 0.5);\n    else if (t_Debug == 3)\n        t_Color.rgb = vec3(t_LightDirView * 0.5 + 0.5);\n    else if (t_Debug == 4)\n        t_Color.rgb = vec3(t_DiffuseIntensity);\n    else if (t_Debug == 5)\n        t_Color.rgb = vec3(t_IncomingSpecularRadiance);\n    else if (t_Debug == 6)\n        t_Color.rgb = t_Specular * t_IncomingSpecularRadiance;\n#endif\n\n    // Convert to gamma-space\n    t_Color.rgb = pow(t_Color.rgb, vec3(1.0 / 2.2));\n\n    gl_FragColor = t_Color;\n}\n`}}function y(e,t){const a=e.params.find(e=>e.name===t);return void 0!==a?a.value:null}function C(e){const t=h.assertExists(y(e,"g_BlendMode"));h.assert(1===t.length);let a=t[0];return a>=32&&(a-=32),a}function M(e,t,a,r,n){if(void 0===n.textures.find(e=>e.name===a))return;const s=h.assertExists(function(e,t){const a=e.parameters.find(e=>e.name===t);return void 0===a?null:a.value.split("\\").pop().replace(/\.tga|\.psd/,"")}(r,a)).toLowerCase();if(t.hasTexture(s)){const r=x(n,a);t.fillTextureMapping(e[r],s)}}T.a_Position=0,T.a_Color=1,T.a_TexCoord0=2,T.a_TexCoord1=3,T.a_Normal=4,T.a_Tangent=5,T.a_Bitangent=6,T.ub_SceneParams=0,T.ub_MeshFragParams=1,T.BindingDefinitions="\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n};\n\nlayout(row_major, std140) uniform ub_MeshFragParams {\n    Mat4x3 u_ViewFromLocal[1];\n    // Fourth element has g_DiffuseMapColorPower\n    vec4 u_DiffuseMapColor;\n    // Fourth element has g_SpecularMapColorPower\n    vec4 u_SpecularMapColor;\n    vec4 u_TexScroll[3];\n    // Light direction in view space\n    vec4 u_LightDirView;\n    // g_SpecularPower\n    vec4 u_Misc[1];\n};\n\n#define u_SpecularPower (u_Misc[0].x)\n\nuniform sampler2D u_Texture[8];\n";const U=u.vec4.create();class k{constructor(e,t,a,r,s,i){this.flverData=t,this.batchData=a,this.visible=!0,this.diffuseColor=u.vec4.fromValues(1,1,1,1),this.specularColor=u.vec4.fromValues(0,0,0,0),this.specularPower=1,this.lightDir=u.vec4.fromValues(-.4,-.8,-.4,0),this.texScroll=h.nArray(3,()=>u.vec4.create()),this.textureMapping=h.nArray(8,()=>new d.TextureMapping);const o=new T(i);if(i.shaderPath.includes("_Phn_")){0!==h.assertExists(y(i,"g_LightingType"))[0]&&o.defines.set("USE_LIGHTING","1")}i.shaderPath.includes("_Water_")&&(this.visible=!1),M(this.textureMapping,r,"g_Diffuse",s,i),M(this.textureMapping,r,"g_Specular",s,i),M(this.textureMapping,r,"g_Bumpmap",s,i),M(this.textureMapping,r,"g_Diffuse_2",s,i),M(this.textureMapping,r,"g_Specular_2",s,i),M(this.textureMapping,r,"g_Bumpmap_2",s,i),M(this.textureMapping,r,"g_Lightmap",s,i);for(let e=0;e<this.textureMapping.length;e++)this.textureMapping[e].gfxSampler=this.flverData.gfxSampler;const c=C(i);let m=!1;0===c?this.megaState={}:2===c?(this.megaState={depthWrite:!1},g.setAttachmentStateSimple(this.megaState,{blendMode:n.GfxBlendMode.ADD,blendSrcFactor:n.GfxBlendFactor.SRC_ALPHA,blendDstFactor:n.GfxBlendFactor.ONE_MINUS_SRC_ALPHA}),m=!0):4===c?(this.megaState={depthWrite:!1},g.setAttachmentStateSimple(this.megaState,{blendMode:n.GfxBlendMode.ADD,blendSrcFactor:n.GfxBlendFactor.SRC_ALPHA,blendDstFactor:n.GfxBlendFactor.ONE}),m=!0):1===c?this.megaState={}:(this.megaState={},console.warn(`Unknown blend mode ${c} in material ${s.mtdName}`));const p=y(i,"g_DiffuseMapColor");if(null!==p){const e=h.assertExists(y(i,"g_DiffuseMapColorPower"))[0];u.vec4.set(this.diffuseColor,p[0],p[1],p[2],e)}const f=y(i,"g_SpecularMapColor");if(null!==f){const e=h.assertExists(y(i,"g_SpecularMapColorPower"))[0];u.vec4.set(this.specularColor,f[0],f[1],f[2],e)}const A=y(i,"g_SpecularPower");null!==A&&(this.specularPower=A[0]);for(let e=0;e<3;e++){const t=y(i,`g_TexScroll_${e}`);t&&u.vec4.set(this.texScroll[e],t[0],t[1],0,0)}this.gfxProgram=e.createProgram(o);const _=m?128:32;this.sortKey=l.makeSortKey(_,0)}prepareToRender(e,t,a,r){if(!this.visible)return;const n=t.pushTemplateRenderInst();n.setSamplerBindingsFromTextureMappings(this.textureMapping),n.setGfxProgram(this.gfxProgram);let s=n.allocateUniformBuffer(T.ub_MeshFragParams,40);const i=n.mapUniformBufferF32(T.ub_MeshFragParams);m.computeViewMatrix(D,a.camera),u.mat4.mul(D,D,r),s+=p.fillMatrix4x3(i,s,D),s+=p.fillVec4v(i,s,this.diffuseColor),s+=p.fillVec4v(i,s,this.specularColor);const c=a.time/120;s+=p.fillVec4v(i,s,u.vec4.scale(U,this.texScroll[0],c)),s+=p.fillVec4v(i,s,u.vec4.scale(U,this.texScroll[1],c)),s+=p.fillVec4v(i,s,u.vec4.scale(U,this.texScroll[2],c)),u.vec4.normalize(U,this.lightDir),u.vec4.transformMat4(U,U,D),u.vec4.normalize(U,U),s+=p.fillVec4v(i,s,U),s+=p.fillVec4(i,s,this.specularPower);const h=m.computeViewSpaceDepthFromWorldSpaceAABB(a.camera,I);for(let e=0;e<this.batchData.batch.primitiveIndexes.length;e++){const a=this.flverData.flver.primitives[this.batchData.batch.primitiveIndexes[e]];if(!_(a))continue;const r=t.pushRenderInst();r.setInputLayoutAndState(this.batchData.inputLayout,this.batchData.inputStates[e]),r.setMegaStateFlags(this.megaState),a.cullMode&&(r.getMegaStateFlags().cullMode=2),r.drawIndexes(o.getTriangleIndexCountForTopologyIndexCount(1,a.indexCount)),r.sortKey=l.setSortKeyDepth(this.sortKey,h)}t.popTemplateRenderInst()}destroy(e){e.destroyProgram(this.gfxProgram)}}const D=u.mat4.create(),I=new f.AABB;class R{constructor(e,t,a,r){this.flverData=r,this.batchInstances=[],this.modelMatrix=u.mat4.create(),this.visible=!0;for(let n=0;n<this.flverData.flver.batches.length;n++){const s=this.flverData.batchData[n],i=s.batch,o=this.flverData.flver.materials[i.materialIndex],l=o.mtdName.split("\\").pop(),c=a.getMaterial(l);this.batchInstances.push(new k(e,r,s,t,o,c))}}setVisible(e){this.visible=e}prepareToRender(e,t,a){if(this.visible&&(I.transform(this.flverData.flver.bbox,this.modelMatrix),a.camera.frustum.contains(I)))for(let r=0;r<this.batchInstances.length;r++)this.batchInstances[r].prepareToRender(e,t,a,this.modelMatrix)}destroy(e){for(let t=0;t<this.batchInstances.length;t++)this.batchInstances[t].destroy(e)}}t.FLVERInstance=R;const B=[{numUniformBuffers:2,numSamplers:8}];function P(e,t){u.mat4.scale(e,e,[-100,100,100]),u.mat4.translate(e,e,t.translation),u.mat4.rotateX(e,e,.01745*t.rotation[0]),u.mat4.rotateY(e,e,.01745*t.rotation[1]),u.mat4.rotateZ(e,e,.01745*t.rotation[2]),u.mat4.scale(e,e,t.scale)}t.MSBRenderer=class{constructor(e,t,a,r,n){this.textureHolder=t,this.modelHolder=a,this.materialDataHolder=r,this.msb=n,this.flverInstances=[],this.lodModels=[];for(let t=0;t<n.parts.length;t++){const a=n.parts[t];if(0===a.type){const t=this.modelHolder.flverData[a.modelIndex];if(void 0===t)continue;const r=new R(e,this.textureHolder,this.materialDataHolder,t);r.visible=!S(a.name),r.name=a.name,P(r.modelMatrix,a),this.flverInstances.push(r)}}}adjustCameraController(e){e.setSceneMoveSpeedMult(20/60)}chooseLODModel(){A.interactiveVizSliderSelect(this.flverInstances,e=>{const t=this.flverInstances[e];this.lodModels.push(t.name),setTimeout(()=>{t.visible=!1},2e3),this.chooseLODModel()})}prepareToRender(e,t,a){const r=t.pushTemplateRenderInst();r.setBindingLayouts(B);const n=r.allocateUniformBuffer(T.ub_SceneParams,16);!function(e,t,a=0){a+=p.fillMatrix4x4(e,a,t.projectionMatrix)}(r.mapUniformBufferF32(T.ub_SceneParams),a.camera,n);for(let r=0;r<this.flverInstances.length;r++)this.flverInstances[r].prepareToRender(e,t,a);t.popTemplateRenderInst()}destroy(e){for(let t=0;t<this.flverInstances.length;t++)this.flverInstances[t].destroy(e);this.modelHolder.destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);class n{constructor(e){this.buffer=e,this.offs=0,this.view=e.createDataView()}assertBlock(e,t,a){r.assert(0===this.readUint32());this.readUint32();const n=this.readUint32();null!==e&&r.assert(n===e);const s=this.readUint32();null!==t&&r.assert(s===t);const i=this.readMarker();return null!==a&&r.assert(i===a),s}readUint8(){return this.view.getUint8(this.offs++)}readMarker(){const e=this.view.getUint8(this.offs+0);return this.offs=r.align(this.offs+1,4),e}assertMarker(e){r.assert(this.readMarker()===e)}readUint32(){const e=this.view.getUint32(this.offs+0,!0);return this.offs+=4,e}assertUint32(e){r.assert(this.readUint32()===e)}readFloat32(){const e=this.view.getFloat32(this.offs+0,!0);return this.offs+=4,e}readMarkedString(e){const t=this.view.getUint32(this.offs+0,!0),a=r.readString(this.buffer,this.offs+4,t,!1);return this.offs+=4+t,this.assertMarker(e),a}}t.parse=function(e){const t=new n(e);t.assertBlock(0,3,1),t.assertBlock(1,2,176),r.assert("MTD "===t.readMarkedString(52)),t.assertUint32(1e3),t.assertMarker(1),t.assertBlock(2,4,163);const a=t.readMarkedString(163),s=t.readMarkedString(3);t.assertUint32(1),t.assertBlock(3,4,163),t.assertUint32(0),t.assertMarker(3);const i=t.readUint32(),o=[];for(let e=0;e<i;e++){t.assertBlock(4,4,163);const e=t.readMarkedString(163),a=t.readMarkedString(4);t.assertUint32(1),t.assertBlock(null,1,null);t.readUint32();let r=[];if("int"===a)r.push(t.readUint32());else if("int2"===a)r.push(t.readUint32()),r.push(t.readUint32());else if("bool"===a)r.push(t.readUint8());else if("float"===a)r.push(t.readFloat32());else if("float2"===a)r.push(t.readFloat32()),r.push(t.readFloat32());else if("float3"===a)r.push(t.readFloat32()),r.push(t.readFloat32()),r.push(t.readFloat32());else{if("float4"!==a)throw"whoops";r.push(t.readFloat32()),r.push(t.readFloat32()),r.push(t.readFloat32()),r.push(t.readFloat32())}t.assertMarker(4),t.assertUint32(0),o.push({name:e,type:a,value:r})}t.assertMarker(3);const l=t.readUint32(),c=[];let h=-1,d=-1;for(let e=0;e<l;e++){const e=t.assertBlock(8192,null,163);r.assert(3===e||5===e);const a=t.readMarkedString(53),n=t.readUint32();t.assertMarker(53);const s=t.readUint32();if(5===e){t.assertUint32(163);t.readMarkedString(186);const e=t.readUint32();for(let a=0;a<e;a++)t.readFloat32()}let i=-1;n===h?i=d:(i=++d,h=n),c.push({name:a,uvNumberUncollapsed:n,uvNumber:i,shaderDataIndex:s})}return t.assertMarker(4),t.assertUint32(0),{shaderPath:a,description:s,params:o,textures:c}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(285)),s=a(286),i=a(1),o=r(a(11)),l=a(0),c=a(13),h=a(9),d=a(23),u=a(118);class m{constructor(e){this.dataFetcher=e,this.filePromiseCache=new Map,this.fileDataCache=new Map}waitForLoad(){const e=[...this.filePromiseCache.values()];return Promise.all(e)}fetchFile(e){l.assert(!this.filePromiseCache.has(e));const t=this.dataFetcher.fetchData(e);return this.filePromiseCache.set(e,t),t}fetchFileData(e){void 0===this.filePromiseCache.get(e)&&this.fetchFile(e).then(t=>{this.fileDataCache.set(e,t)})}getFileData(e){return l.assertExists(this.fileDataCache.get(e))}}function p(e){return`katamari_damacy/1879b0/${e}.bin`}function f(e){return`katamari_damacy/17f590/${e}.bin`}class A{constructor(e){this.objectSpawn=e,this.modelInstance=[]}prepareToRender(e,t,a){for(let r=0;r<this.modelInstance.length;r++)this.modelInstance[r].prepareToRender(e,t,a)}setVisible(e){for(let t=0;t<this.modelInstance.length;t++)this.modelInstance[t].setVisible(e)}setActiveAreaNo(e){const t=e>=this.objectSpawn.dispOnAreaNo&&(e<this.objectSpawn.dispOffAreaNo||-1===this.objectSpawn.dispOffAreaNo);this.setVisible(t)}}class g{constructor(){this.modelInstance=[]}}class _{constructor(e){this.areaIndex=e,this.stageAreaSector=[],this.modelInstance=[]}prepareToRender(e,t,a){for(let r=0;r<this.modelInstance.length;r++)this.modelInstance[r].prepareToRender(e,t,a)}setVisible(e){for(let t=0;t<this.modelInstance.length;t++)this.modelInstance[t].setVisible(e)}setActiveAreaNo(e){this.setVisible(e===this.areaIndex)}}const S=[{numUniformBuffers:2,numSamplers:1}];class b{constructor(e){this.currentAreaNo=0,this.sceneTexture=new h.ColorTexture,this.renderTarget=new h.BasicRenderTarget,this.modelSectorData=[],this.textureHolder=new s.KatamariDamacyTextureHolder,this.stageAreaRenderers=[],this.objectRenderers=[],this.renderHelper=new d.GfxRenderHelper(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(8/60)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.sceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r={gfxTexture:this.sceneTexture.gfxTexture,width:t.backbufferWidth,height:t.backbufferHeight,flipY:!0};this.textureHolder.hasTexture("0290/0000/0000")&&this.textureHolder.setTextureOverride("0290/0000/0000",r),this.textureHolder.hasTexture("01c6/0000/0000")&&this.textureHolder.setTextureOverride("01c6/0000/0000",r),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,h.standardFullClearRenderPassDescriptor,this.sceneTexture.gfxTexture);return this.renderHelper.renderInstManager.drawOnPassRenderer(e,n),this.renderHelper.renderInstManager.resetRenderInsts(),n}serializeSaveState(e,t){return new DataView(e).setUint8(t++,this.currentAreaNo),t}deserializeSaveState(e,t,a){const r=new DataView(e);return t<a&&this.setCurrentAreaNo(r.getUint8(t++)),t}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();r.setBindingLayouts(S);const n=r.allocateUniformBuffer(s.KatamariDamacyProgram.ub_SceneParams,16);!function(e,t,a=0){a+=c.fillMatrix4x4(e,a,t.projectionMatrix)}(r.mapUniformBufferF32(s.KatamariDamacyProgram.ub_SceneParams),a.camera,n);for(let e=0;e<this.stageAreaRenderers.length;e++)this.stageAreaRenderers[e].prepareToRender(this.renderHelper.renderInstManager,this.textureHolder,a);for(let e=0;e<this.objectRenderers.length;e++)this.objectRenderers[e].prepareToRender(this.renderHelper.renderInstManager,this.textureHolder,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}setCurrentAreaNo(e){this.currentAreaNo=e;for(let t=0;t<this.stageAreaRenderers.length;t++)this.stageAreaRenderers[t].setActiveAreaNo(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].setActiveAreaNo(e)}createPanels(){const e=new o.Panel;e.setTitle(o.LAYER_ICON,"Areas"),e.customHeaderBackgroundColor=o.COOL_BLUE_COLOR;const t=new o.SingleSelect;return t.setStrings(this.stageAreaRenderers.map((e,t)=>`Area ${t+1}`)),t.onselectionchange=e=>{const t=this.missionSetupBin.activeStageAreas[e];this.setCurrentAreaNo(t)},t.selectItem(this.currentAreaNo),e.contents.appendChild(t.elem),[e]}destroy(e){this.sceneTexture.destroy(e),this.renderTarget.destroy(e),this.textureHolder.destroy(e),this.renderHelper.destroy(e);for(let t=0;t<this.modelSectorData.length;t++)this.modelSectorData[t].destroy(e)}}class v{constructor(e,t,a,r,n=-1){this.id=e,this.name=t,this.stageAreaFileGroup=a,this.missionSetupFile=r,this.initialAreaNo=n}createScene(e,t){const a=t.dataFetcher,r=new m(a);for(let e=0;e<this.stageAreaFileGroup.length;e++)r.fetchFileData(p(this.stageAreaFileGroup[e].texFile)),r.fetchFileData(p(this.stageAreaFileGroup[e].modelFile));for(let e=0;e<this.missionSetupFile.length;e++)r.fetchFileData(f(this.missionSetupFile[e]));return r.waitForLoad().then(()=>{const t=u.gsMemoryMapNew(),a=new b(e),o=a.renderHelper.getCache(),l=[];for(let e=0;e<this.missionSetupFile.length;e++)l.push(r.getFileData(f(this.missionSetupFile[e])));const c=n.parseMissionSetupBIN(l,t);a.missionSetupBin=c;for(let i=0;i<c.activeStageAreas.length;i++){const l=c.activeStageAreas[i];if(l>=this.stageAreaFileGroup.length)continue;const h=r.getFileData(p(this.stageAreaFileGroup[l].texFile)),d=r.getFileData(p(this.stageAreaFileGroup[l].modelFile));n.parseStageTextureBIN(h,t);const u=n.parseLevelModelBIN(d,t,this.id),m=new _(l);for(let t=0;t<u.sectors.length;t++){const r=u.sectors[t];a.textureHolder.addBINTexture(e,r);const n=new g,i=new s.BINModelSectorData(e,o,r);a.modelSectorData.push(i);for(let t=0;t<r.models.length;t++){const r=new s.BINModelInstance(e,o,a.textureHolder,i.modelData[t]);m.modelInstance.push(r),n.modelInstance.push(r)}m.stageAreaSector.push(n)}a.stageAreaRenderers.push(m)}const h=[];for(let t=0;t<c.objectModels.length;t++){const r=c.objectModels[t];a.textureHolder.addBINTexture(e,r);const n=new s.BINModelSectorData(e,o,r);h.push(n),a.modelSectorData.push(n)}for(let t=0;t<c.objectSpawns.length;t++){const r=c.objectSpawns[t],n=new A(r),l=h[r.modelIndex];for(let t=0;t<l.modelData.length;t++){const c=new s.BINModelInstance(e,o,a.textureHolder,l.modelData[t]);i.mat4.mul(c.modelMatrix,c.modelMatrix,r.modelMatrix),n.modelInstance.push(c)}a.objectRenderers.push(n)}return-1!==this.initialAreaNo&&a.setCurrentAreaNo(c.activeStageAreas[this.initialAreaNo]),a})}}const w=[{texFile:"135049",modelFile:"135b75"},{texFile:"135049",modelFile:"135c43"},{texFile:"135049",modelFile:"135d18"},{texFile:"135049",modelFile:"135ded"}],x=[{texFile:"135231",modelFile:"135ebf"},{texFile:"135231",modelFile:"135fe0"},{texFile:"135231",modelFile:"13612f"},{texFile:"135231",modelFile:"136282"}],T=[{texFile:"1353d1",modelFile:"1363c5"},{texFile:"1353d1",modelFile:"1364a3"},{texFile:"1353d1",modelFile:"136599"},{texFile:"135602",modelFile:"1366d7"},{texFile:"135745",modelFile:"136797"}],y=["Planets",new v("lvl1","Make a Star 1 (House)",w,["13d9bd","13da02","13da55","13daa6"]),new v("lvl2","Make a Star 2 (House)",w,["13daff","13db9c","13dc59","13dd08"]),new v("lvl3","Make a Star 3 (City)",x,["13e462","13e553","13e68e","13e7b1"]),new v("lvl4","Make a Star 4 (House)",w,["13ddc6","13df3f","13e10e","13e2b1"]),new v("lvl5","Make a Star 5 (City)",x,["13e8d2","13ea87","13eca3","13eeb0"]),new v("lvl6","Make a Star 6 (World)",T,["13f0b4","13f244","13f443","13f605"]),new v("lvl7","Make a Star 7 (World)",T,["13f7c8","13f97f","13fbad","13fda5"]),new v("lvl8","Make a Star 8 (City)",x,["13ff91","14017a","1403d3","140616"]),new v("lvl9","Make a Star 9 (World)",T,["140850","140a3e","140cc7","140f02"]),new v("lvl10","Make the Moon (World)",T,["141133","141339","1415d4","141829"]),"Constellations",new v("clvl1","Make Cancer",w,["141ab5","141b43","141bf5","141cae"]),new v("clvl2","Make Cygnus",w,["141d5d","141dfb","141ec1","141f82"]),new v("clvl3","Make Corona Borealis",x,["1422c5","1423de","142542","1426ac"]),new v("clvl4","Make Gemini",T,["14364f","143796","143938","143aae"]),new v("clvl5","Make Ursa Major",x,["14317d","143287","1433dc","143518"]),new v("clvl6","Make Taurus",T,["143c24","143d77","143f34","1440b8"]),new v("clvl7","Make Pisces",x,["142801","14290d","142a52","142b90"]),new v("clvl8","Make Virgo",x,["142cc5","142dd2","142f0e","143046"]),new v("clvl9","Make the North Star",T,["144633","1447b1","1449ba","144b78"],1),"Unused Levels",new v("snow","Snow",[{texFile:"135042",modelFile:"135adb"}],["13d9b1","13d9b3","13d9b5","13d9b8"])],C=new Map;C.set("13698a","lvl1"),t.sceneGroup={id:"katamari_damacy",name:"Katamari Damacy",sceneDescs:y,sceneIdMap:C}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(15)),s=a(0),i=a(4),o=a(12),l=a(1),c=a(118);function h(e){const t=e>>>2&3,a=e>>>0&3,r=function(e){return e+1}(t);if(2===a)return 1*r;if(1===a)return 2*r;if(0===a)return 4*r;if(3===a)return s.assert(3===t),2;throw"whoops"}function d(e,t){const a=t.createDataView(),r=a.getUint8(15);s.assert(80===r,"TAG");const n=0+16*a.getUint16(12,!0);let i=16,o=-1,l=-1,h=-1,d=-1,u=-1,m=-1,p=-1;for(;i<n;){const r=a.getUint32(i+0,!0),n=a.getUint32(i+4,!0),f=a.getUint32(i+8,!0);a.getUint32(i+12,!0);i+=16;const A=32767&r;if(0===A)continue;const g=n>>>26&3;if(0===g){const e=n>>>28&7;s.assert(1===e,"nreg");const t=15&f;s.assert(14===t,"reg");for(let e=0;e<A;e++){const e=a.getUint32(i+0,!0),t=a.getUint32(i+4,!0),r=127&a.getUint8(i+8);80===r?(h=t>>>0&16383,l=t>>>16&63,o=t>>>24&63,s.assert(0===o,"dpsm")):81===r?(m=t>>>0&2047,p=t>>>16&2047):82===r&&(d=e>>>0&4095,u=t>>>0&4095),i+=16}}else 2===g&&(c.gsMemoryMapUploadImage(e,o,h,l,m,p,d,u,t.subarray(i,16*A)),i+=16*A)}return i}function u(e,t,a,r){const n=e.createDataView(),l=n.getUint16(r+0,!0);if(5!==n.getUint16(r+2,!0))return null;const d=[];function u(e,r){let n=d.find(t=>t.tex0_data0===e&&t.tex0_data1===r);return void 0===n&&(n=function(e,t,a,r=""){const n=t>>>0&16383,i=t>>>14&63,o=t>>>20&63,l=t>>>26&15,h=t>>>30&3|(a>>>0&3)<<2,d=a>>>2&3,u=a>>>5&16383,m=a>>>19&15,p=a>>>24&31,f=`${r}/${s.hexzero(n,4)}/${s.hexzero(u,4)}`,A=1<<l,g=1<<h;s.assert(0===m,`Unknown CPSM ${m}`);const _=1===d?-1:128;let S=new Uint8Array(A*g*4);return 20===o?c.gsMemoryMapReadImagePSMT4_PSMCT32(S,e,n,i,A,g,u,p,_):19===o?c.gsMemoryMapReadImagePSMT8_PSMCT32(S,e,n,i,A,g,u,_):console.warn(`Unsupported PSM ${c.psmToString(o)} in texture ${f}`),{name:f,width:A,height:g,pixels:S,tex0_data0:t,tex0_data1:a}}(t,e,r,a),d.push(n)),n.name}let m=r+4;const p=[];for(let e=0;e<l;e++){const e=r+n.getUint32(m+0,!0),t=n.getFloat32(e+0,!0),a=n.getFloat32(e+4,!0),l=n.getFloat32(e+8,!0),c=n.getFloat32(e+16,!0),d=n.getFloat32(e+20,!0),g=n.getFloat32(e+24,!0);s.assert(0===n.getUint32(e+28,!0));const _=new o.AABB(t,a,l,c,d,g),S=e+32,b=S+16*n.getUint16(e+12,!0),v=[];let w=S,x=0,T=0,y=0,C=0,M=null,U=i.colorNewFromRGBA(1,1,1,1),k=null,D={tex0_1_data0:-1,tex0_1_data1:-1,tex1_1_data0:-1,tex1_1_data1:-1,clamp_1_data0:-1,clamp_1_data1:-1,alpha_1_data0:-1,alpha_1_data1:-1,test_1_data0:-1,test_1_data1:-1};const I=32768;let R=-1,B=-1,P=-1,E=!1;const F=()=>{if(x=n.getUint32(w+0,!0),T=n.getUint32(w+4,!0),y=n.getUint32(w+8,!0),C=255&x,M=new Float32Array(9*C),E=!1,1042===y)R=I+1+1*C,B=I+1+2*C,P=I+1+3*C;else{if(65!==y)throw console.warn(`Unknown vertex run flags format code ${y}`),"whoops";R=-1,B=I+1+1*C,P=I+1+2*C,E=!0}};for(;w<b;){const e=n.getUint16(w+0,!0),t=n.getUint8(w+2),a=127&n.getUint8(w+3);if(w+=4,96==(96&a)){const r=15&a,o=e===I;if(!(e>=I)){w+=t*h(r);continue}if(12===r)if(o){s.assert(null===M),F(),w+=16;for(let e=0;e<t-1;e++)M[9*e+0]=n.getFloat32(w+0,!0),M[9*e+1]=n.getFloat32(w+4,!0),M[9*e+2]=n.getFloat32(w+8,!0),M[9*e+3]=n.getUint32(w+12,!0),w+=16}else{s.assert(e===P),s.assert(1===t);const a=n.getFloat32(w+0,!0)/128,r=n.getFloat32(w+4,!0)/128,o=n.getFloat32(w+8,!0)/128,l=n.getFloat32(w+12,!0)/128;i.colorFromRGBA(U,a,r,o,l),w+=16}else if(4===r){s.assert(e===R);for(let e=0;e<t;e++)M[9*e+8]=n.getFloat32(w+4,!0),M[9*e+7]=n.getFloat32(w+0,!0),w+=8}else if(8===r)if(o){s.assert(null===M),F(),w+=12;for(let e=0;e<t-1;e++)M[9*e+0]=n.getFloat32(w+0,!0),M[9*e+1]=n.getFloat32(w+4,!0),M[9*e+2]=n.getFloat32(w+8,!0),M[9*e+3]=0,w+=12}else{s.assert(e===B);for(let e=0;e<t;e++)M[9*e+4]=n.getFloat32(w+0,!0),M[9*e+5]=n.getFloat32(w+4,!0),M[9*e+6]=n.getFloat32(w+4,!0),w+=12}else{if(14!==r)throw console.error(`Unsupported format ${s.hexzero(r,2)}`),"whoops";s.assert(1===t),w+=4}}else if(80==(127&a)){s.assert(null===M);const e=n.getUint32(w+0,!0),t=n.getUint32(w+4,!0),a=n.getUint32(w+8,!0);n.getUint32(w+12,!0);w+=16;const r=32767&e,i=t>>>26&3;s.assert(0===i);const o=t>>>28&7;s.assert(1===o);const l=15&a;s.assert(14===l);for(let e=0;e<r;e++){const e=n.getUint32(w+0,!0),t=n.getUint32(w+4,!0),a=127&n.getUint8(w+8);if(0===a);else if(6===a)k=u(e,t),D.tex0_1_data0=e,D.tex0_1_data1=t;else if(20===a)D.tex1_1_data0=e,D.tex1_1_data1=t;else if(22===a);else if(8===a)D.clamp_1_data0=e,D.clamp_1_data1=t;else if(66===a)D.alpha_1_data0=e,D.alpha_1_data1=t;else{if(71!==a)throw console.warn(`Unknown GS Register ${s.hexzero(a,2)}`),"whoops";D.test_1_data0=e,D.test_1_data1=t}w+=16}s.assertExists(null!==k)}else if(23===a){if(s.assert(null!==M),!E){const e=0==(240&T),t=new Uint16Array(e?3*C-2:C);let a=0;for(let r=0;r<C;r++){const n=M[9*r+3];if(e){if(r<2)continue;if(0!=(49152&n))continue;r%2==0?(t[a++]=r-2,t[a++]=r-1,t[a++]=r):(t[a++]=r-1,t[a++]=r-2,t[a++]=r)}else t[a++]=r}const r=t.slice(0,a),n=k,s=Object.assign({},D);v.push({vertexRunData:M,vertexRunCount:C,indexRunData:r,vertexRunColor:U,textureName:n,gsConfiguration:s})}x=0,T=0,y=0,C=0,M=null}else if(0===a);else if(16===a);else if(17!==a)throw console.error(`Unknown VIF command ${s.hexzero(a,2)}`),"whoops"}let V=0,O=0;for(let e=0;e<v.length;e++)V+=v[e].vertexRunCount,O+=v[e].indexRunData.length;s.assert(V<65535);const N=[];let L=0,G=0,H=0;const j=new Float32Array(8*V),W=new Uint16Array(O);let Z=null;for(let e=0;e<v.length;e++){const t=v[e],a=t.vertexRunData;let r=null!==Z;r&&!i.colorEqual(t.vertexRunColor,Z.diffuseColor)&&(r=!1),r&&t.textureName!==Z.textureName&&(r=!1),r&&(f=t.gsConfiguration,A=Z.gsConfiguration,f.tex0_1_data0!==A.tex0_1_data0||f.tex0_1_data1!==A.tex0_1_data1||f.tex1_1_data0!==A.tex1_1_data0||f.tex1_1_data1!==A.tex1_1_data1||f.clamp_1_data0!==A.clamp_1_data0||f.clamp_1_data1!==A.clamp_1_data1||f.alpha_1_data0!==A.alpha_1_data0||f.alpha_1_data1!==A.alpha_1_data1||f.test_1_data0!==A.test_1_data0||f.test_1_data1!==A.test_1_data1)&&(r=!1),r||(Z={diffuseColor:t.vertexRunColor,indexOffset:H,indexCount:0,textureName:t.textureName,gsConfiguration:t.gsConfiguration},N.push(Z));for(let e=0;e<a.length;e+=9)j[L++]=a[e+0],j[L++]=a[e+1],j[L++]=a[e+2],j[L++]=a[e+4],j[L++]=a[e+5],j[L++]=a[e+6],j[L++]=a[e+7],j[L++]=a[e+8];const n=t.indexRunData;for(let e=0;e<n.length;e++)W[H++]=G+n[e],Z.indexCount++;G+=t.vertexRunCount}p.push({bbox:_,vertexData:j,indexData:W,modelParts:N}),m+=4}var f,A;return{models:p,textures:d}}function m(e,t){return"NIL "===s.readString(e,t,4)}t.parseStageTextureBIN=function(e,t){const a=e.createDataView();a.getUint32(0,!0);let r=a.getUint32(4,!0);for(;r<e.byteLength;)r+=d(t,e.slice(r));s.assert(r===e.byteLength)},t.parseLevelModelBIN=function(e,t,a=""){const r=e.createDataView(),n=r.getUint32(0,!0);s.assert(8===n);const i=[];let o=4;for(let n=0;n<4;n++){const n=r.getUint32(o+0,!0);if(o+=4,m(e,n))continue;const l=s.assertExists(u(e,t,a,n));i.push(l)}return{sectors:i}},t.parseMissionSetupBIN=function(e,t){const a=function(e){if(1===e.length)return e[0];let t=0;for(let a=0;a<e.length;a++)t+=e[a].byteLength;const a=new Uint8Array(t);let r=0;for(let t=0;t<e.length;t++)a.set(e[t].createTypedArray(Uint8Array),r),r+=e[t].byteLength;return new n.default(a.buffer)}(e),r=a.createDataView(),i=r.getUint32(0,!0),o=[],c=[];function h(e){const n=c.find(t=>t.objectId===e);if(void 0!==n)return n.modelIndex;{const n=function(e){const n=9+11*e;s.assert(n+11<=i);const o=4+4*n,l=r.getUint32(o+0,!0),c=(r.getUint32(o+4,!0),r.getUint32(o+8,!0),r.getUint32(o+12,!0)),h=(r.getUint32(o+16,!0),r.getUint32(o+20,!0));return r.getUint32(o+24,!0),r.getUint32(o+28,!0),r.getUint32(o+32,!0),r.getUint32(o+36,!0),r.getUint32(o+40,!0),m(a,l)?null:(m(a,c)||(d(t,a.slice(c)),d(t,a.slice(h))),u(a,t,s.hexzero(e,4),l))}(e);return null===n?-1:(o.push(n),o.length-1)}}const p=l.quat.create(),f=[];let A=20;for(let e=0;e<5;e++){let t=r.getUint32(A,!0);if("NIL "===s.readString(a,t,4)){A+=4;continue}f.push(e);let n=0;for(;;){const a=r.getUint16(t+0,!0),i=r.getUint8(t+2),o=r.getInt8(t+10);let d=!1;if(65535===a)break;switch(0!==i&&(d=!0),a){case 137:case 290:case 381:case 499:case 619:case 631:case 868:case 1438:case 1448:case 1449:d=!0}const u=h(a);if(-1===u&&(console.log(`Missing object ${s.hexzero(a,4)}; layer ${e} object index ${n}`),d=!0),d){t+=64;continue}const m=r.getFloat32(t+16,!0),f=r.getFloat32(t+20,!0),A=r.getFloat32(t+24,!0);s.assert(1===r.getFloat32(t+28,!0));const g=r.getFloat32(t+32,!0),_=r.getFloat32(t+36,!0),S=r.getFloat32(t+40,!0),b=-r.getFloat32(t+44,!0);r.getFloat32(t+48,!0),r.getFloat32(t+52,!0),r.getFloat32(t+56,!0);s.assert(0===r.getUint32(t+60,!0));const v=Math.sin(b/2),w=l.mat4.create();l.quat.set(p,g*v,_*v,S*v,Math.cos(b/2)),l.mat4.fromRotationTranslation(w,p,[m,f,A]);const x={objectId:a,modelIndex:u,dispOnAreaNo:e,dispOffAreaNo:o,modelMatrix:w};c.push(x),t+=64,n++}A+=4}return{objectModels:o,objectSpawns:c,activeStageAreas:f}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(20),s=a(17),i=a(8),o=a(1),l=a(13),c=a(10),h=a(0),d=a(22),u=a(118),m=a(14);class p extends n.DeviceProgram{constructor(e){super(),this.vert=`\n${p.reflectionDeclarations}\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec3 a_Normal;\nlayout(location = 2) in vec2 a_TexCoord;\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_BoneMatrix[0]), vec4(a_Position, 1.0)));\n    v_Normal = normalize(Mul(_Mat4x4(u_NormalMatrix[0]), vec4(a_Normal, 0.0)).xyz);\n    v_TexCoord = Mul(_Mat4x4(u_TextureMatrix[0]), vec4(a_TexCoord, 0.0, 1.0)).xy;\n}\n`,this.frag=this.generateFrag(e)}generateAlphaCompareOp(e,t,a){switch(e){case 1:return"true";case 0:return"false";case 2:return`${t} < ${a}`;case 3:return`${t} <= ${a}`;case 4:return`${t} == ${a}`;case 5:return`${t} >= ${a}`;case 6:return`${t} > ${a}`;case 7:return`${t} != ${a}`}}generateAlphaTest(e,t,a,r){const n=a/255,s=this.generateAlphaCompareOp(t,"t_Color.a",n.toFixed(5));return e&&0===r?`\n    if (!(${s}))\n        discard;\n`:""}generateFrag(e){const t=e.tex0_1_data1>>>3&3;h.assert(0===t);const a=!!(e.test_1_data0>>>0&1),r=e.test_1_data0>>>1&7,n=e.test_1_data0>>>4&255,s=e.test_1_data0>>>12&3;e.test_1_data0,e.test_1_data0;return`\n${p.reflectionDeclarations}\nvoid main() {\n    vec4 t_Color;\n\n    t_Color = texture(u_Texture[0], v_TexCoord);\n    t_Color.rgba *= u_Color.rgba;\n\n    // Basic fake directional.\n    vec3 t_LightDirection = normalize(vec3(0.8, -1, 0.5));\n    float t_LightIntensity = max(dot(-v_Normal, t_LightDirection), 0.0);\n    t_Color.rgb *= mix(0.7, 1.3, t_LightIntensity);\n\n${this.generateAlphaTest(a,r,n,s)}\n\n    gl_FragColor = t_Color;\n}\n`}}t.KatamariDamacyProgram=p,p.a_Position=0,p.a_Normal=1,p.a_TexCoord=2,p.ub_SceneParams=0,p.ub_ModelParams=1,p.reflectionDeclarations="\nprecision mediump float;\n\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n};\n\nlayout(row_major, std140) uniform ub_ModelParams {\n    Mat4x3 u_BoneMatrix[1];\n    Mat4x3 u_NormalMatrix[1];\n    Mat4x2 u_TextureMatrix[1];\n    vec4 u_Color;\n};\n\nuniform sampler2D u_Texture[1];\n\nvarying vec3 v_Normal;\nvarying vec2 v_TexCoord;\n";class f{constructor(e,t,a){this.binModel=a,this.vertexBuffer=s.makeStaticDataBuffer(e,2,this.binModel.vertexData.buffer),this.indexBuffer=s.makeStaticDataBuffer(e,1,this.binModel.indexData.buffer);const n=[{location:p.a_Position,bufferIndex:0,bufferByteOffset:0,format:r.GfxFormat.F32_RGB},{location:p.a_Normal,bufferIndex:0,bufferByteOffset:12,format:r.GfxFormat.F32_RGB},{location:p.a_TexCoord,bufferIndex:0,bufferByteOffset:24,format:r.GfxFormat.F32_RG}],i=[{byteStride:32,frequency:1}],o=r.GfxFormat.U16_R;this.inputLayout=t.createInputLayout(e,{vertexAttributeDescriptors:n,vertexBufferDescriptors:i,indexBufferFormat:o}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}destroy(e){e.destroyBuffer(this.vertexBuffer),e.destroyBuffer(this.indexBuffer),e.destroyInputState(this.inputState)}}var A;function g(e){switch(e){case A.REPEAT:return 1;case A.CLAMP:return 0;case A.REGION_REPEAT:return 1;default:throw"whoops"}}function _(e){switch(e){case 0:return r.GfxCompareMode.NEVER;case 1:return r.GfxCompareMode.ALWAYS;case 2:return r.GfxCompareMode.LEQUAL;case 3:return r.GfxCompareMode.LESS}}function S(e){switch(e){case 1:return[1,0];case 0:return[0,0];case 5:return[1,2];case 4:return[1,1];case 3:return[0,2];case 2:return[0,1];default:throw new Error}}t.BINModelData=f,function(e){e[e.REPEAT=0]="REPEAT",e[e.CLAMP=1]="CLAMP",e[e.REGION_CLAMP=2]="REGION_CLAMP",e[e.REGION_REPEAT=3]="REGION_REPEAT"}(A||(A={}));const b=o.mat4.create();class v{constructor(e,t,a,n){this.binModelPart=n,this.hasDynamicTexture=!1,this.textureMapping=h.nArray(1,()=>new c.TextureMapping);const s=this.binModelPart.gsConfiguration,i=new p(s);this.gfxProgram=t.createProgram(e,i);const o=!!(s.test_1_data0>>>16&1),l=s.test_1_data0>>>17&3;if(h.assert(o),this.megaStateFlags={depthCompare:d.reverseDepthForCompareMode(_(l))},-1===s.alpha_1_data0);else if(68===s.alpha_1_data0)m.setAttachmentStateSimple(this.megaStateFlags,{blendMode:r.GfxBlendMode.ADD,blendSrcFactor:r.GfxBlendFactor.SRC_ALPHA,blendDstFactor:r.GfxBlendFactor.ONE_MINUS_SRC_ALPHA});else{if(72!==s.alpha_1_data0)throw"whoops";m.setAttachmentStateSimple(this.megaStateFlags,{blendMode:r.GfxBlendMode.ADD,blendSrcFactor:r.GfxBlendFactor.SRC_ALPHA,blendDstFactor:r.GfxBlendFactor.ONE})}null!==this.binModelPart.textureName&&(this.hasDynamicTexture=this.binModelPart.textureName.endsWith("/0000/0000"),this.hasDynamicTexture||a.fillTextureMapping(this.textureMapping[0],this.binModelPart.textureName));const u=s.tex1_1_data0>>>0&1,f=s.tex1_1_data0>>>2&7;h.assert(0===u),h.assert(0===f);const A=s.tex1_1_data0>>>5&1,b=s.tex1_1_data0>>>6&7,[v]=S(A),[w,x]=S(b),T=s.clamp_1_data0>>>0&3,y=s.clamp_1_data0>>>2&3,C=g(T),M=g(y);this.gfxSampler=t.createSampler(e,{minFilter:w,magFilter:v,mipFilter:x,wrapS:C,wrapT:M,minLOD:1,maxLOD:1})}prepareToRender(e,t,a,r){const n=e.pushRenderInst();n.setGfxProgram(this.gfxProgram),n.setMegaStateFlags(this.megaStateFlags),this.hasDynamicTexture&&this.binModelPart.textureName&&t.fillTextureMapping(this.textureMapping[0],this.binModelPart.textureName),n.setSamplerBindingsFromTextureMappings(this.textureMapping),n.drawIndexes(this.binModelPart.indexCount,this.binModelPart.indexOffset),this.hasDynamicTexture&&this.textureMapping[0].flipY?(b[5]=-1,b[13]=1):o.mat4.identity(b);let s=n.allocateUniformBuffer(p.ub_ModelParams,36);const i=n.mapUniformBufferF32(p.ub_ModelParams);s+=l.fillMatrix4x3(i,s,a),s+=l.fillMatrix4x3(i,s,r),s+=l.fillMatrix4x2(i,s,b),s+=l.fillColor(i,s,this.binModelPart.diffuseColor)}}t.BINModelPartInstance=v;const w=o.mat4.create(),x={cullMode:2};t.BINModelInstance=class{constructor(e,t,a,r){this.binModelData=r,this.modelMatrix=o.mat4.create(),this.modelParts=[],this.visible=!0,o.mat4.rotateX(this.modelMatrix,this.modelMatrix,Math.PI);for(let r=0;r<this.binModelData.binModel.modelParts.length;r++)this.modelParts.push(new v(e,t,a,this.binModelData.binModel.modelParts[r]))}setVisible(e){this.visible=e}prepareToRender(e,t,a){if(!this.visible)return;const r=e.pushTemplateRenderInst();r.setInputLayoutAndState(this.binModelData.inputLayout,this.binModelData.inputState),r.setMegaStateFlags(x),i.computeViewMatrix(w,a.camera),o.mat4.mul(w,w,this.modelMatrix);for(let a=0;a<this.modelParts.length;a++)this.modelParts[a].prepareToRender(e,t,w,this.modelMatrix);e.popTemplateRenderInst()}};t.BINModelSectorData=class{constructor(e,t,a){this.binModelSector=a,this.modelData=[];for(let r=0;r<a.models.length;r++)this.modelData.push(new f(e,t,a.models[r]))}destroy(e){for(let t=0;t<this.modelData.length;t++)this.modelData[t].destroy(e)}};class T extends c.TextureHolder{addBINTexture(e,t){this.addTextures(e,t.textures)}loadTexture(e,t){const a=e.createTexture(r.makeTextureDescriptor2D(r.GfxFormat.U8_RGBA_NORM,t.width,t.height,1));e.setResourceName(a,t.name);const n=e.createHostAccessPass();return n.uploadTextureData(a,0,[t.pixels]),e.submitPass(n),{gfxTexture:a,viewerTexture:function(e){const t=document.createElement("canvas"),a=e.width,r=e.height,n=e.name;t.width=a,t.height=r,t.title=n;const s=t.getContext("2d"),i=s.createImageData(t.width,t.height);i.data.set(e.pixels),s.putImageData(i,0,0);const o=[t],l=new Map,c=e.tex0_data0>>>20&63;return l.set("Format",u.psmToString(c)),{name:n,surfaces:o,extraInfo:l}}(t)}}}t.KatamariDamacyTextureHolder=T},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(288)),s=r(a(290)),i=a(291),o=a(9),l=a(4),c=r(a(64)),h=a(293),d=a(23);class u{constructor(e){this.textureHolder=new i.PaperMario64TextureHolder,this.modelTreeRenderers=[],this.bgTextureRenderer=null,this.scriptExecutor=null,this.renderTarget=new o.BasicRenderTarget,this.renderHelper=new d.GfxRenderHelper(e),this.clearRenderPassDescriptor=o.makeClearRenderPassDescriptor(!0,l.OpaqueBlack)}adjustCameraController(e){e.setSceneMoveSpeedMult(8/60)}prepareToRender(e,t,a){this.renderHelper.pushTemplateRenderInst(),null!==this.scriptExecutor&&this.scriptExecutor.stepTime(a.time),null!==this.bgTextureRenderer&&this.bgTextureRenderer.prepareToRender(this.renderHelper.renderInstManager,a);for(let t=0;t<this.modelTreeRenderers.length;t++)this.modelTreeRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a);const r=this.renderHelper.renderInstManager;this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,this.clearRenderPassDescriptor);return r.drawOnPassRenderer(e,n),r.resetRenderInsts(),n}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e),this.textureHolder.destroy(e),null!==this.bgTextureRenderer&&this.bgTextureRenderer.destroy(e);for(let t=0;t<this.modelTreeRenderers.length;t++)this.modelTreeRenderers[t].destroy(e)}setBGColor(e){this.clearRenderPassDescriptor=o.makeClearRenderPassDescriptor(!0,e)}setModelTexAnimGroupEnabled(e,t){this.modelTreeRenderers[0].setModelTexAnimGroupEnabled(e,t)}setModelTexAnimGroup(e,t){this.modelTreeRenderers[0].setModelTexAnimGroup(e,t)}setTexAnimGroup(e,t,a,r){this.modelTreeRenderers[0].setTexAnimGroup(e,t,a,r)}}class m{constructor(e,t){this.id=e,this.name=t}async createScene(e,t){const a=t.dataFetcher,r=await a.fetchData(`pm64/${this.id}_arc.crg1`),o=c.parse(r,1),l=new u(e),d=s.parseTextureArchive(o.TexFile);if(l.textureHolder.addTextureArchive(e,d),null!==o.BGTexFile){const t=o.BGTexName,a=s.parseBackground(o.BGTexFile,t);l.textureHolder.addTextures(e,[a]),l.bgTextureRenderer=new i.BackgroundBillboardRenderer(e,l.textureHolder,t)}const m=n.parse(o.ShapeFile),p=new i.PaperMario64ModelTreeRenderer(e,d,l.textureHolder,m.rootNode);l.modelTreeRenderers.push(p);const f=new h.ScriptExecutor(l,o.ROMOverlayData);return f.startFromHeader(o.HeaderAddr),l.scriptExecutor=f,l}}const p=["Goomba Village",new m("kmr_00","Mario Impact Site"),new m("kmr_02","Goomba Village"),new m("kmr_03","Goomba Village Cliff"),new m("kmr_04","Jr. Troopa's Hideout"),new m("kmr_05","Goomba Village Outskirts"),new m("kmr_09","Goomba Road 1"),new m("kmr_06","Goomba Road 2"),new m("kmr_07","Goomba Road 3"),new m("kmr_12","Goomba Road 4"),new m("kmr_11","Goomba King's Fortress"),new m("kmr_10","Toad Town West Gate"),"Toad Town",new m("kmr_20","Mario's House"),new m("mac_00","West Toad Town"),new m("mac_01","Toad Town Plaza"),new m("mac_02","South Toad Town"),new m("mac_03","Toad Town Station"),new m("mac_04","Southwest Toad Town"),new m("mac_05","Toad Town Port"),new m("osr_00","Peach's Castle Courtyard (Normal)"),new m("osr_01","Peach's Castle Courtyard (Ruined)"),new m("mgm_00","Playroom Reception"),new m("mgm_01","Jump Attack Minigame"),new m("mgm_02","Smash Attack Minigame"),new m("kmr_30","Credits Scene"),"Toad Town Tunnels",new m("tik_06","Tunnels Entrance"),new m("tik_18","Toad Town Tunnels 1/3/16"),new m("tik_01","Toad Town Tunnels 1"),new m("tik_02","Toad Town Tunnels 2"),new m("tik_03","Toad Town Tunnels 4"),new m("tik_04","Toad Town Tunnels 5"),new m("tik_05","Toad Town Tunnels 6"),new m("tik_07","Toad Town Tunnels 7"),new m("tik_12","Toad Town Tunnels 8"),new m("tik_08","Toad Town Tunnels 9"),new m("tik_09","Toad Town Tunnels 10"),new m("tik_10","Toad Town Tunnels 11"),new m("tik_20","Toad Town Tunnels 12"),new m("tik_21","Toad Town Tunnels 13"),new m("tik_14","Toad Town Tunnels 14"),new m("tik_15","Rip Cheato's Room"),new m("tik_23","Toad Town Tunnels 15"),new m("tik_25","Ultra Boots Room"),new m("tik_22","Pipe to Frozen Corridor"),new m("tik_17","Pipe to Shiver City"),new m("tik_19","Super Block Room"),"Peach's Castle",new m("osr_02","Outside Peach's Castle (Night)"),new m("kkj_00","First Floor (Day)"),new m("kkj_01","Second Floor (Day)"),new m("kkj_02","Third Floor Stairs (Day)"),new m("kkj_03","Third Floor Hallway (Day) "),new m("kkj_10","First Floor (Night)"),new m("kkj_11","Second Floor (Night)"),new m("kkj_12","Third Floor Stairs (Night)"),new m("kkj_13","Third Floor Hallway (Night)"),new m("kkj_22","Fourth Floor Staircase"),new m("kkj_23","Roof Walkway"),new m("kkj_24","Spire Staircase"),new m("kkj_25","Top of the Castle"),new m("kkj_14","Princess Peach's Room"),new m("kkj_26","Peach's Balcony"),new m("kkj_27","Secret Hallway"),new m("kkj_15","Bowser's Room"),new m("kkj_16","Library"),new m("kkj_17","Storeroom"),new m("kkj_18","Dining Room"),new m("kkj_19","Kitchen"),new m("kkj_20","Guest Bedroom"),new m("kkj_29","Quiz Show Room (Chapter 5)"),new m("kkj_21","Quiz Show Room (Chapter 8)"),new m("kkj_28","Quiz Show Room (???)"),new m("osr_03","Peach's Castle (Bowser Cutscene)"),"Shooting Star Summit",new m("hos_00","Shooting Star Path"),new m("hos_01","Shooting Star Summit"),new m("hos_06","Merluvlee's House"),new m("hos_02","Star Way"),new m("hos_03","Star Haven"),new m("hos_04","Outside Star Sanctuary"),new m("hos_05","Inside Star Sanctuary"),new m("hos_10","Pre-Prologue Cutscene"),new m("hos_20","Star Ship Cutscene"),"Koopa Village",new m("nok_01","South Koopa Village"),new m("nok_02","North Koopa Village"),new m("nok_03","Koopa Village Outskirts"),new m("nok_04","Fuzzy Woods"),new m("nok_11","Pleasant Path 1"),new m("nok_12","Pleasant Path 2"),new m("nok_13","Pleasant Path 3"),new m("nok_14","Pleasant Path 4"),new m("nok_15","Pleasant Path 5"),"Koopa Bros. Fortress",new m("trd_00","Outside Koopa Bros. Fortress"),new m("trd_01","Left Spire"),new m("trd_02","Fortress Left Hall"),new m("trd_03","Fortress Central Hall"),new m("trd_04","Fortress Right Hall"),new m("trd_05","Right Spire Center"),new m("trd_06","Right Spire Basement"),new m("trd_07","Basement Chamber"),new m("trd_08","Basement Hallway"),new m("trd_09","Fortress Bridge"),new m("trd_10","Right Spire Top"),"Mt. Rugged",new m("iwa_00","Mt. Rugged 1"),new m("iwa_01","Mt. Rugged 2"),new m("iwa_02","Mt. Rugged 3"),new m("iwa_03","Mt. Rugged 4"),new m("iwa_04","Mt. Rugged Bridge"),new m("iwa_10","Mt. Rugged Station"),new m("iwa_11","Dry Dry Railroad line"),"Dry Dry Outpost",new m("dro_01","West Dry Dry Outpost"),new m("dro_02","East Dry Dry Outpost"),"Dry Dry Desert",new m("sbk_99","Dry Dry Desert Gateway"),new m("sbk_02","Dry Dry Ruins Entrance"),new m("sbk_56","Desert Oasis"),new m("sbk_00","sbk_00"),new m("sbk_01","sbk_01"),new m("sbk_02","sbk_02"),new m("sbk_04","sbk_04"),new m("sbk_05","sbk_05"),new m("sbk_06","sbk_06"),new m("sbk_10","sbk_10"),new m("sbk_11","sbk_11"),new m("sbk_12","sbk_12"),new m("sbk_13","sbk_13"),new m("sbk_14","sbk_14"),new m("sbk_15","sbk_15"),new m("sbk_16","sbk_16"),new m("sbk_20","sbk_20"),new m("sbk_21","sbk_21"),new m("sbk_22","sbk_22"),new m("sbk_23","sbk_23"),new m("sbk_24","sbk_24"),new m("sbk_25","sbk_25"),new m("sbk_26","sbk_26"),new m("sbk_30","sbk_30"),new m("sbk_31","sbk_31"),new m("sbk_32","sbk_32"),new m("sbk_33","sbk_33"),new m("sbk_34","sbk_34"),new m("sbk_35","sbk_35"),new m("sbk_36","sbk_36"),new m("sbk_40","sbk_40"),new m("sbk_41","sbk_41"),new m("sbk_42","sbk_42"),new m("sbk_43","sbk_43"),new m("sbk_44","sbk_44"),new m("sbk_45","sbk_45"),new m("sbk_46","sbk_46"),new m("sbk_50","sbk_50"),new m("sbk_51","sbk_51"),new m("sbk_52","sbk_52"),new m("sbk_53","sbk_53"),new m("sbk_54","sbk_54"),new m("sbk_55","sbk_55"),new m("sbk_60","sbk_60"),new m("sbk_61","sbk_61"),new m("sbk_62","sbk_62"),new m("sbk_63","sbk_63"),new m("sbk_64","sbk_64"),new m("sbk_65","sbk_65"),new m("sbk_66","sbk_66"),"Dry Dry Ruins",new m("isk_01","Ruins Entrance"),new m("isk_02","Pokey Mummy Corridor 1"),new m("isk_03","Sand Room 1"),new m("isk_04","Staircase Chamber"),new m("isk_05","Pyramid Stone Room"),new m("isk_06","Sand Room 2"),new m("isk_07","Pokey Mummy Corridor 2"),new m("isk_08","Junction Room"),new m("isk_09","Super Hammer Room"),new m("isk_10","Drop-down Chamber"),new m("isk_11","Statue Room"),new m("isk_12","Sand Room 3"),new m("isk_13","Lunar Stone Room"),new m("isk_14","Diamond Stone Room"),new m("isk_16","Tutankoopa's Chamber"),new m("isk_18","Basement Hallway"),new m("isk_19","Save Point Corridor"),"Forever Forest",new m("mim_10","Forever Forest Entrance"),new m("mim_01","Forever Forest 1"),new m("mim_02","Forever Forest 2"),new m("mim_03","Forever Forest 3"),new m("mim_04","Forever Forest 4"),new m("mim_05","Forever Forest 5"),new m("mim_08","Forever Forest 6"),new m("mim_06","Forever Forest 7"),new m("mim_07","Forever Forest 8"),new m("mim_09","Forever Forest 9"),"Boo's Mansion",new m("mim_11","Outside Boo's Mansion"),new m("mim_12","Boo's Mansion Back Gate"),new m("obk_01","Mansion Foyer"),new m("obk_02","Stairs to Basement"),new m("obk_03","Basement Shop"),new m("obk_04","Super Boots Room"),new m("obk_05","Storage Room"),new m("obk_06","Library"),new m("obk_07","Phonograph Room"),new m("obk_08","Record Room"),new m("obk_09","Third Floor"),"Gusty Gulch",new m("arn_07","Outside Windy Mill"),new m("arn_03","Gusty Gulch 1"),new m("arn_05","Gusty Gulch 2"),new m("arn_02","Gusty Gulch 3"),new m("arn_04","Gusty Gulch 4"),new m("dgb_00","Outside Tubba Blubba's Castle"),new m("arn_08","Inside Windy Mill"),new m("arn_09","Windy Mill Well Entrance"),new m("arn_10","Windy Mill Well 1"),new m("arn_12","Windy Mill Well 2"),new m("arn_13","Windy Mill Well 3"),new m("arn_11","Windy Mill Well Arena"),"Tubba Blubba's Castle",new m("dgb_01","Main Hall"),new m("dgb_02","1st Floor Hallway"),new m("dgb_07","Dining Room"),new m("dgb_03","Dual-layer Room"),new m("dgb_05","Staircase above Basement"),new m("dgb_06","Basement"),new m("dgb_04","Staircase to Basement"),new m("dgb_08","2nd Floor Staircase"),new m("dgb_09","2nd Floor Hallway"),new m("dgb_11","Table Room"),new m("dgb_10","Room above Table Room"),new m("dgb_12","Spike Room"),new m("dgb_13","Guest Bedroom"),new m("dgb_14","3rd Floor Staircase"),new m("dgb_15","3rd Floor Hallway"),new m("dgb_16","Nap Room"),new m("dgb_17","Save Point Corridor"),new m("dgb_18","Tubba Blubba's Room"),"Shy Guy's Toybox",new m("omo_03","Blue Station"),new m("omo_13","Blue Station Left Wing"),new m("omo_01","Shy Guy playroom"),new m("omo_04","Blue Station Right Wing"),new m("omo_06","Pink Station"),new m("omo_17","Pink Station Left Wing"),new m("omo_05","Train Track Crossing"),new m("omo_07","Pink Station Right Wing"),new m("omo_08","Green Station"),new m("omo_09","Green Station Right Wing"),new m("omo_10","Red Station"),new m("omo_11","Red Station Left Wing"),new m("omo_12","Big Lantern Guy's Room"),new m("omo_02","Red Station Right Wing"),new m("omo_14","Dark Hallway"),new m("omo_15","General Guy's Arena"),new m("omo_16","Train Track Cutscene"),"Lavalava Island",new m("kgr_01","Whale Entrance"),new m("kgr_02","Whale Belly"),new m("mac_06","Sea Cutscene"),new m("jan_00","Lavalava Island Beach 1"),new m("jan_01","Lavalava Island Beach 2"),new m("jan_02","West Yoshi's Village"),new m("jan_03","East Yoshi's Village"),new m("jan_05","Jade Jungle 1"),new m("jan_04","Jade Jungle 2"),new m("jan_08","Jade Jungle 3"),new m("jan_09","Jade Jungle 4"),new m("jan_10","Jade Jungle 5"),new m("jan_11","Jade Jungle 5 (Underground)"),new m("jan_06","Jade Jungle 6"),new m("jan_07","Jade Jungle 7"),new m("jan_12","Deep Jungle 1"),new m("jan_13","Deep Jungle 2"),new m("jan_14","Deep Jungle 3"),new m("jan_15","Deep Jungle 4"),new m("jan_16","Raven Tree Base"),new m("jan_17","Inside the Tree 1"),new m("jan_18","Raven Tree Middle"),new m("jan_19","Inside the Tree 2"),new m("jan_23","Raphael's Nest"),new m("jan_22","Path to Mt. Lavalava"),"Mt. Lavalava",new m("kzn_01","Mt. Lavalava Entrance"),new m("kzn_02","Lava Corridor 1"),new m("kzn_03","Central Cavern (Left)"),new m("kzn_09","Central Cavern (Right)"),new m("kzn_04","Fire Bar Corridor"),new m("kzn_05","Slope to Block Puzzle"),new m("kzn_06","Block Puzzle Room"),new m("kzn_07","Ultra Hammer Room"),new m("kzn_08","Dizzy Stomp Room"),new m("kzn_10","Spiny Tromp Corridor"),new m("kzn_11","Lava Corridor 2"),new m("kzn_17","Spiny Tromp Puzzle"),new m("kzn_18","Save Point Corridor"),new m("kzn_19","Lava Piranha Arena"),new m("kzn_20","Escape Sequence 1"),new m("kzn_22","Escape Sequence 2"),new m("kzn_23","Volcano Shaft"),"Flower Fields",new m("flo_00","Central Flower Fields"),new m("flo_03","Petunia's Room"),new m("flo_22","Well Room"),new m("flo_07","Posie's Room"),new m("flo_08","Yellow Berry Gate"),new m("flo_09","East Path"),new m("flo_10","Lily's Spring"),new m("flo_11","Hedge Maze"),new m("flo_12","Rosie's Room"),new m("flo_13","Path to Sun Tower"),new m("flo_14","Bubble Flower Room"),new m("flo_15","Sun Tower"),new m("flo_16","Platform Puzzle Room"),new m("flo_17","Path to Puff Puff Machine"),new m("flo_18","Puff Puff Machine Room"),new m("flo_19","Cloudy Climb"),new m("flo_21","Huff N. Puff's Arena"),new m("flo_23","Path to Hedge Maze"),new m("flo_24","Bubble Tree Room"),new m("flo_25","Path to Posie's Room"),"Shiver City",new m("sam_01","West Shiver City"),new m("sam_02","Central Shiver City"),new m("sam_11","East Shiver City"),new m("sam_03","Shiver Snowfield Path"),new m("sam_04","Entrance to Shiver Mountain"),new m("sam_05","Shiver Snowfield"),new m("sam_06","Starborn Valley"),new m("sam_07","Shiver Mountain 1"),new m("sam_08","Shiver Mountain 2"),new m("sam_09","Shiver Mountain 3"),new m("sam_10","Shiver Mountain 4"),new m("sam_12","Madam Merlar's Chamber"),"Crystal Palace",new m("pra_01","Crystal Palace Entrance"),new m("pra_15","Secret Cave"),new m("pra_02","Crystal Palace Foyer"),new m("pra_03","Reflection Puzzle Room (Front)"),new m("pra_04","Reflection Puzzle Room (Back)"),new m("pra_10","Normal Hallway"),new m("pra_05","Normal Chest Room"),new m("pra_09","Bomb Hallway"),new m("pra_11","Bomb Chest Room"),new m("pra_13","Blue Door Corridor"),new m("pra_14","Blue Flipping Room"),new m("pra_16","Red Door Corridor"),new m("pra_18","Clubba Bridge Room"),new m("pra_33","Red Flipping Room"),new m("pra_35","Triple Dip Room"),new m("pra_19","Kooper Clone Puzzle"),new m("pra_20","Junction Room"),new m("pra_21","Dual-Statue Puzzle (Front)"),new m("pra_22","Dual-Statue Puzzle (Back)"),new m("pra_29","Switch Bridge Room"),new m("pra_34","Free Flipping Room"),new m("pra_31","Albino Dino Room"),new m("pra_40","Save Point Corridor"),new m("pra_32","Crystal King Arena"),"Bowser's Castle",new m("kpa_63","Bowser's Castle Hangar"),new m("kpa_60","Castle Courtyard (l/nl)"),new m("kpa_62","Castle Courtyard (l/nl)"),new m("kpa_11","Lava Corridor 1 (Lava)"),new m("kpa_10","Lava Corridor 1 (No Lava)"),new m("kpa_70","Gear Room"),new m("kpa_01","Lower Caves"),new m("kpa_03","Upper Caves"),new m("kpa_04","Block Push Room"),new m("kpa_08","Rising Block Puzzle (Right)"),new m("kpa_09","Rising Block Puzzle (Left)"),new m("kpa_12","Lava Corridor 2"),new m("kpa_13","Lava Corridor 3"),new m("kpa_14","Lava Corridor 4"),new m("kpa_15","Lava Chest Room"),new m("kpa_16","Lava Control Room"),new m("kpa_17","Toad Prison Cell"),new m("kpa_32","Central Hall 1"),new m("kpa_33","Central Hall 2"),new m("kpa_40","Loop Room"),new m("kpa_41","Loop Room 2"),new m("kpa_50","Castle Hallway"),new m("kpa_52","Room Before Loop Room"),new m("kpa_61","Outside Walkway"),new m("kpa_90","Stairs to Toad House (Right)"),new m("kpa_91","Castle Toad House (Right)"),new m("kpa_94","Stairs to Toad House (Left)"),new m("kpa_95","Castle Toad House (Left)"),new m("kpa_96","Storage Room Shop"),new m("kpa_102","2nd to last Corridor"),new m("kpa_111","Block Room 1"),new m("kpa_112","Block Room 2 Hallway"),new m("kpa_113","Block Room 2"),new m("kpa_115","Block Room 3"),new m("kpa_116","Block Room 3 Right Hall"),new m("kpa_117","Treasure Room (Right)"),new m("kpa_118","Block Room 3 Left Hall"),new m("kpa_119","Treasure Room (Left)"),new m("kpa_121","Stairs to Peach's Castle"),new m("kpa_130","B. Bill Blaster Room"),new m("kpa_133","Water Puzzle (Right)"),new m("kpa_134","Water Puzzle (Left)"),"System & Debug Maps",new m("machi","machi"),new m("tst_01","tst_01"),new m("tst_02","tst_02"),new m("tst_03","tst_03"),new m("tst_04","tst_04"),new m("tst_10","tst_10"),new m("tst_11","tst_11"),new m("tst_12","tst_12"),new m("tst_13","tst_13"),new m("tst_20","tst_20"),new m("end_00","end_00"),new m("end_01","end_01"),new m("gv_01","gv_01"),new m("mgm_03","mgm_03")];t.sceneGroup={id:"pm64",name:"Paper Mario 64",sceneDescs:p}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(12),n=a(1),s=a(0),i=a(289);t.parse=function(e){const t=e.createDataView(),a=t.getUint32(0)-2149646336,o=(t.getUint32(4),t.getUint32(8)-2149646336);t.getUint32(12),t.getUint32(16);let l=o,c=0;function h(){const a=t.getUint32(l+0),r=s.readString(e,a-2149646336,48,!0);return l+=4,r}return{rootNode:function a(o){const l=t.getUint32(o+0),d=t.getUint32(o+4)-2149646336,u=t.getUint32(o+8),m=t.getUint32(o+12)-2149646336,p=t.getUint32(o+16);s.assert(u>=6);let f=m;const A=m+12*u;function g(){const a=function(a){const r=t.getUint32(a+0),n=t.getUint32(a+4),i=255&n;if(95===r){return{id:r,type:0,value0:n,value1:t.getUint32(a+8)}}if(0===i){return{id:r,type:i,value0:n,value1:t.getUint32(a+8)}}if(1===i){return{id:r,type:i,value0:n,value1:t.getFloat32(a+8)}}if(2===i){const n=t.getUint32(a+8);if(0!==n){return{id:r,type:i,value:s.readString(e,n-2149646336,48,!0)}}return{id:r,type:i,value:null}}throw"whoops"}(f+0);return f+=12,a}function _(e){const t=g();if(s.assert(t.id===e&&1===t.type),1===t.type)return t.value1;throw"whoops"}const S=_(97),b=_(97),v=_(97),w=_(97),x=_(97),T=_(97),y=new r.AABB(S,b,v,w,x,T);if(2===l){s.assert(0===p);const a=function(e){const t=g();if(s.assert(t.id===e&&2===t.type),2===t.type)return t.value;throw"whoops"}(94),r=[];for(;f<A;)r.push(g());const n=t.getUint32(d+0)-2149646336;s.assert(0===t.getUint32(d+4));const o=new i.RSPState;o.ramAddrBase=2149646336,o.ramBuffer=e,i.runDL_F3DEX2(o,n),o.finish();const u=o.finish();return{type:"leaf",internalType:l,name:h(),id:c++,bbox:y,texEnvName:a,properties:r,rspOutput:u}}{s.assert(6===u||8===u);const e=p-2149646336,r=t.getUint32(e+0),i=t.getUint32(e+12);let o=t.getUint32(e+16)-2149646336;const d=[];for(let e=0;e<i;e++){const e=t.getUint32(o+0)-2149646336;d.push(a(e)),o+=4}const m=7===l?"root":h(),f=n.mat4.create();if(0!==r){const e=r-2149646336;f[0]=(t.getInt16(e+0)<<16|t.getUint16(e+32))/65536,f[1]=(t.getInt16(e+2)<<16|t.getUint16(e+34))/65536,f[2]=(t.getInt16(e+4)<<16|t.getUint16(e+36))/65536,f[3]=(t.getInt16(e+6)<<16|t.getUint16(e+38))/65536,f[4]=(t.getInt16(e+8)<<16|t.getUint16(e+40))/65536,f[5]=(t.getInt16(e+10)<<16|t.getUint16(e+42))/65536,f[6]=(t.getInt16(e+12)<<16|t.getUint16(e+44))/65536,f[7]=(t.getInt16(e+14)<<16|t.getUint16(e+46))/65536,f[8]=(t.getInt16(e+16)<<16|t.getUint16(e+48))/65536,f[9]=(t.getInt16(e+18)<<16|t.getUint16(e+50))/65536,f[10]=(t.getInt16(e+20)<<16|t.getUint16(e+52))/65536,f[11]=(t.getInt16(e+22)<<16|t.getUint16(e+54))/65536,f[12]=(t.getInt16(e+24)<<16|t.getUint16(e+56))/65536,f[13]=(t.getInt16(e+26)<<16|t.getUint16(e+58))/65536,f[14]=(t.getInt16(e+28)<<16|t.getUint16(e+60))/65536,f[15]=(t.getInt16(e+30)<<16|t.getUint16(e+62))/65536}return{type:"group",internalType:l,name:m,id:c++,bbox:y,children:d,modelMatrix:f}}}(a+0)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);class n{constructor(){this.x=0,this.y=0,this.z=0,this.tx=0,this.ty=0,this.c0=0,this.c1=0,this.c2=0,this.a=0}copy(e){this.x=e.x,this.y=e.y,this.z=e.z,this.tx=e.tx,this.ty=e.ty,this.c0=e.c0,this.c1=e.c1,this.c2=e.c2,this.a=e.a}}t.Vertex=n;class s extends n{constructor(){super(...arguments),this.outputIndex=-1}setFromView(e,t){this.outputIndex=-1,this.x=e.getInt16(t+0),this.y=e.getInt16(t+2),this.z=e.getInt16(t+4),this.tx=e.getInt16(t+8)/32,this.ty=e.getInt16(t+10)/32,this.c0=e.getUint8(t+12)/255,this.c1=e.getUint8(t+13)/255,this.c2=e.getUint8(t+14)/255,this.a=e.getUint8(t+15)/255}}class i{constructor(){this.SP_GeometryMode=0,this.indexCount=0,this.firstIndex=0}}t.DrawCall=i;class o{constructor(){this.vertices=[],this.indices=[],this.drawCalls=[],this.newDrawCall()}pushVertex(e){if(-1===e.outputIndex){const t=new n;t.copy(e),this.vertices.push(t),e.outputIndex=this.vertices.length-1}this.indices.push(e.outputIndex),this.currentDrawCall.indexCount++}newDrawCall(){return this.currentDrawCall=new i,this.currentDrawCall.firstIndex=this.indices.length,this.drawCalls.push(this.currentDrawCall),this.currentDrawCall}}t.RSPOutput=o;t.RSPState=class{constructor(){this.output=new o,this.stateChanged=!1,this.vertexCache=r.nArray(64,()=>new s),this.SP_GeometryMode=0}finish(){return this.output}_setGeometryMode(e){this.SP_GeometryMode!==e&&(this.stateChanged=!0,this.SP_GeometryMode=e)}gSPSetGeometryMode(e){this._setGeometryMode(this.SP_GeometryMode|e)}gSPClearGeometryMode(e){this._setGeometryMode(this.SP_GeometryMode&~e)}gSPVertex(e,t,a){const n=e>>>24;r.assert(128===n);const s=this.ramBuffer.createDataView();let i=e-this.ramAddrBase;for(let e=0;e<t;e++)this.vertexCache[a+e].setFromView(s,i),i+=16}_flushDrawCall(){if(this.stateChanged){this.stateChanged=!1,this.output.newDrawCall().SP_GeometryMode=this.SP_GeometryMode}}gSPTri(e,t,a){this._flushDrawCall(),this.output.pushVertex(this.vertexCache[e]),this.output.pushVertex(this.vertexCache[t]),this.output.pushVertex(this.vertexCache[a])}},t.runDL_F3DEX2=function(e,t){const a=e.ramBuffer.createDataView();e:for(let r=16777215&t;;r+=8){const t=a.getUint32(r+0),n=a.getUint32(r+4),s=t>>>24;switch(s){case 223:break e;case 217:e.gSPClearGeometryMode(16777215&t),e.gSPSetGeometryMode(n);break;case 1:{const a=t>>>12&255,r=(t>>>1&255)-a;e.gSPVertex(n,a,r)}break;case 5:{const a=(t>>>16&255)/2,r=(t>>>8&255)/2,n=(t>>>0&255)/2;e.gSPTri(a,r,n)}break;case 6:{const a=(t>>>16&255)/2,r=(t>>>8&255)/2,n=(t>>>0&255)/2;e.gSPTri(a,r,n)}{const t=(n>>>16&255)/2,a=(n>>>8&255)/2,r=(n>>>0&255)/2;e.gSPTri(t,a,r)}break;case 222:break;case 233:case 232:case 231:case 230:break;default:console.error(`Unknown DL opcode: ${s.toString(16)}`)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(76);t.parseTextureArchive=function(e){const t=e.createDataView();function a(e,t,a,r,s,i=!0,l=0){const c=t>>>0&65535,h=(a>>>0&65535)>>>l,d=r>>>0&15,u=s>>>24&15,m=s>>>16&15,p=s>>>8&15,f=o;if(i){const e=n.getSizBitsPerPixel(u)*c*h>>>3;o+=e}return{name:e,width:c,height:h,format:d,siz:u,cms:m,cmt:p,levels:[],dataOffs:f}}function s(e){if(2!==e.format)return null;const a=n.getTLUTSize(e.siz),r=new Uint8Array(4*a);return o+=n.parseTLUT(r,t,o,e.siz,2),r}function i(e,a,s=e.width,i=e.height,o=e.dataOffs){const l=e.format,c=e.siz,h=new Uint8Array(s*i*4);return e.levels.push(h),0===l&&2===c?n.decodeTex_RGBA16(h,t,o,s,i):0===l&&3===c?n.decodeTex_RGBA32(h,t,o,s,i):2===l&&0===c?n.decodeTex_CI4(h,t,o,s,i,r.assertExists(a)):2===l&&1===c?n.decodeTex_CI8(h,t,o,s,i,r.assertExists(a)):3===l&&0===c?n.decodeTex_IA4(h,t,o,s,i):3===l&&1===c?n.decodeTex_IA8(h,t,o,s,i):3===l&&2===c?n.decodeTex_IA16(h,t,o,s,i):4===l&&0===c?n.decodeTex_I4(h,t,o,s,i):4===l&&1===c?n.decodeTex_I8(h,t,o,s,i):void console.warn(`Unknown texture format ${l} / ${c}`)}let o=0;const l=[];for(;o<e.byteLength;){const c=r.readString(e,o+0,32,!0),h=t.getUint32(o+32),d=t.getUint32(o+36),u=t.getUint32(o+40),m=t.getUint32(o+44);o+=48;const p=u>>>16&15,f=u>>>8&255,A=m>>>0&15,g=[];if(0===p){const e=a(c,h>>>0,d>>>0,u>>>0,m>>>0);i(e,s(e)),g.push(e)}else if(1===p){const e=a(c,h>>>0,d>>>0,u>>>0,m>>>0,!1),t=32>>>e.siz,r=n.getSizBitsPerPixel(e.siz);let l=e.width,p=e.height;for(;o+=r*l*p>>>3,!(l<t);)l/=2,p/=2;const f=s(e);let A=e.dataOffs;for(l=e.width,p=e.height;i(e,f,l,p,A),A+=r*l*p>>>3,!(l<t);)l/=2,p/=2;g.push(e)}else if(2===p){const e=a(`${c}0`,h>>>0,d>>>0,u>>>0,m>>>0,!0,1),t=a(`${c}1`,h>>>0,d>>>0,u>>>0,m>>>0,!0,1),r=s(e);i(e,r),i(t,r),g.push(e),g.push(t)}else{if(3!==p)throw"whoops";{const e=a(`${c}0`,h>>>0,d>>>0,u>>>0,m>>>0),t=s(e),r=a(`${c}1`,h>>>16,d>>>16,u>>>4,m>>>4),n=s(r);i(e,t),i(r,n),g.push(e),g.push(r)}}const _=2===g.length;l.push({name:c,images:g,hasSecondImage:_,combineMode:f,texFilter:A})}return{textureEnvironments:l}};t.parseBackground=function(e,t,a=0){const r=e.createDataView(),s=r.getUint32(0)-2149580800,i=r.getUint32(4)-2149580800,o=r.getUint16(12),l=r.getUint16(14),c=n.getTLUTSize(1),h=new Uint8Array(4*c);n.parseTLUT(h,r,i,1,2);const d=new Uint8Array(o*l*4),u=[d];return n.decodeTex_CI8(d,r,s,o,l,h),{name:t,format:2,siz:1,width:o,height:l,levels:u,dataOffs:0,cms:0,cmt:0}}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(292)),s=a(6),i=a(1),o=a(7),l=a(20),c=a(13),h=a(17),d=a(0),u=a(10),m=a(8),p=a(12),f=a(58),A=a(14),g=a(22);class _ extends l.DeviceProgram{constructor(){super(...arguments),this.both=_.program}}_.a_Position=0,_.a_Color=1,_.a_TexCoord=2,_.ub_SceneParams=0,_.ub_DrawParams=1,_.program=n.default;class S{constructor(e,t){this.rspOutput=t;const a=function(e){const t=new Float32Array(10*e.length);let a=0;for(let r=0;r<e.length;r++)t[a++]=e[r].x,t[a++]=e[r].y,t[a++]=e[r].z,t[a++]=0,t[a++]=e[r].tx,t[a++]=e[r].ty,t[a++]=e[r].c0,t[a++]=e[r].c1,t[a++]=e[r].c2,t[a++]=e[r].a;return t.buffer}(this.rspOutput.vertices);this.vertexBuffer=h.makeStaticDataBuffer(e,2,a),d.assert(this.rspOutput.vertices.length<=65535);const r=new Uint16Array(this.rspOutput.indices);this.indexBuffer=h.makeStaticDataBuffer(e,1,r.buffer);const n=[{location:_.a_Position,bufferIndex:0,format:s.GfxFormat.F32_RGB,bufferByteOffset:0},{location:_.a_TexCoord,bufferIndex:0,format:s.GfxFormat.F32_RG,bufferByteOffset:16},{location:_.a_Color,bufferIndex:0,format:s.GfxFormat.F32_RGBA,bufferByteOffset:24}];this.inputLayout=e.createInputLayout({indexBufferFormat:s.GfxFormat.U16_R,vertexAttributeDescriptors:n,vertexBufferDescriptors:[{byteStride:40,frequency:1}]}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}destroy(e){e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}t.N64Data=S;class b extends u.TextureHolder{addTextureArchive(e,t){for(let a=0;a<t.textureEnvironments.length;a++)this.addTextures(e,t.textureEnvironments[a].images)}loadTexture(e,t){const a=e.createTexture(s.makeTextureDescriptor2D(s.GfxFormat.U8_RGBA_NORM,t.width,t.height,t.levels.length));e.setResourceName(a,t.name);const r=e.createHostAccessPass();return r.uploadTextureData(a,0,t.levels),e.submitPass(r),{gfxTexture:a,viewerTexture:function(e){const t=[];for(let a=0;a<e.levels.length;a++){const r=document.createElement("canvas");r.width=e.width>>>a,r.height=e.height>>>a;const n=r.getContext("2d"),s=n.createImageData(r.width,r.height);s.data.set(e.levels[a]),n.putImageData(s,0,0),t.push(r)}const a=new Map;return a.set("Format",f.getImageFormatString(e.format,e.siz)),{name:e.name,extraInfo:a,surfaces:t}}(t)}}}function v(e){switch(e){case 0:return 1;case 1:return 2;case 2:return 0}}t.PaperMario64TextureHolder=b;class w extends l.DeviceProgram{constructor(){super(...arguments),this.both="\nlayout(row_major, std140) uniform ub_Params {\n    vec4 u_ScaleOffset;\n};\n\nuniform sampler2D u_Texture;\n",this.vert=`\nout vec2 v_TexCoord;\n\nvoid main() {\n    vec2 p;\n    p.x = (gl_VertexID == 1) ? 2.0 : 0.0;\n    p.y = (gl_VertexID == 2) ? 2.0 : 0.0;\n    gl_Position.xy = p * vec2(2) - vec2(1);\n    gl_Position.zw = vec2(${g.reverseDepthForDepthOffset(1)}, 1);\n    v_TexCoord = p * u_ScaleOffset.xy + u_ScaleOffset.zw;\n}\n`,this.frag="\nin vec2 v_TexCoord;\n\nvoid main() {\n    vec4 color = texture(u_Texture, v_TexCoord);\n    gl_FragColor = vec4(color.rgb, 1.0);\n}\n"}}function x(e){const t=!!(512&e),a=!!(1024&e);return t&&a?3:t?1:a?2:0}w.ub_Params=0;const T=[{numUniformBuffers:1,numSamplers:1}];var y;function C(e){return e<=10?1/(1<<e):1<<16-e}t.BackgroundBillboardRenderer=class{constructor(e,t,a){this.textureHolder=t,this.textureName=a,this.program=new w,this.textureMappings=d.nArray(1,()=>new u.TextureMapping),this.gfxProgram=e.createProgram(this.program),this.textureHolder.fillTextureMapping(this.textureMappings[0],this.textureName)}prepareToRender(e,t){const a=e.pushRenderInst();a.drawPrimitives(3),a.sortKey=o.makeSortKeyOpaque(0,this.gfxProgram.ResourceUniqueId),a.setInputLayoutAndState(null,null),a.setBindingLayouts(T),a.setGfxProgram(this.gfxProgram),a.allocateUniformBuffer(w.ub_Params,4),a.setSamplerBindingsFromTextureMappings(this.textureMappings);let r=a.getUniformBufferOffset(w.ub_Params);const n=a.mapUniformBufferF32(w.ub_Params),s=t.camera.viewMatrix,i=Math.atan2(-s[2],s[0])/(2*Math.PI)*4,l=t.backbufferWidth/t.backbufferHeight;r+=c.fillVec4(n,r,l,-1,i,0)}destroy(e){e.destroyProgram(this.gfxProgram)}},function(e){e[e.OPA=0]="OPA",e[e.XLU=1]="XLU",e[e.DEC=2]="DEC"}(y||(y={}));const M=i.mat4.create(),U=i.mat4.create(),k=new p.AABB;class D{constructor(e,t,a,r){this.modelTreeLeaf=r,this.gfxSampler=[],this.textureEnvironment=null,this.visible=!0,this.texAnimGroup=-1,this.secondaryTileOffsetS=0,this.secondaryTileOffsetT=0,this.secondaryTileShiftS=0,this.secondaryTileShiftT=0,this.texAnimEnabled=!1,this.textureMapping=d.nArray(2,()=>new u.TextureMapping),this.gfxProgram=null,this.n64Data=new S(e,r.rspOutput);const n=this.modelTreeLeaf.properties.find(e=>92===e.id);void 0!==n&&0===n.type&&(this.renderModeProperty=n.value1);const i=this.modelTreeLeaf.properties.find(e=>95===e.id);if(void 0!==i&&0===i.type&&(this.texAnimGroup=i.value1>>>0&15,this.secondaryTileShiftS=i.value1>>>12&15,this.secondaryTileShiftT=i.value1>>>16&15,this.secondaryTileOffsetS=i.value0>>>0&255,this.secondaryTileOffsetT=i.value0>>>12&255),1===this.renderModeProperty||4===this.renderModeProperty?this.renderMode=y.OPA:13===this.renderModeProperty||16===this.renderModeProperty||19===this.renderModeProperty?this.renderMode=y.DEC:this.renderMode=y.XLU,this.renderMode===y.OPA||this.renderMode===y.DEC?(this.sortKey=o.makeSortKeyOpaque(32,0),this.megaStateFlags={}):this.renderMode===y.XLU&&(this.sortKey=o.makeSortKeyOpaque(128,0),this.megaStateFlags={depthWrite:!1},A.setAttachmentStateSimple(this.megaStateFlags,{blendMode:s.GfxBlendMode.ADD,blendSrcFactor:s.GfxBlendFactor.SRC_ALPHA,blendDstFactor:s.GfxBlendFactor.ONE_MINUS_SRC_ALPHA})),null!==this.modelTreeLeaf.texEnvName){this.textureEnvironment=d.assertExists(t.textureEnvironments.find(e=>e.name===this.modelTreeLeaf.texEnvName));for(let t=0;t<this.textureEnvironment.images.length;t++){const r=this.textureEnvironment.images[t];a.fillTextureMapping(this.textureMapping[t],r.name),this.gfxSampler[t]=e.createSampler({wrapS:v(r.cms),wrapT:v(r.cmt),minFilter:0,magFilter:0,mipFilter:2,minLOD:0,maxLOD:100}),this.textureMapping[t].gfxSampler=this.gfxSampler[t]}}this.createProgram()}computeTextureMatrix(e,t,a){const r=this.textureEnvironment.images[a];let n,s,o,l;if(i.mat4.identity(e),e[0]=1/r.width,e[5]=1/r.height,this.texAnimEnabled&&void 0!==t[this.texAnimGroup]&&i.mat4.mul(e,e,t[this.texAnimGroup].tileMatrix[a]),0===a)n=C(0),s=C(0),o=0,l=0;else{if(1!==a)throw"whoops";n=C(this.secondaryTileShiftS),s=C(this.secondaryTileShiftT),o=this.secondaryTileOffsetS/4,l=this.secondaryTileOffsetT/4}e[0]*=n,e[5]*=s,e[12]+=o,e[13]+=l}setTexAnimEnabled(e){this.texAnimEnabled=e}setTexAnimGroup(e){this.texAnimGroup=e}findModelInstance(e){return this.modelTreeLeaf.id===e?this:null}prepareToRender(e,t,a,r,n){if(!this.visible)return;let s=-1;if(k.transform(this.modelTreeLeaf.bbox,r),!n.camera.frustum.contains(k))return;s=Math.max(0,m.computeViewSpaceDepthFromWorldSpaceAABB(n.camera,k)),null===this.gfxProgram&&(this.gfxProgram=t.gfxRenderCache.createProgram(e,this.program));const l=t.pushTemplateRenderInst();l.setGfxProgram(this.gfxProgram),l.setInputLayoutAndState(this.n64Data.inputLayout,this.n64Data.inputState),l.setSamplerBindingsFromTextureMappings(this.textureMapping),l.setMegaStateFlags(this.megaStateFlags),l.sortKey=this.sortKey;let h=l.allocateUniformBuffer(_.ub_DrawParams,28);const d=l.mapUniformBufferF32(_.ub_DrawParams);i.mat4.mul(M,n.camera.viewMatrix,r),h+=c.fillMatrix4x3(d,h,M),null!==this.textureEnvironment&&(this.computeTextureMatrix(U,a,0),h+=c.fillMatrix4x2(d,h,U),this.textureEnvironment.hasSecondImage&&(this.computeTextureMatrix(U,a,1),h+=c.fillMatrix4x2(d,h,U)));for(let e=0;e<this.n64Data.rspOutput.drawCalls.length;e++){const a=this.n64Data.rspOutput.drawCalls[e],r=t.pushRenderInst();r.drawIndexes(a.indexCount,a.firstIndex),r.getMegaStateFlags().cullMode=x(a.SP_GeometryMode),r.sortKey=o.setSortKeyDepth(r.sortKey,s)}t.popTemplateRenderInst()}setVisible(e){this.visible=e}createProgram(){const e=new _;if(null!==this.textureEnvironment){e.defines.set("USE_TEXTURE","1");const t=this.textureEnvironment.texFilter;if(0===t?e.defines.set("USE_TEXTFILT_POINT","1"):3===t?e.defines.set("USE_TEXTFILT_AVERAGE","1"):2===t&&e.defines.set("USE_TEXTFILT_BILERP","1"),this.textureEnvironment.hasSecondImage){e.defines.set("USE_2CYCLE_MODE","1");const t=this.textureEnvironment.combineMode;0===t||8===t?e.defines.set("USE_COMBINE_MODULATE","1"):13===t?e.defines.set("USE_COMBINE_DIFFERENCE","1"):16===t&&e.defines.set("USE_COMBINE_INTERP","1")}}else e.defines.set("USE_TEXTFILT_POINT","1");this.renderMode===y.DEC&&e.defines.set("USE_ALPHA_MASK","1"),this.gfxProgram=null,this.program=e}destroy(e){this.n64Data.destroy(e);for(let t=0;t<this.gfxSampler.length;t++)e.destroySampler(this.gfxSampler[t])}}class I{constructor(e,t,a=e.name){this.group=e,this.children=t,this.name=a,this.modelMatrixScratch=i.mat4.create()}findModelInstance(e){for(let t=0;t<this.children.length;t++){const a=this.children[t].findModelInstance(e);if(null!==a)return a}return null}setVisible(e){for(let t=0;t<this.children.length;t++)this.children[t].setVisible(e)}prepareToRender(e,t,a,r,n){i.mat4.mul(this.modelMatrixScratch,r,this.group.modelMatrix);for(let r=0;r<this.children.length;r++)this.children[r].prepareToRender(e,t,a,this.modelMatrixScratch,n)}destroy(e){for(let t=0;t<this.children.length;t++)this.children[t].destroy(e)}}class R{constructor(){this.tileMatrix=d.nArray(2,()=>i.mat4.create())}}const B=[{numUniformBuffers:2,numSamplers:2}];t.PaperMario64ModelTreeRenderer=class{constructor(e,t,a,r){this.textureArchive=t,this.textureHolder=a,this.modelTreeRoot=r,this.modelMatrix=i.mat4.create(),this.texAnimGroup=[],this.modelTreeRootInstance=this.translateModelTreeNode(e,r)}translateModelTreeNode(e,t){if("group"===t.type){const a=[];for(let r=0;r<t.children.length;r++)a.push(this.translateModelTreeNode(e,t.children[r]));return new I(t,a)}if("leaf"===t.type)return new D(e,this.textureArchive,this.textureHolder,t);throw"whoops"}prepareToRender(e,t,a){const r=t.pushTemplateRenderInst();r.setBindingLayouts(B);let n=r.allocateUniformBuffer(_.ub_SceneParams,20);const s=r.mapUniformBufferF32(_.ub_SceneParams);n+=c.fillMatrix4x4(s,n,a.camera.projectionMatrix);n+=c.fillVec4(s,n,a.backbufferWidth,a.backbufferHeight,-1.5),this.modelTreeRootInstance.prepareToRender(e,t,this.texAnimGroup,this.modelMatrix,a),t.popTemplateRenderInst()}setModelTexAnimGroupEnabled(e,t){d.assertExists(this.modelTreeRootInstance.findModelInstance(e)).setTexAnimEnabled(t)}setModelTexAnimGroup(e,t){this.texAnimGroup[t]||(this.texAnimGroup[t]=new R);const a=d.assertExists(this.modelTreeRootInstance.findModelInstance(e));a.setTexAnimGroup(t),a.setTexAnimEnabled(!0)}setTexAnimGroup(e,t,a,r){this.texAnimGroup[e]||(this.texAnimGroup[e]=new R);const n=this.texAnimGroup[e].tileMatrix[t];n[12]=a,n[13]=r}destroy(e){this.modelTreeRootInstance.destroy(e)}}},function(e,t,a){"use strict";a.r(t),t.default="\nprecision mediump float;\n\n// Expected to be constant across the entire scene.\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n    vec4 u_Misc0;\n};\n\n#define u_ScreenSize (u_Misc0.xy)\n#define u_LodBias (u_Misc0.z)\n\nlayout(row_major, std140) uniform ub_DrawParams {\n    Mat4x3 u_BoneMatrix[1];\n    Mat4x2 u_TexMatrix[2];\n};\n\nuniform sampler2D u_Texture[2];\n\nvarying vec4 v_Color;\nvarying vec4 v_TexCoord;\n\n#ifdef VERT\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec4 a_Color;\nlayout(location = 2) in vec2 a_TexCoord;\n\nvec3 Monochrome(vec3 t_Color) {\n    // NTSC primaries.\n    return vec3(dot(t_Color.rgb, vec3(0.299, 0.587, 0.114)));\n}\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_BoneMatrix[0]), vec4(a_Position, 1.0)));\n    v_Color = a_Color;\n\n#ifdef USE_MONOCHROME_VERTEX_COLOR\n    v_Color.rgb = Monochrome(v_Color.rgb);\n#endif\n\n    v_TexCoord.xy = Mul(u_TexMatrix[0], vec4(a_TexCoord, 1.0, 1.0));\n    v_TexCoord.zw = Mul(u_TexMatrix[1], vec4(a_TexCoord, 1.0, 1.0));\n}\n#endif\n\n#ifdef FRAG\nvec4 Texture2D_N64_Point(sampler2D t_Texture, vec2 t_TexCoord, float t_LodLevel) {\n    return textureLod(t_Texture, t_TexCoord, t_LodLevel);\n}\n\nvec4 Texture2D_N64_Average(sampler2D t_Texture, vec2 t_TexCoord, float t_LodLevel) {\n    // Unimplemented.\n    return textureLod(t_Texture, t_TexCoord, t_LodLevel);\n}\n\n// Implements N64-style \"triangle bilienar filtering\" with three taps.\n// Based on ArthurCarvalho's implementation, modified by NEC and Jasper for noclip.\nvec4 Texture2D_N64_Bilerp(sampler2D t_Texture, vec2 t_TexCoord, float t_LodLevel) {\n    vec2 t_Size = vec2(textureSize(t_Texture, 0));\n    vec2 t_Offs = fract(t_TexCoord*t_Size - vec2(0.5));\n    t_Offs -= step(1.0, t_Offs.x + t_Offs.y);\n    vec4 t_S0 = textureLod(t_Texture, t_TexCoord - t_Offs / t_Size, t_LodLevel);\n    vec4 t_S1 = textureLod(t_Texture, t_TexCoord - vec2(t_Offs.x - sign(t_Offs.x), t_Offs.y) / t_Size, t_LodLevel);\n    vec4 t_S2 = textureLod(t_Texture, t_TexCoord - vec2(t_Offs.x, t_Offs.y - sign(t_Offs.y)) / t_Size, t_LodLevel);\n    return t_S0 + abs(t_Offs.x)*(t_S1-t_S0) + abs(t_Offs.y)*(t_S2-t_S0);\n}\n\nvec4 Texture2D_N64(sampler2D t_Texture, vec2 t_TexCoord) {\n    vec2 t_Dx = abs(dFdx(t_TexCoord)) * u_ScreenSize;\n    float t_Lod = max(t_Dx.x, t_Dx.y);\n    float t_LodTile = floor(log2(floor(t_Lod)));\n    float t_LodFrac = fract(t_Lod/pow(2.0, t_LodTile));\n    float t_LodLevel = (t_LodTile + t_LodFrac);\n    // TODO(jstpierre): Figure out why we need this LOD bias. I don't believe the N64 even supports one...\n    t_LodLevel += u_LodBias;\n\n#if defined(USE_TEXTFILT_POINT)\n    return Texture2D_N64_Point(t_Texture, t_TexCoord, t_LodLevel);\n#elif defined(USE_TEXTFILT_AVERAGE)\n    return Texture2D_N64_Average(t_Texture, t_TexCoord, t_LodLevel);\n#elif defined(USE_TEXTFILT_BILERP)\n    return Texture2D_N64_Bilerp(t_Texture, t_TexCoord, t_LodLevel);\n#endif\n}\n\nvoid main() {\n    vec4 t_Color = vec4(1.0);\n\n#ifdef USE_TEXTURE\n\n    vec4 t_Texel0 = Texture2D_N64(u_Texture[0], v_TexCoord.xy);\n\n#ifdef USE_2CYCLE_MODE\n\n    vec4 t_Texel1 = Texture2D_N64(u_Texture[1], v_TexCoord.zw);\n#if defined(USE_COMBINE_MODULATE)\n    t_Color = t_Texel0 * t_Texel1 * v_Color;\n#elif defined(USE_COMBINE_DIFFERENCE)\n    t_Color.rgb = v_Color.rgb;\n    t_Color.a = (t_Texel0.a - t_Texel1.a) * v_Color.a;\n#elif defined(USE_COMBINE_INTERP)\n    t_Color.rgb = mix(t_Texel0.rgb, t_Texel1.rgb, v_Color.a);\n    t_Color.a = t_Texel0.a;\n#endif\n\n#else /* USE_2CYCLE_MODE */\n    t_Color = t_Texel0 * v_Color;\n#endif /* USE_2CYCLE_MODE */\n\n#else /* USE_TEXTURE */\n    t_Color = v_Color;\n#endif /* USE_TEXTURE */\n\n#ifdef USE_ALPHA_MASK\n    if (t_Color.a < 0.0125)\n        discard;\n#endif\n\n    gl_FragColor = t_Color;\n}\n#endif\n"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(4);function s(e,t){for(let a=0;a<t.var.length;a++)e.var[a]=t.var[a]}class i{constructor(e){this.start=e,this.var=[],this.parentThread=null,this.boundToParent=!1,this.loopPC=-1,this.loopCount=-1,this.state=0,this.waitOnFrameCount=0,this.pc=e,this.addr=2149842944+e}}function o(e,t,a){switch(e){case 10:return t===a;case 11:return t!==a;case 12:return t<a;case 13:return t>a;case 14:return t<=a;case 15:return t>=a;case 16:return 0!=(t&a);case 17:return 0==(t&a);default:throw"whoops"}}function l(e){return 8+4*e}function c(e,t,a){let r=e.start;for(;;){const e=t.getUint32(r+0),n=t.getUint32(r+4),s=t.getUint32(r+8);if(r+=l(n),3===e&&s===a)return r}}function h(e,t,a){for(;;){const r=e.getUint32(t+0);if(t+=l(e.getUint32(t+4)),r===a)return t;if(5===r&&(t=h(e,t,6)),r>=10&&r<=17&&(t=h(e,t,19)),20===r&&(t=h(e,t,35)),1===r)return-1}}t.ScriptExecutor=class{constructor(e,t){this.scriptHost=e,this.buffer=t,this.threads=[],this.lastTime=-1,this.view=t.createDataView()}startFromHeader(e){const t=e-2149842944,a=this.view.getUint32(t+16);this.startThread(a-2149842944)}startThread(e){const t=new i(e);return this.threads.push(t),t}startChildThread(e,t){const a=this.startThread(t);return s(a,e),a.parentThread=e,a}stepTime(e){let t=1;if(-1!==this.lastTime){t=(e-this.lastTime)/30|0}for(let e=0;e<t;e++)this.stepFrame();t>0&&(this.lastTime=e)}stepFrame(){for(let e=0;e<this.threads.length;e++){const t=this.threads[e];3===t.state&&0==--t.waitOnFrameCount&&(t.state=0)}for(;;){for(let e=0;e<this.threads.length;e++){const t=this.threads[e];t.boundToParent&&null!==t.parentThread&&1===t.parentThread.state&&(t.state=1),0===t.state&&this.stepFrameThread(t),1===t.state&&this.threads.splice(e--,1)}let e=!1;for(let t=0;!e&&t<this.threads.length;t++)e=e||0===this.threads[t].state;if(!e)break}}setVariable(e,t,a){t<-2e7&&(e.var[t+3e7]=a)}getValue(e,t){if(t<-27e7)return t;if(t<=-25e7)throw"whoops";if(t<=-22e7){return(t+23e7)/1024}if(t<=-2e8)return 0;if(t<=-18e7)return 0;if(t<=-16e7){const e=t+17e7;return 0===e?255:(console.warn(`Unknown GameByte flag ${e}`),0)}return t<=-14e7?0:t<=-12e7?0:t<=-1e8?0:t<=-8e7?0:t<=-6e7?0:t<=-4e7?0:t<=-2e7?e.var[t+3e7]:t}callFunction(e,t,a,s){const i=this.view;if(2150410280===t);else if(2150411032===t);else if(2150411672===t){r.assert(4===a);i.getUint32(s+0);const e=i.getUint32(s+4)/255,t=i.getUint32(s+8)/255,o=i.getUint32(s+12)/255,l=n.colorNewFromRGBA(e,t,o);this.scriptHost.setBGColor(l)}else if(2150404616===t){r.assert(2===a);const t=i.getUint32(s+0),n=!!this.getValue(e,i.getUint32(s+4));this.scriptHost.setModelTexAnimGroupEnabled(t,n)}else if(2150404096===t){r.assert(2===a);const t=this.getValue(e,i.getInt32(s+0)),n=this.getValue(e,i.getInt32(s+4));this.scriptHost.setModelTexAnimGroup(t,n)}else if(2150404964===t){r.assert(4===a);const t=this.getValue(e,i.getInt32(s+0)),n=this.getValue(e,i.getInt32(s+4)),o=this.getValue(e,i.getInt32(s+8))/1024,l=this.getValue(e,i.getInt32(s+12))/-1024;this.scriptHost.setTexAnimGroup(t,n,o,l)}return 2}stepFrameThread(e){const t=this.view;let a=e.pc,n=e.pc,i=0;for(;0===e.state;){const d=t.getUint32(a+0),u=t.getUint32(a+4);switch(n+=l(u),++i>1e3&&(e.state=1),d){case 1:return;case 2:e.state=1,null!==e.parentThread&&2===e.parentThread.state&&(s(e.parentThread,e),e.parentThread.state=0);break;case 3:break;case 4:n=c(e,t,t.getUint32(a+8));break;case 5:e.loopPC=n,e.loopCount=t.getUint32(a+8);break;case 6:e.loopCount>0&&(e.loopCount--,0===e.loopCount&&(e.loopCount=-1)),e.loopCount>=0&&(n=e.loopPC);break;case 7:e.loopCount=-1,n=h(t,n,6);break;case 8:e.state=3,e.waitOnFrameCount=t.getUint32(a+8);break;case 9:e.state=3,e.waitOnFrameCount=30*t.getUint32(a+8);break;case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:if(o(d,this.getValue(e,t.getInt32(a+8)),this.getValue(e,t.getInt32(a+12))));else{const e=h(t,n,18);n=e>=0?e:h(t,n,19)}break;case 18:n=h(t,n,19);break;case 19:break;case 20:n=h(t,n,35);break;case 36:case 38:this.setVariable(e,t.getInt32(a+8),this.getValue(e,t.getUint32(a+12)));break;case 39:case 44:{const r=t.getInt32(a+8);this.setVariable(e,r,this.getValue(e,r)+this.getValue(e,t.getInt32(a+12)));break}case 40:case 45:{const r=t.getInt32(a+8);this.setVariable(e,r,this.getValue(e,r)-this.getValue(e,t.getInt32(a+12)));break}case 41:case 46:{const r=t.getInt32(a+8);this.setVariable(e,r,this.getValue(e,r)*this.getValue(e,t.getInt32(a+12)));break}case 42:{const r=t.getInt32(a+8);this.setVariable(e,r,this.getValue(e,r)/this.getValue(e,t.getInt32(a+12))|0);break}case 47:{const r=t.getInt32(a+8);this.setVariable(e,r,this.getValue(e,r)/this.getValue(e,t.getInt32(a+12)));break}case 67:const i=t.getUint32(a+8);if(2!==this.callFunction(e,i,u-1,a+12))return;break;case 68:case 69:{const r=t.getUint32(a+8);r<2150105088&&this.startChildThread(e,r-2149842944);break}case 70:{const r=t.getUint32(a+8);r<2150105088&&(this.startChildThread(e,r-2149842944),e.state=2);break}case 71:case 73:case 77:case 79:case 80:break;case 86:this.startChildThread(e,n),n=h(t,a,87);break;case 87:e.state=1;break;default:console.warn(`Unimplemented command: ${r.hexzero(a,4)}: ${r.hexzero(d,2)} / ${u}`)}a=n}e.pc=a}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(11)),i=r(a(29)),o=a(0),l=a(41),c=a(5),h=n(a(18)),d=a(2);const u={lightingFudge:e=>`${e.matSource} + 0.2`};class m extends c.BasicGXRendererHelper{constructor(e,t,a=new l.RRESTextureHolder){super(e),this.stageRRESes=t,this.textureHolder=a,this.modelInstances=[],this.models=[],this.animationController=new h.default;for(let a=0;a<t.length;a++){const r=t[a];if(this.textureHolder.addRRESTextures(e,r),r.mdl0.length<1)continue;const n=new l.MDL0Model(e,this.getCache(),r.mdl0[0],u);this.models.push(n);const s=new l.MDL0ModelInstance(this.textureHolder,n);this.modelInstances.push(s),s.bindRRESAnimations(this.animationController,r)}}adjustCameraController(e){e.setSceneMoveSpeedMult(.4)}createPanels(){const e=[];if(this.modelInstances.length>1){const t=new s.LayerPanel;t.setLayers(this.modelInstances),e.push(t)}return e}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();c.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}destroy(e){super.destroy(e),this.textureHolder.destroy(e),this.renderHelper.destroy(e);for(let t=0;t<this.models.length;t++)this.models[t].destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e)}}class p{constructor(e,t,a,r){this.id=e,this.stageDir=t,this.name=a,this.rooms=r}createScene(e,t){const a=t.dataFetcher,r=this.rooms.map(e=>function(e,t){return`elb/${e}_${o.leftPad(""+t,2)}_disp01.brres`}(this.stageDir,e)).map(e=>a.fetchData(e));return Promise.all(r).then(t=>{const a=t.map(e=>i.parse(e));return new m(e,a)})}}const f=[new p("stg01","stg01","Mom and Dad's House",d.range(1,18)),new p("stg03","stg03","The Town",[1]),new p("stg02a","stg02","Amusement Park - Main Hub",[1,5]),new p("stg02b","stg02","Amusement Park - Castle",[2]),new p("stg02c","stg02","Amusement Park - Entrance",[3,6]),new p("stg02d","stg02","Amusement Park - Space",[4]),new p("stg04","stg04","Tutorial",[1,2])];t.sceneGroup={id:"elb",name:"Elebits",sceneDescs:f}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(29)),s=r(a(47)),i=a(82);class o extends i.BasicRRESRenderer{adjustCameraController(e){e.setSceneMoveSpeedMult(1/60)}}class l{constructor(e,t){this.id=e,this.name=t}createScene(e,t){return t.dataFetcher.fetchData(`rtdl/${this.id}.brres`).then(e=>s.decompress(e)).then(t=>{const a=n.parse(t);return new o(e,[a])})}}const c=["World Maps",new l("popstarBg","Planet Popstar"),new l("halcandoraBg","Halcandra"),"Level Maps",new l("levelmap1Bg","Level 1 Map"),new l("levelmap2Bg","Level 2 Map"),new l("levelmap3Bg","Level 3 Map"),new l("levelmap4Bg","Level 4 Map"),new l("levelmap5Bg","Level 5 Map"),new l("levelmap6Bg","Level 6 Map"),new l("levelmap7Bg","Level 7 Map"),"Cookie Country",new l("grassBg","Grass Field"),new l("popstarstageBg","Grass Field (Short Lor Version)"),new l("caveBg","Cave 1"),new l("cavenormalBg","Cave 2"),new l("logBg","Whispy Woods"),"Raisin Road",new l("desertBg","Desert"),new l("oasisBg","Oasis"),new l("pyramidBg","Pyramid"),"Onion Ocean",new l("gckbeachBg","Beach"),new l("seaBg","Sea Floor"),new l("seatempleBg","Sea Temple 1"),new l("seatemple2Bg","Sea Temple 2"),"White Wafers",new l("snowBg","Snow Field"),new l("gcksnowmtBg","Snow Mountain"),new l("icebldgBg","Ice Field"),new l("icecaveBg","Ice Cave"),"Nutty Noon",new l("airislandBg","Daytime Tower"),new l("airfortBg","Sunset Tower"),new l("airtempleBg","Space Tower"),"Egg Engines",new l("bridgeBg","Bridge"),new l("factoryBg","Factory"),new l("subwayBg","Subway"),"Dangerous Dinner",new l("lavaBg","Lava Cave"),new l("volcanoBg","Volcano"),new l("landiaBg","Landia Battle"),new l("halcandraBg","Halcandra Stage"),"Ability Challenge Backdrops",new l("challenge1Bg","Challenge 1"),new l("challenge2Bg","Challenge 2"),new l("challenge3Bg","Challenge 3"),new l("challenge4Bg","Challenge 4"),new l("challenge5Bg","Challenge 5"),new l("challenge6Bg","Challenge 6"),new l("challenge7Bg","Challenge 7"),"Another Dimension",new l("lowper2Bg","Another Dimension"),new l("shootingBg","Lor Starcutter Shooter"),new l("finalBg","Final Battle"),"Arena",new l("gckcanyonBg","Boss Rush Canyon"),new l("gckcanyon2Bg","True Arena Rest Point 1"),new l("lowperBg","True Arena Rest Point 2"),new l("sunBg","Galacta Knight Battle")];t.sceneGroup={id:"rtdl",name:"Kirby's Return to Dreamland",sceneDescs:c}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(47)),i=r(a(29)),o=r(a(49)),l=a(41),c=a(9),h=a(5),d=n(a(18)),u=a(0),m=a(16),p=a(7);class f{constructor(e){this.mainRenderTarget=new c.BasicRenderTarget,this.opaqueSceneTexture=new c.ColorTexture,this.modelInstances=[],this.modelData=[],this.textureHolder=new l.RRESTextureHolder,this.animationController=new d.default,this.renderHelper=new h.GXRenderHelperGfx(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(.1)}prepareToRender(e,t,a){this.animationController.setTimeInMilliseconds(a.time);const r=this.renderHelper.pushTemplateRenderInst();h.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}destroy(e){this.textureHolder.destroy(e),this.renderHelper.destroy(e),this.mainRenderTarget.destroy(e),this.opaqueSceneTexture.destroy(e);for(let t=0;t<this.modelData.length;t++)this.modelData[t].destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.mainRenderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.opaqueSceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.mainRenderTarget.createRenderPass(e,t.viewport,c.standardFullClearRenderPassDescriptor);p.executeOnPass(this.renderHelper.renderInstManager,e,r,1),e.submitPass(r);const n=this.mainRenderTarget.createRenderPass(e,t.viewport,c.depthClearRenderPassDescriptor,this.opaqueSceneTexture.gfxTexture);let s;if(p.executeOnPass(this.renderHelper.renderInstManager,e,n,2),p.hasAnyVisible(this.renderHelper.renderInstManager,4)){e.submitPass(n);const a={gfxTexture:this.opaqueSceneTexture.gfxTexture,width:m.EFB_WIDTH,height:m.EFB_HEIGHT,flipY:!0};this.textureHolder.setTextureOverride("ph_dummy128",a);const r=this.mainRenderTarget.createRenderPass(e,t.viewport,c.noClearRenderPassDescriptor);p.executeOnPass(this.renderHelper.renderInstManager,e,r,4),s=r}else s=n;return this.renderHelper.renderInstManager.resetRenderInsts(),s}}class A{constructor(e,t,a=`tex${e.slice(1,3)}.bin`){this.id=e,this.name=t,this.texBinName=a}createScene(e,t){const a=`${this.id}.bin`;function r(e){return t.dataFetcher.fetchData(`klonoa/us/landscape/${e}`).then(e=>0===e.byteLength?e:s.decompress(e))}return Promise.all([r(a),r(this.texBinName)]).then(([t,a])=>{const r=new f(e),n=r.renderHelper.renderInstManager.gfxRenderCache;if(0!==a.byteLength){const t=i.parse(a);r.textureHolder.addRRESTextures(e,t)}const s=o.parse(t),c=s.findFileData("arc/tex.bin");if(null!==c){const t=i.parse(c);r.textureHolder.addRRESTextures(e,t)}for(let t=0;t<4;t++){const a=s.findFileData(`arc/mdl_${t}.bin`);if(null===a)continue;const o=i.parse(a);u.assert(1===o.mdl0.length);const c=new l.MDL0Model(e,n,o.mdl0[0]);r.modelData.push(c);const h=new l.MDL0ModelInstance(r.textureHolder,c);r.modelInstances.push(h),h.passMask=2===t?4:2}const h=s.findFileData("arc/anm.bin");if(null!==h){const e=i.parse(h);for(let t=0;t<r.modelInstances.length;t++){r.modelInstances[t].bindRRESAnimations(r.animationController,e,null)}}return r})}}const g=["The Beginnings of Gale ~Breezegale, the Wind Village~",new A("s110","Vision 1-1, Area 1"),new A("s111","Vision 1-1, Area 2"),new A("s112","Vision 1-1, Area 3"),new A("s113","Vision 1-1, Area 4"),"The Diva and the Dark Spirit ~Guston Mine~",new A("s120","Vision 1-2, Area 1"),new A("s121","Vision 1-2, Area 2"),new A("s122","Vision 1-2, Area 3"),new A("s123","Vision 1-2, Area 4"),new A("s124","Vision 1-2, Area 5"),new A("s125","Vision 1-2, Area 6"),new A("s126","Vision 1-2, Area 7"),new A("s127","Vision 1-2, Area 8"),"Deep in the Dying Forest ~Forlock, the Tree Village~",new A("s210","Vision 2-1, Area 1"),new A("s211","Vision 2-1, Area 2"),new A("s212","Vision 2-1, Area 3"),new A("s213","Vision 2-1, Area 4"),"Beyond the Backwards Waterfall ~The Kingdom of Jugpot~",new A("s220","Vision 2-2, Area 1"),new A("s221","Vision 2-2, Area 2"),new A("s222","Vision 2-2, Area 3"),new A("s223","Vision 2-2, Area 4"),new A("s224","Vision 2-2, Area 5"),new A("s225","Vision 2-2, Area 6"),new A("s226","Vision 2-2, Area 7"),"Rebirth of the Forest ~Forlock, the Tree Village~",new A("s310","Vision 3-1, Area 1"),new A("s311","Vision 3-1, Area 2"),new A("s312","Vision 3-1, Area 3"),new A("s313","Vision 3-1, Area 4"),new A("s314","Vision 3-1, Area 5"),new A("s315","Vision 3-1, Area 6"),"The Stopped Gear ~The Tree Mansion of Machinery~",new A("s320","Vision 3-2, Area 1"),new A("s321","Vision 3-2, Area 2"),new A("s322","Vision 3-2, Area 3"),new A("s323","Vision 3-2, Area 4"),new A("s324","Vision 3-2, Area 5"),new A("s325","Vision 3-2, Area 6"),new A("s326","Vision 3-2, Area 7"),new A("s327","Vision 3-2, Area 8"),new A("s328","Vision 3-2, Area 9"),new A("s329","Vision 3-2, Area 10"),new A("s330","Vision 3-2, Area 11","tex32.bin"),"A Village in Danger ~Breezegale, The Wind Village~",new A("s410","Vision 4-1, Area 1"),new A("s412","Vision 4-1, Area 2"),new A("s413","Vision 4-1, Area 3"),"A Lull in the Wind ~The Leviathan's Ice Cavern~",new A("s420","Vision 4-2, Area 1"),new A("s421","Vision 4-2, Area 2"),new A("s422","Vision 4-2, Area 3"),new A("s423","Vision 4-2, Area 4"),new A("s424","Vision 4-2, Area 5"),new A("s425","Vision 4-2, Area 6"),new A("s426","Vision 4-2, Area 7"),new A("s427","Vision 4-2, Area 8"),new A("s428","Vision 4-2, Area 9"),new A("s430","Vision 4-2, Area 10","tex42.bin"),new A("s431","Vision 4-2, Area 11","tex42.bin"),"The Four Orbs ~Coronia, Temple of the Sun~",new A("s510","Vision 5-1, Area 1"),new A("s511","Vision 5-1, Area 2"),new A("s512","Vision 5-1, Area 3"),new A("s513","Vision 5-1, Area 4"),new A("s514","Vision 5-1, Area 5"),new A("s515","Vision 5-1, Area 6"),new A("s516","Vision 5-1, Area 7"),"Between Light and Darkness ~High Above Coronia~",new A("s520","Vision 5-2, Area 1"),new A("s521","Vision 5-2, Area 2"),new A("s522","Vision 5-2, Area 3"),new A("s523","Vision 5-2, Area 4"),new A("s524","Vision 5-2, Area 5"),new A("s525","Vision 5-2, Area 6"),new A("s526","Vision 5-2, Area 7"),new A("s527","Vision 5-2, Area 8"),new A("s528","Vision 5-2, Area 9"),new A("s530","Vision 5-2, Area 10","tex52.bin"),"The Legendary Kingdom ~Cress, the Moon Kingdom~",new A("s610","Vision 6-1, Area 1"),new A("s611","Vision 6-1, Area 2"),new A("s612","Vision 6-1, Area 3"),new A("s613","Vision 6-1, Area 4"),new A("s614","Vision 6-1, Area 5"),new A("s615","Vision 6-1, Area 6"),new A("s616","Vision 6-1, Area 7"),new A("s617","Vision 6-1, Area 8"),"The Time of Restoration ~The Prism Corridor~",new A("s620","Vision 6-2 Area 1"),new A("s621","Vision 6-2 Area 2"),new A("s622","Vision 6-2 Area 3"),new A("s623","Vision 6-2 Area 4"),new A("s624","Vision 6-2 Area 5"),new A("s625","Vision 6-2 Area 6"),new A("s626","Vision 6-2 Area 7"),new A("s627","Vision 6-2 Area 8"),new A("s630","Vision 6-2 Area 9","tex62.bin"),new A("s631","Vision 6-2 Area 10","tex62.bin"),new A("s632","Vision 6-2 Area 11","tex62.bin"),new A("s633","Vision 6-2 Area 12","tex62.bin"),new A("s634","Vision 6-2 Area 13","tex62.bin"),new A("s635","Vision 6-2 Area 14","tex62.bin"),new A("s636","Vision 6-2 Area 15","tex62.bin"),"Ending",new A("s730","Final Vision, Area 1"),new A("s731","Final Vision, Area 2"),new A("s732","Final Vision, Area 3"),"Klonoa's Grand Gale Strategy ~Balue's Tower~",new A("s810","Bonus Vision, Area 1"),new A("s811","Bonus Vision, Area 2"),new A("s812","Bonus Vision, Area 3"),new A("s813","Bonus Vision, Area 4"),new A("s814","Bonus Vision, Area 5"),new A("s815","Bonus Vision, Area 6"),new A("s816","Bonus Vision, Area 7"),new A("s817","Bonus Vision, Area 8"),new A("s818","Bonus Vision, Area 9"),new A("s820","Bonus Vision, Area 10","tex82.bin"),new A("s821","Bonus Vision, Area 11","tex82.bin"),new A("s822","Bonus Vision, Area 12","tex82.bin"),"Misc. Cutscene & Boss Areas",new A("s000","s000","tex11.bin"),new A("s001","s001","tex11.bin"),new A("s010","s010","tex11.bin"),new A("s020","s020","tex11.bin"),new A("s030","s030","tex11.bin"),new A("s040","s040","tex11.bin"),new A("s043","s043","tex11.bin"),new A("s050","s050","tex11.bin"),new A("s900","s900"),new A("s901","s901"),new A("s902","s902"),new A("s903","s903"),new A("s910","s910"),new A("s911","s911"),new A("s912","s912"),new A("s913","s913"),new A("s920","s920"),new A("s921","s921"),new A("s922","s922"),new A("s923","s923"),new A("s930","s930")];t.sceneGroup={id:"klonoa",name:"Klonoa",sceneDescs:g}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(82);class n{constructor(e,t=e){this.id=e,this.name=t}createScene(e,t){return t.dataFetcher.fetchData(`MarioAndSonicAtTheOlympicGames2012/Terrain/${this.id}`).then(t=>r.createBasicRRESRendererFromU8Buffer(e,t))}}const s=["Dream Events",new n("d110h_cmn1.arc","Dream Hurdles: Battlerock Galaxy"),new n("dcano_cmn1.arc","Dream Rafting: Cheep Cheep River"),new n("deque_cmn1.arc","Dream Equestrian: Moo Moo Meadows"),new n("dfenc_cmn1.arc","Dream Fencing: Ocean Palace"),new n("dlong_cmn1.arc","Dream Long Jump: Yoshi's Picture Book"),new n("dspri_cmn1.arc","Dream Sprint: Bingo Highway"),new n("dsync_cmn1.arc","Dream Spacewalk: Synchro Battle Galaxy"),new n("dthro_cmn1.arc","Dream Discus: Windy Valley"),new n("dtram_cmn1.arc","Dream Trampoline: Crazy Gadget"),new n("dunev_cmn1.arc","Dream Uneven Bars: Grand Metropolis"),"Unique Mapped Olympic Events",new n("eton_c210.arc","Canoe Sprint 1000m: Eton Dorney"),new n("exce_judo.arc","Judo: 3DS Only Event"),new n("hors_beac.arc","Beach Volleyball: Horse Guards Parade"),"London Sports Arena",new n("nor2_badm.arc","Badminton - Doubles"),new n("nor2_ryth.arc","Rhythmic Ribbon"),"Aquatics Centre",new n("aqu1_100m.arc","100m Freestyle"),new n("aqu1_100m_4p.arc","100m Freestyle 4 Players"),new n("aqu1_sync.arc","Synchronised Swimming"),"ExCel London",new n("exce_fenc.arc","Fencing - pe"),new n("exce_tabl.arc","Table Tennis - Singles"),new n("exce_tabl_4p.arc","Table Tennis 4 Players"),"North Greenwich Arena",new n("nor1_tram.arc","Trampoline"),new n("nor1_unev.arc","Uneven Bars"),new n("gree_eque.arc","Equestrian - Show Jumping: Greenwich Park"),"Olympic Stadium",new n("olym_4x1r.arc","4 x 100m Relay"),new n("olym_4x1r_4p.arc","4 x 100m Relay 4 Players"),new n("olym_100m.arc","100m Sprint"),new n("olym_100m_4p.arc","100m Sprint 4 Players"),new n("olym_110h.arc","110m Hurdles"),new n("olym_110h_4p.arc","110m Hurdles 4 Players"),new n("olym_disc.arc","Discus Throw"),new n("olym_hamm.arc","Hammer Throw"),new n("olym_jave.arc","Javelin Throw"),new n("olym_long.arc","Long Jump"),"London Party",new n("pty5_cmn1.arc","London (Day)"),new n("pty6_cmn1.arc","London (Night)"),new n("pty1_cmn1.arc","London (Darkened)"),new n("pty4_cmn1.arc","Vacant Lot Espio Search!"),new n("pty2_cmn1.arc","2D London Map Textures 1"),new n("pty3_cmn1.arc","2D London Map Textures 2"),new n("a5_test.arc","2D London Map Textures Text"),new n("roya_shoo.arc","Shooting - Pistol: The Royal Artillery Barracks"),new n("velo_spri.arc","Track Cycling - Team Pursuit: Velodrome"),new n("wemb_foot.arc","Football: Millennium Stadium"),"Olympic Stadium Testing",new n("a_test.arc","Test 1"),new n("a2_test.arc","Test 2"),new n("a3_test.arc","Test 3"),new n("a4_test.arc","Test 4")];t.sceneGroup={id:"MarioAndSonicAtTheOlympicGames2012",name:"Mario & Sonic at the Olympic Games (2012)",sceneDescs:s}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(41),i=a(1),o=r(a(29)),l=a(0),c=a(5),h=n(a(18)),d=a(2),u=a(8),m=a(9);function p(e){const t=e.createDataView(),a=t.getUint32(0);let r=4;const n=[];for(let s=0;s<a;s++){const i=t.getUint32(r+0);let o;o=s<a-1?t.getUint32(r+4):e.byteLength;const c=l.readString(e,i-24,4,!0),h=l.readString(e,i-20,20,!0),d=e.slice(i,o);n.push({filename:h,type:c,buffer:d}),r+=4}return{files:n}}class f{constructor(e,t,a){this.scrMapEntry=e,this.modelMatrix=t,this.modelInstance=a,this.animationController=new h.default,this.visible=!0,this.transS=0,this.transT=0,i.mat4.copy(this.modelInstance.modelMatrix,this.modelMatrix),3&this.scrMapEntry.flags_08&&d.computeMatrixWithoutRotation(this.modelMatrix,this.modelMatrix)}prepareToRender(e,t,a){if(!this.visible)return;this.animationController.setTimeInMilliseconds(a.time);const r=this.animationController.getTimeInFrames();let n=r*this.scrMapEntry.texSpeedS,s=r*this.scrMapEntry.texSpeedT;64&this.scrMapEntry.flags_0A&&(n*=.1,s*=.1),n/=800,s/=800,16&this.scrMapEntry.flags_0A&&(s=.05*Math.cos(s));const o=this.modelInstance.materialInstances[0].materialData.material.texSrts[0].srtMtx;o[12]=n+this.transS,o[13]=s+this.transT,3&this.scrMapEntry.flags_08&&(u.computeModelMatrixYBillboard(this.modelInstance.modelMatrix,a.camera),i.mat4.mul(this.modelInstance.modelMatrix,this.modelMatrix,this.modelInstance.modelMatrix)),this.modelInstance.prepareToRender(e,t.renderInstManager,a)}destroy(e){this.modelInstance.destroy(e)}}function A(e){const t=e.createDataView();l.assert("scr\0"===l.readString(e,0,4,!1));const a=t.getUint32(4);l.assert(1===a);const r=t.getUint16(8),n=[];let s=16;for(let e=0;e<r;e++){const e=t.getUint32(s+0),a=(t.getInt32(e+0),i.mat4.create()),r=t.getUint32(e+4),o=t.getUint16(e+8),l=t.getUint16(e+10),c=t.getUint16(e+12),h=t.getUint8(e+20),u=t.getUint8(e+21),m=t.getUint16(e+30)/4096,p=t.getUint16(e+32)/4096,f=t.getUint16(e+34)/4096,A=t.getInt16(e+36)/2048*Math.PI,g=t.getInt16(e+38)/2048*Math.PI,_=t.getInt16(e+40)/2048*Math.PI,S=t.getInt16(e+42),b=t.getInt16(e+44),v=t.getInt16(e+46);d.computeModelMatrixSRT(a,m,p,f,A,g,_,S,b,v),n.push({modelIndex:r,flags_08:o,flags_0A:l,flags_0C:c,modelMatrix:a,texSpeedS:h,texSpeedT:u}),s+=4}return{instances:n}}function g(e){const t=e.createDataView();l.assert("scr\0"===l.readString(e,0,4,!1));const a=t.getUint32(4);l.assert(0===a);const r=t.getUint16(8),n=[];let s=16;for(let e=0;e<r;e++){const e=t.getUint32(s+0),a=(t.getInt32(e+0),i.mat4.create()),r=t.getFloat32(e+8),o=t.getFloat32(e+12),l=t.getFloat32(e+16),c=t.getFloat32(e+20),h=t.getFloat32(e+24),u=t.getFloat32(e+28),m=t.getFloat32(e+32),p=t.getFloat32(e+36),f=t.getFloat32(e+40);d.computeModelMatrixSRT(a,r,o,l,c,h,u,m,p,f),n.push({modelMatrix:a}),s+=4}return{instances:n}}class _{constructor(e){this.dataFetcher=e,this.filePromiseCache=new Map,this.scpArchivePromiseCache=new Map,this.scpArchiveCache=new Map}waitForLoad(){const e=[...this.filePromiseCache.values()];return Promise.all(e).then(()=>null)}fetchFile(e){l.assert(!this.filePromiseCache.has(e));const t=this.dataFetcher.fetchData(e);return this.filePromiseCache.set(e,t),t}fetchObjSCPArchive(e,t,a,r){const n=`okami/${l.assertExists(U(a,r))}`;let s=this.scpArchivePromiseCache.get(n);return void 0===s&&(s=this.fetchFile(n).then(e=>e).then(s=>{const i=new C(e,t,s,a,r,n);return this.scpArchiveCache.set(n,i),i}),this.scpArchivePromiseCache.set(n,s)),s}}class S{constructor(e){this.renderTarget=new m.BasicRenderTarget,this.mapPartInstances=[],this.objectInstances=[],this.models=[],this.animationController=new h.default,this.textureHolder=new s.RRESTextureHolder,this.renderHelper=new c.GXRenderHelperGfx(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(8/60)}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();this.animationController.setTimeInMilliseconds(a.time),c.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.mapPartInstances.length;t++)this.mapPartInstances[t].prepareToRender(e,this.renderHelper,a);for(let t=0;t<this.objectInstances.length;t++)this.objectInstances[t].prepareToRender(e,this.renderHelper,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a);const r=this.renderHelper.renderInstManager;this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,m.standardFullClearRenderPassDescriptor);return r.drawOnPassRenderer(e,n),r.resetRenderInsts(),n}destroy(e){this.renderTarget.destroy(e),this.textureHolder.destroy(e),this.renderHelper.destroy(e);for(let t=0;t<this.models.length;t++)this.models[t].destroy(e);for(let t=0;t<this.mapPartInstances.length;t++)this.mapPartInstances[t].destroy(e);for(let t=0;t<this.objectInstances.length;t++)this.objectInstances[t].destroy(e)}}t.OkamiRenderer=S;const b={lightingFudge:e=>`vec4((0.5 * ${e.matSource}).rgb, ${e.matSource}.a)`};function v(e,t){if(68!==t)throw"whoops";e.gxMaterial.ropInfo.blendMode=1,e.gxMaterial.ropInfo.blendSrcFactor=4,e.gxMaterial.ropInfo.blendDstFactor=5}function w(e){if(null===e.nodes[0].bbox)for(let t=1;t<e.nodes.length;t++)if(null!==e.nodes[t].bbox){e.nodes[0].bbox=e.nodes[t].bbox;break}null===e.bbox&&(e.bbox=e.nodes[0].bbox);for(let t=0;t<e.materials.length;t++){const a=e.materials[t];l.assert(1===a.gxMaterial.tevStages.length),a.gxMaterial.tevStages[0].texMap=0}}function x(e,t){if(e.translucent=!0,327709===t)e.gxMaterial.ropInfo.depthWrite=!0,e.gxMaterial.alphaTest.op=1,e.gxMaterial.alphaTest.compareA=4,e.gxMaterial.alphaTest.referenceA=1/255,e.gxMaterial.alphaTest.compareB=0;else if(331777===t)e.gxMaterial.ropInfo.depthWrite=!1,e.gxMaterial.alphaTest.op=1,e.gxMaterial.alphaTest.compareA=7;else{if(0!==t)throw"whoops";e.gxMaterial.ropInfo.depthWrite=!0,e.gxMaterial.alphaTest.op=1,e.gxMaterial.alphaTest.compareA=7}}class T{constructor(e,t,a,r){this.filename=r,this.scrModels=[],this.scr=[],this.scpArc=p(a);const n=this.scpArc.files.find(e=>"BRT"===e.type);if(void 0===n)return;const i=o.parse(n.buffer);t.textureHolder.addRRESTextures(e,i);const c=t.renderHelper.renderInstManager.gfxRenderCache,h=this.scpArc.files.filter(e=>"SCR"===e.type),d=this.scpArc.files.filter(e=>"BRS"===e.type);l.assert(h.length===d.length);for(let a=0;a<h.length;a++){const r=h[a],n=d[a];l.assert(r.filename===n.filename);const i=A(r.buffer);this.scr.push(i);const u=o.parse(n.buffer),m=[];for(let a=0;a<u.mdl0.length;a++){const n=u.mdl0[a];n.name=`${r.filename}/${n.name}`;let o=-1,l=-1,h=-1;for(let e=0;e<i.instances.length;e++){const t=i.instances[e];if(t.modelIndex===a){o=t.flags_08,l=t.flags_0A,h=t.flags_0C;break}}let d=0;o>>>6&1&&(d=327709),(o>>>14&1||l>>>3&1)&&(d=327709),h>>>4&1&&(d=331777),w(n);for(let e=0;e<n.materials.length;e++)v(n.materials[e],68),x(n.materials[e],d);const p=new s.MDL0Model(e,c,u.mdl0[a],b);t.models.push(p),m.push(p)}this.scrModels.push(m)}}createInstances(e,t,a){for(let e=0;e<this.scr.length;e++){const r=this.scr[e],n=this.scrModels[e];for(let e=0;e<r.instances.length;e++){const o=r.instances[e],l=n[o.modelIndex],c=new s.MDL0ModelInstance(t.textureHolder,l,this.filename),h=(240&o.flags_08)>>>4;c.setSortKeyLayer(h);const d=i.mat4.create();i.mat4.mul(d,a,o.modelMatrix);const u=new f(o,d,c);t.mapPartInstances.push(u)}}}}class y{constructor(e,t,a,r){this.objectTypeId=e,this.objectId=t,this.modelMatrix=a,this.modelInstance=r,this.shouldBillboard=function(e,t){switch(e<<8|t){case 2839:case 2841:case 2843:case 2849:case 3009:case 3013:case 3015:case 3056:return!0}return!1}(this.objectTypeId,this.objectId),i.mat4.copy(this.modelInstance.modelMatrix,this.modelMatrix),this.shouldBillboard&&d.computeMatrixWithoutRotation(this.modelMatrix,this.modelMatrix)}prepareToRender(e,t,a){this.shouldBillboard&&(u.computeModelMatrixYBillboard(this.modelInstance.modelMatrix,a.camera),i.mat4.mul(this.modelInstance.modelMatrix,this.modelMatrix,this.modelInstance.modelMatrix)),this.modelInstance.prepareToRender(e,t.renderInstManager,a)}destroy(e){this.modelInstance.destroy(e)}}class C{constructor(e,t,a,r,n,i){this.objectTypeId=r,this.objectId=n,this.filename=i,this.mdModels=[],this.md=[],this.scpArc=p(a);const c=this.scpArc.files.find(e=>"BRT"===e.type);if(void 0===c)return;const h=o.parse(c.buffer);t.textureHolder.addRRESTextures(e,h);const d=t.renderHelper.renderInstManager.gfxRenderCache,u=this.scpArc.files.filter(e=>"MD"===e.type),m=this.scpArc.files.filter(e=>"BRS"===e.type);l.assert(u.length===m.length);for(let a=0;a<u.length;a++){const r=u[a],n=m[a];l.assert(r.filename===n.filename);const i=g(r.buffer);this.md.push(i);const c=o.parse(n.buffer),h=[];for(let a=0;a<c.mdl0.length;a++){const r=c.mdl0[a];w(r);for(let e=0;e<r.materials.length;e++)v(r.materials[e],68),x(r.materials[e],327709);const n=new s.MDL0Model(e,d,c.mdl0[a],b);t.models.push(n),h.push(n)}this.mdModels.push(h)}}createInstances(e,t,a){for(let e=0;e<this.md.length;e++){const r=this.md[e],n=this.mdModels[e];for(let e=0;e<r.instances.length;e++){const o=r.instances[e],l=n[e],c=new s.MDL0ModelInstance(t.textureHolder,l,this.filename);c.setSortKeyLayer(240);const h=i.mat4.create();i.mat4.mul(h,a,o.modelMatrix);const d=new y(this.objectTypeId,this.objectId,h,c);t.objectInstances.push(d)}}}}const M=[null,"pl","em","et","hm","an","wp",null,"ut","gt","it","vt","dr","md","es",null];function U(e,t){const a=M[e];return null===a?null:`${a}${l.hexzero(t,2).toLowerCase()}.dat`}class k{constructor(e,t){this.id=e,this.name=t}spawnObjectTable(e,t,a,r){const n=r.createDataView(),s=n.getUint16(0);let o=4;for(let r=0;r<s;r++){const r=n.getUint8(o+0),s=n.getUint8(o+1),l=n.getUint8(o+4)/20,c=n.getUint8(o+5)/20,h=n.getUint8(o+6)/20,u=n.getUint8(o+7)/90*Math.PI,m=n.getUint8(o+8)/90*Math.PI,p=n.getUint8(o+9)/90*Math.PI,f=n.getInt16(o+10),A=n.getInt16(o+12),g=n.getInt16(o+14);o+=32;const _=i.mat4.create();d.computeModelMatrixSRT(_,l,c,h,u,m,p,f,A,g),null!==U(r,s)&&a.fetchObjSCPArchive(e,t,r,s).then(a=>{a.createInstances(e,t,_)})}}createScene(e,t){const a=t.dataFetcher;return a.fetchData(`okami/${this.id}.dat`).then(r=>{const n=new S(e);t.destroyablePool.push(n);const s=p(r),o=s.files.find(e=>"SCP"===e.type),l=new T(e,n,o.buffer,o.filename),c=i.mat4.create();l.createInstances(e,n,c);const h=new _(a),d=s.files.find(e=>"TSC"===e.type);this.spawnObjectTable(e,n,h,d.buffer);const u=s.files.find(e=>"TRE"===e.type);return this.spawnObjectTable(e,n,h,u.buffer),h.waitForLoad().then(()=>n)})}}const D=[new k("r122","River of the Heavens - Area 1"),new k("r101","River of the Heavens - Area 2"),new k("r100","Kamiki Village (Cursed)"),new k("r102","Kamiki Village"),new k("r103","Hana Valley"),new k("r104","Tsuta Ruins"),new k("r106","Tsuta Ruins - Spider Queen Arena"),new k("r105","Sei-An City Checkpoint"),new k("r107","Gale Shrine - Peak"),new k("r108","Kusa Village"),new k("r109","Sasa Sanctuary - Exterior"),new k("r10a","Madame Fawn's House"),new k("r10c","Onigiri-Sensei's Dojo"),new k("r10d","Gale Shrine - Crimson Helm Arena"),new k("r10e","Moon Cave - Calcified Cavern"),new k("r110","Moon Cave"),new k("r111","Moon Cave - Orochi Arena"),new k("r112","Kamiki Village"),new k("r114","Divine Spring 1"),new k("r115","Divine Spring 2"),new k("r116","Divine Spring 3"),new k("r117","Divine Spring 4"),new k("r118","Divine Spring 5"),new k("r119","Divine Spring 6"),new k("r11c","Divine Spring 7"),new k("r11d","Divine Spring 8"),new k("r113","Bandit Spider and Devil Gate Arena 1"),new k("r11a","Bandit Spider and Devil Gate Arena 2"),new k("r11b","Bandit Spider and Devil Gate Arena 3"),new k("r120","Moon Cave - Orochi Arena (No Bell)"),new k("r200","Sei'an City - Arisocratic Quarter (Cursed)"),new k("r201","Sei'an City - Commoner's Quarter"),new k("r202","Himiko Palace"),new k("r203","Dragon Palace - Exterior"),new k("r204","Inside the Water Dragon - Area 1"),new k("r205","Sunken Ship"),new k("r206","Emperor's Palace - Area 1"),new k("r207","Emperor's Palace - Area 2"),new k("r208","Oni Island - Area 1"),new k("r209","Oni Island - Ninetails Arena"),new k("r20a","Catcall Tower"),new k("r20b","Emperor's Body - Blight Arena"),new k("r20d","Oni Island - Exterior Area"),new k("r20e","Oni Island - Area 3"),new k("r20f","Oni Island - Area 2"),new k("r301","Wep'keer"),new k("r302","Kamiki Village (Spirit Gate)"),new k("r303","Wawku Shrine"),new k("r304","Wawku Shrine - Lechku & Nechku Arena 2"),new k("r305","Ponc'tan"),new k("r306","Moon Cave - True Orochi Arena"),new k("r307","Ark of Yamato - Interior Hub"),new k("r308","Ark of Yamato - Spider Queen Arena"),new k("r309","Ark of Yamato - True Orochi Arena"),new k("r30a","Ark of Yamato - Blight Arena"),new k("r30b","Ark of Yamato - Ninetails Arena"),new k("r30c","Ark of Yamato - Crimson Helm Arena"),new k("r30d","Ponc'tan - Mrs. Seal's House"),new k("r310","Yoshpet"),new k("r311","Inner Yoshpet"),new k("r312","Ark of Yamato - Yami Arena"),new k("r313","Wep'keer - Snowball Playground"),new k("r314","Wawku Shrine - Lechku & Nechku Arena 1"),new k("rf01","Shinshu Field (Cursed)"),new k("rf02","Shinshu Field"),new k("rf03","Agata Forest (Cursed)"),new k("rf04","Agata Forest"),new k("rf06","Moon Cave (Exterior, Cursed)"),new k("rf07","Taka Pass (Cursed)"),new k("rf08","Taka Pass"),new k("rf09","South Ryoshima Coast (Cursed)"),new k("rf0a","South Ryoshima Coast"),new k("rf0c","North Ryoshima Coast (Oni Island Entrance)"),new k("rf10","Kamui (Beta Version)"),new k("rf11","Kamui (Cursed)"),new k("rf12","Kamui"),new k("rf13","Kamui (Ezofuji)"),new k("rf20","Shinshu Field (Spirit Gate)"),new k("rf21","Moon Cave (Exterior, Cursed, Less Wind)"),new k("re00","Ending Credits: Sei'an City - Gojo Bridge"),new k("re01","Ending Credits: Sei'an City - Aristocratic Quarter"),new k("re02","Ending Credits: Agata Forest"),new k("re03","Ending Credits: Kamui"),new k("re04","Ending Credits: North Ryoshima Coast")];t.sceneGroup={id:"okami",name:"Okami",sceneDescs:D}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(49)),i=r(a(29)),o=a(1),l=a(0),c=a(41),h=n(a(18)),d=a(5),u=a(9),m=a(7);var p;!function(e){e[e.SKYBOX=1]="SKYBOX",e[e.MAIN=2]="MAIN"}(p||(p={}));class f{constructor(e){this.renderTarget=new u.BasicRenderTarget,this.textureHolder=new c.RRESTextureHolder,this.animationController=new h.default,this.modelInstances=[],this.modelData=[],this.renderHelper=new d.GXRenderHelperGfx(e)}prepareToRender(e,t,a){this.animationController.setTimeInMilliseconds(a.time);const r=this.renderHelper.pushTemplateRenderInst();d.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,u.standardFullClearRenderPassDescriptor);m.executeOnPass(this.renderHelper.renderInstManager,e,r,p.SKYBOX),e.submitPass(r);const n=this.renderTarget.createRenderPass(e,t.viewport,u.depthClearRenderPassDescriptor);return m.executeOnPass(this.renderHelper.renderInstManager,e,n,p.MAIN),this.renderHelper.renderInstManager.resetRenderInsts(),n}destroy(e){this.textureHolder.destroy(e),this.renderTarget.destroy(e),this.renderHelper.destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e);for(let t=0;t<this.modelData.length;t++)this.modelData[t].destroy(e)}}const A={lightingFudge:e=>`${e.ambSource} + 0.6`};class g{constructor(e,t){this.id=e,this.name=t}createScene(e,t){const a=t.dataFetcher,r=`sonic_colors/${this.id}`,n=`${r}/${this.id}_cmn.arc`,h=`${r}/${this.id}_tex.brres`;return Promise.all([a.fetchData(n),a.fetchData(h)]).then(([n,h])=>{const d=s.parse(n),u=function(e){const t=e.createDataView();l.assert("BINA"===l.readString(e,24,4));const a=t.getUint32(36,!1),r=[];let n=44;for(let s=0;s<a;s++){const a=32+t.getUint32(n+0),i=l.readString(e,a),c=t.getUint32(n+4);l.assert(c===s);t.getUint32(n+8);const h=t.getFloat32(n+12),d=t.getFloat32(n+16),u=t.getFloat32(n+20),m=o.vec3.fromValues(h,d,u);r.push({index:c,filename:i,translation:m}),n+=24}return{entries:r}}(l.assertExists(d.findFile(`arc/${this.id}_map.map.bin`)).buffer),m=i.parse(h),g=new f(e);t.destroyablePool.push(g);const _=g.renderHelper.renderInstManager.gfxRenderCache;return g.textureHolder.addRRESTextures(e,m),Promise.all(u.entries.map(e=>{const t=`${r}/${e.filename}.arc`;return a.fetchData(t)})).then(t=>{const a=i.parse(l.assertExists(d.findFile(`arc/${this.id}_sky.brres`)).buffer);let r=null;const n=d.findFileData(`arc/${this.id}_mot.brres`);null!==n&&(r=i.parse(n));const o=new c.MDL0Model(e,_,a.mdl0[0],A),h=new c.MDL0ModelInstance(g.textureHolder,o);h.isSkybox=!0,h.passMask=p.SKYBOX,g.modelData.push(o),g.modelInstances.push(h);for(let a=0;a<u.entries.length;a++){u.entries[a];const n=s.parse(t[a]),o=l.assertExists(n.findDir("arc"));for(let t=0;t<o.files.length;t++){const a=i.parse(o.files[t].buffer);l.assert(1===a.mdl0.length);const n=new c.MDL0Model(e,_,a.mdl0[0],A),s=new c.MDL0ModelInstance(g.textureHolder,n);s.passMask=p.MAIN,r&&s.bindRRESAnimations(g.animationController,r),g.modelData.push(n),g.modelInstances.push(s)}}return g})})}}const _=["Tropical Resort",new g("stg110","Act 1-2, 4"),new g("stg120","Act 3, 5-6"),new g("stg190","Rotatotron Boss Arena"),"Sweet Mountain",new g("stg210","Act 1-2, 6"),new g("stg220","Act 3-5"),new g("stg290","Captain Jelly Boss Arena"),"Planet Wisp",new g("stg410","Act 1-4"),new g("stg420","Act 5-6"),new g("stg490","Refreshinator Boss Arena"),"Aquarium Park",new g("stg510","Act 1, 3-5"),new g("stg520","Act 2, 6"),new g("stg590","Admiral Jelly Boss Arena"),"Asteroid Coaster",new g("stg610","Act 1-5"),new g("stg620","Act 6"),new g("stg690","Figate Skullian Boss Arena"),"Terminal Velocity",new g("stg710","Act 1"),new g("stg720","Act 2"),new g("stg790","Nega-Wisp Armor Boss Arena")];t.sceneGroup={id:"sonic_colors",name:"Sonic Colors",sceneDescs:_}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(29)),i=r(a(47)),o=r(a(11)),l=a(0),c=a(41),h=n(a(18)),d=a(5);function u(e){const t=l.readString(e,0,6,!1);l.assert("ARC\0"===t);const a=e.createDataView(),r=a.getUint16(6),n=l.readString(e,16,48,!0),s=[];let i=64;for(let t=0;t<r;t++){const t=a.getUint16(i+0),r=a.getUint16(i+2),n=a.getUint32(i+4),o=e.subarray(i+32,n);s.push({fileType:t,index:r,data:o}),i+=32+n,i=l.align(i,32)}return{name:n,files:s}}const m={lightingFudge:e=>`(0.5 * (${e.ambSource} + 0.2) * ${e.matSource})`};class p extends d.BasicGXRendererHelper{constructor(e,t,a=new c.RRESTextureHolder){super(e),this.stageRRESes=t,this.textureHolder=a,this.modelInstances=[],this.models=[],this.animationController=new h.default;for(let r=0;r<t.length;r++){const n=t[r];if(a.addRRESTextures(e,n),0===n.mdl0.length)continue;const s=new c.MDL0Model(e,this.getCache(),n.mdl0[0],m);this.models.push(s);const i=new c.MDL0ModelInstance(this.textureHolder,s);this.modelInstances.push(i),i.bindRRESAnimations(this.animationController,n)}}createPanels(){const e=[];if(this.modelInstances.length>1){const t=new o.LayerPanel;t.setLayers(this.modelInstances),e.push(t)}return e}prepareToRender(e,t,a){this.animationController.setTimeInMilliseconds(a.time);const r=this.renderHelper.pushTemplateRenderInst();d.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}destroy(e){super.destroy(e),this.textureHolder.destroy(e);for(let t=0;t<this.models.length;t++)this.models[t].destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e)}}class f{constructor(e,t){this.id=e,this.name=t}createScene(e,t){return t.dataFetcher.fetchData(`ssbb/stage/${this.id}`).then(t=>{const a=new c.RRESTextureHolder,r=u(t);l.assert(r.files.length>=2);const n=u(i.maybeDecompress(r.files[1].data)),o=n.files.filter(e=>3===e.fileType);for(let t=0;t<o.length;t++){const r=s.parse(o[t].data);a.addRRESTextures(e,r)}const h=n.files.filter(e=>2===e.fileType).map(e=>s.parse(e.data));return console.log(n,h),new p(e,h,a)})}}const A=["Battle Stages",new f("melee/STGBATTLEFIELD.PAC","Battlefield"),new f("melee/STGFINAL.PAC","Final Destination"),new f("melee/STGDOLPIC.PAC","Delfino Plaza"),new f("melee/STGMARIOPAST_00.PAC","Mushroomy Kingdom [World 1-1]"),new f("melee/STGMARIOPAST_01.PAC","Mushroomy Kingdom [World 1-2]"),new f("melee/STGKART.PAC","Mario Circuit"),new f("melee/STGMANSION.PAC","Luigi's Mansion"),new f("melee/STGFAMICOM.PAC","Mario Bros."),new f("melee/STGJUNGLE.PAC","Rumble Falls"),new f("melee/STGDONKEY.PAC","75m"),new f("melee/STGCRAYON.PAC","Yoshi's Island"),new f("melee/STGOLDIN.PAC","Bridge of Eldin"),new f("melee/STGPIRATES.PAC","Pirate Ship"),new f("melee/STGNORFAIR.PAC","Norfair"),new f("melee/STGORPHEON.PAC","Frigate Orpheon"),new f("melee/STGHALBERD.PAC","Halberd"),new f("melee/STGSTARFOX_BATTLESHIP.PAC","Lylat Cruise  [Battleship]"),new f("melee/STGSTARFOX_ASTEROID.PAC","Lylat Cruise  [Asteroid]"),new f("melee/STGSTARFOX_GDIFF.PAC","Lylat Cruise  [G-Diffuser]"),new f("melee/STGSTARFOX_CORNERIA.PAC","Lylat Cruise  [Corneria]"),new f("melee/STGSTARFOX_SPACE.PAC","Lylat Cruise  [Space]"),new f("melee/STGSTADIUM_en.PAC","Pokmon Stadium 2  [ENG]"),new f("melee/STGTENGAN_1.PAC","Spear Pillar  [Dialga]"),new f("melee/STGTENGAN_2.PAC","Spear Pillar  [Palkia]"),new f("melee/STGTENGAN_3.PAC","Spear Pillar  [Cresselia]"),new f("melee/STGFZERO.PAC","Port Town Aero Dive"),new f("melee/STGNEWPORK_en.PAC","New Pork City  [ENG]"),new f("melee/STGICE.PAC","Summit"),new f("melee/STGEMBLEM.PAC","Castle Siege  []"),new f("melee/STGEMBLEM_00.PAC","Castle Siege  []"),new f("melee/STGEMBLEM_01.PAC","Castle Siege  []"),new f("melee/STGEMBLEM_02.PAC","Castle Siege  []"),new f("melee/STGGW.PAC","Flat Zone 2  [JPN]"),new f("melee/STGGW_en.PAC","Flat Zone 2  [ENG]"),new f("melee/STGPALUTENA.PAC","Skyworld"),new f("melee/STGMADEIN_en.PAC","WarioWare, Inc.  [ENG]"),new f("melee/STGEARTH.PAC","Distant Planet"),new f("melee/STGVILLAGE_00_en.PAC","Smashville  [][ENG]"),new f("melee/STGVILLAGE_01_en.PAC","Smashville  [][ENG]"),new f("melee/STGVILLAGE_02_en.PAC","Smashville  [][ENG]"),new f("melee/STGVILLAGE_03_en.PAC","Smashville  [][ENG]"),new f("melee/STGVILLAGE_04_en.PAC","Smashville  [][ENG]"),new f("melee/STGPICTCHAT_en.PAC","PictoChat  [ENG]"),new f("melee/STGPLANKTON.PAC","Hanenbow"),new f("melee/STGMETALGEAR_00.PAC","Shadow Moses Island  [GEKKO]"),new f("melee/STGMETALGEAR_01.PAC","Shadow Moses Island  [Metal Gear RAY]"),new f("melee/STGMETALGEAR_02.PAC","Shadow Moses Island  [Metal Gear REX]"),new f("melee/STGGREENHILL.PAC","Green Hill Zone"),new f("melee/STGDXRCRUISE.PAC","Rainbow Cruise (Melee)"),new f("melee/STGDXGARDEN.PAC","Jungle Japes (Melee)"),new f("melee/STGDXSHRINE.PAC","Temple (Melee)"),new f("melee/STGDXZEBES.PAC","Brinstar (Melee)"),new f("melee/STGDXYORSTER.PAC","Yoshi's Island (Melee)"),new f("melee/STGDXGREENS.PAC","Green Greens (Melee)"),new f("melee/STGDXCORNERIA.PAC","Corneria (Melee)"),new f("melee/STGDXPSTADIUM_en.PAC","Pokmon Stadium (Melee)  [ENG]"),new f("melee/STGDXBIGBLUE.PAC","Big Blue (Melee)"),new f("melee/STGDXONETT.PAC","Onett (Melee)  [JPN]"),new f("melee/STGDXONETT_en.PAC","Onett (Melee)  [ENG]"),"Miscellaneous",new f("melee/STGRESULT_en.PAC","Results  [ENG]"),new f("melee/STGONLINETRAINING.PAC","Online - Training"),new f("melee/STGCONFIGTEST.PAC","Options - Controller Test"),new f("melee/STGHEAL.PAC","All-Star - Rest Area"),new f("melee/STGTARGETLV1.PAC","Target Smash!! - Level 1"),new f("melee/STGTARGETLV2.PAC","Target Smash!! - Level 2"),new f("melee/STGTARGETLv3.PAC","Target Smash!! - Level 3"),new f("melee/STGTARGETLv4.PAC","Target Smash!! - Level 4"),new f("melee/STGTARGETLv5.PAC","Target Smash!! - Level 5"),new f("melee/STGHOMERUN.PAC","Home-Run Contest  [JPN]"),new f("melee/STGHOMERUN_en.PAC","Home-Run Contest  [ENG]"),new f("melee/STGEDIT_0.PAC","Stage Builder - Theme 1"),new f("melee/STGEDIT_1.PAC","Stage Builder - Theme 2"),new f("melee/STGEDIT_2.PAC","Stage Builder - Theme 3"),new f("melee/STGCHARAROLL.PAC","melee/STGCHARAROLL"),"Subspace Emissiary",new f("adventure/040101.pac","Skyworld 1-1"),new f("adventure/040201.pac","Skyworld 1-2"),new f("adventure/040201a.pac","Skyworld 1-2 Bonus"),new f("adventure/050001.pac","Halberd Deck"),new f("adventure/050102.pac","Skyworld 2-1"),new f("adventure/050102a.pac","Skyworld 2-1 Bonus"),new f("adventure/050103.pac","Skyworld 2-2"),new f("adventure/060001.pac","The Jungle 1"),new f("adventure/060002.pac","The Jungle 2"),new f("adventure/060002a.pac","The Jungle 2 Bonus"),new f("adventure/060003.pac","The Jungle 3"),new f("adventure/060004.pac","The Jungle 4"),new f("adventure/060004a.pac","The Jungle 4 Bonus"),new f("adventure/070001.pac","The Plain 1"),new f("adventure/070001a.pac","The Plain 1 Bonus"),new f("adventure/070002.pac","The Plain 2"),new f("adventure/080001.pac","Rayquaza Fight"),new f("adventure/080101.pac","The Lake 1"),new f("adventure/080102.pac","The Lake 2"),new f("adventure/080103.pac","The Lake 3"),new f("adventure/080103a.pac","The Lake 3 Fake"),new f("adventure/080103b.pac","The Lake 3 Real"),new f("adventure/080104.pac","The Lake 4"),new f("adventure/080104a.pac","The Lake 4 Fake"),new f("adventure/080104b.pac","The Lake 4 Real"),new f("adventure/080105.pac","The Lake 5"),new f("adventure/080105a.pac","The Lake 5 Bonus"),new f("adventure/080201.pac","The Lake 6"),new f("adventure/080301.pac","Shadow Bowser Fight"),new f("adventure/090001.pac","The Ruined Zoo 1"),new f("adventure/090101.pac","Porky Fight"),new f("adventure/090201.pac","The Ruined Zoo 2"),new f("adventure/090202.pac","The Ruined Zoo 3"),new f("adventure/090203.pac","The Ruined Zoo 4"),new f("adventure/090203a.pac","The Ruined Zoo 4 Bonus"),new f("adventure/100001.pac","The Battlefield Fortress 1"),new f("adventure/100001a.pac","The Battlefield Fortress 1 Bonus"),new f("adventure/100002.pac","The Battlefield Fortress 2"),new f("adventure/100101.pac","The Battlefield Fortress 3"),new f("adventure/100201.pac","The Battlefield Fortress 4"),new f("adventure/100202.pac","The Battlefield Fortress 5"),new f("adventure/100202a.pac","The Battlefield Fortress 5 Bonus"),new f("adventure/100203.pac","The Battlefield Fortress 6"),new f("adventure/100205.pac","The Battlefield Fortress 7"),new f("adventure/120001.pac","The Forest 1"),new f("adventure/120001a.pac","The Forest 2"),new f("adventure/120002.pac","The Forest 3"),new f("adventure/120003.pac","The Forest 4"),new f("adventure/140001.pac","The Research Facility 1-1"),new f("adventure/140005.pac","The Research Facility 1-2"),new f("adventure/140101.pac","The Research Facility 1-3"),new f("adventure/140102.pac","The Research Facility 1-4"),new f("adventure/140103.pac","The Research Facility 1-5"),new f("adventure/140104.pac","The Research Facility 1-6"),new f("adventure/140105.pac","The Research Facility 1-7"),new f("adventure/140106.pac","The Research Facility 1-8"),new f("adventure/160001.pac","Shadow Peach Fight"),new f("adventure/160002.pac","Shadow Zelda Fight"),new f("adventure/160101.pac","Link & Yoshi Fight"),new f("adventure/160102.pac","Mario & Pit Fight"),new f("adventure/160201.pac","The Lake Shore 1"),new f("adventure/160202.pac","The Lake Shore 2"),new f("adventure/160301.pac","The Lake Shore 3"),new f("adventure/160301a.pac","The Lake Shore 3 Bonus 1"),new f("adventure/160301b.pac","The Lake Shore 3 Bonus 2"),new f("adventure/160301c.pac","The Lake Shore 4"),new f("adventure/180001.pac","The Path to the Ruins 1"),new f("adventure/180001a.pac","The Path to the Ruins 1 Bonus"),new f("adventure/180002.pac","The Path to the Ruins 2"),new f("adventure/180003.pac","The Path to the Ruins 3"),new f("adventure/180101.pac","Wario Fight"),new f("adventure/200001.pac","The Cave 1"),new f("adventure/200001a.pac","The Cave 1 Bonus"),new f("adventure/200002.pac","The Cave 2"),new f("adventure/200003.pac","The Cave 3"),new f("adventure/200003a.pac","The Cave 3 Bonus"),new f("adventure/220001.pac","The Ruins 1"),new f("adventure/220002.pac","The Ruins 2"),new f("adventure/220002a.pac","The Ruins 2 Bonus"),new f("adventure/220003.pac","The Ruins 3"),new f("adventure/220003a.pac","The Ruins 3 Bonus"),new f("adventure/220101.pac","Charizard Fight"),new f("adventure/240001.pac","The Wilds 1-1"),new f("adventure/240001a.pac","The Wilds 1 Bonus"),new f("adventure/240002.pac","The Wilds 1-2"),new f("adventure/240002a.pac","The Wilds 1-2 Bonus"),new f("adventure/240002b.pac","The Wilds 1-3"),new f("adventure/240101.pac","Galleom Fight"),new f("adventure/250001.pac","The Ruined Hall"),new f("adventure/260001.pac","The Wilds 2-1"),new f("adventure/260001a.pac","The Wilds 2-1 Bonus"),new f("adventure/260002.pac","The Wilds 2-2"),new f("adventure/270001.pac","The Swamp 1"),new f("adventure/270002.pac","The Swamp 2"),new f("adventure/270002a.pac","The Swamp 2 Bonus"),new f("adventure/270101.pac","Shadow Diddy Kong Fight"),new f("adventure/270201.pac","The Swamp 3"),new f("adventure/270202.pac","The Swamp 4"),new f("adventure/270202a.pac","The Swamp 4 Bonus"),new f("adventure/270203.pac","The Swamp 5"),new f("adventure/280002.pac","The Research Facility 2-1"),new f("adventure/280002a.pac","The Research Facility 2-1 Bonus"),new f("adventure/280003.pac","The Research Facility 2-2"),new f("adventure/280101.pac","Shadow Samus Fight"),new f("adventure/280201.pac","The Research Facility 2-3"),new f("adventure/280202.pac","The Research Facility 2-4"),new f("adventure/280202a.pac","The Research Facility 2-4 Bonus"),new f("adventure/280203.pac","The Research Facility 2-5"),new f("adventure/280204.pac","The Research Facility 2-6"),new f("adventure/280301.pac","Ridley Fight"),new f("adventure/290001.pac","Outside the Ancient Ruins"),new f("adventure/290001a.pac","Outside the Ancient Ruins Bonus 1"),new f("adventure/290001b.pac","Outside the Ancient Ruins Bonus 2"),new f("adventure/300001.pac","Platform Gauntlet"),new f("adventure/310001.pac","The Glacial Peak 1"),new f("adventure/310002.pac","The Glacial Peak 2"),new f("adventure/310003.pac","The Glacial Peak 3"),new f("adventure/310003a.pac","The Glacial Peak 3 Bonus 1"),new f("adventure/310003b.pac","The Glacial Peak 3 Bonus 2"),new f("adventure/310101.pac","Lucario Battle"),new f("adventure/320001.pac","The Canyon"),new f("adventure/330001.pac","Battleship Halberd Interior 1"),new f("adventure/330002.pac","Battleship Halberd Interior 2"),new f("adventure/330002a.pac","Battleship Halberd Interior 2 Bonus"),new f("adventure/330101.pac","Battleship Halberd Interior 3"),new f("adventure/330101a.pac","Battleship Halberd Interior 3 Bonus"),new f("adventure/330102.pac","Battleship Halberd Interior 4"),new f("adventure/330103.pac","Battleship Halberd Interior 5"),new f("adventure/330104.pac","Battleship Halberd Interior 6"),new f("adventure/330201.pac","Shadow Peach & Zelda Fight"),new f("adventure/340001.pac","Battleship Halberd Exterior 1"),new f("adventure/340002.pac","Battleship Halberd Exterior 2"),new f("adventure/340003.pac","Battleship Halberd Exterior 3"),new f("adventure/340004.pac","Battleship Halberd Exterior 4"),new f("adventure/340005.pac","Battleship Halberd Exterior 5"),new f("adventure/350001.pac","Duon Fight (Halberd Main Deck"),new f("adventure/360001.pac","The Subspace Bomb Factory 1-1"),new f("adventure/360001a.pac","The Subspace Bomb Factory 1-1 Bonus 1"),new f("adventure/360001b.pac","The Subspace Bomb Factory 1-1 Bonus 2"),new f("adventure/360001c.pac","The Subspace Bomb Factory 1-1 Bonus 3"),new f("adventure/360002.pac","The Subspace Bomb Factory 1-2"),new f("adventure/370001.pac","The Subspace Bomb Factory 2-1"),new f("adventure/370001a.pac","The Subspace Bomb Factory 2-1 Bonus"),new f("adventure/370002.pac","The Subspace Bomb Factory 2-2"),new f("adventure/370002a.pac","The Subspace Bomb Factory 2-2 Bonus"),new f("adventure/370003.pac","The Subspace Bomb Factory 2-3"),new f("adventure/370101.pac","The Subspace Bomb Factory Gauntlet"),new f("adventure/370201.pac","The Subspace Bomb Factory Escape 1"),new f("adventure/370202.pac","The Subspace Bomb Factory Escape 2"),new f("adventure/370203.pac","The Subspace Bomb Factory Escape 3"),new f("adventure/370301.pac","Meta Ridley Fight"),new f("adventure/390001.pac","Entrance to Subspace"),new f("adventure/400001.pac","Subspace 1-1"),new f("adventure/400002.pac","Subspace 1-2"),new f("adventure/400003.pac","Subspace 1-3"),new f("adventure/400004.pac","Subspace 1-4"),new f("adventure/400005.pac","Subspace 1-5"),new f("adventure/400006.pac","Subspace 1-6"),new f("adventure/400007.pac","Subspace 1-7"),new f("adventure/400008.pac","Subspace 1-8"),new f("adventure/400009.pac","Subspace 1-9"),new f("adventure/400101.pac","Bowser Fight"),new f("adventure/410001.pac","Subspace 2-1"),new f("adventure/410002.pac","Subspace 2-2"),new f("adventure/410003.pac","Subspace 2-3"),new f("adventure/420001a.pac","The Great Maze Save 1-1"),new f("adventure/420001b.pac","The Great Maze Save 1-2"),new f("adventure/420001c.pac","The Great Maze Save 1-3"),new f("adventure/420001d.pac","The Great Maze Save 1-4"),new f("adventure/420002a.pac","The Great Maze Save 2-1"),new f("adventure/420002b.pac","The Great Maze Save 2-2"),new f("adventure/420002c.pac","The Great Maze Save 2-3"),new f("adventure/420002d.pac","The Great Maze Save 2-4"),new f("adventure/420002e.pac","The Great Maze Save 2-5"),new f("adventure/420003a.pac","The Great Maze Stadium"),new f("adventure/420005a.pac","adventure/420005a.pac"),new f("adventure/420005b.pac","adventure/420005b.pac"),new f("adventure/420005c.pac","adventure/420005c.pac"),new f("adventure/420007a.pac","adventure/420007a.pac"),new f("adventure/420007b.pac","adventure/420007b.pac"),new f("adventure/420007c.pac","adventure/420007c.pac"),new f("adventure/420009a.pac","adventure/420009a.pac"),new f("adventure/420009b.pac","adventure/420009b.pac"),new f("adventure/420009c.pac","adventure/420009c.pac"),new f("adventure/420011a.pac","adventure/420011a.pac"),new f("adventure/420013a.pac","adventure/420013a.pac"),new f("adventure/420013b.pac","adventure/420013b.pac"),new f("adventure/420015a.pac","adventure/420015a.pac"),new f("adventure/420017a.pac","adventure/420017a.pac"),new f("adventure/420017b.pac","adventure/420017b.pac"),new f("adventure/420017c.pac","adventure/420017c.pac"),new f("adventure/420019a.pac","adventure/420019a.pac"),new f("adventure/420019b.pac","adventure/420019b.pac"),new f("adventure/420021a.pac","adventure/420021a.pac"),new f("adventure/420021c.pac","adventure/420021c.pac"),new f("adventure/420021d.pac","adventure/420021d.pac"),new f("adventure/420021e.pac","adventure/420021e.pac"),new f("adventure/420023a.pac","adventure/420023a.pac"),new f("adventure/420023b.pac","adventure/420023b.pac"),new f("adventure/420023c.pac","adventure/420023c.pac"),new f("adventure/420025a.pac","adventure/420025a.pac"),new f("adventure/420025b.pac","adventure/420025b.pac"),new f("adventure/420025c.pac","adventure/420025c.pac"),new f("adventure/420027a.pac","adventure/420027a.pac"),new f("adventure/420027b.pac","adventure/420027b.pac"),new f("adventure/420027c.pac","adventure/420027c.pac"),new f("adventure/420029b.pac","adventure/420029b.pac"),new f("adventure/420031a.pac","adventure/420031a.pac"),new f("adventure/420031b.pac","adventure/420031b.pac"),new f("adventure/420031c.pac","adventure/420031c.pac"),new f("adventure/420033a.pac","adventure/420033a.pac"),new f("adventure/420033b.pac","adventure/420033b.pac"),new f("adventure/420035a.pac","adventure/420035a.pac"),new f("adventure/420037a.pac","adventure/420037a.pac"),new f("adventure/420041.pac","adventure/420041.pac"),new f("adventure/420042.pac","adventure/420042.pac"),new f("adventure/420043.pac","adventure/420043.pac"),new f("adventure/420044.pac","adventure/420044.pac"),new f("adventure/420045.pac","adventure/420045.pac"),new f("adventure/420046.pac","adventure/420046.pac"),new f("adventure/420047.pac","adventure/420047.pac"),new f("adventure/420051.pac","adventure/420051.pac"),new f("adventure/420052.pac","adventure/420052.pac"),new f("adventure/420053.pac","adventure/420053.pac"),new f("adventure/420054.pac","adventure/420054.pac"),new f("adventure/420055.pac","adventure/420055.pac"),new f("adventure/420056.pac","adventure/420056.pac"),new f("adventure/420057.pac","adventure/420057.pac"),new f("adventure/420058.pac","adventure/420058.pac"),new f("adventure/420059.pac","adventure/420059.pac"),new f("adventure/420060.pac","adventure/420060.pac"),new f("adventure/420061.pac","adventure/420061.pac"),new f("adventure/420062.pac","adventure/420062.pac"),new f("adventure/420063.pac","adventure/420063.pac"),new f("adventure/420064.pac","adventure/420064.pac"),new f("adventure/420065.pac","adventure/420065.pac"),new f("adventure/420066.pac","adventure/420066.pac"),new f("adventure/420067.pac","adventure/420067.pac"),new f("adventure/420068.pac","adventure/420068.pac"),new f("adventure/420069.pac","adventure/420069.pac"),new f("adventure/420070.pac","adventure/420070.pac"),new f("adventure/420071.pac","adventure/420071.pac"),new f("adventure/420072.pac","adventure/420072.pac"),new f("adventure/420073.pac","adventure/420073.pac"),new f("adventure/420074.pac","adventure/420074.pac"),new f("adventure/420075.pac","adventure/420075.pac"),new f("adventure/420076.pac","adventure/420076.pac"),new f("adventure/420077.pac","adventure/420077.pac"),new f("adventure/420078.pac","adventure/420078.pac"),new f("adventure/420079.pac","adventure/420079.pac"),new f("adventure/420080.pac","adventure/420080.pac"),new f("adventure/420081.pac","adventure/420081.pac"),new f("adventure/420101.pac","adventure/420101.pac"),new f("adventure/900001.pac","adventure/900001.pac"),new f("adventure/900101.pac","adventure/900101.pac"),new f("adventure/900201.pac","adventure/900201.pac"),new f("adventure/910101.pac","adventure/910101.pac"),new f("adventure/920001.pac","adventure/920001.pac"),new f("adventure/920101.pac","adventure/920101.pac"),new f("adventure/920201.pac","adventure/920201.pac"),new f("adventure/920301.pac","adventure/920301.pac"),new f("adventure/920401.pac","adventure/920401.pac"),new f("adventure/920501.pac","adventure/920501.pac"),new f("adventure/920601.pac","adventure/920601.pac"),new f("adventure/920701.pac","adventure/920701.pac"),new f("adventure/920801.pac","adventure/920801.pac"),new f("adventure/010001.pac","adventure/010001.pac"),new f("adventure/030001.pac","adventure/030001.pac"),new f("adventure/030101.pac","adventure/030101.pac"),new f("adventure/040001.pac","adventure/040001.pac")];t.sceneGroup={id:"ssbb",name:"Super Smash Bros. Brawl",sceneDescs:A}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(42),s=a(82),i=r(a(121)),o=a(68),l=r(a(111));class c{constructor(){this.textureHolder=new o.CtrTextureHolder}render(e,t){return null}destroy(e){}}const h=[new class{constructor(e,t=e,a=e){this.dataPath=e,this.id=t,this.name=a}createScene(e,t){return t.dataFetcher.fetchData(this.dataPath).then(t=>s.createBasicRRESRendererFromBRRES(e,[t]))}}("test/dthro_cmn1.brres"),new class{constructor(e,t=e,a=e){this.dataPath=e,this.id=t,this.name=a}createScene(e,t){return t.dataFetcher.fetchData(this.dataPath).then(t=>{const a=i.parse(t),r=new c;return r.textureHolder.addTextures(e,a.textures),r})}}("test/cave_Common.bch"),new class{constructor(e,t=e,a=e){this.dataPath=e,this.id=t,this.name=a}createScene(e,t){return t.dataFetcher.fetchData(this.dataPath).then(e=>{const t=l.parse(e);return console.log(t),new c})}}("test/land_data.narc")];t.sceneGroup={id:"test",name:"Test Scenes",sceneDescs:h,hidden:!n.IS_DEVELOPMENT}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(49)),i=r(a(27)),o=r(a(29)),l=a(0),c=a(5),h=a(41),d=n(a(18)),u=a(1),m=a(37),p=a(4),f=a(120);class A{constructor(){this.mounts=[],this.brresCache=new Map,this.mdl0Cache=new Map}destroy(e){for(const t of this.mdl0Cache.values())t.destroy(e)}mountArchive(e){this.mounts.push(e)}findFileData(e){for(let t=0;t<this.mounts.length;t++){const a=this.mounts[t].findFileData(e);if(null!==a)return a}return null}mountRRES(e,t,a){if(!this.brresCache.has(a)){const r=o.parse(l.assertExists(this.findFileData(a)));t.addRRESTextures(e,r),this.brresCache.set(a,r)}return this.brresCache.get(a)}mountMDL0(e,t,a,r){return this.mdl0Cache.has(r)||this.mdl0Cache.set(r,new h.MDL0Model(e,t,l.assertExists(a.mdl0.find(e=>e.name===r)))),this.mdl0Cache.get(r)}}async function g(e,t,a){const r=await Promise.all(a.map(e=>async function(e,t){const a=await e.fetchData(t),r=await i.decompress(a);return s.parse(r)}(t,e)));for(let t=0;t<r.length;t++)e.mountArchive(r[t])}const _=u.vec3.create();class S extends c.BasicGXRendererHelper{constructor(e,t){super(e),this.resourceSystem=t,this.animationController=new d.default,this.modelInstances=[],this.textureHolder=new h.RRESTextureHolder,this.pmp=[],this.debugObjects=!1;const a=this.resourceSystem.mountRRES(e,this.textureHolder,"G3D/WS2_Scene.brres");this.scn0Animator=new o.SCN0Animator(this.animationController,a.scn0[0]);const r=f.parseBLIGHT(l.assertExists(t.findFileData("Env/WS2_omk_F0_Light.plight")));this.eggLightManager=new f.EggLightManager(r)}mountRRES(e,t){return this.resourceSystem.mountRRES(e,this.textureHolder,t)}spawnModel(e,t,a){const r=this.resourceSystem.mountMDL0(e,this.getCache(),t,a),n=new h.MDL0ModelInstance(this.textureHolder,r);return n.bindRRESAnimations(this.animationController,t),n.bindLightSetting(this.eggLightManager.lightSetting),this.modelInstances.push(n),n}prepareToRender(e,t,a){this.animationController.setTimeInMilliseconds(a.time),this.scn0Animator.calcCameraClipPlanes(a.camera,0);const r=this.renderHelper.pushTemplateRenderInst();c.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);if(this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t),this.debugObjects){const e=m.getDebugOverlayCanvas2D();for(let t=0;t<this.pmp.length;t++){const r=this.pmp[t],n=_;u.vec3.set(n,0,0,0),u.vec3.transformMat4(n,n,r.modelMatrix),m.drawWorldSpacePoint(e,a.camera,n,p.Magenta,10)}}}destroy(e){super.destroy(e),this.textureHolder.destroy(e),this.resourceSystem.destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e)}}const b=[new class{constructor(e,t=e){this.id=e,this.name=t}spawnObject(e,t,a){if(65536===a.objectId){const r=t.mountRRES(e,"Tree/G3D/WS2_common_tree.brres"),n=t.spawnModel(e,r,"WS2_common_tree_H");u.mat4.copy(n.modelMatrix,a.modelMatrix)}else if(65537===a.objectId){const r=t.mountRRES(e,"Tree/G3D/WS2_common_tree2.brres"),n=t.spawnModel(e,r,"WS2_common_tree2_H");u.mat4.copy(n.modelMatrix,a.modelMatrix)}else if(65538===a.objectId){const r=t.mountRRES(e,"Tree/G3D/WS2_common_tree3.brres"),n=t.spawnModel(e,r,"WS2_common_tree3");u.mat4.copy(n.modelMatrix,a.modelMatrix)}else if(65562===a.objectId){const r=t.mountRRES(e,"WindMill/G3D/WS2_common_windmill.brres"),n=t.spawnModel(e,r,"WS2_common_windmill");u.mat4.copy(n.modelMatrix,a.modelMatrix)}else{if(65566!==a.objectId)return!1;{const r=t.mountRRES(e,"Fountain/G3D/WS2_common_fountain.brres"),n=t.spawnModel(e,r,"WS2_common_fountain");u.mat4.copy(n.modelMatrix,a.modelMatrix)}}return!0}async createScene(e,t){const a=t.dataFetcher,r=new A;await g(r,a,["WiiSportsResort/Common/Static/common.carc","WiiSportsResort/Common/OmkScene/common.carc","WiiSportsResort/Stage/Static/StageArc.carc"]);const n=function(e){const t=e.createDataView();l.assertExists("PMPF"===l.readString(e,0,4));const a=t.getUint16(16),r=t.getUint32(64);l.assert(128===r);const n=[];let s=r;for(let e=0;e<a;e++){const e=t.getUint32(s+0);l.assert(0===t.getUint32(s+4));const a=t.getFloat32(s+8),r=t.getFloat32(s+12),i=t.getFloat32(s+16),o=t.getFloat32(s+20),c=t.getFloat32(s+24),h=t.getFloat32(s+28),d=t.getFloat32(s+32),m=t.getFloat32(s+36),p=t.getFloat32(s+40),f=t.getFloat32(s+44),A=t.getFloat32(s+48),g=t.getFloat32(s+52),_=t.getFloat32(s+56),S=t.getFloat32(s+60),b=t.getFloat32(s+64),v=u.mat4.fromValues(o*_,o*S,o*b,0,c*f,c*A,c*g,0,h*d,h*m,h*p,0,a,r,i,1);n.push({objectId:e,modelMatrix:v}),s+=88}return n}(l.assertExists(r.findFileData("WS2_omk_island_tag.pmp"))),s=new S(e,r);s.mountRRES(e,"Island/G3D/WS2_common_seatex.brres");const i=s.mountRRES(e,"Island/G3D/WS2_common_island.brres"),o=s.spawnModel(e,i,"WS2_common_island");o.mdl0Model.mdl0.nodes[10].visible=!1,o.mdl0Model.mdl0.nodes[12].visible=!1,o.mdl0Model.mdl0.nodes[13].visible=!1,s.spawnModel(e,i,"WS2_common_vr");const c=s.spawnModel(e,i,"WS2_common_sea");c.bindRRESAnimations(s.animationController,i,"WS2_common_sea_nami"),c.bindRRESAnimations(s.animationController,i,"WS2_common_sea_B");for(let t=0;t<n.length;t++)this.spawnObject(e,s,n[t])||s.pmp.push(n[t]);return s}}("WuhuIsland","Wuhu Island")];t.sceneGroup={id:"WiiSportsResort",name:"Wii Sports Resort",sceneDescs:b}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(11)),i=r(a(47)),o=r(a(29)),l=r(a(49)),c=a(0),h=a(41),d=a(16),u=a(1),m=n(a(18)),p=a(5),f=a(6),A=a(7),g=a(9),_=a(5),S=a(4),b={lightingFudge:e=>`vec4((0.5 * ${e.matSource}).rgb, 1.0)`};class v{constructor(){this.mounts=[],this.brresCache=new Map}mountArchive(e){this.mounts.push(e)}findFile(e){for(let t=0;t<this.mounts.length;t++){const a=this.mounts[t].findFile(e);if(null!==a)return a}return null}getRRES(e,t,a){if(this.brresCache.has(a))return this.brresCache.get(a);const r=c.assertExists(this.findFile(a)),n=l.parse(r.buffer),s=o.parse(c.assertExists(n.findFileData("g3d/model.brres")));return t.addRRESTextures(e,s),this.brresCache.set(a,s),s}}class w{constructor(){this.cache=new Map}getModel(e,t,a,r){if(this.cache.has(a))return this.cache.get(a);const n=t.renderInstManager.gfxRenderCache,s=new h.MDL0Model(e,n,a,r);return this.cache.set(a,s),s}destroy(e){for(const t of this.cache.values())t.destroy(e)}}class x extends h.RRESTextureHolder{findTextureEntryIndex(e){let t=-1;return t=this.searchTextureEntryIndex(e),t>=0?t:"F211_Wood01"===e?this.searchTextureEntryIndex("F211_Wood02"):-1}}class T{constructor(e,t,a,r,n){this.stageId=t,this.systemArchive=a,this.objPackArchive=r,this.stageArchive=n,this.mainRenderTarget=new g.BasicRenderTarget,this.opaqueSceneTexture=new g.ColorTexture,this.stageBZS=null,this.roomBZSes=[],this.resourceSystem=new v,this.modelCache=new w,this.modelInstances=[],this.renderHelper=new p.GXRenderHelperGfx(e),this.textureHolder=new x,this.animationController=new m.default,this.resourceSystem.mountArchive(this.stageArchive),this.resourceSystem.mountArchive(this.objPackArchive);const s=o.parse(a.findFileData("g3d/model.brres"));this.textureHolder.addRRESTextures(e,s),this.blackTexture=e.createTexture(f.makeTextureDescriptor2D(f.GfxFormat.U8_RGBA_NORM,1,1,1)),e.createHostAccessPass().uploadTextureData(this.blackTexture,0,[new Uint8Array([0,0,0,0])]),this.textureHolder.setTextureOverride("LmChaAdd",{gfxTexture:this.blackTexture,width:1,height:1,flipY:!1}),this.textureHolder.setTextureOverride("LmBGAdd",{gfxTexture:this.blackTexture,width:1,height:1,flipY:!1}),this.resourceSystem.getRRES(e,this.textureHolder,"oarc/SkyCmn.arc"),this.commonRRES=this.resourceSystem.getRRES(e,this.textureHolder,"oarc/Common.arc"),this.stageRRES=o.parse(n.findFileData("g3d/stage.brres")),this.textureHolder.addRRESTextures(e,this.stageRRES),this.stageBZS=this.parseBZS(n.findFileData("dat/stage.bzs"));const i=this.stageBZS.layouts[0];this.spawnLayout(e,i);const c=n.findDir("rarc");if(c)for(let t=0;t<c.files.length;t++){const a=c.files[t],r=l.parse(a.buffer),n=o.parse(r.findFileData("g3d/room.brres"));this.textureHolder.addRRESTextures(e,n);for(let t=0;t<n.mdl0.length;t++){const r=n.mdl0[t],s=this.modelCache.getModel(e,this.renderHelper,r,b),i=new h.MDL0ModelInstance(this.textureHolder,s,a.name);i.bindRRESAnimations(this.animationController,n,null),i.bindRRESAnimations(this.animationController,this.commonRRES,"MA01"),i.bindRRESAnimations(this.animationController,this.commonRRES,"MA02"),i.bindRRESAnimations(this.animationController,this.commonRRES,"MA04"),i.passMask=2,this.modelInstances.push(i),r.name.endsWith("_s")&&i.setSortKeyLayer(129)}const s=this.parseBZS(r.findFileData("dat/room.bzs"));this.roomBZSes.push(s);const i=s.layouts[0];this.spawnLayout(e,i)}e:for(let e=0;e<this.modelInstances.length;e++){const t=this.modelInstances[e];for(let e=0;e<t.mdl0Model.mdl0.materials.length;e++){const a=t.mdl0Model.mdl0.materials[e];for(let e=0;e<a.samplers.length;e++)if("DummyWater"===a.samplers[e].name){t.passMask=4;continue e}}}}createPanels(){const e=[],t=new s.LayerPanel;t.setLayers(this.modelInstances),e.push(t);const a=[],r=[];for(let e=0;e<this.modelInstances.length;e++){const t=this.modelInstances[e];t.mdl0Model.mdl0.name.startsWith("model_obj")&&r.push(t),"F301_1"===this.stageId&&"model1_s"===t.mdl0Model.mdl0.name&&a.push(t)}if(a.length||r.length){const n=new s.Panel;n.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,n.setTitle(s.SAND_CLOCK_ICON,"Time Stones");const i=new s.SingleSelect;i.setStrings(["Past","Present"]),i.onselectionchange=e=>{const n=1===e;for(let e=0;e<a.length;e++)a[e].setVisible(n);for(let e=0;e<r.length;e++)r[e].setVisible(!n);t.syncLayerVisibility()},i.selectItem(0),n.contents.appendChild(i.elem),e.push(n)}const n=new s.Panel;n.customHeaderBackgroundColor=s.COOL_BLUE_COLOR,n.setTitle(s.RENDER_HACKS_ICON,"Render Hacks");const i=new s.Checkbox("Enable Vertex Colors",!0);i.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setVertexColorsEnabled(i.checked)},n.contents.appendChild(i.elem);const o=new s.Checkbox("Enable Textures",!0);return o.onchanged=()=>{for(let e=0;e<this.modelInstances.length;e++)this.modelInstances[e].setTexturesEnabled(o.checked)},n.contents.appendChild(o.elem),e.push(n),e}destroy(e){this.textureHolder.destroy(e),this.renderHelper.destroy(e),this.modelCache.destroy(e),this.mainRenderTarget.destroy(e),this.opaqueSceneTexture.destroy(e);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].destroy(e);e.destroyTexture(this.blackTexture)}prepareToRender(e,t,a){this.animationController.setTimeInMilliseconds(a.time);const r=this.renderHelper.pushTemplateRenderInst();p.fillSceneParamsDataOnTemplate(r,a);for(let t=0;t<this.modelInstances.length;t++)this.modelInstances[t].prepareToRender(e,this.renderHelper.renderInstManager,a);this.renderHelper.prepareToRender(e,t),this.renderHelper.renderInstManager.popTemplateRenderInst()}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.mainRenderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight),this.opaqueSceneTexture.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.mainRenderTarget.createRenderPass(e,t.viewport,g.standardFullClearRenderPassDescriptor);A.executeOnPass(this.renderHelper.renderInstManager,e,r,1),e.submitPass(r);const n=this.mainRenderTarget.createRenderPass(e,t.viewport,g.depthClearRenderPassDescriptor,this.opaqueSceneTexture.gfxTexture);let s;if(A.executeOnPass(this.renderHelper.renderInstManager,e,n,2),A.hasAnyVisible(this.renderHelper.renderInstManager,4)){e.submitPass(n);const a={gfxTexture:this.opaqueSceneTexture.gfxTexture,width:d.EFB_WIDTH,height:d.EFB_HEIGHT,flipY:!0};this.textureHolder.setTextureOverride("DummyWater",a);const r=this.mainRenderTarget.createRenderPass(e,t.viewport,g.noClearRenderPassDescriptor);A.executeOnPass(this.renderHelper.renderInstManager,e,r,4),s=r}else s=n;return this.renderHelper.renderInstManager.resetRenderInsts(),s}spawnObj(e,t,a){const r=t.name,n=t.unk1,s=t.unk2,i=this.renderHelper,o=(r,n)=>{const s=c.assertExists(r.mdl0.find(e=>e.name===n)),o=this.modelCache.getModel(e,i,s,b),l=new h.MDL0ModelInstance(this.textureHolder,o,t.name);return l.passMask=2,u.mat4.copy(l.modelMatrix,a),this.modelInstances.push(l),l.bindRRESAnimations(this.animationController,r),l.bindRRESAnimations(this.animationController,this.commonRRES,"MA01"),l.bindRRESAnimations(this.animationController,this.commonRRES,"MA02"),l.bindRRESAnimations(this.animationController,this.commonRRES,"MA04"),l},l=t=>this.resourceSystem.getRRES(e,this.textureHolder,`oarc/${t}.arc`),d=t=>{const a=this.resourceSystem.getRRES(e,this.textureHolder,`oarc/${t}.arc`);return o(a,t)},m=this.stageRRES;if("CityWtr"===r)o(m,"StageF000Water0"),o(m,"StageF000Water1"),o(m,"StageF000Water2");else if("Grave"===r)o(m,"StageF000Grave");else if("Shed"===r)o(m,"StageF000Shed");else if("Windmil"===r)o(m,"StageF000Windmill");else if("Blade"===r)o(m,"StageF000Blade");else if("LHHarp"===r)o(m,"StageF000Harp");else if("LHLight"===r)o(m,"StageF000Light");else if("Heartf"===r)d("FlowerHeart");else if("Pumpkin"===r){d("Pumpkin");const t=this.resourceSystem.getRRES(e,this.textureHolder,"oarc/Pumpkin.arc");o(t,"Pumpkin")}else if("DmtGate"===r)console.log("DmtGate",c.hexzero(n,8),c.hexzero(s,8));else if("IslLOD"===r){d(["IslLODA","IslLODB","IslLODC","IslLODD","IslLODE"][15&n])}else if("ClawSTg"===r)d("ShotMark");else if("Vrbox"===r){const e=d(["Vrbox00","Vrbox01","Vrbox02","Vrbox03"][15&n]);e.passMask=1,e.isSkybox=!0,e.setColorOverride(_.ColorKind.C2,S.colorNewCopy(S.White)),e.setColorOverride(_.ColorKind.K3,S.colorNewCopy(S.White)),u.mat4.scale(e.modelMatrix,e.modelMatrix,[.001,.001,.001])}else if("CmCloud"===r)d("F020Cloud");else if("UdCloud"===r)d("F020UnderCloud");else if("ObjBld"===r)d("DowsingZoneE300");else if("WtrF100"===r){const e=l("WaterF100");o(e,"model0"),o(e,"model1"),o(e,"model2"),o(e,"model3")}else if("GodCube"===r)d("GoddessCube");else if("LavF200"===r)d("LavaF200");else if("UDLava"===r){const e=l("UpdwnLava");o(e,"UpdwnLavaA"),o(e,"UpdwnLavaB"),o(e,"UpdwnLavaC")}else if("NpcKnld"===r){const e=l("Lord");o(e,"Lord").bindCHR0(this.animationController,((e,t)=>c.assertExists(e.chr0.find(e=>e.name===t)))(e,"Lord_wait"))}else console.log("Unknown object",r)}spawnLayout(e,t){const a=u.quat.create(),r=u.mat4.create();for(let n=0;n<t.obj.length;n++){const s=t.obj[n],i=s.rotX/32767*180,o=s.rotY/32767*180;u.quat.fromEuler(a,i,o,0),u.mat4.fromRotationTranslation(r,a,[s.tx,s.ty,s.tz]),this.spawnObj(e,s,r)}for(let n=0;n<t.sobj.length;n++){const s=t.sobj[n];u.mat4.fromRotationTranslationScale(r,a,[s.tx,s.ty,s.tz],[s.sx,s.sy,s.sz]);const i=s.rotY/32767*180;u.quat.fromEuler(a,0,i,0),u.mat4.fromRotationTranslationScale(r,a,[s.tx,s.ty,s.tz],[s.sx,s.sy,s.sz]),this.spawnObj(e,s,r)}}parseBZS(e){const t=e.createDataView();function a(a,r){const n=[];let s=a;for(let a=0;a<r;a++){const a=c.readString(e,s+0,4,!1),r=t.getUint16(s+4),i=s+t.getUint32(s+8);n.push({name:a,count:r,offs:i}),s+=12}return n}const r=a(0,1);c.assert(1===r.length);const n=r[0];c.assert("V001"===n.name&&12===n.offs);const s=a(n.offs,n.count);function i(a){return{unk1:t.getUint32(a+0),unk2:t.getUint32(a+4),tx:t.getFloat32(a+8),ty:t.getFloat32(a+12),tz:t.getFloat32(a+16),sx:t.getFloat32(a+20),sy:t.getFloat32(a+24),sz:t.getFloat32(a+28),rotY:t.getInt16(a+32),unk4:t.getUint16(a+34),unk5:t.getUint8(a+38),unk6:t.getUint8(a+39),name:c.readString(e,a+40,8,!0)}}const o=c.assertExists(s.find(e=>"LAY "===e.name));const l=[];return l.push(function(r){const n=o.offs+8*r,s=t.getUint16(n+0),l=a(n+t.getUint32(n+4),s),h=[],d=l.find(e=>"OBJ "===e.name);if(d)for(let a=0;a<d.count;a++)h.push((u=d.offs+36*a,{unk1:t.getUint32(u+0),unk2:t.getUint32(u+4),tx:t.getFloat32(u+8),ty:t.getFloat32(u+12),tz:t.getFloat32(u+16),rotX:t.getInt16(u+20),rotY:t.getInt16(u+22),unk4:t.getInt16(u+24),unk5:t.getUint8(u+26),unk6:t.getUint8(u+27),name:c.readString(e,u+28,8,!0)}));var u;const m=[],p=l.find(e=>"SOBJ"===e.name);if(p)for(let e=0;e<p.count;e++)m.push(i(p.offs+48*e));const f=l.find(e=>"STAG"===e.name);if(f)for(let e=0;e<f.count;e++)m.push(i(f.offs+48*e));return{obj:h,sobj:m}}(0)),{layouts:l}}}class y{constructor(e,t){this.id=e,this.name=t}createScene(e,t){const a=`zss/Stage/${this.id}/${this.id}_stg_l0.arc.LZ`,r=t.dataFetcher;return Promise.all([r.fetchData("zss/Object/System.arc"),r.fetchData("zss/Object/ObjectPack.arc.LZ"),r.fetchData(a)]).then(t=>{const[a,r,n]=t,s=l.parse(a),o=l.parse(i.decompress(r)),c=l.parse(i.decompress(n));return new T(e,this.id,s,o,c)})}}const C=["Skyloft",new y("F000","Skyloft"),new y("F001r","Knight's Academy"),new y("F002r","Beedle's Airshop"),new y("F004r","Bazaar"),new y("F005r","Orielle & Parrows House"),new y("F006r","Kukiels House"),new y("F007r","Pipers House"),new y("F008r","Inside the Statue of the Goddess"),new y("F009r","Sparring Hall"),new y("F010r","Isle of Songs Tower"),new y("F011r","The Lumpy Pumpkin"),new y("F012r","Batreauxs House"),new y("F013r","Fortune-teller Sparrots House"),new y("F014r","Potion Shop Owner Berties House"),new y("F015r","Scrap Shop Owner Gondos House"),new y("F016r","Pipets House"),new y("F017r","Gear Peddler Rupins House"),new y("F018r","Item Check Girl Peatrices House"),new y("F019r","Bamboo Island"),new y("D000","Waterfall Cave"),"Faron Woods",new y("F100","Faron Woods"),new y("F100_1","Inside the Great Tree"),new y("D100","Skyview Temple"),new y("F102_2","Faron's Lair"),new y("F101","Deep Woods"),new y("F102","Lake Floria"),new y("F102_1","Outside Ancient Cistern"),new y("D101","Ancient Cistern"),new y("F103","Faron Woods (Flooded)"),"Eldin Volcano",new y("F200","Eldin Volcano"),new y("F210","Caves"),new y("F211","Thrill Digger"),new y("F201_1","Inside Volcano"),new y("F201_4","Volcano Summit - Waterfall"),new y("F202_1","Despacito 202_1"),new y("F221","Despacito 221"),new y("D200","Earth Temple"),new y("F201_3","Fire Sanctuary Entrance"),new y("D201","Fire Sanctuary (A)"),new y("D201_1","Fire Sanctuary (B)"),"Lanayru Desert",new y("F300","Lanayru Desert"),new y("F300_1","Ancient Harbor"),new y("D301","Sandship"),new y("F300_2","Lanayru Mine"),new y("D300","Lanayru Mining Facility (A)"),new y("D300_1","Lanayru Mining Facility (B)"),new y("F300_3","Power Generator #1"),new y("F300_4","Power Generator #2"),new y("F300_5","Temple of Time"),new y("F301","Sand Sea Docks"),new y("F301_1","Sand Sea"),new y("F301_2","Pirate Stronghold"),new y("F301_3","Skipper's Retreat"),new y("F301_5","Skipper's Retreat Shack"),new y("F301_4","Shipyard"),new y("F301_7","Shipyard Construction Bay"),new y("F302","Lanayru Gorge"),new y("F303","Lanayru Caves"),"Untagged - Sacred Grounds",new y("F400","F400"),new y("F401","F401"),new y("F402","F402"),new y("F403","F403"),new y("F404","F404"),new y("F405","F405"),new y("F406","F406"),new y("F407","F407")];t.sceneGroup={id:"zss",name:"The Legend of Zelda: Skyward Sword",sceneDescs:C}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(42),n=[new(a(305).FoxFur)("FoxFur","FoxFur")];t.sceneGroup={id:"InteractiveExamples",name:"Interactive Examples",sceneDescs:n,hidden:!r.IS_DEVELOPMENT}},function(e,t,a){"use strict";var r=this&&this.__decorate||function(e,t,a,r){var n,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,r);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(s<3?n(i):s>3?n(t,a,i):n(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i};Object.defineProperty(t,"__esModule",{value:!0});const n=a(8),s=a(6),i=a(99),o=a(9),l=a(4),c=a(10),h=a(0),d=a(17),u=a(20),m=a(13),p=a(1),f=a(2),A=a(23),g=a(11),_=a(306),S=a(182),b=a(183),v=a(107);class w extends u.DeviceProgram{constructor(){super(...arguments),this.both="\nlayout(row_major, std140) uniform ub_ShapeParams {\n    Mat4x4 u_Projection;\n    Mat4x3 u_BoneMatrix[1];\n    vec4 u_Misc[3];\n    vec4 u_TintColor;\n};\n\n#define u_LayerMagnitude  (u_Misc[0].x)\n#define u_PoreBaseAlpha   (u_Misc[0].y)\n#define u_PoreMapScale    (u_Misc[0].z)\n#define u_BodyIndMapOffsS (u_Misc[1].x)\n#define u_BodyIndMapOffsT (u_Misc[1].y)\n#define u_BodyMapIndScale (u_Misc[1].z)\n#define u_BodyMapIndAngle (u_Misc[1].w)\n#define u_PoreIndMapOffsS (u_Misc[2].x)\n#define u_PoreIndMapOffsT (u_Misc[2].y)\n#define u_PoreMapIndScale (u_Misc[2].z)\n#define u_PoreMapIndAngle (u_Misc[2].w)\n\nuniform sampler2D u_Texture[3];\n",this.vert="\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec3 a_Normal;\nlayout(location = 2) in vec2 a_TexCoord;\n\nout vec2 v_TexCoord;\n\nvoid main() {\n    vec3 t_Position = a_Position.xyz + (a_Normal.xyz * u_LayerMagnitude);\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_BoneMatrix[0]), vec4(t_Position, 1.0)));\n    v_TexCoord = a_TexCoord.xy;\n}\n",this.frag="\nin vec2 v_TexCoord;\n\nvec2 rotateZ(vec2 v, float theta) {\n    float s = sin(theta), c = cos(theta);\n    mat2 m = mat2(c, s, -s, c);\n    return m * v;\n}\n\nvoid main() {\n    gl_FragColor = u_TintColor;\n\n    // Trying out some ind stuff\n    vec2 t_BodyIndCoord = v_TexCoord.xy + vec2(u_BodyIndMapOffsS, u_BodyIndMapOffsT);\n    vec2 t_BodyIndTex = (texture(u_Texture[2], t_BodyIndCoord).gr - vec2(0.5, 0.5)) * vec2(1, -1);\n    // Scale and rotate.\n    t_BodyIndTex = rotateZ(t_BodyIndTex, u_BodyMapIndAngle);\n    t_BodyIndTex *= u_BodyMapIndScale;\n    vec2 t_BodyTexCoord = (v_TexCoord.xy) + t_BodyIndTex;\n\n    vec4 t_BodyColor = texture(u_Texture[0], t_BodyTexCoord);\n    gl_FragColor *= t_BodyColor;\n\n    // Sample pore map.\n    vec2 t_PoreIndCoord = v_TexCoord.xy + vec2(u_PoreIndMapOffsS, u_PoreIndMapOffsT);\n    vec2 t_PoreIndTex = (texture(u_Texture[2], t_PoreIndCoord).gr - vec2(0.5, 0.5)) * vec2(1, -1);\n    // Scale and rotate.\n    t_PoreIndTex = rotateZ(t_PoreIndTex, u_PoreMapIndAngle);\n    t_PoreIndTex *= u_PoreMapIndScale;\n\n    vec2 t_PoreTexCoord = (v_TexCoord.xy * u_PoreMapScale) + t_PoreIndTex;\n    vec4 t_PoreMask = texture(u_Texture[1], t_PoreTexCoord).rrrg;\n    t_PoreMask.a += u_PoreBaseAlpha;\n    gl_FragColor *= t_PoreMask;\n}\n"}}w.ub_ShapeParams=0;const x=[{numSamplers:4,numUniformBuffers:1}];class T{constructor(){this.mapIndScale=0,this.mapIndAngle=0,this.indMapSpeedS=0,this.indMapSpeedT=0}fill(e,t,a,r){const n=a*this.indMapSpeedS/1e4,s=a*this.indMapSpeedT/1e4,i=r*this.mapIndScale,o=this.mapIndAngle;return m.fillVec4(e,t,n,s,i,o)}}r([g.dfRange(0,1)],T.prototype,"mapIndScale",void 0),r([g.dfRange(-Math.PI,Math.PI)],T.prototype,"mapIndAngle",void 0),r([g.dfRange(-5,5)],T.prototype,"indMapSpeedS",void 0),r([g.dfRange(-5,5)],T.prototype,"indMapSpeedT",void 0);const y=p.mat4.create(),C=l.colorNewCopy(l.TransparentBlack);class M{constructor(e,t,a){this.textureMapping=h.nArray(4,()=>new c.TextureMapping),this.modelMatrix=p.mat4.create(),this.numLayers=16,this.magnitude=1,this.pow=.6,this.poreMapScale=1,this.bodyInd=new T,this.poreInd=new T,this.rootColor=l.colorNewFromRGBA(.2,.2,.2,1),this.tipColor=l.colorNewFromRGBA(1,1,1,.2),this.bodyTex=function(e,t){const a=e.createHostAccessPass(),r=e.createTexture(s.makeTextureDescriptor2D(s.GfxFormat.U8_RGBA_NORM,t.width,t.height,1));return a.uploadTextureData(r,0,[new Uint8Array(t.data.buffer)]),e.submitPass(a),r}(e,a),e.setResourceName(this.bodyTex,"Body"),this.poreTex=function(e,t,a){const r=e.createTexture(s.makeTextureDescriptor2D(s.GfxFormat.U8_RG_NORM,t,a,1)),n=new Uint8Array(t*a*2);for(let e=0;e<n.byteLength;)n[e++]=f.clamp(255*Math.random()+128,0,255),n[e++]=255*Math.random();const i=e.createHostAccessPass();return i.uploadTextureData(r,0,[n]),e.submitPass(i),r}(e,256,256),e.setResourceName(this.poreTex,"Pore"),this.indTex=function(e,t,a){const r=e.createTexture(s.makeTextureDescriptor2D(s.GfxFormat.U8_RG_NORM,t,a,1)),n=new Uint8Array(t*a*2);for(let e=0;e<n.byteLength;)n[e++]=16*Math.random()+64,n[e++]=32*Math.random()+128;const i=e.createHostAccessPass();return i.uploadTextureData(r,0,[n]),e.submitPass(i),r}(e,64,64),e.setResourceName(this.poreTex,"Ind"),this.textureMapping[0].gfxTexture=this.bodyTex,this.textureMapping[1].gfxTexture=this.poreTex,this.textureMapping[2].gfxTexture=this.indTex;const r=function(e){const t=e.split("\n"),a=[],r=[],n=[],s=[],i=[],o=new Map;for(let e=0;e<t.length;e++){const l=t[e].trim();if(0===l.length||l.startsWith("#"))continue;const c=l.split(" ");if("v"===c[0])a.push(+c[1]),a.push(+c[2]),a.push(+c[3]);else if("vn"===c[0]){const e=+c[1],t=+c[2],a=+c[3],n=Math.hypot(e,t,a),s=0!==n?1/n:1;r.push(s*e,s*t,s*a)}else if("vt"===c[0])n.push(+c[1]),n.push(+c[2]);else if("f"===c[0])for(let e=1;e<=3;e++){let t;if(o.has(c[e]))t=o.get(c[e]);else{const[s,l,h]=c[e].split("/");t=i.length/8;const d=+s-1;i.push(a[3*d+0]),i.push(a[3*d+1]),i.push(a[3*d+2]);const u=+h-1;i.push(r[3*u+0]),i.push(r[3*u+1]),i.push(r[3*u+2]);const m=+l-1;i.push(n[2*m+0]),i.push(n[2*m+1]),o.set(c[e],t)}s.push(t)}}return{vertexBuffer:new Float32Array(i),indexBuffer:new Uint16Array(s)}}(t);this.vertexBuffer=d.makeStaticDataBuffer(e,2,r.vertexBuffer.buffer),this.indexBuffer=d.makeStaticDataBuffer(e,1,r.indexBuffer.buffer),this.indexCount=r.indexBuffer.length,this.inputLayout=e.createInputLayout({indexBufferFormat:s.GfxFormat.U16_R,vertexAttributeDescriptors:[{location:0,bufferIndex:0,format:s.GfxFormat.F32_RGB,bufferByteOffset:0},{location:1,bufferIndex:0,format:s.GfxFormat.F32_RGB,bufferByteOffset:12},{location:2,bufferIndex:0,format:s.GfxFormat.F32_RG,bufferByteOffset:24}],vertexBufferDescriptors:[{byteStride:32,frequency:1}]}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0}),this.gfxProgram=e.createProgram(new w);f.computeModelMatrixSRT(this.modelMatrix,10,10,10,0,0,0,0,0,0)}prepareToRender(e,t,a){const r=t.pushTemplateRenderInst();r.setBindingLayouts(x),r.setSamplerBindingsFromTextureMappings(this.textureMapping),r.setGfxProgram(this.gfxProgram),r.setInputLayoutAndState(this.inputLayout,this.inputState),r.setMegaStateFlags({cullMode:2});for(let e=0;e<this.numLayers;e++){const r=t.pushRenderInst(),n=0===e,i=(e+1)/(0|this.numLayers),o=Math.pow(i,this.pow);let c=r.allocateUniformBuffer(w.ub_ShapeParams,44);const h=r.mapUniformBufferF32(w.ub_ShapeParams);c+=m.fillMatrix4x4(h,c,a.camera.projectionMatrix),p.mat4.mul(y,a.camera.viewMatrix,this.modelMatrix),c+=m.fillMatrix4x3(h,c,y);const d=o*this.magnitude,u=n?1:0,f=this.poreMapScale;c+=m.fillVec4(h,c,d,u,f);const A=a.time;c+=this.bodyInd.fill(h,c,A,o),c+=this.poreInd.fill(h,c,A,o),l.colorLerp(C,this.rootColor,this.tipColor,o),c+=m.fillColor(h,c,C),n||r.setMegaStateFlags({attachmentsState:[{colorWriteMask:15,rgbBlendState:{blendMode:s.GfxBlendMode.ADD,blendSrcFactor:s.GfxBlendFactor.SRC_ALPHA,blendDstFactor:s.GfxBlendFactor.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:s.GfxBlendMode.ADD,blendSrcFactor:s.GfxBlendFactor.ONE,blendDstFactor:s.GfxBlendFactor.ONE_MINUS_SRC_ALPHA}}]}),r.drawIndexes(this.indexCount)}t.popTemplateRenderInst()}destroy(e){}}r([g.dfHide()],M.prototype,"indexCount",void 0),r([g.dfHide()],M.prototype,"modelMatrix",void 0),r([g.dfRange(1,32,1)],M.prototype,"numLayers",void 0),r([g.dfRange(0,10)],M.prototype,"magnitude",void 0),r([g.dfRange(0,1)],M.prototype,"pow",void 0),r([g.dfRange(0,8)],M.prototype,"poreMapScale",void 0),r([g.dfShow()],M.prototype,"bodyInd",void 0),r([g.dfShow()],M.prototype,"poreInd",void 0);const U=o.makeClearRenderPassDescriptor(!0,l.TransparentBlack);class k{constructor(e){this.renderTarget=new o.BasicRenderTarget,this.obj=[],this.obj.push(new v.GridPlane(e)),this.renderHelper=new A.GfxRenderHelper(e)}createCameraController(){return new n.OrbitCameraController}prepareToRender(e,t,a){this.renderHelper.pushTemplateRenderInst();const r=this.renderHelper.renderInstManager;for(let t=0;t<this.obj.length;t++)this.obj[t].prepareToRender(e,r,a);r.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=this.renderHelper.renderInstManager,r=e.createHostAccessPass();this.prepareToRender(e,r,t),e.submitPass(r),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,U);return a.drawOnPassRenderer(e,n),a.resetRenderInsts(),n}async film(){const e=await _.captureScene(window.main.viewer,{width:1920,height:1080,opaque:!1,frameCount:12,filenamePrefix:"scene0/scene0",setupCallback:(e,t,a)=>{const r=e.cameraController;return r.shouldOrbit=!1,r.x=-Math.PI/2,r.y=2,r.z=-150,this.fur.magnitude=t,!0}}),t=b.makeZipFile([...e]);S.downloadBuffer("FoxFur.zip",t)}destroy(e){for(let t=0;t<this.obj.length;t++)this.obj[t].destroy(e)}}t.SceneRenderer=k;t.FoxFur=class{constructor(e,t){this.id=e,this.name=t}async createScene(e,t){const a=await t.dataFetcher.fetchData("FoxFur/foxtail.obj"),r=new TextDecoder("utf8").decode(a.arrayBuffer),n=await function(e){e=i.getDataURLForPath(e);const t=document.createElement("img");return t.crossOrigin="anonymous",t.src=e,new Promise(e=>{t.onload=()=>{const a=document.createElement("canvas");a.width=t.width,a.height=t.height;const r=a.getContext("2d");r.drawImage(t,0,0),e(r.getImageData(0,0,t.width,t.height))}})}("FoxFur/furtex.png"),s=new k(e),o=new M(e,r,n);return window.main.ui.bindSliders(o),s.fur=o,s.obj.push(o),s}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(73);function s(e){return new Promise(t=>e.toBlob(e=>t(r.assertExists(e)),"image/png"))}async function i(e){return await new Response(e).arrayBuffer()}t.captureScene=async function(e,t){const a=[];window.main.setPaused(!0),e.sceneTime=0,e.rafTime=0;for(let o=0;o<t.frameCount;o++){const l=o/(t.frameCount-1);if(n.resizeCanvas(e.canvas,t.width,t.height,1),!t.setupCallback(e,l,o))break;await Promise.resolve();const c=e.takeScreenshotToCanvas(t.opaque),h=await s(c),d=await i(h),u=`${t.filenamePrefix}_${r.leftPad(""+o,4)}.png`;a.push({filename:u,data:d})}return window.main.setPaused(!1),a}},function(e,t,a){var r;r=function(e){e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),a=0;256!=a;++a)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=a)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[a]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();e.table=t,e.bstr=function(e,a){for(var r=-1^a,n=e.length-1,s=0;s<n;)r=(r=r>>>8^t[255&(r^e.charCodeAt(s++))])>>>8^t[255&(r^e.charCodeAt(s++))];return s===n&&(r=r>>>8^t[255&(r^e.charCodeAt(s))]),-1^r},e.buf=function(e,a){if(e.length>1e4)return function(e,a){for(var r=-1^a,n=e.length-7,s=0;s<n;)r=(r=(r=(r=(r=(r=(r=(r=r>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])];for(;s<n+7;)r=r>>>8^t[255&(r^e[s++])];return-1^r}(e,a);for(var r=-1^a,n=e.length-3,s=0;s<n;)r=(r=(r=(r=r>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])])>>>8^t[255&(r^e[s++])];for(;s<n+3;)r=r>>>8^t[255&(r^e[s++])];return-1^r},e.str=function(e,a){for(var r,n,s=-1^a,i=0,o=e.length;i<o;)(r=e.charCodeAt(i++))<128?s=s>>>8^t[255&(s^r)]:r<2048?s=(s=s>>>8^t[255&(s^(192|r>>6&31))])>>>8^t[255&(s^(128|63&r))]:r>=55296&&r<57344?(r=64+(1023&r),n=1023&e.charCodeAt(i++),s=(s=(s=(s=s>>>8^t[255&(s^(240|r>>8&7))])>>>8^t[255&(s^(128|r>>2&63))])>>>8^t[255&(s^(128|n>>6&15|(3&r)<<4))])>>>8^t[255&(s^(128|63&n))]):s=(s=(s=s>>>8^t[255&(s^(224|r>>12&15))])>>>8^t[255&(s^(128|r>>6&63))])>>>8^t[255&(s^(128|63&r))];return-1^s}},"undefined"==typeof DO_NOT_EXPORT_CRC?r(t):r({})},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(48)),s=a(6),i=a(0),o=a(309),l=a(17),c=a(20),h=a(7),d=a(13),u=a(1),m=a(23),p=a(9),f=a(8),A=a(2),g=a(58),_=a(76),S=a(10),b=a(51),v=a(30),w=a(11),x=a(14),T=a(77);function y(e){return i.assert(1===e.chunks.length),i.assert("COMM"===e.chunks[0].tag),function(e){i.assert("COMM"===e.tag);const t=e.buffer.createDataView(),a=t.getUint16(0),r=t.getUint16(2),n=t.getUint16(4),s=t.getUint16(6);let o=8;const l=new Float32Array(9*a);for(let e=0;e<l.length;)l[e++]=t.getInt16(o+0),l[e++]=t.getInt16(o+2),l[e++]=t.getInt16(o+4),l[e++]=t.getInt16(o+8)/32+.5,l[e++]=t.getInt16(o+10)/32+.5,l[e++]=t.getUint8(o+12)/255,l[e++]=t.getUint8(o+13)/255,l[e++]=t.getUint8(o+14)/255,l[e++]=t.getUint8(o+15)/255,o+=16;const c=new Uint16Array(3*r);for(let e=0;e<c.length;)c[e++]=t.getUint16(o+0),c[e++]=t.getUint16(o+2),c[e++]=t.getUint16(o+4),o+=8;const h=[];for(let e=0;e<n;e++){const e=t.getUint8(o+0);o+=1;let a=u.mat4.create();for(let r=0;r<e;r++){const e=o,n=o+32,s=t.getInt16(e+0)+t.getUint16(n+0)/65536,l=t.getInt16(e+2)+t.getUint16(n+2)/65536,c=t.getInt16(e+4)+t.getUint16(n+4)/65536,h=t.getInt16(e+6)+t.getUint16(n+6)/65536,d=t.getInt16(e+8)+t.getUint16(n+8)/65536,m=t.getInt16(e+10)+t.getUint16(n+10)/65536,p=t.getInt16(e+12)+t.getUint16(n+12)/65536,f=t.getInt16(e+14)+t.getUint16(n+14)/65536,A=t.getInt16(e+16)+t.getUint16(n+16)/65536,g=t.getInt16(e+18)+t.getUint16(n+18)/65536,_=t.getInt16(e+20)+t.getUint16(n+20)/65536,S=t.getInt16(e+22)+t.getUint16(n+22)/65536,b=t.getInt16(e+24)+t.getUint16(n+24)/65536,v=t.getInt16(e+26)+t.getUint16(n+26)/65536,w=t.getInt16(e+28)+t.getUint16(n+28)/65536,x=t.getInt16(e+30)+t.getUint16(n+30)/65536;0==r&&(a=u.mat4.fromValues(s,l,c,h,d,m,p,f,A,g,_,S,b,v,w,x)),i.assert(1===x),o+=64}const r=t.getInt16(o+0),n=t.getFloat32(o+2),s=t.getFloat32(o+6),l=t.getFloat32(o+10);0===e&&(i.assert(0===n),i.assert(0===s),i.assert(0===l)),o+=18,r>=0&&h.push({modelIndex:r,modelMatrix:a})}const d=[];for(let e=0;e<s;e++){const e=t.getUint16(o+0),a=t.getUint16(o+2),r=(t.getUint16(o+4),t.getUint16(o+6)),n=t.getUint16(o+8);o+=10;for(let e=0;e<n;e++){const e=t.getUint16(o+0);o+=2,0==(16384&e)&&(o+=1)}const s=3*t.getUint16(o+0);o+=24,d.push({rspModeInfo:e,textureIndex:a,indexOffset:s,triCount:r})}return{mesh:{vertexData:l,indexData:c,materials:d},models:h}}(e.chunks[0])}function C(e){const t=e.buffer.createDataView(),a=(t.getFloat32(0),t.getFloat32(4),t.getUint8(24)),r=t.getUint8(25),n=t.getFloat32(26),s=t.getFloat32(30),o=(t.getFloat32(34),[]);let l=38;for(let e=0;e<a*r;e++){if(0===t.getUint8(l++))continue;const e=t.getFloat32(l+0),a=t.getFloat32(l+4),r=t.getFloat32(l+8),n=t.getFloat32(l+12),s=t.getFloat32(l+16),c=t.getFloat32(l+20),h=t.getFloat32(l+24),d=t.getFloat32(l+28),m=t.getFloat32(l+32),p=t.getFloat32(l+36),f=t.getFloat32(l+40),A=t.getFloat32(l+44);i.assert(1===e&&0===a&&0===r&&0===n),i.assert(0===s&&1===c&&0===h&&0===d),i.assert(0===m&&0===p&&1===f&&0===A);const g=t.getFloat32(l+48),_=t.getFloat32(l+52),S=t.getFloat32(l+56);i.assert(0===S);const b=u.vec3.fromValues(g,_,S),v=t.getFloat32(l+60);i.assert(1===v);const w=t.getInt8(l+64);i.assert(0===w);const x=t.getUint16(l+65);o.push({contourIndex:x,position:b}),l+=67}return{gridWidth:a,gridHeight:r,cellX:n,cellY:s,contourPlacements:o}}function M(e){const t=[];for(let a=0;a<e.chunks.length;a++)t.push(C(e.chunks[a]));return{maps:t}}var U;function k(e){return i.assert(1===e.chunks.length),function(e,t){const a=e.buffer.createDataView(),r=a.getUint16(0),s=8*a.getUint16(2),o=a.getFloat32(4),l=a.getFloat32(8),c=a.getFloat32(12),h=a.getFloat32(16);let d,m,p,f=0,A=0,S=-1;const b=new g.TextureState,v=i.nArray(8,()=>new n.TileState),w=[],x=20+r,T=x+s;for(let e=16777215&x;e<T;e+=8){const t=a.getUint32(e+0),r=a.getUint32(e+4),s=t>>>24;if(s===U.G_TEXTURE){const e=t>>>11&7,a=t>>>8&7,n=!!(t>>>0&127),s=r>>>16&65535,o=r>>>0&65535;i.assert(n),b.set(n,a,e,s,o)}else if(s===U.G_SETCOMBINE)p=n.decodeCombineParams(t,r);else if(s===U.G_SETOTHERMODE_H){f|=r}else if(s===U.G_RDPLOADSYNC);else if(s===U.G_RDPTILESYNC);else if(s===U.G_SETTIMG){i.assert(0===r),A++,i.assert(A<=2)}else if(s===U.G_SETTILE){const e=t>>>21&7,a=t>>>19&3,n=t>>>9&511,s=t>>>0&511,o=r>>>24&7,l=r>>>20&15,c=r>>>18&3,h=r>>>14&15,d=r>>>10&15,u=r>>>8&3,m=r>>>4&15,p=r>>>0&15;v[o].set(e,a,n,s,l,c,h,d,u,m,p),2===A&&(i.assert(-1===S||7===S),S=o)}else if(s===U.G_LOADBLOCK){const e=t>>>12&4095,a=t>>>0&4095,n=r>>>24&7,s=r>>>0&4095;i.assert(7===n),i.assert(0===e&&0===a),i.assert(0===s)}else if(s===U.G_SETTILESIZE){const e=t>>>12&4095,a=t>>>0&4095,n=r>>>12&4095,s=r>>>0&4095;v[r>>>24&7].setSize(e,a,n,s)}else{if(s===U.G_ENDDL)break;s===U.G_SETPRIMCOLOR?d=u.vec4.fromValues((r>>>24&255)/255,(r>>>16&255)/255,(r>>>8&255)/255,(r>>>0&255)/255):s===U.G_SETENVCOLOR?m=u.vec4.fromValues((r>>>24&255)/255,(r>>>16&255)/255,(r>>>8&255)/255,(r>>>0&255)/255):console.warn(`Unsupported command ${U[s]}`)}}const y=a.getUint16(T+7)>>>15==0,C=a.getUint16(T+9),M=a.getUint8(T+13);A>1&&i.assert(C<4095),b.level,b.tile;for(let e=b.tile;e<=b.tile+1;e++){const t=v[e];0===t.lrs&&0===t.lrt&&(i.assert(0!=c||0!=h||0!=o||0!=l),t.lrs=4*a.getUint16(T+0)-4,t.lrt=4*a.getUint16(T+2)-4);const r=S===e,n=1+(t.lrs-t.uls>>>2),s=1+(t.lrt-t.ult>>>2),d=new Uint8Array(n*s*4),u=20+t.tmem;if(r||(0===t.fmt&&2===t.siz?_.decodeTex_RGBA16(d,a,u,n,s,t.line,!0):4===t.fmt&&0===t.siz?_.decodeTex_I4(d,a,u,n,s,t.line,!0):4===t.fmt&&1===t.siz?_.decodeTex_I8(d,a,u,n,s,t.line,!0):3===t.fmt&&0===t.siz?_.decodeTex_IA4(d,a,u,n,s,t.line,!0):3===t.fmt&&1===t.siz?_.decodeTex_IA8(d,a,u,n,s,t.line,!0):3===t.fmt&&2===t.siz?_.decodeTex_IA16(d,a,u,n,s,t.line,!0):console.warn(`Unsupported texture format ${_.getImageFormatName(t.fmt)} / ${_.getImageSizeName(t.siz)}`)),w.push({width:n,height:s,pixels:d,shiftS:t.shifts,shiftT:t.shiftt,usesPaired:r}),4095==C)break}const k=b.tile===S?1:0,D=v[b.tile+k],I=D.cms,R=D.cmt,B={name:t,width:w[k].width,height:w[k].height,fmt:D.fmt,siz:D.siz,levels:w,cms:I,cmt:R,combine:p,otherModeH:f,cutOutTransparent:y,otherModeLByte:M};return 0===c&&0===h||(B.uvScroll={scaleS:c,scaleT:h}),0===o&&0===l||(B.combineScroll={scaleS:o,scaleT:l}),d&&(B.primitive=d),m&&(B.environment=m),C<4095&&(B.pairedIndex=C),B}(e.chunks[0],e.name)}function D(e){const t=e.buffer,a=t.createDataView(),r=[];let n=0;for(let e=0;e<10;e++){const e=a.getUint16(n+0),s=t.createTypedArray(Uint16Array,n+2,e,1);r.push(s),n+=2+2*e}return{terras:r[0],lights:r[1],envs:r[2],models:r[3],contours:r[4],textures:r[5],sqs:r[6],anims:r[7],fonts:r[8],blits:r[9]}}function I(e){const t=[];for(let a=0;a<e.chunks.length;a++)t.push(D(e.chunks[a]));return{levels:t}}function R(e){i.assert(1==e.chunks.length);const t=e.chunks[0].buffer.createDataView(),a=t.getUint16(0),r=t.getUint8(2),n=t.getUint8(3),s=t.getUint8(4),o=t.getInt8(5)>0;let l=8;const c=new Float32Array(9*a);for(let e=0;e<c.length;)c[e++]=t.getInt16(l+0),c[e++]=t.getInt16(l+2),c[e++]=t.getInt16(l+4),c[e++]=t.getInt16(l+8)/32+.5,c[e++]=t.getInt16(l+10)/32+.5,c[e++]=t.getUint8(l+12)/255,c[e++]=t.getUint8(l+13)/255,c[e++]=t.getUint8(l+14)/255,c[e++]=t.getUint8(l+15)/255,l+=16;const h=[],d=new Uint16Array(16);for(let e=0;e<r;e++){const e=t.getUint8(l+0),a=0!==t.getUint8(l+1);i.assert(e<=n),l+=2;const r=[];for(let a=0;a<e;a++){const e=t.getUint8(l+0),a=t.getUint8(l+2);l+=3;const n=[],s=[];for(let a=0;a<e;a++){const e=t.getUint16(l+0),a=t.getUint16(l+2),r=(t.getUint16(l+4),t.getUint16(l+6)),o=t.getUint16(l+8);l+=10;const c=n.length;for(let e=0;e<o;e++){const e=t.getUint16(l);if(l+=2,16384&e)n.push(d[(3840&e)>>8],d[(240&e)>>4],d[(15&e)>>0]);else{const a=t.getUint8(l++);for(let t=0,r=15&a;t<=a>>4;t++,r++)d[r]=(16383&e)+t}}i.assert(n.length-c==3*r),s.push({rspModeInfo:e,textureIndex:a,indexOffset:c,triCount:r})}r.push({indexData:new Uint16Array(n),materials:s,attachmentLevel:a})}const s=t.getFloat32(l);l+=4,h.push({parts:r,radius:s,billboard:a})}const m=[];for(let e=0;e<n;e++){const e=t.getFloat32(l+0),a=t.getFloat32(l+4),r=t.getFloat32(l+8),n=t.getFloat32(l+12),s=t.getFloat32(l+16),o=t.getFloat32(l+20),c=t.getFloat32(l+24),h=t.getFloat32(l+28),d=t.getFloat32(l+32),p=t.getFloat32(l+36),f=t.getFloat32(l+40),A=t.getFloat32(l+44),g=t.getFloat32(l+48),_=t.getFloat32(l+52),S=t.getFloat32(l+56),b=t.getFloat32(l+60);i.assert(1===b);const v=u.mat4.fromValues(e,a,r,n,s,o,c,h,d,p,f,A,g,_,S,1);m.push(v),l+=64}return l+=36*s,{vertexData:c,partPlacements:m,lods:h,inverseScale:t.getFloat32(l+4),hasTransparency:o}}function B(e,t,a){e[0]=t.xTrack[a].value,e[1]=t.yTrack[a].value,e[2]=t.zTrack[a].value}function P(e){const t=[],a=[],r=[],n=[],s=[],o=[];for(let l=0;l<e.chunks.length;l++){const c=e.chunks[l].tag,h=e.chunks[l].buffer.createDataView(),d=h.getUint32(0);let u;if("SCPX"===c)u=t;else if("SCPY"===c)u=a;else if("SCPZ"===c)u=r;else if("SCPH"===c)u=n;else if("SCPP"===c)u=s;else{if("SCPR"!==c){i.assert("SCP#"===c&&l==e.chunks.length-1);break}u=o}let m=4;for(let e=0;e<d;e++){const e=h.getFloat32(m+0),t=h.getFloat32(m+4);u.push({time:e,value:t}),m+=8}}return{xTrack:t,yTrack:a,zTrack:r,hTrack:n,pTrack:s,rTrack:o}}function E(e,t,a,r,n,s){const i=a.time-t.time,o=(s-t.time)/i;!function(e,t,a,r,n,s){const i=2*t+-2*a+1*r+1*n,o=-3*t+3*a+-2*r+-1*n,l=0*t+0*a+1*r+0*n,c=1*t+0*a+0*r+0*n;e.pos=v.getPointCubic(i,o,l,c,s),e.vel=function(e,t,a,r){return(3*e*r+2*t)*r+a}(i,o,l,s),e.acc=6*i*s+2*o}(e,t.value,a.value,r.value*i,n.value*i,o)}!function(e){e[e.G_MTX=1]="G_MTX",e[e.G_MOVEMEM=3]="G_MOVEMEM",e[e.G_VTX=4]="G_VTX",e[e.G_DL=6]="G_DL",e[e.G_TRI1=191]="G_TRI1",e[e.G_CULLDL=190]="G_CULLDL",e[e.G_POPMTX=189]="G_POPMTX",e[e.G_MOVEWORD=188]="G_MOVEWORD",e[e.G_TEXTURE=187]="G_TEXTURE",e[e.G_SETOTHERMODE_H=186]="G_SETOTHERMODE_H",e[e.G_SETOTHERMODE_L=185]="G_SETOTHERMODE_L",e[e.G_ENDDL=184]="G_ENDDL",e[e.G_SETGEOMETRYMODE=183]="G_SETGEOMETRYMODE",e[e.G_CLEARGEOMETRYMODE=182]="G_CLEARGEOMETRYMODE",e[e.G_LINE3D=181]="G_LINE3D",e[e.G_RDPHALF_1=180]="G_RDPHALF_1",e[e.G_RDPHALF_2=179]="G_RDPHALF_2",e[e.G_MODIFYVTX=178]="G_MODIFYVTX",e[e.G_TRI2=177]="G_TRI2",e[e.G_BRANCH_Z=176]="G_BRANCH_Z",e[e.G_LOAD_UCODE=175]="G_LOAD_UCODE",e[e.G_SETCIMG=255]="G_SETCIMG",e[e.G_SETZIMG=254]="G_SETZIMG",e[e.G_SETTIMG=253]="G_SETTIMG",e[e.G_SETCOMBINE=252]="G_SETCOMBINE",e[e.G_SETENVCOLOR=251]="G_SETENVCOLOR",e[e.G_SETPRIMCOLOR=250]="G_SETPRIMCOLOR",e[e.G_SETBLENDCOLOR=249]="G_SETBLENDCOLOR",e[e.G_SETFOGCOLOR=248]="G_SETFOGCOLOR",e[e.G_SETFILLCOLOR=247]="G_SETFILLCOLOR",e[e.G_FILLRECT=246]="G_FILLRECT",e[e.G_SETTILE=245]="G_SETTILE",e[e.G_LOADTILE=244]="G_LOADTILE",e[e.G_LOADBLOCK=243]="G_LOADBLOCK",e[e.G_SETTILESIZE=242]="G_SETTILESIZE",e[e.G_LOADTLUT=240]="G_LOADTLUT",e[e.G_RDPSETOTHERMODE=239]="G_RDPSETOTHERMODE",e[e.G_SETPRIMDEPTH=238]="G_SETPRIMDEPTH",e[e.G_SETSCISSOR=237]="G_SETSCISSOR",e[e.G_SETCONVERT=236]="G_SETCONVERT",e[e.G_SETKEYR=235]="G_SETKEYR",e[e.G_SETKEYFB=234]="G_SETKEYFB",e[e.G_RDPFULLSYNC=233]="G_RDPFULLSYNC",e[e.G_RDPTILESYNC=232]="G_RDPTILESYNC",e[e.G_RDPPIPESYNC=231]="G_RDPPIPESYNC",e[e.G_RDPLOADSYNC=230]="G_RDPLOADSYNC",e[e.G_TEXRECTFLIP=229]="G_TEXRECTFLIP",e[e.G_TEXRECT=228]="G_TEXRECT"}(U||(U={}));class F{constructor(){this.pos=0,this.vel=0,this.acc=0}}const V=i.nArray(3,()=>new F);function O(e,t,a,r){let n=1;for(;n<t.length&&!(r<=t[n].time);n++);const s=n-1;E(e,t[s],t[n],a[s],a[n],r)}function N(e,t,a,r){if(t<=e[0].time)return e[0].value;if(t>=e[e.length-1].time)return e[e.length-1].value;let n=1;for(;n<e.length&&!(t<=e[n].time);n++);const s=e[n-1],i=e[n],o=i.time-s.time,l=(t-s.time)/o;return v.getPointHermite(s.value,i.value,a,r,l)}function L(e){const t=[],a=[];let r=u.vec3.create();for(let n=0;n<e.chunks.length;n++){const s=e.chunks[n].buffer.createDataView();let i=0;if("LEVL"===e.chunks[n].tag);else if("WOBJ"===e.chunks[n].tag)for(;i<s.byteLength;){const e=u.vec3.fromValues(s.getFloat32(i+0),s.getFloat32(i+4),s.getFloat32(i+8)),a=0===s.getUint8(i+12)?64:83;t.push({position:e,modelIndex:a}),i+=16}else if("LPAD"===e.chunks[n].tag)for(;i<s.byteLength;){const e=u.vec3.fromValues(s.getFloat32(i+0),s.getFloat32(i+4),s.getFloat32(i+8)),t=s.getFloat32(i+12);a.push({modelIndex:212,position:e,angles:u.vec3.fromValues(t,0,0)}),i+=24}else"BNUS"===e.chunks[n].tag&&u.vec3.set(r,s.getFloat32(i+0),s.getFloat32(i+4),s.getFloat32(i+8))}return{windObjects:t,landingPads:a,bonusStar:r}}const G=["Beginner","Class A","Class B","Pilot"],H=["Hang Glider","Rocket Belt","Gyrocopter","Cannonball","Skydiving","Jumble Hopper","Birdman"];function j(e){const t=H[e.vehicle];if(e.vehicle<=2){return`${t} ${G[e.taskClass]} #${e.taskStage+1}`}return 3===e.vehicle?`${t} Level ${e.taskClass+1} Target #${e.taskStage+1}`:e.vehicle<6?(i.assert(0===e.taskStage),`${t} Level ${e.taskClass+1}`):`${t} ${e.taskClass} ${e.taskStage}`}function W(e,t){return e.label.taskClass!==t.label.taskClass?e.label.taskClass-t.label.taskClass:e.label.vehicle!==t.label.vehicle?e.label.vehicle-t.label.vehicle:e.label.taskStage-t.label.taskStage}function Z(e){let t,a,r="",n="",s="",o=[],l=[];for(let c=0;c<e.chunks.length;c++){const h=e.chunks[c].buffer.createDataView();let d=0;if("JPTX"===e.chunks[c].tag)r=i.readString(e.chunks[c].buffer,d+0,e.chunks[c].buffer.byteLength,!0);else if("INFO"===e.chunks[c].tag)s=i.readString(e.chunks[c].buffer,d+0,e.chunks[c].buffer.byteLength,!0);else if("NAME"===e.chunks[c].tag)n=i.readString(e.chunks[c].buffer,d+0,e.chunks[c].buffer.byteLength,!0);else if("COMM"===e.chunks[c].tag){t={taskClass:h.getUint8(d+0),vehicle:h.getUint8(d+1),taskStage:h.getUint8(d+2),level:h.getUint8(d+3),weather:h.getUint8(d+8)}}else if("LPAD"===e.chunks[c].tag){const e=u.vec3.fromValues(h.getFloat32(d+0),h.getFloat32(d+4),h.getFloat32(d+8)),t=u.vec3.fromValues(h.getFloat32(d+12),h.getFloat32(d+16),h.getFloat32(d+20));i.assert(u.vec3.equals(t,[0,0,0])),a={modelIndex:258+h.getUint8(d+44),position:e}}else if("THER"===e.chunks[c].tag)for(;d<h.byteLength-40;){const e=u.vec3.fromValues(h.getFloat32(d+0),h.getFloat32(d+4),h.getFloat32(d+8)),t=h.getFloat32(d+12),a=h.getFloat32(d+16);o.push({modelIndex:257,position:e,scale:u.vec3.fromValues(t,t,a)}),d+=40}else if("RNGS"===e.chunks[c].tag)for(;d<h.byteLength-132;){const e=u.vec3.fromValues(h.getFloat32(d+0),h.getFloat32(d+4),h.getFloat32(d+8)),t=u.vec3.fromValues(h.getFloat32(d+12),h.getFloat32(d+16),h.getFloat32(d+20));u.vec3.scale(t,t,.01745);const a=0===h.getUint8(d+29)?0:1,r=h.getUint8(d+84),n=h.getUint8(d+112),s=h.getUint8(d+114);let i=217+s+2*a+4*r;s>1&&(i=241),l.push({position:e,angles:t,axis:n,modelIndex:i}),d+=132}else if("BALS"===e.chunks[c].tag)for(;d<h.byteLength;){const e=u.vec3.fromValues(h.getFloat32(d+0),h.getFloat32(d+4),h.getFloat32(d+8)),t=h.getUint8(d+32),a=h.getFloat32(d+48);o.push({modelIndex:244+t,position:e,scale:u.vec3.fromValues(a,a,a)}),d+=104}else if("TARG"===e.chunks[c].tag)for(;d<h.byteLength;){const e=u.vec3.fromValues(h.getFloat32(d+0),h.getFloat32(d+4),h.getFloat32(d+8)),t=u.vec3.fromValues(h.getFloat32(d+12),h.getFloat32(d+16),h.getFloat32(d+20));u.vec3.scale(t,t,.01745);const a=h.getUint8(d+24);o.push({modelIndex:249-a,position:e,angles:t}),d+=32}}return{jptx:r,name:n,info:s,label:t,rings:l,models:o,landingPad:a}}function z(e){const t=e.buffer.createDataView(),a=t.getUint8(0);let r,n,s,i,o=1;return 2==a&&(r=t.getUint16(o+0),n=t.getUint8(o+2),o+=3),a>0&&(s=t.getUint16(o+0),i=t.getUint8(o+2),o+=3),{skyboxModel:r,skyboxFlags:n,oceanModel:s,oceanFlags:i,clearColor:u.vec4.fromValues(t.getUint8(o+0)/255,t.getUint8(o+1)/255,t.getUint8(o+2)/255,t.getUint8(o+3)/255),fogColor:u.vec4.fromValues(t.getUint8(o+4)/255,t.getUint8(o+5)/255,t.getUint8(o+6)/255,t.getUint8(o+7)/255),otherColor:u.vec4.fromValues(t.getUint8(o+8)/255,t.getUint8(o+9)/255,t.getUint8(o+10)/255,t.getUint8(o+11)/255)}}function K(e){const t=[];for(let a=0;a<e.chunks.length;a++)t.push(z(e.chunks[a]));return t}function X(e){const t=new Map,a=e.buffer.createDataView(),r=a.getUint16(0);let n=2;for(let e=0;e<r;e++){const e=a.getUint16(n+0),r=a.getUint16(n+2);t.set(e,r),n+=4}return t}function Y(e){const t=[];for(let a=0;a<e.chunks.length;a++)t.push(X(e.chunks[a]));return t}class ${constructor(e,t,a){this.uvmd=t,this.modelIndex=a;const r=t.lods[0];this.parts=r.parts.map(a=>{const r={vertexData:t.vertexData,indexData:a.indexData,materials:a.materials};return new q(e,r)});const n=r.parts.map(e=>e.attachmentLevel);this.partParentIndices=function(e){const t=e[0],a=[-1],r=[0];for(let n=1;n<e.length;n++){const s=e[n-1],o=e[n];o>s&&i.assert(o===s+1),a[n]=r[o-t-1],r[o-t]=n}return a}(n)}destroy(e){for(let t of this.parts)t.destroy(e)}}class q{constructor(e,t){this.mesh=t,this.vertexBuffer=l.makeStaticDataBuffer(e,2,t.vertexData.buffer),this.indexBuffer=l.makeStaticDataBuffer(e,1,t.indexData.buffer);const a=[{location:T.F3DEX_Program.a_Position,bufferIndex:0,format:s.GfxFormat.F32_RGB,bufferByteOffset:0},{location:T.F3DEX_Program.a_TexCoord,bufferIndex:0,format:s.GfxFormat.F32_RGBA,bufferByteOffset:12},{location:T.F3DEX_Program.a_Color,bufferIndex:0,format:s.GfxFormat.F32_RGBA,bufferByteOffset:20}];this.inputLayout=e.createInputLayout({indexBufferFormat:s.GfxFormat.U16_R,vertexAttributeDescriptors:a,vertexBufferDescriptors:[{byteStride:36,frequency:1}]}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}destroy(e){e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}function Q(e,t){if(0===e&&0===t)return 0;const a=Math.abs(e),r=Math.abs(t),n=a<r?a/r:r/a,s=Math.abs(a-r),i=n*(Math.PI/4+.309*s);let o=a<r?i:Math.PI/2-i;return t<0&&(o=Math.PI-o),e>=0?o:-o}class J{constructor(e,t,a){this.model=e,this.modelMatrix=u.mat4.create(),this.partRenderers=[],this.visible=!0,this.taskNumber=-1,this.sortKeyBase=h.makeSortKey(this.model.uvmd.hasTransparency?128:32);for(let r=0;r<e.parts.length;r++){const n=new ee(e.parts[r],t,a,this.model.uvmd.lods[0].billboard);this.partRenderers.push(n)}i.assert(e.parts.length+1<=J.jointMatrixScratch.length)}syncTaskVisibility(e){return this.taskNumber<0?this.visible:(this.visible=this.taskNumber===e,this.visible)}calcAnimJoint(e,t,a){}calcAnim(e,t,a){for(let r=0;r<this.partRenderers.length;r++){const n=this.model.partParentIndices[r];let s;-1===n?(s=ie,u.mat4.mul(s,a,this.modelMatrix)):s=J.jointMatrixScratch[n],u.mat4.copy(e[r],this.model.uvmd.partPlacements[r]),this.calcAnimJoint(e[r],t,r),u.mat4.mul(e[r],s,e[r])}}prepareToRender(e,t,a,r){if(!this.visible)return;t.pushTemplateRenderInst().sortKey=this.sortKeyBase;const n=J.jointMatrixScratch;this.calcAnim(n,a,r);for(let r=0;r<this.partRenderers.length;r++)this.partRenderers[r].prepareToRender(e,t,a,n[r]);t.popTemplateRenderInst()}}J.jointMatrixScratch=i.nArray(20,()=>u.mat4.create());class ee{constructor(e,t,a,r){this.meshData=e,this.materials=[],this.visible=!0;for(let n of e.mesh.materials)this.materials.push(new le(n,t,a,r))}prepareToRender(e,t,a,r){if(!this.visible)return;t.pushTemplateRenderInst().setInputLayoutAndState(this.meshData.inputLayout,this.meshData.inputState);for(let n=0;n<this.materials.length;n++)this.materials[n].prepareToRender(e,t,a,r);t.popTemplateRenderInst()}}function te(e){return e<=10?1/(1<<e):1<<16-e}ee.scratchMatrix=u.mat4.create();const ae=[50479104,1122864,1056840,1056888,1065536,1067600,1065416,1066456,1125904,1125904,1125720,1125720,1068624,1068624,1068504,1068504];function re(e,t,a,r){if(512&e)throw"found alternate dlist: "+e;let n,s=0;2048&e&&(s|=393216),16&e&&(s|=8192),8&e&&(s|=4096),2&e&&(s|=512),32&e&&(s|=1),32768&e&&(s|=65536);let i=0;t&&2048&e&&(n={c0:{a:7,b:7,c:15,d:1},a0:{a:7,b:7,c:7,d:4},c1:{a:7,b:7,c:15,d:1},a1:{a:7,b:7,c:7,d:4}},i=.484375);const o=e>>>5&15;let l=ae[o];6===o&&a&&(l=1060936),7===o&&t&&(l=!a||1===r||e>>>10&1?1067480:1060984),e>>>12&1&&(l=286327792),32768&e?(l|=-1006632960,7===o&&(n=t?{c0:{a:1,b:7,c:4,d:7},a0:{a:7,b:7,c:7,d:1},c1:{a:7,b:7,c:15,d:0},a1:{a:7,b:7,c:7,d:0}}:{c0:{a:7,b:7,c:15,d:4},a0:{a:7,b:7,c:7,d:4},c1:{a:7,b:7,c:15,d:0},a1:{a:7,b:7,c:7,d:0}})):l|=201850880;const c={geoMode:s,renderMode:l};return void 0!==n&&(c.combineOverride=n),i>0&&(c.scaleOverride=i),c}function ne(e,t,a){const r=t/1e3*a.scaleS%1,n=t/1e3*a.scaleT%1;e[12]=-(r>=0?r:r+1),e[13]=-(n>=0?n:n+1)}function se(e,t){const a=Math.hypot(t[0],t[1],t[2]),r=Math.hypot(t[4],t[5],t[6]),n=Math.hypot(t[9],t[10]);e[0]=-a,e[4]=0,e[8]=t[8],e[12]=t[12],e[1]=0,e[5]=-r*t[10]/n,e[9]=t[9],e[13]=t[13],e[2]=0,e[6]=r*t[9]/n,e[10]=t[10],e[14]=t[14],t[3]=9999,t[7]=9999,t[11]=9999,t[15]=9999}t.calcZBBoardMtx=se;const ie=u.mat4.create(),oe=u.mat4.create();class le{constructor(e,t,a,r){this.materialData=e,this.isBillboard=r,this.hasTexture=!1,this.hasPairedTexture=!1,this.textureMappings=i.nArray(2,()=>new S.TextureMapping),this.visible=!0,this.hasTexture=e.textureIndex<4095;let s=e.rspModeInfo;if(a&&(s&=-33),this.hasTexture){const a=t.get(e.textureIndex);this.uvtx=a.uvtx,a.fillTextureMapping(this.textureMappings[0]),void 0!==this.uvtx.pairedIndex&&(this.hasPairedTexture=!0,i.assert(this.uvtx.levels.length>1),t.get(this.uvtx.pairedIndex).fillTextureMapping(this.textureMappings[1]),this.uvtx.levels[0].usesPaired&&(i.assert(!this.uvtx.levels[1].usesPaired),this.textureMappings.reverse())),this.decodedMaterial=re(s,!0,this.uvtx.cutOutTransparent,this.uvtx.otherModeLByte);const r=this.decodedMaterial.combineOverride?this.decodedMaterial.combineOverride:this.uvtx.combine,o=u.vec4.create();n.fillCombineParams(o,0,r),this.program=new T.F3DEX_Program(this.uvtx.otherModeH,this.decodedMaterial.renderMode,o)}else{this.decodedMaterial=re(s,!1,!0,0);const e=u.vec4.create();this.program=new T.F3DEX_Program(0,this.decodedMaterial.renderMode,e)}this.stateFlags=g.translateBlendMode(this.decodedMaterial.geoMode,this.decodedMaterial.renderMode),this.program.defines.set("BONE_MATRIX_COUNT","1"),this.program.defines.set("USE_VERTEX_COLOR","1")}prepareToRender(e,t,a,r){if(!this.visible)return;const n=t.pushRenderInst();n.setMegaStateFlags(this.stateFlags);let s=n.allocateUniformBuffer(T.F3DEX_Program.ub_DrawParams,28);const i=n.mapUniformBufferF32(T.F3DEX_Program.ub_DrawParams);if(f.computeViewMatrix(ie,a.camera),u.mat4.mul(ie,ie,r),128&h.getSortKeyLayer(n.sortKey)&&(n.sortKey=h.setSortKeyDepth(n.sortKey,-ie[14])),this.isBillboard&&se(ie,ie),s+=d.fillMatrix4x3(i,s,ie),this.hasTexture){n.setSamplerBindingsFromTextureMappings(this.textureMappings);let e=te(this.uvtx.levels[0].shiftS),t=te(this.uvtx.levels[0].shiftT);if(this.decodedMaterial.scaleOverride&&(e/=this.decodedMaterial.scaleOverride,t/=this.decodedMaterial.scaleOverride),u.mat4.fromScaling(oe,[e/this.textureMappings[0].width,t/this.textureMappings[0].height,1]),this.uvtx.uvScroll&&ne(oe,a.time,this.uvtx.uvScroll),s+=d.fillMatrix4x2(i,s,oe),this.program.defines.set("USE_TEXTURE","1"),this.hasPairedTexture){const e=te(this.uvtx.levels[1].shiftS),t=te(this.uvtx.levels[1].shiftT);u.mat4.fromScaling(oe,[e/this.textureMappings[1].width,t/this.textureMappings[1].height,1]),this.uvtx.combineScroll&&ne(oe,a.time,this.uvtx.combineScroll),s+=d.fillMatrix4x2(i,s,oe)}s=n.allocateUniformBuffer(T.F3DEX_Program.ub_CombineParams,8);const r=n.mapUniformBufferF32(T.F3DEX_Program.ub_CombineParams);this.uvtx.primitive&&d.fillVec4v(r,s+0,this.uvtx.primitive),this.uvtx.environment&&d.fillVec4v(r,s+4,this.uvtx.environment)}else this.program.defines.set("ONLY_VERTEX_COLOR","1");const o=t.gfxRenderCache.createProgram(e,this.program);n.setGfxProgram(o),n.drawIndexes(3*this.materialData.triCount,this.materialData.indexOffset)}}function ce(e){switch(e){case 0:return 1;case 1:return 2;case 2:return 0}}const he=[{numUniformBuffers:3,numSamplers:2}];class de{constructor(e,t,a){this.uvtx=a;const r=this.uvtx;this.gfxTexture=e.createTexture(s.makeTextureDescriptor2D(s.GfxFormat.U8_RGBA_NORM,r.width,r.height,r.levels.length)),e.setResourceName(this.gfxTexture,r.name);const n=e.createHostAccessPass(),i=r.levels.filter(e=>!e.usesPaired).map(e=>e.pixels);n.uploadTextureData(this.gfxTexture,0,i),e.submitPass(n),this.gfxSampler=e.createSampler({wrapS:ce(r.cms),wrapT:ce(r.cmt),minFilter:0,magFilter:0,mipFilter:0,minLOD:0,maxLOD:0}),this.viewerTexture=function(e){const t=[];for(let a=0;a<e.levels.length;a++){const r=e.levels[a],n=document.createElement("canvas");n.width=r.width,n.height=r.height;const s=n.getContext("2d"),i=s.createImageData(n.width,n.height);i.data.set(r.pixels),s.putImageData(i,0,0),t.push(n)}const a=new Map;return a.set("Format",`${_.getImageFormatName(e.fmt)}${_.getImageSizeName(e.siz)}`),{name:e.name,extraInfo:a,surfaces:t}}(a)}fillTextureMapping(e){e.gfxTexture=this.gfxTexture,e.gfxSampler=this.gfxSampler,e.width=this.uvtx.width,e.height=this.uvtx.height,e.lodBias=0}destroy(e){e.destroyTexture(this.gfxTexture),e.destroySampler(this.gfxSampler)}}class ue extends J{calcAnimJoint(e,t,a){const r=t.time/1e3;if(1===a){const t=10;u.mat4.rotateZ(e,e,.01745*t*r)}}}class me extends J{calcAnimJoint(e,t,a){const r=t.time/1e3;if(1===a){const t=17;u.mat4.rotateY(e,e,.01745*t*r)}else if(a>=2){const t=-17;u.mat4.rotateY(e,e,.01745*t*r)}}}class pe extends J{calcAnimJoint(e,t,a){const r=t.time/1e3;if(0===a){const t=40;u.mat4.rotateY(e,e,.01745*t*r)}}}function fe(e,t,a){return Q(e*a,t)}class Ae extends J{calcAnimJoint(e,t,a){const r=t.time/1e3;if(1===a){const t=65;u.mat4.rotateX(e,e,.01745*(270+t*r))}else if(2===a){const t=Math.sin(1.13425*r);u.mat4.rotateX(e,e,fe(1.16,55,t))}else if(3===a){const t=Math.sin(1.13425*r);u.mat4.rotateX(e,e,fe(-1.16,55,t))}}}class ge extends J{constructor(e,t){super(e,t);const a=1/e.uvmd.inverseScale;u.mat4.scale(this.modelMatrix,this.modelMatrix,[a,a,a]),this.translationScale=e.uvmd.inverseScale}}class _e extends J{calcAnimJoint(e,t,a){const r=t.time/1e3;u.mat4.rotateZ(e,e,6.283*r)}}class Se extends J{constructor(){super(...arguments),this.alternates=[]}syncTaskVisibility(e){this.visible=!0;for(let t=0;t<this.alternates.length;t++)this.alternates[t].syncTaskVisibility(e)&&(this.visible=!1);return this.visible}}class be extends ge{constructor(e,t,a){super(e,t),this.params=a,this.bounceHeight=0,this.bounceVelocity=0,a.bounce&&(this.bounceVelocity=a.bounce.maxVelocity),u.vec3.scale(this.params.center,this.params.center,this.translationScale),u.mat4.translate(this.modelMatrix,this.modelMatrix,this.params.center)}calcAnimJoint(e,t,a){const r=t.time/1e3;if(0===a)u.mat4.fromZRotation(e,this.params.angularVelocity*r*.01745),u.mat4.translate(e,e,[this.params.radius*this.translationScale,0,0]),0!==this.params.roll&&u.mat4.rotateY(e,e,.01745*this.params.roll);else if(this.params.bounce&&this.params.bounce.bouncingPart===a){const a=.75*t.deltaTime/1e3,r=this.params.bounce;this.bounceVelocity-=9.8*a,this.bounceHeight+=this.bounceVelocity*a,this.bounceHeight<=0&&(this.bounceHeight=0,this.bounceVelocity=r.maxVelocity*Math.random());let n=this.bounceHeight/r.maxHeight*r.maxAngle;this.bounceVelocity>0&&(n*=2),n>r.maxAngle&&(n=r.maxAngle),this.params.angularVelocity<0&&(n*=-1),u.mat4.rotateX(e,e,.01745*n),u.mat4.translate(e,e,[0,0,this.bounceHeight*this.translationScale])}}}function ve(e,t){if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(e[a].time!==t[a].time)return!1;return!0}class we extends ge{constructor(e,t,a,r){super(e,t),this.spline=a,this.params=r,this.pos=u.vec3.create(),this.angles=u.vec3.create(),this.speed=0,this.yawSpeed=0,this.oldPitch=0,this.fly(r.pathLength),this.pos[2]=r.minHeight,this.angles[2]=0,i.assert(ve(a.xTrack,a.hTrack)),i.assert(ve(a.yTrack,a.pTrack)),i.assert(ve(a.zTrack,a.rTrack))}fly(e){const t=e/this.params.pathLength*100;O(V[0],this.spline.xTrack,this.spline.hTrack,t),O(V[1],this.spline.yTrack,this.spline.pTrack,t),O(V[2],this.spline.zTrack,this.spline.rTrack,t);const a=V[0],r=V[1],n=V[2],s=Math.hypot(a.vel,r.vel),i=Math.hypot(a.pos,r.pos),o=Math.abs(a.pos*a.vel+r.pos*r.vel)/i,l=Math.hypot(n.vel,o);this.angles[0]=Q(-a.vel/s,r.vel/s),this.angles[1]=Q(n.vel/l,o/l),u.vec3.set(this.pos,a.pos,r.pos,n.pos),this.speed=Math.hypot(s,n.vel),this.yawSpeed=(r.acc*a.vel-a.acc*r.vel)/(s*s)}calcAnimJoint(e,t,a){const r=t.time/1e3,n=Math.abs(t.deltaTime/1e3/10);this.oldPitch=this.angles[1],this.fly(r%this.params.pathLength),this.pos[2]<this.params.minHeight&&(this.pos[2]=this.params.minHeight),this.angles[1]=A.clamp(this.angles[1],this.oldPitch-n,this.oldPitch+n);const s=-this.params.rollFactor*this.yawSpeed/this.speed;if(Math.abs(s)>1e-5){let e;e=s<-1?-Math.PI/2:s>1?Math.PI/2:Q(s,Math.sqrt(1-s*s)),this.angles[2]=A.clamp(e,this.angles[2]-n,this.angles[2]+n)}else this.angles[2]=0;u.vec3.scale(this.pos,this.pos,this.translationScale),Re(e,this.pos,1,this.angles)}}class xe extends ge{constructor(e,t,a,r){super(e,t),this.spline=a,this.offset=r,this.pos=u.vec3.create(),i.assert(ve(a.xTrack,a.yTrack)),i.assert(ve(a.xTrack,a.zTrack))}calcAnimJoint(e,t,a){const r=(t.time/1e3+this.offset)%100,n=this.spline.xTrack.length;let s=1;for(;s<n&&!(r<=this.spline.xTrack[s].time);s++);const i=xe.scratchVectors,o=s<n-1?s+1:0,l=s-1,c=s>1?s-2:n-1;B(i[0],this.spline,c),B(i[1],this.spline,l),B(i[2],this.spline,s),B(i[3],this.spline,o);const h=512*Math.abs(this.spline.xTrack[s].time-this.spline.xTrack[l].time)/100;u.vec3.sub(i[1],i[1],i[0]),u.vec3.normalize(i[1],i[1]),u.vec3.scale(i[1],i[1],h),u.vec3.sub(i[3],i[3],i[2]),u.vec3.normalize(i[3],i[3]),u.vec3.scale(i[3],i[3],h);const d=i[1],m=i[3];this.pos[0]=N(this.spline.xTrack,r,d[0],m[0]),this.pos[1]=N(this.spline.yTrack,r,d[1],m[1]),this.pos[2]=N(this.spline.zTrack,r,d[2],m[2]),u.vec3.scale(this.pos,this.pos,this.translationScale);const p=N(this.spline.hTrack,r,1,-1),f=N(this.spline.pTrack,r,1,-1),A=N(this.spline.rTrack,r,1,-1);u.mat4.fromTranslation(e,this.pos),u.mat4.rotateZ(e,e,.01745*p),u.mat4.rotateX(e,e,.01745*f),u.mat4.rotateY(e,e,.01745*A)}}xe.scratchVectors=i.nArray(4,()=>u.vec3.create());class Te extends J{constructor(e,t,a){super(e,t),this.axis=a}calcAnimJoint(e,t,a){if(0!==a)return;const r=t.time/1e3;120===this.axis?u.mat4.fromXRotation(e,r):121===this.axis?u.mat4.fromYRotation(e,r):122===this.axis&&u.mat4.fromZRotation(e,r)}}class ye extends c.DeviceProgram{constructor(){super(...arguments),this.name="PW64_Snow",this.both="\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n};\n\nlayout(row_major, std140) uniform ub_DrawParams {\n    Mat4x3 u_BoneMatrix;\n    vec4 u_Shift;\n};",this.vert="\nlayout(location = 0) in vec3 a_Position;\n\nvoid main() {\n    gl_Position = vec4(a_Position, 1.0) + vec4(u_Shift.xyz, 0.0);\n    // slightly clumsy, force into 0-10k cube, then shift center to origin\n    // just easier than dealing with negative mod values\n    float cubeSide = 5000.0;\n    gl_Position = mod(gl_Position, 2.0*vec4(cubeSide)) - vec4(vec3(cubeSide), 0.0);\n    gl_Position = Mul(_Mat4x4(u_BoneMatrix), gl_Position);\n    // shift snow cube in front of camera\n    gl_Position.z -= cubeSide;\n    // add offset based on which corner this is, undoing perspective correction so every flake is the same size\n    gl_Position += (u_Shift.w * gl_Position.z) * vec4(float(gl_VertexID & 1) - 0.5, float((gl_VertexID >> 1) & 1) - 0.5, 0.0, 0.0);\n    gl_Position = Mul(u_Projection, gl_Position);\n    // game writes snow directly to the frame buffer, with a very simple projection\n    // this effectively leads to a slightly larger FOV, so apply the same multiplier here\n    gl_Position = gl_Position * vec4(0.81778, 0.81778, 1.0, 1.0);\n}",this.frag="\nvoid main() {\n    gl_FragColor = vec4(1.0); // flakes are just white\n}"}}ye.a_Position=0,ye.a_Corner=1,ye.ub_SceneParams=0,ye.ub_DrawParams=1;const Ce=[{numUniformBuffers:2,numSamplers:0}],Me=u.vec3.create();class Ue{constructor(e,t){this.flakeCount=t,this.visible=!0,this.snowProgram=new ye,this.snowShift=u.vec3.create(),this.flakeBounds=1e4,this.flakeScale=.005;const a=new Float32Array(12*t),r=new Uint16Array(6*t);for(let e=0;e<t;e++){const t=u.vec3.fromValues(this.flakeBounds*Math.random(),this.flakeBounds*Math.random(),this.flakeBounds*Math.random());for(let r=0;r<4;r++)a[12*e+3*r+0]=t[0],a[12*e+3*r+1]=t[1],a[12*e+3*r+2]=t[2];r[6*e+0]=4*e+0,r[6*e+1]=4*e+1,r[6*e+2]=4*e+2,r[6*e+3]=4*e+2,r[6*e+4]=4*e+1,r[6*e+5]=4*e+3}this.vertexBuffer=l.makeStaticDataBuffer(e,2,a.buffer),this.indexBuffer=l.makeStaticDataBuffer(e,1,r.buffer);const n=[{location:ye.a_Position,bufferIndex:0,format:s.GfxFormat.F32_RGB,bufferByteOffset:0}];this.inputLayout=e.createInputLayout({indexBufferFormat:s.GfxFormat.U16_R,vertexAttributeDescriptors:n,vertexBufferDescriptors:[{byteStride:12,frequency:1}]}),this.inputState=e.createInputState(this.inputLayout,[{buffer:this.vertexBuffer,byteOffset:0}],{buffer:this.indexBuffer,byteOffset:0})}prepareToRender(e,t,a){if(!this.visible)return;const r=t.pushRenderInst();r.filterKey=2,r.setBindingLayouts(Ce),r.setMegaStateFlags(x.fullscreenMegaState);let n=r.allocateUniformBuffer(ye.ub_DrawParams,16);const s=r.mapUniformBufferF32(ye.ub_DrawParams);A.computeMatrixWithoutTranslation(ie,a.camera.viewMatrix),n+=d.fillMatrix4x3(s,n,ie),u.vec3.set(this.snowShift,0,0,-this.flakeBounds/2),u.vec3.transformMat4(this.snowShift,this.snowShift,a.camera.worldMatrix),u.vec3.scale(this.snowShift,this.snowShift,-1),u.mat4.getTranslation(Me,a.camera.worldMatrix),u.vec3.scaleAndAdd(this.snowShift,this.snowShift,Me,-3),this.snowShift[1]-=.75*a.time;for(let e=0;e<3;e++)this.snowShift[e]=this.snowShift[e]%this.flakeBounds,this.snowShift[e]<0&&(this.snowShift[e]+=this.flakeBounds);d.fillVec3v(s,n,this.snowShift,this.flakeScale),r.setInputLayoutAndState(this.inputLayout,this.inputState),r.setGfxProgram(t.gfxRenderCache.createProgram(e,this.snowProgram)),r.drawIndexes(6*this.flakeCount)}destroy(e){e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState)}}class ke{constructor(e,t){this.uvct=t,this.meshData=new q(e,t.mesh)}destroy(e){this.meshData.destroy(e)}}class De{constructor(){this.textureData=[],this.uvmdData=[],this.uvctData=[],this.uvtr=[],this.uvlv=[],this.upwl=[],this.upwt=i.nArray(4,()=>[]),this.uven=[],this.uvtp=[],this.splineData=new Map,this.gfxRenderCache=new b.GfxRenderCache}destroy(e){for(let t=0;t<this.textureData.length;t++)this.textureData[t].destroy(e);for(let t=0;t<this.uvmdData.length;t++)this.uvmdData[t].destroy(e);for(let t=0;t<this.uvctData.length;t++)this.uvctData[t].destroy(e);this.gfxRenderCache.destroy(e)}}function Ie(e,t){const a=e.uvmdData[t],r=e.palette;return 9===t?new ue(a,r):12===t?new me(a,r):13===t?new pe(a,r):84===t?new Ae(a,r):new J(a,r)}function Re(e,t,a,r){u.mat4.fromTranslation(e,t),e[0]=a,e[5]=a,e[10]=a,r&&(u.mat4.rotateZ(e,e,r[0]),u.mat4.rotateX(e,e,r[1]),u.mat4.rotateY(e,e,r[2]))}function Be(e,t,a){const r=e.uvmdData[t.modelIndex],n=new J(r,e.palette);void 0!==a&&(n.taskNumber=a,n.syncTaskVisibility(-1));let s=1/r.uvmd.inverseScale;return Re(n.modelMatrix,t.position,s,t.angles),t.scale&&u.mat4.scale(n.modelMatrix,n.modelMatrix,t.scale),n}class Pe{constructor(e,t){this.uvctData=t,this.modelMatrix=u.mat4.create(),this.sobjRenderers=[],this.visible=!0,this.meshRenderer=new ee(t.meshData,e.palette);const a=this.uvctData.uvct.models;for(let t=0;t<a.length;t++){const r=a[t],n=Ie(e,r.modelIndex);u.mat4.copy(n.modelMatrix,r.modelMatrix),this.sobjRenderers.push(n)}}prepareToRender(e,t,a,r){if(!this.visible)return;u.mat4.mul(Pe.scratchMatrix,r,this.modelMatrix),t.pushTemplateRenderInst().sortKey=h.makeSortKey(32),this.meshRenderer.prepareToRender(e,t,a,Pe.scratchMatrix),t.popTemplateRenderInst();for(let r=0;r<this.sobjRenderers.length;r++)this.sobjRenderers[r].prepareToRender(e,t,a,Pe.scratchMatrix)}}Pe.scratchMatrix=u.mat4.create();class Ee{constructor(e,t,a){this.uvtrChunk=a,this.uvctRenderers=[],this.modelMatrix=u.mat4.create();for(let a=0;a<this.uvtrChunk.contourPlacements.length;a++){const r=this.uvtrChunk.contourPlacements[a],n=e.uvctData[r.contourIndex],s=new Pe(t,n);u.mat4.translate(s.modelMatrix,s.modelMatrix,r.position),this.uvctRenderers.push(s)}}prepareToRender(e,t,a){for(let r=0;r<this.uvctRenderers.length;r++)this.uvctRenderers[r].prepareToRender(e,t,a,this.modelMatrix)}}async function Fe(e,t){const a=function(e){const t=e.createDataView(),a=[];let r=0;for(;r<e.byteLength;){const n=i.readString(e,r+0,4,!1);if("\0\0\0\0"===n)break;i.assert("FORM"===n);const s=r+8+t.getUint32(r+4),l=i.readString(e,r+8,4),c=`${l}_${i.hexzero(r,6)}`;r+=12;const h=[];for(;r<s;){const a=i.readString(e,r+0,4),n=t.getUint32(r+4),s=r+8+n;if("GZIP"===a){const a=i.readString(e,r+8,4),s=t.getUint32(r+12),l=o.decompress(e.subarray(r+16,n-8));i.assert(l.byteLength===s),h.push({tag:a,buffer:l})}else"PAD "!==a&&h.push({tag:a,buffer:e.subarray(r+8,n)});r=s}a.push({name:c,type:l,chunks:h}),i.assert(r===s)}return{files:a}}(await e.fetchData(`${Ge}/fs.bin`)),r=new De;let n=0;for(let e=0;e<a.files.length;e++){const s=a.files[e];if("UVCT"===s.type){const e=y(s);r.uvctData.push(new ke(t,e))}else if("UVTX"===s.type){const e=k(s);r.textureData.push(new de(t,r.gfxRenderCache,e))}else if("UVMD"===s.type){const e=R(s);r.uvmdData.push(new $(t,e,r.uvmdData.length))}else if("UVTR"===s.type)r.uvtr.push(M(s));else if("UVLV"===s.type)r.uvlv.push(I(s));else if("UPWL"===s.type)r.upwl.push(L(s));else if("UPWT"===s.type){const e=Z(s);r.upwt[e.label.level].push(e)}else"UVTP"===s.type?r.uvtp=Y(s):"UVEN"===s.type?r.uven=K(s):"SPTH"===s.type&&r.splineData.set(n,P(s));s.type.startsWith("UV")||n++}return r}const Ve=u.mat4.create();u.mat4.fromXRotation(Ve,-1.5705),u.mat4.scale(Ve,Ve,[50,50,50]);class Oe{constructor(e,t,a){this.dataHolder=t,this.modelBuilder=a,this.uvtrRenderers=[],this.dobjRenderers=[],this.skyRenderers=[],this.snowRenderer=null,this.renderTarget=new p.BasicRenderTarget,this.taskLabels=[],this.strIndexToTask=[],this.currentTaskIndex=-1,this.renderHelper=new m.GfxRenderHelper(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(128/60)}prepareToRender(e,t,a){const r=this.renderHelper.pushTemplateRenderInst();r.setBindingLayouts(he),r.setMegaStateFlags(x.setAttachmentStateSimple({},{blendMode:s.GfxBlendMode.ADD,blendSrcFactor:s.GfxBlendFactor.SRC_ALPHA,blendDstFactor:s.GfxBlendFactor.ONE_MINUS_SRC_ALPHA}));let n=r.allocateUniformBuffer(T.F3DEX_Program.ub_SceneParams,16);const i=r.mapUniformBufferF32(T.F3DEX_Program.ub_SceneParams);n+=d.fillMatrix4x4(i,n,a.camera.projectionMatrix),r.filterKey=0;const o=Oe.scratchMatrix;u.mat4.copy(o,Ve),o[12]=a.camera.worldMatrix[12],o[13]=a.camera.worldMatrix[13]-5e3,o[14]=a.camera.worldMatrix[14];for(let t=0;t<this.skyRenderers.length;t++)this.skyRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a,o);r.filterKey=1;for(let t=0;t<this.uvtrRenderers.length;t++)this.uvtrRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a);for(let t=0;t<this.dobjRenderers.length;t++)this.dobjRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a,Ve);null!==this.snowRenderer&&this.snowRenderer.prepareToRender(e,this.renderHelper.renderInstManager,a),this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}spawnObject(e){const t=Ie(this.modelBuilder,e);return this.dobjRenderers.push(t),t}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a);const r=this.renderHelper.renderInstManager;this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=this.renderTarget.createRenderPass(e,t.viewport,p.standardFullClearRenderPassDescriptor);h.executeOnPass(r,e,n,0),e.submitPass(n);const s=this.renderTarget.createRenderPass(e,t.viewport,p.depthClearRenderPassDescriptor);return h.executeOnPass(r,e,s,1),h.executeOnPass(r,e,s,2),r.resetRenderInsts(),n}setCurrentTask(e){if(this.currentTaskIndex!==e){this.currentTaskIndex=e;for(let t=0;t<this.dobjRenderers.length;t++)this.dobjRenderers[t].syncTaskVisibility(e)}}createPanels(){const e=new w.Panel;e.customHeaderBackgroundColor=w.COOL_BLUE_COLOR,e.setTitle(w.TIME_OF_DAY_ICON,"Task");const t=["None"];for(let e=0;e<this.taskLabels.length;e++)t.push(j(this.taskLabels[e]));return this.taskSelect=new w.SingleSelect,this.taskSelect.setStrings(t),this.taskSelect.onselectionchange=e=>{const t=this.strIndexToTask[e-1];this.setCurrentTask(t)},this.taskSelect.selectItem(0),e.contents.appendChild(this.taskSelect.elem),[e]}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e),null!==this.snowRenderer&&this.snowRenderer.destroy(e)}}Oe.scratchMatrix=u.mat4.create();const Ne=[1,3,5,10];class Le{constructor(e,t){this.textureData=e,this.palette=t}get(e){return this.palette&&this.palette.has(e)?this.textureData[this.palette.get(e)]:this.textureData[e]}}const Ge="Pilotwings64";class He{constructor(e,t,a){this.levelID=e,this.weatherConditions=t,this.name=a,this.id=`${e}:${t}`}async createScene(e,t){let a=await t.dataShare.ensureObject(`${Ge}/DataHolder`,async()=>await Fe(t.dataFetcher,e));const r=a.uvlv[0].levels[Ne[this.levelID]],n=a.uven[function(e,t){const a=2+5*e+t;if(0===e)return t<3?a:a-1;if(1===e)return t<4?a:a-1;if(2===e)return a;if(3===e)return t<3?a+1:a;throw"Unknown level "+e}(this.levelID,this.weatherConditions)],s=a.uvtp[(i=this.levelID,o=this.weatherConditions,3===i?2===o?4:4===o?3:5:5===o?i:-1)];var i,o;const l={uvmdData:a.uvmdData,palette:new Le(a.textureData,s)},c=new Oe(e,a,l);if(void 0!==n.skyboxModel){const e=Ie(l,n.skyboxModel);c.skyRenderers.push(e)}if(void 0!==n.oceanModel){const e=function(e,t){const a=e.uvmdData[t];return new J(a,e.palette,!0)}(l,n.oceanModel);e.sortKeyBase=h.makeSortKey(0),c.dobjRenderers.push(e)}3===this.levelID&&2===this.weatherConditions&&(c.snowRenderer=new Ue(e,800));for(let e=0;e<r.terras.length;e++){const t=r.terras[e],n=a.uvtr[0].maps[t],s=new Ee(a,l,n);u.mat4.copy(s.modelMatrix,Ve),c.uvtrRenderers.push(s)}const d=function(e,t,a){const r=[],n=[266,267,268,269,270,271];if(0===e)r.push(new be(t.uvmdData[3],t.palette,{angularVelocity:-4,center:u.vec3.fromValues(-600,-600,0),radius:300,roll:-5,bounce:{bouncingPart:1,maxAngle:10,maxHeight:1.5,maxVelocity:7}})),r.push(new be(t.uvmdData[1],t.palette,{angularVelocity:10,center:u.vec3.fromValues(700,-500,0),radius:300,roll:15})),r.push(new be(t.uvmdData[n[0]],t.palette,{angularVelocity:20,center:u.vec3.fromValues(-66,320,125),radius:80,roll:-15})),r.push(new be(t.uvmdData[n[1]],t.palette,{angularVelocity:18,center:u.vec3.fromValues(-66,320,135),radius:70,roll:-15})),r.push(new be(t.uvmdData[n[2]],t.palette,{angularVelocity:18,center:u.vec3.fromValues(-70,320,155),radius:90,roll:-15}));else if(1===e)r.push(new be(t.uvmdData[3],t.palette,{angularVelocity:-4,center:u.vec3.fromValues(400,-300,0),radius:400,roll:-5,bounce:{bouncingPart:1,maxAngle:10,maxHeight:1.5,maxVelocity:7}})),r.push(new be(t.uvmdData[41],t.palette,{angularVelocity:2,center:u.vec3.fromValues(300,-200,0),radius:275,roll:0})),r.push(new be(t.uvmdData[n[0]],t.palette,{angularVelocity:10,center:u.vec3.fromValues(-891.24,602.16,450),radius:220,roll:-15})),r.push(new be(t.uvmdData[n[1]],t.palette,{angularVelocity:18,center:u.vec3.fromValues(1100.06,686.22,250),radius:70,roll:-15})),r.push(new be(t.uvmdData[n[2]],t.palette,{angularVelocity:18,center:u.vec3.fromValues(1050.06,686.22,265),radius:90,roll:-15}));else if(2===e)r.push(new be(t.uvmdData[n[0]],t.palette,{angularVelocity:17,center:u.vec3.fromValues(1666.32,-1099.06,100),radius:30,roll:-15})),r.push(new be(t.uvmdData[n[1]],t.palette,{angularVelocity:13,center:u.vec3.fromValues(3293.09,931.19,150),radius:60,roll:-15})),r.push(new be(t.uvmdData[n[2]],t.palette,{angularVelocity:18,center:u.vec3.fromValues(-2294.23,-791.48,150),radius:30,roll:-15})),r.push(new be(t.uvmdData[n[3]],t.palette,{angularVelocity:18,center:u.vec3.fromValues(-2290.23,-791.48,170),radius:50,roll:-15})),r.push(new we(t.uvmdData[39],t.palette,a.splineData.get(109),{pathLength:120,minHeight:42.4323081970215,rollFactor:150})),r.push(new we(t.uvmdData[27],t.palette,a.splineData.get(110),{pathLength:120,minHeight:33.757682800293,rollFactor:150}));else if(3===e){r.push(new be(t.uvmdData[n[0]],t.palette,{angularVelocity:7,center:u.vec3.fromValues(80.03,-162.16,600),radius:250,roll:-15})),r.push(new be(t.uvmdData[n[1]],t.palette,{angularVelocity:17,center:u.vec3.fromValues(745.26,1107.29,150),radius:70,roll:-15})),r.push(new be(t.uvmdData[n[2]],t.palette,{angularVelocity:17,center:u.vec3.fromValues(800.26,1107.29,170),radius:168,roll:-15}));for(let e=0;e<20;e++)r.push(new xe(t.uvmdData[167],t.palette,a.splineData.get(4),5*e))}return r}(this.levelID,l,a);for(let e=0;e<d.length;e++)c.dobjRenderers.push(d[e]);const m=a.upwl[this.levelID];for(let e=0;e<m.windObjects.length;e++)c.dobjRenderers.push(Be(l,m.windObjects[e]));const p=[];for(let e=0;e<m.landingPads.length;e++){const t=a.uvmdData[m.landingPads[e].modelIndex],r=new Se(t,l.palette);Re(r.modelMatrix,m.landingPads[e].position,1/t.uvmd.inverseScale,m.landingPads[e].angles),c.dobjRenderers.push(r),p.push(r)}const f=a.uvmdData[242],A=new _e(f,l.palette);Re(A.modelMatrix,m.bonusStar,1/f.uvmd.inverseScale),c.dobjRenderers.push(A);const g=a.upwt[this.levelID];g.sort(W);for(let e=0;e<g.length;e++){const t=g[e];if(0!==(_=t).rings.length||0!==_.models.length||_.landingPad){c.taskLabels.push(t.label),c.strIndexToTask.push(e);for(let a=0;a<t.models.length;a++)c.dobjRenderers.push(Be(l,t.models[a],e));for(let r=0;r<t.rings.length;r++){const n=t.rings[r],s=a.uvmdData[n.modelIndex],i=new Te(s,l.palette,n.axis);i.taskNumber=e,Re(i.modelMatrix,n.position,1/s.uvmd.inverseScale,n.angles),c.dobjRenderers.push(i)}if(t.landingPad)for(let a=0;a<m.landingPads.length;a++)if(u.vec3.distance(t.landingPad.position,m.landingPads[a].position)<100){t.landingPad.position=m.landingPads[a].position,t.landingPad.angles=m.landingPads[a].angles;const r=Be(l,t.landingPad,e);c.dobjRenderers.push(r),p[a].alternates.push(r);break}}}var _;return c}}const je=["Holiday Island",new He(0,0,"Holiday Island (Sunny)"),new He(0,1,"Holiday Island (Sunny Part 2)"),new He(0,2,"Holiday Island (Cloudy)"),new He(0,4,"Holiday Island (Evening)"),new He(0,5,"Holiday Island (Starry Night)"),"Crescent Island",new He(1,0,"Crescent Island (Sunny)"),new He(1,1,"Crescent Island (Sunny Part 2)"),new He(1,2,"Crescent Island (Cloudy)"),new He(1,3,"Crescent Island (Cloudy Night)"),new He(1,5,"Crescent Island (Starry Night)"),"Little States",new He(2,0,"Little States (Sunny)"),new He(2,1,"Little States (Sunny Part 2)"),new He(2,2,"Little States (Cloudy)"),new He(2,3,"Little States (Cloudy Night)"),new He(2,4,"Little States (Evening)"),new He(2,5,"Little States (Starry Night)"),"Ever-Frost Island",new He(3,0,"Ever-Frost Island (Sunny)"),new He(3,1,"Ever-Frost Island (Sunny Part 2)"),new He(3,2,"Ever-Frost Island (Snowing)"),new He(3,4,"Ever-Frost Island (Starry Night)")];t.sceneGroup={id:"Pilotwings64",name:"Pilotwings 64",sceneDescs:je}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),s=r(a(15));t.decompress=function(e){const t=e.createDataView();n.assert("MIO0"===n.readString(e,0,4));let a=t.getUint32(4,!1),r=t.getUint32(8,!1),i=t.getUint32(12,!1),o=16;const l=new Uint8Array(a);let c=0;for(;;){const e=t.getUint8(o++);let n=8;for(;n--;){if(e&1<<n)a--,l[c++]=t.getUint8(i++);else{const e=t.getUint16(r,!1);r+=2;let n=3+(e>>12),s=c-(1+(4095&e));for(a-=n;n--;)l[c++]=l[s++]}if(a<=0)return new s.default(l.buffer)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(311),n=a(312),s=a(313),i=a(184),o=a(51),l=a(185),c=a(314),h=a(187);class d{constructor(e){this.dataFetcher=e,this.promiseCache=new Map,this.trilesetDatas=[],this.artObjectDatas=[],this.backgroundPlaneDatas=[],this.skyDatas=[],this.gfxRenderCache=new o.GfxRenderCache,this.fezTypeReaderManager=new c.FezContentTypeReaderManager}waitForLoad(){return Promise.all(this.promiseCache.values())}async fetchXNB(e){const t=await this.dataFetcher.fetchData(`Fez/${e.toLowerCase()}`);return h.parse(this.fezTypeReaderManager,t)}async fetchTrilesetInternal(e,t){const a=await this.fetchXNB(`xnb/trile sets/${t}.xnb`);this.trilesetDatas.push(new n.TrilesetData(e,this.gfxRenderCache,t,a))}async fetchArtObjectInternal(e,t){const a=await this.fetchXNB(`xnb/art objects/${t}.xnb`);this.artObjectDatas.push(new s.ArtObjectData(e,this.gfxRenderCache,t,a))}async fetchBackgroundPlaneInternal(e,t,a){if(a){const a=await this.fetchXNB(`xnb/background planes/${t}.xnb`);this.backgroundPlaneDatas.push(new i.BackgroundPlaneData(e,t,a.texture,a))}else{const a=await this.fetchXNB(`xnb/background planes/${t}.xnb`);this.backgroundPlaneDatas.push(new i.BackgroundPlaneData(e,t,a,null))}}async fetchSkyDataInternal(e,t){this.skyDatas.push(await l.fetchSkyData(this,e,this.gfxRenderCache,t))}fetchTrileset(e,t){const a=`trile sets/${t}`;this.promiseCache.has(a)||this.promiseCache.set(a,this.fetchTrilesetInternal(e,t))}fetchArtObject(e,t){const a=`art objects/${t}`;this.promiseCache.has(a)||this.promiseCache.set(a,this.fetchArtObjectInternal(e,t))}fetchBackgroundPlane(e,t,a){const r=`background planes/${t}`;this.promiseCache.has(r)||this.promiseCache.set(r,this.fetchBackgroundPlaneInternal(e,t,a))}fetchSky(e,t){const a=`skies/${t}`;this.promiseCache.has(a)||this.promiseCache.set(a,this.fetchSkyDataInternal(e,t))}destroy(e){this.gfxRenderCache.destroy(e);for(let t=0;t<this.trilesetDatas.length;t++)this.trilesetDatas[t].destroy(e);for(let t=0;t<this.artObjectDatas.length;t++)this.artObjectDatas[t].destroy(e);for(let t=0;t<this.backgroundPlaneDatas.length;t++)this.backgroundPlaneDatas[t].destroy(e);for(let t=0;t<this.skyDatas.length;t++)this.skyDatas[t].destroy(e)}}t.ModelCache=d;class u{constructor(e,t){this.id=e,this.name=t}async createScene(e,t){const a=await t.dataShare.ensureObject("Fez/ModelCache",async()=>new d(t.dataFetcher)),n=await a.fetchXNB(`xnb/levels/${this.id}.xnb`);a.fetchTrileset(e,n.trileSetName),a.fetchSky(e,n.skyName);for(const t of n.artObjects.values())a.fetchArtObject(e,t.name);for(const t of n.backgroundPlanes.values())a.fetchBackgroundPlane(e,t.textureName,t.animated);return await a.waitForLoad(),new r.FezRenderer(e,a,n)}}const m=[new u("abandoned_a","abandoned_a"),new u("abandoned_b","abandoned_b"),new u("abandoned_c","abandoned_c"),new u("ancient_walls","ancient_walls"),new u("arch","arch"),new u("bell_tower","bell_tower"),new u("big_owl","big_owl"),new u("big_tower","big_tower"),new u("boileroom","boileroom"),new u("cabin_interior_a","cabin_interior_a"),new u("cabin_interior_b","cabin_interior_b"),new u("clock","clock"),new u("cmy","cmy"),new u("cmy_b","cmy_b"),new u("cmy_fork","cmy_fork"),new u("code_machine","code_machine"),new u("crypt","crypt"),new u("drum","drum"),new u("elders","elders"),new u("extractor_a","extractor_a"),new u("five_towers","five_towers"),new u("five_towers_cave","five_towers_cave"),new u("fox","fox"),new u("fractal","fractal"),new u("geezer_house","geezer_house"),new u("geezer_house_2d","geezer_house_2d"),new u("globe","globe"),new u("globe_int","globe_int"),new u("gomez_house","gomez_house"),new u("gomez_house_2d","gomez_house_2d"),new u("gomez_house_end_32","gomez_house_end_32"),new u("gomez_house_end_64","gomez_house_end_64"),new u("grave_cabin","grave_cabin"),new u("grave_ghost","grave_ghost"),new u("grave_lesser_gate","grave_lesser_gate"),new u("grave_treasure_a","grave_treasure_a"),new u("graveyard_a","graveyard_a"),new u("graveyard_gate","graveyard_gate"),new u("hex_rebuild","hex_rebuild"),new u("indust_abandoned_a","indust_abandoned_a"),new u("industrial_city","industrial_city"),new u("industrial_hub","industrial_hub"),new u("industrial_superspin","industrial_superspin"),new u("kitchen","kitchen"),new u("kitchen_2d","kitchen_2d"),new u("lava","lava"),new u("lava_fork","lava_fork"),new u("lava_skull","lava_skull"),new u("library_interior","library_interior"),new u("lighthouse","lighthouse"),new u("lighthouse_house_a","lighthouse_house_a"),new u("lighthouse_spin","lighthouse_spin"),new u("mausoleum","mausoleum"),new u("memory_core","memory_core"),new u("mine_a","mine_a"),new u("mine_bomb_pillar","mine_bomb_pillar"),new u("mine_wrap","mine_wrap"),new u("nature_hub","nature_hub"),new u("nuzu_abandoned_a","nuzu_abandoned_a"),new u("nuzu_abandoned_b","nuzu_abandoned_b"),new u("nuzu_boilerroom","nuzu_boilerroom"),new u("nuzu_dorm","nuzu_dorm"),new u("nuzu_school","nuzu_school"),new u("observatory","observatory"),new u("octoheahedron","octoheahedron"),new u("oldschool","oldschool"),new u("oldschool_ruins","oldschool_ruins"),new u("orrery","orrery"),new u("orrery_b","orrery_b"),new u("owl","owl"),new u("parlor","parlor"),new u("parlor_2d","parlor_2d"),new u("pivot_one","pivot_one"),new u("pivot_two","pivot_two"),new u("pivot_three","pivot_three"),new u("pivot_three_cave","pivot_three_cave"),new u("pivot_watertower","pivot_watertower"),new u("purple_lodge","purple_lodge"),new u("purple_lodge_ruin","purple_lodge_ruin"),new u("pyramid","pyramid"),new u("quantum","quantum"),new u("rails","rails"),new u("ritual","ritual"),new u("school","school"),new u("school_2d","school_2d"),new u("sewer_fork","sewer_fork"),new u("sewer_geyser","sewer_geyser"),new u("sewer_hub","sewer_hub"),new u("sewer_lesser_gate_b","sewer_lesser_gate_b"),new u("sewer_pillars","sewer_pillars"),new u("sewer_pivot","sewer_pivot"),new u("sewer_qr","sewer_qr"),new u("sewer_start","sewer_start"),new u("sewer_to_lava","sewer_to_lava"),new u("sewer_treasure_one","sewer_treasure_one"),new u("sewer_treasure_two","sewer_treasure_two"),new u("showers","showers"),new u("skull","skull"),new u("skull_b","skull_b"),new u("spinning_plates","spinning_plates"),new u("stargate","stargate"),new u("stargate_ruins","stargate_ruins"),new u("superspin_cave","superspin_cave"),new u("telescope","telescope"),new u("temple_of_love","temple_of_love"),new u("throne","throne"),new u("tree","tree"),new u("tree_crumble","tree_crumble"),new u("tree_of_death","tree_of_death"),new u("tree_roots","tree_roots"),new u("tree_sky","tree_sky"),new u("triple_pivot_cave","triple_pivot_cave"),new u("two_walls","two_walls"),new u("villageville_2d","villageville_2d"),new u("villageville_3d","villageville_3d"),new u("villageville_3d_end_32","villageville_3d_end_32"),new u("villageville_3d_end_64","villageville_3d_end_64"),new u("visitor","visitor"),new u("wall_hole","wall_hole"),new u("wall_interior_a","wall_interior_a"),new u("wall_interior_b","wall_interior_b"),new u("wall_interior_hole","wall_interior_hole"),new u("wall_kitchen","wall_kitchen"),new u("wall_school","wall_school"),new u("wall_village","wall_village"),new u("water_pyramid","water_pyramid"),new u("water_tower","water_tower"),new u("water_wheel","water_wheel"),new u("water_wheel_b","water_wheel_b"),new u("waterfall","waterfall"),new u("waterfall_alt","waterfall_alt"),new u("watertower_secret","watertower_secret"),new u("weightswitch_temple","weightswitch_temple"),new u("well_2","well_2"),new u("windmill_cave","windmill_cave"),new u("windmill_int","windmill_int"),new u("zu_4_side","zu_4_side"),new u("zu_bridge","zu_bridge"),new u("zu_city","zu_city"),new u("zu_city_ruins","zu_city_ruins"),new u("zu_code_loop","zu_code_loop"),new u("zu_fork","zu_fork"),new u("zu_heads","zu_heads"),new u("zu_house_empty","zu_house_empty"),new u("zu_house_empty_b","zu_house_empty_b"),new u("zu_house_qr","zu_house_qr"),new u("zu_house_ruin_gate","zu_house_ruin_gate"),new u("zu_house_ruin_visitors","zu_house_ruin_visitors"),new u("zu_house_scaffolding","zu_house_scaffolding"),new u("zu_library","zu_library"),new u("zu_switch","zu_switch"),new u("zu_switch_b","zu_switch_b"),new u("zu_tetris","zu_tetris"),new u("zu_throne_ruins","zu_throne_ruins"),new u("zu_unfold","zu_unfold"),new u("zu_zuish","zu_zuish")];t.sceneGroup={id:"Fez",name:"Fez",sceneDescs:m}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(6),n=a(9),s=a(23),i=a(7),o=a(13),l=a(1),c=a(8),h=a(0),d=a(10),u=a(184),m=a(12),p=a(14),f=a(50),A=a(185);class g{constructor(){this.both="\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n};\n\nlayout(row_major, std140) uniform ub_ShapeParams {\n    Mat4x3 u_BoneMatrix[1];\n    vec4 u_LightDirection;\n    vec4 u_TexScaleBiasPre;\n    vec4 u_TexScaleBiasPost;\n    vec4 u_ShadowTexScaleBias;\n    vec4 u_Misc[1];\n};\n\n#define u_BaseDiffuse (u_Misc[0].x)\n#define u_BaseAmbient (u_Misc[0].y)\n\nuniform sampler2D u_Texture[2];\n",this.vert="\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec3 a_Normal;\nlayout(location = 2) in vec2 a_TexCoord;\n\nout vec3 v_Normal;\nout vec2 v_TexCoord;\nout vec3 v_ShadowTexCoord;\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_BoneMatrix[0]), vec4(a_Position, 1.0)));\n    v_Normal = normalize(Mul(_Mat4x4(u_BoneMatrix[0]), vec4(a_Normal, 0.0)).xyz);\n    v_TexCoord = a_TexCoord.xy * u_TexScaleBiasPre.xy + u_TexScaleBiasPre.zw;\n    v_ShadowTexCoord = gl_Position.xyw;\n}\n",this.frag="\nin vec2 v_TexCoord;\nin vec3 v_ShadowTexCoord;\nin vec3 v_Normal;\n\nvoid main() {\n    vec2 t_DiffuseTexCoord = mod(v_TexCoord, vec2(1.0, 1.0));\n    t_DiffuseTexCoord = t_DiffuseTexCoord.xy * u_TexScaleBiasPost.xy + u_TexScaleBiasPost.zw;\n    vec4 t_DiffuseMapColor = texture(u_Texture[0], t_DiffuseTexCoord.xy);\n\n    float t_LightFalloff = clamp(dot(u_LightDirection.xyz, v_Normal.xyz), 0.0, 1.0);\n    float t_Illum = clamp(t_LightFalloff + u_BaseAmbient, 0.0, 1.0);\n\n    gl_FragColor.rgb = t_Illum * t_DiffuseMapColor.rgb;\n    gl_FragColor.a = t_DiffuseMapColor.a;\n\n    // Add in the shadow texture\n    vec2 t_ShadowTexCoord = ((v_ShadowTexCoord.xy / v_ShadowTexCoord.z) * vec2(0.5)) + vec2(0.5);\n    t_ShadowTexCoord = t_ShadowTexCoord.xy * u_ShadowTexScaleBias.xy + u_ShadowTexScaleBias.zw;\n    vec4 t_ShadowMapColor = texture(u_Texture[1], t_ShadowTexCoord);\n    vec4 t_ShadowMul = 1.0 - (t_ShadowMapColor * 0.25);\n    gl_FragColor.rgb *= t_ShadowMul.rgb;\n}\n"}}g.ub_SceneParams=0,g.ub_ShapeParams=1;const _=[{numUniformBuffers:2,numSamplers:2}],S=l.mat4.create(),b=[180,270,0,90];class v{constructor(){this.shadowTextureMapping=new d.TextureMapping,this.shadowTexScaleBias=l.vec4.create(),this.lightDirection=l.vec4.create(),this.baseDiffuse=1,this.baseAmbient=0}}t.FezRenderer=class{constructor(e,t,a){this.renderTarget=new n.BasicRenderTarget,this.modelMatrix=l.mat4.create(),this.levelRenderData=new v,this.trileRenderers=[],this.artObjectRenderers=[],this.backgroundPlaneRenderers=[],this.lightDirection=l.vec4.fromValues(1,1,1,0),this.renderHelper=new s.GfxRenderHelper(e),this.program=f.preprocessProgramObj_GLSL(e,new g),l.mat4.fromScaling(this.modelMatrix,[50,50,50]);const r=h.assertExists(t.trilesetDatas.find(e=>e.name===a.trileSetName));for(const e of a.triles.values()){const t=e.trileID;if(t<0)continue;const a=e.position,n=e.orientation,s=.01745*b[n],i=r.triles.get(t),o=new y(r,i.geometry);l.mat4.translate(o.modelMatrix,o.modelMatrix,a),l.mat4.rotateY(o.modelMatrix,o.modelMatrix,s),l.mat4.mul(o.modelMatrix,this.modelMatrix,o.modelMatrix),this.trileRenderers.push(o)}this.skyData=h.assertExists(t.skyDatas.find(e=>e.name===a.skyName)),this.skyRenderer=new A.SkyRenderer(this.skyData);for(const e of a.artObjects.values()){const a=h.assertExists(t.artObjectDatas.find(t=>t.name===e.name)),r=l.vec3.clone(e.position);r[0]-=.5,r[1]-=.5,r[2]-=.5;const n=l.mat4.create();l.mat4.fromQuat(n,e.rotation);const s=new y(a,a.geometry);l.mat4.translate(s.modelMatrix,s.modelMatrix,r),l.mat4.mul(s.modelMatrix,s.modelMatrix,n),l.mat4.mul(s.modelMatrix,this.modelMatrix,s.modelMatrix),l.mat4.scale(s.modelMatrix,s.modelMatrix,e.scale),this.artObjectRenderers.push(s)}this.backgroundPlaneStaticData=new u.BackgroundPlaneStaticData(e,t.gfxRenderCache);for(const r of a.backgroundPlanes.values()){const a=h.assertExists(t.backgroundPlaneDatas.find(e=>e.name===r.textureName)),n=new M(e,r,a,this.backgroundPlaneStaticData);l.mat4.mul(n.modelMatrix,this.modelMatrix,n.modelMatrix),this.backgroundPlaneRenderers.push(n)}this.levelRenderData.shadowTextureMapping.copy(this.skyData.shadowsTextureMapping[0]),this.levelRenderData.baseDiffuse=a.baseDiffuse,this.levelRenderData.baseAmbient=a.baseAmbient}adjustCameraController(e){e.setSceneMoveSpeedMult(16/60)}prepareToRender(e,t,a,r){const n=this.renderHelper.pushTemplateRenderInst();n.setBindingLayouts(_);const s=r.gfxRenderCache.createProgramSimple(e,this.program);n.setGfxProgram(s);let c=n.allocateUniformBuffer(g.ub_SceneParams,16);const h=n.mapUniformBufferF32(g.ub_SceneParams);c+=o.fillMatrix4x4(h,c,a.camera.projectionMatrix),this.skyRenderer.prepareToRender(r,a),l.vec4.transformMat4(this.levelRenderData.lightDirection,this.lightDirection,a.camera.viewMatrix);const d=a.camera.viewMatrix,u=-Math.atan2(-d[2],d[0])/6.283*4;l.vec4.set(this.levelRenderData.shadowTexScaleBias,.5,.5,u,0),n.sortKey=i.makeSortKeyOpaque(32,s.ResourceUniqueId);for(let e=0;e<this.trileRenderers.length;e++)this.trileRenderers[e].prepareToRender(this.levelRenderData,r,a);for(let e=0;e<this.artObjectRenderers.length;e++)this.artObjectRenderers[e].prepareToRender(this.levelRenderData,r,a);for(let e=0;e<this.backgroundPlaneRenderers.length;e++)this.backgroundPlaneRenderers[e].prepareToRender(this.levelRenderData,r,a);r.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass(),r=this.renderHelper.renderInstManager;this.prepareToRender(e,a,t,r),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const s=this.renderTarget.createRenderPass(e,t.viewport,n.standardFullClearRenderPassDescriptor);return r.drawOnPassRenderer(e,s),r.resetRenderInsts(),s}destroy(e){for(let t=0;t<this.backgroundPlaneRenderers.length;t++)this.backgroundPlaneRenderers[t].destroy(e);this.backgroundPlaneStaticData.destroy(e),this.renderHelper.destroy(e),this.renderTarget.destroy(e)}};const w=h.nArray(2,()=>new d.TextureMapping),x=l.mat4.create(),T=new m.AABB;class y{constructor(e,t){this.geometryData=t,this.modelMatrix=l.mat4.create(),this.textureMatrix=l.mat4.create(),this.textureMapping=new d.TextureMapping,this.megaStateFlags={},this.textureMapping.gfxTexture=e.texture,this.textureMapping.gfxSampler=e.sampler,this.megaStateFlags.frontFace=r.GfxFrontFaceMode.CW,this.megaStateFlags.cullMode=2}prepareToRender(e,t,a){if(T.transform(this.geometryData.bbox,this.modelMatrix),!a.camera.frustum.contains(T))return;const r=t.pushRenderInst();r.setInputLayoutAndState(this.geometryData.inputLayout,this.geometryData.inputState),w[0].copy(this.textureMapping),w[1].copy(e.shadowTextureMapping),r.setSamplerBindingsFromTextureMappings(w),r.setMegaStateFlags(this.megaStateFlags);let n=r.allocateUniformBuffer(g.ub_ShapeParams,32);const s=r.mapUniformBufferF32(g.ub_ShapeParams);c.computeViewMatrix(S,a.camera),l.mat4.mul(S,S,this.modelMatrix),n+=o.fillMatrix4x3(s,n,S),n+=o.fillVec4v(s,n,e.lightDirection),n+=o.fillVec4(s,n,1,1,0,0),n+=o.fillVec4(s,n,1,1,0,0),n+=o.fillVec4v(s,n,e.shadowTexScaleBias),n+=o.fillVec4(s,n,e.baseDiffuse,e.baseAmbient,0,0),r.drawIndexes(this.geometryData.indexCount)}}t.FezObjectRenderer=y;const C=l.vec3.create();class M{constructor(e,t,a,n){this.planeData=a,this.staticData=n,this.modelMatrix=l.mat4.create(),this.textureMapping=new d.TextureMapping,this.megaStateFlags={},this.rawScale=l.vec2.create(),this.xTextureRepeat=!1,this.yTextureRepeat=!1,this.clampTexture=!1;const s=l.vec3.clone(t.position);s[0]-=.5,s[1]-=.5,s[2]-=.5;const i=l.mat4.create();l.mat4.fromQuat(i,t.rotation),l.vec3.set(C,0,0,1),l.vec3.transformMat4(C,C,i),l.vec3.scaleAndAdd(s,s,C,.005),l.vec2.set(this.rawScale,t.scale[0],t.scale[1]),l.mat4.translate(this.modelMatrix,this.modelMatrix,s);const o=this.planeData.dimensions[0]/16,c=this.planeData.dimensions[1]/16;l.mat4.mul(this.modelMatrix,this.modelMatrix,i),l.mat4.scale(this.modelMatrix,this.modelMatrix,t.scale),l.mat4.scale(this.modelMatrix,this.modelMatrix,[o,c,1]),this.megaStateFlags.frontFace=r.GfxFrontFaceMode.CW,t.doubleSided?this.megaStateFlags.cullMode=0:this.megaStateFlags.cullMode=2,this.xTextureRepeat=t.xTextureRepeat,this.yTextureRepeat=t.yTextureRepeat,this.clampTexture=t.clampTexture,p.setAttachmentStateSimple(this.megaStateFlags,{blendMode:r.GfxBlendMode.ADD,blendSrcFactor:r.GfxBlendFactor.SRC_ALPHA,blendDstFactor:r.GfxBlendFactor.ONE_MINUS_SRC_ALPHA}),this.sampler=e.createSampler({wrapS:this.xTextureRepeat?1:0,wrapT:this.yTextureRepeat?1:0,minFilter:0,magFilter:0,mipFilter:0,minLOD:0,maxLOD:0}),this.textureMapping.gfxTexture=this.planeData.texture,this.textureMapping.gfxSampler=this.sampler,this.phaseInSeconds=Math.random()*this.planeData.duration}prepareToRender(e,t,a){const r=t.pushRenderInst();r.setInputLayoutAndState(this.staticData.inputLayout,this.staticData.inputState),w[0].copy(this.textureMapping),w[1].copy(e.shadowTextureMapping),r.setSamplerBindingsFromTextureMappings(w),r.setMegaStateFlags(this.megaStateFlags);let n=r.allocateUniformBuffer(g.ub_ShapeParams,32);const s=r.mapUniformBufferF32(g.ub_ShapeParams);c.computeViewMatrix(S,a.camera),l.mat4.mul(S,S,this.modelMatrix),n+=o.fillMatrix4x3(s,n,S);const i=a.time/1e3+this.phaseInSeconds;this.planeData.calcTexMatrix(x,i),n+=o.fillVec4v(s,n,e.lightDirection),n+=o.fillVec4(s,n,this.rawScale[0],this.rawScale[1],0,0),n+=o.fillVec4(s,n,x[0],x[5],x[12],x[13]),n+=o.fillVec4v(s,n,e.shadowTexScaleBias),n+=o.fillVec4(s,n,e.baseDiffuse,e.baseAmbient,0,0),r.drawIndexes(this.staticData.indexCount)}destroy(e){e.destroySampler(this.sampler)}}t.BackgroundPlaneRenderer=M},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(122),n=a(186);class s{constructor(e,t,a){this.trile=a,this.geometry=new n.GeometryData(e,t,a.geometry)}destroy(e){this.geometry.destroy(e)}}t.TrileData=s;t.TrilesetData=class{constructor(e,t,a,n){this.name=a,this.triles=new Map,this.texture=r.makeTextureFromXNA_Texture2D(e,n.textureAtlas),this.sampler=t.createSampler(e,{wrapS:0,wrapT:0,minFilter:0,magFilter:0,mipFilter:0,minLOD:0,maxLOD:0});for(const[a,r]of n.triles.entries())this.triles.set(a,new s(e,t,r))}destroy(e){e.destroyTexture(this.texture);for(const t of this.triles.values())t.destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(122),n=a(186);t.ArtObjectData=class{constructor(e,t,a,s){this.name=a,this.texture=r.makeTextureFromXNA_Texture2D(e,s.futureCubeMap),this.sampler=t.createSampler(e,{wrapS:0,wrapT:0,minFilter:0,magFilter:0,mipFilter:0,minLOD:0,maxLOD:0}),this.geometry=new n.GeometryData(e,t,s.geometry)}destroy(e){e.destroyTexture(this.texture),this.geometry.destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(187),n=a(1),s=a(0);function i(e){const t=e.ReadInt32(),a=e.ReadInt32(),r=e.ReadInt32();return n.vec3.fromValues(t,a,r)}const o=[n.vec3.fromValues(-1,0,0),n.vec3.fromValues(0,-1,0),n.vec3.fromValues(0,0,-1),n.vec3.fromValues(1,0,0),n.vec3.fromValues(0,1,0),n.vec3.fromValues(0,0,1)];function l(e){const t=e.ReadVector3(),a=e.ReadByte();return{position:t,normal:o[a],texcoord:e.ReadVector2()}}function c(e){return{name:e.ReadString(),futureCubeMap:s.assertExists(e.ReadObject()),size:e.ReadVector3(),geometry:e.ReadObject(),actorType:e.ReadObject(),noSilhouette:e.ReadBoolean()}}function h(e){const t=e.ReadString(),a=e.ReadString(),r=e.ReadVector3(),n=e.ReadVector3(),s=(e.ReadBoolean(),e.ReadBoolean(),e.ReadBoolean(),e.ReadBoolean(),e.ReadObject(),e.ReadObject());e.ReadObject(),e.ReadObject(),e.ReadObject();return{name:t,cubemapPath:a,size:r,offset:n,geometry:s,atlasOffset:e.ReadVector2()}}function d(e){return{name:e.ReadString(),triles:e.ReadObject(),textureAtlas:e.ReadObject()}}function u(e){const t=e.ReadInt32(),a=e.ReadInt32(),r=e.ReadInt32(),n=e.ReadInt32(),s=e.ReadInt32();return{width:t,height:a,actualWidth:r,actualHeight:n,texture:{format:0,width:t,height:a,levelData:[e.ReadBytes(s)]},frames:e.ReadObject()}}function m(e){return{duration:e.ReadObject(),rectangle:e.ReadObject()}}function p(e){return{name:e.ReadString(),inFront:e.ReadBoolean(),opacity:e.ReadSingle(),fogTint:e.ReadSingle()}}function f(e){return{name:e.ReadString(),background:e.ReadString(),windSpeed:e.ReadSingle(),density:e.ReadSingle(),fogDensity:e.ReadSingle(),layers:e.ReadObject(),clouds:e.ReadObject(),shadows:e.ReadObject(),stars:e.ReadObject(),cloudTint:e.ReadObject(),verticalTiling:e.ReadBoolean(),horizontalScrolling:e.ReadBoolean(),layerBaseHeight:e.ReadSingle(),interLayerVerticalDistance:e.ReadSingle(),horizontalDistance:e.ReadSingle(),verticalDistance:e.ReadSingle(),layerBaseSpacing:e.ReadSingle(),windParallax:e.ReadSingle(),windDistance:e.ReadSingle(),cloudsParallax:e.ReadSingle(),shadowOpacity:e.ReadSingle(),foliageShadows:e.ReadBoolean(),noPerFaceLayerXOffset:e.ReadBoolean(),layerBaseXOffset:e.ReadSingle()}}function A(e){return{trileID:e.ReadObject(),faceOrientation:e.ReadObject()}}function g(e){return{orientations:e.ReadObject(),from:e.ReadVector3(),to:e.ReadVector3(),actorSettings:e.ReadObject()}}function _(e){return{resourceText:e.ReadObject(),grouped:e.ReadBoolean()}}function S(e){return{farawayPlaneOffset:e.ReadVector2(),isPointOfInterest:e.ReadBoolean(),dotDialogue:e.ReadObject(),waterLocked:e.ReadBoolean(),codePattern:e.ReadObject(),isBlackHole:e.ReadBoolean(),needsTrigger:e.ReadBoolean(),isSecretPassage:e.ReadBoolean()}}function b(e){return{name:e.ReadString(),timeout:e.ReadObject(),triggers:e.ReadObject(),conditions:e.ReadObject(),actions:e.ReadObject(),oneTime:e.ReadBoolean(),triggerless:e.ReadBoolean(),ignoreEndTriggers:e.ReadBoolean(),levelWideOneTime:e.ReadBoolean(),disabled:e.ReadBoolean(),isWinCondition:e.ReadBoolean()}}function v(e){return{entity:e.ReadObject(),event:e.ReadString()}}function w(e){return{entity:e.ReadObject(),operator:e.ReadObject(),property:e.ReadString(),value:e.ReadString()}}function x(e){return{entity:e.ReadObject(),operation:e.ReadString(),arguments:e.ReadObject(),killswitch:e.ReadBoolean(),blocking:e.ReadBoolean()}}function T(e){return{entityType:e.ReadString(),identifier:e.ReadObject()}}function y(e){const t=e.ReadVector3(),a=e.ReadInt32(),r=e.ReadByte();let n=null;return e.ReadBoolean()&&(n=e.ReadObject()),{position:t,trileID:a,orientation:r,actorSettings:n,overlappedTriles:e.ReadObject()}}function C(e){return{containedTrile:e.ReadObject(),signText:e.ReadObject(),sequence:e.ReadObject(),sequenceSampleName:e.ReadObject(),sequenceAlternateSampleName:e.ReadObject(),hostVolume:e.ReadObject()}}function M(e){return{name:e.ReadString(),position:e.ReadVector3(),rotation:e.ReadQuaternion(),scale:e.ReadVector3(),actorSettings:e.ReadObject()}}function U(e){return{inactive:e.ReadBoolean(),containedTrile:e.ReadObject(),attachedGroup:e.ReadObject(),spinView:e.ReadObject(),spinEvery:e.ReadSingle(),spinOffset:e.ReadSingle(),offCenter:e.ReadBoolean(),rotationCenter:e.ReadVector3(),vibrationPattern:e.ReadObject(),codePattern:e.ReadObject(),segment:e.ReadObject(),nextNode:e.ReadObject(),destinationLevel:e.ReadObject(),treasureMapName:e.ReadObject(),invisibleSides:e.ReadObject(),timeSwitchWindBackSpeed:e.ReadSingle()}}function k(e){return{position:e.ReadVector3(),rotation:e.ReadQuaternion(),scale:e.ReadVector3(),size:e.ReadVector3(),textureName:e.ReadString(),lightMap:e.ReadBoolean(),allowOverbrightness:e.ReadBoolean(),filter:e.ReadColor(),animated:e.ReadBoolean(),doubleSided:e.ReadBoolean(),opacity:e.ReadSingle(),attachedGroup:e.ReadObject(),billboard:e.ReadBoolean(),syncWithSamples:e.ReadBoolean(),crosshatch:e.ReadBoolean(),unknown:e.ReadBoolean(),alwaysOnTop:e.ReadBoolean(),fullbright:e.ReadBoolean(),pixelatedLightmap:e.ReadBoolean(),xTextureRepeat:e.ReadBoolean(),yTextureRepeat:e.ReadBoolean(),clampTexture:e.ReadBoolean(),actorType:e.ReadObject(),attachedPlane:e.ReadObject(),parallaxFactor:e.ReadSingle()}}function D(e){return{triles:e.ReadObject(),path:e.ReadObject(),heavy:e.ReadBoolean(),actorType:e.ReadObject(),geyserOffset:e.ReadSingle(),geyserPauseFor:e.ReadSingle(),geyserLiftFor:e.ReadSingle(),geyserApexHeight:e.ReadSingle(),spinCenter:e.ReadVector3(),spinClockwise:e.ReadBoolean(),spinFrequency:e.ReadSingle(),spinNeedsTriggering:e.ReadBoolean(),spin180Degrees:e.ReadBoolean(),fallOnRotate:e.ReadBoolean(),spinOffset:e.ReadSingle(),associatedSound:e.ReadObject()}}function I(e){return{segments:e.ReadObject(),needsTrigger:e.ReadBoolean(),endBehavior:e.ReadObject(),soundName:e.ReadObject(),isSpline:e.ReadBoolean(),offsetSeconds:e.ReadSingle(),saveTrigger:e.ReadBoolean()}}function R(e){const t=e.ReadVector3(),a=e.ReadObject(),r=e.ReadObject(),n=e.ReadObject(),s=e.ReadSingle(),i=e.ReadSingle(),o=e.ReadSingle(),l=e.ReadQuaternion();let c=null;return e.ReadBoolean()&&(c=e.ReadObject()),{destination:t,duration:a,waitTimeOnStart:r,waitTimeOnFinish:n,acceleration:s,deceleration:i,jitterFactor:o,orientation:l,customData:c}}function B(e){return{name:e.ReadString(),position:e.ReadVector3(),destinationOffset:e.ReadVector3(),walkSpeed:e.ReadSingle(),randomizeSpeech:e.ReadBoolean(),sayFirstSpeechLineOnce:e.ReadBoolean(),avoidsGomez:e.ReadBoolean(),actorType:e.ReadObject(),speech:e.ReadObject(),actions:e.ReadObject()}}function P(e){return{text:e.ReadObject(),overrideContent:e.ReadObject()}}function E(e){return{animationName:e.ReadObject(),soundName:e.ReadObject()}}function F(e){return{name:e.ReadObject(),dawn:e.ReadBoolean(),day:e.ReadBoolean(),dusk:e.ReadBoolean(),night:e.ReadBoolean()}}function V(e){return{perspective:e.ReadBoolean(),pixelsPerTrixel:e.ReadInt32(),soundName:e.ReadObject()}}function O(e){return{name:e.ReadObject(),size:e.ReadVector3(),startingPosition:e.ReadObject(),sequenceSamplesPath:e.ReadObject(),flat:e.ReadBoolean(),skipPostprocess:e.ReadBoolean(),baseDiffuse:e.ReadSingle(),baseAmbient:e.ReadSingle(),gomezHaloName:e.ReadObject(),haloFiltering:e.ReadBoolean(),blinkingAlpha:e.ReadBoolean(),loops:e.ReadBoolean(),waterType:e.ReadObject(),waterHeight:e.ReadSingle(),skyName:e.ReadString(),trileSetName:e.ReadObject(),volumes:e.ReadObject(),scripts:e.ReadObject(),songName:e.ReadObject(),fapFadeoutStart:e.ReadInt32(),fapFadeoutLength:e.ReadInt32(),triles:e.ReadObject(),artObjects:e.ReadObject(),backgroundPlanes:e.ReadObject(),groups:e.ReadObject(),nonplayerCharacters:e.ReadObject(),paths:e.ReadObject(),descending:e.ReadBoolean(),rainy:e.ReadBoolean(),lowPass:e.ReadBoolean(),mutedLoops:e.ReadObject(),ambienceTracks:e.ReadObject(),nodeType:e.ReadObject(),quantum:e.ReadBoolean()}}function N(e){return e=>({primitiveType:e.ReadObject(),vertices:e.ReadObject(),indices:e.ReadObject()})}class L extends r.ContentTypeReaderManager{constructor(){super(),this.RegisterTypeReaderEnum("FezEngine.FaceOrientation"),this.RegisterTypeReaderEnum("FezEngine.CollisionType"),this.RegisterTypeReaderEnum("FezEngine.Structure.LiquidType"),this.RegisterTypeReaderEnum("FezEngine.Structure.NpcAction"),this.RegisterTypeReaderEnum("FezEngine.Structure.Input.CodeInput"),this.RegisterTypeReaderEnum("FezEngine.Structure.Input.VibrationMotor"),this.RegisterTypeReaderValueType(i,"FezEngine.Structure.TrileEmplacement","FezEngine.Readers.TrileEmplacementReader"),this.RegisterTypeReaderValueType(l,"FezEngine.Structure.Geometry.VertexPositionNormalTextureInstance","FezEngine.Readers.VertexPositionNormalTextureInstanceReader"),this.RegisterTypeReaderDirect(c,"FezEngine.Structure.ArtObject","FezEngine.Readers.ArtObjectReader"),this.RegisterTypeReaderDirect(d,"FezEngine.Structure.TrileSet","FezEngine.Readers.TrileSetReader"),this.RegisterTypeReaderDirect(h,"FezEngine.Structure.Trile","FezEngine.Readers.TrileReader"),this.RegisterTypeReaderDirect(u,"FezEngine.Structure.AnimatedTexture","FezEngine.Readers.AnimatedTextureReader"),this.RegisterTypeReaderDirect(m,"FezEngine.Content.FrameContent","FezEngine.Readers.FrameReader"),this.RegisterTypeReaderDirect(f,"FezEngine.Structure.Sky","FezEngine.Readers.SkyReader"),this.RegisterTypeReaderDirect(p,"FezEngine.Structure.SkyLayer","FezEngine.Readers.SkyLayerReader"),this.RegisterTypeReaderDirect(A,"FezEngine.Structure.TrileFace","FezEngine.Readers.TrileFaceReader"),this.RegisterTypeReaderDirect(g,"FezEngine.Structure.Volume","FezEngine.Readers.VolumeReader"),this.RegisterTypeReaderDirect(S,"FezEngine.Structure.VolumeActorSettings","FezEngine.Readers.VolumeActorSettingsReader"),this.RegisterTypeReaderDirect(_,"FezEngine.Structure.DotDialogueLine","FezEngine.Readers.DotDialogueLineReader"),this.RegisterTypeReaderDirect(b,"FezEngine.Structure.Scripting.Script","FezEngine.Readers.ScriptReader"),this.RegisterTypeReaderDirect(v,"FezEngine.Structure.Scripting.ScriptTrigger","FezEngine.Readers.ScriptTriggerReader"),this.RegisterTypeReaderDirect(w,"FezEngine.Structure.Scripting.ScriptCondition","FezEngine.Readers.ScriptConditionReader"),this.RegisterTypeReaderDirect(x,"FezEngine.Structure.Scripting.ScriptAction","FezEngine.Readers.ScriptActionReader"),this.RegisterTypeReaderDirect(T,"FezEngine.Structure.Scripting.Entity","FezEngine.Readers.EntityReader"),this.RegisterTypeReaderDirect(y,"FezEngine.Structure.TrileInstance","FezEngine.Readers.TrileInstanceReader"),this.RegisterTypeReaderDirect(C,"FezEngine.Structure.InstanceActorSettings","FezEngine.Readers.InstanceActorSettingsReader"),this.RegisterTypeReaderDirect(M,"FezEngine.Structure.ArtObjectInstance","FezEngine.Readers.ArtObjectInstanceReader"),this.RegisterTypeReaderDirect(U,"FezEngine.Structure.ArtObjectActorSettings","FezEngine.Readers.ArtObjectActorSettingsReader"),this.RegisterTypeReaderDirect(k,"FezEngine.Structure.BackgroundPlane","FezEngine.Readers.BackgroundPlaneReader"),this.RegisterTypeReaderDirect(D,"FezEngine.Structure.TrileGroup","FezEngine.Readers.TrileGroupReader"),this.RegisterTypeReaderDirect(I,"FezEngine.Structure.MovementPath","FezEngine.Readers.MovementPathReader"),this.RegisterTypeReaderDirect(R,"FezEngine.Structure.PathSegment","FezEngine.Readers.PathSegmentReader"),this.RegisterTypeReaderDirect(B,"FezEngine.Structure.NpcInstance","FezEngine.Readers.NpcInstanceReader"),this.RegisterTypeReaderDirect(P,"FezEngine.Structure.SpeechLine","FezEngine.Readers.SpeechLineReader"),this.RegisterTypeReaderDirect(E,"FezEngine.Structure.NpcActionContent","FezEngine.Readers.NpcActionContentReader"),this.RegisterTypeReaderDirect(F,"FezEngine.Structure.AmbienceTrack","FezEngine.Readers.AmbienceTrackReader"),this.RegisterTypeReaderDirect(V,"FezEngine.Structure.CameraNodeData","FezEngine.Readers.CameraNodeDataReader"),this.RegisterTypeReaderDirect(O,"FezEngine.Structure.Level","FezEngine.Readers.LevelReader"),this.RegisterTypeReaderGenericFactory(N,"FezEngine.Structure.Geometry.ShaderInstancedIndexedPrimitives","FezEngine.Readers.ShaderInstancedIndexedPrimitivesReader")}}t.FezContentTypeReaderManager=L},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);class n{constructor(e){this.view=e,this.offs=0,this.reset()}reset(){this.nbits=0,this.sink=0}fill(e){for(;this.nbits<e;){const e=this.offs<this.view.byteLength?this.view.getUint16(this.offs+0,!0):255;this.sink=(this.sink|e<<16-this.nbits)>>>0,this.nbits+=16,r.assert(this.nbits<53),this.offs+=2}}peek(e){return this.sink>>>32-e}eat(e){this.sink=this.sink<<e>>>0,this.nbits-=e}read(e){if(e>0){this.fill(e);const t=this.peek(e);return this.eat(e),t}return 0}}class s{constructor(e){this.maxSymbols=e,this.maxnbits=16,this.nbits=0,this.len=new Uint8Array(this.maxSymbols),this.cw=new Uint16Array(1<<this.maxnbits)}}function i(e){e.nbits=0;for(let t=0;t<e.maxSymbols;t++)r.assert(e.len[t]<=e.maxnbits),e.nbits=Math.max(e.nbits,e.len[t]);if(r.assert(e.nbits<=e.maxnbits),0===e.nbits)return;const t=1<<e.nbits;let a=0;const n=e.cw;for(let s=1;s<=e.nbits;s++){const i=t>>>s;for(let t=0;t<e.maxSymbols;t++)s===e.len[t]&&(n.fill(t,a,a+i),a+=i,r.assert(0==(a&i-1)))}}function o(e,t){t.fill(16);const a=t.peek(e.nbits),r=e.cw[a];return t.eat(e.len[r]),r}function l(e,t,a,r,n){const s=t.pretreeHuffTable;for(let e=0;e<20;e++)s.len[e]=n.read(4);i(s);for(let t=a;t<r;){const a=o(s,n);if(17===a){const a=4+n.read(4);e.len.fill(0,t,t+a),t+=a}else if(18===a){const a=20+n.read(5);e.len.fill(0,t,t+a),t+=a}else if(19===a){const a=4+n.read(1),r=o(s,n);let i=e.len[t]-r;i<0&&(i+=17);for(let r=0;r<a;r++)e.len[t++]=i}else{const r=a;let n=e.len[t]-r;n<0&&(n+=17),e.len[t++]=n}}}t.LZXState=class{constructor(e){this.header=!1,this.windowOffs=0,this.blockType=0,this.blockLength=0,this.R0=1,this.R1=1,this.R2=1,this.pretreeHuffTable=new s(20),this.lengthHuffTable=new s(250),this.alignedHuffTable=new s(8);const t=1<<e;if(this.window=new Uint8Array(t),this.window.fill(220),15===e)this.positionSlots=30;else if(16===e)this.positionSlots=32;else if(17===e)this.positionSlots=34;else if(18===e)this.positionSlots=36;else if(19===e)this.positionSlots=38;else if(20===e)this.positionSlots=42;else{if(21!==e)throw"whoops";this.positionSlots=50}this.maintreeHuffTable=new s(256+(this.positionSlots<<3)),this.extraBitsTable=new Uint8Array(this.positionSlots-3),this.positionBaseTable=new Uint32Array(this.positionSlots-3);for(let e=0,t=1,a=4;e<this.extraBitsTable.length;e++)this.extraBitsTable[e]=t,this.positionBaseTable[e]=a,a+=1<<t,1&e&&t<17&&t++}},t.decompressLZX=function(e,t,a,s,c){const h=c.createDataView(),d=new n(h);if(!e.header){const t=d.read(1);r.assert(0===t),e.header=!0}const u=e.window;let m=e.windowOffs,p=e.R0,f=e.R1,A=e.R2;const g=e.window.byteLength,_=g-1;let S=s;for(;S>0;){if(0===e.blockLength){e.blockType=d.read(3);const t=d.read(16),a=d.read(8);if(e.blockLength=t<<8|a,1===e.blockType||2===e.blockType){if(2===e.blockType){for(let t=0;t<8;t++)e.alignedHuffTable.len[t]=d.read(3);i(e.alignedHuffTable)}l(e.maintreeHuffTable,e,0,256,d),l(e.maintreeHuffTable,e,256,e.maintreeHuffTable.maxSymbols,d),i(e.maintreeHuffTable),l(e.lengthHuffTable,e,0,249,d),i(e.lengthHuffTable)}else if(3===e.blockType){const e=d.offs;r.assert(0==(1&e)),p=h.getUint32(e+0,!0),f=h.getUint32(e+4,!0),A=h.getUint32(e+8,!0),d.offs+=12}}let t=Math.min(e.blockLength,S);if(S-=t,e.blockLength-=t,m&=_,m+t>g)throw"whoops";for(;t>0;)if(1===e.blockType||2===e.blockType){const a=o(e.maintreeHuffTable,d);if(a<256)u[m++]=a,t--;else{let r=7&a;7===r&&(r+=o(e.lengthHuffTable,d)),r+=2;const n=a-256>>>3;let s;if(n>3){s=e.positionBaseTable[n-4]-2;const t=e.extraBitsTable[n-4];t>0?2===e.blockType&&t>=3?(s+=d.read(t-3)<<3,s+=o(e.alignedHuffTable,d)):s+=d.read(t):s=1,A=f,f=p,p=s}else if(0===n)s=p;else if(1===n)s=f,f=p,p=s;else if(2===n)s=A,A=p,p=s;else{if(3!==n)throw"whoops";s=1,A=f,f=p,p=s}let i=m-s;for(i<0&&(i+=u.byteLength),t-=r;r--;)u[m++]=u[i++],m&=_,i&=_}}else{if(3!==e.blockType)throw"whoops";for(r.assert(0==(1&d.offs));t--;)u[m++]=h.getUint8(d.offs++),m&=_;d.reset()}}r.assert(m<=u.byteLength),r.assert(m-s>=0);for(let e=0;e<s;e++)t[a++]=u[m-s+e];e.windowOffs=m,e.R0=p,e.R1=f,e.R2=A}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(34),s=a(190),i=a(100),o=a(191),l=a(150),c=a(101);t.BlockFetcher=class{};t.BlockRenderer=class{};t.BlockCollection=class{constructor(e,t){this.mod=e,this.isAncient=t,this.blockRenderers=[]}async create(e,t,a){this.gfxDevice=e;const r=t.dataFetcher;if(this.blockFetcher=await a.makeBlockFetcher(this.mod,r,a),this.isAncient)this.texColl=new s.FakeTextureCollection;else{const e=i.getSubdir(this.mod,a);try{const t=new s.SFATextureCollection(a);await t.create(r,e),this.texColl=t}catch(t){console.warn(`Failed to load textures for subdirectory ${e}. Using fake textures instead. Exception:`),console.error(t),this.texColl=new s.FakeTextureCollection}}}getBlockRenderer(e,t){if(void 0===this.blockRenderers[t]){const a=this.blockFetcher.getBlock(this.mod,t);if(null===a)return null;this.isAncient?this.blockRenderers[t]=new h(e,a,this.texColl):this.blockRenderers[t]=new l.Model(e,a,this.texColl)}return this.blockRenderers[t]}getBlock(e,t){return this.getBlockRenderer(this.gfxDevice,t)}};class h{constructor(e,t,a){this.models=[],this.yTranslate=0;let s=0;const i=t.createDataView(),h=88,d=92,u=96,m=100,p=104,f=108,A=112,g=124,_=160,S=154,b=60,v=153,w=6,x=134,T=!1,y=i.getUint32(h),C=i.getUint8(_),M=[];for(let e=0;e<C;e++){const t=i.getUint32(y+4*e);M.push(t)}const U=i.getUint32(d),k=t.subarray(U),D=i.getUint32(u),I=t.subarray(D),R=i.getUint32(m),B=t.subarray(R),P=i.getUint32(p),E=i.getUint8(S),F=[];s=P;for(let e=0;e<E;e++){const e={numLayers:0,hasTexCoord:r.nArray(8,()=>!1),tex0Num:-1,tex1Num:-1,enableCull:!1,flags:0};e.numLayers=1;for(let t=0;t<e.numLayers;t++)e.hasTexCoord[t]=!0;e.tex0Num=i.getUint32(s+36),e.tex1Num=i.getUint32(s+36+8),e.flags=i.getUint32(s+60),e.enableCull=!0,F.push(e),s+=b}const V=[],O=r.nArray(8,()=>[]);for(let e=0;e<=20;e++){V[e]={type:0};for(let t=0;t<8;t++)O[t][e]={compType:0,compShift:0,compCnt:0}}V[9].type=1,V[11].type=1,V[13].type=1,O[0][9]={compType:3,compShift:0,compCnt:1},O[0][11]={compType:5,compShift:0,compCnt:1},O[0][13]={compType:3,compShift:7,compCnt:1},O[1][9]={compType:3,compShift:2,compCnt:1},O[1][11]={compType:5,compShift:0,compCnt:1},O[1][13]={compType:4,compShift:0,compCnt:1},O[2][9]={compType:4,compShift:0,compCnt:1},O[2][11]={compType:5,compShift:0,compCnt:1},O[2][13]={compType:4,compShift:0,compCnt:1},O[2][14]={compType:4,compShift:0,compCnt:1},O[3][9]={compType:3,compShift:8,compCnt:1},O[3][25]={compType:1,compShift:0,compCnt:1},O[3][11]={compType:3,compShift:0,compCnt:1},O[3][13]={compType:3,compShift:10,compCnt:1},O[3][14]={compType:3,compShift:10,compCnt:1},O[3][15]={compType:3,compShift:10,compCnt:1},O[3][16]={compType:3,compShift:10,compCnt:1},O[4][9]={compType:4,compShift:0,compCnt:1},O[4][11]={compType:5,compShift:0,compCnt:1},O[4][13]={compType:3,compShift:7,compCnt:1},O[5][9]={compType:3,compShift:0,compCnt:1},O[5][11]={compType:3,compShift:0,compCnt:1},O[5][13]={compType:3,compShift:8,compCnt:1},O[5][14]={compType:3,compShift:8,compCnt:1},O[5][15]={compType:3,compShift:8,compCnt:1},O[5][16]={compType:3,compShift:8,compCnt:1},O[6][9]={compType:3,compShift:8,compCnt:1},O[6][11]={compType:3,compShift:0,compCnt:1},O[6][13]={compType:3,compShift:10,compCnt:1},O[6][14]={compType:3,compShift:10,compCnt:1},O[6][15]={compType:3,compShift:10,compCnt:1},O[6][16]={compType:3,compShift:10,compCnt:1},O[7][9]={compType:3,compShift:0,compCnt:1},O[7][11]={compType:3,compShift:0,compCnt:1},O[7][13]={compType:3,compShift:10,compCnt:1},O[7][14]={compType:3,compShift:10,compCnt:1},O[7][15]={compType:3,compShift:10,compCnt:1},O[7][16]={compType:3,compShift:10,compCnt:1};const N=i.getUint32(f),L=i.getUint32(A),G=i.getUint8(v),H=i.getUint32(g);i.getUint16(x);this.yTranslate=T?i.getInt16(142):0;const j=new c.LowBitReader(i,H);let W=!1,Z=0;for(;!W;){const r=j.get(4);switch(r){case 1:Z=j.get(6);break;case 2:const c=j.get(w);if(c>=G){console.warn(`Can't draw display list #${c} (out of range)`);continue}s=N+4*c;const h=i.getUint32(s);s=L+2*c;const d=i.getUint16(s),u=t.subarray(h,d),m=[];m[9]={buffer:k,offs:0,stride:6},m[11]={buffer:I,offs:0,stride:2};for(let e=0;e<8;e++)m[13+e]={buffer:B,offs:0,stride:4};try{const t=F[Z],r=new l.ModelInstance(m,V,O,u),s=new n.GXMaterialBuilder("Basic");s.setBlendMode(1,1,0),s.setZMode(!0,1,!0),s.setChanCtrl(4,!1,0,1,0,0,2),s.setCullMode(t.enableCull?2:0);let i=0,c=0,h=0,d=4;for(let e=0;e<t.numLayers;e++)s.setTexCoordGen(c,1,d,60),s.setTevDirect(i),s.setTevOrder(i,255,255,0),s.setTevColorIn(i,15,12,10,15),s.setTevAlphaIn(i,7,7,7,7),s.setTevColorOp(i,0,0,0,!0,0),s.setTevAlphaOp(i,0,0,0,!0,0),s.setTevDirect(i+1),s.setTevOrder(i+1,255,255,0),s.setTevColorIn(i+1,0,10,11,15),s.setTevAlphaIn(i+1,7,7,7,7),s.setTevColorOp(i+1,0,0,0,!0,0),s.setTevAlphaOp(i+1,0,0,0,!0,0),s.setTevDirect(i+2),s.setTevOrder(i+2,c,h,7),s.setTevColorIn(i+2,15,0,8,15),s.setTevAlphaIn(i+2,7,7,7,4),s.setTevColorOp(i+2,0,0,0,!0,0),s.setTevAlphaOp(i+2,0,0,0,!0,0),i+=3,c++,h++,d++;const p={material:s.finish(),textures:[o.makeMaterialTexture(a.getTexture(e,M[t.tex0Num],!0))],setupMaterialParams:()=>{}};r.setMaterial(p),this.models.push(r)}catch(e){console.error(e)}break;case 3:const p=j.get(1),f=j.get(1),A=j.get(1);if(V[9].type=p?3:2,V[10].type=0,V[11].type=f?3:2,F[Z].hasTexCoord[0])for(let e=0;e<8;e++)F[Z].hasTexCoord[e]?V[13+e].type=A?3:2:V[13+e].type=0;break;case 4:const g=j.get(4);for(let e=0;e<g;e++)j.get(8);break;case 5:W=!0;break;default:console.warn(`Skipping unknown model bits opcode ${r}`)}}}getNumDrawSteps(){return 1}prepareToRender(e,t,a,r,n,s){if(0==s)for(let s=0;s<this.models.length;s++)this.models[s].prepareToRender(e,t,a,r,n)}}t.AncientBlockRenderer=h},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(106),s=a(5),i=a(5),o=a(37),l=a(2),c=a(149),h=a(100),d=a(318),u=a(319),m=a(190),p=a(189),f=a(34),A=a(188),g=a(101),_=a(150),S=new i.MaterialParams,b=new i.PacketParams;function v(e,t,a,n,i,o=!1,l=S,c=b){a.setOnRenderInst(e,t.gfxRenderCache,n),n.setSamplerBindingsFromTextureMappings(l.m_TextureMapping);const h=a.allocateMaterialParams(n);a.fillMaterialParamsDataOnInst(n,h,l),n.allocateUniformBuffer(s.ub_PacketParams,s.u_PacketParamsBufferSize),o?r.mat4.identity(c.u_PosMtx[0]):r.mat4.copy(c.u_PosMtx[0],i.camera.viewMatrix),s.fillPacketParamsData(n.mapUniformBufferF32(s.ub_PacketParams),n.getUniformBufferOffset(s.ub_PacketParams),c),t.submitRenderInst(n)}async function w(e,t,a,r,n){const s=a.pathBase,i=new m.SFATextureCollection(a),[o,l,c]=await Promise.all([t.fetchData(`${s}/${r}/MODELS.tab`),t.fetchData(`${s}/${r}/MODELS.bin`),i.create(t,r)]),d=o.createDataView().getUint32(4*n);if(0===d)throw Error(`Model #${n} not found`);const u=16777215&d,p=h.loadRes(l.subarray(u+36));return new _.Model(e,p,i)}class x extends p.SFARenderer{constructor(e,t,a,s,o){super(e),this.envfxMan=t,this.mapInstance=a,this.objectSpheres=s,this.models=o,this.ddraw=new n.TDDraw,this.objddraw=new n.TDDraw,b.clear();const l=this.envfxMan.atmosphere;for(let e=0;e<8;e++){const t=l.textures[e];S.m_TextureMapping[e].gfxTexture=t.gfxTexture,S.m_TextureMapping[e].gfxSampler=t.gfxSampler,S.m_TextureMapping[e].width=t.width,S.m_TextureMapping[e].height=t.height,S.m_TextureMapping[e].lodBias=0,r.mat4.identity(S.u_TexMtx[e])}this.ddraw.setVtxDesc(9,!0),this.ddraw.setVtxDesc(13,!0),this.ddraw.setVtxAttrFmt(0,9,1),this.ddraw.setVtxAttrFmt(0,13,1);let c=new f.GXMaterialBuilder;c.setTexCoordGen(0,1,4,60),c.setTevDirect(0),c.setTevOrder(0,0,0,7),c.setTevColorIn(0,15,15,15,8),c.setTevColorOp(0,0,0,0,!0,0),c.setTevAlphaIn(0,7,7,7,4),c.setTevAlphaOp(0,0,0,0,!0,0),c.setBlendMode(0,1,0),c.setZMode(!1,7,!1),c.setCullMode(0),c.setUsePnMtxIdx(!1),this.materialHelperSky=new i.GXMaterialHelperGfx(c.finish("sky")),this.objddraw.setVtxDesc(9,!0),this.objddraw.setVtxDesc(13,!0),this.objddraw.setVtxAttrFmt(0,9,1),this.objddraw.setVtxAttrFmt(0,13,1),c=new f.GXMaterialBuilder,c.setTexCoordGen(0,1,4,60),c.setTevDirect(0),c.setTevOrder(0,0,0,7),c.setTevColorIn(0,15,15,15,8),c.setTevColorOp(0,0,0,0,!0,0),c.setTevAlphaIn(0,7,7,7,4),c.setTevAlphaOp(0,0,0,0,!0,0),c.setBlendMode(0,1,0),c.setZMode(!0,3,!0),c.setCullMode(0),c.setUsePnMtxIdx(!1),this.materialHelperObjectSphere=new i.GXMaterialHelperGfx(c.finish("objectsphere"))}renderSky(e,t,a){const n=this.renderHelper.pushTemplateRenderInst(),s=r.mat4.create();r.mat4.copy(s,a.camera.projectionMatrix),r.mat4.identity(a.camera.projectionMatrix),i.fillSceneParamsDataOnTemplate(n,a,!1);const o=this.envfxMan.atmosphere.textures[0],c=r.vec3.create();l.getMatrixAxisZ(c,a.camera.worldMatrix),r.vec3.negate(c,c);const h=(d=c,Math.atan2(d[1],Math.hypot(d[2],d[0])));var d;const u=Math.PI/2,m=.5*o.height*a.camera.fovY/Math.PI*3*Math.sin(-u),p=(.5*o.height-6-3*o.height*h/Math.PI+m)/o.height,f=p-2*m/o.height;this.ddraw.beginDraw(),this.ddraw.begin(128),this.ddraw.position3f32(-1,-1,-1),this.ddraw.texCoord2f32(13,1,f),this.ddraw.position3f32(-1,1,-1),this.ddraw.texCoord2f32(13,1,p),this.ddraw.position3f32(1,1,-1),this.ddraw.texCoord2f32(13,1,p),this.ddraw.position3f32(1,-1,-1),this.ddraw.texCoord2f32(13,1,f),this.ddraw.end();const A=this.ddraw.makeRenderInst(e,t);v(e,t,this.materialHelperSky,A,a,!0),this.ddraw.endAndUpload(e,t),t.popTemplateRenderInst(),r.mat4.copy(a.camera.projectionMatrix,s);let g=e.createHostAccessPass();this.prepareToRender(e,g,a),e.submitPass(g),t.drawOnPassRenderer(e,this.renderPass),t.resetRenderInsts(),e.submitPass(this.renderPass)}renderTestModel(e,t,a,r,n){let s=t.pushTemplateRenderInst();i.fillSceneParamsDataOnTemplate(s,a,!1),n.prepareToRender(e,t,a,r,this.sceneTexture,0),t.popTemplateRenderInst()}renderWorld(e,t,a){const n=this.renderHelper.pushTemplateRenderInst();i.fillSceneParamsDataOnTemplate(n,a,!1),this.mapInstance.prepareToRender(e,t,a,this.sceneTexture,0),this.copyToSceneTexture(e);o.getDebugOverlayCanvas2D();let s=t.pushTemplateRenderInst();i.fillSceneParamsDataOnTemplate(s,a,!1),this.objddraw.beginDraw();for(let e=0;e<this.objectSpheres.length;e++){this.objectSpheres[e].radius=8}const l=this.objddraw.makeRenderInst(e,t);v(e,t,this.materialHelperObjectSphere,l,a),this.objddraw.endAndUpload(e,t),t.popTemplateRenderInst();const c=r.mat4.create();for(let n=0;n<this.objectSpheres.length;n++){const s=this.objectSpheres[n];s.model&&(r.mat4.fromTranslation(c,s.pos),r.mat4.scale(c,c,[s.obj.scale,s.obj.scale,s.obj.scale]),r.mat4.rotateY(c,c,s.obj.yaw),r.mat4.rotateX(c,c,s.obj.pitch),r.mat4.rotateZ(c,c,s.obj.roll),this.renderTestModel(e,t,a,c,s.model))}for(let n=0;n<this.models.length;n++)r.mat4.fromTranslation(c,[30*n,0,0]),this.renderTestModel(e,t,a,c,this.models[n]);t.popTemplateRenderInst();let h=e.createHostAccessPass();this.prepareToRender(e,h,a),e.submitPass(h),t.drawOnPassRenderer(e,this.renderPass),t.resetRenderInsts(),e.submitPass(this.renderPass)}}t.SFAWorldSceneDesc=class{constructor(e,t,a,r,n=c.SFA_GAME_INFO){this.id=e,this.subdir=t,this.mapNum=a,this.name=r,this.gameInfo=n}async createScene(e,t){console.log(`Creating scene for world ${this.name} (ID ${this.id}) ...`);const a=await A.loadMap(e,t,this.mapNum,this.gameInfo),n=new A.MapInstance(a);await n.reloadBlocks();const s=r.mat4.create();r.mat4.fromTranslation(s,r.vec3.fromValues(0,0,-640)),n.setMatrix(s);const i=this.gameInfo.pathBase,o=t.dataFetcher,l=new m.SFATextureCollection(this.gameInfo);await l.create(o,this.subdir);const p=new d.ObjectManager(this.gameInfo,l,!1),f=new d.ObjectManager(c.SFADEMO_GAME_INFO,l,!0),_=new u.EnvfxManager(this.gameInfo,l),[S,b,v,T]=await Promise.all([p.create(o,this.subdir),f.create(o,this.subdir),_.create(o),o.fetchData(`${i}/${this.id}.romlist.zlb`)]),y=h.loadRes(T).createDataView(),C=[];let M=0,U=0;for(;M<y.byteLength;){const t={objType:y.getUint16(M+0),entrySize:y.getUint8(M+2),radius:8*y.getUint8(M+6),x:y.getFloat32(M+8),y:y.getFloat32(M+12),z:y.getFloat32(M+16)},a=g.dataSubarray(y,M,4*t.entrySize),n=await p.loadObject(e,t.objType);if(201===n.objClass)n.yaw=(a.getInt8(42)<<8)*Math.PI/32768;else if(222===n.objClass||233===n.objClass||234===n.objClass||235===n.objClass||283===n.objClass||313===n.objClass||424===n.objClass||666===n.objClass);else if(237===n.objClass)n.yaw=(a.getInt8(27)<<8)*Math.PI/32768,n.pitch=(a.getInt8(34)<<8)*Math.PI/32768,n.roll=(a.getInt8(35)<<8)*Math.PI/32768;else if(249===n.objClass){n.yaw=(a.getInt8(31)<<8)*Math.PI/32768,n.pitch=(a.getInt8(28)<<8)*Math.PI/32768;const e=a.getUint8(29);0!==e&&(n.scale*=e/64)}else if(254===n.objClass)n.yaw=(a.getInt8(29)<<8)*Math.PI/32768;else if(256===n.objClass)n.yaw=(a.getInt8(26)<<8)*Math.PI/32768;else if(240===n.objClass||260===n.objClass||261===n.objClass)n.yaw=(a.getInt8(24)<<8)*Math.PI/32768;else if(272===n.objClass){n.yaw=(a.getInt8(31)<<8)*Math.PI/32768;const e=a.getUint8(33)/64;0===e?n.scale=1:n.scale*=e}else if(275===n.objClass)n.yaw=(a.getInt8(28)<<8)*Math.PI/32768;else if(284===n.objClass||289===n.objClass)n.yaw=(a.getInt8(24)<<8)*Math.PI/32768;else if(288===n.objClass)n.yaw=(a.getInt8(25)<<8)*Math.PI/32768;else if(293===n.objClass)n.yaw=(a.getInt8(44)<<8)*Math.PI/32768,n.pitch=(a.getInt8(45)<<8)*Math.PI/32768;else if(294===n.objClass&&77===n.objType)n.yaw=(a.getInt8(61)<<8)*Math.PI/32768,n.pitch=(a.getInt8(62)<<8)*Math.PI/32768;else if(306===n.objClass)n.roll=(a.getInt8(26)<<8)*Math.PI/32768,n.pitch=(a.getInt8(27)<<8)*Math.PI/32768,n.yaw=(a.getInt8(28)<<8)*Math.PI/32768;else if(346===n.objClass){n.yaw=a.getInt16(26)*Math.PI/32768,n.pitch=a.getInt16(28)*Math.PI/32768,n.roll=a.getInt16(30)*Math.PI/32768;let e=a.getInt8(45);0===e&&(e=20),n.scale*=e/20}else if(429===n.objClass)n.yaw=(a.getInt8(25)<<8)*Math.PI/32768,n.scale*=a.getUint16(28)/1e3;else if(518===n.objClass){n.yaw=g.interpS16((63&a.getUint8(24))<<10)*Math.PI/32768;const e=a.getInt16(26);n.scale=e<1?.1:e/8192}else if(579===n.objClass)n.yaw=(a.getInt8(24)<<8)*Math.PI/32768;else if(683===n.objClass)n.yaw=(a.getInt8(24)<<8)*Math.PI/32768,n.pitch=(a.getInt8(25)<<8)*Math.PI/32768,n.roll=(a.getInt8(52)<<8)*Math.PI/32768;else if(689===n.objClass)n.roll=(a.getInt8(24)<<8)*Math.PI/32768,n.pitch=(a.getInt8(25)<<8)*Math.PI/32768,n.yaw=(a.getInt8(26)<<8)*Math.PI/32768;else if(302===n.objClass||685===n.objClass||687===n.objClass||688===n.objClass){n.roll=(a.getInt8(24)<<8)*Math.PI/32768,n.pitch=(a.getInt8(25)<<8)*Math.PI/32768,n.yaw=(a.getInt8(26)<<8)*Math.PI/32768;const e=a.getUint8(27);0!==e&&(n.scale*=e/255)}else console.log(`Don't know how to setup object class ${n.objClass} objType ${n.objType}`);C.push({name:n.name,obj:n,pos:r.vec3.fromValues(t.x,t.y,t.z),radius:t.radius,model:n.models[0]}),console.log(`Object #${U}: ${n.name} (type ${n.objType} class ${n.objClass})`),M+=4*t.entrySize,U++}window.main.lookupObject=(t,a=!1)=>async function(){const r=await p.loadObject(e,t,a);console.log(`Object ${t}: ${r.name} (type ${r.objType} class ${r.objClass})`)},window.main.lookupEarlyObject=(t,a=!1)=>async function(){const r=await f.loadObject(e,t,a);console.log(`Object ${t}: ${r.name} (type ${r.objType} class ${r.objClass})`)};const k=_.loadEnvfx(e,60);console.log(`Envfx ${k.index}: ${JSON.stringify(k,null,"\t")}`);const D=[];return D.push(await w(e,o,this.gameInfo,this.subdir,1)),D.push(await w(e,o,this.gameInfo,this.subdir,23)),new x(e,_,n,C,D)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(150),n=a(101);class s{constructor(e,t,a){this.objType=e,this.data=t,this.isEarlyObject=a,this.yaw=0,this.pitch=0,this.roll=0,this.scale=1,this.models=[],this.scale=t.getFloat32(4),this.objClass=t.getInt16(80),this.name="";let r,n=a?88:145;for(;0!=(r=t.getUint8(n));)this.name+=String.fromCharCode(r),n++}async create(e,t){const a=this.data,r=a.getUint8(85),n=a.getUint32(8);for(let s=0;s<r;s++){const r=a.getUint32(n+4*s);try{const a=t.loadModel(e,r);this.models.push(a)}catch(e){console.warn(`Failed to load model ${r} due to exception:`),console.error(e)}}}}t.SFAObject=s;t.ObjectManager=class{constructor(e,t,a){this.gameInfo=e,this.texColl=t,this.useEarlyObjects=a}async create(e,t){const a=this.gameInfo.pathBase;this.modelColl=new r.ModelCollection(this.texColl,this.gameInfo);const[n,s,i,o]=await Promise.all([e.fetchData(`${a}/OBJECTS.tab`),e.fetchData(`${a}/OBJECTS.bin`),this.useEarlyObjects?null:e.fetchData(`${a}/OBJINDEX.bin`),this.modelColl.create(e,t)]);this.objectsTab=n.createDataView(),this.objectsBin=s.createDataView(),this.objindexBin=this.useEarlyObjects?null:i.createDataView()}async loadObject(e,t,a=!1){this.useEarlyObjects||a||(t=this.objindexBin.getUint16(2*t));const r=this.objectsTab.getUint32(4*t),i=new s(t,n.dataSubarray(this.objectsBin,r),this.useEarlyObjects);return await i.create(e,this.modelColl),i}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.textures=[]}}t.EnvfxManager=class{constructor(e,t){this.gameInfo=e,this.texColl=t,this.atmosphere=new r,this.ENVFX_SIZE=96}async create(e){const t=this.gameInfo.pathBase;this.envfxactBin=(await e.fetchData(`${t}/ENVFXACT.bin`)).createDataView()}loadEnvfx(e,t){const a=function(e,t,a){return new DataView(e.buffer,e.byteOffset+t,a)}(this.envfxactBin,t*this.ENVFX_SIZE,this.ENVFX_SIZE),r={index:t,type:a.getUint8(92),texIds:[0]};r.texIds=[];for(let e=0;e<4;e++)r.texIds.push(a.getUint16(46+2*e));for(let e=0;e<4;e++)r.texIds.push(a.getUint16(62+2*e));if(5==r.type){const t=3128;this.atmosphere.textures=[];for(let a=0;a<8;a++){const n=t+r.texIds[a];console.log(`loading sky texture ${a}: 0x${n.toString(16)}`),this.atmosphere.textures[a]=this.texColl.getTexture(e,t+r.texIds[a],!1)}}return r}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(27)),s=r(a(64)),i=r(a(321)),o=r(a(192)),l=a(322),c=a(0),h=a(1),d=a(2);class u{constructor(){this.textureHolder=new l.BRTITextureHolder,this.mounts=new Map,this.bfresCache=new Map,this.fmdlDataCache=new Map,this.arcPromiseCache=new Map}loadResource(e,t,a){c.assert(!this.mounts.has(t)),this.mounts.set(t,a);for(let r=0;r<a.files.length;r++){if(!a.files[r].name.endsWith(".bfres"))continue;c.assert(!this.bfresCache.has(t));const n=o.parse(a.files[r].buffer);this.bfresCache.set(t,n),this.textureHolder.addFRESTextures(e,n)}}async fetchDataInternal(e,t,a){const r=await t.fetchData(`smo/${a}.szs`,1);if(0===r.byteLength)return null;const s=await n.decompress(r),o=i.parse(s);return this.loadResource(e,a,o),o}fetchData(e,t,a){return this.arcPromiseCache.has(a)||this.arcPromiseCache.set(a,this.fetchDataInternal(e,t,a)),this.arcPromiseCache.get(a)}waitForLoad(){return Promise.all(this.arcPromiseCache.values())}findFRES(e){return this.bfresCache.has(e)||(console.log(`No FRES for ${e}`),this.bfresCache.set(e,null)),this.bfresCache.get(e)}getFMDLData(e,t){if(!this.fmdlDataCache.has(t)){const a=this.findFRES(t);let r=null;if(null!==a){if(!(a.fmdl.length>0))return null;c.assert(1===a.fmdl.length),r=new l.FMDLData(e,a.fmdl[0])}this.fmdlDataCache.set(t,r)}return this.fmdlDataCache.get(t)}findBuffer(e,t){return c.assertExists(this.mounts.get(e)).files.find(e=>e.name===t).buffer}destroy(e){this.textureHolder.destroy(e),this.fmdlDataCache.forEach(t=>{null!==t&&t.destroy(e)})}}function m(e,t,a,r){d.computeModelMatrixSRT(e,r.X,r.Y,r.Z,.01745*a.X,.01745*a.Y,.01745*a.Z,t.X,t.Y,t.Z)}class p extends l.BasicFRESRenderer{constructor(e,t){super(e,t.textureHolder),this.resourceSystem=t}destroy(e){super.destroy(e),this.resourceSystem.destroy(e)}}t.OdysseyRenderer=p;class f{constructor(e,t=e){this.id=e,this.name=t}async createScene(e,t){const a=new u,r=t.dataFetcher,n=c.assertExists(await a.fetchData(e,r,"SystemData/WorldList")),i=s.parse(n.files.find(e=>"WorldListFromDb.byml"===e.name).buffer);const o=c.assertExists(function(e,t){for(let a=0;a<e.length;a++)for(let r=0;r<e[a].StageList.length;r++)if(e[a].StageList[r].name===t)return e[a];return null}(i,this.id)),d=new p(e,a),f=d.renderHelper.getCache();a.fetchData(e,r,`ObjectData/${o.Name}Texture`);const A=async(t,n)=>{const i=c.assertExists(await a.fetchData(e,r,`StageData/${t}Map`)),u=s.parse(c.assertExists(i.files.find(e=>e.name===`${t}Map.byml`)).buffer),p=o.AfterEndingScenario,g=u[p>0?p-1:0];if(void 0!==g.ObjectList)for(let t=0;t<g.ObjectList.length;t++)a.fetchData(e,r,`ObjectData/${g.ObjectList[t].UnitConfigName}`);if(void 0!==g.ZoneList)for(let t=0;t<g.ZoneList.length;t++)a.fetchData(e,r,`StageData/${g.ZoneList[t].UnitConfigName}Map`);if(await a.waitForLoad(),void 0!==g.ObjectList)for(let t=0;t<g.ObjectList.length;t++){const r=g.ObjectList[t],s=a.getFMDLData(e,`ObjectData/${r.UnitConfigName}`);if(null===s)continue;const i=new l.FMDLRenderer(e,f,a.textureHolder,s);m(i.modelMatrix,r.Translate,r.Rotate,r.Scale),h.mat4.mul(i.modelMatrix,n,i.modelMatrix),d.fmdlRenderers.push(i)}if(void 0!==g.ZoneList)for(let e=0;e<g.ZoneList.length;e++){const t=g.ZoneList[e],a=h.mat4.create();m(a,t.Translate,t.Rotate,t.Scale),h.mat4.mul(a,n,a),A(`${t.UnitConfigName}`,a)}};return await A(this.id,h.mat4.create()),await a.waitForLoad(),d}}const A=["Cap",new f("CapWorldHomeStage"),new f("CapWorldTowerStage"),new f("RollingExStage"),new f("PoisonWaveExStage"),new f("PushBlockExStage"),new f("FrogSearchExStage"),"Waterfall",new f("WaterfallWorldHomeStage"),new f("CapAppearExStage"),new f("WanwanClashExStage"),new f("Lift2DExStage"),new f("WindBlowExStage"),new f("TrexPoppunExStage"),"Sand",new f("SandWorldHomeStage"),new f("SandWorldMeganeExStage"),new f("SandWorldSphinxExStage"),new f("SandWorldUnderground000Stage"),new f("SandWorldKillerExStage"),new f("SandWorldShopStage"),new f("SandWorldPressExStage"),new f("SandWorldPyramid000Stage"),new f("SandWorldPyramid001Stage"),new f("SandWorldCostumeStage"),new f("SandWorldUnderground001Stage"),new f("SandWorldRotateExStage"),new f("SandWorldSlotStage"),new f("SandWorldSecretStage"),new f("MeganeLiftExStage"),new f("RocketFlowerExStage"),new f("WaterTubeExStage"),new f("SandWorldVibrationStage"),"Forest",new f("ForestWorldHomeStage"),new f("ForestWorldTowerStage"),new f("ForestWorldWaterExStage"),new f("ForestWorldCloudBonusExStage"),new f("ShootingElevatorExStage"),new f("FogMountainExStage"),new f("ForestWorldBossStage"),new f("RailCollisionExStage"),new f("AnimalChaseExStage"),new f("ForestWorldWoodsStage"),new f("ForestWorldWoodsTreasureStage"),new f("PackunPoisonExStage"),new f("ForestWorldBonusStage"),new f("ForestWorldWoodsCostumeStage"),new f("KillerRoadExStage"),"Lake",new f("LakeWorldHomeStage"),new f("LakeWorldShopStage"),new f("FrogPoisonExStage"),new f("TrampolineWallCatchExStage"),new f("GotogotonExStage"),new f("FastenerExStage"),"Cloud",new f("CloudWorldHomeStage"),new f("Cube2DExStage"),new f("FukuwaraiKuriboStage"),"Clash",new f("ClashWorldHomeStage"),new f("ClashWorldShopStage"),new f("ImomuPoisonExStage"),new f("JangoExStage"),"City",new f("CityWorldHomeStage"),new f("CityWorldShop01Stage"),new f("Note2D3DRoomExStage"),new f("CityWorldFactoryStage"),new f("CityWorldMainTowerStage"),new f("PoleKillerExStage"),new f("BikeSteelExStage"),new f("CapRotatePackunExStage"),new f("ElectricWireExStage"),new f("CityWorldSandSlotStage"),new f("RadioControlExStage"),new f("ShootingCityExStage"),new f("SwingSteelExStage"),new f("PoleGrabCeilExStage"),new f("Theater2DExStage"),new f("DonsukeExStage"),new f("CityPeopleRoadStage"),new f("TrexBikeExStage"),"Sea",new f("SeaWorldHomeStage"),new f("SeaWorldCostumeStage"),new f("WaterValleyExStage"),new f("SeaWorldSecretStage"),new f("CloudExStage"),new f("SenobiTowerExStage"),new f("ReflectBombExStage"),new f("TogezoRotateExStage"),new f("SeaWorldSneakingManStage"),new f("SeaWorldUtsuboCaveStage"),new f("SeaWorldVibrationStage"),"Snow",new f("SnowWorldHomeStage"),new f("IceWaterBlockExStage"),new f("SnowWorldTownStage"),new f("ByugoPuzzleExStage"),new f("IceWaterDashExStage"),new f("KillerRailCollisionExStage"),new f("SnowWorldCloudBonusExStage"),new f("SnowWorldLobby000Stage"),new f("SnowWorldLobby001Stage"),new f("SnowWorldShopStage"),new f("SnowWorldRace000Stage"),new f("IceWalkerExStage"),new f("SnowWorldLobbyExStage"),new f("SnowWorldRaceExStage"),new f("SnowWorldCostumeStage"),new f("SnowWorldRaceTutorialStage"),new f("SnowWorldRace001Stage"),new f("SnowWorldRaceHardExStage"),"Lava",new f("LavaWorldHomeStage"),new f("LavaWorldUpDownExStage"),new f("LavaWorldBubbleLaneExStage"),new f("LavaWorldFenceLiftExStage"),new f("LavaWorldClockExStage"),new f("LavaWorldExcavationExStage"),new f("LavaWorldShopStage"),new f("DemoLavaWorldScenario1EndStage"),new f("CapAppearLavaLiftExStage"),new f("ForkExStage"),new f("GabuzouClockExStage"),new f("LavaWorldTreasureStage"),new f("LavaWorldCostumeStage"),"BossRaid",new f("BossRaidWorldHomeStage"),new f("BullRunExStage"),new f("DotTowerExStage"),"Sky",new f("SkyWorldHomeStage"),new f("SkyWorldShopStage"),new f("SkyWorldCostumeStage"),new f("TsukkunClimbExStage"),new f("TsukkunRotateExStage"),new f("JizoSwitchExStage"),new f("SkyWorldCloudBonusExStage"),new f("KaronWingTowerStage"),new f("SkyWorldTreasureStage"),"Moon",new f("MoonWorldHomeStage"),new f("MoonWorldWeddingRoomStage"),new f("MoonWorldShopRoom"),new f("MoonWorldSphinxRoom"),new f("MoonWorldCaptureParadeStage"),new f("MoonAthleticExStage"),new f("Galaxy2DExStage"),new f("MoonWorldBasementStage"),new f("MoonWorldKoopa1Stage"),new f("MoonWorldKoopa2Stage"),new f("MoonWorldWeddingRoom2Stage"),"Peach",new f("PeachWorldHomeStage"),new f("PeachWorldCastleStage"),new f("PeachWorldPictureBossMagmaStage"),new f("PeachWorldPictureMofumofuStage"),new f("PeachWorldPictureBossRaidStage"),new f("PeachWorldPictureBossForestStage"),new f("PeachWorldPictureBossKnuckleStage"),new f("PeachWorldPictureGiantWanderBossStage"),new f("PeachWorldShopStage"),new f("PeachWorldCostumeStage"),new f("YoshiCloudExStage"),new f("FukuwaraiMarioStage"),new f("DotHardExStage"),new f("RevengeMofumofuStage"),new f("RevengeBossMagmaStage"),new f("RevengeForestBossStage"),new f("RevengeBossRaidStage"),new f("RevengeBossKnuckleStage"),new f("RevengeGiantWanderBossStage"),"Special1",new f("Special1WorldHomeStage"),new f("PackunPoisonNoCapExStage"),new f("KillerRoadNoCapExStage"),new f("BikeSteelNoCapExStage"),new f("SenobiTowerYoshiExStage"),new f("ShootingCityYoshiExStage"),new f("LavaWorldUpDownYoshiExStage"),new f("Special1WorldTowerStackerStage"),new f("Special1WorldTowerBombTailStage"),new f("Special1WorldTowerFireBlowerStage"),new f("Special1WorldTowerCapThrowerStage"),"Special2",new f("Special2WorldKoopaStage"),new f("Special2WorldHomeStage"),new f("Special2WorldLavaStage"),new f("Special2WorldCloudStage")];t.sceneGroup={id:"smo",name:"Super Mario Odyssey",sceneDescs:A}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.parse=function(e){const t=e.createDataView();let a;switch(r.assert("SARC"===r.readString(e,0,4)),t.getUint16(6,!1)){case 65279:a=!1;break;case 65534:a=!0;break;default:throw new Error("Invalid BOM")}r.assert(20===t.getUint16(4,a));const n=t.getUint32(12,a),s=t.getUint16(16,a);r.assert(256===s),r.assert("SFAT"===r.readString(e,20,4)),r.assert(12===t.getUint16(24,a));const i=t.getUint16(26,a),o=32+16*i;r.assert("SFNT"===r.readString(e,o,4)),r.assert(8===t.getUint16(o+4,a));const l=o+8,c=[];let h=32;for(let s=0;s<i;s++){const s=t.getUint32(h+0,a),i=t.getUint32(h+4,a);let o;if(i>>>24){const t=4*(16777215&i);o=r.readString(e,l+t,255)}else o=s.toString(16);const d=n+t.getUint32(h+8,a),u=n+t.getUint32(h+12,a);c.push({name:o,offset:d,buffer:e.slice(d,u)}),h+=16}return{buffer:e,files:c}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(11)),s=a(10),i=a(6),o=r(a(323)),l=a(98),c=a(193),h=a(7),d=a(151),u=a(0),m=a(17),p=a(13),f=a(1),A=a(8),g=a(12),_=a(22),S=a(20),b=a(23),v=a(9),w=a(14);class x extends s.TextureHolder{addFRESTextures(e,t){const a=t.externalFiles.find(e=>"textures.bntx"===e.name);if(void 0!==a){const t=o.parse(a.buffer);this.addTextures(e,t.textures)}}loadTexture(e,t){const a=e.createTexture({dimension:0,pixelFormat:c.translateImageFormat(t.imageFormat),width:t.width,height:t.height,depth:1,numLevels:t.mipBuffers.length}),r=[],n=d.getChannelFormat(t.imageFormat);for(let s=0;s<t.mipBuffers.length;s++){const i=s,o=t.mipBuffers[s],h=Math.max(t.width>>>i,1),d=Math.max(t.height>>>i,1),u=1,m=c.deswizzle({buffer:o,width:h,height:d,channelFormat:n}),p=c.decompress(Object.assign(Object.assign({},t),{width:h,height:d,depth:u}),m),f=p.pixels,A=e.createHostAccessPass();A.uploadTextureData(a,i,[f]),e.submitPass(A);const g=document.createElement("canvas");l.surfaceToCanvas(g,p,0),r.push(g)}const s=new Map;return s.set("Format",c.getImageFormatString(t.imageFormat)),{viewerTexture:{name:t.name,surfaces:r,extraInfo:s},gfxTexture:a}}}function T(e){switch(e){case 0:return 1;case 2:case 3:return 0;case 1:case 4:return 2;default:throw"whoops"}}function y(e){switch(e){case 2:return 2;case 1:return 1;case 0:return 0;default:throw"whoops"}}function C(e){switch(e){case 2:return 1;case 1:return 0;default:throw"whoops"}}t.BRTITextureHolder=x;class M extends S.DeviceProgram{constructor(e){super(),this.fmat=e,this.isTranslucent=!1,this.both=M.globalDefinitions,this.vert=`\nlayout(location = ${M._p0}) in vec3 _p0;\nlayout(location = ${M._c0}) in vec4 _c0;\nlayout(location = ${M._u0}) in vec2 _u0;\nlayout(location = ${M._n0}) in vec4 _n0;\nlayout(location = ${M._t0}) in vec4 _t0;\n\nout vec3 v_PositionWorld;\nout vec2 v_TexCoord0;\nout vec4 v_VtxColor;\n\nout vec4 v_NormalWorld;\nout vec4 v_TangentWorld;\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_ModelView), vec4(_p0, 1.0)));\n    v_PositionWorld = _p0.xyz;\n    v_TexCoord0 = _u0;\n    v_VtxColor = _c0;\n    v_NormalWorld = _n0;\n    v_TangentWorld = _t0;\n}\n`,this.name=this.fmat.name,u.assert(this.fmat.samplerInfo.length<=8),this.getShaderOptionNumber("vtxcolor_type")>=0&&this.defines.set("OPT_vtxcolor","1");let t=!1;try{t=this.outputIsTranslucent("o_alpha")}catch(e){}this.isTranslucent=t&&!this.getShaderOptionBoolean("enable_alphamask"),this.frag=this.generateFrag()}lookupSamplerIndex(e){const t=u.assertExists(this.fmat.shaderAssign.samplerAssign.get(e)),a=this.fmat.samplerInfo.findIndex(e=>e.name===t);return u.assert(a>=0),a}getShaderOptionNumber(e){return+u.assertExists(this.fmat.shaderAssign.shaderOption.get(e))}getShaderOptionBoolean(e){const t=u.assertExists(this.fmat.shaderAssign.shaderOption.get(e));return u.assert("0"===t||"1"===t),"1"===t}condShaderOption(e,t,a=(()=>"")){return this.getShaderOptionBoolean(e)?t():a()}generateComponentMask(e){if(10===e)return".rgba";if(20===e)return".rrrr";if(30===e)return".g";if(50===e)return".rgba";if(60===e)return".a";throw"whoops"}genSample(e){try{return`texture(u_Samplers[${this.lookupSamplerIndex(e)}], ${"v_TexCoord0"})`}catch(t){return console.warn(`${this.name}: No sampler by name ${e}`),"vec4(1.0)"}}genBlend(e){return u.assert(this.getShaderOptionBoolean(`enable_blend${e}`)),`${this.genOutput(`blend${e}_src`)}${this.genOutputCompMask(`blend${e}_src_ch`)}`}genOutputCompMask(e){return this.generateComponentMask(this.getShaderOptionNumber(e))}genOutput(e){const t=this.getShaderOptionNumber(e);if(15===t)return"vec4(1.0)";const a=u.assertExists(t/10|0),r=u.assertExists(t%10);if(1===a)return this.genSample(`_a${r}`);if(2===a||3===a)return this.genSample(`_n${r}`);if(5===a)return this.genSample(`_u${r}`);if(6===a)return"vec4(1.0)";if(7===a)return"vec4(1.0)";if(8===a)return this.genBlend(r);if(10===a)return"vec4(1.0)";if(11===a){if(0===r||1===r||2===r||5===r)return"vec4(0.0)";if(6===r)return"vec4(1.0)";throw"whoops"}throw"whoops"}blendIsTranslucent(e){return u.assert(this.getShaderOptionBoolean(`enable_blend${e}`)),this.outputIsTranslucent(`blend${e}_src`)}outputIsTranslucent(e){const t=this.getShaderOptionNumber(e),a=t/10|0,r=t%10;return 8===a?this.blendIsTranslucent(r):11!==a||6!==r}generateFrag(){return`\nprecision mediump float;\n\nin vec3 v_PositionWorld;\nin vec2 v_TexCoord0;\nin vec4 v_VtxColor;\nin vec4 v_NormalWorld;\nin vec4 v_TangentWorld;\n\nvoid main() {\n    gl_FragColor = vec4(0.0);\n\n${this.condShaderOption("enable_base_color",()=>`\n    vec4 o_base_color = ${this.genOutput("o_base_color")};\n    gl_FragColor += o_base_color;\n`)}\n\n    // TODO(jstpierre): When should o_alpha be used?\n    gl_FragColor.a = ${this.genOutput("o_alpha")}${this.genOutputCompMask("alpha_component")};\n\n// TODO(jstpierre): How does this interact with enable_base_color_mul_color\n#ifdef OPT_vtxcolor\n    gl_FragColor.rgb *= v_VtxColor.rgb;\n#endif\n\n${this.condShaderOption("enable_normal",()=>`\n    vec3 t_Normal = v_NormalWorld.xyz;\n    vec3 t_Tangent = normalize(v_TangentWorld.xyz);\n    vec3 t_Bitangent = cross(t_Normal, t_Tangent) * v_TangentWorld.w;\n\n    // Perturb normal with map.\n    vec3 t_LocalNormal = vec3(${this.genOutput("o_normal")}.rg, 0);\n    float t_Len2 = 1.0 - t_LocalNormal.x*t_LocalNormal.x - t_LocalNormal.y*t_LocalNormal.y;\n    t_LocalNormal.z = sqrt(clamp(t_Len2, 0.0, 1.0));\n    vec3 t_NormalDir = (t_LocalNormal.x * t_Tangent + t_LocalNormal.y * t_Bitangent + t_LocalNormal.z * t_Normal);\n\n    vec3 t_LightDir = normalize(vec3(-0.5, -0.5, -1));\n    float t_LightIntensity = clamp(dot(t_LightDir, -t_NormalDir), 0.0, 1.0);\n    // Don't perturb that much.\n    t_LightIntensity = mix(0.6, 1.0, t_LightIntensity);\n\n    gl_FragColor.rgb *= t_LightIntensity;\n`)}\n\n${this.condShaderOption("enable_alphamask",()=>"\n    // TODO(jstpierre): Dynamic alpha reference value (it should be in the shader params)\n    if (gl_FragColor.a <= 0.5)\n        discard;\n")}\n\n${this.condShaderOption("enable_emission",()=>`\n    vec4 o_emission = ${this.genOutput("o_emission")};\n    // gl_FragColor.rgb += o_emission.rgb;\n`)}\n\n    // Gamma correction.\n    gl_FragColor.rgb = pow(gl_FragColor.rgb, vec3(1.0 / 2.2));\n}\n`}}function U(e){return u.assert(2===e.type&&1===e.values.length),e.values[0]}function k(e){const t=U(e);if("true"===t)return!0;if("false"===t)return!1;throw"whoops"}function D(e){const t=U(e.renderInfo.get("display_face"));if("front"===t)return 2;if("back"===t)return 1;if("both"===t)return 0;throw"whoops"}function I(e){return k(e.renderInfo.get("enable_depth_write"))}function R(e){if(k(e.renderInfo.get("enable_depth_test"))){if("Lequal"===U(e.renderInfo.get("depth_test_func")))return i.GfxCompareMode.LEQUAL;throw"whoops"}return i.GfxCompareMode.ALWAYS}function B(e){const t=U(e);if("src_alpha"===t)return i.GfxBlendFactor.SRC_ALPHA;if("one_minus_src_alpha"===t)return i.GfxBlendFactor.ONE_MINUS_SRC_ALPHA;if("one"===t)return i.GfxBlendFactor.ONE;if("zero"===t)return i.GfxBlendFactor.ZERO;throw"whoops"}function P(e){return B(e.renderInfo.get("color_blend_rgb_src_func"))}function E(e){return B(e.renderInfo.get("color_blend_rgb_dst_func"))}M._p0=0,M._c0=1,M._u0=2,M._n0=3,M._t0=4,M.a_Orders=["_p0","_c0","_u0","_n0","_t0"],M.ub_ShapeParams=0,M.globalDefinitions="\nprecision mediump float;\n\nlayout(row_major, std140) uniform ub_ShapeParams {\n    Mat4x4 u_Projection;\n    Mat4x3 u_ModelView;\n};\n\nuniform sampler2D u_Samplers[8];\n";class F{constructor(e,t,a,r){this.fmat=r,this.gfxSamplers=[],this.textureMapping=[],this.program=new M(r),u.assert(r.samplerInfo.length===r.textureName.length),this.textureMapping=u.nArray(8,()=>new s.TextureMapping);for(let n=0;n<r.samplerInfo.length;n++){const s=r.samplerInfo[n],i=t.createSampler(e,{wrapS:T(s.addrModeU),wrapT:T(s.addrModeV),mipFilter:y(s.filterMode>>>0&3),minFilter:C(s.filterMode>>>4&3),magFilter:C(s.filterMode>>>2&3),maxLOD:s.maxLOD,minLOD:s.minLOD});this.gfxSamplers.push(i);const o=r.textureName[n];a.fillTextureMapping(this.textureMapping[n],o),this.textureMapping[n].name=o,this.textureMapping[n].gfxSampler=i}this.gfxProgram=e.createProgram(this.program);const n=this.program.isTranslucent;this.megaStateFlags={cullMode:D(r),depthCompare:_.reverseDepthForCompareMode(R(r)),depthWrite:!n&&I(r)},w.setAttachmentStateSimple(this.megaStateFlags,{blendMode:i.GfxBlendMode.ADD,blendSrcFactor:n?P(r):i.GfxBlendFactor.ONE,blendDstFactor:n?E(r):i.GfxBlendFactor.ZERO})}setOnRenderInst(e,t){const a=this.program.isTranslucent?128:32;t.sortKey=h.makeSortKey(a,0),t.setSamplerBindingsFromTextureMappings(this.textureMapping),t.setGfxProgram(this.gfxProgram),t.setMegaStateFlags(this.megaStateFlags)}destroy(e){e.destroyProgram(this.gfxProgram)}}function V(e){switch(e){case 2305:return i.GfxFormat.U8_RG_NORM;case 2306:return i.GfxFormat.S8_RG_NORM;case 2307:return i.GfxFormat.U32_RG;case 2817:return i.GfxFormat.U8_RGBA_NORM;case 2818:case 3586:return i.GfxFormat.S8_RGBA_NORM;case 4609:return i.GfxFormat.U16_RG_NORM;case 4610:return i.GfxFormat.S16_RG_NORM;case 4613:return i.GfxFormat.F16_RG;case 5381:return i.GfxFormat.F16_RGBA;case 5893:return i.GfxFormat.F32_RG;case 6149:return i.GfxFormat.F32_RGB;default:throw console.error(d.getChannelFormat(e),d.getTypeFormat(e)),"whoops"}}class O{constructor(e,t){this.fvtx=t,this.vertexAttributeDescriptors=[],this.inputBufferDescriptors=[],this.vertexBufferDescriptors=[];let a=t.vertexBuffers.length;for(let r=0;r<t.vertexAttributes.length;r++){const n=t.vertexAttributes[r],s=M.a_Orders.indexOf(n.name);if(s<0)continue;const i=n.bufferIndex,o=t.vertexBuffers[i],l=this.convertVertexAttribute(n,o);if(null!==l){const t=a++;this.vertexAttributeDescriptors.push({location:s,format:l.format,bufferIndex:t,bufferByteOffset:0}),this.inputBufferDescriptors[t]={byteStride:l.stride,frequency:1};const r=m.makeStaticDataBuffer(e,2,l.data);this.vertexBufferDescriptors[t]={buffer:r,byteOffset:0}}else if(this.vertexAttributeDescriptors.push({location:s,format:V(n.format),bufferIndex:i,bufferByteOffset:n.offset}),!this.vertexBufferDescriptors[i]){const t=m.makeStaticDataBufferFromSlice(e,2,o.data);this.inputBufferDescriptors[i]={byteStride:o.stride,frequency:1},this.vertexBufferDescriptors[i]={buffer:t,byteOffset:0}}}}convertVertexAttribute(e,t){switch(e.format){case 3586:return this.convertVertexAttribute_10_10_10_2_Snorm(e,t);default:return null}}convertVertexAttribute_10_10_10_2_Snorm(e,t){function a(e){return e<<22>>22}const r=t.data.byteLength/t.stride,n=i.GfxFormat.S16_RGBA_NORM,s=new Int16Array(4*r),o=4*s.BYTES_PER_ELEMENT;let l=0,c=e.offset;const h=t.data.createDataView();for(let e=0;e<r;e++){const e=h.getUint32(c,!0);s[l++]=a(e>>>0&1023)<<4,s[l++]=a(e>>>10&1023)<<4,s[l++]=a(e>>>20&1023)<<4,s[l++]=(e>>>30&3)<<14,c+=t.stride}return{format:n,data:s.buffer,stride:o}}destroy(e){for(let t=0;t<this.vertexBufferDescriptors.length;t++)this.vertexBufferDescriptors[t]&&e.destroyBuffer(this.vertexBufferDescriptors[t].buffer)}}class N{constructor(e,t,a){this.mesh=t;const r=function(e){switch(e){case 0:return i.GfxFormat.U8_R;case 1:return i.GfxFormat.U16_R;case 2:return i.GfxFormat.U32_R;default:throw"whoops"}}(t.indexFormat);this.inputLayout=e.createInputLayout({indexBufferFormat:r,vertexAttributeDescriptors:a.vertexAttributeDescriptors,vertexBufferDescriptors:a.inputBufferDescriptors}),this.indexBuffer=m.makeStaticDataBufferFromSlice(e,1,t.indexBufferData);const n={buffer:this.indexBuffer,byteOffset:0};this.inputState=e.createInputState(this.inputLayout,a.vertexBufferDescriptors,n)}destroy(e){e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState),e.destroyBuffer(this.indexBuffer)}}t.FSHPMeshData=N;class L{constructor(e,t,a){this.fshp=t,this.meshData=[];for(let r=0;r<t.mesh.length;r++)this.meshData.push(new N(e,t.mesh[r],a))}destroy(e){for(let t=0;t<this.meshData.length;t++)this.meshData[t].destroy(e)}}t.FSHPData=L;t.FMDLData=class{constructor(e,t){this.fmdl=t,this.fvtxData=[],this.fshpData=[];for(let a=0;a<t.fvtx.length;a++)this.fvtxData.push(new O(e,t.fvtx[a]));for(let a=0;a<t.fshp.length;a++){const r=t.fshp[a];this.fshpData.push(new L(e,r,this.fvtxData[r.vertexIndex]))}}destroy(e){for(let t=0;t<this.fvtxData.length;t++)this.fvtxData[t].destroy(e);for(let t=0;t<this.fshpData.length;t++)this.fshpData[t].destroy(e)}};class G{constructor(e){this.meshData=e,u.assert(0===this.meshData.mesh.offset)}prepareToRender(e,t,a){const r=t.pushRenderInst();r.drawIndexes(this.meshData.mesh.count),r.setInputLayoutAndState(this.meshData.inputLayout,this.meshData.inputState);const n=A.computeViewSpaceDepthFromWorldSpaceAABB(a.camera,this.meshData.mesh.bbox);r.sortKey=h.setSortKeyDepth(r.sortKey,n)}}const H=f.mat4.create(),j=new g.AABB;class W{constructor(e,t){this.fshpData=e,this.fmatInstance=t,this.lodMeshInstances=[],this.visible=!0;for(let t=0;t<1;t++)this.lodMeshInstances.push(new G(e.meshData[t]))}computeModelView(e,t){const a=H;return A.computeViewMatrix(a,t.camera),f.mat4.mul(a,a,e),a}prepareToRender(e,t,a,r){if(!this.visible)return;const n=t.pushTemplateRenderInst();let s=n.allocateUniformBuffer(M.ub_ShapeParams,28);const i=n.mapUniformBufferF32(M.ub_ShapeParams);s+=p.fillMatrix4x4(i,s,r.camera.projectionMatrix),s+=p.fillMatrix4x3(i,s,this.computeModelView(a,r)),this.fmatInstance.setOnRenderInst(e,n);for(let n=0;n<this.lodMeshInstances.length;n++)j.transform(this.lodMeshInstances[n].meshData.mesh.bbox,a),r.camera.frustum.contains(j)&&this.lodMeshInstances[n].prepareToRender(e,t,r);t.popTemplateRenderInst()}}const Z=[{numUniformBuffers:1,numSamplers:8}];t.FMDLRenderer=class{constructor(e,t,a,r){this.textureHolder=a,this.fmdlData=r,this.fmatInst=[],this.fshpInst=[],this.modelMatrix=f.mat4.create(),this.visible=!0,this.name=r.fmdl.name;for(let a=0;a<this.fmdlData.fmdl.fmat.length;a++)this.fmatInst.push(new F(e,t,this.textureHolder,this.fmdlData.fmdl.fmat[a]));for(let e=0;e<this.fmdlData.fshpData.length;e++){const t=this.fmdlData.fshpData[e],a=this.fmatInst[t.fshp.materialIndex];this.fshpInst.push(new W(t,a))}}setVisible(e){this.visible=e}prepareToRender(e,t,a){if(!this.visible)return;t.pushTemplateRenderInst().setBindingLayouts(Z);for(let r=0;r<this.fshpInst.length;r++)this.fshpInst[r].prepareToRender(e,t,this.modelMatrix,a);t.popTemplateRenderInst()}destroy(e){for(let t=0;t<this.fmatInst.length;t++)this.fmatInst[t].destroy(e)}};t.BasicFRESRenderer=class{constructor(e,t){this.textureHolder=t,this.renderTarget=new v.BasicRenderTarget,this.fmdlRenderers=[],this.renderHelper=new b.GfxRenderHelper(e)}createPanels(){const e=new n.LayerPanel;return e.setLayers(this.fmdlRenderers),[e]}prepareToRender(e,t,a){const r=this.renderHelper.renderInstManager;this.renderHelper.pushTemplateRenderInst();for(let t=0;t<this.fmdlRenderers.length;t++)this.fmdlRenderers[t].prepareToRender(e,r,a);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,v.standardFullClearRenderPassDescriptor);return this.renderHelper.renderInstManager.drawOnPassRenderer(e,r),this.renderHelper.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.fmdlRenderers.length;t++)this.fmdlRenderers[t].destroy(e)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0),n=a(192),s=a(151),i=a(193);function o(e,t,a){const o=e.createDataView();r.assert("BRTI"===r.readString(e,t+0,4));const l=n.readBinStr(e,o.getUint32(t+96,a),a),c=(o.getUint8(t+16),o.getUint8(t+17),o.getUint16(t+18,a));r.assert(0===c);o.getUint16(t+20,a);const h=o.getUint16(t+22,a),d=o.getUint16(t+24,a);r.assert(1===d);const u=o.getUint32(t+28,a),m=(o.getUint32(t+32,a),o.getUint32(t+36,a)),p=o.getUint32(t+40,a),f=o.getUint32(t+44,a),A=o.getUint32(t+48,a),g=o.getUint32(t+52,a),_=s.getChannelFormat(u);if(!i.isChannelFormatSupported(_))return null;const S=i.getFormatBlockHeight(_),b=i.getBlockHeightLog2(p/S);if(g!==b)return null;r.assert(g===b);const v=o.getUint32(t+80,a),w=(o.getUint32(t+84,a),o.getUint32(t+88,a),o.getUint8(t+92)),x=[];let T=o.getUint32(t+112,a);for(let e=0;e<h;e++)x.push(o.getUint32(T+0,a)),T+=8;const y=[];for(let t=0;t<h-1;t++)y.push(e.slice(x[t],x[t+1]));return y.push(e.slice(x[h-1],x[0]+v)),{name:l,imageDimension:w,imageFormat:u,width:m,height:p,depth:f,arraySize:A,mipBuffers:y}}t.parse=function(e){const t=e.createDataView();r.assert("BNTX\0\0\0\0"===r.readString(e,0,8,!1));const a=n.isMarkerLittleEndian(t.getUint16(12,!1)),s=t.getUint32(8,a);r.assert([262144].includes(s));const i=r.readString(e,32,4);r.assert("NX  "===i);const l=t.getUint32(56,a);r.assert("_DIC"===r.readString(e,l+0,4));const c=t.getUint32(l+4,a);let h=l+24,d=t.getUint32(40,a)+0;const u=[];for(let s=0;s<c;s++){const s=n.readBinStr(e,t.getUint32(h+8,a),a),i=o(e,t.getUint32(d+0,a),a);null!==i&&(r.assert(i.name===s),u.push(i)),h+=16,d+=8}return{textures:u}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(102)),i=r(a(326)),o=a(194),l=a(97),c=a(6),h=a(195),d=a(0),u=a(197),m=a(196),p=a(329),f=a(1),A=n(a(15)),g=a(4),_=a(8),S=a(198),b=a(98);function v(e){let t=0;for(;t<e.length&&e[t];)t++;return new TextDecoder("utf8").decode(e.subarray(0,t))}class w extends Map{constructor(){super(...arguments),this.primed=!1}destroy(e){console.log("Deleting",this.size,"assets from cache"),this.clear()}}const x=g.colorNewCopy(g.OpaqueBlack);class T{constructor(e,t,a,r){this.meta=e,this.name=t,this.interior=a,this.id=r}static async initialise(){this.initialised||(await s.init({gtaPlugins:!0,platform:s.Platform.PLATFORM_D3D8}),s.Texture.setCreateDummies(!0),s.Texture.setLoadTextures(!1),await o.initializeBasis(),this.initialised=!0)}async fetchIMG(e,t="gta3",a=!0){if(this.assetCache.primed)return;const r=1===this.meta.img.version,n=a?await this.fetchGZ(e,`models/${t}.imgz`):await this.fetch(e,`models/${t}.img`),s=r?await this.fetch(e,`models/${t}.dir`):n,i=s.createDataView(),o=r?0:8,l=r?i.byteLength:32*i.getUint32(4,!0);r||d.assert(1447383602===i.getUint32(0));for(let e=o;e<o+l;e+=32){const t=i.getUint32(e+0,!0),a=r?i.getUint32(e+4,!0):i.getUint16(e+4,!0),o=v(s.subarray(e+8,24).createTypedArray(Uint8Array)).toLowerCase(),l=n.subarray(2048*t,2048*a),c=`${this.meta.id}/models/gta3/${o}`;this.assetCache.has(c)&&console.warn("Duplicate",c),this.assetCache.set(c,l)}}async fetchGZ(e,t){const a=d.assertExists(await this.fetch(e,t,!1)),r=l.inflate(a.createTypedArray(Uint8Array));return new A.default(r.buffer,r.byteOffset,r.byteLength)}async fetch(e,t,a=!0){t=`${this.meta.id}/${t}`;let r=this.assetCache.get(t);if(void 0===r){if(r=await e.fetchData(t,1),0===r.byteLength)return console.error("Not found",t),null;a&&this.assetCache.set(t,r)}return r}async fetchText(e,t){const a=await this.fetch(e,t);return new TextDecoder("utf8").decode(a.createDataView())}async fetchIDE(e,t){const a=await this.fetchText(e,`data/maps/${t}.ide`);return u.parseItemDefinition(a)}async fetchIPL(e,t){const a=await this.fetchText(e,"props"===t?"data/maps/props.IPL":`data/maps/${t}.ipl`),r=u.parseItemPlacement(t,a);if(!t.match(/\//))return r;const n=t.split("/")[1].toLowerCase(),s=this.meta.ipl_stream[n];if(void 0===s)return r;for(let t=0;t<s;t++){const a=n+"_stream"+t,s=await this.fetch(e,`models/gta3/${a}.ipl`),i=u.parseItemPlacementBinary(s.createDataView());r.instances=r.instances.concat(i)}return r}async fetchTimeCycle(e){const t=await this.fetchText(e,this.meta.paths.dat.timecyc);return m.parseTimeCycle(t,this.meta.paths.dat.timecyc)}async fetchZones(e){const t=await this.fetchText(e,this.meta.paths.zon);return u.parseZones(t)}async fetchWater(e){if(this.meta.paths.dat.water.endsWith("water.dat")){const t=await this.fetchText(e,this.meta.paths.dat.water);return[{id:"water",instances:[u.createItemInstance("water")],interiors:[]},p.parseWater(t,this.meta.water.texture)]}{const t=await this.fetch(e,this.meta.paths.dat.water);return[p.parseWaterPro(t.createDataView(),this.meta.water.origin),[p.waterMeshFragData(this.meta.water.texture)]]}}async fetchTXD(e,t,a,r){const n="generic"===a||"particle"===a?`models/${a}.txd`:`models/gta3/${a}.txd`,i=e.queryTextureFormatSupported(c.GfxFormat.BC1)&&!("generic"===a||"particle"===a),o=await this.fetch(t,n);if(null===o)return;const l=new s.StreamMemory(o.createTypedArray(Uint8Array)),u=new s.ChunkHeaderInfo(l);d.assert(u.type===s.PluginID.ID_TEXDICTIONARY);const m=new s.TexDictionary(l);for(let e=m.textures.begin;!e.is(m.textures.end);e=e.next){r(h.rwTexture(s.Texture.fromDict(e),a,i))}m.delete(),u.delete(),l.delete()}async fetchDFF(e,t,a){const r=`models/gta3/${t}.dff`,n=await this.fetch(e,r);if(null===n)return;const i=new s.StreamMemory(n.createTypedArray(Uint8Array));let o=new s.ChunkHeaderInfo(i);o.type===s.PluginID.ID_UVANIMDICT&&(console.log("Found UV animation for",t),s.UVAnimDictionary.current=s.UVAnimDictionary.streamRead(i),o.delete(),o=new s.ChunkHeaderInfo(i)),d.assert(o.type===s.PluginID.ID_CLUMP);const l=s.Clump.streamRead(i);a(l),l.delete(),o.delete(),i.delete(),s.UVAnimDictionary.current=null}async fetchBasisTextures(e,t,a,r){const n=e.queryTextureFormatSupported(c.GfxFormat.BC1);n||console.warn("DXT not supported");for(const e of[!1,!0]){const s=e?"transparent":"opaque",i=await this.fetchText(t,`textures/${s}.txt`).then(e=>e.trim().split("\n")),l=[];for(let e=0;e<Math.ceil(i.length/256);e++)l.push(this.fetch(t,`textures/${s}/${d.leftPad(e.toString(16),2)}.basis`));for(let t=0;t<l.length;t++){const s=await l[t],h=new o.BasisFile(s.createTypedArray(Uint8Array)),u=[];for(let e=0;e<256&&256*t+e<i.length;e++)u.push(i[256*t+e]);d.assert(h.getNumImages()===u.length),d.assert(!!h.startTranscoding());for(let t=0;t<u.length;t++){const s=u[t];if(!a.has(s))continue;a.delete(s);const i=h.getImageWidth(t,0),l=h.getImageHeight(t,0),m=n?e?c.GfxFormat.BC3:c.GfxFormat.BC1:c.GfxFormat.U8_RGBA_NORM,p=e?o.BasisFormat.cTFBC3:o.BasisFormat.cTFBC1,f=[],A=h.getNumLevels(t);for(let a=0;a<A;a++){const r=h.getImageTranscodedSizeInBytes(t,a,p);let s=new Uint8Array(r);d.assert(!!h.transcodeImage(s,t,a,p,0,0)),n||(s=b.decompressBC({width:h.getImageWidth(t,a),height:h.getImageHeight(t,a),depth:1,type:e?"BC3":"BC1",pixels:s,flag:"UNORM"}).pixels),f.push(s)}r({name:s,width:i,height:l,levels:f,pixelFormat:m,transparent:e})}}}}generateSaveStates(e){const t=f.mat4.create(),a=new Uint8Array(512),r=new DataView(a.buffer),n=new Map;for(const s of e)for(const e of s.interiors){if(0===e.interior||"changer"===e.name)continue;f.mat4.identity(t);const s=1.6;f.mat4.translate(t,t,[e.exitPos[1],e.exitPos[2]+s,e.exitPos[0]]),f.mat4.rotateY(t,t,.01745*(e.exitAngle-90));const i=1+_.serializeMat4(r,1,t),o="A"+S.btoa(a,i),l=`SaveState_${this.meta.id}/${e.interior}/${e.name}/1`;n.set(l,o)}return Object.assign({},...[...n.entries()].sort().map(([e,t])=>({[e]:t})))}async createScene(e,t){await T.initialise();const a=t.dataFetcher,r=new Map,n=new Map,s=new Set;if(this.assetCache=await t.dataShare.ensureObject(this.meta.id,async()=>new w),this.meta.basisTextures)await this.fetchIMG(a,"gta_notxd");else{await this.fetchIMG(a);for(const e of this.meta.img.extra)await this.fetchIMG(a,e,!1)}this.assetCache.primed=!0;const i=await Promise.all(this.meta.paths.ide.map(e=>this.fetchIDE(a,e)));for(const e of i)for(const t of e.objects)r.set(t.modelName,t),void 0!==t.id&&n.set(t.id,t.modelName),t.modelName.startsWith("lod")&&s.add(t.modelName.substr(3));r.set("water",p.waterDefinition);const o=await Promise.all(this.meta.paths.ipl.map(e=>this.fetchIPL(a,e))),l=await this.fetchTimeCycle(a),[c,d]=await this.fetchWater(a);o.push(c);for(const e of o)for(const t of e.instances)void 0===t.modelName&&void 0!==t.id&&(t.modelName=n.get(t.id));for(const e of o)for(let t=0;t<e.instances.length;t++){const a=e.instances[t];if(void 0!==a.lod&&a.lod>=0){const t=r.get(a.modelName);e.instances[a.lod].lodDistance=t.drawDistance}}const m=new h.GTA3Renderer(e,l,this.meta.weather.names,this.meta.weather.periods,this.meta.water.origin),f=new h.ModelCache,A=new Set,g=new Set,_=new Map;f.meshData.set("water",d);for(const e of o)for(const t of e.instances){if(void 0===t.modelName){console.error("Missing model name for ID",t.id);continue}const n=t.modelName,i=s.has(n.substr(3))||void 0!==t.lod&&t.lod>=0,o=r.get(n);if(!o){console.warn("No definition for object",n);continue}if(void 0===t.lod&&(n.startsWith("lod")&&"lodistancoast01"!==n||n.startsWith("islandlod")))continue;const l=255&t.interior;if(!(l===this.interior||l===u.INTERIOR_EVERYWHERE))continue;f.meshData.has(o.modelName)||await this.fetchDFF(a,o.modelName,e=>f.addModel(e,o));const c=f.meshData.get(n);if(void 0===c){console.warn("Missing model",n);continue}let d=!1;for(const e of c)if(void 0!==e.texName){A.add(e.texName),g.add(e.texName.split("/")[0]);for(let t=0;t<e.vertices;t++)if(e.fillColor(x,t),x.a<1){d=!0;break}}const m=100;let p=new h.DrawParams;o.flags&u.ObjectFlags.IGNORE_DRAW_DISTANCE||(p.maxDistance=50*Math.ceil(o.drawDistance/50)),o.tobj&&(p.timeOn=o.timeOn,p.timeOff=o.timeOff),p.water="water"===o.modelName,p.additive=!!(o.flags&u.ObjectFlags.ADDITIVE),p.backface=!!(o.flags&u.ObjectFlags.DISABLE_BACKFACE_CULLING),(d||o.flags&u.ObjectFlags.DRAW_LAST)&&(p.renderLayer=128),void 0!==t.lodDistance&&(p.minDistance=50*Math.ceil(t.lodDistance/50)),(0!==this.interior||void 0===t.lod&&(i||p.maxDistance>=m)||void 0!==t.lodDistance||n.startsWith("lod"))&&(p.maxDistance=1/0),p=p.intern();const S=e.id;_.has(S)||_.set(S,new Map);const b=_.get(S);b.has(p)||b.set(p,[]);const v=new h.MeshInstance(c,t);b.get(p).push(v)}const S=new Map,b=[];function v(t){const a=[t.width,t.height,t.pixelFormat,t.transparent,t.levels.length].join();S.has(a)||S.set(a,new Set);const r=S.get(a);r.add(t),r.size>=256&&(b.push(new h.TextureArray(e,Array.from(r))),r.clear())}this.meta.basisTextures&&(await this.fetchBasisTextures(e,a,A,v),g.clear(),g.add("particle"));for(const t of g)await this.fetchTXD(e,a,t,e=>{A.has(e.name)&&(A.delete(e.name),v(e))});for(const t of S.values())t.size>0&&(b.push(new h.TextureArray(e,Array.from(t))),t.clear());const y=A;y.size>0&&console.warn("Missing textures",Array.from(y).sort());const C=this.meta.water.origin[2],M=m.renderHelper.getCache();for(const t of _.values()){const a=new h.AreaRenderer;for(const[r,n]of t){for(const e of n)for(const t of e.frags)void 0!==t.texName&&y.has(t.texName)&&delete t.texName;h.SceneRenderer.applicable(n)&&a.push(new h.SceneRenderer(e,M,r,n,C));for(const t of b)h.SceneRenderer.applicable(n,t)&&(a.push(new h.SceneRenderer(e,M,r,n,C,t)),128!==r.renderLayer||r.water||a.push(new h.SceneRenderer(e,M,r,n,C,t,!0)))}m.renderers.push(a)}return await this.fetchTXD(e,a,"particle",t=>{if(t.name===`particle/${this.meta.water.texture}`){const a=new h.TextureArray(e,[t]);m.renderers.push(new h.SkyRenderer(e,M,a))}}),m}}function y(e){const t={id:e.id,name:e.name,sceneDescs:[new T(e,e.map.name,0,"0")]};if(e.map.interiors.length>0){t.sceneDescs.push("Interiors");for(const[a,r,n]of e.map.interiors){const s=""===n?String(r):`${r}/${n.toLowerCase()}`;t.sceneDescs.push(new T(e,a,r,s))}}return t}t.GTA3SceneDesc=T,T.initialised=!1,t.sceneGroup={iii:y(i.iii),vc:y(i.vc),sa:y(i.sa)}},function(e,t,a){(function(t,r){var n,s=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){e=void 0!==(e=e||{})?e:{};var s,i={};for(s in e)e.hasOwnProperty(s)&&(i[s]=e[s]);var o=[],l=function(e,t){throw t},c=!1,h=!1,d=!1,u=!1;c="object"==typeof window,h="function"==typeof importScripts,d="object"==typeof t&&"object"==typeof t.versions&&"string"==typeof t.versions.node&&!c&&!h,u=!c&&!d&&!h;var m,p,f,A,g="";function _(t){return e.locateFile?e.locateFile(t,g):g+t}d?(g=r+"/",m=function(e,t){var r;return f||(f=a(!function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}())),A||(A=a(!function(){var e=new Error("Cannot find module 'path'");throw e.code="MODULE_NOT_FOUND",e}())),e=A.normalize(e),r=f.readFileSync(e),t?r:r.toString()},p=function(e){var t=m(e,!0);return t.buffer||(t=new Uint8Array(t)),C(t.buffer),t},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),o=t.argv.slice(2),t.on("uncaughtException",(function(e){if(!(e instanceof Be))throw e})),t.on("unhandledRejection",Fe),l=function(e){t.exit(e)},e.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(m=function(e){return read(e)}),p=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(C("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?o=scriptArgs:void 0!==arguments&&(o=arguments),"function"==typeof quit&&(l=function(e){quit(e)}),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(c||h)&&(h?g=self.location.href:document.currentScript&&(g=document.currentScript.src),n&&(g=n),g=0!==g.indexOf("blob:")?g.substr(0,g.lastIndexOf("/")+1):"",m=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},h&&(p=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var S=e.print||console.log.bind(console),b=e.printErr||console.warn.bind(console);for(s in i)i.hasOwnProperty(s)&&(e[s]=i[s]);i=null,e.arguments&&(o=e.arguments),e.thisProgram&&e.thisProgram,e.quit&&(l=e.quit);var v,w,x,T={"f64-rem":function(e,t){return e%t},debugger:function(){}};new Array(0),e.wasmBinary&&(v=e.wasmBinary),e.noExitRuntime&&(w=e.noExitRuntime),"object"!=typeof WebAssembly&&b("no native wasm support detected");var y=!1;function C(e,t){e||Fe("Assertion failed: "+t)}var M="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function U(e,t,a){for(var r=t+a,n=t;e[n]&&!(n>=r);)++n;if(n-t>16&&e.subarray&&M)return M.decode(e.subarray(t,n));for(var s="";t<n;){var i=e[t++];if(128&i){var o=63&e[t++];if(192!=(224&i)){var l=63&e[t++];if((i=224==(240&i)?(15&i)<<12|o<<6|l:(7&i)<<18|o<<12|l<<6|63&e[t++])<65536)s+=String.fromCharCode(i);else{var c=i-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&i)<<6|o)}else s+=String.fromCharCode(i)}return s}function k(e,t){return e?U(R,e,t):""}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var D,I,R,B,P=65536;function E(e,t){return e%t>0&&(e+=t-e%t),e}function F(t){D=t,e.HEAP8=I=new Int8Array(t),e.HEAP16=new Int16Array(t),e.HEAP32=B=new Int32Array(t),e.HEAPU8=R=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAPU32=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}var V=5255296,O=12384,N=e.TOTAL_MEMORY||16777216;function L(t){for(;t.length>0;){var a=t.shift();if("function"!=typeof a){var r=a.func;"number"==typeof r?void 0===a.arg?e.dynCall_v(r):e.dynCall_vi(r,a.arg):r(void 0===a.arg?null:a.arg)}else a()}}(x=e.wasmMemory?e.wasmMemory:new WebAssembly.Memory({initial:N/P}))&&(D=x.buffer),N=D.byteLength,F(D),B[O>>2]=V;var G=[],H=[],j=[],W=[];function Z(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)$(e.preRun.shift());L(G)}function z(){L(H)}function K(){L(j)}function X(){}function Y(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)q(e.postRun.shift());L(W)}function $(e){G.unshift(e)}function q(e){W.unshift(e)}var Q=0,J=null,ee=null;function te(t){Q++,e.monitorRunDependencies&&e.monitorRunDependencies(Q)}function ae(t){if(Q--,e.monitorRunDependencies&&e.monitorRunDependencies(Q),0==Q&&(null!==J&&(clearInterval(J),J=null),ee)){var a=ee;ee=null,a()}}e.preloadedImages={},e.preloadedAudios={};var re="data:application/octet-stream;base64,";function ne(e){return String.prototype.startsWith?e.startsWith(re):0===e.indexOf(re)}var se="librw.wasm";function ie(){try{if(v)return new Uint8Array(v);if(p)return p(se);throw"both async and sync fetching of the wasm failed"}catch(e){Fe(e)}}function oe(){return v||!c&&!h||"function"!=typeof fetch?new Promise((function(e,t){e(ie())})):fetch(se,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+se+"'";return e.arrayBuffer()})).catch((function(){return ie()}))}function le(t){var a={env:t,wasi_unstable:t,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:T};function r(t,a){var r=t.exports;e.asm=r,ae()}function n(e){r(e.instance)}function s(e){return oe().then((function(e){return WebAssembly.instantiate(e,a)})).then(e,(function(e){b("failed to asynchronously prepare wasm: "+e),Fe(e)}))}if(te(),e.instantiateWasm)try{return e.instantiateWasm(a,r)}catch(e){return b("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(v||"function"!=typeof WebAssembly.instantiateStreaming||ne(se)||"function"!=typeof fetch)return s(n);fetch(se,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,a).then(n,(function(e){b("wasm streaming compile failed: "+e),b("falling back to ArrayBuffer instantiation"),s(n)}))}))}(),{}}function ce(e,t,a,r){Fe("Assertion failed: "+k(e)+", at: "+[t?k(t):"unknown filename",a,r?k(r):"unknown function"])}function he(){throw y=!0,"Pure virtual function called!"}function de(){}ne(se)||(se=_(se)),e.asm=function(e,t,a){return t.memory=x,t.table=new WebAssembly.Table({initial:406,maximum:406,element:"anyfunc"}),t.__memory_base=1024,t.__table_base=0,le(t)};var ue={buffers:[null,[],[]],printChar:function(e,t){var a=ue.buffers[e];0===t||10===t?((1===e?S:b)(U(a,0)),a.length=0):a.push(t)},varargs:0,get:function(e){return ue.varargs+=4,B[ue.varargs-4>>2]},getStr:function(){return k(ue.get())},get64:function(){var e=ue.get();return ue.get(),e},getZero:function(){ue.get()}};function me(e,t){ue.varargs=t;try{return ue.getStreamFromFD(),ue.get(),ue.get(),ue.get(),ue.get(),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Fe(e),-e.errno}}function pe(e,t){ue.varargs=t;try{var a=ue.getStreamFromFD(),r=ue.get(),n=ue.get();return ue.doReadv(a,r,n)}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Fe(e),-e.errno}}function fe(t){return e.___errno_location&&(B[e.___errno_location()>>2]=t),t}function Ae(e,t){ue.varargs=t;try{return 0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Fe(e),-e.errno}}function ge(e,t){ue.varargs=t;try{var a=ue.getStr(),r=ue.get(),n=ue.get();return FS.open(a,r,n).fd}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Fe(e),-e.errno}}function _e(e,t){ue.varargs=t;try{return 0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Fe(e),-e.errno}}function Se(e,t){ue.varargs=t;try{return ue.getStreamFromFD(),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Fe(e),-e.errno}}function be(){}function ve(e,t,a,r){try{for(var n=0,s=0;s<a;s++){for(var i=B[t+8*s>>2],o=B[t+(8*s+4)>>2],l=0;l<o;l++)ue.printChar(e,R[i+l]);n+=o}return B[r>>2]=n,0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Fe(e),-e.errno}}function we(){return ve.apply(null,arguments)}function xe(){return I.length}function Te(e){Ee(e)}function ye(e,t,a){R.set(R.subarray(t,t+a),e)}function Ce(e){Fe("OOM")}function Me(e){try{return x.grow(e-D.byteLength+65535>>16),F(x.buffer),1}catch(e){}}function Ue(e){var t=xe();if(e>2147418112)return!1;for(var a=Math.max(t,16777216);a<e;)a=a<=536870912?E(2*a,65536):Math.min(E((3*a+2147483648)/4,65536),2147418112);return!!Me(a)}var ke,De={},Ie={c:Fe,b:ce,s:he,r:de,h:fe,q:me,p:pe,d:Ae,o:ge,n:_e,g:Se,e:be,m:we,l:xe,k:ye,j:Ue,f:Te,i:Ce,a:O},Re=e.asm(De,Ie,D);function Be(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Pe(t){function a(){ke||(ke=!0,y||(z(),K(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Y()))}t=t||o,Q>0||(Z(),Q>0||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),a()}),1)):a()))}function Ee(t,a){a&&w&&0===t||(w||(y=!0,X(),e.onExit&&e.onExit(t)),l(t,new Be(t)))}function Fe(t){throw e.onAbort&&e.onAbort(t),S(t+=""),b(t),y=!0,"abort("+t+"). Build with -s ASSERTIONS=1 for more info."}if(e.asm=Re,e._free=function(){return e.asm.t.apply(null,arguments)},e._gta_attachPlugins=function(){return e.asm.u.apply(null,arguments)},e._gta_getNodeName=function(){return e.asm.v.apply(null,arguments)},e._malloc=function(){return e.asm.w.apply(null,arguments)},e._rw_AnimInterpolator_currentAnim=function(){return e.asm.x.apply(null,arguments)},e._rw_Animation_duration=function(){return e.asm.y.apply(null,arguments)},e._rw_Animation_getNumNodes=function(){return e.asm.z.apply(null,arguments)},e._rw_Animation_keyframes=function(){return e.asm.A.apply(null,arguments)},e._rw_Animation_numFrames=function(){return e.asm.B.apply(null,arguments)},e._rw_Atomic_fromClump=function(){return e.asm.C.apply(null,arguments)},e._rw_Atomic_geometry=function(){return e.asm.D.apply(null,arguments)},e._rw_Atomic_getFrame=function(){return e.asm.E.apply(null,arguments)},e._rw_ChunkHeaderInfo_delete=function(){return e.asm.F.apply(null,arguments)},e._rw_ChunkHeaderInfo_new=function(){return e.asm.G.apply(null,arguments)},e._rw_ChunkHeaderInfo_type=function(){return e.asm.H.apply(null,arguments)},e._rw_Clump_atomics=function(){return e.asm.I.apply(null,arguments)},e._rw_Clump_destroy=function(){return e.asm.J.apply(null,arguments)},e._rw_Clump_getFrame=function(){return e.asm.K.apply(null,arguments)},e._rw_Clump_streamRead=function(){return e.asm.L.apply(null,arguments)},e._rw_Engine_init=function(){return e.asm.M.apply(null,arguments)},e._rw_Engine_open=function(){return e.asm.N.apply(null,arguments)},e._rw_Engine_start=function(){return e.asm.O.apply(null,arguments)},e._rw_Geometry_colors=function(){return e.asm.P.apply(null,arguments)},e._rw_Geometry_meshHeader=function(){return e.asm.Q.apply(null,arguments)},e._rw_Geometry_morphTargets=function(){return e.asm.R.apply(null,arguments)},e._rw_Geometry_numTexCoordSets=function(){return e.asm.S.apply(null,arguments)},e._rw_Geometry_numVertices=function(){return e.asm.T.apply(null,arguments)},e._rw_Geometry_texCoords=function(){return e.asm.U.apply(null,arguments)},e._rw_Image_bpp=function(){return e.asm.V.apply(null,arguments)},e._rw_Image_depth=function(){return e.asm.W.apply(null,arguments)},e._rw_Image_destroy=function(){return e.asm.X.apply(null,arguments)},e._rw_Image_hasAlpha=function(){return e.asm.Y.apply(null,arguments)},e._rw_Image_height=function(){return e.asm.Z.apply(null,arguments)},e._rw_Image_pixels=function(){return e.asm._.apply(null,arguments)},e._rw_Image_unindex=function(){return e.asm.$.apply(null,arguments)},e._rw_Image_width=function(){return e.asm.aa.apply(null,arguments)},e._rw_LLLink_next=function(){return e.asm.ba.apply(null,arguments)},e._rw_LinkList_end=function(){return e.asm.ca.apply(null,arguments)},e._rw_Material_color=function(){return e.asm.da.apply(null,arguments)},e._rw_Material_surfaceProps=function(){return e.asm.ea.apply(null,arguments)},e._rw_Material_texture=function(){return e.asm.fa.apply(null,arguments)},e._rw_Material_uvAnim=function(){return e.asm.ga.apply(null,arguments)},e._rw_MeshHeader_flags=function(){return e.asm.ha.apply(null,arguments)},e._rw_MeshHeader_getMeshes=function(){return e.asm.ia.apply(null,arguments)},e._rw_MeshHeader_numMeshes=function(){return e.asm.ja.apply(null,arguments)},e._rw_Mesh_indices=function(){return e.asm.ka.apply(null,arguments)},e._rw_Mesh_material=function(){return e.asm.la.apply(null,arguments)},e._rw_Mesh_numIndices=function(){return e.asm.ma.apply(null,arguments)},e._rw_MorphTarget_normals=function(){return e.asm.na.apply(null,arguments)},e._rw_MorphTarget_parent=function(){return e.asm.oa.apply(null,arguments)},e._rw_MorphTarget_vertices=function(){return e.asm.pa.apply(null,arguments)},e._rw_RasterLevels_Level_data=function(){return e.asm.qa.apply(null,arguments)},e._rw_RasterLevels_Level_height=function(){return e.asm.ra.apply(null,arguments)},e._rw_RasterLevels_Level_size=function(){return e.asm.sa.apply(null,arguments)},e._rw_RasterLevels_Level_width=function(){return e.asm.ta.apply(null,arguments)},e._rw_RasterLevels_format=function(){return e.asm.ua.apply(null,arguments)},e._rw_RasterLevels_levels=function(){return e.asm.va.apply(null,arguments)},e._rw_RasterLevels_numlevels=function(){return e.asm.wa.apply(null,arguments)},e._rw_Raster_d3d=function(){return e.asm.xa.apply(null,arguments)},e._rw_Raster_format=function(){return e.asm.ya.apply(null,arguments)},e._rw_Raster_formatHasAlpha=function(){return e.asm.za.apply(null,arguments)},e._rw_Raster_platform=function(){return e.asm.Aa.apply(null,arguments)},e._rw_Raster_toImage=function(){return e.asm.Ba.apply(null,arguments)},e._rw_StreamMemory_close=function(){return e.asm.Ca.apply(null,arguments)},e._rw_StreamMemory_delete=function(){return e.asm.Da.apply(null,arguments)},e._rw_StreamMemory_new=function(){return e.asm.Ea.apply(null,arguments)},e._rw_StreamMemory_open=function(){return e.asm.Fa.apply(null,arguments)},e._rw_SurfaceProperties_ambient=function(){return e.asm.Ga.apply(null,arguments)},e._rw_SurfaceProperties_diffuse=function(){return e.asm.Ha.apply(null,arguments)},e._rw_SurfaceProperties_specular=function(){return e.asm.Ia.apply(null,arguments)},e._rw_TexDictionary_destroy=function(){return e.asm.Ja.apply(null,arguments)},e._rw_TexDictionary_setCurrent=function(){return e.asm.Ka.apply(null,arguments)},e._rw_TexDictionary_streamRead=function(){return e.asm.La.apply(null,arguments)},e._rw_TexDictionary_textures=function(){return e.asm.Ma.apply(null,arguments)},e._rw_Texture_fromDict=function(){return e.asm.Na.apply(null,arguments)},e._rw_Texture_getAddressU=function(){return e.asm.Oa.apply(null,arguments)},e._rw_Texture_getAddressV=function(){return e.asm.Pa.apply(null,arguments)},e._rw_Texture_getFilter=function(){return e.asm.Qa.apply(null,arguments)},e._rw_Texture_name=function(){return e.asm.Ra.apply(null,arguments)},e._rw_Texture_raster=function(){return e.asm.Sa.apply(null,arguments)},e._rw_Texture_setCreateDummies=function(){return e.asm.Ta.apply(null,arguments)},e._rw_Texture_setLoadTextures=function(){return e.asm.Ua.apply(null,arguments)},e._rw_UVAnimCustomData_get=function(){return e.asm.Va.apply(null,arguments)},e._rw_UVAnimCustomData_name=function(){return e.asm.Wa.apply(null,arguments)},e._rw_UVAnimCustomData_nodeToUVChannel=function(){return e.asm.Xa.apply(null,arguments)},e._rw_UVAnimDictEntry_anim=function(){return e.asm.Ya.apply(null,arguments)},e._rw_UVAnimDictEntry_fromDict=function(){return e.asm.Za.apply(null,arguments)},e._rw_UVAnimDictionary_animations=function(){return e.asm._a.apply(null,arguments)},e._rw_UVAnimDictionary_destroy=function(){return e.asm.$a.apply(null,arguments)},e._rw_UVAnimDictionary_streamRead=function(){return e.asm.ab.apply(null,arguments)},e._rw_UVAnimKeyFrame_prev=function(){return e.asm.bb.apply(null,arguments)},e._rw_UVAnimKeyFrame_time=function(){return e.asm.cb.apply(null,arguments)},e._rw_UVAnimKeyFrame_uv=function(){return e.asm.db.apply(null,arguments)},e._rw_UVAnim_interp=function(){return e.asm.eb.apply(null,arguments)},e._rw_currentUVAnimDictionary_set=function(){return e.asm.fb.apply(null,arguments)},e._rw_d3d_D3dRaster_customFormat=function(){return e.asm.gb.apply(null,arguments)},e._rw_d3d_D3dRaster_format=function(){return e.asm.hb.apply(null,arguments)},e._rw_d3d_D3dRaster_hasAlpha=function(){return e.asm.ib.apply(null,arguments)},e._rw_d3d_D3dRaster_texture=function(){return e.asm.jb.apply(null,arguments)},e._rw_platform_set=function(){return e.asm.kb.apply(null,arguments)},e._rw_readChunkHeaderInfo=function(){return e.asm.lb.apply(null,arguments)},e.dynCall_v=function(){return e.asm.mb.apply(null,arguments)},e.dynCall_vi=function(){return e.asm.nb.apply(null,arguments)},e.asm=Re,e.then=function(t){if(ke)t(e);else{var a=e.onRuntimeInitialized;e.onRuntimeInitialized=function(){a&&a(),t(e)}}return e},ee=function e(){ke||Pe(),ke||(ee=e)},e.run=Pe,e.abort=Fe,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return w=!0,Pe(),e});e.exports=s}).call(this,a(75),"/")},function(e){e.exports=JSON.parse('{"iii":{"id":"GrandTheftAuto3","name":"Grand Theft Auto III","water":{"origin":[0,0,0,2048],"texture":"water_old"},"weather":{"names":["Sunny","Cloudy","Rainy","Foggy"],"periods":24},"paths":{"zon":"data/gta3.zon","dat":{"timecyc":"data/timecyc.dat","water":"data/waterpro.dat"},"ide":["generic","temppart/temppart","comroad/comroad","indroads/indroads","making/making","subroads/subroads","comntop/comntop","comnbtm/comnbtm","comse/comse","comsw/comsw","industne/industne","industnw/industnw","industse/industse","industsw/industsw","landne/landne","landsw/landsw"],"ipl":["comntop/comNtop","comnbtm/comNbtm","comse/comSE","comsw/comSW","industne/industNE","industnw/industNW","industse/industSE","industsw/industSW","landne/landne","landsw/landsw","overview","props"]},"ipl_stream":{},"img":{"version":1,"extra":[]},"basisTextures":false,"map":{"name":"Liberty City","interiors":[]}},"vc":{"id":"GrandTheftAutoViceCity","name":"Grand Theft Auto: Vice City","water":{"origin":[-400,0,6,2048],"texture":"waterclear256"},"weather":{"names":["Sunny","Cloudy","Rainy","Foggy","Extra Sunny","Hurricane"],"periods":24},"paths":{"zon":"data/navig.zon","dat":{"timecyc":"data/timecyc.dat","water":"data/WATERPRO.DAT"},"ide":["generic","airport/airport","airportN/airportN","bank/bank","bridge/bridge","cisland/cisland","club/club","concerth/concerth","docks/docks","downtown/downtown","downtows/downtows","golf/golf","haiti/haiti","haitiN/haitiN","hotel/hotel","islandsf/islandsf","lawyers/lawyers","littleha/littleha","mall/mall","mansion/mansion","nbeachbt/nbeachbt","nbeach/nbeach","nbeachw/nbeachw","oceandn/oceandN","oceandrv/oceandrv","stadint/stadint","starisl/starisl","stripclb/stripclb","washintn/washintn","washints/washints","yacht/yacht"],"ipl":["airport/airport","airportN/airportN","bank/bank","bridge/bridge","cisland/cisland","club/CLUB","concerth/concerth","docks/docks","downtown/downtown","downtows/downtows","golf/golf","haiti/haiti","haitiN/haitin","hotel/hotel","islandsf/islandsf","lawyers/lawyers","littleha/littleha","mall/mall","mansion/mansion","nbeachbt/nbeachbt","nbeach/nbeach","nbeachw/nbeachw","oceandn/oceandN","oceandrv/oceandrv","stadint/stadint","starisl/starisl","stripclb/stripclb","washintn/washintn","washints/washints","yacht/yacht"]},"ipl_stream":{},"img":{"version":1,"extra":[]},"basisTextures":false,"map":{"name":"Vice City","interiors":[["Ocean View Hotel",1,""],["Vercetti Estate",2,""],["El Banco Corrupto Grande",3,""],["North Point Mall",4,""],["Pole Position Club",5,""],["Ken Rosenberg\'s office",6,""],["Cafe Robina",7,""],["Love Fist concert hall",8,""],["Love Fist recording studio",9,""],["Shooting Range",10,""],["Apartment 3C",11,"a"],["Greasy Choppers",11,"b"],["VCPD HQ",12,"a"],["Auntie Poulet\'s",12,"b"],["Dirt Ring",14,""],["Bloodring",15,""],["Hotring",16,""],["The Malibu Club",17,""],["Print Works",18,""]]}},"sa":{"id":"GrandTheftAutoSanAndreas","name":"Grand Theft Auto: San Andreas","water":{"origin":[0,0,0,3000],"texture":"waterclear256"},"weather":{"names":["Los Santos: Extra Sunny","Los Santos: Sunny","Los Santos: Extra Sunny Smog","Los Santos: Sunny Smog","Los Santos: Cloudy","San Fierro: Sunny","San Fierro: Extra Sunny","San Fierro: Cloudy","San Fierro: Rainy","San Fierro: Foggy","Las Venturas: Sunny","Las Venturas: Extra Sunny","Las Venturas: Cloudy","Countryside: Extra Sunny","Countryside: Sunny","Countryside: Cloudy","Countryside: Rainy","Desert: Extra Sunny","Desert: Sunny","Desert: Sandstorm","Underwater","Interior A","Interior B"],"periods":8},"paths":{"zon":"data/info.zon","dat":{"timecyc":"data/timecycp.dat","water":"data/water.dat"},"ide":["country/countn2","country/countrye","country/countryN","country/countryS","country/countryW","country/counxref","generic/barriers","generic/dynamic2","generic/dynamic","generic/multiobj","generic/procobj","generic/vegepart","interior/gen_int1","interior/gen_int2","interior/gen_int3","interior/gen_int4","interior/gen_int5","interior/gen_intb","interior/int_cont","interior/int_LA","interior/int_SF","interior/int_veg","interior/propext","interior/props2","interior/props","interior/savehous","interior/stadint","LA/LAe2","LA/LAe","LA/LAhills","LA/LAn2","LA/LAn","LA/LAs2","LA/LAs","LA/LAw2","LA/LAw","LA/LaWn","LA/LAxref","leveldes/leveldes","leveldes/levelmap","leveldes/levelxre","leveldes/seabed","SF/SFe","SF/SFn","SF/SFSe","SF/SFs","SF/SFw","SF/SFxref","txd","vegas/vegasE","vegas/VegasN","vegas/VegasS","vegas/VegasW","vegas/vegaxref","veh_mods/veh_mods"],"ipl":["Audiozon","country/countn2","country/countrye","country/countryN","country/countryS","country/countryw","cull","interior/gen_int1","interior/gen_int2","interior/gen_int3","interior/gen_int4","interior/gen_int5","interior/gen_intb","interior/int_cont","interior/int_LA","interior/int_SF","interior/int_veg","interior/savehous","interior/stadint","LA/LAe2","LA/LAe","LA/LAhills","LA/LAn2","LA/LAn","LA/LAs2","LA/LAs","LA/LAw2","LA/LAw","LA/LaWn","leveldes/leveldes","leveldes/levelmap","leveldes/seabed","occluint","occlu","occluLA","occlusf","occluveg","paths2","paths3","paths4","paths5","paths","SF/SFe","SF/SFn","SF/SFSe","SF/SFs","SF/SFw","tunnels","vegas/vegasE","vegas/vegasN","vegas/vegasS","vegas/vegasW","vegas/vegaxref"]},"ipl_stream":{"countn2":9,"countrye":14,"countryn":4,"countrys":5,"countryw":9,"lae2":7,"lae":6,"lahills":5,"lan2":4,"lan":3,"las2":5,"las":6,"law2":5,"lawn":4,"law":6,"levelmap":1,"seabed":1,"sfe":4,"sfn":3,"sfse":7,"sfs":9,"sfw":6,"vegase":9,"vegasn":9,"vegass":6,"vegasw":12,"gen_int2":1,"gen_int3":1,"gen_int4":3,"gen_int5":8,"gen_intb":1,"int_la":4,"int_sf":1,"int_veg":4,"savehous":2,"stadint":1},"img":{"version":2,"extra":["gta_int"]},"basisTextures":true,"map":{"name":"San Andreas","interiors":[["Sindacco Abattoir",1,"ABATOIR"],["Ammu-Nation",1,"AMMUN1"],["TransFender",1,"CARMOD1"],["World of Coq",1,"FDREST1"],["Denise\'s",1,"GF1"],["Shamal interior",1,"JETINT"],["Sub Urban",1,"LACS1"],["House",1,"LAHS1B"],["Caligula\'s Casino",1,"MAFCAS"],["Penthouse Suites",1,"MAFCAS2"],["Warehouse",1,"SMASHTV"],["Hotel Suite",1,"SVVGHO1"],["Sweet\'s House",1,"SWEETS"],["Truck Stop",1,"TSDINER"],["Wu Zi Mu\'s",1,"WUZIBET"],["Barber",2,"BARBERS"],["B Dup\'s Crack Palace",2,"BDUPS1"],["Loco Low Co.",2,"CARMOD2"],["Smoke\'s Crack Palace",2,"CARTER"],["Katie\'s",2,"GF2"],["House",2,"LAHS1A"],["Strip Club",2,"LASTRIP"],["Ryder\'s Place",2,"RYDERS"],["Hotel Suite",2,"SVVGHO2"],["House",2,"VGHSB1"],["House",2,"VGHSB3"],["Barber",3,"BARBER2"],["B Dup\'s apartment",3,"BDUPS"],["Bike School",3,"BIKESCH"],["Whore House",3,"BROTHL1"],["The Johnson House",3,"CARLS"],["Wheel Arch Angels",3,"CARMOD3"],["Pro-Laps",3,"CSSPRT"],["Driving School",3,"DRIVES"],["Driving School",3,"DRIVES2"],["Inside Track Betting",3,"GENOTB"],["Helena\'s",3,"GF3"],["House",3,"LAHSB4"],["OG Loc\'s",3,"OGLOCS"],["Planning Department",3,"PAPER"],["The Pleasure Domes",3,"PDOMES"],["The Pleasure Domes",3,"PDOMES2"],["LVPD HQ",3,"POLICE3"],["Sex Shop",3,"SEXSHOP"],["Strip Club",3,"STRIP2"],["Blastin\' Fools Records studio",3,"STUDIO"],["Tattoo Parlor",3,"TATTO3"],["Ammu-Nation",4,"AMMUN2"],["Diner",4,"DINER1"],["Dirt Stadium",4,"DIRBIKE"],["Michelle\'s",4,"GF4"],["House",4,"LAHS2A"],["House",4,"LAHSS6"],["House",4,"SFHSM2"],["24-7",4,"X711S2"],["Victim",5,"CSDESGN"],["Diner",5,"DINER2"],["Pizza Stack",5,"FDPIZA"],["Vagos Gang House",5,"GANG"],["Barbara\'s",5,"GF5"],["Ganton Gym",5,"GYM1"],["Crack Den",5,"LACRAK"],["House",5,"LAHSB3"],["Madd Dogg\'s Crib",5,"MADDOGS"],["Madd Dogg\'s Crib",5,"MDDOGS"],["House",5,"SFHSB1"],["Hotel Suite",5,"SVHOT1"],["House",5,"VGHSM2"],["Ammu-Nation",6,"AMMUN3"],["Ammu-Nation",6,"AMMUN5"],["Whore House",6,"BROTHEL"],["Millie\'s",6,"GF6"],["Cobra Martial Arts",6,"GYM2"],["House",6,"LAHSB1"],["LSPD HQ",6,"POLICE1"],["Zero\'s RC Shop",6,"RCPLAY"],["Secret Valley",6,"REST2"],["House",6,"SFHSS2"],["Safe House",6,"SVCUNT"],["Safe House",6,"SVSFBG"],["Safe House",6,"SVSFSM"],["24-7",6,"X7_11S"],["8-Track Stadium",7,"8TRACK"],["Ammu-Nation",7,"AMMUN4"],["Below the Belt Gym",7,"GYM3"],["House",7,"LAHSB2"],["Colonel Fuhrberger\'s",8,"BURHOUS"],["House",8,"SFHSS1"],["Safe House",8,"SVLAMD"],["Cluckin\' Bell",9,"FDCHICK"],["House",9,"LAHS2B"],["House",9,"SFHSB3"],["Motel room",9,"SVGNMT1"],["Safe House",9,"SVVGMD"],["Burger Shot",10,"FDBURG"],["SFPD HQ",10,"POLICE2"],["Motel room",10,"SVGNMT2"],["The Four Dragons",10,"TRICAS"],["Safe House",10,"SVSFMD"],["House",10,"VGHSM3"],["24-7",10,"X711S3"],["Bar",11,"BAR2"],["Safe House",11,"SVLASM"],["Barber",12,"BARBER3"],["Casino Floor",12,"CASINO2"],["Motel room",12,"MOROOM"],["Safe House",12,"SVLABIG"],["Didier Sachs",14,"CSEXL"],["Binco",15,"CSCHP"],["Jefferson Motel",15,"MOTEL1"],["House",15,"SFHSM1"],["House",15,"VGHSS1"],["House",15,"VGSHM2"],["House",15,"VGSHM3"],["House",15,"VGSHS2"],["Tattoo Parlor",16,"TATTOO"],["24-7",16,"X7_11C"],["Bar",17,"BAR1"],["Rusty Brown\'s",17,"FDDONUT"],["Tattoo Parlor",17,"TATTO2"],["24-7",17,"X7_11D"],["Atrium",18,"ATRIUME"],["Atrium",18,"ATRIUMX"],["Zip",18,"CLOTHGP"],["Warehouse",18,"GENWRHS"],["24-7 ",18,"X7_11B"]]}}}')},function(e,t,a){(function(t,r){var n,s=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var s,i=void 0!==(e=e||{})?e:{},o={};for(s in i)i.hasOwnProperty(s)&&(o[s]=i[s]);var l=[],c=!1,h=!1,d=!1,u=!1;c="object"==typeof window,h="function"==typeof importScripts,d="object"==typeof t&&"object"==typeof t.versions&&"string"==typeof t.versions.node&&!c&&!h,u=!c&&!d&&!h;var m,p,f,A,g="";function _(e){return i.locateFile?i.locateFile(e,g):g+e}d?(g=r+"/",m=function(e,t){var r;return f||(f=a(!function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}())),A||(A=a(!function(){var e=new Error("Cannot find module 'path'");throw e.code="MODULE_NOT_FOUND",e}())),e=A.normalize(e),r=f.readFileSync(e),t?r:r.toString()},p=function(e){var t=m(e,!0);return t.buffer||(t=new Uint8Array(t)),C(t.buffer),t},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),l=t.argv.slice(2),t.on("uncaughtException",(function(e){if(!(e instanceof Za))throw e})),t.on("unhandledRejection",Ka),i.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(m=function(e){return read(e)}),p=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(C("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?l=scriptArgs:void 0!==arguments&&(l=arguments),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(c||h)&&(h?g=self.location.href:document.currentScript&&(g=document.currentScript.src),n&&(g=n),g=0!==g.indexOf("blob:")?g.substr(0,g.lastIndexOf("/")+1):"",m=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},h&&(p=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var S=i.print||console.log.bind(console),b=i.printErr||console.warn.bind(console);for(s in o)o.hasOwnProperty(s)&&(i[s]=o[s]);o=null,i.arguments&&(l=i.arguments),i.thisProgram&&i.thisProgram,i.quit&&i.quit;var v,w,x={"f64-rem":function(e,t){return e%t},debugger:function(){}},T=(new Array(0),function(e){});i.wasmBinary&&(v=i.wasmBinary),i.noExitRuntime&&i.noExitRuntime,"object"!=typeof WebAssembly&&b("no native wasm support detected");var y=!1;function C(e,t){e||Ka("Assertion failed: "+t)}var M="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function U(e,t,a){for(var r=t+a,n=t;e[n]&&!(n>=r);)++n;if(n-t>16&&e.subarray&&M)return M.decode(e.subarray(t,n));for(var s="";t<n;){var i=e[t++];if(128&i){var o=63&e[t++];if(192!=(224&i)){var l=63&e[t++];if((i=224==(240&i)?(15&i)<<12|o<<6|l:(7&i)<<18|o<<12|l<<6|63&e[t++])<65536)s+=String.fromCharCode(i);else{var c=i-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&i)<<6|o)}else s+=String.fromCharCode(i)}return s}function k(e,t){return e?U(E,e,t):""}function D(e,t,a,r){if(!(r>0))return 0;for(var n=a,s=a+r-1,i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++i)),o<=127){if(a>=s)break;t[a++]=o}else if(o<=2047){if(a+1>=s)break;t[a++]=192|o>>6,t[a++]=128|63&o}else if(o<=65535){if(a+2>=s)break;t[a++]=224|o>>12,t[a++]=128|o>>6&63,t[a++]=128|63&o}else{if(a+3>=s)break;t[a++]=240|o>>18,t[a++]=128|o>>12&63,t[a++]=128|o>>6&63,t[a++]=128|63&o}}return t[a]=0,a-n}function I(e,t,a){return D(e,E,t,a)}function R(e){for(var t=0,a=0;a<e.length;++a){var r=e.charCodeAt(a);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++a)),r<=127?++t:t+=r<=2047?2:r<=65535?3:4}return t}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var B,P,E,F,V,O,N,L,G,H=65536;function j(e,t){return e%t>0&&(e+=t-e%t),e}function W(e){B=e,i.HEAP8=P=new Int8Array(e),i.HEAP16=F=new Int16Array(e),i.HEAP32=O=new Int32Array(e),i.HEAPU8=E=new Uint8Array(e),i.HEAPU16=V=new Uint16Array(e),i.HEAPU32=N=new Uint32Array(e),i.HEAPF32=L=new Float32Array(e),i.HEAPF64=G=new Float64Array(e)}var Z=5482368,z=239456,K=i.TOTAL_MEMORY||16777216;function X(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var a=t.func;"number"==typeof a?void 0===t.arg?i.dynCall_v(a):i.dynCall_vi(a,t.arg):a(void 0===t.arg?null:t.arg)}else t()}}(w=i.wasmMemory?i.wasmMemory:new WebAssembly.Memory({initial:K/H}))&&(B=w.buffer),K=B.byteLength,W(B),O[z>>2]=Z;var Y=[],$=[],q=[],Q=[];function J(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)re(i.preRun.shift());X(Y)}function ee(){X($)}function te(){X(q)}function ae(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)ne(i.postRun.shift());X(Q)}function re(e){Y.unshift(e)}function ne(e){Q.unshift(e)}var se=0,ie=null,oe=null;function le(e){se++,i.monitorRunDependencies&&i.monitorRunDependencies(se)}function ce(e){if(se--,i.monitorRunDependencies&&i.monitorRunDependencies(se),0==se&&(null!==ie&&(clearInterval(ie),ie=null),oe)){var t=oe;oe=null,t()}}i.preloadedImages={},i.preloadedAudios={};var he="data:application/octet-stream;base64,";function de(e){return String.prototype.startsWith?e.startsWith(he):0===e.indexOf(he)}var ue="basis_transcoder.wasm";function me(){try{if(v)return new Uint8Array(v);if(p)return p(ue);throw"both async and sync fetching of the wasm failed"}catch(e){Ka(e)}}function pe(){return v||!c&&!h||"function"!=typeof fetch?new Promise((function(e,t){e(me())})):fetch(ue,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ue+"'";return e.arrayBuffer()})).catch((function(){return me()}))}function fe(e){var t={env:e,wasi_unstable:e,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:x};function a(e,t){var a=e.exports;i.asm=a,ce()}function r(e){a(e.instance)}function n(e){return pe().then((function(e){return WebAssembly.instantiate(e,t)})).then(e,(function(e){b("failed to asynchronously prepare wasm: "+e),Ka(e)}))}if(le(),i.instantiateWasm)try{return i.instantiateWasm(t,a)}catch(e){return b("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(v||"function"!=typeof WebAssembly.instantiateStreaming||de(ue)||"function"!=typeof fetch)return n(r);fetch(ue,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,t).then(r,(function(e){b("wasm streaming compile failed: "+e),b("falling back to ArrayBuffer instantiation"),n(r)}))}))}(),{}}function Ae(e){return ja(e)}de(ue)||(ue=_(ue)),i.asm=function(e,t,a){return t.memory=w,t.table=new WebAssembly.Table({initial:342,maximum:342,element:"anyfunc"}),t.__memory_base=1024,t.__table_base=0,fe(t)},$.push({func:function(){Wa()}});var ge={};function _e(){throw y=!0,"Pure virtual function called!"}function Se(e,t,a){throw ge[e]={ptr:e,adjusted:[e],type:t,destructor:a,refcount:0,caught:!1,rethrown:!1},"uncaught_exception"in La?La.uncaught_exceptions++:La.uncaught_exceptions=1,e}function be(){return La.uncaught_exceptions}var ve={buffers:[null,[],[]],printChar:function(e,t){var a=ve.buffers[e];0===t||10===t?((1===e?S:b)(U(a,0)),a.length=0):a.push(t)},varargs:0,get:function(e){return ve.varargs+=4,O[ve.varargs-4>>2]},getStr:function(){return k(ve.get())},get64:function(){var e=ve.get();return ve.get(),e},getZero:function(){ve.get()}};function we(e,t){ve.varargs=t;try{return ve.getStreamFromFD(),ve.get(),ve.get(),ve.get(),ve.get(),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Ka(e),-e.errno}}function xe(e,t){ve.varargs=t;try{return ve.getStreamFromFD(),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Ka(e),-e.errno}}function Te(e,t,a,r){try{for(var n=0,s=0;s<a;s++){for(var i=O[t+8*s>>2],o=O[t+(8*s+4)>>2],l=0;l<o;l++)ve.printChar(e,E[i+l]);n+=o}return O[r>>2]=n,0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||Ka(e),-e.errno}}function ye(){return Te.apply(null,arguments)}function Ce(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function Me(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);Ue=e}var Ue=void 0;function ke(e){for(var t="",a=e;E[a];)t+=Ue[E[a++]];return t}var De={},Ie={},Re={},Be=48,Pe=57;function Ee(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=Be&&t<=Pe?"_"+e:e}function Fe(e,t){return e=Ee(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function Ve(e,t){var a=Fe(t,(function(e){this.name=t,this.message=e;var a=new Error(e).stack;void 0!==a&&(this.stack=this.toString()+"\n"+a.replace(/^Error(:[^\n]*)?\n/,""))}));return a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},a}var Oe=void 0;function Ne(e){throw new Oe(e)}var Le=void 0;function Ge(e){throw new Le(e)}function He(e,t,a){function r(t){var r=a(t);r.length!==e.length&&Ge("Mismatched type converter count");for(var n=0;n<e.length;++n)je(e[n],r[n])}e.forEach((function(e){Re[e]=t}));var n=new Array(t.length),s=[],i=0;t.forEach((function(e,t){Ie.hasOwnProperty(e)?n[t]=Ie[e]:(s.push(e),De.hasOwnProperty(e)||(De[e]=[]),De[e].push((function(){n[t]=Ie[e],++i===s.length&&r(n)})))})),0===s.length&&r(n)}function je(e,t,a){if(a=a||{},!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=t.name;if(e||Ne('type "'+r+'" must have a positive integer typeid pointer'),Ie.hasOwnProperty(e)){if(a.ignoreDuplicateRegistrations)return;Ne("Cannot register type '"+r+"' twice")}if(Ie[e]=t,delete Re[e],De.hasOwnProperty(e)){var n=De[e];delete De[e],n.forEach((function(e){e()}))}}function We(e,t,a,r,n){var s=Ce(a);je(e,{name:t=ke(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:n},argPackAdvance:8,readValueFromPointer:function(e){var r;if(1===a)r=P;else if(2===a)r=F;else{if(4!==a)throw new TypeError("Unknown boolean type size: "+t);r=O}return this.fromWireType(r[e>>s])},destructorFunction:null})}function Ze(e){if(!(this instanceof ot))return!1;if(!(e instanceof ot))return!1;for(var t=this.$$.ptrType.registeredClass,a=this.$$.ptr,r=e.$$.ptrType.registeredClass,n=e.$$.ptr;t.baseClass;)a=t.upcast(a),t=t.baseClass;for(;r.baseClass;)n=r.upcast(n),r=r.baseClass;return t===r&&a===n}function ze(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Ke(e){Ne(e.$$.ptrType.registeredClass.name+" instance already deleted")}var Xe=!1;function Ye(e){}function $e(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function qe(e){e.count.value-=1,0===e.count.value&&$e(e)}function Qe(e){return"undefined"==typeof FinalizationGroup?(Qe=function(e){return e},e):(Xe=new FinalizationGroup((function(e){for(var t=e.next();!t.done;t=e.next()){var a=t.value;a.ptr?qe(a):console.warn("object already deleted: "+a.ptr)}})),Ye=function(e){Xe.unregister(e.$$)},(Qe=function(e){return Xe.register(e,e.$$,e.$$),e})(e))}function Je(){if(this.$$.ptr||Ke(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=Qe(Object.create(Object.getPrototypeOf(this),{$$:{value:ze(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function et(){this.$$.ptr||Ke(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Ne("Object already scheduled for deletion"),Ye(this),qe(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function tt(){return!this.$$.ptr}var at=void 0,rt=[];function nt(){for(;rt.length;){var e=rt.pop();e.$$.deleteScheduled=!1,e.delete()}}function st(){return this.$$.ptr||Ke(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Ne("Object already scheduled for deletion"),rt.push(this),1===rt.length&&at&&at(nt),this.$$.deleteScheduled=!0,this}function it(){ot.prototype.isAliasOf=Ze,ot.prototype.clone=Je,ot.prototype.delete=et,ot.prototype.isDeleted=tt,ot.prototype.deleteLater=st}function ot(){}var lt={};function ct(e,t,a){if(void 0===e[t].overloadTable){var r=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||Ne("Function '"+a+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[r.argCount]=r}}function ht(e,t,a){i.hasOwnProperty(e)?((void 0===a||void 0!==i[e].overloadTable&&void 0!==i[e].overloadTable[a])&&Ne("Cannot register public name '"+e+"' twice"),ct(i,e,e),i.hasOwnProperty(a)&&Ne("Cannot register multiple overloads of a function with the same number of arguments ("+a+")!"),i[e].overloadTable[a]=t):(i[e]=t,void 0!==a&&(i[e].numArguments=a))}function dt(e,t,a,r,n,s,i,o){this.name=e,this.constructor=t,this.instancePrototype=a,this.rawDestructor=r,this.baseClass=n,this.getActualType=s,this.upcast=i,this.downcast=o,this.pureVirtualFunctions=[]}function ut(e,t,a){for(;t!==a;)t.upcast||Ne("Expected null or instance of "+a.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function mt(e,t){if(null===t)return this.isReference&&Ne("null is not a valid "+this.name),0;t.$$||Ne('Cannot pass "'+Qt(t)+'" as a '+this.name),t.$$.ptr||Ne("Cannot pass deleted object as a pointer of type "+this.name);var a=t.$$.ptrType.registeredClass;return ut(t.$$.ptr,a,this.registeredClass)}function pt(e,t){var a;if(null===t)return this.isReference&&Ne("null is not a valid "+this.name),this.isSmartPointer?(a=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,a),a):0;t.$$||Ne('Cannot pass "'+Qt(t)+'" as a '+this.name),t.$$.ptr||Ne("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&Ne("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass;if(a=ut(t.$$.ptr,r,this.registeredClass),this.isSmartPointer)switch(void 0===t.$$.smartPtr&&Ne("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?a=t.$$.smartPtr:Ne("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:a=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)a=t.$$.smartPtr;else{var n=t.clone();a=this.rawShare(a,$t((function(){n.delete()}))),null!==e&&e.push(this.rawDestructor,a)}break;default:Ne("Unsupporting sharing policy")}return a}function ft(e,t){if(null===t)return this.isReference&&Ne("null is not a valid "+this.name),0;t.$$||Ne('Cannot pass "'+Qt(t)+'" as a '+this.name),t.$$.ptr||Ne("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&Ne("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var a=t.$$.ptrType.registeredClass;return ut(t.$$.ptr,a,this.registeredClass)}function At(e){return this.fromWireType(N[e>>2])}function gt(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function _t(e){this.rawDestructor&&this.rawDestructor(e)}function St(e){null!==e&&e.delete()}function bt(e,t,a){if(t===a)return e;if(void 0===a.baseClass)return null;var r=bt(e,t,a.baseClass);return null===r?null:a.downcast(r)}function vt(){return Object.keys(yt).length}function wt(){var e=[];for(var t in yt)yt.hasOwnProperty(t)&&e.push(yt[t]);return e}function xt(e){at=e,rt.length&&at&&at(nt)}function Tt(){i.getInheritedInstanceCount=vt,i.getLiveInheritedInstances=wt,i.flushPendingDeletes=nt,i.setDelayFunction=xt}var yt={};function Ct(e,t){for(void 0===t&&Ne("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function Mt(e,t){return t=Ct(e,t),yt[t]}function Ut(e,t){return t.ptrType&&t.ptr||Ge("makeClassHandle requires ptr and ptrType"),!!t.smartPtrType!=!!t.smartPtr&&Ge("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Qe(Object.create(e,{$$:{value:t}}))}function kt(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var a=Mt(this.registeredClass,t);if(void 0!==a){if(0===a.$$.count.value)return a.$$.ptr=t,a.$$.smartPtr=e,a.clone();var r=a.clone();return this.destructor(e),r}function n(){return this.isSmartPointer?Ut(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Ut(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var s,i=this.registeredClass.getActualType(t),o=lt[i];if(!o)return n.call(this);s=this.isConst?o.constPointerType:o.pointerType;var l=bt(t,this.registeredClass,s.registeredClass);return null===l?n.call(this):this.isSmartPointer?Ut(s.registeredClass.instancePrototype,{ptrType:s,ptr:l,smartPtrType:this,smartPtr:e}):Ut(s.registeredClass.instancePrototype,{ptrType:s,ptr:l})}function Dt(){It.prototype.getPointee=gt,It.prototype.destructor=_t,It.prototype.argPackAdvance=8,It.prototype.readValueFromPointer=At,It.prototype.deleteObject=St,It.prototype.fromWireType=kt}function It(e,t,a,r,n,s,i,o,l,c,h){this.name=e,this.registeredClass=t,this.isReference=a,this.isConst=r,this.isSmartPointer=n,this.pointeeType=s,this.sharingPolicy=i,this.rawGetPointee=o,this.rawConstructor=l,this.rawShare=c,this.rawDestructor=h,n||void 0!==t.baseClass?this.toWireType=pt:r?(this.toWireType=mt,this.destructorFunction=null):(this.toWireType=ft,this.destructorFunction=null)}function Rt(e,t,a){i.hasOwnProperty(e)||Ge("Replacing nonexistant public symbol"),void 0!==i[e].overloadTable&&void 0!==a?i[e].overloadTable[a]=t:(i[e]=t,i[e].argCount=a)}function Bt(e,t){var a;if(e=ke(e),void 0!==i["FUNCTION_TABLE_"+e])a=i["FUNCTION_TABLE_"+e][t];else if("undefined"!=typeof FUNCTION_TABLE)a=FUNCTION_TABLE[t];else{var r=i["dynCall_"+e];void 0===r&&void 0===(r=i["dynCall_"+e.replace(/f/g,"d")])&&Ne("No dynCall invoker for signature: "+e),a=function(a){for(var r=[],n=1;n<e.length;++n)r.push("a"+n);var s="return function dynCall_"+e+"_"+t+"("+r.join(", ")+") {\n";return s+="    return dynCall(rawFunction"+(r.length?", ":"")+r.join(", ")+");\n",s+="};\n",new Function("dynCall","rawFunction",s)(a,t)}(r)}return"function"!=typeof a&&Ne("unknown function pointer with signature "+e+": "+t),a}var Pt=void 0;function Et(e){var t=Ga(e),a=ke(t);return Ha(t),a}function Ft(e,t){var a=[],r={};throw t.forEach((function e(t){r[t]||Ie[t]||(Re[t]?Re[t].forEach(e):(a.push(t),r[t]=!0))})),new Pt(e+": "+a.map(Et).join([", "]))}function Vt(e,t,a,r,n,s,i,o,l,c,h,d,u){h=ke(h),s=Bt(n,s),o&&(o=Bt(i,o)),c&&(c=Bt(l,c)),u=Bt(d,u);var m=Ee(h);ht(m,(function(){Ft("Cannot construct "+h+" due to unbound types",[r])})),He([e,t,a],r?[r]:[],(function(t){var a,n;t=t[0],n=r?(a=t.registeredClass).instancePrototype:ot.prototype;var i=Fe(m,(function(){if(Object.getPrototypeOf(this)!==l)throw new Oe("Use 'new' to construct "+h);if(void 0===d.constructor_body)throw new Oe(h+" has no accessible constructor");var e=d.constructor_body[arguments.length];if(void 0===e)throw new Oe("Tried to invoke ctor of "+h+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(d.constructor_body).toString()+") parameters instead!");return e.apply(this,arguments)})),l=Object.create(n,{constructor:{value:i}});i.prototype=l;var d=new dt(h,i,l,u,a,s,o,c),p=new It(h,d,!0,!1,!1),f=new It(h+"*",d,!1,!1,!1),A=new It(h+" const*",d,!1,!0,!1);return lt[e]={pointerType:f,constPointerType:A},Rt(m,i),[p,f,A]}))}function Ot(e,t){for(var a=[],r=0;r<e;r++)a.push(O[(t>>2)+r]);return a}function Nt(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function Lt(e,t,a,r,n,s){var i=Ot(t,a);n=Bt(r,n),He([],[e],(function(e){var a="constructor "+(e=e[0]).name;if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[t-1])throw new Oe("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.registeredClass.constructor_body[t-1]=function(){Ft("Cannot construct "+e.name+" due to unbound types",i)},He([],i,(function(r){return e.registeredClass.constructor_body[t-1]=function(){arguments.length!==t-1&&Ne(a+" called with "+arguments.length+" arguments, expected "+(t-1));var e=[],i=new Array(t);i[0]=s;for(var o=1;o<t;++o)i[o]=r[o].toWireType(e,arguments[o-1]);var l=n.apply(null,i);return Nt(e),r[0].fromWireType(l)},[]})),[]}))}function Gt(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var a=Fe(e.name||"unknownFunctionName",(function(){}));a.prototype=e.prototype;var r=new a,n=e.apply(r,t);return n instanceof Object?n:r}function Ht(e,t,a,r,n){var s=t.length;s<2&&Ne("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var i=null!==t[1]&&null!==a,o=!1,l=1;l<t.length;++l)if(null!==t[l]&&void 0===t[l].destructorFunction){o=!0;break}var c="void"!==t[0].name,h="",d="";for(l=0;l<s-2;++l)h+=(0!==l?", ":"")+"arg"+l,d+=(0!==l?", ":"")+"arg"+l+"Wired";var u="return function "+Ee(e)+"("+h+") {\nif (arguments.length !== "+(s-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(s-2)+" args!');\n}\n";o&&(u+="var destructors = [];\n");var m=o?"destructors":"null",p=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],f=[Ne,r,n,Nt,t[0],t[1]];for(i&&(u+="var thisWired = classParam.toWireType("+m+", this);\n"),l=0;l<s-2;++l)u+="var arg"+l+"Wired = argType"+l+".toWireType("+m+", arg"+l+"); // "+t[l+2].name+"\n",p.push("argType"+l),f.push(t[l+2]);if(i&&(d="thisWired"+(d.length>0?", ":"")+d),u+=(c?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+");\n",o)u+="runDestructors(destructors);\n";else for(l=i?1:2;l<t.length;++l){var A=1===l?"thisWired":"arg"+(l-2)+"Wired";null!==t[l].destructorFunction&&(u+=A+"_dtor("+A+"); // "+t[l].name+"\n",p.push(A+"_dtor"),f.push(t[l].destructorFunction))}return c&&(u+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),u+="}\n",p.push(u),Gt(Function,p).apply(null,f)}function jt(e,t,a,r,n,s,i,o){var l=Ot(a,r);t=ke(t),s=Bt(n,s),He([],[e],(function(e){var r=(e=e[0]).name+"."+t;function n(){Ft("Cannot call "+r+" due to unbound types",l)}o&&e.registeredClass.pureVirtualFunctions.push(t);var c=e.registeredClass.instancePrototype,h=c[t];return void 0===h||void 0===h.overloadTable&&h.className!==e.name&&h.argCount===a-2?(n.argCount=a-2,n.className=e.name,c[t]=n):(ct(c,t,r),c[t].overloadTable[a-2]=n),He([],l,(function(n){var o=Ht(r,n,e,s,i);return void 0===c[t].overloadTable?(o.argCount=a-2,c[t]=o):c[t].overloadTable[a-2]=o,[]})),[]}))}var Wt=[],Zt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function zt(e){e>4&&0==--Zt[e].refcount&&(Zt[e]=void 0,Wt.push(e))}function Kt(){for(var e=0,t=5;t<Zt.length;++t)void 0!==Zt[t]&&++e;return e}function Xt(){for(var e=5;e<Zt.length;++e)if(void 0!==Zt[e])return Zt[e];return null}function Yt(){i.count_emval_handles=Kt,i.get_first_emval=Xt}function $t(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=Wt.length?Wt.pop():Zt.length;return Zt[t]={refcount:1,value:e},t}}function qt(e,t){je(e,{name:t=ke(t),fromWireType:function(e){var t=Zt[e].value;return zt(e),t},toWireType:function(e,t){return $t(t)},argPackAdvance:8,readValueFromPointer:At,destructorFunction:null})}function Qt(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function Jt(e,t){switch(t){case 2:return function(e){return this.fromWireType(L[e>>2])};case 3:return function(e){return this.fromWireType(G[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function ea(e,t,a){var r=Ce(a);je(e,{name:t=ke(t),fromWireType:function(e){return e},toWireType:function(e,t){if("number"!=typeof t&&"boolean"!=typeof t)throw new TypeError('Cannot convert "'+Qt(t)+'" to '+this.name);return t},argPackAdvance:8,readValueFromPointer:Jt(t,r),destructorFunction:null})}function ta(e,t,a,r,n,s){var i=Ot(t,a);e=ke(e),n=Bt(r,n),ht(e,(function(){Ft("Cannot call "+e+" due to unbound types",i)}),t-1),He([],i,(function(a){var r=[a[0],null].concat(a.slice(1));return Rt(e,Ht(e,r,null,n,s),t-1),[]}))}function aa(e,t,a){switch(t){case 0:return a?function(e){return P[e]}:function(e){return E[e]};case 1:return a?function(e){return F[e>>1]}:function(e){return V[e>>1]};case 2:return a?function(e){return O[e>>2]}:function(e){return N[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function ra(e,t,a,r,n){t=ke(t),-1===n&&(n=4294967295);var s=Ce(a),i=function(e){return e};if(0===r){var o=32-8*a;i=function(e){return e<<o>>>o}}var l=-1!=t.indexOf("unsigned");je(e,{name:t,fromWireType:i,toWireType:function(e,a){if("number"!=typeof a&&"boolean"!=typeof a)throw new TypeError('Cannot convert "'+Qt(a)+'" to '+this.name);if(a<r||a>n)throw new TypeError('Passing a number "'+Qt(a)+'" from JS side to C/C++ side to an argument of type "'+t+'", which is outside the valid range ['+r+", "+n+"]!");return l?a>>>0:0|a},argPackAdvance:8,readValueFromPointer:aa(t,s,0!==r),destructorFunction:null})}function na(e,t,a){var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function n(e){var t=N,a=t[e>>=2],n=t[e+1];return new r(t.buffer,n,a)}je(e,{name:a=ke(a),fromWireType:n,argPackAdvance:8,readValueFromPointer:n},{ignoreDuplicateRegistrations:!0})}function sa(e,t){var a="std::string"===(t=ke(t));je(e,{name:t,fromWireType:function(e){var t,r=N[e>>2];if(a){var n=E[e+4+r],s=0;0!=n&&(s=n,E[e+4+r]=0);for(var i=e+4,o=0;o<=r;++o){var l=e+4+o;if(0==E[l]){var c=k(i);void 0===t?t=c:(t+=String.fromCharCode(0),t+=c),i=l+1}}0!=s&&(E[e+4+r]=s)}else{var h=new Array(r);for(o=0;o<r;++o)h[o]=String.fromCharCode(E[e+4+o]);t=h.join("")}return Ha(e),t},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var r="string"==typeof t;r||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||Ne("Cannot pass non-string to std::string");var n=(a&&r?function(){return R(t)}:function(){return t.length})(),s=ja(4+n+1);if(N[s>>2]=n,a&&r)I(t,s+4,n+1);else if(r)for(var i=0;i<n;++i){var o=t.charCodeAt(i);o>255&&(Ha(s),Ne("String has UTF-16 code units that do not fit in 8 bits")),E[s+4+i]=o}else for(i=0;i<n;++i)E[s+4+i]=t[i];return null!==e&&e.push(Ha,s),s},argPackAdvance:8,readValueFromPointer:At,destructorFunction:function(e){Ha(e)}})}function ia(e,t,a){var r,n;a=ke(a),2===t?(r=function(){return V},n=1):4===t&&(r=function(){return N},n=2),je(e,{name:a,fromWireType:function(e){for(var t=r(),a=N[e>>2],s=new Array(a),i=e+4>>n,o=0;o<a;++o)s[o]=String.fromCharCode(t[i+o]);return Ha(e),s.join("")},toWireType:function(e,a){var s=r(),i=a.length,o=ja(4+i*t);N[o>>2]=i;for(var l=o+4>>n,c=0;c<i;++c)s[l+c]=a.charCodeAt(c);return null!==e&&e.push(Ha,o),o},argPackAdvance:8,readValueFromPointer:At,destructorFunction:function(e){Ha(e)}})}function oa(e,t){je(e,{isVoid:!0,name:t=ke(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})}function la(e){return e||Ne("Cannot use deleted val. handle = "+e),Zt[e].value}function ca(e,t){var a=Ie[e];return void 0===a&&Ne(t+" has unknown type "+Et(e)),a}function ha(e,t,a){e=la(e),t=ca(t,"emval::as");var r=[],n=$t(r);return O[a>>2]=n,t.toWireType(r,e)}var da={};function ua(e){var t=da[e];return void 0===t?ke(e):t}var ma=[];function pa(e,t,a,r){(e=ma[e])(t=la(t),a=ua(a),null,r)}function fa(){return"object"==typeof globalThis?globalThis:Function("return this")()}function Aa(e){return 0===e?$t(fa()):(e=ua(e),$t(fa()[e]))}function ga(e){var t=ma.length;return ma.push(e),t}function _a(e,t,a){for(var r=new Array(e),n=0;n<e;++n)r[n]=ca(O[(t>>2)+n],"parameter "+n);return r}function Sa(e,t){for(var a=_a(e,t),r=a[0],n=r.name+"_$"+a.slice(1).map((function(e){return e.name})).join("_")+"$",s=["retType"],i=[r],o="",l=0;l<e-1;++l)o+=(0!==l?", ":"")+"arg"+l,s.push("argType"+l),i.push(a[1+l]);var c="return function "+Ee("methodCaller_"+n)+"(handle, name, destructors, args) {\n",h=0;for(l=0;l<e-1;++l)c+="    var arg"+l+" = argType"+l+".readValueFromPointer(args"+(h?"+"+h:"")+");\n",h+=a[l+1].argPackAdvance;for(c+="    var rv = handle[name]("+o+");\n",l=0;l<e-1;++l)a[l+1].deleteObject&&(c+="    argType"+l+".deleteObject(arg"+l+");\n");return r.isVoid||(c+="    return retType.toWireType(destructors, rv);\n"),c+="};\n",s.push(c),ga(Gt(Function,s).apply(null,i))}function ba(e){return e=ua(e),$t(i[e])}function va(e,t){return $t((e=la(e))[t=la(t)])}function wa(e){e>4&&(Zt[e].refcount+=1)}function xa(e){for(var t="",a=0;a<e;++a)t+=(0!==a?", ":"")+"arg"+a;var r="return function emval_allocator_"+e+"(constructor, argTypes, args) {\n";for(a=0;a<e;++a)r+="var argType"+a+" = requireRegisteredType(Module['HEAP32'][(argTypes >> 2) + "+a+'], "parameter '+a+'");\nvar arg'+a+" = argType"+a+".readValueFromPointer(args);\nargs += argType"+a+"['argPackAdvance'];\n";return r+="var obj = new constructor("+t+");\nreturn __emval_register(obj);\n}\n",new Function("requireRegisteredType","Module","__emval_register",r)(ca,i,$t)}var Ta={};function ya(e,t,a,r){e=la(e);var n=Ta[t];return n||(n=xa(t),Ta[t]=n),n(e,a,r)}function Ca(e){return $t(ua(e))}function Ma(e){Nt(Zt[e].value),zt(e)}function Ua(){i.abort()}function ka(){return P.length}function Da(){Ka("trap!")}function Ia(e,t,a){E.set(E.subarray(t,t+a),e)}function Ra(e){return i.___errno_location&&(O[i.___errno_location()>>2]=e),e}function Ba(e){Ka("OOM")}function Pa(e){try{return w.grow(e-B.byteLength+65535>>16),W(w.buffer),1}catch(e){}}function Ea(e){var t=ka();if(e>2147418112)return!1;for(var a=Math.max(t,16777216);a<e;)a=a<=536870912?j(2*a,65536):Math.min(j((3*a+2147483648)/4,65536),2147418112);return!!Pa(a)}Me(),Oe=i.BindingError=Ve(Error,"BindingError"),Le=i.InternalError=Ve(Error,"InternalError"),it(),Dt(),Tt(),Pt=i.UnboundTypeError=Ve(Error,"UnboundTypeError"),Yt();var Fa={},Va={c:Ka,A:T,i:Ae,I:_e,h:Se,z:be,m:Ra,y:we,x:xe,w:ye,v:We,N:Vt,M:Lt,g:jt,L:qt,u:ea,K:ta,f:ra,e:na,t:sa,J:ia,H:oa,s:ha,r:pa,b:zt,G:Aa,q:Sa,p:ba,k:va,l:wa,o:ya,j:Ca,n:Ma,d:Ua,F:ka,E:Ia,D:Ea,C:Da,B:Ba,a:z},Oa=i.asm(Fa,Va,B);i.asm=Oa;var Na,La=i.__ZSt18uncaught_exceptionv=function(){return i.asm.O.apply(null,arguments)},Ga=(i.___embind_register_native_and_builtin_types=function(){return i.asm.P.apply(null,arguments)},i.___errno_location=function(){return i.asm.Q.apply(null,arguments)},i.___getTypeName=function(){return i.asm.R.apply(null,arguments)}),Ha=i._free=function(){return i.asm.S.apply(null,arguments)},ja=i._malloc=function(){return i.asm.T.apply(null,arguments)},Wa=i.globalCtors=function(){return i.asm.ha.apply(null,arguments)};function Za(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function za(e){function t(){Na||(Na=!0,y||(ee(),te(),i.onRuntimeInitialized&&i.onRuntimeInitialized(),ae()))}e=e||l,se>0||(J(),se>0||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1),t()}),1)):t()))}function Ka(e){throw i.onAbort&&i.onAbort(e),S(e+=""),b(e),y=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(i.dynCall_ii=function(){return i.asm.U.apply(null,arguments)},i.dynCall_iidiiii=function(){return i.asm.V.apply(null,arguments)},i.dynCall_iii=function(){return i.asm.W.apply(null,arguments)},i.dynCall_iiii=function(){return i.asm.X.apply(null,arguments)},i.dynCall_iiiii=function(){return i.asm.Y.apply(null,arguments)},i.dynCall_iiiiii=function(){return i.asm.Z.apply(null,arguments)},i.dynCall_iiiiiiii=function(){return i.asm._.apply(null,arguments)},i.dynCall_iiiiiiiii=function(){return i.asm.$.apply(null,arguments)},i.dynCall_jiji=function(){return i.asm.aa.apply(null,arguments)},i.dynCall_v=function(){return i.asm.ba.apply(null,arguments)},i.dynCall_vi=function(){return i.asm.ca.apply(null,arguments)},i.dynCall_vii=function(){return i.asm.da.apply(null,arguments)},i.dynCall_viiii=function(){return i.asm.ea.apply(null,arguments)},i.dynCall_viiiii=function(){return i.asm.fa.apply(null,arguments)},i.dynCall_viiiiii=function(){return i.asm.ga.apply(null,arguments)},i.asm=Oa,i.then=function(e){if(Na)e(i);else{var t=i.onRuntimeInitialized;i.onRuntimeInitialized=function(){t&&t(),e(i)}}return i},oe=function e(){Na||za(),Na||(oe=e)},i.run=za,i.abort=Ka,i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return za(),e});e.exports=s}).call(this,a(75),"/")},function(e,t,a){"use strict";a.r(t),t.default="\nprecision mediump float; precision lowp sampler2DArray;\n\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n    Mat4x3 u_ViewMatrix;\n    Mat4x3 u_WorldMatrix;\n    vec4 u_Frustum;\n    vec4 u_AmbientColor;\n    vec4 u_SkyTopColor;\n    vec4 u_SkyBotColor;\n    vec4 u_WaterColor;\n    vec4 u_WaterOrigin;\n    float u_Time;\n};\n\nuniform sampler2DArray u_Texture;\n\n#ifdef SKY\nvarying vec3 v_Position;\n#else\nvarying vec4 v_Color;\nvarying vec3 v_TexCoord;\nvarying vec3 v_TexScroll;\n#endif\n\n#ifdef VERT\nlayout(location = 0) in vec3 a_Position;\n#ifdef SKY\nvoid main() {\n    gl_Position = vec4(a_Position, 1.0);\n    v_Position = a_Position;\n}\n#else\nlayout(location = 1) in vec4 a_Color;\nlayout(location = 2) in vec3 a_TexCoord;\nlayout(location = 3) in vec3 a_TexScroll;\n\nvoid main() {\n    gl_Position = Mul(u_Projection, Mul(_Mat4x4(u_ViewMatrix), vec4(a_Position, 1.0)));\n    v_Color = a_Color;\n    v_TexCoord = a_TexCoord;\n    v_TexScroll = a_TexScroll;\n}\n#endif\n#endif\n\n#ifdef FRAG\n#ifdef SKY\nvoid main() {\n    vec3 nearPlane = v_Position * u_Frustum.xyz;\n    vec3 cameraRay = Mul(u_WorldMatrix, vec4(nearPlane, 0.0));\n    vec3 cameraPos = Mul(u_WorldMatrix, vec4(vec3(0.0), 1.0));\n    float elevation = atan(cameraRay.y, length(cameraRay.zx)) * 180.0 / radians(180.0);\n    gl_FragColor = mix(u_SkyBotColor, u_SkyTopColor, clamp(abs(elevation / 45.0), 0.0, 1.0));\n    gl_FragDepth = 0.0;\n\n    float t = (u_WaterOrigin.y - cameraPos.y) / cameraRay.y;\n    vec3 oceanPlane = cameraPos + t * cameraRay;\n    if (t > 0.0 && (abs(oceanPlane.z - u_WaterOrigin.z) >= u_WaterOrigin.w - 32.0 ||\n                    abs(oceanPlane.x - u_WaterOrigin.x) >= u_WaterOrigin.w - 32.0)) {\n        vec2 uv = (oceanPlane.zx - u_WaterOrigin.zx) / 32.0;\n        vec4 t_Color = u_WaterColor;\n        t_Color *= texture(u_Texture, vec3(uv, 0));\n        gl_FragColor = mix(gl_FragColor, t_Color, t_Color.a);\n\n        // slightly overlap water tiles to avoid seam\n        vec4 clipOffset = 0.01 * vec4(0,0,1,0);\n        vec4 clipSpacePos = Mul(u_Projection, Mul(_Mat4x4(u_ViewMatrix), vec4(oceanPlane, 1.0)) + clipOffset);\n        float depthNDC = clipSpacePos.z / clipSpacePos.w;\n        gl_FragDepth = 0.5 + 0.5 * depthNDC;\n    }\n}\n#else\nvoid main() {\n#ifdef WATER\n    vec4 t_Color = u_WaterColor;\n#else\n    vec4 t_Color = v_Color;\n    t_Color.rgb += u_AmbientColor.rgb;\n#endif\n\n    if (v_TexCoord.z >= 0.0) {\n        vec3 uv = v_TexCoord;\n        if (v_TexScroll.z > 0.0)\n            uv.xy += v_TexScroll.xy * fract(u_Time / v_TexScroll.z);\n        t_Color *= texture(u_Texture, uv);\n    }\n\n#ifdef ALPHA_TEST\n    if (t_Color.a ALPHA_TEST) discard;\n#endif\n    gl_FragColor = t_Color;\n}\n#endif\n#endif\n"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(1),n=a(4),s=a(197);t.parseWaterPro=function(e,[t,a]){const n=e.getInt32(0,!0),i=[];for(let t=0;t<n;t++)i.push(e.getFloat32(4+4*t,!0));const o=[],l=r.vec3.fromValues(32,32,1),c=r.quat.identity(r.quat.create());for(let n=0;n<128;n++)for(let h=0;h<128;h++){const d=e.getUint8(5060+128*n+h);128&d||o.push({modelName:"water",interior:s.INTERIOR_EVERYWHERE,translation:r.vec3.fromValues(32*n+t-2048,32*h+a-2048,i[d]),scale:l,rotation:c})}return{id:"water",instances:o,interiors:[]}},t.waterDefinition={modelName:"water",txdName:"particle",drawDistance:1/0,flags:s.ObjectFlags.DISABLE_BACKFACE_CULLING,tobj:!1};const i=[r.vec3.fromValues(0,0,0),r.vec3.fromValues(0,1,0),r.vec3.fromValues(1,1,0),r.vec3.fromValues(1,0,0)],o=[r.vec2.fromValues(0,0),r.vec2.fromValues(0,1),r.vec2.fromValues(1,1),r.vec2.fromValues(1,0)];function l([e,t,a,n,s,i,o]){return{pos:r.vec3.fromValues(e,t,a),velocity:r.vec2.fromValues(n,s),waveHeight:o}}function c(e,t){e[e.length-1];const a=[l(e.slice(0,7)),l(e.slice(7,14)),l(e.slice(14,21))];return e.length>22&&a.push(l(e.slice(21,28))),{texName:`particle/${t}`,indices:new Uint16Array(3===a.length?[0,1,2]:[0,1,2,2,1,3]),vertices:a.length,fillPosition:(e,t)=>r.vec3.copy(e,a[t].pos),fillTexCoord:(e,t)=>r.vec2.set(e,a[t].pos[0]/32,a[t].pos[1]/32),fillColor:(e,t)=>n.colorCopy(e,n.TransparentBlack)}}t.waterMeshFragData=function(e){return{texName:`particle/${e}`,indices:new Uint16Array([0,1,2,0,2,3]),vertices:4,fillPosition:(e,t)=>r.vec3.copy(e,i[t]),fillTexCoord:(e,t)=>r.vec2.copy(e,o[t]),fillColor:(e,t)=>n.colorCopy(e,n.TransparentBlack)}},t.parseWater=function(e,t){const a=[],r=e.split("\n");for(const e of r){const r=e.trim().toLowerCase();if("processed"===r||""===r)continue;const n=r.split(/\s+/).map(Number);a.push(c(n,t))}return a}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(102)),s=a(194),i=a(331),o=a(333),l=r(a(334)),c=a(152),h=a(0);class d extends c.DataCacheIDName{addAsset(e,t=!1){this.add(e,e.name,e.id,t)}}class u extends c.DataCacheIDName{}class m extends c.DataCacheIDName{}class p extends c.DataCacheIDName{}class f extends c.DataCacheIDName{}class A extends c.DataCacheIDName{}class g extends c.DataCacheIDName{}class _ extends c.DataCacheIDName{}class S extends c.DataCacheIDName{}class b extends c.DataCacheIDName{}const v=new class{constructor(){this.assetCache=new d,this.modelCache=new i.ModelCache,this.textureCache=new i.TextureCache,this.buttonCache=new u,this.destructObjCache=new m,this.npcCache=new p,this.pickupCache=new f,this.platformCache=new A,this.playerCache=new g,this.simpleObjCache=new _,this.lightKitCache=new S,this.modelInfoCache=new b,this.jsps=[]}};async function w(e,t,a,r=!1){const s=await e.fetchData(`bfbb/xbox/${t}`),d=o.parseHIP(s);function u(e){const t=c.parseRWChunks(e.data)[0];h.assert(t.header.type===n.PluginID.ID_CLUMP);const a=c.createRWStreamFromChunk(t),s=n.Clump.streamRead(a),o=function(e){let t=[];for(let a=e.atomics.begin;!a.is(e.atomics.end);a=a.next){const e=n.Atomic.fromClump(a);for(let a=0;a<e.geometry.meshHeader.numMeshes;a++){const r=e.geometry.meshHeader.mesh(a).material.texture;if(r){const e=v.textureCache.getByName(i.textureNameRW3(r.name));e&&t.push(e)}}}return t}(s);v.modelCache.addClump(t,s,e.name,e.id,o,r)}function m(e){return{asset:e,models:[]}}function p(e){!function t(a){let r=v.modelCache.getByID(a);if(r)e.models.push(r);else{const e=v.modelInfoCache.getByID(a);if(e)for(let a=0;a<e.NumModelInst;a++)t(e.modelInst[a].ModelID);else console.log(`Can't find model/model info ID ${a.toString(16)}`)}}(e.asset.modelInfoID)}function f(e){if(v.pickupTable)for(let t=0;t<v.pickupTable.Count;t++){const a=v.pickupTable.entries[t];if(a.pickupHash===e.asset.pickupHash)return e.asset.ent.modelInfoID=a.modelID,void p(e.ent)}}!function(e){for(const t of d.layers)for(const a of t.assets)0!==a.data.byteLength&&(v.assetCache.addAsset(a,r),e[a.type]&&e[a.type](a))}({1112888398:e=>{const t=new c.DataStream(e.data,!0),n=l.readButtonAsset(t,a),s=m(n.ent);v.buttonCache.add({ent:s,asset:n},e.name,e.id,r)},1146311762:e=>{const t=new c.DataStream(e.data,!0),n=l.readDestructObjAsset(t,a),s=m(n.ent);v.destructObjCache.add({ent:s,asset:n},e.name,e.id,r)},1162761760:e=>{const t=new c.DataStream(e.data,!0);v.env=l.readEnvAsset(t)},1179600672:e=>{if(v.fog)return;const t=new c.DataStream(e.data,!0);v.fog=l.readFogAsset(t)},1246973984:e=>{const t=e.id;if(12513025===e.data.createDataView(0,4).getUint32(0,!0));else{u(e);const a=v.modelCache.getByID(e.id);a&&v.jsps.push({id:t,model:a})}},1280002388:e=>{const t=new c.DataStream(e.data,!0);v.lightKitCache.add(l.readLightKit(t),e.name,e.id,r)},1296649798:e=>{const t=new c.DataStream(e.data,!0);v.modelInfoCache.add(l.readModelInfo(t),e.name,e.id,r)},1297040460:e=>{u(e)},1347114320:e=>{const t=new c.DataStream(e.data,!0),n=l.readPickupAsset(t,a),s=m(n.ent);v.pickupCache.add({ent:s,asset:n},e.name,e.id,r)},1346978635:e=>{const t=new c.DataStream(e.data,!0);v.pickupTable=l.readPickupTable(t)},1346981972:e=>{const t=new c.DataStream(e.data,!0),a=l.readPipeInfoTable(t);for(const e of a){const t=v.modelCache.getByID(e.ModelHashID);t&&(t.pipeInfo=e)}},1347174740:e=>{const t=new c.DataStream(e.data,!0),n=l.readPlatformAsset(t,a),s=m(n.ent);v.platformCache.add({ent:s,asset:n},e.name,e.id,r)},1347180882:e=>{const t=new c.DataStream(e.data,!0),n=l.readPlayerAsset(t,a),s=m(n.ent);v.playerCache.add({ent:s,asset:n},e.name,e.id,r)},1381454936:e=>{!function(e){const t=new n.StreamMemory(e.data.createTypedArray(Uint8Array)),a=new n.ChunkHeaderInfo(t);h.assert(a.type===n.PluginID.ID_TEXDICTIONARY);const s=new n.TexDictionary(t);v.textureCache.addTexDictionary(s,e.name,e.id,r),t.delete(),a.delete(),s.delete()}(e)},1397312848:e=>{const t=new c.DataStream(e.data,!0),n=l.readSimpleObjAsset(t,a),s=m(n.ent);v.simpleObjCache.add({ent:s,asset:n},e.name,e.id,r)},1447644192:e=>{const t=new c.DataStream(e.data,!0),n=l.readNPCAsset(t,a),s=m(n.ent);v.npcCache.add({ent:s,asset:n},e.name,e.id,r)}});for(const e of v.buttonCache.data())p(e.ent);for(const e of v.destructObjCache.data())p(e.ent);for(const e of v.npcCache.data())p(e.ent);for(const e of v.pickupCache.data())f(e);for(const e of v.platformCache.data())p(e.ent);for(const e of v.simpleObjCache.data())p(e.ent);for(const e of v.playerCache.data())p(e.ent)}class x{constructor(e,t,a=!1){this.id=e,this.name=t,this.beta=a,this.id=this.id.toLowerCase()}static async initialize(e){this.initialised||(await n.init({gtaPlugins:!0,platform:n.Platform.PLATFORM_D3D8}),n.Texture.setCreateDummies(!0),n.Texture.setLoadTextures(!1),await s.initializeBasis(),await w(e,"boot.HIP",!1,!0),this.initialised=!0)}async createScene(e,t){await x.initialize(t.dataFetcher);const a=`${this.id.substr(0,2)}/${this.id}`;await w(t.dataFetcher,`${a}.HOP`,this.beta),await w(t.dataFetcher,`${a}.HIP`,this.beta);const r=new i.BFBBRenderer(e),n=r.renderHelper.getCache();for(;v.jsps.length;){const t=v.jsps.pop();r.renderers.push(new i.JSPRenderer(e,n,t))}for(const t of v.buttonCache.data())r.renderers.push(new i.EntRenderer(void 0,e,n,t.ent));for(const t of v.destructObjCache.data())r.renderers.push(new i.EntRenderer(void 0,e,n,t.ent));for(const t of v.npcCache.data())r.renderers.push(new i.EntRenderer(void 0,e,n,t.ent));for(const t of v.pickupCache.data())r.renderers.push(new i.PickupRenderer(e,n,t));for(const t of v.platformCache.data())r.renderers.push(new i.EntRenderer(void 0,e,n,t.ent));for(const t of v.simpleObjCache.data())r.renderers.push(new i.EntRenderer(void 0,e,n,t.ent));for(const t of v.playerCache.ids())if(!v.playerCache.isIDLocked(t)){const a=v.playerCache.getByID(t);r.renderers.push(new i.PlayerRenderer(e,n,a)),r.playerLightKit=v.lightKitCache.getByID(a.asset.lightKitID)}return v.env&&(r.objectLightKit=v.lightKitCache.getByID(v.env.objectLightKit),v.env=void 0),v.fog&&(r.fog=v.fog,v.fog=void 0),v.buttonCache.clear(),v.destructObjCache.clear(),v.npcCache.clear(),v.pickupCache.clear(),v.platformCache.clear(),v.playerCache.clear(),v.simpleObjCache.clear(),v.lightKitCache.clear(),v.modelInfoCache.clear(),v.assetCache.clear(),v.modelCache.clear(),v.textureCache.clear(),r}}x.initialised=!1;const T=["Main Menu",new x("MNU3","Main Menu"),"Bikini Bottom",new x("HB00","Prologue Cutscene"),new x("HB01","Bikini Bottom"),new x("HB02","SpongeBob's Pineapple"),new x("HB03","Squidward's Tiki"),new x("HB04","Patrick's Rock"),new x("HB05","Sandy's Treedome"),new x("HB06","Shady Shoals"),new x("HB07","Krusty Krab"),new x("HB08","Chum Bucket"),new x("HB09","Police Station"),new x("HB10","Theater"),"Jellyfish Fields",new x("JF01","Jellyfish Rock"),new x("JF02","Jellyfish Caves"),new x("JF03","Jellyfish Lake"),new x("JF04","Spork Mountain"),"Downtown Bikini Bottom",new x("BB01","Downtown Streets"),new x("BB02","Downtown Rooftops"),new x("BB03","Lighthouse"),new x("BB04","Sea Needle"),"Goo Lagoon",new x("GL01","Goo Lagoon Beach"),new x("GL02","Goo Lagoon Sea Caves"),new x("GL03","Goo Lagoon Pier"),"Poseidome",new x("B101","Poseidome"),"Rock Bottom",new x("RB01","Downtown Rock Bottom"),new x("RB02","Rock Bottom Museum"),new x("RB03","Trench of Advanced Darkness"),"Mermalair",new x("BC01","Mermalair Lobby"),new x("BC02","Mermalair Main Chamber"),new x("BC03","Mermalair Security Tunnel"),new x("BC04","Rolling Ball Area"),new x("BC05","Villain Containment Area"),"Sand Mountain",new x("SM01","Ski Lodge"),new x("SM02","Guppy Mound"),new x("SM03","Flounder Hill"),new x("SM04","Sand Mountain"),"Industrial Park",new x("B201","Industrial Park"),"Kelp Forest",new x("KF01","Kelp Forest"),new x("KF02","Kelp Swamp"),new x("KF04","Kelp Caves"),new x("KF05","Kelp Vines"),"Flying Dutchman's Graveyard",new x("GY01","Graveyard Lake"),new x("GY02","Graveyard of Ships"),new x("GY03","Dutchman's Ship"),new x("GY04","Flying Dutchman Battle"),"SpongeBob's Dream",new x("DB01","SpongeBob's Dream"),new x("DB02","Sandy's Dream"),new x("DB03","Squidward's Dream"),new x("DB04","Mr. Krabs' Dream"),new x("DB05","Patrick's Dream (unused)",!0),new x("DB06","Patrick's Dream"),"Chum Bucket Lab",new x("B301","MuscleBob Fight (unused)"),new x("B302","Kah-Rah-Tae!"),new x("B303","The Small Shall Rule... Or Not"),"SpongeBall Arena",new x("PG12","SpongeBall Arena")];t.sceneGroup={id:"bfbb",name:"SpongeBob SquarePants: Battle for Bikini Bottom",sceneDescs:T}},function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=r(a(332)),i=n(a(102)),o=n(a(11)),l=a(6),c=a(195),h=a(1),d=a(4),u=a(32),m=a(20),p=a(7),f=a(12),A=a(0),g=a(23),_=a(8),S=a(13),b=a(17),v=a(14),w=a(9),x=a(10),T=a(152),y=a(22);class C extends m.DeviceProgram{constructor(e={}){super(),this.both=s.default,e.PLAYER&&this.defines.set("PLAYER",e.PLAYER),e.SKY&&this.defines.set("SKY",e.SKY),e.SKY_DEPTH&&this.defines.set("SKY_DEPTH",e.SKY_DEPTH),e.USE_TEXTURE&&this.defines.set("USE_TEXTURE",e.USE_TEXTURE),e.USE_LIGHTING&&this.defines.set("USE_LIGHTING",e.USE_LIGHTING),e.USE_FOG&&this.defines.set("USE_FOG",e.USE_FOG),e.ALPHA_REF&&this.defines.set("ALPHA_REF",e.ALPHA_REF)}}C.a_Position=0,C.a_Normal=1,C.a_Color=2,C.a_TexCoord=3,C.ub_SceneParams=0,C.ub_ModelParams=1;class M{constructor(e,t,a,r,n){this.texture=e,this.name=t,this.filter=a,this.wrapS=r,this.wrapT=n,this.gfxTexture=null,this.gfxSampler=null,this.textureMapping=A.nArray(1,()=>new x.TextureMapping),this.isSetup=!1}setup(e){if(this.isSetup)return;this.gfxTexture=e.createTexture(l.makeTextureDescriptor2D(this.texture.pixelFormat,this.texture.width,this.texture.height,1));const t=e.createHostAccessPass();t.uploadTextureData(this.gfxTexture,0,[this.texture.levels[0]]),e.submitPass(t),this.gfxSampler=e.createSampler({magFilter:this.filter,minFilter:this.filter,mipFilter:0,minLOD:0,maxLOD:1e3,wrapS:this.wrapS,wrapT:this.wrapT});const a=this.textureMapping[0];a.width=this.texture.width,a.height=this.texture.height,a.flipY=!1,a.gfxTexture=this.gfxTexture,a.gfxSampler=this.gfxSampler,this.isSetup=!0}destroy(e){this.isSetup&&(null!==this.gfxTexture&&e.destroyTexture(this.gfxTexture),null!==this.gfxSampler&&e.destroySampler(this.gfxSampler),this.isSetup=!1)}}function U(e){switch(e){case i.Texture.Addressing.MIRROR:return 2;case i.Texture.Addressing.WRAP:return 1;case i.Texture.Addressing.CLAMP:case i.Texture.Addressing.BORDER:default:return 0}}t.TextureData=M;class k extends T.DataCacheIDName{addTexDictionary(e,t,a,r=!1){const n=i.Texture.fromDict(e.textures.begin),s=(n.filter,1),o=U(n.addressU),l=U(n.addressV),h=c.rwTexture(n,t,!1),d=new M(h,t,s,o,l);this.add(d,t,a,r)}}function D(e){return e+".RW3"}t.TextureCache=k,t.textureNameRW3=D;class I{constructor(e,t,a,r,n,s,i){this.positions=a,this.normals=r,this.texCoords=n,this.colors=s,this.baseColor=d.colorNewCopy(d.White);const{texture:o,color:c}=e.material;if(o&&i)for(const e of i)if(e.name===D(o.name)){this.textureData=e;break}if(c&&(this.baseColor=d.colorNewFromRGBA(c[0]/255,c[1]/255,c[2]/255,c[3]/255)),this.transparentColors=!1,this.transparentTexture=!1,this.textureData&&(function(e){if(A.assert(e.pixelFormat===l.GfxFormat.U8_RGBA_NORM||e.pixelFormat===l.GfxFormat.U8_RGB_NORM),e.pixelFormat===l.GfxFormat.U8_RGB_NORM)return!1;const t=e.levels[0];for(let e=0;e<t.length;e+=4)if(t[e+3]<255)return!0;return!1}(this.textureData.texture)||this.textureData.name.startsWith("shadow"))&&(this.transparentTexture=!0),c&&c[3]<255)this.transparentColors=!0;else if(this.colors)for(let e=0;e<this.colors.length;e+=4)if(this.colors[e+3]<255){this.transparentColors=!0;break}this.indexMap=Array.from(new Set(e.indices)).sort(),this.indices=u.filterDegenerateTriangleIndexBuffer(u.convertToTriangleIndexBuffer(t?1:0,e.indices.map(e=>this.indexMap.indexOf(e))))}get vertices(){return this.indexMap.length}distanceToCamera(e,t){let a=1/0;const r=t;for(let t=0;t<this.positions.length;t+=3){const n=this.positions[t+0],s=this.positions[t+1],i=this.positions[t+2],o=r[0]*n+r[4]*s+r[8]*i+r[12],l=r[1]*n+r[5]*s+r[9]*i+r[13],c=r[2]*n+r[6]*s+r[10]*i+r[14],h=e[0]-o,d=e[1]-l,u=e[2]-c,m=h*h+d*d+u*u;a=Math.min(m,a)}return Math.sqrt(a)}fillPosition(e,t){const a=this.indexMap[t];e[0]=this.positions[3*a+0],e[1]=this.positions[3*a+1],e[2]=this.positions[3*a+2]}fillNormal(e,t){const a=this.indexMap[t];null!==this.normals&&(e[0]=this.normals[3*a+0],e[1]=this.normals[3*a+1],e[2]=this.normals[3*a+2])}fillColor(e,t){const a=this.indexMap[t];if(d.colorCopy(e,this.baseColor),null!==this.colors){const t=this.colors[4*a+0]/255,r=this.colors[4*a+1]/255,n=this.colors[4*a+2]/255,s=this.colors[4*a+3]/255;e.r*=t,e.g*=r,e.b*=n,e.a*=s}}fillTexCoord(e,t){const a=this.indexMap[t];null!==this.texCoords&&(e[0]=this.texCoords[2*a+0],e[1]=this.texCoords[2*a+1])}}class R extends T.DataCacheIDName{addAtomic(e,t,a,r=!1){const n=e.geometry,s=n.morphTarget(0).vertices.slice(),i=n.morphTarget(0).normals?n.morphTarget(0).normals.slice():null,o=n.numTexCoordSets?n.texCoords(0).slice():null,l=n.colors?n.colors.slice():null,c=n.meshHeader,h=[];for(let e=0;e<c.numMeshes;e++)h.push(new I(c.mesh(e),c.tristrip,s,i,o,l,a));this.currentModelBeingAdded.meshes.push({frags:h,atomicStruct:t})}addClump(e,t,a,r,n,s=!1){for(let o=0,l=t.atomics.begin;o<e.children.length&&!l.is(t.atomics.end);l=l.next){const t=i.Atomic.fromClump(l);let c;do{c=e.children[o++]}while(c.header.type!==i.PluginID.ID_ATOMIC);const h=c.children[0];A.assert(h.header.type===i.PluginID.ID_STRUCT);const d=T.parseRWAtomic(h);this.currentModelBeingAdded=this.getByID(r),this.currentModelBeingAdded||(this.currentModelBeingAdded={meshes:[]},this.add(this.currentModelBeingAdded,a,r,s)),this.addAtomic(t,d,n,s),this.currentModelBeingAdded=void 0,t.delete()}t.delete()}}t.ModelCache=R;function B(e,t,a,r){return e.fill(a,t,t+r),r}function P(e,t,a){for(let r=0;r<8;r++)if(a.lightCount>r){const n=a.lightListArray[r];t+=S.fillVec4(e,t,n.type,n.radius,n.angle),t+=S.fillVec4(e,t,n.matrix[12],n.matrix[13],n.matrix[14]),t+=S.fillVec4(e,t,n.matrix[8],n.matrix[9],n.matrix[10]),t+=S.fillColor(e,t,n.color)}else t+=B(e,t,0,16);return 128}class E{constructor(e){this.parent=e,this.bbox=new f.AABB(1/0,1/0,1/0,-1/0,-1/0,-1/0),this.bboxModel=new f.AABB,this.modelMatrix=h.mat4.create(),this.transparent=!1,this.isCulled=!1,this.drawDistance=-1,this.renderers=[]}addRenderer(e){this.bbox.union(this.bbox,e.bbox),this.renderers.push(e)}prepareToRender(e){if(this.parent&&h.mat4.copy(this.modelMatrix,this.parent.modelMatrix),this.bboxModel.transform(this.bbox,this.modelMatrix),this.isCulled=!1,this.parent&&this.parent.isCulled)return void(this.isCulled=!0);if(!e.viewerInput.camera.frustum.contains(this.bboxModel))return void(this.isCulled=!0);const t=-1!=this.drawDistance?this.drawDistance:e.drawDistance;Math.sqrt(f.squaredDistanceFromPointToAABB(e.cameraPosition,this.bboxModel))>=t&&(this.isCulled=!0)}destroy(e){for(let t=0;t<this.renderers.length;t++)this.renderers[t].destroy(e);this.renderers.length=0}}function F(e){switch(e){case 1:return l.GfxBlendFactor.ZERO;case 2:return l.GfxBlendFactor.ONE;case 3:return l.GfxBlendFactor.SRC_COLOR;case 4:return l.GfxBlendFactor.ONE_MINUS_SRC_COLOR;case 5:return l.GfxBlendFactor.SRC_ALPHA;case 6:return l.GfxBlendFactor.ONE_MINUS_SRC_ALPHA;case 7:return l.GfxBlendFactor.DST_ALPHA;case 8:return l.GfxBlendFactor.ONE_MINUS_DST_ALPHA;case 9:return l.GfxBlendFactor.DST_COLOR;case 10:return l.GfxBlendFactor.ONE_MINUS_DST_COLOR;case 11:case 0:default:return-1}}t.BaseRenderer=E;class V extends E{constructor(e,t,a,r,n,s,i){super(e),this.frag=n,this.pipeInfo=s,this.megaStateFlags={},this.indices=n.indices.length,A.assert(this.indices>0);const o=new Float32Array(12*n.vertices),c=new Uint32Array(this.indices);let u=0,m=0;const f=h.vec3.create(),g=d.colorNewCopy(d.White),_=h.vec2.create();for(let e=0;e<n.vertices;e++)n.fillPosition(f,e),o[u++]=f[0],o[u++]=f[1],o[u++]=f[2],this.bbox.unionPoint(f),n.fillNormal(f,e),o[u++]=f[0],o[u++]=f[1],o[u++]=f[2],n.fillColor(g,e),u+=S.fillColor(o,u,g),n.fillTexCoord(_,e),o[u++]=_[0],o[u++]=_[1];for(let e=0;e<n.indices.length;e++)c[m++]=n.indices[e];this.vertexBuffer=b.makeStaticDataBuffer(t,2,o.buffer),this.indexBuffer=b.makeStaticDataBuffer(t,1,c.buffer);const w=[{location:C.a_Position,bufferIndex:0,format:l.GfxFormat.F32_RGB,bufferByteOffset:0},{location:C.a_Normal,bufferIndex:0,format:l.GfxFormat.F32_RGB,bufferByteOffset:12},{location:C.a_Color,bufferIndex:0,format:l.GfxFormat.F32_RGBA,bufferByteOffset:24},{location:C.a_TexCoord,bufferIndex:0,format:l.GfxFormat.F32_RG,bufferByteOffset:40}],x=[{byteStride:48,frequency:1}];this.inputLayout=t.createInputLayout({indexBufferFormat:l.GfxFormat.U32_R,vertexAttributeDescriptors:w,vertexBufferDescriptors:x});const T=[{buffer:this.vertexBuffer,byteOffset:0}],M={buffer:this.indexBuffer,byteOffset:0};this.inputState=t.createInputState(this.inputLayout,T,M),this.megaStateFlags={cullMode:0,depthWrite:!n.transparentTexture,depthCompare:y.reverseDepthForCompareMode(l.GfxCompareMode.LEQUAL)};let U,k=l.GfxBlendMode.ADD,D=l.GfxBlendFactor.ONE_MINUS_SRC_ALPHA,I=l.GfxBlendFactor.SRC_ALPHA,R=!r.SKY,B=!r.SKY,P=0;if(this.dualCull=!1,this.pipeInfo&&this.pipeInfo.SubObjectBits&i){switch(this.pipeInfo.PipeFlags.cullMode){case 1:this.megaStateFlags.cullMode=0;break;case 2:this.megaStateFlags.cullMode=2;break;case 3:this.dualCull=!0,this.megaStateFlags.cullMode=1}this.megaStateFlags.depthWrite=1!=this.pipeInfo.PipeFlags.zWriteMode;const e=F(this.pipeInfo.PipeFlags.dstBlend),t=F(this.pipeInfo.PipeFlags.srcBlend);-1!=e&&(D=e),-1!=t&&(I=t),this.pipeInfo.PipeFlags.noFog&&(R=!1),this.pipeInfo.PipeFlags.noLighting&&(B=!1),this.pipeInfo.PipeFlags.alphaCompare&&(P=this.pipeInfo.PipeFlags.alphaCompare/255)}R&&!r.USE_FOG&&(r.USE_FOG="1"),B&&!r.USE_LIGHTING&&(r.USE_LIGHTING="1"),P&&!r.ALPHA_REF&&(r.ALPHA_REF=P.toString()),v.setAttachmentStateSimple(this.megaStateFlags,{blendMode:k,blendDstFactor:D,blendSrcFactor:I}),this.transparent=n.transparentColors||n.transparentTexture,this.transparent?(U=128,this.megaStateFlags.depthWrite||U++):U=r.SKY?0:32,this.program=new C(r),this.gfxProgram=t.createProgram(this.program),this.sortKey=p.makeSortKey(U),this.filterKey=r.SKY?1:0}prepareRenderInst(e,t,a){const r=e.pushRenderInst();r.setInputLayoutAndState(this.inputLayout,this.inputState),r.drawIndexes(this.indices),r.setGfxProgram(this.gfxProgram);const n=this.megaStateFlags.cullMode,s=this.megaStateFlags.depthWrite;this.dualCull?this.megaStateFlags.cullMode=a?2:1:this.dualZWrite&&(this.megaStateFlags.depthWrite=a),r.setMegaStateFlags(this.megaStateFlags),this.megaStateFlags.cullMode=n,this.megaStateFlags.depthWrite=s,void 0!==this.frag.textureData&&r.setSamplerBindingsFromTextureMappings(this.frag.textureData.textureMapping),r.sortKey=p.setSortKeyDepth(this.sortKey,t),r.filterKey=this.filterKey}prepareToRender(e){if(super.prepareToRender(e),this.isCulled)return;const t=_.computeViewSpaceDepthFromWorldSpaceAABB(e.viewerInput.camera,this.bboxModel);this.prepareRenderInst(e.instManager,t,!1),(this.dualCull||this.dualZWrite)&&this.prepareRenderInst(e.instManager,t,!0)}destroy(e){super.destroy(e),e.destroyBuffer(this.indexBuffer),e.destroyBuffer(this.vertexBuffer),e.destroyInputLayout(this.inputLayout),e.destroyInputState(this.inputState),e.destroyProgram(this.gfxProgram),void 0!==this.frag.textureData&&this.frag.textureData.destroy(e)}}t.FragRenderer=V;class O extends E{constructor(e,t,a,r,n,s,i){super(e),this.mesh=n,this.pipeInfo=s,this.visible=!0,this.isAtomicVisible=!0;for(const e of n.frags){const n=Object.assign({},r);e.textureData&&(e.textureData.setup(t),n.USE_TEXTURE="1"),this.addRenderer(new V(this,t,a,n,e,s,i))}this.isAtomicVisible=0!=(4&this.mesh.atomicStruct.flags)}prepareToRender(e){if(this.visible&&(this.isAtomicVisible||e.hacks.invisibleAtomics)&&(super.prepareToRender(e),!this.isCulled))for(let t=0;t<this.renderers.length;t++)this.renderers[t].prepareToRender(e)}}t.MeshRenderer=O;const N=[{numUniformBuffers:2,numSamplers:1}];class L extends E{constructor(e,t,a,r,n,s=d.White){super(e),this.model=n,this.color=s;let i=1<<n.meshes.length-1;for(let e=0;e<n.meshes.length;e++)this.addRenderer(new O(this,t,a,r,n.meshes[e],n.pipeInfo,i)),i>>>=1}prepareToRender(e){if(0===this.color.a)return;if(super.prepareToRender(e),this.isCulled)return;const t=e.instManager.pushTemplateRenderInst();t.setBindingLayouts(N);let a=t.allocateUniformBuffer(C.ub_ModelParams,16);const r=t.mapUniformBufferF32(C.ub_ModelParams);a+=S.fillMatrix4x3(r,a,this.modelMatrix),a+=S.fillColor(r,a,this.color);for(let t=0;t<this.renderers.length;t++)this.renderers[t].prepareToRender(e);e.instManager.popTemplateRenderInst()}}t.ModelRenderer=L;t.JSPRenderer=class extends E{constructor(e,t,a){super(),this.jsp=a,this.modelRenderer=new L(this,e,t,{USE_LIGHTING:"0"},a.model),this.addRenderer(this.modelRenderer)}prepareToRender(e){super.prepareToRender(e),this.isCulled||this.modelRenderer.prepareToRender(e)}};class G extends E{constructor(e,t,a,r,n={}){super(e),this.ent=r,this.isSkydome=!1,this.skydomeLockY=!1,this.visible=0!=(1&r.asset.flags),this.color={r:r.asset.redMult,g:r.asset.greenMult,b:r.asset.blueMult,a:r.asset.seeThru};for(let e=0;e<r.asset.linkCount;e++){const t=r.asset.links[e];if(87===t.srcEvent&&306===t.dstEvent){this.isSkydome=!0,n.SKY="1",n.SKY_DEPTH=`${t.param[0]/8}`,this.skydomeLockY=1===t.param[1];break}}for(let e=0;e<r.models.length;e++)this.addRenderer(new L(this,t,a,n,r.models[e],this.color));const s=h.quat.create();T.quatFromYPR(s,r.asset.ang),h.mat4.fromRotationTranslationScale(this.modelMatrix,s,r.asset.pos,r.asset.scale)}update(e){this.isSkydome&&(this.modelMatrix[12]=e.cameraPosition[0],this.modelMatrix[14]=e.cameraPosition[2],this.skydomeLockY&&(this.modelMatrix[13]=e.cameraPosition[1]))}prepareToRender(e){if(this.update(e),0!==this.color.a&&(super.prepareToRender(e),!this.isCulled&&(this.visible||e.hacks.invisibleEntities)))for(let t=0;t<this.renderers.length;t++){const a=this.renderers[t];a.color=this.color,a.prepareToRender(e)}}destroy(e){for(let t=0;t<this.renderers.length;t++)this.renderers[t].destroy(e)}}t.EntRenderer=G;class H extends E{constructor(e,t,a,r={}){super(),this.pickup=a,r.USE_LIGHTING="0",this.drawDistance=144,this.entRenderer=new G(this,e,t,a.ent,r),this.addRenderer(this.entRenderer),h.mat4.copy(this.modelMatrix,this.entRenderer.modelMatrix)}static sceneUpdate(e){const t=3.141*e.deltaTime;h.mat4.rotateY(H.pickupOrientation,H.pickupOrientation,t)}update(e){const t=this.modelMatrix[12],a=this.modelMatrix[13],r=this.modelMatrix[14];h.mat4.copy(this.modelMatrix,H.pickupOrientation),this.modelMatrix[12]=t,this.modelMatrix[13]=a,this.modelMatrix[14]=r}prepareToRender(e){this.update(e),super.prepareToRender(e),this.isCulled||this.entRenderer.prepareToRender(e)}}t.PickupRenderer=H,H.pickupOrientation=h.mat4.create();t.PlayerRenderer=class extends E{constructor(e,t,a,r={}){super(),this.player=a,this.meshRenderers=[],r.PLAYER="1",this.entRenderer=new G(this,e,t,a.ent,r),this.addRenderer(this.entRenderer),this.entRenderer.renderers.forEach(e=>{e.renderers.forEach(e=>{this.meshRenderers.push(e)})}),this.entRenderer.color.a=1,14===this.meshRenderers.length&&(this.meshRenderers[4].visible=!0,this.meshRenderers[3].visible=!0,this.meshRenderers[2].visible=!0,this.meshRenderers[0].visible=!1,this.meshRenderers[1].visible=!1,this.meshRenderers[5].visible=!1,this.meshRenderers[6].visible=!1,this.meshRenderers[7].visible=!1,this.meshRenderers[8].visible=!1,this.meshRenderers[9].visible=!1,this.meshRenderers[10].visible=!1,this.meshRenderers[11].visible=!1,this.meshRenderers[12].visible=!1,this.meshRenderers[13].visible=!1),h.mat4.copy(this.modelMatrix,this.entRenderer.modelMatrix)}prepareToRender(e){e.hacks.player&&(super.prepareToRender(e),this.isCulled||this.entRenderer.prepareToRender(e))}};t.BFBBRenderer=class{constructor(e){this.renderers=[],this.renderTarget=new w.BasicRenderTarget,this.renderHacks={lighting:!0,fog:!0,skydome:!0,player:!0,invisibleEntities:!1,invisibleAtomics:!1},this.scratchVec3=h.vec3.create(),this.renderHelper=new g.GfxRenderHelper(e)}adjustCameraController(e){e.setSceneMoveSpeedMult(.025)}update(e){H.sceneUpdate(e)}prepareToRender(e,t,a){const r=this.renderHacks.fog&&this.fog;this.clearColor=r?this.fog.bkgndColor:d.TransparentBlack;const n=r?this.fog.fogColor:d.TransparentBlack,s=r?this.fog.fogStart:0,i=r?this.fog.fogStop:0;a.camera.setClipPlanes(1),h.mat4.getTranslation(this.scratchVec3,a.camera.worldMatrix);const o={device:e,instManager:this.renderHelper.renderInstManager,viewerInput:a,deltaTime:a.deltaTime/1e3,cameraPosition:this.scratchVec3,hacks:this.renderHacks,drawDistance:i?Math.min(i,1e3):1e3};this.update(o),this.renderHelper.pushTemplateRenderInst();const l=this.renderHelper.renderInstManager.pushTemplateRenderInst();l.setBindingLayouts(N);let c=l.allocateUniformBuffer(C.ub_SceneParams,292);const u=l.mapUniformBufferF32(C.ub_SceneParams);c+=S.fillMatrix4x4(u,c,a.camera.projectionMatrix),c+=S.fillMatrix4x3(u,c,a.camera.viewMatrix),c+=S.fillColor(u,c,n),c+=S.fillVec4(u,c,s,i),this.renderHacks.lighting&&this.objectLightKit?c+=P(u,c,this.objectLightKit):c+=B(u,c,0,128),this.renderHacks.player&&this.renderHacks.lighting&&this.playerLightKit?c+=P(u,c,this.playerLightKit):c+=B(u,c,0,128);for(let e=0;e<this.renderers.length;e++)this.renderers[e].prepareToRender(o);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=this.renderHelper.renderInstManager,r=e.createHostAccessPass();this.prepareToRender(e,r,t),e.submitPass(r),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const n=w.makeClearRenderPassDescriptor(!0,this.clearColor);if(this.renderHacks.skydome){const r=this.renderTarget.createRenderPass(e,t.viewport,n);a.setVisibleByFilterKeyExact(1),a.drawOnPassRenderer(e,r),e.submitPass(r)}const s=this.renderHacks.skydome?w.depthClearRenderPassDescriptor:n,i=this.renderTarget.createRenderPass(e,t.viewport,s);return a.setVisibleByFilterKeyExact(0),a.drawOnPassRenderer(e,i),this.renderHelper.renderInstManager.resetRenderInsts(),i}createPanels(){const e=new o.Panel;e.customHeaderBackgroundColor=o.COOL_BLUE_COLOR,e.setTitle(o.RENDER_HACKS_ICON,"Render Hacks");const t=new o.Checkbox("Lighting",this.renderHacks.lighting);t.onchanged=()=>{this.renderHacks.lighting=t.checked},e.contents.appendChild(t.elem);const a=new o.Checkbox("Fog",this.renderHacks.fog);a.onchanged=()=>{this.renderHacks.fog=a.checked},e.contents.appendChild(a.elem);const r=new o.Checkbox("Skydome",this.renderHacks.skydome);r.onchanged=()=>{this.renderHacks.skydome=r.checked},e.contents.appendChild(r.elem);const n=new o.Checkbox("Player",this.renderHacks.player);n.onchanged=()=>{this.renderHacks.player=n.checked},e.contents.appendChild(n.elem);const s=new o.Checkbox("Invisible Entities",this.renderHacks.invisibleEntities);s.onchanged=()=>{this.renderHacks.invisibleEntities=s.checked},e.contents.appendChild(s.elem);const i=new o.Checkbox("Invisible Atomics",this.renderHacks.invisibleAtomics);return i.onchanged=()=>{this.renderHacks.invisibleAtomics=i.checked},e.contents.appendChild(i.elem),e.setVisible(!0),[e]}destroy(e){this.renderHelper.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.renderers.length;t++)this.renderers[t].destroy(e);this.renderers.length=0}}},function(e,t,a){"use strict";a.r(t),t.default="\nprecision mediump float; precision lowp sampler2D;\n\nstruct Light {\n    float type;\n    float radius;\n    float angle;\n    float pad;\n    vec4 position;\n    vec4 direction;\n    vec4 color;\n};\n\n#define LIGHT_TYPE_AMBIENT     1.0 // rpLIGHTAMBIENT\n#define LIGHT_TYPE_DIRECTIONAL 2.0 // rpLIGHTDIRECTIONAL\n#define LIGHT_TYPE_POINT       3.0 // rpLIGHTPOINT\n#define LIGHT_TYPE_SPOT        4.0 // rpLIGHTSPOTSOFT\n\n#define LIGHT_COUNT 8\n\nlayout(row_major, std140) uniform ub_SceneParams {\n    Mat4x4 u_Projection;\n    Mat4x3 u_ViewMatrix;\n    vec4 u_FogColor;\n    vec4 u_FogParams;\n    Light u_ObjectLights[LIGHT_COUNT];\n    Light u_PlayerLights[LIGHT_COUNT];\n};\n\n#define u_FogStart (u_FogParams.x)\n#define u_FogStop (u_FogParams.y)\n\n#ifdef PLAYER\n#define u_Lights u_PlayerLights\n#else\n#define u_Lights u_ObjectLights\n#endif\n\nlayout(row_major, std140) uniform ub_ModelParams {\n    Mat4x3 u_ModelMatrix;\n    vec4 u_ModelColor;\n};\n\nuniform sampler2D u_Texture;\n\nvarying vec4 v_Position;\nvarying vec4 v_Color;\nvarying vec2 v_TexCoord;\nvarying vec3 v_LightColor;\n\n#ifdef VERT\nlayout(location = 0) in vec3 a_Position;\nlayout(location = 1) in vec3 a_Normal;\nlayout(location = 2) in vec4 a_Color;\nlayout(location = 3) in vec2 a_TexCoord;\n\nvoid main() {\n    v_Position = Mul(u_Projection, Mul(_Mat4x4(u_ViewMatrix), Mul(_Mat4x4(u_ModelMatrix), vec4(a_Position, 1.0))));\n    v_Color = a_Color;\n    v_TexCoord = a_TexCoord;\n\n    vec3 t_Normal = normalize(Mul(_Mat4x4(u_ModelMatrix), vec4(a_Normal, 0.0)).xyz);\n\n#ifdef USE_LIGHTING\n    if (USE_LIGHTING == 1) {\n        v_LightColor = vec3(0.0);\n\n        for (int i = 0; i < LIGHT_COUNT; i++) {\n            Light light = u_Lights[i];\n            if (light.type == 0.0) break;\n\n            vec3 lightColor = light.color.rgb; // alpha is ignored\n\n            if (light.type == LIGHT_TYPE_AMBIENT) {\n                v_LightColor += lightColor;\n            } else if (light.type == LIGHT_TYPE_DIRECTIONAL) {\n                vec3 lightDir = normalize(light.direction.xyz);\n                float diffuse = max(dot(t_Normal, lightDir), 0.0);\n                v_LightColor += diffuse * lightColor;\n                v_LightColor = min(v_LightColor, vec3(1.0));\n            }\n        }\n    }\n#endif\n\n    gl_Position = v_Position;\n}\n#endif\n\n#ifdef FRAG\nvoid main() {\n    float t_Distance = abs(v_Position.z);\n    if (u_FogColor.a > 0.0 && t_Distance > u_FogStop) discard;\n\n    vec4 t_Color = v_Color;\n\n#ifdef PLAYER\n    t_Color.rgb = vec3(1.0, 1.0, 1.0);\n#endif\n\n#ifdef USE_TEXTURE\n    if (USE_TEXTURE == 1)\n        t_Color *= texture(u_Texture, v_TexCoord);\n#endif\n\n    t_Color *= u_ModelColor;\n\n#ifdef ALPHA_REF\n    if (t_Color.a <= ALPHA_REF) discard;\n#endif\n\n#ifdef USE_LIGHTING\n    if (USE_LIGHTING == 1 && u_Lights[0].type != 0.0)\n        t_Color *= vec4(v_LightColor, 1.0);\n#endif\n\n#ifdef USE_FOG\n    if (USE_FOG == 1) {\n        if (u_FogColor.w > 0.0) {\n            float t_FogFactor = 1.0 - (u_FogStop - t_Distance)/(u_FogStop - u_FogStart);\n            t_FogFactor = clamp(t_FogFactor, 0.0, 1.0);\n\n            vec4 t_FogColor = u_FogColor;\n            t_FogColor.a = t_Color.a;\n\n            t_Color = mix(t_Color, t_FogColor, t_FogFactor);\n        }\n    }\n#endif\n\n#ifdef SKY\n    gl_FragDepth = float(SKY_DEPTH);\n#endif\n\n    gl_FragColor = t_Color;\n    \n}\n#endif"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(152);var n;function s(e,t){return e.find(e=>e.id===t)}!function(e){e[e.HIPA=1212764225]="HIPA",e[e.PACK=1346454347]="PACK",e[e.PVER=1347831122]="PVER",e[e.PFLG=1346784327]="PFLG",e[e.PCNT=1346588244]="PCNT",e[e.PCRT=1346589268]="PCRT",e[e.PMOD=1347243844]="PMOD",e[e.PLAT=1347174740]="PLAT",e[e.DICT=1145652052]="DICT",e[e.ATOC=1096044355]="ATOC",e[e.AINF=1095323206]="AINF",e[e.AHDR=1095255122]="AHDR",e[e.ADBG=1094992455]="ADBG",e[e.LTOC=1280593731]="LTOC",e[e.LINF=1279872582]="LINF",e[e.LHDR=1279804498]="LHDR",e[e.LDBG=1279541831]="LDBG",e[e.STRM=1398035021]="STRM",e[e.DHDR=1145586770]="DHDR",e[e.DPAK=1146110283]="DPAK"}(n||(n={})),t.findAssetByID=s,t.filterAssetsByType=function(e,t){return e.filter(e=>e.type===t)},t.parseHIP=function(e){const t=new r.DataStream(e,!1),a=[],i=[];function o(){const e=t.readString();return t.align(2),e}function l(e,a){for(;t.offset<e;){const e=t.readUInt32(),r=t.readUInt32(),n=t.offset+r;a[e]&&a[e](n),t.offset=n}}return l(t.length,{[n.DICT]:r=>{l(r,{[n.ATOC]:r=>{l(r,{[n.AHDR]:r=>{const s=t.readUInt32(),i=t.readUInt32(),c=t.readUInt32(),h=t.readUInt32(),d=(t.readUInt32(),t.readUInt32(),e.subarray(c,h));let u="";l(r,{[n.ADBG]:()=>{t.readUInt32();u=o();o(),t.readUInt32()}}),a.push({id:s,type:i,name:u,data:d})}})},[n.LTOC]:e=>{let r=0;l(e,{[n.LHDR]:e=>{const n=t.readUInt32(),o=t.readUInt32(),l=[];for(let e=0;e<o;e++){const e=t.readUInt32(),n=s(a,e);void 0===n?console.warn(`Couldn't find asset ${e} in layer ${r}`):l.push(n)}i.push({type:n,assets:l}),r++}})}})}}),{assets:a,layers:i}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){for(let a=0;a<t.linkCount;a++){const a=e.readUInt16(),r=e.readUInt16(),n=e.readUInt32(),s=[];for(let t=0;t<4;t++)s.push(e.readFloat());const i=e.readUInt32(),o=e.readUInt32();t.links.push({srcEvent:a,dstEvent:r,dstAssetID:n,param:s,paramWidgetAssetID:i,chkAssetID:o})}}function n(e){return{id:e.readUInt32(),baseType:e.readUInt8(),linkCount:e.readUInt8(),baseFlags:e.readUInt16(),links:[]}}function s(e,t){const{id:a,baseType:r,linkCount:s,baseFlags:i,links:o}=n(e),l=e.readUInt8(),c=e.readUInt8(),h=e.readUInt8(),d=e.readUInt8();let u=0;return t||(u=e.readUInt8(),e.align(4)),{id:a,baseType:r,linkCount:s,baseFlags:i,links:o,flags:l,subtype:c,pflags:h,moreFlags:d,pad:u,surfaceID:e.readUInt32(),ang:e.readVec3(),pos:e.readVec3(),scale:e.readVec3(),redMult:e.readFloat(),greenMult:e.readFloat(),blueMult:e.readFloat(),seeThru:e.readFloat(),seeThruSpeed:e.readFloat(),modelInfoID:e.readUInt32(),animListID:e.readUInt32()}}var i,o;function l(e){const t=e.readUInt8(),a=e.readUInt8(),r=e.readUInt16();let n;const s=e.offset+44;switch(t){case i.ExtendRetract:n={ret_pos:e.readVec3(),ext_dpos:e.readVec3(),ext_tm:e.readFloat(),ext_wait_tm:e.readFloat(),ret_tm:e.readFloat(),ret_wait_tm:e.readFloat()};break;case i.Orbit:n={center:e.readVec3(),w:e.readFloat(),h:e.readFloat(),period:e.readFloat()};break;case i.Spline:n={unknown:e.readInt32()};break;case i.MovePoint:n={flags:e.readUInt32(),mp_id:e.readUInt32(),speed:e.readFloat()};break;case i.Mechanism:n={type:e.readUInt8(),flags:e.readUInt8(),sld_axis:e.readUInt8(),rot_axis:e.readUInt8(),sld_dist:e.readFloat(),sld_tm:e.readFloat(),sld_acc_tm:e.readFloat(),sld_dec_tm:e.readFloat(),rot_dist:e.readFloat(),rot_tm:e.readFloat(),rot_acc_tm:e.readFloat(),rot_dec_tm:e.readFloat(),ret_delay:e.readFloat(),post_ret_delay:e.readFloat()};break;case i.Pendulum:{const t=e.readUInt8(),a=e.readUInt8(),r=[];r.push(e.readUInt8()),r.push(e.readUInt8()),n={flags:t,plane:a,pad:r,len:e.readFloat(),range:e.readFloat(),period:e.readFloat(),phase:e.readFloat()};break}case i.None:break;default:console.warn(`Unknown motion type ${t}`)}return e.offset=s,{type:t,use_banking:a,flags:r,data:n}}t.readBaseAsset=n,t.readEnvAsset=function(e){const{id:t,baseType:a,linkCount:s,baseFlags:i,links:o}=n(e),l={id:t,baseType:a,linkCount:s,baseFlags:i,links:o,bspAssetID:e.readUInt32(),startCameraAssetID:e.readUInt32(),climateFlags:e.readUInt32(),climateStrengthMin:e.readFloat(),climateStrengthMax:e.readFloat(),bspLightKit:e.readUInt32(),objectLightKit:e.readUInt32(),padF1:e.readFloat(),bspCollisionAssetID:e.readUInt32(),bspFXAssetID:e.readUInt32(),bspCameraAssetID:e.readUInt32(),bspMapperID:e.readUInt32(),bspMapperCollisionID:e.readUInt32(),bspMapperFXID:e.readUInt32(),loldHeight:e.readFloat()};return r(e,l),l},t.readFogAsset=function(e){const{id:t,baseType:a,linkCount:s,baseFlags:i,links:o}=n(e),l=e.readColor8(),c=e.readColor8(),h=e.readFloat(),d=e.readFloat(),u=e.readFloat(),m=e.readFloat(),p=e.readUInt8(),f=[];f.push(e.readUInt8()),f.push(e.readUInt8()),f.push(e.readUInt8());const A={id:t,baseType:a,linkCount:s,baseFlags:i,links:o,bkgndColor:l,fogColor:c,fogDensity:h,fogStart:d,fogStop:u,transitionTime:m,fogType:p,padFog:f};return r(e,A),A},t.readEntAsset=s,function(e){e[e.ExtendRetract=0]="ExtendRetract",e[e.Orbit=1]="Orbit",e[e.Spline=2]="Spline",e[e.MovePoint=3]="MovePoint",e[e.Mechanism=4]="Mechanism",e[e.Pendulum=5]="Pendulum",e[e.None=6]="None"}(i=t.MotionType||(t.MotionType={})),t.readMotionAsset=l,t.readButtonAsset=function(e,t){const a=s(e,t),n=e.readUInt32(),i=e.readUInt32(),o=e.readInt32(),c=e.readInt32(),h=e.readFloat(),d=e.readUInt32(),u=l(e);return r(e,a),{ent:a,modelPressedInfoID:n,actMethod:i,initButtonState:o,isReset:c,resetDelay:h,buttonActFlags:d,motion:u}},t.readDestructObjAsset=function(e,t){const a=s(e,t),n=e.readFloat(),i=e.readUInt32(),o=e.readUInt32(),l=e.readUInt32(),c=e.readUInt32(),h=e.readUInt8(),d=e.readUInt8(),u=[0,0];u[0]=e.readUInt8(),u[1]=e.readUInt8();const m=e.readFloat(),p=e.readFloat(),f=e.readUInt32(),A=e.readUInt32(),g=e.readUInt32(),_=e.readUInt32(),S=e.readUInt32(),b=e.readUInt32();return r(e,a),{ent:a,animSpeed:n,initAnimState:i,health:o,spawnItemID:l,dflags:c,collType:h,fxType:d,pad:u,blast_radius:m,blast_strength:p,shrapnelID_destroy:f,shrapnelID_hit:A,sfx_destroy:g,sfx_hit:_,hitModel:S,destroyModel:b}},t.readNPCAsset=function(e,t){const a=s(e,t),n=e.readInt32(),i=e.readInt32(),o=e.readInt32(),l=e.readUInt32(),c=e.readUInt32(),h=e.readUInt32();return r(e,a),{ent:a,npcFlags:n,npcModel:i,npcProps:o,movepoint:l,taskWidgetPrime:c,taskWidgetSecond:h}},t.readPickupAsset=function(e,t){const a=s(e,t),n=e.readUInt32(),i=e.readUInt16(),o=e.readUInt16();return r(e,a),{ent:a,pickupHash:n,pickupFlags:i,pickupValue:o}},function(e){e[e.Platform=0]="Platform",e[e.ExtendRetract=0]="ExtendRetract",e[e.Orbit=1]="Orbit",e[e.Spline=2]="Spline",e[e.MovePoint=3]="MovePoint",e[e.Mechanism=4]="Mechanism",e[e.Pendulum=5]="Pendulum",e[e.ConveyorBelt=6]="ConveyorBelt",e[e.Falling=7]="Falling",e[e.ForwardReverse=8]="ForwardReverse",e[e.Breakaway=9]="Breakaway",e[e.Springboard=10]="Springboard",e[e.TeeterTotter=11]="TeeterTotter",e[e.Paddle=12]="Paddle",e[e.FullyManipulable=13]="FullyManipulable"}(o=t.PlatformType||(t.PlatformType={})),t.readPlatformAsset=function(e,t){const a=s(e,t),n=e.readUInt8(),i=e.readUInt8(),c=e.readUInt16();let h;const d=e.offset+56;switch(n){case o.ExtendRetract:case o.Orbit:case o.Spline:case o.MovePoint:case o.Mechanism:case o.Pendulum:h={nodata:e.readInt32()};break;case o.ConveyorBelt:h={speed:e.readFloat()};break;case o.Falling:h={speed:e.readFloat(),bustModelID:e.readUInt32()};break;case o.ForwardReverse:h={fspeed:e.readFloat(),rspeed:e.readFloat(),ret_delay:e.readFloat(),post_ret_delay:e.readFloat()};break;case o.Breakaway:h={ba_delay:e.readFloat(),bustModelID:e.readUInt32(),reset_delay:e.readFloat(),breakflags:e.readUInt32()};break;case o.Springboard:{const t=[];t.push(e.readFloat()),t.push(e.readFloat()),t.push(e.readFloat());const a=e.readFloat(),r=[];r.push(e.readUInt32()),r.push(e.readUInt32()),r.push(e.readUInt32()),h={jmph:t,jmpbounce:a,animID:r,jmpdir:e.readVec3(),springflags:e.readUInt32()};break}case o.TeeterTotter:h={itilt:e.readFloat(),maxtilt:e.readFloat(),invmass:e.readFloat()};break;case o.Paddle:{const t=e.readInt32(),a=e.readInt32(),r=e.readFloat(),n=[];n.push(e.readFloat()),n.push(e.readFloat()),n.push(e.readFloat()),n.push(e.readFloat()),n.push(e.readFloat()),n.push(e.readFloat()),h={startOrient:t,countOrient:a,orientLoop:r,orient:n,paddleFlags:e.readUInt32(),rotateSpeed:e.readFloat(),accelTime:e.readFloat(),decelTime:e.readFloat(),hubRadius:e.readFloat()};break}case o.FullyManipulable:h={nothingyet:e.readInt32()};break;default:console.warn(`Unknown platform type ${n}`)}e.offset=d;const u=l(e);return r(e,a),{ent:a,type:n,pad:i,flags:c,data:h,motion:u}},t.readPlayerAsset=function(e,t){const a=s(e,t);return r(e,a),{ent:a,lightKitID:e.readUInt32()}},t.readSimpleObjAsset=function(e,t){const a=s(e,t),n=e.readFloat(),i=e.readUInt32(),o=e.readUInt8(),l=e.readUInt8();return e.align(4),r(e,a),{ent:a,animSpeed:n,initAnimState:i,collType:o,flags:l}},t.readLightKit=function(e){const t=e.readUInt32(),a=e.readUInt32(),r=e.readUInt32(),n=e.readUInt32(),s=[];for(let t=0;t<r;t++){const t=e.readUInt32(),a=e.readColor(),r=e.readRwMatrix(),n=e.readFloat(),i=e.readFloat(),o=e.readUInt32();s.push({type:t,color:a,matrix:r,radius:n,angle:i,platLight:o})}return{tagID:t,groupID:a,lightCount:r,lightList:n,lightListArray:s}},t.readModelInfo=function(e){const t=e.readUInt32(),a=e.readUInt32(),r=e.readUInt32(),n=e.readUInt32(),s=e.readUInt32(),i=[];for(let t=0;t<a;t++){const t=e.readUInt32(),a=e.readUInt16(),r=e.readUInt8(),n=e.readUInt8(),s=e.readVec3(),o=e.readVec3(),l=e.readVec3(),c=e.readVec3();i.push({ModelID:t,Flags:a,Parent:r,Bone:n,MatRight:s,MatUp:o,MatAt:l,MatPos:c})}return{Magic:t,NumModelInst:a,AnimTableID:r,CombatID:n,BrainID:s,modelInst:i}},t.readPickupTable=function(e){const t=e.readUInt32(),a=e.readUInt32(),r=[];for(let t=0;t<a;t++){const t=e.readUInt32(),a=e.readUInt8(),n=e.readUInt8(),s=e.readUInt16(),i=e.readUInt32(),o=e.readUInt32(),l=e.readUInt32();r.push({pickupHash:t,pickupType:a,pickupIndex:n,pickupFlags:s,quantity:i,modelID:o,animID:l})}return{Magic:t,Count:a,entries:r}};class c{constructor(e){this.flags=e}get zWriteMode(){return(12&this.flags)>>>2}get cullMode(){return(48&this.flags)>>>4}get noLighting(){return(192&this.flags)>>>6==1}get srcBlend(){return(3840&this.flags)>>>8}get dstBlend(){return(61440&this.flags)>>>12}get noFog(){return(65536&this.flags)>>>16==1}get unknownF00000(){return(15728640&this.flags)>>>20}get alphaCompare(){return(4278190080&this.flags)>>>24}}t.PipeInfoFlags=c,t.readPipeInfoTable=function(e){const t=e.readUInt32(),a=[];for(let r=0;r<t;r++){const t=e.readUInt32(),r=e.readUInt32(),n=new c(e.readUInt32());a.push({ModelHashID:t,SubObjectBits:r,PipeFlags:n})}return a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(5),n=a(336),s=a(199),i=a(42),o=a(4),l=a(0),c=a(338);class h{constructor(e,t){this.device=e,this.cache=t,this.data=[]}loadJObjRoot(e){for(let t=0;t<this.data.length;t++)if(this.data[t].root===e)return this.data[t];const t=new n.HSD_JObjRoot_Data(this.device,this.cache,e);return this.data.push(t),t}destroy(e){for(let t=0;t<this.data.length;t++)this.data[t].destroy(e)}}class d extends r.BasicGXRendererHelper{constructor(e){super(e),this.jobjRoots=[],this.modelCache=new h(e,this.getCache())}prepareToRender(e,t,a){const n=this.renderHelper.renderInstManager,s=this.renderHelper.pushTemplateRenderInst(),i=a.deltaTime/1e3*60;r.fillSceneParamsDataOnTemplate(s,a);for(let t=0;t<this.jobjRoots.length;t++){const r=this.jobjRoots[t];r.calcAnim(i),r.calcMtx(a),r.draw(e,this.renderHelper.renderInstManager,a)}n.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}destroy(e){super.destroy(e),this.modelCache.destroy(e)}}t.MeleeRenderer=d;const u="SuperSmashBrosMelee";class m{constructor(e,t=null,a=e,r=e){this.dataPath=e,this.rootName=t,this.id=a,this.name=r}async createScene(e,t){const a=t.dataFetcher,r=s.HSD_ArchiveParse(await a.fetchData(`${u}/${this.dataPath}`));console.log(r);const i=new d(e);if(null===this.rootName){const e=r.publics.find(e=>e.name.endsWith("_joint"));if(void 0===e)throw"whoops";this.rootName=e.name.slice(0,-6)}const o=new n.HSD_JObjRoot_Instance(i.modelCache.loadJObjRoot(s.HSD_JObjLoadJoint(r,l.assertExists(s.HSD_Archive_FindPublic(r,`${this.rootName}_joint`)))));return o.addAnimAll(s.HSD_AObjLoadAnimJoint(r,s.HSD_Archive_FindPublic(r,`${this.rootName}_animjoint`)),s.HSD_AObjLoadMatAnimJoint(r,s.HSD_Archive_FindPublic(r,`${this.rootName}_matanim_joint`)),s.HSD_AObjLoadShapeAnimJoint(r,s.HSD_Archive_FindPublic(r,`${this.rootName}_shapeanim_joint`))),i.jobjRoots.push(o),i}}class p{constructor(e,t,a){this.arcName=e,this.jointName=t,this.mdArc=a}}class f{constructor(e,t,a,r,n){this.plName=e,this.plArc=t,this.plAJData=a,this.variants=r,this.shareName=n,l.assert(1===t.publics.length),this.playerData=c.Melee_ftData_Load(t,t.publics[0]),this.figatrees=c.Melee_SplitDataAJ(a,this.playerData.subActionTable).map(e=>null!==e?c.Melee_figatree_Load(e):null)}}class A{constructor(e,t,a){this.data=t,this.variantIndex=a;const r=this.data.variants[this.variantIndex],i=`${this.data.shareName}${r.jointName}_Share_joint`,o=r.mdArc,c=l.assertExists(s.HSD_Archive_FindPublic(o,i)),h=e.loadJObjRoot(s.HSD_JObjLoadJoint(o,c));this.rootInst=new n.HSD_JObjRoot_Instance(h)}setSubActionName(e){const t=`${this.data.shareName}_Share_ACTION_${e}_figatree`,a=this.data.figatrees.find(e=>null!==e&&e.name===t);return void 0!==a&&(l.assert("Anim"===a.kind),function(e,t){l.assert("Anim"===t.kind),l.assert(t.aobj.length===e.allJObjs.length);for(let a=0;a<t.aobj.length;a++){const r=e.allJObjs[a],s=t.aobj[a];r.aobj=new n.HSD_AObj_Instance(s)}}(this.rootInst,a),!0)}}function g(e,t,a){const r=t.variants[a],n=`${t.shareName}${r.jointName}_Share_joint`,i=r.mdArc;return null===s.HSD_Archive_FindPublic(i,n)?null:new A(e,t,a)}async function _(e,t,a,r){const n=`Pl${t}`,i=`Ply${a}5K`,o=s.HSD_ArchiveParse(await e.fetchData(`${u}/${n}.dat`)),l=await e.fetchData(`${u}/${n}AJ.dat`),c=await Promise.all(r.map(async t=>{t.endsWith(".usd")||(t=`${t}.dat`);const a=s.HSD_ArchiveParse(await e.fetchData(`${u}/${n}${t}`)),r=t.slice(0,2);return new p(r,"Nr"===r?"":r,a)}));return new f(n,o,l,c,i)}function S(e,t){for(let a=0;a<t.length;a++)if(e.setSubActionName(t[a]))return}const b=[new class{constructor(e="Title",t="Title"){this.id=e,this.name=t}async createScene(e,t){const a=t.dataFetcher,r=s.HSD_ArchiveParse(await a.fetchData(`${u}/GmTtAll.usd`)),i=new d(e);o.colorFromRGBA8(i.clearRenderPassDescriptor.colorClearColor,640034559);const c=new n.HSD_JObjRoot_Instance(i.modelCache.loadJObjRoot(s.HSD_JObjLoadJoint(r,l.assertExists(s.HSD_Archive_FindPublic(r,"TtlBg_Top_joint")))));c.addAnimAll(s.HSD_AObjLoadAnimJoint(r,s.HSD_Archive_FindPublic(r,"TtlBg_Top_animjoint")),s.HSD_AObjLoadMatAnimJoint(r,s.HSD_Archive_FindPublic(r,"TtlBg_Top_matanim_joint")),null),i.jobjRoots.push(c);const h=new n.HSD_JObjRoot_Instance(i.modelCache.loadJObjRoot(s.HSD_JObjLoadJoint(r,l.assertExists(s.HSD_Archive_FindPublic(r,"TtlMoji_Top_joint")))));return h.addAnimAll(s.HSD_AObjLoadAnimJoint(r,s.HSD_Archive_FindPublic(r,"TtlMoji_Top_animjoint")),s.HSD_AObjLoadMatAnimJoint(r,s.HSD_Archive_FindPublic(r,"TtlMoji_Top_matanim_joint")),null),i.jobjRoots.push(h),i}},new class{constructor(e="Fighter Test Scene",t="Fighters"){this.name=e,this.id=t}async createScene(e,t){const a=t.dataFetcher,r=new d(e),n=await function(e){const t=[];return t.push(_(e,"Ca","Captain",["Nr","Bu","Gr","Gy","Re","Re.usd"])),t.push(_(e,"Cl","Clink",["Nr","Bk","Bu","Re","Wh"])),t.push(_(e,"Dk","Donkey",["Nr","Bk","Gr","Re"])),t.push(_(e,"Dr","Drmario",["Nr","Bk","Bu","Gr","Re"])),t.push(_(e,"Fc","Falco",["Nr","Bu","Gr","Re"])),t.push(_(e,"Fe","Emblem",["Nr","Bu","Gr","Re","Ye"])),t.push(_(e,"Fx","Fox",["Nr","Or","La","Gr"])),Promise.all(t)}(a);let s=-50;for(let e=0;e<n.length;e++){let t=0;const a=n[e];for(let e=0;e<a.variants.length;e++){const n=g(r.modelCache,a,e);null!==n?(S(n,["Wait","Wait1"]),n.rootInst.modelMatrix[12]=t,n.rootInst.modelMatrix[14]=s,r.jobjRoots.push(n.rootInst),t+=25):console.log("proper root",a.variants[0].mdArc.publics[0].name)}s-=25}return r}},new m("PlFxNr.dat"),new m("PlKbNr.dat"),new m("MnExtAll.usd","MenMainBack_Top"),new m("GmRgEBG3.dat"),new m("GmRst.usd"),new m("TyZkPair.dat"),new m("TyZkWmen.dat"),new m("TmBox.dat"),new m("TyAligat.dat"),new m("Tyandold.dat"),new m("TyAndruf.dat"),new m("TyAnnie.dat"),new m("TyArwing.dat"),new m("TyAyumi.dat"),new m("TyBacket.dat"),new m("TyBalf.dat"),new m("TyBancho.dat"),new m("TyBarCan.dat"),new m("TyBaritm.dat"),new m("TyBayone.dat"),new m("TyBField.dat"),new m("TyBKoopa.dat"),new m("TyBMario.dat"),new m("TyBox.dat"),new m("TyBrdian.dat"),new m("TyBSword.dat"),new m("TyBTrper.dat"),new m("TyCaptan.dat"),new m("TyCaptnR.dat"),new m("TyCaptR2.dat"),new m("TyCathar.dat"),new m("TyCerebi.dat"),new m("TyChico.dat"),new m("TyClink.dat"),new m("TyClinkR.dat"),new m("TyClnkR2.dat"),new m("TyCoin.dat"),new m("TyCpeacch.dat"),new m("TyCpR2Us.dat"),new m("TyCrobat.dat"),new m("TyCulCul.dat"),new m("TyCupsul.dat"),new m("TyDaikon.dat"),new m("TyDaisy.dat"),new m("TyDataf.dat"),new m("TyDatai.dat"),new m("TyDatai.usd"),new m("TyDedede.dat"),new m("TyDiskun.dat"),new m("TyDixKng.dat"),new m("TyDkJr.dat"),new m("TyDLight.dat"),new m("TyDMario.dat"),new m("TyDnkyR2.dat"),new m("TyDonkey.dat"),new m("TyDonkyR.dat"),new m("TyDosei.dat"),new m("TyDosin.dat"),new m("TyDossun.dat"),new m("TyDrMriR.dat"),new m("TyDrMrR2.dat"),new m("TyDuck.dat"),new m("TyEgg.dat"),new m("TyEievui.dat"),new m("TyEntei.dat"),new m("TyEtcA.dat"),new m("TyEtcB.dat"),new m("TyEtcC.dat"),new m("TyEtcD.dat"),new m("TyEtcE.dat"),new m("TyExbike.dat"),new m("TyFalco.dat"),new m("TyFalcoR.dat"),new m("TyFalcR2.dat"),new m("TyFFlowr.dat"),new m("TyFFlyer.dat"),new m("TyFire.dat"),new m("TyFirest.dat"),new m("TyFliper.dat"),new m("TyFood.dat"),new m("TyFounta.dat"),new m("TyFox.dat"),new m("TyFoxR.dat"),new m("TyFoxR2.dat"),new m("TyFreeze.dat"),new m("TyFrezer.dat"),new m("TyFubana.dat"),new m("TyFudane.dat"),new m("TyFzero.dat"),new m("TyFZone.dat"),new m("TyGanond.dat"),new m("TyGanonR.dat"),new m("TyGanonR2.dat"),new m("TyGKoopa.dat"),new m("TyGldFox.dat"),new m("TyGmCube.dat"),new m("TyGooie.dat"),new m("TyGoron.dat"),new m("TyGrtfox.dat"),new m("TyGShell.dat"),new m("TyGWatch.dat"),new m("TyGWathR.dat"),new m("TyGWatR2.dat"),new m("TyGwfeld.dat"),new m("TyHagane.dat"),new m("TyHammer.dat"),new m("TyHarise.dat"),new m("TyHassam.dat"),new m("TyHDosin.dat"),new m("TyHeart.dat"),new m("TyHecros.dat"),new m("TyHeiho.dat"),new m("TyHeriri.dat"),new m("TyHinoar.dat"),new m("TyHitode.dat"),new m("TyHomBat.dat"),new m("TyHotRly.dat"),new m("TyHouou.dat"),new m("TyIceclm.dat"),new m("TyIceclR.dat"),new m("TyIcecR2.dat"),new m("TyItemA.dat"),new m("TyItemB.dat"),new m("TyItemC.dat"),new m("TyItemD.dat"),new m("TyItemE.dat"),new m("TyJeff.dat"),new m("TyJugemu.dat"),new m("TyKabigo.dat"),new m("TyKamex.dat"),new m("TyKamiwa.dat"),new m("TyKart.dat"),new m("TyKasumi.dat"),new m("TyKbBall.dat"),new m("TyKbFigt.dat"),new m("TyKbFire.dat"),new m("TyKbHat1.dat"),new m("TyKbHat2.dat"),new m("TyKbHat3.dat"),new m("TyKbHat4.dat"),new m("TyKbHat5.dat"),new m("TyKiller.dat"),new m("TyKingCr.dat"),new m("TyKinopi.dat"),new m("TyKirbR2.dat"),new m("TyKirby.dat"),new m("TyKirbyR.dat"),new m("TyKirei.dat"),new m("TyKoopa.dat"),new m("TyKoopaR.dat"),new m("TyKopaR2.dat"),new m("TyKpMobl.dat"),new m("TyKraid.dat"),new m("TyKuribo.dat"),new m("TyKusuda.dat"),new m("TyLandms.dat"),new m("TyLeaded.dat"),new m("TyLight.dat"),new m("TyLikeli.dat"),new m("TyLink.dat"),new m("TyLinkR.dat"),new m("TyLinkR2.dat"),new m("TyLipSti.dat"),new m("TyLizdon.dat"),new m("TyLucky.dat"),new m("TyLugia.dat"),new m("TyLuigi.dat"),new m("TyLuigiM.dat"),new m("TyLuigiR.dat"),new m("TyLuigR2.dat"),new m("TyMajora.dat"),new m("TyMapA.dat"),new m("TyMapB.dat"),new m("TyMapC.dat"),new m("TyMapD.dat"),new m("TyMapE.dat"),new m("TyMaril.dat"),new m("TyMarin.dat"),new m("TyMario.dat"),new m("TyMarioR.dat"),new m("TyMariR2.dat"),new m("TyMars.dat"),new m("TyMarsR.dat"),new m("TyMarsR2.dat"),new m("TyMarumi.dat"),new m("TyMatado.dat"),new m("TyMbombJ.dat"),new m("TyMBombU.dat"),new m("TyMCapsu.dat"),new m("TyMcCmDs.dat"),new m("TyMcR1Ds.dat"),new m("TyMcR2Ds.dat"),new m("TyMetamo.dat"),new m("TyMetoid.dat"),new m("TyMew.dat"),new m("TyMew2.dat"),new m("TyMew2R.dat"),new m("TyMew2R2.dat"),new m("TyMHandL.dat"),new m("TyMhandR.dat"),new m("TyMHige.dat"),new m("TyMKnigt.dat"),new m("TyMMario.dat"),new m("TyMnBg.dat"),new m("TyMnDisp.dat"),new m("TyMnDisp.usd"),new m("TyMnFigp.dat"),new m("TyMnFigp.usd"),new m("TyMnInfo.dat"),new m("TyMnInfo.usd"),new m("TyMnView.dat"),new m("TyMnView.usd"),new m("TyMoon.dat"),new m("TyMrCoin.dat"),new m("TyMRider.dat"),new m("TyMrMant.dat"),new m("TyMrTail.dat"),new m("TyMsBall.dat"),new m("TyMSword.dat"),new m("TyMtlbox.dat"),new m("TyMTomat.dat"),new m("TyMucity.dat"),new m("TyMuroom.dat"),new m("TyMycCmA.dat"),new m("TyMycCmB.dat"),new m("TyMycCmC.dat"),new m("TyMycCmD.dat"),new m("TyMycCmE.dat"),new m("TyMycR1A.dat"),new m("TyMycR1B.dat"),new m("TyMycR1C.dat"),new m("TyMycR1D.dat"),new m("TyMycR1E.dat"),new m("TyMycR2A.dat"),new m("TyMycR2B.dat"),new m("TyMycR2C.dat"),new m("TyMycR2D.dat"),new m("TyMycR2E.dat"),new m("TyNasubi.dat"),new m("TyNess.dat"),new m("TyNessR.dat"),new m("TyNessR2.dat"),new m("TyNoko.dat"),new m("TyNyathR.dat"),new m("TyNyoroz.dat"),new m("TyOcarin.dat"),new m("TyOctaro.dat"),new m("TyOni.dat"),new m("TyOokido.dat"),new m("TyOrima.dat"),new m("TyOtosei.dat"),new m("TyParaso.dat"),new m("TyPatapa.dat"),new m("TyPchuR2.dat"),new m("TyPeach.dat"),new m("TyPeachR.dat"),new m("TyPeacR2.dat"),new m("TyPeppy.dat"),new m("TyPichu.dat"),new m("TyPichuR.dat"),new m("TyPikacR.dat"),new m("TyPikacu.dat"),new m("TyPikaR2.dat"),new m("TyPikmin.dat"),new m("TyPippi.dat"),new m("TyPit.dat"),new m("TyPlum.dat"),new m("TyPMario.dat"),new m("TyPMurom.dat"),new m("TyPokeA.dat"),new m("TyPokeB.dat"),new m("TyPokeC.dat"),new m("TyPokeD.dat"),new m("TyPokeE.dat"),new m("TyPola.dat"),new m("TyPoo.dat"),new m("TyPorgn2.dat"),new m("TyPupuri.dat"),new m("TyPurin.dat"),new m("TyPurinR.dat"),new m("TyPuriR2.dat"),new m("TyPy.dat"),new m("TyQChan.dat"),new m("TyQuesD.dat"),new m("TyRaikou.dat"),new m("TyRaygun.dat"),new m("TyRayMk2.dat"),new m("TyReset.dat"),new m("TyRick.dat"),new m("TyRidley.dat"),new m("TyRodori.dat"),new m("TyRoMilk.dat"),new m("TyRoy.dat"),new m("TyRoyR.dat"),new m("TyRoyR2.dat"),new m("TyRShell.dat"),new m("TySamuR2.dat"),new m("TySamus.dat"),new m("TySamusM.dat"),new m("TySamusR.dat"),new m("TyScBall.dat"),new m("TySeak.dat"),new m("TySeakR.dat"),new m("TySeakR2.dat"),new m("TySeirei.dat"),new m("TySeriA.dat"),new m("TySeriB.dat"),new m("TySeriC.dat"),new m("TySeriD.dat"),new m("TySeriE.dat"),new m("TySherif.dat"),new m("TySlippy.dat"),new m("TySmShip.dat"),new m("TySndbag.dat"),new m("TySnZero.dat"),new m("TySonans.dat"),new m("TySpyclJ.dat"),new m("TySpyclU.dat"),new m("TySScope.dat"),new m("TyStand.dat"),new m("TyStandD.dat"),new m("TyStar.dat"),new m("TyStarod.dat"),new m("TyStdiam.dat"),new m("TyStnley.dat"),new m("TyStrman.dat"),new m("TySuikun.dat"),new m("TyTamagn.dat"),new m("TyTanuki.dat"),new m("TyTarget.dat"),new m("TyTenEit.dat"),new m("TyTeresa.dat"),new m("TyThnder.dat"),new m("TyTogepy.dat"),new m("TyToppi.dat"),new m("TyTosaki.dat"),new m("TyTosanz.dat"),new m("TyTotake.dat"),new m("TyTwinkl.dat"),new m("TyUfo.dat"),new m("TyUKnown.dat"),new m("TyUsahat.dat"),new m("TyUsokie.dat"),new m("TyVirus.dat"),new m("TyWalugi.dat"),new m("TyWanino.dat"),new m("TyWario.dat"),new m("TyWaveRc.dat"),new m("TyWdldee.dat"),new m("TyWolfen.dat"),new m("TyWpStar.dat"),new m("TyWtBear.dat"),new m("TyWtCat.dat"),new m("TyWvRcUs.dat"),new m("TyWwoods.dat"),new m("TyYoshi.dat"),new m("TyYoshiR.dat"),new m("TyYoshR2.dat"),new m("TyZelda.dat"),new m("TyZeldaR.dat"),new m("TyZeldR2.dat"),new m("TyZeniga.dat"),new m("TyZkMen.dat")];t.sceneGroup={id:"SuperSmashBrosMelee",name:"Super Smash Bros. Melee",sceneDescs:b,hidden:!i.IS_DEVELOPMENT}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(5),n=a(1),s=a(2),i=a(34),o=a(35),l=a(0),c=a(30),h=a(337),d=a(4);class u{constructor(e,t,a){this.tobj=a;const[n,s]=r.translateTexFilterGfx(this.tobj.minFilt),[i]=r.translateTexFilterGfx(this.tobj.magFilt);this.gfxSampler=t.createSampler(e,{wrapS:r.translateWrapModeGfx(this.tobj.wrapS),wrapT:r.translateWrapModeGfx(this.tobj.wrapT),minFilter:n,mipFilter:s,magFilter:i,minLOD:this.tobj.imageDesc.minLOD,maxLOD:this.tobj.imageDesc.maxLOD})}}class m{constructor(e,t,a){this.mobj=a,this.tobj=[];for(let a=0;a<this.mobj.tobj.length;a++)this.tobj.push(new u(e,t,this.mobj.tobj[a]))}}class p{constructor(e,t,a,n){this.dobj=n,this.shapeHelpers=[],this.mobj=null,null!==this.dobj.mobj&&(this.mobj=new m(e,t,this.dobj.mobj));for(let n=0;n<this.dobj.pobj.length;n++){const s=this.dobj.pobj[n];this.shapeHelpers.push(new r.GXShapeHelperGfx(e,t,a.shift(),s.loadedVertexLayout,s.loadedVertexData))}}destroy(e){for(let t=0;t<this.shapeHelpers.length;t++)this.shapeHelpers[t].destroy(e)}}class f{constructor(e,t,a,r){if(this.jobj=r,this.dobj=[],this.children=[],"DObj"===this.jobj.kind)for(let r=0;r<this.jobj.dobj.length;r++)this.dobj.push(new p(e,t,a,this.jobj.dobj[r]));for(let r=0;r<this.jobj.children.length;r++)this.children.push(new f(e,t,a,this.jobj.children[r]))}destroy(e){for(let t=0;t<this.dobj.length;t++)this.dobj[t].destroy(e);for(let t=0;t<this.children.length;t++)this.children[t].destroy(e)}}class A{constructor(e,t,a){this.imageDesc=t,this.tlutDesc=a;const n={name:`HSD Texture ${l.hexzero(t.offs,8)}`,data:t.data,format:t.format,width:t.width,height:t.height,mipCount:t.mipCount,paletteFormat:null!==a?a.paletteFormat:null,paletteData:null!==a?a.paletteData:null},s=o.calcMipChain(n,t.mipCount),{viewerTexture:i,gfxTexture:c}=r.loadTextureFromMipChain(e,s);this.gfxTexture=c,this.viewerTexture=i}fillTextureMapping(e){return e.gfxTexture=this.gfxTexture,e.width=this.imageDesc.width,e.height=this.imageDesc.height,!0}destroy(e){e.destroyTexture(this.gfxTexture)}}class g{constructor(){this.imageDatas=[]}getImageData(e,t,a){for(let e=0;e<this.imageDatas.length;e++){const r=this.imageDatas[e];if(r.imageDesc===t&&r.tlutDesc===a)return r}const r=new A(e,t,a);return this.imageDatas.push(r),r}destroy(e){for(let t=0;t<this.imageDatas.length;t++)this.imageDatas[t].destroy(e)}}t.HSD_JObjRoot_Data=class{constructor(e,t,a,n=new g){this.root=a,this.texImageDataCache=n,this.texImageData=[];const s=[];function i(e){for(let t=0;t<e.pobj.length;t++)s.push(e.pobj[t].loadedVertexData)}!function e(t){if("DObj"===t.kind)for(let e=0;e<t.dobj.length;e++)i(t.dobj[e]);for(let a=0;a<t.children.length;a++)e(t.children[a])}(this.root.jobj),this.coalescedBuffers=r.loadedDataCoalescerComboGfx(e,s);const o=this.coalescedBuffers.coalescedBuffers.slice();this.rootData=new f(e,t,o,this.root.jobj)}destroy(e){this.coalescedBuffers.destroy(e),this.rootData.destroy(e);for(let t=0;t<this.texImageData.length;t++)this.texImageData[t].destroy(e)}};class _{constructor(e){this.aobj=e,this.framerate=1,this.currFrame=0,this.flags=this.aobj.flags}calcFObj(e,t,a){const r=this.currFrame;let n=0;for(;n<e.keyframes.length&&!(r<e.keyframes[n].time);n++);n>0&&n--;const i=e.keyframes[n];if("Constant"===i.kind)t(e.type,i.p0,a);else if("Linear"===i.kind){const n=0!==i.duration?(r-i.time)/i.duration:1;t(e.type,s.lerp(i.p0,i.p1,n),a)}else if("Hermite"===i.kind){const n=0!==i.duration?(r-i.time)/i.duration:1;t(e.type,c.getPointHermite(i.p0,i.p1,i.d0,i.d1,n),a)}}calcAnim(e,t,a){if(this.currFrame+=this.framerate*e,536870912&this.flags)for(;this.currFrame>=this.aobj.endFrame;)this.currFrame-=this.aobj.endFrame;for(let e=0;e<this.aobj.fobj.length;e++)this.calcFObj(this.aobj.fobj[e],t,a)}}t.HSD_AObj_Instance=_;const S=n.mat4.create();class b{constructor(e,t){this.data=e,this.texImageDataCache=t,this.textureMatrix=n.mat4.create(),this.texMtxID=125,this.texMapID=255,this.texCoordID=255,this.aobj=null,this.texAnim=null,this.scale=n.vec3.create(),this.rotation=n.vec3.create(),this.translation=n.vec3.create(),this.constant=null,this.tev0=null,this.tev1=null;const a=this.data.tobj;this.imageDesc=a.imageDesc,this.tlutDesc=a.tlutDesc,n.vec3.copy(this.scale,a.scale),n.vec3.copy(this.rotation,a.rotation),n.vec3.copy(this.translation,a.translation),this.blending=a.blending,null!==a.tevDesc&&(this.constant=d.colorNewCopy(a.tevDesc.constant),this.tev0=d.colorNewCopy(a.tevDesc.tev0),this.tev1=d.colorNewCopy(a.tevDesc.tev1))}addAnim(e){this.texAnim=e,null!==e.aobj&&(this.aobj=new _(e.aobj))}static updateAnim(e,t,a){1===e?a.imageDesc=l.assertExists(a.texAnim.imageDescs[t]):2===e?a.translation[0]=t:3===e?a.translation[1]=t:4===e?a.scale[0]=t:5===e?a.scale[1]=t:6===e?a.rotation[0]=t:7===e?a.rotation[1]=t:8===e?a.rotation[2]=t:9===e?a.blending=s.saturate(t):10===e?a.tlutDesc=l.assertExists(a.texAnim.tlutDescs[t]):11===e||(12===e?null!==a.constant&&(a.constant.r=s.saturate(t)):13===e?null!==a.constant&&(a.constant.g=s.saturate(t)):14===e?null!==a.constant&&(a.constant.b=s.saturate(t)):15===e?null!==a.constant&&(a.constant.a=s.saturate(t)):16===e?null!==a.tev0&&(a.tev0.r=s.saturate(t)):17===e?null!==a.tev0&&(a.tev0.g=s.saturate(t)):18===e?null!==a.tev0&&(a.tev0.b=s.saturate(t)):19===e?null!==a.tev0&&(a.tev0.a=s.saturate(t)):20===e?null!==a.tev1&&(a.tev1.r=s.saturate(t)):21===e?null!==a.tev1&&(a.tev1.g=s.saturate(t)):22===e?null!==a.tev1&&(a.tev1.b=s.saturate(t)):23===e?null!==a.tev1&&(a.tev1.a=s.saturate(t)):24===e&&(a.blending=s.saturate(t)))}calcAnim(e){null!==this.aobj&&this.aobj.calcAnim(e,b.updateAnim,this)}makeColorGenTExp(e,t,a){const r=this.data.tobj.tevDesc,n=h.HSD_TExpTev(e);h.HSD_TExpOrder(n,this,7);const s=[],i=[];if(1073741824&r.active){for(let a=0;a<4;a++){const n=r.colorIn[a];if(15===n)s[a]=7,i[a]=null;else if(12===n)s[a]=8,i[a]=null;else if(13===n)s[a]=12,i[a]=null;else if(8===n)s[a]=1,i[a]=h.HSD_TEXP_TEX;else if(9===n)s[a]=5,i[a]=h.HSD_TEXP_TEX;else if(128===n)s[a]=1,i[a]=h.HSD_TExpCnstTObj(e,t,3,1);else if(129===n)s[a]=6,i[a]=h.HSD_TExpCnstTObj(e,t,4,6);else if(130===n)s[a]=6,i[a]=h.HSD_TExpCnstTObj(e,t,5,6);else if(131===n)s[a]=6,i[a]=h.HSD_TExpCnstTObj(e,t,6,6);else if(132===n)s[a]=6,i[a]=h.HSD_TExpCnstTObj(e,t,7,6);else if(133===n){s[a]=1;const r=h.HSD_TExpTev(e);h.HSD_TExpOrder(r,null,7),h.HSD_TExpColorOp(r,0,0,0,!0),h.HSD_TExpColorIn(r,7,null,7,null,7,null,1,h.HSD_TExpCnstTObj(e,t,8,1)),i[a]=r}else if(134===n){s[a]=1;const r=h.HSD_TExpTev(e);h.HSD_TExpOrder(r,null,7),h.HSD_TExpColorOp(r,0,0,0,!0),h.HSD_TExpColorIn(r,7,null,7,null,7,null,6,h.HSD_TExpCnstTObj(e,t,9,6)),i[a]=r}else if(135===n){s[a]=1;const r=h.HSD_TExpTev(e);h.HSD_TExpOrder(r,null,7),h.HSD_TExpColorOp(r,0,0,0,!0),h.HSD_TExpColorIn(r,7,null,7,null,7,null,1,h.HSD_TExpCnstTObj(e,t,10,1)),i[a]=r}else{if(136!==n)throw"whoops";{s[a]=1;const r=h.HSD_TExpTev(e);h.HSD_TExpOrder(r,null,7),h.HSD_TExpColorOp(r,0,0,0,!0),h.HSD_TExpColorIn(r,7,null,7,null,7,null,6,h.HSD_TExpCnstTObj(e,t,11,6)),i[a]=r}}}h.HSD_TExpColorOp(n,r.colorOp,r.colorBias,r.colorScale,r.colorClamp),h.HSD_TExpColorIn(n,s[0],i[0],s[1],i[1],s[2],i[2],s[3],i[3]),a.c=n}if(-2147483648&r.active){for(let a=0;a<4;a++){const n=r.alphaIn[a];if(7===n)s[a]=7,i[a]=null;else if(4===n)s[a]=5,i[a]=h.HSD_TEXP_TEX;else if(64===n)s[a]=6,i[a]=h.HSD_TExpCnstTObj(e,t,4,6);else if(65===n)s[a]=6,i[a]=h.HSD_TExpCnstTObj(e,t,5,6);else if(66===n)s[a]=6,i[a]=h.HSD_TExpCnstTObj(e,t,6,6);else if(67===n)s[a]=6,i[a]=h.HSD_TExpCnstTObj(e,t,7,6);else if(68===n){s[a]=5;const r=h.HSD_TExpTev(e);h.HSD_TExpOrder(r,null,7),h.HSD_TExpAlphaOp(r,0,0,0,!0),h.HSD_TExpAlphaIn(r,7,null,7,null,7,null,6,h.HSD_TExpCnstTObj(e,t,9,6)),i[a]=r}else{if(69!==n)throw"whoops";{s[a]=1;const r=h.HSD_TExpTev(e);h.HSD_TExpOrder(r,null,7),h.HSD_TExpAlphaOp(r,0,0,0,!0),h.HSD_TExpAlphaIn(r,7,null,7,null,7,null,6,h.HSD_TExpCnstTObj(e,t,11,6)),i[a]=r}}}h.HSD_TExpAlphaOp(n,r.alphaOp,r.alphaBias,r.alphaScale,r.alphaClamp),h.HSD_TExpAlphaIn(n,s[0],i[0],s[1],i[1],s[2],i[2],s[3],i[3]),a.a=n}}makeTExp(e,t,a,r){const n=this.data.tobj,s=!!(a&this.data.tobj.flags),i={c:h.HSD_TEXP_TEX,a:h.HSD_TEXP_TEX},o=h.HSD_TExpTev(e);null!==n.tevDesc&&-1073741824&n.tevDesc.active&&this.makeColorGenTExp(e,t,i),h.HSD_TExpOrder(o,this,7);const l=983040&this.data.tobj.flags;if(65536===l)h.HSD_TExpColorOp(o,0,0,0,!0),h.HSD_TExpColorIn(o,1,r.c,1,i.c,5,i.a,7,null);else if(131072===l)h.HSD_TExpColorOp(o,0,0,0,!0),h.HSD_TExpColorIn(o,1,r.c,1,i.c,1,i.c,7,null);else if(196608===l){const a=h.HSD_TExpCnstTObj(e,t,12,6);h.HSD_TExpColorOp(o,0,0,0,!0),h.HSD_TExpColorIn(o,1,r.c,1,i.c,6,a,7,null)}else if(262144===l)h.HSD_TExpColorOp(o,0,0,0,!0),h.HSD_TExpColorIn(o,7,null,1,r.c,1,i.c,7,null);else if(327680===l)h.HSD_TExpColorOp(o,0,0,0,!0),h.HSD_TExpColorIn(o,7,null,7,null,7,null,1,i.c);else if(0===l||393216===l)h.HSD_TExpColorOp(o,0,0,0,!0),h.HSD_TExpColorIn(o,7,null,7,null,7,null,1,r.c);else if(458752===l)h.HSD_TExpColorOp(o,0,0,0,!0),h.HSD_TExpColorIn(o,1,i.c,7,null,7,null,1,r.c);else{if(524288!==l)throw"whoops";h.HSD_TExpColorOp(o,1,0,0,!0),h.HSD_TExpColorIn(o,1,i.c,7,null,7,null,1,r.c)}if(r.c=o,!s){const a=15728640&this.data.tobj.flags;if(1048576===a)h.HSD_TExpAlphaOp(o,0,0,0,!0),h.HSD_TExpAlphaIn(o,5,r.a,5,i.a,5,i.a,7,null);else if(2097152===a){const a=h.HSD_TExpCnstTObj(e,t,12,6);h.HSD_TExpAlphaOp(o,0,0,0,!0),h.HSD_TExpAlphaIn(o,5,r.a,5,i.a,6,a,7,null)}else if(3145728===a)h.HSD_TExpAlphaOp(o,0,0,0,!0),h.HSD_TExpAlphaIn(o,7,null,5,r.a,5,i.a,7,null);else if(4194304===a)h.HSD_TExpAlphaOp(o,0,0,0,!0),h.HSD_TExpAlphaIn(o,7,null,7,null,7,null,5,i.a);else if(0===a||5242880===a)h.HSD_TExpAlphaOp(o,0,0,0,!0),h.HSD_TExpAlphaIn(o,7,null,7,null,7,null,5,r.a);else if(6291456===a)h.HSD_TExpAlphaOp(o,0,0,0,!0),h.HSD_TExpAlphaIn(o,5,i.a,7,null,7,null,5,r.a);else{if(7340032!==a)throw"whoops";h.HSD_TExpAlphaOp(o,1,0,0,!0),h.HSD_TExpAlphaIn(o,5,i.a,7,null,7,null,5,r.a)}r.a=o}}calcMtx(){const e=this.data.tobj;n.mat4.identity(this.textureMatrix),this.textureMatrix[12]=-this.translation[0],this.textureMatrix[13]=-(this.translation[1]+(2===e.wrapT?1/(e.repeatT/this.scale[1]):0)),this.textureMatrix[14]=this.translation[2],s.computeModelMatrixR(S,this.rotation[0],this.rotation[1],-this.rotation[2]),n.mat4.mul(this.textureMatrix,S,this.textureMatrix),s.computeModelMatrixS(S,Math.abs(this.scale[0])<1e-6?0:e.repeatS/this.scale[0],Math.abs(this.scale[1])<1e-6?0:e.repeatT/this.scale[1],this.scale[2]),n.mat4.mul(this.textureMatrix,S,this.textureMatrix)}fillTExpConstantInput(e,t,a){l.assert(t>=3),3===t?(l.assert(1===a),d.colorCopy(e,this.constant)):4===t?(l.assert(6===a),e.a=this.constant.r):5===t?(l.assert(6===a),e.a=this.constant.g):6===t?(l.assert(6===a),e.a=this.constant.b):7===t?(l.assert(6===a),e.a=this.constant.a):8===t?(l.assert(1===a),d.colorCopy(e,this.tev0)):9===t?(l.assert(6===a),e.a=this.tev0.a):10===t?(l.assert(1===a),d.colorCopy(e,this.tev1)):11===t?(l.assert(6===a),e.a=this.tev1.a):12===t&&(l.assert(6===a),e.a=this.blending)}fillTexMtx(e){const t=this.data.tobj.flags,a=15&t;1===a||2===a||3===a||(16777216&t?n.mat4.copy(e.u_TexMtx[9],this.textureMatrix):n.mat4.copy(e.u_PostTexMtx[this.texMapID],this.textureMatrix))}fillTextureMapping(e,t){this.texImageDataCache.getImageData(e,this.imageDesc,this.tlutDesc).fillTextureMapping(t),t.gfxSampler=this.data.gfxSampler}}t.HSD_TObj_Instance=b;const v=new r.MaterialParams,w=d.colorNewCopy(d.White);class x{constructor(e,t){this.data=e,this.tobj=[],this.aobj=null,this.ambient=d.colorNewCopy(d.White),this.diffuse=d.colorNewCopy(d.White),this.specular=d.colorNewCopy(d.White),this.alpha=1;for(let e=0;e<this.data.tobj.length;e++)this.tobj.push(new b(this.data.tobj[e],t));const a=this.data.mobj;d.colorCopy(this.ambient,a.ambient),d.colorCopy(this.diffuse,a.diffuse),d.colorCopy(this.specular,a.specular),this.alpha=a.alpha;const n=new i.GXMaterialBuilder;this.compileTev(n),this.setupChannelMode(n);for(let e=0;e<this.tobj.length;e++){const t=this.tobj[e],a=t.data.tobj.flags,r=15&a;3===r?n.setTexCoordGen(t.texCoordID,0,0,0,!1,t.texMtxID):1===r||2===r?n.setTexCoordGen(t.texCoordID,0,1,30,!0,t.texMtxID):16777216&a?n.setTexCoordGen(t.texCoordID,1,t.data.tobj.src,57):n.setTexCoordGen(t.texCoordID,1,t.data.tobj.src,60,!1,t.texMtxID)}n.setAlphaCompare(a.alphaComp0,a.alphaRef0,a.alphaOp,a.alphaComp1,a.alphaRef1),n.setBlendMode(a.type,a.srcFactor,a.dstFactor,a.logicOp),n.setZMode(!!(16&a.peFlags),a.zComp,!!(32&a.peFlags)),this.materialHelper=new r.GXMaterialHelperGfx(n.finish())}setupChannelMode(e){const t=this.data.mobj.renderMode;let a=3&t;0===a&&(a=1);let r=24576&t;if(0===r&&(r=a<<13),4&t){const t=2&a?1:0;e.setChanCtrl(0,!1,0,t,0,2,1);let n=2;16384&r&&(e.setChanCtrl(2,!1,0,1,0,2,1),n=3),e.setChanCtrl(n,!1,0,0,0,2,1)}else{const t=2&a?1:0;e.setChanCtrl(0,!1,0,t,0,2,1);const n=16384&r?1:0;e.setChanCtrl(2,!1,0,n,0,2,1)}}addAnim(e){null!==e.aobj&&(this.aobj=new _(e.aobj));for(let t=0;t<this.tobj.length;t++){const a=this.tobj[t],r=e.texAnim.find(e=>e.animID===a.data.tobj.animID);void 0!==r&&a.addAnim(r)}}static updateAnim(e,t,a){1===e?a.ambient.r=s.saturate(t):2===e?a.ambient.g=s.saturate(t):3===e?a.ambient.b=s.saturate(t):4===e?a.diffuse.r=s.saturate(t):5===e?a.diffuse.g=s.saturate(t):6===e?a.diffuse.b=s.saturate(t):7===e?a.specular.r=s.saturate(t):8===e?a.specular.g=s.saturate(t):9===e?a.specular.b=s.saturate(t):10===e&&(a.alpha=s.saturate(1-t))}calcAnim(e){null!==this.aobj&&this.aobj.calcAnim(e,x.updateAnim,this);for(let t=0;t<this.tobj.length;t++)this.tobj[t].calcAnim(e)}calcMtx(){for(let e=0;e<this.tobj.length;e++)this.tobj[e].calcMtx()}assignResources(){let e=0,t=0;for(let a=0;a<this.tobj.length;a++){const r=this.tobj[a],n=15&r.data.tobj.flags;if(4===n);else if(16777216===n);else{const a=e++;r.texMapID=0+a,r.texMtxID=64+3*a,1!==n&&2!==n&&3!==n||(r.texCoordID=t++)}}for(let e=0;e<this.tobj.length;e++){const a=this.tobj[e];0===(15&a.data.tobj.flags)&&(a.texCoordID=t++)}}makeTExp(){let e=null;for(let t=0;t<this.tobj.length;t++){const a=this.tobj[t];4===(15&a.data.tobj.flags)&&(e=a)}const t=this.data.mobj;let a=3&t.renderMode;0===a&&(a=1);let r=24576&t.renderMode;0===r&&(r=a<<13);const n=new h.HSD_TExpList;let s=h.HSD_TExpTev(n);if(4&t.renderMode){if(2===a)h.HSD_TExpColorOp(s,0,0,0,!0),h.HSD_TExpColorIn(s,7,null,7,null,7,null,8,null);else{const e=h.HSD_TExpCnst(n,1,1);h.HSD_TExpColorOp(s,0,0,0,!0),h.HSD_TExpColorIn(s,7,null,7,null,7,null,1,e)}if(16384===r){const e=h.HSD_TExpCnst(n,0,6);h.HSD_TExpAlphaOp(s,0,0,0,!0),h.HSD_TExpAlphaIn(s,7,null,7,null,7,null,6,e)}else{const e=h.HSD_TExpCnst(n,2,6);h.HSD_TExpAlphaOp(s,0,0,0,!0),h.HSD_TExpAlphaIn(s,7,null,7,null,7,null,6,e)}}else{if(1===a){const e=h.HSD_TExpCnst(n,1,1);h.HSD_TExpColorOp(s,0,0,0,!0),h.HSD_TExpColorIn(s,7,null,7,null,7,null,1,e)}else if(2===a)h.HSD_TExpOrder(s,e,0),h.HSD_TExpColorOp(s,0,0,0,!0),h.HSD_TExpColorIn(s,7,null,7,null,7,null,1,e?h.HSD_TEXP_TEX:h.HSD_TEXP_RAS);else{const t=h.HSD_TExpCnst(n,1,1);h.HSD_TExpOrder(s,e,0),h.HSD_TExpColorOp(s,0,0,0,!0),h.HSD_TExpColorIn(s,1,e?h.HSD_TEXP_TEX:h.HSD_TEXP_RAS,7,null,7,null,1,t)}if(8192===r){const e=h.HSD_TExpCnst(n,2,6);h.HSD_TExpAlphaOp(s,0,0,0,!0),h.HSD_TExpAlphaIn(s,7,null,7,null,7,null,6,e)}else if(16384===r)h.HSD_TExpOrder(s,e,0),h.HSD_TExpAlphaOp(s,0,0,0,!0),h.HSD_TExpAlphaIn(s,7,null,7,null,7,null,5,h.HSD_TEXP_RAS);else{const t=h.HSD_TExpCnst(n,2,6);h.HSD_TExpOrder(s,e,0),h.HSD_TExpAlphaOp(s,0,0,0,!0),h.HSD_TExpAlphaIn(s,7,null,5,h.HSD_TEXP_RAS,6,t,7,null)}}const i={c:s,a:s};let o=0;for(let e=0;e<this.tobj.length;e++){const t=this.tobj[e];80&t.data.tobj.flags&&255!==t.texMapID&&t.makeTExp(n,e,o,i)}if(o|=80,4&t.renderMode){if(16384&r){const e=h.HSD_TExpTev(n);h.HSD_TExpOrder(e,null,1),h.HSD_TExpColorOp(e,0,0,0,!0),h.HSD_TExpColorIn(e,7,null,7,null,7,null,1,i.c),h.HSD_TExpAlphaOp(e,0,0,0,!0),h.HSD_TExpAlphaIn(e,5,i.a,7,null,5,h.HSD_TEXP_RAS,7,null),i.c=e,i.a=e}const t=h.HSD_TExpTev(n);h.HSD_TExpOrder(t,e,0),h.HSD_TExpColorOp(t,0,0,0,!0),h.HSD_TExpColorIn(t,7,null,1,i.c,1,null!==e?h.HSD_TEXP_TEX:h.HSD_TEXP_RAS,7,null),i.c=t,h.HSD_TExpAlphaOp(t,0,0,0,!0),h.HSD_TExpAlphaIn(t,7,null,5,i.a,5,h.HSD_TEXP_RAS,7,null),i.a=t}t.renderMode;for(let e=0;e<this.tobj.length;e++){const t=this.tobj[e];128&t.data.tobj.flags&&255!==t.texMapID&&t.makeTExp(n,e,o,i)}if(i.c!==i.a||h.HSD_TExpGetType(i.c)!==h.HSD_TExpType.TE_TEV||h.HSD_TExpGetType(i.a)!==h.HSD_TExpType.TE_TEV){const e=h.HSD_TExpTev(n);h.HSD_TExpColorOp(e,0,0,0,!0),h.HSD_TExpColorIn(e,7,null,7,null,7,null,1,i.c),h.HSD_TExpAlphaOp(e,0,0,0,!0),h.HSD_TExpColorIn(e,7,null,7,null,7,null,5,i.a),n.root=e}else n.root=i.c;return n}compileTev(e){this.assignResources(),this.texp=this.makeTExp(),h.HSD_TExpCompile(this.texp,e)}fillTExpConstantInput(e,t,a){if(0===t)l.assert(6===a),e.a=1;else if(1===t)l.assert(1===a),d.colorCopy(e,this.diffuse);else if(2===t)l.assert(6===a),e.a=this.alpha;else if(t>=3){const r=t>>>16;this.tobj[r].fillTExpConstantInput(e,65535&t,a)}}setupTExpConstants(e){for(let t=0;t<this.texp.cnsts.length;t++){const a=this.texp.cnsts[t];if(null===a.reg)continue;this.fillTExpConstantInput(w,a.val,a.comp);const n=a.reg;let s;if(s=n<4?e.u_Color[r.ColorKind.K0+n]:e.u_Color[r.ColorKind.C0+n-4],1===a.comp)s.r=w.r,s.g=w.g,s.b=w.b;else{const e=w.a;n<4?0===a.idx?s.r=e:1===a.idx?s.g=e:2===a.idx?s.b=e:s.a=e:3===a.idx?s.a=e:(s.r=e,s.g=e,s.b=e)}}}setOnRenderInst(e,t,a){for(let e=0;e<8;e++)v.m_TextureMapping[e].reset();for(let t=0;t<this.tobj.length;t++){const a=this.tobj[t];a.fillTextureMapping(e,v.m_TextureMapping[t]),a.fillTexMtx(v)}this.materialHelper.setOnRenderInst(e,t,a);const r=this.materialHelper.allocateMaterialParams(a);this.setupTExpConstants(v),this.materialHelper.fillMaterialParamsDataOnInst(a,r,v),a.setSamplerBindingsFromTextureMappings(v.m_TextureMapping)}}const T=new r.PacketParams;function y(e,t){if(2&t.data.jobj.flags)n.mat4.identity(e);else{const a=function(e){for(;!(3&e.data.jobj.flags);)e=e.parent;return e}(t);a===t?n.mat4.invert(e,a.data.jobj.inverseBindPose):2&a.data.jobj.flags?(n.mat4.invert(e,t.jointMtx),n.mat4.mul(e,a.jointMtx,e)):(n.mat4.invert(e,t.jointMtx),n.mat4.mul(e,a.data.jobj.inverseBindPose,e),n.mat4.mul(e,a.jointMtx,e))}}const C=n.mat4.create(),M=n.mat4.create();class U{constructor(e,t){this.data=e,this.mobj=null,this.visible=!0,null!==this.data.mobj&&(this.mobj=new x(this.data.mobj,t))}addAnimAll(e,t){null!==this.mobj&&null!==e&&this.mobj.addAnim(e)}calcAnim(e){null!==this.mobj&&this.mobj.calcAnim(e)}calcMtx(){null!==this.mobj&&this.mobj.calcMtx()}draw(e,t,a,r,s){if(null===this.mobj)return;if(!this.visible)return;const i=t.pushTemplateRenderInst();this.mobj.setOnRenderInst(e,t.gfxRenderCache,i);for(let e=0;e<this.data.dobj.pobj.length;e++){const i=this.data.dobj.pobj[e],o=this.data.shapeHelpers[e];if("Rigid"===i.kind)l.assert(0===i.jointReference),n.mat4.mul(T.u_PosMtx[0],a.camera.viewMatrix,r.jointMtx);else if("Envelope"===i.kind){y(M,r);for(let e=0;e<i.envelopeDesc.length;e++){const t=i.envelopeDesc[e],o=T.u_PosMtx[e];if(o.fill(0),1===t.length){const e=t[0];l.assert(1===e.weight);const a=s.findJObjByJointReferenceID(e.jointReference);2&r.data.jobj.flags?n.mat4.copy(o,a.jointMtx):n.mat4.mul(o,a.jointMtx,a.data.jobj.inverseBindPose)}else for(let e=0;e<t.length;e++){const a=t[e];l.assert(a.weight<1);const r=s.findJObjByJointReferenceID(a.jointReference);n.mat4.mul(C,r.jointMtx,r.data.jobj.inverseBindPose),n.mat4.multiplyScalarAndAdd(o,o,C,a.weight)}n.mat4.mul(o,o,M),n.mat4.mul(o,a.camera.viewMatrix,o)}}else if("ShapeAnim"===i.kind)throw"whoops";const c=t.newRenderInst(),h=c.getMegaStateFlags(),d=49152&i.flags;h.cullMode=0===d?0:16384===d?1:32768===d?2:3,o.setOnRenderInst(c),o.fillPacketParams(T,c),t.submitRenderInst(c)}t.popTemplateRenderInst()}}class k{constructor(e,t,a=null){this.data=e,this.parent=a,this.dobj=[],this.aobj=null,this.children=[],this.jointMtx=n.mat4.create(),this.translation=n.vec3.create(),this.rotation=n.vec3.create(),this.scale=n.vec3.create(),this.parentScale=n.vec3.fromValues(1,1,1),this.visible=!0;for(let e=0;e<this.data.dobj.length;e++)this.dobj.push(new U(this.data.dobj[e],t));for(let e=0;e<this.data.children.length;e++)this.children.push(new k(this.data.children[e],t,this));const r=this.data.jobj;n.vec3.copy(this.translation,r.translation),n.vec3.copy(this.rotation,r.rotation),n.vec3.copy(this.scale,r.scale),this.visible=!(16&r.flags)}setVisible(e){this.visible=e}setVisibleAll(e){this.visible=e;for(let t=0;t<this.children.length;t++)this.children[t].setVisibleAll(e)}addAnim(e,t,a){null!==e&&null!==e.aobj&&(this.aobj=new _(e.aobj));for(let e=0;e<this.dobj.length;e++){this.dobj[e].addAnimAll(null!==t?t.matAnim[e]:null,null)}}addAnimAll(e,t,a){this.addAnim(e,t,a);for(let r=0;r<this.children.length;r++){this.children[r].addAnimAll(null!==e&&r<e.children.length?e.children[r]:null,null!==t&&r<t.children.length?t.children[r]:null,null!==a&&r<a.children.length?a.children[r]:null)}}static updateAnim(e,t,a){1===e?a.rotation[0]=t:2===e?a.rotation[1]=t:3===e?a.rotation[2]=t:4===e||(5===e?a.translation[0]=t:6===e?a.translation[1]=t:7===e?a.translation[2]=t:8===e?a.scale[0]=t:9===e?a.scale[1]=t:10===e?a.scale[2]=t:11===e?a.setVisible(t>=.5):12===e&&a.setVisibleAll(t>=.5))}calcAnim(e){null!==this.aobj&&this.aobj.calcAnim(e,k.updateAnim,this);for(let t=0;t<this.dobj.length;t++)this.dobj[t].calcAnim(e);for(let t=0;t<this.children.length;t++)this.children[t].calcAnim(e)}calcMtx(e=null,t=s.Vec3One){!!(8&this.data.jobj.flags)?n.vec3.copy(this.parentScale,t):n.vec3.mul(this.parentScale,this.scale,t),s.computeModelMatrixSRT_MayaSSC(this.jointMtx,this.scale[0],this.scale[1],this.scale[2],this.rotation[0],this.rotation[1],this.rotation[2],this.translation[0],this.translation[1],this.translation[2],t[0],t[1],t[2]),null!==e&&n.mat4.mul(this.jointMtx,e,this.jointMtx);for(let e=0;e<this.dobj.length;e++)this.dobj[e].calcMtx();for(let e=0;e<this.children.length;e++)this.children[e].calcMtx(this.jointMtx,this.parentScale)}draw(e,t,a,r){if(this.visible)for(let n=0;n<this.dobj.length;n++)this.dobj[n].draw(e,t,a,this,r);for(let n=0;n<this.children.length;n++)this.children[n].draw(e,t,a,r)}}t.HSD_JObjRoot_Instance=class{constructor(e){this.data=e,this.allJObjs=[],this.modelMatrix=n.mat4.create(),this.allJObjsByID=new Map,this.rootInst=new k(this.data.rootData,this.data.texImageDataCache);const t=e=>{this.allJObjs.push(e),this.allJObjsByID.set(e.data.jobj.jointReferenceID,e);for(let a=0;a<e.children.length;a++)t(e.children[a])};t(this.rootInst)}addAnimAll(e,t,a){this.rootInst.addAnimAll(null!==e?e.root:null,null!==t?t.root:null,null!==a?a.root:null)}findJObjByJointReferenceID(e){return this.allJObjsByID.get(e)}calcAnim(e){this.rootInst.calcAnim(e)}calcMtx(e){this.rootInst.calcMtx(this.modelMatrix)}draw(e,t,a){this.rootInst.draw(e,t,a,this),this.drawBoneHierarchy(this.rootInst,a.camera)}drawBoneHierarchy(e,t,a=0,r=0,n=!1){return 0}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);var n;!function(e){e[e.TE_ZERO=0]="TE_ZERO",e[e.TE_TEV=1]="TE_TEV",e[e.TE_TEX=2]="TE_TEX",e[e.TE_RAS=3]="TE_RAS",e[e.TE_CNST=4]="TE_CNST",e[e.TE_IMM=5]="TE_IMM",e[e.TE_KONST=6]="TE_KONST"}(n=t.HSD_TExpType||(t.HSD_TExpType={}));class s{constructor(){this.type=null,this.arg=null,this.sel=0,this.exp=null}}class i{constructor(){this.type=n.TE_TEV,this.colorOp=null,this.colorBias=0,this.colorScale=0,this.colorClamp=!1,this.alphaOp=null,this.alphaBias=0,this.alphaScale=0,this.alphaClamp=!1,this.colorIn=r.nArray(4,()=>new s),this.alphaIn=r.nArray(4,()=>new s),this.kcsel=null,this.kasel=null,this.rasSwapTable=void 0,this.texSwapTable=void 0,this.tex=null,this.chan=7,this.refColor=0,this.refAlpha=0,this.dstRegColor=null,this.dstRegAlpha=null}}class o{constructor(e,t){this.val=e,this.comp=t,this.type=n.TE_CNST,this.reg=null,this.idx=null,this.ref=0}}t.HSD_TECnst=o,t.HSD_TEXP_RAS=-2,t.HSD_TEXP_TEX=-1;function l(e){return null===e?n.TE_ZERO:e===t.HSD_TEXP_TEX?n.TE_TEX:e===t.HSD_TEXP_RAS?n.TE_RAS:e.type}function c(e,t){const a=l(e);if(a===n.TE_CNST){e.ref++}else if(a===n.TE_TEV){const a=e;1===t?a.refColor++:a.refAlpha++}}function h(e,t){const a=l(e);if(a===n.TE_CNST){e.ref--}else if(a===n.TE_TEV){const a=e;if(1===t?a.refColor>0&&a.refColor--:a.refAlpha>0&&a.refAlpha--,0===a.refColor&&0===a.refAlpha)for(let e=0;e<4;e++)h(a.colorIn[e].exp,a.colorIn[e].sel),h(a.alphaIn[e].exp,a.alphaIn[e].sel)}}function d(e,t,a,s){const i=e.colorIn[t];if(h(i.exp,i.sel),i.type=l(s),i.sel=a,i.exp=s,i.arg=null,r.assert(s!==e),7===a?i.type=n.TE_ZERO:8===a?(i.type=n.TE_IMM,i.arg=12,i.exp=null):12===a?(i.type=n.TE_IMM,i.arg=13,i.exp=null):a>=9&&a<=15&&(i.type=n.TE_KONST,i.arg=14,9===a?e.kcsel=7:10===a?e.kcsel=6:11===a?e.kcsel=5:13===a?e.kcsel=3:14===a?e.kcsel=2:15===a&&(e.kcsel=1)),i.type===n.TE_ZERO)i.sel=7,i.arg=15;else if(i.type===n.TE_TEV){r.assert(1===a||5===a),r.assert(l(s)===n.TE_TEV);const e=s;r.assert(3===t||1!==a||e.colorClamp),r.assert(3===t||5!==a||e.alphaClamp),c(i.exp,i.sel)}else if(i.type===n.TE_TEX)1===a?i.arg=8:2===a?(i.arg=8,e.texSwapTable=[0,0,0,0]):3===a?(i.arg=8,e.texSwapTable=[1,1,1,1]):4===a?(i.arg=8,e.texSwapTable=[2,2,2,2]):5===a&&(i.arg=9);else if(i.type===n.TE_RAS)1===a?i.arg=10:2===a?(i.arg=10,e.rasSwapTable=[0,0,0,0]):3===a?(i.arg=10,e.rasSwapTable=[1,1,1,1]):4===a?(i.arg=10,e.rasSwapTable=[2,2,2,2]):5===a&&(i.arg=11);else if(i.type===n.TE_CNST){r.assert(l(s)===n.TE_CNST);const e=s;i.sel=e.comp,c(i.exp,i.sel)}}function u(e,t,a,s){const i=e.alphaIn[t];if(h(i.exp,i.sel),i.type=l(s),i.sel=a,i.exp=s,i.arg=null,r.assert(s!==e),7===a?i.type=n.TE_ZERO:a>=8&&a<=15&&(i.type=n.TE_KONST,i.arg=6,9===a?e.kasel=7:10===a?e.kasel=6:11===a?e.kasel=5:13===a?e.kasel=3:14===a?e.kasel=2:15===a&&(e.kasel=1)),i.type===n.TE_ZERO)i.sel=7,i.arg=7;else if(i.type===n.TE_TEV){r.assert(5===a),r.assert(l(s)===n.TE_TEV);const e=s;r.assert(3===t||e.alphaClamp),c(i.exp,i.sel)}else if(i.type===n.TE_TEX)i.arg=4;else if(i.type===n.TE_RAS)i.arg=5;else if(i.type===n.TE_CNST){r.assert(5===a||6===a),r.assert(l(s)===n.TE_CNST);const e=s;r.assert(6===e.comp),i.sel=6,c(i.exp,i.sel)}}function m(e,t,a){let r=e.cnsts.find(e=>e.val===t&&e.comp===a);return void 0===r&&(r=new o(t,a),e.cnsts.push(r)),r}function p(e){h(e.exp,e.sel),e.type=n.TE_ZERO,e.sel=7,e.arg=null,e.exp=null}function f(e,t){c(t.exp,t.sel),h(e.exp,e.sel),e.type=t.type,e.sel=t.sel,e.arg=t.arg,e.exp=t.exp}function A(e,t){const a=e.type,r=e.sel,n=e.arg,s=e.exp;f(e,t),t.type=a,t.sel=r,t.arg=n,t.exp=s}function g(e,t){return null!==e.tex&&null!==t.tex||e.tex!==t.tex||(null!==e.chan&&null!==t.chan||e.chan!==t.chan)}function _(e,t,a){let r=0;return 2===a?r--:1===a&&r++,1===e&&(r=-r),2===t?r--:1===t&&r++,0===r?0:1===r?1:-1===r?2:null}function S(e,t){r.assert(!g(e,t)),null===e.tex&&(e.tex=t.tex),null===e.chan&&(e.chan=t.chan),void 0===e.texSwapTable&&(e.texSwapTable=t.texSwapTable),void 0===e.rasSwapTable&&(e.rasSwapTable=t.rasSwapTable)}function b(e){return 0===e.colorOp&&7===e.colorIn[0].sel&&7===e.colorIn[1].sel&&0===e.colorBias&&0===e.colorScale}function v(e){return 0===e.alphaOp&&7===e.alphaIn[0].sel&&7===e.alphaIn[1].sel&&0===e.alphaBias&&0===e.alphaScale}function w(e){if(l(e)===n.TE_TEV){const t=e;!function(e){for(;;){let t=!1,a=!1;for(let r=0;r<4;r++){const s=e.colorIn[r].type,i=e.alphaIn[r].type;s===n.TE_RAS||i===n.TE_RAS?t=!0:s!==n.TE_TEX&&i!==n.TE_TEX||(a=!0)}a||(e.tex=null,e.texSwapTable=void 0),t||(e.chan=7,e.rasSwapTable=void 0);let r=!1;if(null===e.alphaOp||14===e.alphaOp||15===e.alphaOp){if(null!==e.colorOp&&0===e.refColor){e.colorOp=null;for(let t=0;t<4;t++)p(e.colorIn[t]);r=!0}0===e.colorOp||1===e.colorOp?(7===e.colorIn[2].sel&&(7!==e.colorIn[1].sel&&(p(e.colorIn[1]),r=!0),0===e.colorOp&&7===e.colorIn[3].sel&&(f(e.colorIn[3],e.colorIn[0]),p(e.colorIn[0]),e.colorClamp=!0,r=!0)),8===e.colorIn[2].sel&&(7!==e.colorIn[0].sel&&(p(e.colorIn[0]),r=!0),0===e.colorOp&&7===e.colorIn[3].sel&&(f(e.colorIn[3],e.colorIn[1]),p(e.colorIn[1]),r=!0)),7===e.colorIn[0].sel&&8===e.colorIn[1].sel&&(f(e.colorIn[0],e.colorIn[2]),p(e.colorIn[1]),p(e.colorIn[2]),r=!0),7===e.colorIn[0].sel&&7===e.colorIn[1].sel&&8===e.colorIn[3].sel&&0===e.colorBias&&(e.colorOp=null)):8===e.colorOp||10===e.colorOp||12===e.colorOp||14===e.colorOp||9===e.colorOp||11===e.colorOp||13===e.colorOp||e.colorOp}else 0!==e.alphaOp&&1!==e.alphaOp||(7===e.alphaIn[2].sel&&(7!==e.alphaIn[1].sel&&(p(e.alphaIn[1]),r=!0),0===e.alphaOp&&7===e.alphaIn[3].sel&&(f(e.alphaIn[3],e.alphaIn[0]),p(e.alphaIn[0]),r=!0)),8===e.alphaIn[2].sel&&(7!==e.alphaIn[0].sel&&(p(e.alphaIn[0]),r=!0),0===e.alphaOp&&7===e.alphaIn[3].sel&&(f(e.alphaIn[3],e.alphaIn[1]),p(e.alphaIn[1]),r=!0)),7===e.alphaIn[0].sel&&8===e.alphaIn[1].sel&&(f(e.alphaIn[0],e.alphaIn[2]),p(e.alphaIn[1]),p(e.alphaIn[2]),r=!0),7===e.alphaIn[0].sel&&7===e.alphaIn[1].sel&&8===e.alphaIn[3].sel&&(e.alphaOp=null));if(!r)break}}(t),function(e){for(;;){let t=!1;if(null!==e.alphaOp&&14!==e.alphaOp&&15!==e.alphaOp&&0!==e.alphaOp&&1!==e.alphaOp)break;if((0===e.colorOp||1===e.colorOp)&&7===e.colorIn[1].sel&&7===e.colorIn[2].sel&&l(e.colorIn[0].exp)!==n.TE_CNST&&l(e.colorIn[3].exp)!==n.TE_CNST){if(0===e.colorOp&&(e.colorIn[0].type===n.TE_TEX||e.colorIn[0].type===n.TE_RAS)&&e.colorIn[3].type===n.TE_TEV){const t=e.colorIn[3].exp;(1===e.colorIn[3].sel&&t.colorClamp||5===e.colorIn[3].sel&&t.alphaClamp)&&A(e.colorIn[0],e.colorIn[3])}if(e.colorIn[0].type===n.TE_TEV&&1===e.colorIn[0].sel){const a=e.colorIn[0].sel,r=e.colorIn[0].exp;if((0===r.colorOp||1===r.colorOp)&&7===r.colorIn[3].sel&&0===r.colorScale&&!g(e,r)){const n=_(r.colorOp,e.colorBias,r.colorBias);if(null!==n){e.colorBias=n,1===r.colorOp&&(e.colorOp=0===e.colorOp?1:0);for(let t=0;t<3;t++)f(e.colorIn[t],r.colorIn[t]);S(e,r),h(e,a),t=!0}}}else if(e.colorIn[0].type!==n.TE_TEV&&0===e.alphaOp&&e.colorIn[3].type===n.TE_TEV&&1===e.colorIn[3].sel){const a=e.colorIn[3].sel,n=e.colorIn[3].exp;if(0===n.colorScale&&(0===e.colorBias||e.colorBias!==n.colorBias)&&!g(e,n)){for(let t=0;t<4;t++)f(e.colorIn[t],n.colorIn[t]);e.colorOp=n.colorOp,e.colorBias=r.assertExists(_(e.colorOp,e.colorBias,n.colorBias)),e.colorClamp=e.colorClamp||n.colorClamp,S(e,n),h(n,a),t=!0}}}if((0===e.alphaOp||1===e.alphaOp)&&7===e.alphaIn[1].sel&&7===e.alphaIn[2].sel&&l(e.alphaIn[0].exp)!==n.TE_CNST&&(l(e.alphaIn[3].exp),n.TE_CNST),!t)break}}(t)}}function x(e){r.assert(l(e)===n.TE_TEV);const t=[e];for(let e=0;e<t.length;e++)for(let a=0;a<4;a++){if(t[e].colorIn[a].type===n.TE_TEV){const r=t[e].colorIn[a].exp;t.includes(r)||t.push(r)}if(t[e].alphaIn[a].type===n.TE_TEV){const r=t[e].alphaIn[a].exp;t.includes(r)||t.push(r)}}const a=r.nArray(t.length,()=>-1);!function e(t,a,s,i){const o=a.indexOf(s);r.assert(o>=0),t[o]=Math.max(t[o],i);for(let o=0;o<4;o++)s.colorIn[o].type===n.TE_TEV&&e(t,a,s.colorIn[o].exp,i+1),s.alphaIn[o].type===n.TE_TEV&&(r.assert(s.alphaIn[o].exp!==s),e(t,a,s.alphaIn[o].exp,i+1))}(a,t,t[0],0);const s=t.slice();t.sort((e,t)=>a[s.indexOf(e)]-a[s.indexOf(t)]);const i=r.nArray(t.length,()=>({tev:null,idx:-1,dependencies:[]}));for(let e=t.length-1;e>=0;e--){const a=t[e],r=i[e];r.tev=a,r.idx=e;for(let s=0;s<4;s++){if(a.colorIn[s].type===n.TE_TEV){const n=t.indexOf(a.colorIn[s].exp,e);r.dependencies.includes(i[n])||r.dependencies.push(i[n])}if(a.alphaIn[s].type===n.TE_TEV){const n=t.indexOf(a.alphaIn[s].exp,e);r.dependencies.includes(i[n])||r.dependencies.push(i[n])}}}return i}function T(e,t,a,r,s,i,o,c,h){if(c|=1<<o,a[i]=o,++i>=r.length){const r=function(e,t){let a=4,r=4;const s=[0,0,0,0],i=[0,0,0,0];for(let o=e.length-1;o>=0;o--){const c=e[t[o]].tev;for(let e=0;e<4;e++){if(l(c.colorIn[e].exp)===n.TE_TEV){const t=c.colorIn[e].exp;1===c.colorIn[e].sel?s[t.dstRegColor]--:i[t.dstRegAlpha]--}if(l(c.alphaIn[e].exp)===n.TE_TEV){i[c.alphaIn[e].exp.dstRegAlpha]--}}if(c.refColor>0)for(let e=3;e>=0;e--)if(0===s[e]){s[e]=c.refColor,c.dstRegColor=e,a=Math.min(e,a);break}if(c.refAlpha>0)for(let e=3;e>=0;e--)if(0===i[e]){i[e]=c.refAlpha,c.dstRegAlpha=e,r=Math.min(e,r);break}}return 4-a+(4-r)}(t,a);r<e.bestRegsUsed&&(e.bestRegsUsed=r,e.bestOrder=a.slice())}else{let n=h&~(1<<o)|r[o],l=0;for(let e=0;e<t.length;e++)n&1<<e&&(l|=s[e]);if(n&=~l,1===t[o].dependencies.length&&n&r[o])T(e,t,a,r,s,i,t[o].dependencies[0].idx,c,n);else for(let o=0;o<t.length;o++)n&1<<o&&T(e,t,a,r,s,i,o,c,n)}}function y(e,t){const a=function(e){const t=r.nArray(e.length,()=>0);for(let a=0;a<e.length;a++){const r=e[a];for(let e=0;e<r.dependencies.length;e++)t[a]|=1<<r.dependencies[e].idx}return t}(t),s=function(e,t,a){const n={bestRegsUsed:5,bestOrder:[]};return T(n,e,r.nArray(e.length,()=>-1),t,a,0,0,0,0),n.bestOrder}(t,a,function(e){const t=e.slice();for(;;){let e=!1;for(let a=0;a<t.length;a++)for(let r=0;r<t.length;r++)0!=(1<<a&t[r])&&(t[r]&t[a])!==t[a]&&(t[r]|=t[a],e=!0);if(!e)break}return t}(a)),i=[2,4,6,0],o=[3,5,7,1],c=[1,2,3,0],h=[];for(let a=0;a<s.length;a++){const d=t[s[a]].tev;if(h[a]=d,null!==d.dstRegColor){e.regsColor[d.dstRegColor+4]=3;for(let e=0;e<4;e++)if(l(d.colorIn[e].exp)===n.TE_TEV){const t=d.colorIn[e].exp;1===d.colorIn[e].sel?d.colorIn[e].arg=r.assertExists(i[t.dstRegColor]):d.colorIn[e].arg=r.assertExists(o[t.dstRegAlpha])}}if(null!==d.dstRegAlpha){e.regsAlpha[d.dstRegAlpha+4]=1;for(let e=0;e<4;e++)if(l(d.alphaIn[e].exp)===n.TE_TEV){const t=d.alphaIn[e].exp;d.alphaIn[e].arg=r.assertExists(c[t.dstRegAlpha])}}}return h}function C(e,t,a){const r=[[16,20,24,28],[17,21,25,29],[18,22,26,30],[19,23,27,31]],s=[12,13,14,15],i=e.colorIn[t].exp;if(null===i.reg)if(6===i.comp){for(let e=1;e<4;e++)if(0===a.regsAlpha[e]){i.reg=e,i.idx=3,a.regsAlpha[e]=1;break}for(let e=0;e<4;e++)if(a.regsColor[e]<3){i.reg=e,i.idx=a.regsAlpha[e],a.regsColor[e]++;break}}else for(let e=0;e<4;e++)if(0===a.regsColor[e]){i.reg=e,i.idx=0,a.regsColor[e]=3;break}return null!==i.reg&&i.reg<4&&null!==i.idx&&(e.colorIn[t].type=n.TE_KONST,e.colorIn[t].arg=14,6===i.comp?e.kcsel=r[i.reg][i.idx]:e.kcsel=s[i.reg],!0)}function M(e,t,a){const r=[2,4,6,0],s=[3,5,7,1],i=e.colorIn[t].exp;if(null===i.reg)if(6===i.comp){for(let e=4;e<8;e++)if(0===a.regsAlpha[e]){i.reg=e,i.idx=3,a.regsAlpha[e]=1;break}}else for(let e=4;e<8;e++)if(0===a.regsColor[e]){i.reg=e,i.idx=0,a.regsColor[e]=3;break}return null!==i.reg&&i.reg>=4&&null!==i.idx&&(e.colorIn[t].type=n.TE_IMM,6===i.comp?e.colorIn[t].arg=s[i.reg-4]:e.colorIn[t].arg=r[i.reg-4],!0)}function U(e,t,a){const r=[[16,20,24,28],[17,21,25,29],[18,22,26,30],[19,23,27,31]],s=e.alphaIn[t].exp;if(null===s.reg){for(let e=1;e<4;e++)if(0===a.regsAlpha[e]){s.reg=e,s.idx=3,a.regsAlpha[e]=1;break}for(let e=0;e<4;e++)if(a.regsColor[e]<3){s.reg=e,s.idx=a.regsAlpha[e],a.regsColor[e]++;break}}return null!==s.reg&&s.reg<4&&null!==s.idx&&(e.alphaIn[t].type=n.TE_KONST,e.alphaIn[t].arg=6,e.kasel=r[s.reg][s.idx],!0)}function k(e,t,a){const r=[1,2,3,0],s=e.alphaIn[t].exp;if(null===s.reg)for(let e=4;e<8;e++)if(0===a.regsAlpha[e]){s.reg=e,s.idx=3,a.regsAlpha[e]=1,window.debug&&console.log("assigning alpha reg!",e);break}return null!==s.reg&&s.reg>=4&&null!==s.idx&&(e.alphaIn[t].type=n.TE_IMM,e.alphaIn[t].arg=r[s.reg-4],!0)}function D(e,t){if(e.refColor>0)if(null===e.kcsel){if(b(e)&&e.colorIn[3].type===n.TE_CNST){if(!C(e,3,t))return M(e,3,t)}else for(let a=0;a<4;a++)if(e.colorIn[a].type===n.TE_CNST&&!C(e,a,t))return M(e,a,t)}else for(let a=0;a<4;a++)if(e.colorIn[a].type===n.TE_CNST)return M(e,a,t);if(e.refAlpha>0)if(null===e.kasel){if(v(e)&&e.alphaIn[3].type===n.TE_CNST){if(!k(e,3,t))return U(e,3,t)}else for(let a=0;a<4;a++)if(e.alphaIn[a].type===n.TE_CNST&&!U(e,a,t))return k(e,a,t)}else for(let a=0;a<4;a++)if(e.alphaIn[a].type===n.TE_CNST)return k(e,a,t);return!0}function I(e){for(let t=0;t<4;t++)if(e.colorIn[t].type===n.TE_TEV&&1===e.colorIn[t].sel){const a=e.colorIn[t].exp;if(b(a)){if(a.colorIn[3].type===n.TE_KONST){if(null===e.kcsel)e.kcsel=a.kcsel;else if(e.kcsel!==a.kcsel)continue}else if(a.colorIn[3].type!==n.TE_IMM)continue;f(e.colorIn[t],a.colorIn[3])}}for(let t=0;t<4;t++)if(e.alphaIn[t].type===n.TE_TEV){const a=e.alphaIn[t].exp;if(v(a)){if(a.alphaIn[3].type===n.TE_KONST){if(null===e.kasel)e.kasel=a.kasel;else if(e.kasel!==a.kasel)continue}else if(a.alphaIn[3].type!==n.TE_IMM)continue;f(e.alphaIn[t],a.alphaIn[3])}}}function R(e,t,a,r){var n,s,i,o,l,c,h,d,u,m;null!==a.tex?e.setTevOrder(t,a.tex.texCoordID,a.tex.texMapID,a.chan):e.setTevOrder(t,255,255,a.chan),e.setTevSwapMode(t,a.rasSwapTable,a.texSwapTable),e.setTevKColorSel(t,null!=(n=a.kcsel)?n:0),e.setTevKAlphaSel(t,null!=(s=a.kasel)?s:0);const p=[1,2,3,0];if(null===a.colorOp||0===a.refColor&&8!==a.alphaOp&&9!==a.alphaOp&&10!==a.alphaOp&&11!==a.alphaOp&&12!==a.alphaOp&&13!==a.alphaOp)e.setTevColorOp(t,0,0,0,!1,0),e.setTevColorIn(t,15,15,15,r.initCPREV?15:0),r.initCPREV=!1;else{const n=p[a.dstRegColor];e.setTevColorOp(t,a.colorOp,a.colorBias,a.colorScale,a.colorClamp,n),e.setTevColorIn(t,null!=(i=a.colorIn[0].arg)?i:15,null!=(o=a.colorIn[1].arg)?o:15,null!=(l=a.colorIn[2].arg)?l:15,null!=(c=a.colorIn[3].arg)?c:15),0===n&&(r.initCPREV=!1)}if(null===a.alphaOp||0===a.refAlpha)e.setTevAlphaOp(t,0,0,0,!1,0),e.setTevAlphaIn(t,7,7,7,r.initAPREV?7:0),r.initAPREV=!1;else{const n=p[a.dstRegAlpha];e.setTevAlphaOp(t,a.alphaOp,a.alphaBias,a.alphaScale,a.alphaClamp,n),e.setTevAlphaIn(t,null!=(h=a.alphaIn[0].arg)?h:7,null!=(d=a.alphaIn[1].arg)?d:7,null!=(u=a.alphaIn[2].arg)?u:7,null!=(m=a.alphaIn[3].arg)?m:7),0===n&&(r.initAPREV=!1)}}function B(e){console.log(function e(t,a=l(t),s=null,i=null,o=""){function c(t){return e(t.exp,t.type,t.arg,t.sel,o+"    ")}if(a===n.TE_ZERO)return"TE_ZERO ";if(a===n.TE_TEV){const e=t;return r.assert(null===s),`TE_TEV  {\n${o}  CA: ${c(e.colorIn[0])}\n${o}  CB: ${c(e.colorIn[1])}\n${o}  CC: ${c(e.colorIn[2])}\n${o}  CD: ${c(e.colorIn[3])}\n${o}  \n${o}  AA: ${c(e.alphaIn[0])}\n${o}  AB: ${c(e.alphaIn[1])}\n${o}  AC: ${c(e.alphaIn[2])}\n${o}  AD: ${c(e.alphaIn[3])}\n${o}}`}if(a===n.TE_TEX)return r.assert(1===i||5===i),`TE_TEX  <${1===i?"RGB":"A"}>`;if(a===n.TE_RAS)return r.assert(1===i||5===i),`TE_RAS  <${1===i?"RGB":"A"}>`;if(a===n.TE_CNST){const e=t;return r.assert(null===s),r.assert(1===i||6===i),`TE_CNST <${e.val}, ${1===i?"RGB":"X"}>`}return a===n.TE_IMM?(r.assert(null!==s),r.assert(null!==i),`TE_IMM  <${i} / ${s}>`):"UNDEF"}(e))}function P(e){function t(t){return t.type===n.TE_TEV?`${n[t.type]} / ${t.arg} / ${e.length-e.indexOf(t.exp)-1}`:`${null===t.type?"UNDEF":n[t.type]} / ${t.arg}`}function a(e,a){return`[${a}] = TE_TEV {\n  CRef: ${e.refColor}\n  CDst: ${e.dstRegColor}\n  COp: ${e.colorOp}\n  CA: ${t(e.colorIn[0])}\n  CB: ${t(e.colorIn[1])}\n  CC: ${t(e.colorIn[2])}\n  CD: ${t(e.colorIn[3])}\n\n  AA: ${t(e.alphaIn[0])}\n  AB: ${t(e.alphaIn[1])}\n  AC: ${t(e.alphaIn[2])}\n  AD: ${t(e.alphaIn[3])}\n}`}let r="";for(let t=0;t<e.length;t++)r+=a(e[e.length-t-1],t)+"\n";console.log(r)}t.HSD_TExpList=class{constructor(){this.debug=!1,this.tevs=[],this.cnsts=[]}},t.HSD_TExpGetType=l,t.HSD_TExpOrder=function(e,t,a){e.tex=t,e.chan=a},t.HSD_TExpColorOp=function(e,t,a,r,n){e.colorOp=t,e.colorClamp=n,t<=1?(e.colorBias=a,e.colorScale=r):(e.colorBias=0,e.colorScale=0)},t.HSD_TExpColorIn=function(e,t,a,r,n,s,i,o,l){d(e,0,t,a),d(e,1,r,n),d(e,2,s,i),d(e,3,o,l)},t.HSD_TExpAlphaOp=function(e,t,a,r,n){e.alphaOp=t,e.alphaClamp=n,t<=1?(e.alphaBias=a,e.alphaScale=r):(e.alphaBias=0,e.alphaScale=0)},t.HSD_TExpAlphaIn=function(e,t,a,r,n,s,i,o,l){u(e,0,t,a),u(e,1,r,n),u(e,2,s,i),u(e,3,o,l)},t.HSD_TExpTev=function(e){const t=new i;return e.tevs.unshift(t),t},t.HSD_TExpCnst=function(e,t,a){return r.assert(t<3),m(e,t,a)},t.HSD_TExpCnstTObj=function(e,t,a,n){return r.assert(a>=3),r.assert((65535&a)===a),m(e,a|=t<<16,n)},t.HSD_TExpCompile=function(e,t){const a=e.root;e.debug&&(console.log("Unsimplified"),B(a)),c(a,1),c(a,5),w(a),e.debug&&(console.log("Simplify 1"),B(a));const n={regsColor:r.nArray(8,()=>0),regsAlpha:r.nArray(8,()=>0)},s=y(n,x(a));r.assert(s.length>=1),e.debug&&(console.log("Schedule 1 Pre"),P(s));for(let e=0;e<s.length;e++){const t=D(s[e],n);r.assert(t)}e.debug&&(console.log("Schedule 1 Assign"),P(s));for(let e=s.length-1;e>=0;e--)I(s[e]);e.debug&&(console.log("Simplify2"),P(s));const i=y(n,x(a));e.debug&&(console.log("Schedule 2"),P(i));const o={initCPREV:!0,initAPREV:!0};for(let e=0;e<i.length;e++)R(t,e,i[i.length-e-1],o)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(199),n=a(0);function s(e,t){const a=t.createDataView(),n=a.getUint16(0),s=a.getUint8(4),i=a.getUint8(5),o=a.getUint8(6),l=a.getUint32(8),c=r.HSD_LoadContext__ResolvePtr(e,l,n);return{type:s,keyframes:r.HSD_FObjLoadKeyframes(e,c,i,o)}}t.Melee_figatree_Track_Load=s,t.Melee_figatree_Load=function(e){n.assert(1===e.publics.length);const t=e.publics[0],a=new r.HSD_LoadContext(e),i=r.HSD_LoadContext__ResolvePtr(a,t.offset).createDataView(),o=i.getInt32(0);n.assert(1===o);const l=i.getFloat32(8),c=i.getUint32(12),h=r.HSD_LoadContext__ResolvePtr(a,c).createDataView(),d=i.getUint32(16),u=r.HSD_LoadContext__ResolvePtr(a,d),m=[];let p=0;for(let e=0;;e++){const t=h.getUint8(e);if(255===t)break;const r=[];for(let e=0;e<t;e++)r.push(s(a,u.subarray(p,12))),p+=12;const n=536870912;m.push({flags:n,endFrame:l,fobj:r,objID:0})}return{kind:"Anim",name:t.name,endFrame:l,aobj:m}},t.Melee_SplitDataAJ=function(e,t){const a=[];for(let s=0;s<t.length;s++){const i=t[s];if(null===i.symbolStr)n.assert(0===i.animJointOffs),n.assert(0===i.animJointSize),a[s]=null;else{n.assert(0!==i.animJointSize);const t=r.HSD_ArchiveParse(e.subarray(i.animJointOffs,i.animJointSize));n.assert(1===t.publics.length),n.assert(t.publics[0].name===i.symbolStr),a[s]=t}}return a},t.Melee_ftData_Load=function(e,t){const a=new r.HSD_LoadContext(e);return function(e,t){const a=t.createDataView(),n=r.HSD_LoadContext__ResolvePtrAutoSize(e,a.getUint32(12)),s=[],i=n.byteLength/24,o=n.createDataView();let l=0;for(let t=0;t<i;t++){const t=o.getUint32(l+0);let a=null;0!==t&&(a=r.HSD_LoadContext__ResolvePtrString(e,t));const n=o.getUint32(l+4),i=o.getUint32(l+8),c=o.getUint32(l+12),h=o.getUint32(l+16);s.push({symbolStr:a,animJointOffs:n,animJointSize:i,subActionDataOffs:c,flags:h}),l+=24}return{subActionTable:s}}(a,r.HSD_LoadContext__ResolvePtr(a,t.offset))}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(11)),s=r(a(64)),i=a(9),o=a(23),l=a(7),c=a(200),h=a(124),d=a(77),u=a(10),m=a(0),p=a(341);class f{constructor(e,t,a){this.textureHolder=t,this.renderData=[],this.modelRenderers=[],this.renderTarget=new i.BasicRenderTarget,this.renderHelper=new o.GfxRenderHelper(e),this.globals=new p.LevelGlobals(a)}adjustCameraController(e){e.setSceneMoveSpeedMult(32/60)}createPanels(){const e=new n.Panel;e.customHeaderBackgroundColor=n.COOL_BLUE_COLOR,e.setTitle(n.RENDER_HACKS_ICON,"Render Hacks");const t=new n.Checkbox("Enable Culling",!0);t.onchanged=()=>{for(let e=0;e<this.modelRenderers.length;e++)this.modelRenderers[e].setBackfaceCullingEnabled(t.checked)},e.contents.appendChild(t.elem);const a=new n.Checkbox("Enable Vertex Colors",!0);a.onchanged=()=>{for(let e=0;e<this.modelRenderers.length;e++)this.modelRenderers[e].setVertexColorsEnabled(a.checked)},e.contents.appendChild(a.elem);const r=new n.Checkbox("Enable Textures",!0);r.onchanged=()=>{for(let e=0;e<this.modelRenderers.length;e++)this.modelRenderers[e].setTexturesEnabled(r.checked)},e.contents.appendChild(r.elem);const s=new n.Checkbox("Grayscale Vertex Colors",!1);s.onchanged=()=>{for(let e=0;e<this.modelRenderers.length;e++)this.modelRenderers[e].setMonochromeVertexColorsEnabled(s.checked)},e.contents.appendChild(s.elem);const i=new n.Checkbox("Visualize Vertex Alpha",!1);return i.onchanged=()=>{for(let e=0;e<this.modelRenderers.length;e++)this.modelRenderers[e].setAlphaVisualizerEnabled(i.checked)},e.contents.appendChild(i.elem),[e]}prepareToRender(e,t,a){this.globals.update(a),this.renderHelper.pushTemplateRenderInst();for(let t=0;t<this.modelRenderers.length;t++)this.modelRenderers[t].prepareToRender(e,this.renderHelper.renderInstManager,a,this.globals);this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderHelper.renderInstManager,n=this.renderTarget.createRenderPass(e,t.viewport,i.transparentBlackFullClearRenderPassDescriptor);l.executeOnPass(r,e,n,2),e.submitPass(n);const s=this.renderTarget.createRenderPass(e,t.viewport,i.depthClearRenderPassDescriptor);return l.executeOnPass(r,e,s,1),r.resetRenderInsts(),s}destroy(e){this.renderTarget.destroy(e),this.renderHelper.destroy(e);for(let t=0;t<this.renderData.length;t++)this.renderData[t].destroy(e)}}class A{constructor(e,t){this.id=e,this.name=t}createScene(e,t){const a=[this.id,"0E","magikarp"];switch(this.id){case"10":a.push("pikachu");break;case"12":a.push("pikachu","zubat");break;case"16":a.push("pikachu","bulbasaur");break;case"14":a.push("pikachu","bulbasaur","zubat")}return Promise.all(a.map(e=>t.dataFetcher.fetchData(`PokemonSnap/${e}_arc.crg1?cache_bust=3`))).then(t=>{const a=t.map(e=>s.parse(e,1)),r=[],n=new u.FakeTextureHolder(r),i=new f(e,n,this.id),o=h.parseLevel(a);for(let e=0;e<o.sharedCache.textures.length;e++)r.push(d.textureToCanvas(o.sharedCache.textures[e]));if(i.globals.collision=o.collision,p.sceneActorInit(),null!==o.skybox){const t=new d.RenderData(e,i.renderHelper.getCache(),o.skybox.node.model.sharedOutput),a=new c.ModelRenderer(t,[o.skybox.node],[],!0);null!==o.skybox.animation&&(a.animations.push(o.skybox.animation),a.setAnimation(0)),a.forceLoop(),i.renderData.push(t),i.modelRenderers.push(a)}const l=new d.RenderData(e,i.renderHelper.getCache(),o.zeroOne.sharedOutput);i.renderData.push(l);const A=[];for(let t=0;t<o.projectiles.length;t++)A.push(new d.RenderData(e,i.renderHelper.getCache(),o.projectiles[t].sharedOutput));i.renderData.push(...A);const g=[];for(let t=0;t<o.objectInfo.length;t++){const a=new d.RenderData(e,i.renderHelper.getCache(),o.objectInfo[t].sharedOutput);g.push(a),i.renderData.push(a);for(let e=0;e<a.sharedOutput.textureCache.textures.length;e++)r.push(d.textureToCanvas(a.sharedOutput.textureCache.textures[e]))}i.modelRenderers.push(...i.globals.buildTempObjects(o.objectInfo,g,l,A,o));for(let t=0;t<o.rooms.length;t++){const a=new d.RenderData(e,i.renderHelper.getCache(),o.rooms[t].node.model.sharedOutput),r=new c.ModelRenderer(a,[o.rooms[t].node],[]);null!==o.rooms[t].animation&&(r.animations.push(o.rooms[t].animation),r.setAnimation(0)),r.forceLoop(),i.renderData.push(a),i.modelRenderers.push(r);const n=o.rooms[t].objects;for(let e=0;e<n.length;e++){const t=o.objectInfo.findIndex(t=>t.id===n[e].id);if(-1===t){console.warn("missing object",m.hexzero(n[e].id,3));continue}const a=o.objectInfo[t];if(h.isActor(a)){const r=p.createActor(g[t],n[e],a,i.globals);133===a.id&&(r.motionData.path=n.find(e=>113===e.id).path),i.globals.allActors.push(r),i.modelRenderers.push(r)}else{const r=new c.ModelRenderer(g[t],[a.node],[]);c.buildTransform(r.modelMatrix,n[e].pos,n[e].euler,n[e].scale),i.modelRenderers.push(r)}}}return i})}}const g=[new A("10","Beach"),new A("12","Tunnel"),new A("18","Volcano"),new A("16","River"),new A("14","Cave"),new A("1A","Valley"),new A("1C","Rainbow Cloud")];t.sceneGroup={id:"snap",name:"Pokemon Snap",sceneDescs:g}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(58)),s=r(a(48)),i=a(0),o=a(1);class l extends n.DrawCall{constructor(){super(...arguments),this.DP_PrimColor=o.vec4.fromValues(1,1,1,1),this.DP_EnvColor=o.vec4.fromValues(1,1,1,1),this.DP_PrimLOD=0,this.materialIndex=-1}}t.DrawCall=l;class c extends n.RSPOutput{constructor(){super(...arguments),this.drawCalls=[],this.currentDrawCall=new l}newDrawCall(e){return this.currentDrawCall=new l,this.currentDrawCall.firstIndex=e,this.drawCalls.push(this.currentDrawCall),this.currentDrawCall}}t.RSPOutput=c;var h;t.RSPState=class{constructor(e,t){this.sharedOutput=e,this.dataMap=t,this.output=new c,this.stateChanged=!1,this.minorChange=!1,this.vertexCache=i.nArray(64,()=>new n.StagingVertex),this.SP_GeometryMode=0,this.SP_TextureState=new n.TextureState,this.DP_OtherModeL=0,this.DP_OtherModeH=0,this.DP_CombineL=0,this.DP_CombineH=0,this.DP_TextureImageState=new n.TextureImageState,this.DP_TileState=i.nArray(8,()=>new s.TileState),this.DP_TMemTracker=new Map,this.DP_PrimColor=o.vec4.create(),this.DP_EnvColor=o.vec4.create(),this.DP_PrimLOD=0,this.SP_MatrixIndex=0,this.DP_Half1=0,this.materialIndex=-1}finish(){return 0===this.output.drawCalls.length?null:this.output}clear(){this.SP_MatrixIndex=0,this.output=new c,this.stateChanged=!0,this.materialIndex=-1;for(let e=0;e<this.vertexCache.length;e++)this.vertexCache[e].matrixIndex=1,this.vertexCache[e].outputIndex=-1}_setGeometryMode(e){this.SP_GeometryMode!==e&&(this.minorChange=!0,this.SP_GeometryMode=e)}gSPSetGeometryMode(e){this._setGeometryMode(this.SP_GeometryMode|e)}gSPClearGeometryMode(e){this._setGeometryMode(this.SP_GeometryMode&~e)}gSPTexture(e,t,a,r,n){this.SP_TextureState.set(e,t,a,r/65536,n/65536),this.stateChanged=!0}gSPVertex(e,t,a){const r=this.dataMap.getView(e);for(let e=0;e<t;e++)this.vertexCache[a+e].setFromView(r,16*e),this.vertexCache[a+e].tx*=this.SP_TextureState.s,this.vertexCache[a+e].ty*=this.SP_TextureState.t,this.vertexCache[a+e].matrixIndex=this.SP_MatrixIndex}gSPModifyVertex(e,t,a,r){const n=this.vertexCache[t];switch(e){case 20:n.tx=a/32+.5,n.ty=r/32+.5;break;default:console.warn("new modifyvtx",e,a,r)}n.outputIndex=-1}_translateTileTexture(e){const t=this.DP_TileState[e],a=i.assertExists(this.DP_TMemTracker.get(t.tmem));let r;if(2===t.fmt){this.DP_OtherModeH;const e=256+(t.palette<<4);r=i.assertExists(this.DP_TMemTracker.get(e))}else r=0;const n=this.dataMap.getRange(a);return this.sharedOutput.textureCache.translateTileTexture([n.data],a-n.start,r-n.start,t)}_flushTextures(e){if(!this.SP_TextureState.on)return;if(!!(this.DP_OtherModeH>>>16&1))i.assert(!1);else{const t=n.getCycleTypeFromOtherModeH(this.DP_OtherModeH);i.assert(0===t||1===t),e.textureIndices.push(this._translateTileTexture(this.SP_TextureState.tile)),0===this.SP_TextureState.level&&s.combineParamsUsesT1(e.DP_Combine)&&e.textureIndices.push(this._translateTileTexture(this.SP_TextureState.tile+1))}}_flushDrawCall(){if(this.stateChanged||this.minorChange){this.materialIndex===this.output.currentDrawCall.materialIndex&&this.stateChanged&&(this.materialIndex=-1),this.stateChanged=!1,this.minorChange=!1;const e=this.output.newDrawCall(this.sharedOutput.indices.length);e.SP_GeometryMode=this.SP_GeometryMode,e.SP_TextureState.copy(this.SP_TextureState),e.DP_Combine=s.decodeCombineParams(this.DP_CombineH,this.DP_CombineL),e.DP_OtherModeH=this.DP_OtherModeH,e.DP_OtherModeL=this.DP_OtherModeL,o.vec4.copy(e.DP_PrimColor,this.DP_PrimColor),o.vec4.copy(e.DP_EnvColor,this.DP_EnvColor),e.DP_PrimLOD=this.DP_PrimLOD,e.materialIndex=this.materialIndex,this._flushTextures(e)}}gSPTri(e,t,a){this._flushDrawCall(),this.sharedOutput.loadVertex(this.vertexCache[e]),this.sharedOutput.loadVertex(this.vertexCache[t]),this.sharedOutput.loadVertex(this.vertexCache[a]),this.sharedOutput.indices.push(this.vertexCache[e].outputIndex,this.vertexCache[t].outputIndex,this.vertexCache[a].outputIndex),this.output.currentDrawCall.indexCount+=3}gDPSetTextureImage(e,t,a,r){this.DP_TextureImageState.set(e,t,a,r)}gDPSetTile(e,t,a,r,n,s,i,o,l,c,h,d){this.DP_TileState[n].set(e,t,a,r,s,i,o,l,c,h,d)}gDPLoadTLUT(e,t){const a=this.DP_TileState[e].tmem;this.DP_TMemTracker.set(a,this.DP_TextureImageState.addr)}gDPLoadBlock(e,t,a,r,n){i.assert(0===t&&0===a);const s=this.DP_TileState[e];this.DP_TMemTracker.set(s.tmem,this.DP_TextureImageState.addr),this.stateChanged=!0}gDPSetTileSize(e,t,a,r,n){this.DP_TileState[e].setSize(t,a,r,n),this.stateChanged=!0}gDPSetOtherModeL(e,t,a){const r=(1<<t)-1<<e,n=this.DP_OtherModeL&~r|a&r;n!==this.DP_OtherModeL&&(this.DP_OtherModeL=n,this.stateChanged=!0)}gDPSetOtherModeH(e,t,a){const r=(1<<t)-1<<e,n=this.DP_OtherModeH&~r|a&r;n!==this.DP_OtherModeH&&(this.DP_OtherModeH=n,this.stateChanged=!0)}gDPSetCombine(e,t){this.DP_CombineH===e&&this.DP_CombineL===t||(this.DP_CombineH=e,this.DP_CombineL=t,this.stateChanged=!0)}gSPSetPrimColor(e,t,a,r,n){o.vec4.set(this.DP_PrimColor,t/255,a/255,r/255,n/255),this.DP_PrimLOD=e/255,this.stateChanged=!0}gSPSetEnvColor(e,t,a,r){o.vec4.set(this.DP_EnvColor,e/255,t/255,a/255,r/255),this.stateChanged=!0}},function(e){e[e.G_VTX=1]="G_VTX",e[e.G_MODIFYVTX=2]="G_MODIFYVTX",e[e.G_CULLDL=3]="G_CULLDL",e[e.G_BRANCH_Z=4]="G_BRANCH_Z",e[e.G_TRI1=5]="G_TRI1",e[e.G_TRI2=6]="G_TRI2",e[e.G_QUAD=7]="G_QUAD",e[e.G_LINE3D=8]="G_LINE3D",e[e.G_TEXTURE=215]="G_TEXTURE",e[e.G_POPMTX=216]="G_POPMTX",e[e.G_GEOMETRYMODE=217]="G_GEOMETRYMODE",e[e.G_MTX=218]="G_MTX",e[e.G_MOVEWORD=219]="G_MOVEWORD",e[e.G_DL=222]="G_DL",e[e.G_ENDDL=223]="G_ENDDL",e[e.G_SETCIMG=255]="G_SETCIMG",e[e.G_SETZIMG=254]="G_SETZIMG",e[e.G_SETTIMG=253]="G_SETTIMG",e[e.G_SETCOMBINE=252]="G_SETCOMBINE",e[e.G_SETENVCOLOR=251]="G_SETENVCOLOR",e[e.G_SETPRIMCOLOR=250]="G_SETPRIMCOLOR",e[e.G_SETBLENDCOLOR=249]="G_SETBLENDCOLOR",e[e.G_SETFOGCOLOR=248]="G_SETFOGCOLOR",e[e.G_SETFILLCOLOR=247]="G_SETFILLCOLOR",e[e.G_FILLRECT=246]="G_FILLRECT",e[e.G_SETTILE=245]="G_SETTILE",e[e.G_LOADTILE=244]="G_LOADTILE",e[e.G_LOADBLOCK=243]="G_LOADBLOCK",e[e.G_SETTILESIZE=242]="G_SETTILESIZE",e[e.G_LOADTLUT=240]="G_LOADTLUT",e[e.G_RDPSETOTHERMODE=239]="G_RDPSETOTHERMODE",e[e.G_SETPRIMDEPTH=238]="G_SETPRIMDEPTH",e[e.G_SETSCISSOR=237]="G_SETSCISSOR",e[e.G_SETCONVERT=236]="G_SETCONVERT",e[e.G_SETKEYR=235]="G_SETKEYR",e[e.G_SETKEYFB=234]="G_SETKEYFB",e[e.G_RDPFULLSYNC=233]="G_RDPFULLSYNC",e[e.G_RDPTILESYNC=232]="G_RDPTILESYNC",e[e.G_RDPPIPESYNC=231]="G_RDPPIPESYNC",e[e.G_RDPLOADSYNC=230]="G_RDPLOADSYNC",e[e.G_TEXRECTFLIP=229]="G_TEXRECTFLIP",e[e.G_TEXRECT=228]="G_TEXRECT",e[e.G_SETOTHERMODE_H=227]="G_SETOTHERMODE_H",e[e.G_SETOTHERMODE_L=226]="G_SETOTHERMODE_L",e[e.G_RDPHALF_1=225]="G_RDPHALF_1"}(h||(h={})),t.runDL_F3DEX2=function e(t,a,r=e){const n=t.dataMap.getView(a);for(let a=0;a<n.byteLength;a+=8){const s=n.getUint32(a+0),o=n.getUint32(a+4),l=s>>>24;switch(window.debug&&console.log(i.hexzero(a,8),h[l],i.hexzero(s,8),i.hexzero(o,8)),l){case h.G_ENDDL:return;case h.G_GEOMETRYMODE:t.gSPClearGeometryMode(~(16777215&s)),t.gSPSetGeometryMode(o);break;case h.G_SETTIMG:{const e=s>>>21&7,a=s>>>19&3,r=1+(4095&s);t.gDPSetTextureImage(e,a,r,o)}break;case h.G_SETTILE:{const e=s>>>21&7,a=s>>>19&3,r=s>>>9&511,n=s>>>0&511,i=o>>>24&7,l=o>>>20&15,c=o>>>18&3,h=o>>>14&15,d=o>>>10&15,u=o>>>8&3,m=o>>>4&15,p=o>>>0&15;t.gDPSetTile(e,a,r,n,i,l,c,h,d,u,m,p)}break;case h.G_LOADTLUT:{const e=o>>>24&7,a=o>>>14&1023;t.gDPLoadTLUT(e,a)}break;case h.G_LOADBLOCK:{const e=s>>>12&4095,a=s>>>0&4095,r=o>>>24&7,n=o>>>12&4095,i=o>>>0&4095;t.gDPLoadBlock(r,e,a,n,i)}break;case h.G_VTX:{const e=s>>>12&255,a=(s>>>1&255)-e;t.gSPVertex(o,e,a)}break;case h.G_TRI1:{const e=(s>>>16&255)/2,a=(s>>>8&255)/2,r=(s>>>0&255)/2;t.gSPTri(e,a,r)}break;case h.G_TRI2:{const e=(s>>>16&255)/2,a=(s>>>8&255)/2,r=(s>>>0&255)/2;t.gSPTri(e,a,r)}{const e=(o>>>16&255)/2,a=(o>>>8&255)/2,r=(o>>>0&255)/2;t.gSPTri(e,a,r)}break;case h.G_DL:if(128===(o>>>24&255)?e(t,o,r):r(t,o),s>>>16&255)return;break;case h.G_RDPSETOTHERMODE:t.gDPSetOtherModeH(0,24,16777215&s),t.gDPSetOtherModeL(0,32,o);break;case h.G_SETOTHERMODE_H:{const e=1+(s>>>0&255),a=32-(s>>>8&255)-e;t.gDPSetOtherModeH(a,e,o)}break;case h.G_SETOTHERMODE_L:{const e=1+(s>>>0&255),a=32-(s>>>8&255)-e;t.gDPSetOtherModeL(a,e,o)}break;case h.G_SETCOMBINE:t.gDPSetCombine(16777215&s,o);break;case h.G_TEXTURE:{const e=s>>>11&7;let a=s>>>8&7;const r=!!(s>>>0&127),n=o>>>16&65535,i=o>>>0&65535;t.gSPTexture(r,a,e,n,i)}break;case h.G_SETTILESIZE:{const e=s>>>12&4095,a=s>>>0&4095,r=o>>>24&7,n=o>>>12&4095,i=o>>>0&4095;t.gDPSetTileSize(r,e,a,n,i)}break;case h.G_POPMTX:break;case h.G_SETPRIMCOLOR:{const e=s>>>0&255,a=o>>>24&255,r=o>>>16&255,n=o>>>8&255,i=o>>>0&255;t.gSPSetPrimColor(e,a,r,n,i)}break;case h.G_SETBLENDCOLOR:break;case h.G_SETENVCOLOR:{const e=o>>>24&255,a=o>>>16&255,r=o>>>8&255,n=o>>>0&255;t.gSPSetEnvColor(e,a,r,n)}break;case h.G_BRANCH_Z:return void e(t,t.DP_Half1,r);case h.G_RDPHALF_1:t.DP_Half1=o;break;case h.G_MODIFYVTX:{const e=s>>>16&255,r=s>>>1&32767,i=n.getInt16(a+4),o=n.getInt16(a+6);t.gSPModifyVertex(e,r,i,o)}break;case h.G_MOVEWORD:i.assert(10==(s>>>16&255));break;case h.G_CULLDL:case h.G_RDPFULLSYNC:case h.G_RDPTILESYNC:case h.G_RDPPIPESYNC:case h.G_RDPLOADSYNC:break;default:console.error(`Unknown DL opcode: ${l.toString(16)} ${i.hexzero(a,8)}`)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(200),n=a(124),s=a(1),i=a(0),o=a(202),l=a(2),c=a(123),h=a(137),d=i.nArray(2,()=>s.vec3.create());t.LevelGlobals=class{constructor(e){this.id=e,this.collision=null,this.currentSong=0,this.songStart=0,this.allActors=[],this.translation=s.vec3.create(),this.lastThrow=-1,this.projectiles=[],this.pesterNext=!1,this.fishTable=[],this.fishCount=0,this.activeFish=null,this.splashes=[],this.tempActors=[]}update(e){if(s.mat4.getTranslation(this.translation,e.camera.worldMatrix),e.time>this.songStart+1e4&&(0!==this.currentSong?this.currentSong=0:Math.random()<.5&&(this.currentSong=5+(3*Math.random()>>>0)),this.songStart=e.time),this.lastThrow<0&&(this.lastThrow=e.time+2e3),e.time>this.lastThrow+2500){let t=!1;if(this.translation[1]>n.findGroundHeight(this.collision,this.translation[0],this.translation[2])+20){l.getMatrixAxisZ(d[0],e.camera.worldMatrix),s.vec3.scale(d[0],d[0],-1),e.deltaTime>0?(s.vec3.scale(d[1],e.camera.linearVelocity,1e3/e.deltaTime),l.transformVec3Mat4w0(d[1],e.camera.worldMatrix,d[1])):s.vec3.copy(d[1],l.Vec3Zero);for(let e=0;e<this.projectiles.length;e++)if(this.projectiles[e].isPester===this.pesterNext&&this.projectiles[e].tryThrow(this.translation,d[0],d[1])){t=!0;break}}t?(this.lastThrow=e.time,this.pesterNext=!this.pesterNext):this.lastThrow+=500}}spawnFish(e){if(null!==this.activeFish){if(this.activeFish.visible)return;this.activeFish=null}let t=0;if("16"===this.id){const e=this.fishTable[this.fishCount%this.fishTable.length];Math.random()<e.probability&&(t=e.id)}else{let e=Math.random();for(let a=0;a<this.fishTable.length;a++){if(e<this.fishTable[a].probability){t=this.fishTable[a].id;break}e-=this.fishTable[a].probability}}0!==t&&(this.activeFish=this.activateObject(t,e,6.283*Math.random()),this.fishCount++)}activateObject(e,t,a,r=0,n=l.Vec3One){const i=this.tempActors.find(t=>t.def.id===e&&!t.visible);return void 0===i?null:(i.spawn.behavior=r,s.vec3.copy(i.spawn.pos,t),s.vec3.copy(i.spawn.scale,n),i.spawn.euler[1]=a,i.reset(this),i)}createSplash(e,t,a=l.Vec3One){for(let r=0;r<this.splashes.length&&(this.splashes[r].type!==e||!this.splashes[r].tryStart(t,a,this));r++);}sendGlobalSignal(e,t){for(let a=0;a<this.allActors.length;a++)this.allActors[a].receiveSignal(e,t,this)}sendTargetedSignal(e,t,a){for(let r=0;r<this.allActors.length;r++)if(this.allActors[r].def.globalPointer===a){this.allActors[r].receiveSignal(e,t,this);break}}buildTempObjects(e,t,a,o,c){const h=[];this.zeroOne=new r.ModelRenderer(a,c.zeroOne.nodes,c.zeroOne.animations),h.push(this.zeroOne);for(let e=0;e<2;e++)for(let t=0;t<5;t++){const t=new f(o[e],c.projectiles[e],1===e);this.projectiles.push(t),h.push(t)}for(let e=2;e<4;e++){const t=2===e?2:3;for(let a=0;a<3;a++){const a=new g(o[e],c.projectiles[e].nodes,c.projectiles[e].animations,t,u);this.splashes.push(a),h.push(a)}}const d=e.findIndex(e=>1003===e.id);if(d>=0){const a=e[d];for(let e=0;e<5;e++){const e=new g(t[d],a.nodes,a.stateGraph.animations,0,a.scale);this.splashes.push(e),h.push(e)}}this.fishTable=c.fishTable;for(let a=0;a<c.fishTable.length;a++){if(0===c.fishTable[a].id)continue;const r=e.findIndex(e=>e.id===c.fishTable[a].id);i.assert(r>=0);const n={id:c.fishTable[a].id,behavior:0,pos:s.vec3.create(),euler:s.vec3.create(),scale:s.vec3.clone(l.Vec3One)},o=new v(t[r],n,e[r],this);o.visible=!1,this.tempActors.push(o),h.push(o)}const m=new Set;for(let e of c.objectInfo)if(n.isActor(e))for(let t of e.stateGraph.states)for(let e of t.blocks)e.spawn&&m.add(e.spawn.id);"18"===this.id&&(m.add(58),m.add(59));for(let a of m){let r=1;switch(a){case 58:case 59:r=3;break;case 132:r=4;break;case 1030:r=10}const n=e.findIndex(e=>e.id===a);i.assert(n>=0);for(let i=0;i<r;i++){const r={id:a,behavior:0,pos:s.vec3.create(),euler:s.vec3.create(),scale:s.vec3.clone(l.Vec3One)},i=new v(t[n],r,e[n],this);i.visible=!1,this.tempActors.push(i),this.allActors.push(i),h.push(i)}}return h}};const u=s.vec3.fromValues(.1,.1,.1),m=i.nArray(2,()=>s.vec3.create()),p=s.vec3.create();class f extends r.ModelRenderer{constructor(e,t,a){super(e,t.nodes,t.animations),this.def=t,this.isPester=a,this.translation=s.vec3.create(),this.prevPos=s.vec3.create(),this.velocity=s.vec3.create(),this.landedAt=0,this.inWater=!1,this.visible=!1}distFrom(e){return!this.visible||this.hidden||0===this.landedAt?1/0:s.vec3.dist(e,this.translation)}tryThrow(e,t,a){return!this.visible&&(this.visible=!0,this.landedAt=0,this.inWater=!1,this.animationPaused=!1,this.setAnimation(0),s.vec3.copy(this.prevPos,e),s.vec3.normalize(this.velocity,t),s.vec3.scale(this.velocity,this.velocity,1500),s.vec3.scaleAndAdd(this.translation,e,this.velocity,.1),s.vec3.add(this.velocity,this.velocity,a),s.mat4.fromScaling(this.modelMatrix,u),!0)}eat(e){this.visible=!1,e.sendGlobalSignal(this,21)}motion(e,t){const a=e.deltaTime/1e3;if(this.landedAt>0){const r=30*(e.time-this.landedAt)/1e3;if(this.inWater)r>60?this.eat(t):this.translation[1]-=60*a;else if(r>170)this.eat(t);else if(r>140){const e=.1*Math.pow(.9,2*(r-140));this.modelMatrix[0]=e,this.modelMatrix[5]=e,this.modelMatrix[10]=e,this.translation[1]-=360*e*a}}else this.hitGround(e,t)||(this.checkCollision(s.vec3.len(this.velocity),a,t),this.velocity[1]-=1080*a);s.vec3.copy(this.prevPos,this.translation),0===this.landedAt&&s.vec3.scaleAndAdd(this.translation,this.translation,this.velocity,a),this.modelMatrix[12]=this.translation[0],this.modelMatrix[13]=this.translation[1],this.modelMatrix[14]=this.translation[2]}hitGround(e,t){var a;const r=n.findGroundPlane(t.collision,this.translation[0],this.translation[2]),i=n.computePlaneHeight(r,this.translation[0],this.translation[2]);if(this.translation[1]>i)return!1;let o=0,c=1,h=this.translation[1]-i,d=15;for(s.vec3.copy(p,this.translation);Math.abs(h)>.375&&d-- >0;){const e=(o+c)/2;s.vec3.lerp(p,this.prevPos,this.translation,e);const t=n.computePlaneHeight(r,p[0],p[2]);h=p[1]-t,h>0?o=e:c=e}if(s.vec3.scaleAndAdd(this.translation,p,l.Vec3UnitY,12),3375026===r.type&&t.spawnFish(this.translation),this.isPester){switch(t.sendGlobalSignal(this,10),r.type){case 65280:t.sendGlobalSignal(this,38);break;case 16711680:t.sendGlobalSignal(this,42);break;case 16744370:t.sendGlobalSignal(this,29);break;case 6655:t.sendTargetedSignal(this,43,2150447924)}return this.visible=!1,!0}t.sendGlobalSignal(this,14);let u=1;switch(r.type){case 6655:case 32614:case 3375026:case 5033164:t.createSplash(2,this.translation),this.landedAt=e.time,this.inWater=!0;break;case 65280:case 16731161:t.createSplash(3,this.translation),this.landedAt=e.time,this.inWater=!0;break;case 16711680:this.visible=!1;break;case 1651507:case 3348761:case 4987136:case 5000243:case 8342528:case 8349235:case 8349311:case 8355711:case 16744370:u=.3;break;case 5013248:case 10053222:case 11704703:case 16750873:u=.2;break;default:u=0}if(!this.visible||0!==this.landedAt)return!0;s.vec3.normalize(p,null===(a=r)||void 0===a?void 0:a.normal),l.reflectVec3(this.velocity,this.velocity,p);const m=s.vec3.len(this.velocity);return m*u<f.minSpeed?p[1]>=f.maxSlope?(this.landedAt=e.time,this.animationPaused=!0):s.vec3.scale(this.velocity,this.velocity,f.minSpeed/m):s.vec3.scale(this.velocity,this.velocity,u),!0}checkCollision(e,t,a){s.vec3.normalize(m[0],this.velocity);let r=e*t,n=null;for(let e=0;e<a.allActors.length;e++){const t=a.allActors[e];if(!t.getImpact(m[1],this.translation))continue;const i=s.vec3.dot(m[0],m[1]);if(i<0)continue;const o=t.def.radius-Math.sqrt(s.vec3.sqrLen(m[1])-i*i);if(o<0)continue;2&t.def.flags&&(this.isPester?t.receiveSignal(this,8,a):t.receiveSignal(this,12,a));const l=Math.sqrt(t.def.radius*t.def.radius-o*o)-i;l>r&&(r=l,n=t)}null!==n&&(s.vec3.copy(n.motionData.lastImpact,m[0]),this.isPester?(n.receiveSignal(this,9,a),this.visible=!1):(n.receiveSignal(this,13,a),s.vec3.scaleAndAdd(this.translation,this.translation,m[0],-r),s.vec3.sub(m[1],this.translation,n.center),s.vec3.normalize(m[1],m[1]),l.reflectVec3(this.velocity,this.velocity,m[1]),l.normToLength(this.velocity,Math.max(e/2,300))))}}t.Projectile=f,f.maxSlope=Math.sqrt(3)/2,f.minSpeed=390;const A=s.vec3.create();class g extends r.ModelRenderer{constructor(e,t,a,r,n){super(e,t,a),this.type=r,this.baseScale=n,this.visible=!1}tryStart(e,t,a){return!this.visible&&(this.visible=!0,s.vec3.mul(A,this.baseScale,t),s.mat4.fromScaling(this.modelMatrix,A),this.modelMatrix[12]=e[0],this.modelMatrix[13]=n.findGroundHeight(a.collision,e[0],e[2]),this.modelMatrix[14]=e[2],this.setAnimation(0),this.renderers[this.headAnimationIndex].animator.loopCount=0,!0)}motion(e,t){this.renderers[this.headAnimationIndex].animator.loopCount>=1&&(this.visible=!1)}}const _=s.vec3.create(),S=i.nArray(2,()=>s.vec3.create()),b=s.vec3.create();class v extends r.ModelRenderer{constructor(e,t,a,r){super(e,a.nodes,a.stateGraph.animations),this.spawn=t,this.def=a,this.motionData=new o.MotionData,this.currState=-1,this.currBlock=0,this.currAux=0,this.target=null,this.lastSpawn=null,this.blockEnd=0,this.loopTarget=1,this.photoTimer=0,this.translation=s.vec3.create(),this.euler=s.vec3.create(),this.scale=s.vec3.clone(l.Vec3One),this.center=s.vec3.create(),this.tangible=!0,this.motionData.path=t.path,this.reset(r)}getImpact(e,t){return!(!this.visible||this.hidden||!this.tangible||0===this.def.radius)&&(s.vec3.sub(e,this.center,t),!0)}reset(e){s.vec3.copy(this.translation,this.spawn.pos),0===this.def.spawn&&(this.translation[1]=n.findGroundHeight(e.collision,this.spawn.pos[0],this.spawn.pos[2])),s.vec3.copy(this.euler,this.spawn.euler),s.vec3.mul(this.scale,this.def.scale,this.spawn.scale),this.updatePositions(),this.motionData.reset(),this.visible=!0,this.hidden=!1,this.tangible=!0;const t=n.findGroundPlane(e.collision,this.translation[0],this.translation[2]);this.motionData.groundHeight=n.computePlaneHeight(t,this.translation[0],this.translation[2]),this.motionData.groundType=t.type,this.currAux=0,this.animations.length>0&&this.setAnimation(0),this.def.stateGraph.states.length>0&&this.changeState(0,e)}updatePositions(){r.buildTransform(this.modelMatrix,this.translation,this.euler,this.scale),1&this.def.flags?(s.vec3.div(this.center,this.def.center,this.scale),s.vec3.add(this.center,this.center,this.renderers[0].translation)):s.vec3.copy(this.center,this.def.center),s.vec3.transformMat4(this.center,this.center,this.modelMatrix)}motion(e,t){for(this.motionStep(e,t);this.currState>=0;){const a=this.def.stateGraph.states[this.currState],r=this.stateOverride(a.startAddress,e,t);if(1===r)continue;if(2===r)break;const n=a.blocks[this.currBlock];if(null!==n.wait){if(n.wait.allowInteraction&&this.basicInteractions(n.wait,e,t))continue;if(!this.metEndCondition(n.wait.endCondition,t))break}this.endBlock(t),this.chooseEdge(n.edges,t)||(this.currBlock++,this.startBlock(t))}}stateOverride(e,t,a){return 0}endBlock(e){}customMotion(e,t,a){return t.time-this.motionData.start>5e3?2:0}changeState(e,t){return-1!==e&&((!this.def.stateGraph.states[e].doCleanup||0!==this.def.stateGraph.states[e].blocks.length)&&(this.currState=e,this.currBlock=0,this.startBlock(t),!0))}startBlock(e){const t=this.def.stateGraph.states[this.currState];if(this.currBlock>=t.blocks.length)return t.doCleanup&&(this.visible=!1),void(this.currState=-1);const a=t.blocks[this.currBlock];if(a.animation>=0){(a.animation!==this.currAnimation||a.force)&&this.setAnimation(a.animation);const e=i.assertExists(this.renderers[this.headAnimationIndex]).animator.loopCount;this.loopTarget=e+(null!==a.wait&&a.wait.loopTarget>0?a.wait.loopTarget:1)}for(let t=0;t<a.signals.length;t++){let r=!0;switch(a.signals[t].condition){case 63:r=this.spawn.behavior!==a.signals[t].conditionParam;break;case 68:r=3375026!==this.motionData.groundType&&32614!==this.motionData.groundType&&16731161!==this.motionData.groundType;break;case 59:r=!1}r||(0===a.signals[t].target?e.sendGlobalSignal(this,a.signals[t].value):112===a.signals[t].target&&this.target instanceof v?this.target.receiveSignal(this,a.signals[t].value,e):e.sendTargetedSignal(this,a.signals[t].value,a.signals[t].target))}if(a.auxAddress>=0&&(this.currAux=a.auxAddress,a.auxAddress>0?(this.motionData.stateFlags&=-9,this.motionData.auxStart=-1):this.motionData.stateFlags|=8),0!==a.flagSet&&(this.motionData.stateFlags|=a.flagSet),0!==a.flagClear&&(this.motionData.stateFlags&=~a.flagClear),131072&a.flagSet&&(this.hidden=!0),131072&a.flagClear&&(this.hidden=!1),262144&a.flagSet&&(this.animationPaused=!0),262144&a.flagClear&&(this.animationPaused=!1),void 0!==a.ignoreGround&&(this.motionData.ignoreGround=a.ignoreGround),a.eatApple&&null!==this.target&&(this.target instanceof f?this.target.eat(e):console.warn("eating non apple"),this.target=null),void 0!==a.forwardSpeed&&(this.motionData.forwardSpeed=a.forwardSpeed),void 0!==a.tangible&&(this.tangible=a.tangible),void 0!==a.splash&&(-1===a.splash.index?s.vec3.copy(b,this.translation):s.mat4.getTranslation(b,this.renderers[a.splash.index].modelMatrix),e.createSplash(0,b,a.splash.scale)),void 0!==a.spawn){let t=0;0===a.spawn.yaw?t=this.euler[1]:1===a.spawn.yaw&&(t=this.euler[1]+Math.PI),this.lastSpawn=e.activateObject(a.spawn.id,this.translation,t,a.spawn.behavior>=0?a.spawn.behavior:this.spawn.behavior,a.spawn.scale),null!==this.lastSpawn&&(this.lastSpawn.motionData.path=this.motionData.path)}null!==a.motion&&(this.motionData.currMotion=a.motion,this.motionData.currBlock=0,this.motionData.start=-1,this.motionData.stateFlags&=-51),null!==a.wait&&(this.blockEnd=this.animationController.getTimeInSeconds()+a.wait.duration+a.wait.durationRange*Math.random())}receiveSignal(e,t,a){if(-1===this.currState)return!1;const r=this.def.stateGraph.states[this.currState].blocks[this.currBlock];if(null===r.wait)return!1;if(21===t||22===t){if(e!==this.target)return!1;this.target=null}for(let n=0;n<r.wait.interactions.length;n++){if(r.wait.interactions[n].type!==t)continue;const i=null!==e?s.vec3.dist(this.translation,e.translation):1/0;switch(t){case 10:if(i>=150)return!1;this.target=e;break;case 14:case 20:if(i>=600)return!1;this.target=e;break;case 18:if(s.vec3.dist(this.translation,a.translation)>=400)return!1;this.target=e;break;case 21:case 22:break;default:null!==e&&(this.target=e)}return this.followEdge(r.wait.interactions[n],a)}return!1}followEdge(e,t){return 0!==e.auxFunc&&(this.currAux=e.auxFunc,this.motionData.stateFlags&=-9,this.motionData.auxStart=-1),this.changeState(e.index,t)}chooseEdge(e,t){let a=Math.random(),r=!1;for(let n=0;n<e.length;n++){switch(e[n].type){case 59:r=!0;break;case 60:a-=e[n].param,r=a<0;break;case 63:r=this.spawn.behavior===e[n].param;break;case 64:r=0!==this.spawn.behavior;break;case 61:case 62:r=this.metEndCondition(e[n].param,t)===(61===e[n].type);break;case 66:r=null!==this.target;break;case 68:r=3375026===this.motionData.groundType||32614===this.motionData.groundType||16731161===this.motionData.groundType}if(r)return this.followEdge(e[n],t)}return!1}metEndCondition(e,t){return!!(65536&e)&&!o.canHearSong(this.translation,t)||!!(4&e)&&this.animationController.getTimeInSeconds()>=this.blockEnd||!!(1&e)&&this.renderers[this.headAnimationIndex].animator.loopCount>=this.loopTarget||0!=(e&this.motionData.stateFlags)}basicInteractions(e,t,a){s.mat4.getTranslation(_,t.camera.worldMatrix);const r=s.vec3.dist(this.translation,_),n=t.camera.frustum.containsSphere(this.translation,100)&&!this.hidden;for(let s=0;s<e.interactions.length;s++)switch(e.interactions[s].type){case 5:case 6:case 7:if(o.canHearSong(this.translation,a)&&e.interactions[s].type===a.currentSong)return this.target=a,this.followEdge(e.interactions[s],a);break;case 16:if(r<e.interactions[s].param)return this.target=a,this.followEdge(e.interactions[s],a);break;case 23:case 24:{n&&r<1500?this.photoTimer+=t.deltaTime:this.photoTimer=0;const i=24===e.interactions[s].type?3e3:e.interactions[s].param/30*1e3;if(this.photoTimer>i)return this.photoTimer=0,this.followEdge(e.interactions[s],a)}break;case 15:{let t=null,r=600;for(let e=0;e<a.projectiles.length;e++){if(a.projectiles[e].isPester)continue;const n=a.projectiles[e].distFrom(this.translation);n<r&&(r=n,t=a.projectiles[e])}if(null!==t)return this.target=t,this.followEdge(e.interactions[s],a)}}return!1}motionStep(e,t){const a=e.deltaTime/1e3;let r=0,i=!1;for(;this.motionData.currBlock<this.motionData.currMotion.length;){if(this.motionData.start<0&&(r=o.motionBlockInit(this.motionData,this.translation,this.euler,e,this.target),2===r)){this.motionData.currBlock++,this.motionData.start=-1;continue}const l=this.motionData.currMotion[this.motionData.currBlock];switch(l.kind){case"animation":(l.index!==this.currAnimation||l.force)&&this.setAnimation(l.index),r=2;break;case"path":r=o.followPath(this.translation,this.euler,this.motionData,l,a,t);break;case"projectile":r=o.projectile(this.translation,this.motionData,l,e.time,t);break;case"vertical":r=o.vertical(this.translation,this.euler,this.motionData,l,a);break;case"random":r=o.randomCircle(this.translation,this.euler,this.motionData,l,a,t);break;case"linear":r=o.linear(this.translation,this.euler,this.motionData,l,this.target,a,e.time);break;case"walkToTarget":r=o.walkToTarget(this.translation,this.euler,this.motionData,l,this.target,a,t);break;case"faceTarget":r=o.faceTarget(this.translation,this.euler,this.motionData,l,this.target,a,t);break;case"point":r=o.approachPoint(this.translation,this.euler,this.motionData,t,l,a);break;case"forward":r=o.forward(this.translation,this.euler,this.motionData,t,l,a);break;case"splash":if(-1===l.index?s.vec3.copy(b,this.translation):s.mat4.getTranslation(b,this.renderers[l.index].modelMatrix),l.onImpact){const e=n.findGroundHeight(t.collision,b[0],b[2]);if(b[1]>e){r=0;break}}t.createSplash(0,b,l.scale),r=2;break;case"basic":switch(l.subtype){case 1:r=(e.time-this.motionData.start)/1e3>l.param?2:0;break;case 2:r=o.canHearSong(this.translation,t)?0:2;break;case 3:this.motionData.forwardSpeed=l.param,r=2;break;case 0:r=this.customMotion(l.param,e,t);break;case 4:this.motionData.currBlock=-1,r=2}}if(0!==r&&(i=!0),2!==r)break;this.motionData.currBlock++,this.motionData.start=-1}this.motionData.currBlock>=this.motionData.currMotion.length&&this.motionData.currMotion.length>0&&(this.motionData.stateFlags|=2),r=this.auxStep(e,t),0!==r&&(i=!0),2===r&&(this.currAux=0,this.motionData.stateFlags|=8),i&&this.updatePositions(),524288&this.motionData.stateFlags&&this.collide(t)}auxStep(e,t){return 0}collide(e){for(let t=0;t<e.allActors.length;t++){const a=e.allActors[t];if(!(524288&a.motionData.stateFlags))continue;if(this===a)break;s.vec3.sub(S[0],a.center,this.center);const r=s.vec3.len(S[0])-a.def.radius-this.def.radius;if(r>0)continue;a.receiveSignal(this,26,e),this.receiveSignal(a,26,e),S[0][1]=0,s.vec3.normalize(S[0],S[0]);const n=r*(2097152&this.motionData.stateFlags&&2097152&a.motionData.stateFlags?.5:1);2097152&this.motionData.stateFlags&&(s.vec3.scaleAndAdd(S[1],this.translation,S[0],n),o.attemptMove(this.translation,S[1],this.motionData,e,1)||this.updatePositions()),2097152&a.motionData.stateFlags&&(s.vec3.scaleAndAdd(S[1],a.translation,S[0],-n),o.attemptMove(a.translation,S[1],a.motionData,e,1)||a.updatePositions())}}}t.Actor=v;class w extends v{startBlock(e){const t=this.def.stateGraph.states[this.currState];switch(t.startAddress){case 2150470888:if(0===this.motionData.storedValues[0]&&0===this.currBlock&&(1===this.spawn.behavior||2===this.spawn.behavior))return void this.followEdge(t.blocks[0].edges[0],e);break;case 2150471608:if(0===this.currBlock){const t=1===this.spawn.behavior?3:4;this.target=e.allActors.find(e=>e.spawn.id===this.spawn.id&&e.spawn.behavior===t)}else 1===this.currBlock&&(this.motionData.storedValues[0]=1)}super.startBlock(e)}}class x extends v{constructor(){super(...arguments),this.depth=-95}auxStep(e,t){if(2150414992===this.currAux){this.motionData.auxStart<0&&(this.motionData.auxStart=e.time);const a=n.findGroundHeight(t.collision,this.translation[0],this.translation[2]),r=(e.time-this.motionData.auxStart)/1e3;return this.translation[1]=a+10*Math.sin(r/1.5*6.283)+this.depth,this.depth=Math.min(this.depth+60*e.deltaTime/1e3,-45),1}return 0}}class T extends v{reset(e){super.reset(e),this.motionData.storedValues[0]=this.translation[1],this.motionData.storedValues[1]=this.motionData.groundHeight+25}}class y extends v{auxStep(e,t){return 2150403012===this.currAux&&(this.motionData.auxStart<0&&(this.motionData.auxStart=e.time),e.time>this.motionData.auxStart+128e3/30)?(0===this.motionData.storedValues[0]&&t.sendGlobalSignal(this,29),2):0}}const C=s.vec3.create();class M extends v{auxStep(e,t){switch(this.currAux){case 2150414356:if(c.getPathPoint(this.motionData.destination,i.assertExists(this.spawn.path),1),s.vec3.sub(C,this.motionData.destination,this.translation),Math.hypot(C[0],C[2])<475)return this.receiveSignal(this,35,t),2;break;case 2150530212:if(!o.canHearSong(this.translation,t))return this.motionData.stateFlags|=4096,2}return 0}startBlock(e){const t=this.def.stateGraph.states[this.currState];switch(t.startAddress){case 2150531728:{if(M.currDiglett&M.targetDiglett)return void this.followEdge(t.blocks[0].edges[0],e);M.targetDiglett<<=1;const a=this.motionData.storedValues[0];this.motionData.storedValues[1]=a+(a<3?1:2)}}super.startBlock(e)}endBlock(e){switch(this.def.stateGraph.states[this.currState].startAddress){case 2150531888:this.motionData.storedValues[0]=this.motionData.storedValues[1]}}}M.currDiglett=0,M.targetDiglett=1;class U extends v{auxStep(e,t){switch(this.currAux){case 2150473212:case 2150473340:if(4096&this.motionData.stateFlags)return 2;if(c.getPathPoint(this.motionData.destination,i.assertExists(this.spawn.path),1),s.vec3.sub(C,this.motionData.destination,this.translation),Math.hypot(C[0],C[2])<1e3)return this.receiveSignal(this,44,t),2}return 0}}class k extends v{startBlock(e){switch(this.def.stateGraph.states[this.currState].startAddress){case 2150364812:this.motionData.storedValues[1]=.08;break;case 2150365756:s.vec3.copy(this.motionData.destination,this.translation)}super.startBlock(e)}}class D extends v{startBlock(e){2150366960===this.def.stateGraph.states[this.currState].startAddress&&(this.translation[1]=i.assertExists(this.target).translation[1]-100,this.updatePositions()),super.startBlock(e)}}class I extends v{stateOverride(e,t,a){let r=0;switch(e){case 2150369632:r=1;break;case 2150369732:r=2;break;case 2150369832:r=4;break;case 2150369932:r=8}return I.flags&r||0===r?0:2}auxStep(e,t){return 2150371352===this.currAux?(I.flags|=1<<this.spawn.behavior-1,2):0}}I.flags=0;class R extends v{constructor(){super(...arguments),this.spinSpeed=0,this.whirlpool=null,this.relativeToPlayer=!0}static baseAngle(e){return 6.283*(1-e/1500%1)}static targetPosition(e,t,a,r){const n=R.baseAngle(a)+(0===r?0:(r-1)*Math.PI/9)*R.separationScale;s.vec3.set(e,R.playerRadius*Math.sin(n),-200,R.playerRadius*Math.cos(n)),s.vec3.add(e,e,t)}auxStep(e,t){switch(this.currAux){case 2150421976:{const a=(this.relativeToPlayer?t.translation[1]:n.findGroundHeight(t.collision,this.translation[0],this.translation[2]))+this.motionData.storedValues[0]-this.translation[1],r=600*e.deltaTime/1e3;Math.abs(a)<r&&(this.motionData.stateFlags|=4096),this.translation[1]+=l.clampRange(a,r)}case 2150419124:0===this.spinSpeed&&(this.spinSpeed=h.randomRange(1,2)*Math.PI/3),this.euler[1]+=this.spinSpeed*e.deltaTime/1e3}return 1}customMotion(e,t,a){const r=t.deltaTime/1e3;switch(e){case 1:{s.vec3.sub(this.motionData.destination,this.translation,a.translation);const e=Math.atan2(this.motionData.destination[0],this.motionData.destination[2]),n=s.vec3.len(this.motionData.destination);if(l.normToLength(this.motionData.destination,R.playerRadius),s.vec3.add(this.motionData.destination,this.motionData.destination,a.translation),o.approachPoint(this.translation,this.euler,this.motionData,a,o.staryuApproach,r),this.euler[1]=e+Math.PI,Math.abs(n-R.playerRadius)<25&&Math.abs(l.angleDist(e,R.baseAngle(t.time)))<Math.PI/72)return R.targetPosition(this.motionData.destination,a.translation,t.time,this.spawn.behavior),2}break;case 2:case 3:case 4:{if(R.targetPosition(this.motionData.destination,a.translation,t.time,this.spawn.behavior),s.vec3.dist(this.translation,this.motionData.destination)>R.playerRadius)return this.changeState(3,a),1;const i=this.euler[1],c=o.approachPoint(this.translation,this.euler,this.motionData,a,o.staryuApproach,r);if(2===e)return c;if(this.euler[1]=i,null===this.whirlpool&&(this.whirlpool=a.allActors.find(e=>1033===e.def.id)),3===e)return s.vec3.dist(a.translation,this.whirlpool.translation)<4e3?2:1;R.separationScale=l.clamp(R.separationScale+.9*r,1,4);const h=o.yawTowards(this.whirlpool.translation,a.translation),d=o.yawTowards(this.translation,a.translation);if(Math.abs(l.angleDist(h,d))<Math.PI/60)return s.vec3.copy(this.motionData.destination,this.whirlpool.translation),this.relativeToPlayer=!1,this.motionData.storedValues[0]=1e3,this.motionData.destination[1]=n.findGroundHeight(a.collision,this.whirlpool.translation[0],this.whirlpool.translation[2])+1e3,2}break;default:return super.customMotion(e,t,a)}return 1}startBlock(e){const t=this.def.stateGraph.states[this.currState];switch(t.startAddress){case 2150419708:case 2150419840:this.motionData.storedValues[0]=3e3;break;case 2150419932:this.motionData.storedValues[0]=-200;break;case 2150420664:0===this.currBlock&&Math.random()<.5&&(this.currBlock=1);break;case 2150421748:0===this.currBlock?this.motionData.storedValues[0]=-400:1===this.currBlock&&R.evolveCount<=2&&e.sendGlobalSignal(this,t.blocks[1].signals[R.evolveCount++].value)}super.startBlock(e)}}t.Staryu=R,R.evolveCount=0,R.separationScale=1,R.playerRadius=800;class B extends v{startBlock(e){switch(this.def.stateGraph.states[this.currState].startAddress){case 2150387444:this.translation[1]=n.findGroundHeight(e.collision,this.translation[0],this.translation[2])-53.25,this.updatePositions()}super.startBlock(e)}}B.flags=0;class P extends v{constructor(){super(...arguments),this.gyarados=null}auxStep(e,t){return 2150441256===this.currAux&&(null===this.gyarados&&(this.gyarados=t.allActors.find(e=>e.def.id===this.def.id+1)),this.translation[1]>this.gyarados.translation[1]+100)?2:0}}class E extends v{stateOverride(e,t,a){let r=0;switch(e){case 2150400364:r=1;break;case 2150400452:r=2;break;case 2150400540:r=4}return E.flags&r||0===r?0:2}auxStep(e,t){return this.currAux===n.fakeAux?(E.flags|=1<<this.spawn.behavior,2===this.spawn.behavior&&(E.flags|=2),2):0}}E.flags=0;const F=s.vec3.create();class V extends v{constructor(){super(...arguments),this.startAngle=0,this.amplitude=0,this.endHeight=0}startBlock(e){const t=this.def.stateGraph.states[this.currState];if(2150486484===t.startAddress){if(!(this.target&&s.vec3.dist(this.translation,this.target.translation)<1e3))return void this.changeState(0,e);this.currBlock=this.spawn.behavior-1}super.startBlock(e),2150486240===t.startAddress&&1===this.spawn.behavior&&1!==this.currAnimation&&this.setAnimation(1),2150486936===t.startAddress&&2===this.currBlock&&2===this.spawn.behavior&&e.sendGlobalSignal(this,43)}auxStep(e,t){if(2150487356===this.currAux){this.motionData.auxStart<0&&(this.motionData.auxStart=e.time,i.assert(this.motionData.start>=0,"aux before path"),c.getPathPoint(F,this.motionData.path,1),this.endHeight=n.findGroundHeight(t.collision,F[0],F[2]),this.amplitude=this.translation[1]+50-this.endHeight,this.startAngle=Math.asin((this.translation[1]-this.endHeight)/this.amplitude));const a=(e.time-this.motionData.auxStart)/1e3*3/this.motionData.path.duration;return a>1?2:(this.translation[1]=this.endHeight+this.amplitude*Math.sin(l.lerp(this.startAngle,Math.PI,a)),1)}return 0}}class O extends v{startBlock(e){if(2150488404===this.def.stateGraph.states[this.currState].startAddress&&0===this.motionData.storedValues[0]&&this.target&&s.vec3.dist(this.translation,this.target.translation)<200){const t=Math.random()<.2?59:58;e.activateObject(t,this.translation,0),this.motionData.storedValues[0]=1}super.startBlock(e)}customMotion(e,t,a){return 0!==this.motionData.storedValues[0]?(this.lavaSplash.receiveSignal(this,35,a),2):(t.time>this.motionData.start&&(this.lavaSplash.receiveSignal(this,34,a),this.motionData.start+=1e3*h.randomRange(4,10)),0)}endBlock(e){2150488048===this.def.stateGraph.states[this.currState].startAddress&&(this.lavaSplash=i.assertExists(this.lastSpawn))}}class N extends v{startBlock(e){const t=this.def.stateGraph.states[this.currState];if(2150492508===t.startAddress){let a=0;return this.target&&16731161===n.findGroundPlane(e.collision,this.target.translation[0],this.target.translation[2]).type&&(a=1),void this.followEdge(t.blocks[0].edges[a],e)}super.startBlock(e)}}t.sceneActorInit=function(){M.currDiglett=0,M.targetDiglett=1,R.evolveCount=0,R.separationScale=1},t.createActor=function(e,t,a,r){switch(a.id){case 4:return new w(e,t,a,r);case 7:return new x(e,t,a,r);case 14:return new T(e,t,a,r);case 16:return new y(e,t,a,r);case 25:return new M(e,t,a,r);case 37:return new U(e,t,a,r);case 70:return new k(e,t,a,r);case 71:return new D(e,t,a,r);case 88:return new I(e,t,a,r);case 120:return new R(e,t,a,r);case 124:return new B(e,t,a,r);case 129:return new P(e,t,a,r);case 131:return new E(e,t,a,r);case 137:return new V(e,t,a,r);case 1026:return new O(e,t,a,r);case 1027:return new N(e,t,a,r)}return new v(e,t,a,r)}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(47)),s=r(a(343)),i=a(344),o=a(345),l=a(0),c=a(9),h=a(10),d=a(7),u=a(33);class m{constructor(e){this.dataFetcher=e,this.filePromiseCache=new Map,this.fileDataCache=new Map}waitForLoad(){const e=[...this.filePromiseCache.values()];return Promise.all(e)}mountARC(e){for(let t=0;t<e.files.length;t++){const a=e.files[t];this.fileDataCache.set(l.assertExists(a.path),a.buffer)}}fetchFile(e){l.assert(!this.filePromiseCache.has(e));const t=this.dataFetcher.fetchData(`MetroidPrimeHunters/${e}`);return this.filePromiseCache.set(e,t),t}async fetchMPHARC(e){const t=await this.fetchFile(e),a=s.parse(n.decompress(t));this.mountARC(a)}async fetchMPFile(e){const t=await this.fetchFile(e);this.fileDataCache.set(l.assertExists(e),t)}getFileData(e){return this.fileDataCache.has(e)?this.fileDataCache.get(e):null}}class p{constructor(e,t){this.stageRenderer=t,this.renderTarget=new c.BasicRenderTarget,this.renderInstManager=new d.GfxRenderInstManager,this.objectRenderers=[],this.uniformBuffer=new u.GfxRenderDynamicUniformBuffer(e),this.textureHolder=new h.FakeTextureHolder(this.stageRenderer.viewerTextures)}adjustCameraController(e){e.setSceneMoveSpeedMult(8/60)}prepareToRender(e,t,a){this.renderInstManager.pushTemplateRenderInst().setUniformBuffer(this.uniformBuffer),this.stageRenderer.prepareToRender(this.renderInstManager,a);for(let e=0;e<this.objectRenderers.length;e++)this.objectRenderers[e].prepareToRender(this.renderInstManager,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,c.transparentBlackFullClearRenderPassDescriptor);return this.renderInstManager.setVisibleByFilterKeyExact(1),this.renderInstManager.drawOnPassRenderer(e,r),this.renderInstManager.resetRenderInsts(),r}destroy(e){this.renderInstManager.destroy(e),this.renderTarget.destroy(e),this.uniformBuffer.destroy(e),this.stageRenderer.destroy(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].destroy(e)}}t.MPHSceneRenderer=p;class f{constructor(e,t,a,r){this.id=e,this.name=t,this.arcName=a,this.texName=r}async createScene(e,t){const a=t.dataFetcher,r=new m(a);null!==this.arcName?(r.fetchMPHARC(`archives/${this.arcName}.arc`),null!==this.texName&&r.fetchMPFile(`levels/textures/${this.texName}.bin`)):r.fetchMPFile(`${this.id}.bin`),await r.waitForLoad();const n=r.getFileData(`${this.id}.bin`),s=i.parseMPH_Model(l.assertExists(n));l.assert(1===s.models.length);const c=r.getFileData(`levels/textures/${this.texName}.bin`),h=null!==c?i.parseTEX0Texture(c,s.mphTex):i.parseTEX0Texture(l.assertExists(n),s.mphTex),d=new o.MPHRenderer(e,s,null!==s.tex0?s.tex0:l.assertExists(h));return new p(e,d)}}const A=["Multiplayer",new f("mp3_Model","Combat Hall","mp3","mp3_Tex"),new f("mp1_Model","Data Shrine","mp1","mp1_tex"),new f("mp7_model","Processor Core","mp7","mp7_tex"),new f("unit1_RM1_model","High Ground","unit1_RM1","unit1_rm1_tex"),new f("mp9_model","Ice Hive","mp9","mp9_tex"),new f("unit1_rm2_model","Alinos Perch","unit1_RM2","unit1_rm2_tex"),new f("mp12_model","Sic Transit","mp12","mp12_Tex"),new f("ad1_model","Transfer Lock","ad1","ad1_tex"),new f("mp11_model","Sanctorus","mp11","mp11_tex"),new f("mp5_Model","Compression Chamber","mp5","mp5_tex"),new f("mp10_model","Incubation Vault","mp10","mp10_tex"),new f("unit4_rm5_model","Subterranean","unit4_rm5","unit4_rm5_tex"),new f("mp14_model","Outer Reach","mp14","mp14_tex"),new f("mp2_model","Harvester","mp2","mp2_tex"),new f("mp8_model","Weapons Complex","mp8","mp8_Tex"),new f("ad2_model","Council Chamber","ad2","ad2_tex"),new f("mp4_model","Elder Passage","mp4","mp4_Tex"),new f("mp13_model","Fuel Stack","mp13","mp13_tex"),new f("ctf1_model","Fault Line","ctf1","ctf1_tex"),new f("e3Level_Model","Stasis Bunker","e3Level","e3level_tex"),new f("mp6_model","Head Shot","mp6","mp6_tex"),new f("unit2_Land_model","Celestial Gateway","unit2_Land","unit2_land_tex"),new f("unit1_land_model","Alinos Gateway","unit1_Land","unit1_land_tex"),new f("unit3_land_model","VDO Gateway","unit3_Land","unit3_land_tex"),new f("unit4_land_model","Arcterra Gateway","unit4_Land","unit4_land_tex"),new f("gorea_b2_Model","Oubliette","Gorea_b2","gorea_b2_tex"),"Celestial Archives,",new f("unit2_c0_model","Helm Room","unit2_C0","unit2_c0_tex"),new f("unit2_c1_model","Meditation Room","unit2_C1","unit2_c1_tex"),new f("unit2_c2_model","Fan Room Alpha","unit2_C2","unit2_c2_tex"),new f("unit2_c3_model","Fan Room Beta","unit2_C3","unit2_c3_tex"),new f("unit2_RM3_model","Data Shrine 03","unit2_RM3","unit2_rm3_tex"),new f("unit2_c4_model","Synergy Core","unit2_C4","unit2_c4_tex"),new f("unit2_rm4_model","Transfer Lock","unit2_RM4","unit2_rm4_tex"),new f("unit2_rm8_model","Docking Bay","unit2_RM8","unit2_rm8_tex"),new f("unit2_c6_model","Tetra Vista","unit2_C6","unit2_c6_tex"),new f("unit2_c7_model","New Arrival Registration","unit2_C7","unit2_c7_tex"),new f("unit2_cx_model","1_CX","unit2_CX",null),new f("unit2_cz_model","1_CZ","unit2_CZ",null),"Alinos",new f("unit1_c0_model","Echo Hall","unit1_C0","unit1_c0_tex"),new f("unit1_RM1_model","High Ground","unit1_RM1","unit1_rm1_tex"),new f("unit1_rm6_model","Elder Passage","unit1_RM6","unit1_rm6_tex"),new f("unit1_c1_model","Alimbic Gardens","unit1_C1","unit1_c1_tex"),new f("unit1_c2_model","Thermal Vast","unit1_C2","unit1_c2_tex"),new f("unit1_rm2_model","Alinos Perch","unit1_RM2","unit1_rm2_tex"),new f("unit1_rm3_model","Council Chamber","unit1_RM3","unit1_rm3_tex"),new f("unit1_c3_model","Crash Site","unit1_C3","unit1_c3_tex"),new f("unit1_c4_model","Magma Drop","unit1_C4","unit1_c4_tex"),new f("unit1_c5_model","Piston Cave","unit1_C5","unit1_c5_tex"),new f("crystalroom_model","Alimbic Cannon Control Room","crystalroom","crystalroom_tex"),new f("unit1_cx_model","1_CX","unit1_CX",null),new f("unit1_cz_model","1_CZ","unit1_CZ",null),new f("unit1_morph_cx_model","1_morphCX","unit1_morph_CX",null),new f("unit1_morph_cz_model","1_morphCZ","unit1_morph_CZ",null),new f("unit1_rm1_cx_model","1_RM_CX","unit1_RM1_CX",null),"Vesper Defense Outpost",new f("unit3_c0_model","Bioweaponry Lab","unit3_C0","unit3_c0_tex"),new f("unit3_rm1_model","Weapons Complex","unit3_RM1","unit3_rm1_Tex"),new f("unit3_c2_model","Cortex CPU","unit3_C2","unit3_c2_tex"),new f("e3Level_Model","Stasis Bunker","e3Level","e3level_tex"),new f("unit3_c1_model","Ascension","unit3_C1","unit3_c1_tex"),new f("unit3_rm2_model","Fuel Stack","unit3_RM2","unit3_rm2_tex"),new f("unit3_cx_model","3_CX","unit3_CX",null),new f("unit3_cz_model","3_CZ","unit3_CZ",null),new f("unit3_morph_cz_model","3_morphCZ","unit3_morph_CZ",null),"Arcterra",new f("unit4_rm1_model","Ice Hive","unit4_rm1","unit4_rm1_Tex"),new f("unit4_c0_model","Frost Labyrinth","unit4_C0","unit4_c0_tex"),new f("unit4_rm5_model","Subterranean","unit4_rm5","unit4_rm5_tex"),new f("unit4_c1_model","Drip Moat","unit4_C1","unit4_c1_tex"),new f("unit4_rm2_model","Fault Line","unit4_rm2","unit4_rm2_tex"),new f("unit4_cx_model","4_CX","unit4_CX",null),new f("unit4_cz_model","4_CZ","unit4_CZ",null),"Stronghold Void",new f("TeleportRoom_model","Stronghold Gateway","TeleportRoom","teleportroom_tex"),new f("Cylinder_C1_model","Biodefense Chamber A Connect","Cylinder_C1_CZ",null),new f("cylinderroom_model","Biodefense Chamber A","cylinderroom","cylinderroom_tex"),new f("bigeye_c1_model","Biodefense Chamber B Connect","BigEye_C1_CZ",null),new f("bigeyeroom_model","Biodefense Chamber B","bigeyeroom","bigeyeroom_tex"),"Oubliette",new f("Gorea_Land_Model","Oubliette Gateway","Gorea_Land","Gorea_Land_tex"),new f("Gorea_b1_Model","Gorea Room","Gorea_b1","Gorea_b1_tex"),new f("gorea_b2_Model","Gorea Soul Room","Gorea_b2","gorea_b2_tex"),new f("Gorea_c1_Model","Gorea Connect Room(unused)","Gorea_C1_CZ",null),"TestRooms",new f("unit1_b2_model","biodefense chamber 06","unit1_b2",null),new f("unit2_b2_model","biodefense chamber 05","unit2_b2",null),new f("unit3_b1_model","biodefense chamber 03","unit3_b1",null),new f("unit3_b2_model","biodefense chamber 08","unit3_b2",null),new f("unit4_b1_model","biodefense chamber 04","unit4_b1",null),new f("unit4_b2_model","biodefense chamber 07","unit4_b2",null),"FirstHunt",new f("mp_fh_data/levels/models/blueRoom_Model","Regulator Stage",null,null),new f("mp_fh_data/levels/models/e3Level_Model","Morphball Stage",null,null),new f("mp_fh_data/levels/models/mp1_Model","Trooper Module",null,null),new f("mp_fh_data/levels/models/mp2_Model","Assault Cradle / Survivour Stage",null,null),new f("mp_fh_data/levels/models/mp3_Model","Ancient Vestige",null,null),new f("mp_fh_data/levels/models/mp5_Model","MAP 5",null,null),new f("mp_fh_data/levels/models/testLevel_Model","Test Room",null,null)];t.sceneGroup={id:"mph",name:"Metroid Prime: Hunters",sceneDescs:A}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.parse=function(e){const t=e.createDataView();return r.assert("SNDFILE"===r.readString(e,0,7)),function(e,t){const a=t.createDataView();function n(e){const r=a.getUint32(64*e+64,!1),n=a.getUint32(64*e+72,!1);return t.slice(r,r+n)}const s=[];let i=0;for(let a=0;a<e;a++){i=64*a+32;const e=n(a),o=r.readString(t,i,32,!0);s.push({path:o,fileId:a,buffer:e})}return{files:s}}(t.getUint32(8,!1),e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(55),n=a(1),s=a(44),i=a(0),o=a(4);function l(e,t){const a=e.createDataView(),s=i.readString(e,0,64,!0),l=a.getUint8(65),c=a.getInt8(66),h=(a.getInt8(67),a.getUint16(68,!0)),d=a.getUint16(70,!0),u=a.getUint16(72,!0),m=(o.colorNewFromRGBA(a.getInt8(74),a.getInt8(75),a.getInt8(76)),o.colorNewFromRGBA(a.getInt8(77),a.getInt8(78),a.getInt8(79)),o.colorNewFromRGBA(a.getInt8(80),a.getInt8(81),a.getInt8(82)),a.getInt8(83),a.getInt32(84,!0)),p=(a.getInt32(92,!0),a.getInt32(96,!0),a.getInt32(100,!0),r.fx32(a.getInt32(104,!0))),f=r.fx32(a.getInt32(108,!0)),A=r.fx16(a.getUint16(112,!0)),g=(a.getInt16(114,!0),r.fx32(a.getInt32(116,!0))),_=r.fx32(a.getInt32(120,!0));a.getInt16(126,!0),a.getInt8(128),a.getInt8(129),a.getInt16(130,!0);let S,b;const v=n.mat2d.create();let w,x;65535==h||65535==d?(b=null,S=null,w=1,x=1):(b=`pallet_${h}`,S=`texture_${d}`,w=t[d].width,x=t[d].height);let T=1,y=0;if(Math.abs(A)>0){const e=A;y=Math.sin(e),T=Math.cos(e)}const C=1/w,M=1/x,U=g*w,k=_*x;return r.calcTexMtx(v,0,C,M,p,f,y,T,U,k),{name:s,textureName:S,paletteName:b,cullMode:l,alpha:c,polyAttribs:m,texParams:u,texMatrix:v,texScaleS:C,texScaleT:M}}function c(e,t,a){const r=e.createDataView(),n=r.getUint32(0,!0),s=r.getUint32(4,!0);r.getUint32(8,!0),r.getUint32(12,!0),r.getUint32(16,!0),r.getUint32(20,!0),r.getUint32(24,!0),r.getUint32(28,!0);return{name:`polygon_${a}`,dlBuffer:t.slice(n,n+s)}}function h(e){const t=e.createDataView();let a=n.vec3.create(),s=n.vec3.create();const o=n.mat4.create(),l=i.readString(e,0,64,!0),c=t.getInt16(64,!0),h=t.getInt16(66,!0),d=t.getInt16(68,!0),u=(t.getInt16(70,!0),t.getInt32(72,!0),t.getInt16(76,!0),t.getInt16(78,!0));t.getInt32(80,!0),t.getInt32(84,!0),t.getInt32(88,!0),t.getInt16(84,!0),t.getInt16(94,!0),t.getInt16(96,!0),t.getInt16(98,!0),t.getInt32(100,!0),t.getInt32(104,!0),t.getInt32(108,!0),t.getInt32(112,!0);n.vec3.set(a,r.fx32(t.getInt32(116,!0)),r.fx32(t.getInt32(120,!0)),r.fx32(t.getInt32(124,!0))),n.vec3.set(s,r.fx32(t.getInt32(128,!0)),r.fx32(t.getInt32(132,!0)),r.fx32(t.getInt32(136,!0)));t.getUint8(140),t.getInt8(141),t.getInt16(142,!0);o[15]=1,o[0]=r.fx32(t.getInt32(144,!0)),o[4]=r.fx32(t.getInt32(148,!0)),o[8]=r.fx32(t.getInt32(152,!0)),o[1]=r.fx32(t.getInt32(156,!0)),o[5]=r.fx32(t.getInt32(160,!0)),o[9]=r.fx32(t.getInt32(164,!0)),o[2]=r.fx32(t.getInt32(168,!0)),o[6]=r.fx32(t.getInt32(172,!0)),o[10]=r.fx32(t.getInt32(176,!0)),o[3]=r.fx32(t.getInt32(180,!0)),o[7]=r.fx32(t.getInt32(184,!0)),o[11]=r.fx32(t.getInt32(188,!0));t.getInt32(192,!0),t.getInt32(196,!0),t.getInt32(200,!0),t.getInt32(204,!0),t.getInt32(208,!0),t.getInt32(212,!0),t.getInt32(216,!0),t.getInt32(220,!0),t.getInt32(224,!0),t.getInt32(228,!0),t.getInt32(232,!0),t.getInt32(236,!0);return{name:l,parent:c,child:h,next:d,meshID:u,node_transform:o}}function d(e){const t=e.createDataView();return{matID:t.getUint16(0,!0),shapeID:t.getUint16(2,!0)}}function u(e,t,a){const r=e.createDataView(),n=r.getUint32(0,!0),s=n+r.getUint32(4,!0);return{name:`pallet_${a}`,data:t.slice(n,s)}}function m(e,t,a){const r=e.createDataView(),n=`texture_${a}`,i=r.getInt8(0),o=(r.getInt8(1),r.getUint16(2,!0)),l=r.getUint16(4,!0),c=(r.getUint16(6,!0),r.getUint32(8,!0)),h=r.getInt32(12,!0),d=(r.getUint32(16,!0),r.getUint32(20,!0),r.getInt32(24,!0),r.getInt32(28,!0),r.getInt32(32,!0),r.getUint8(36),r.getUint8(37),r.getInt16(38,!0),c),u=d+h;return{name:n,format:function(e){switch(e){case 0:return s.Format.Tex_Palette4;case 1:return s.Format.Tex_Palette16;case 2:return s.Format.Tex_Palette256;case 3:return s.Format.Tex_CMPR_4x4;case 4:return s.Format.Tex_A5I3;case 5:return s.Format.Tex_Direct;case 6:return s.Format.Tex_A3I5;default:return s.Format.Tex_None}}(i),width:o,height:l,color0:!1,texData:t.slice(d,u),palIdxData:null}}t.parseMPH_Model=function(e){const t=e.createDataView(),a=t.getInt32(0,!0),s=r.fx32(t.getInt32(4,!0)),i=(t.getInt32(8,!0),t.getInt32(12,!0),t.getUint32(16,!0)),o=t.getUint32(20,!0),u=t.getUint32(24,!0),m=(t.getInt16(28,!0),t.getInt8(30),t.getInt8(31),t.getUint32(32,!0),t.getUint32(36,!0)),p=t.getUint16(40,!0),f=(t.getUint16(42,!0),t.getUint32(44,!0)),A=t.getUint16(48,!0),g=(t.getUint16(50,!0),t.getUint32(52,!0)),_=(t.getUint16(56,!0),t.getUint16(60,!0),r.fx32(t.getInt32(64,!0)),r.fx32(t.getInt32(68,!0)),t.getUint16(72,!0)),S=t.getUint16(74,!0),b=(t.getUint16(76,!0),t.getUint16(80,!0),t.getUint16(84,!0),t.getUint16(88,!0),t.getUint16(92,!0),t.getUint16(96,!0)),v=(t.getUint16(98,!0),[]);for(let t=0;t<b;t++){const a=4*t+m;v.push(d(e.slice(a)))}const w=[];for(let a=0;a<p;a++){const r=40*a+f,n=r+40,s=e.slice(r,n),i=t.getInt16(r+2,!0),o=t.getInt16(r+4,!0),l=!1;w.push({tex:s,width:i,height:o,color0:l})}const x=[];for(let t=0;t<A;t++){const a=g+16*t,r=a+16,n=e.slice(a,r);x.push({pal:n})}const T=[];for(let t=0;t<_;t++){const a=132*t+i;T.push(l(e.slice(a),w))}const y=[];for(let t=0;t<b;t++){const a=32*t+o;y.push(c(e.slice(a),e,t))}const C=[];for(let t=0;t<S;t++){const a=240*t+u;C.push(h(e.slice(a)))}const M={pals:x,texs:w},U=e.slice(0,16),k=[],D=n.mat4.create(),I=[];return I.push({name:"model_0",jointMatrix:D}),k.push({name:"model_0",nodes:I,materials:T,shapes:y,sbcBuffer:U,posScale:s,texMtxMode:0}),{models:k,tex0:null,mphTex:M,meshs:v,mtx_shmat:a}},t.parseTEX0Texture=function(e,t){const a=[];for(let r=0;r<t.pals.length;r++)a.push(u(t.pals[r].pal,e,r));const r=[];for(let a=0;a<t.texs.length;a++)r.push(m(t.texs[a].tex,e,a)),r[a].color0=!!t.texs[a].color0;return{textures:r,palettes:a}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(1),i=a(6),o=r(a(66)),l=a(44),c=a(94),h=a(7),d=a(10),u=a(13),m=a(8),p=n(a(18)),f=a(0),A=a(14),g=a(69);function _(e,t){return t?2:e?1:0}function S(e){return _(1==(e>>8&1),1==(e>>9&1))}const b=s.mat2d.create();class v{constructor(e,t,a,r){this.model=a,this.material=r,this.gfxTextures=[],this.textureNames=[],this.gfxSampler=null,this.textureMappings=f.nArray(1,()=>new d.TextureMapping),this.viewerTextures=[],this.srt0Animator=null,this.pat0Animator=null;const n=t.textures.find(e=>e.name===this.material.textureName);var s,o;if(this.texture=void 0!==n?n:null,this.translateTexture(e,t,this.material.textureName,this.material.paletteName),this.baseCtx={color:{r:255,g:255,b:255},alpha:(s=this.material.alpha,s<<3|s>>>2)},this.gfxTextures.length>0){this.gfxSampler=e.createSampler({minFilter:0,magFilter:0,mipFilter:0,wrapS:(o=this.material.texParams,_(1==(o>>0&1),1==(o>>1&1))),wrapT:S(this.material.texParams),minLOD:0,maxLOD:100});const t=this.textureMappings[0];t.gfxTexture=this.gfxTextures[0],t.gfxSampler=this.gfxSampler}const c=this.material.alpha<31||this.texture&&l.textureFormatIsTranslucent(this.texture.format),u=!!(this.material.polyAttribs>>>11&1)||!c,m=c?128:32;this.sortKey=h.makeSortKeyOpaque(m,0),this.megaStateFlags={depthWrite:u,cullMode:this.material.cullMode},A.setAttachmentStateSimple(this.megaStateFlags,{blendMode:i.GfxBlendMode.ADD,blendDstFactor:i.GfxBlendFactor.ONE_MINUS_SRC_ALPHA,blendSrcFactor:i.GfxBlendFactor.SRC_ALPHA})}translateTexture(e,t,a,r){if(null===t||null===a)return;const n=f.assertExists(t.textures.find(e=>e.name===a)),s=null!==r?f.assertExists(t.palettes.find(e=>e.name===r)):null,o=`${a}/${r}`;if(this.textureNames.indexOf(o)>=0)return;this.textureNames.push(o);const c=Object.assign(Object.assign({},n),{palData:null!==s?s.data:null}),h=l.readTexture(c),d=e.createTexture(i.makeTextureDescriptor2D(i.GfxFormat.U8_RGBA_NORM,n.width,n.height,1));this.gfxTextures.push(d);const u=e.createHostAccessPass();u.uploadTextureData(d,0,[h]),e.submitPass(u),this.viewerTextures.push(function(e,t,a){const r=document.createElement("canvas");r.width=e.width,r.height=e.height,r.title=a;const n=r.getContext("2d"),s=n.createImageData(r.width,r.height);s.data.set(t),n.putImageData(s,0,0);const i=[r],o=new Map;return o.set("Format",l.getFormatName(e.format)),{name:a,surfaces:i,extraInfo:o}}(n,h,o))}setOnRenderInst(e,t){if(null!==this.srt0Animator?this.srt0Animator.calcTexMtx(b,this.model.texMtxMode,this.material.texScaleS,this.material.texScaleT):s.mat2d.copy(b,this.material.texMatrix),e.sortKey=this.sortKey,e.setMegaStateFlags(this.megaStateFlags),null!==this.pat0Animator){const e=this.pat0Animator.calcFullTextureName();let t=this.textureNames.indexOf(e);t>=0&&(this.textureMappings[0].gfxTexture=this.gfxTextures[t])}e.setSamplerBindingsFromTextureMappings(this.textureMappings);let a=e.allocateUniformBuffer(c.NITRO_Program.ub_MaterialParams,12);const r=e.mapUniformBufferF32(c.NITRO_Program.ub_MaterialParams);a+=u.fillMatrix3x2(r,a,b),a+=u.fillVec4(r,a,0)}destroy(e){for(let t=0;t<this.gfxTextures.length;t++)e.destroyTexture(this.gfxTextures[t]);null!==this.gfxSampler&&e.destroySampler(this.gfxSampler)}}class w{constructor(e){this.node=e,this.modelMatrix=s.mat4.create(),this.billboardMode=0}calcMatrix(e){s.mat4.mul(this.modelMatrix,e,this.node.jointMatrix)}}const x=s.mat4.create();class T{constructor(e,t,a,r,n){this.materialInstance=t,this.node=a,this.shape=r;const s=this.materialInstance.baseCtx,i=o.readCmds(r.dlBuffer,s,n);this.vertexData=new c.VertexData(e,i)}computeModelView(e,t){m.computeViewMatrix(e,t.camera),s.mat4.mul(e,e,this.node.modelMatrix),1===this.node.billboardMode?g.calcBBoardMtx(e,e):2===this.node.billboardMode&&g.calcYBBoardMtx(e,e)}prepareToRender(e,t){const a=e.pushTemplateRenderInst();a.setInputLayoutAndState(this.vertexData.inputLayout,this.vertexData.inputState);let r=a.allocateUniformBuffer(c.NITRO_Program.ub_PacketParams,384);const n=a.mapUniformBufferF32(c.NITRO_Program.ub_PacketParams);this.computeModelView(x,t),r+=u.fillMatrix4x3(n,r,x),this.materialInstance.setOnRenderInst(a,t);for(let t=0;t<this.vertexData.nitroVertexData.drawCalls.length;t++){const a=this.vertexData.nitroVertexData.drawCalls[t];e.pushRenderInst().drawIndexes(a.numIndices,a.startIndex)}e.popTemplateRenderInst()}destroy(e){this.vertexData.destroy(e)}}const y=[{numUniformBuffers:3,numSamplers:1}];t.MPHRenderer=class{constructor(e,t,a){this.mphModel=t,this.tex0=a,this.modelMatrix=s.mat4.create(),this.isSkybox=!1,this.animationController=new p.default,this.materialInstances=[],this.shapeInstances=[],this.nodes=[],this.viewerTextures=[];const r=new c.NITRO_Program;let n;r.defines.set("USE_VERTEX_COLOR","1"),r.defines.set("USE_TEXTURE","1"),this.gfxProgram=e.createProgram(r),n=t.mtx_shmat<=0?4:4*t.mtx_shmat,s.mat4.fromScaling(this.modelMatrix,[n,n,n]);const i=t.models[0];for(let t=0;t<i.materials.length;t++)this.materialInstances.push(new v(e,this.tex0,i,i.materials[t]));for(let e=0;e<i.nodes.length;e++)this.nodes.push(new w(i.nodes[e]));for(let e=0;e<this.materialInstances.length;e++)this.materialInstances[e].viewerTextures.length>0&&this.viewerTextures.push(this.materialInstances[e].viewerTextures[0]);for(let a=0;a<t.meshs.length;a++){const r=t.meshs[a].matID,s=t.meshs[a].shapeID,o=i.shapes[s],l=0;this.shapeInstances.push(new T(e,this.materialInstances[r],this.nodes[l],o,n))}}prepareToRender(e,t){this.animationController.setTimeInMilliseconds(t.time);for(let e=0;e<this.nodes.length;e++)this.nodes[e].calcMatrix(this.modelMatrix);const a=e.pushTemplateRenderInst();a.setBindingLayouts(y),a.filterKey=1,a.setGfxProgram(this.gfxProgram);let r=a.allocateUniformBuffer(c.NITRO_Program.ub_SceneParams,16);const n=a.mapUniformBufferF32(c.NITRO_Program.ub_SceneParams);r+=u.fillMatrix4x4(n,r,t.camera.projectionMatrix);for(let a=0;a<this.shapeInstances.length;a++)this.shapeInstances[a].prepareToRender(e,t);e.popTemplateRenderInst()}destroy(e){e.destroyProgram(this.gfxProgram);for(let t=0;t<this.materialInstances.length;t++)this.materialInstances[t].destroy(e);for(let t=0;t<this.shapeInstances.length;t++)this.shapeInstances[t].destroy(e)}}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=r(a(111)),s=a(69),i=a(0),o=a(1),l=a(9),c=a(10),h=a(7),d=a(33),u=a(55),m=a(12);class p{constructor(e){this.dataFetcher=e,this.filePromiseCache=new Map,this.fileDataCache=new Map}waitForLoad(){const e=[...this.filePromiseCache.values()];return Promise.all(e)}mountNARC(e,t){for(let a=0;a<e.files.length;a++){const r=e.files[a];this.fileDataCache.set(`${t}/${a}.bin`,r.buffer)}}fetchFile(e){i.assert(!this.filePromiseCache.has(e));const t=this.dataFetcher.fetchData(`PokemonPlatinum/${e}`);return this.filePromiseCache.set(e,t),t}async fetchNARC(e,t){const a=await this.fetchFile(e),r=n.parse(a);this.mountNARC(r,t)}getFileData(e){return this.fileDataCache.has(e)?this.fileDataCache.get(e):null}}class f{constructor(e,t){this.objectRenderers=t,this.renderTarget=new l.BasicRenderTarget,this.renderInstManager=new h.GfxRenderInstManager,this.uniformBuffer=new d.GfxRenderDynamicUniformBuffer(e);const a=[];for(let e=0;e<this.objectRenderers.length;e++){const t=this.objectRenderers[e];for(let e=0;e<t.viewerTextures.length;e++)a.push(t.viewerTextures[e])}this.textureHolder=new c.FakeTextureHolder(a)}adjustCameraController(e){e.setSceneMoveSpeedMult(10)}prepareToRender(e,t,a){this.renderInstManager.pushTemplateRenderInst().setUniformBuffer(this.uniformBuffer);for(let e=0;e<this.objectRenderers.length;e++)this.objectRenderers[e].prepareToRender(this.renderInstManager,a);this.renderInstManager.popTemplateRenderInst(),this.uniformBuffer.prepareToRender(e,t)}render(e,t){const a=e.createHostAccessPass();this.prepareToRender(e,a,t),e.submitPass(a),this.renderTarget.setParameters(e,t.backbufferWidth,t.backbufferHeight);const r=this.renderTarget.createRenderPass(e,t.viewport,l.transparentBlackFullClearRenderPassDescriptor);this.renderInstManager.setVisibleByFilterKeyExact(2),this.renderInstManager.drawOnPassRenderer(e,r),e.submitPass(r);const n=this.renderTarget.createRenderPass(e,t.viewport,l.depthClearRenderPassDescriptor);return this.renderInstManager.setVisibleByFilterKeyExact(1),this.renderInstManager.drawOnPassRenderer(e,n),this.renderInstManager.resetRenderInsts(),n}destroy(e){this.renderInstManager.destroy(e),this.renderTarget.destroy(e),this.uniformBuffer.destroy(e),this.renderTarget.destroy(e);for(let t=0;t<this.objectRenderers.length;t++)this.objectRenderers[t].destroy(e)}}function A(e,t,a){return function(e,t){for(let a=0;a<e.materials.length;a++)if(null!==e.materials[a].textureName&&void 0===t.textures.find(t=>t.name===e.materials[a].textureName))return!1;return!0}(t,a)?new s.MDL0Renderer(e,t,a):null}t.PlatinumMapRenderer=f;const g=[new class{constructor(e,t){this.id=e,this.name=t}async createScene(e,t){const a=t.dataFetcher,r=new p(a);r.fetchNARC("land_data.narc","land_data"),r.fetchNARC("map_tex_set.narc","map_tex_set"),r.fetchNARC("build_model.narc","build_model"),r.fetchNARC("map_matrix.narc","map_matrix"),await r.waitForLoad();const n=new Map,l=[],c=[],h=[],d=[],g=[],_=(await a.fetchData("PokemonPlatinum/maps.bin")).createDataView();for(let e=0;e<700;e++)g[e]=_.getUint8(24*e);const S=i.assertExists(r.getFileData("map_matrix/0.bin")).createDataView();let b=8;for(let e=0;e<30;e++){c[e]=[];for(let t=0;t<30;t++)c[e][t]=S.getUint16(b,!0),b+=2}for(let e=0;e<30;e++){h[e]=[];for(let t=0;t<30;t++)h[e][t]=S.getUint8(b),b+=1}for(let e=0;e<30;e++){d[e]=[];for(let t=0;t<30;t++)d[e][t]=S.getUint16(b,!0),b+=2}let v=0;for(;null!==r.getFileData(`map_tex_set/${v}.bin`);)n.set(v,u.parseNSBTX(i.assertExists(r.getFileData(`map_tex_set/${v}.bin`)))),v++;for(let t=0;t<30;t++)for(let a=0;a<30;a++){if(65535===d[t][a])continue;const p=i.assertExists(r.getFileData(`land_data/${d[t][a]}.bin`)),f=i.assertExists(p).createDataView(),_=f.getUint32(0,!0)+16,S=f.getUint32(4,!0)+_,b=f.getUint32(8,!0),v=u.parseNSBMD(p.slice(S,S+b)),w=g[c[t][a]];let x=null;if(null===x&&(x=A(e,v.models[0],i.assertExists(n.get(w).tex0))),null===x&&(x=A(e,v.models[0],i.assertExists(n.get(6).tex0))),null===x)continue;o.mat4.translate(x.modelMatrix,x.modelMatrix,[512*a,8*h[t][a],512*t]);const T=new m.AABB(-256,-256,-256,256,256,256);T.transform(T,x.modelMatrix),x.bbox=T,l.push(x);const y=(S-_)/48;for(let n=0;n<y;n++){const c=_+48*n,h=f.getUint32(c,!0),d=u.fx32(f.getInt32(c+4,!0)),m=u.fx32(f.getInt32(c+8,!0)),p=u.fx32(f.getInt32(c+12,!0)),A=i.assertExists(r.getFileData(`build_model/${h}.bin`)),g=u.parseNSBMD(A),S=new s.MDL0Renderer(e,g.models[0],i.assertExists(g.tex0));S.bbox=T,o.mat4.translate(S.modelMatrix,S.modelMatrix,[d+512*a,m,p+512*t]),l.push(S)}}return new f(e,l)}}("0","Sinnoh Region")];t.sceneGroup={id:"pkmnpl",name:"Pokemon Platinum",sceneDescs:g}},function(e,t,a){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(5),i=r(a(29)),o=n(a(18)),l=a(41),c=a(42);class h{constructor(e,t,a,r,n,s,c=null){this.model=n,this.scn0=s,this.isStarting=!0,this.modelData=new l.MDL0Model(e,t,n),this.modelInstance=new l.MDL0ModelInstance(a,this.modelData),this.modelAnimationController=new o.default(30),this.modelInstance.bindRRESAnimations(this.modelAnimationController,r),this.scn0AnimationController=new o.default(30),this.scn0Animator=new i.SCN0Animator(this.scn0AnimationController,this.scn0),this.duration=null!==c?c:Math.max(this.scn0.duration,60)}prepareToRender(e,t,a){this.modelAnimationController.setTimeFromViewerInput(a),this.scn0AnimationController.setTimeFromViewerInput(a),this.scn0AnimationController.quantizeTimeToFPS(),this.isStarting&&(this.modelAnimationController.setPhaseToCurrent(),this.scn0AnimationController.setPhaseToCurrent(),this.isStarting=!1),this.scn0Animator.calcCameraPositionAim(a.camera,0),this.scn0Animator.calcCameraProjection(a.camera,0);const r=t.pushTemplateRenderInst();return r.allocateUniformBuffer(s.ub_SceneParams,s.u_SceneParamsBufferSize),s.fillSceneParamsDataOnTemplate(r,a),this.modelInstance.prepareToRender(e,t,a),t.popTemplateRenderInst(),this.scn0AnimationController.getTimeInFrames()>=this.duration}}class d extends s.BasicGXRendererHelper{constructor(e,t,a,r){super(e),this.textureHolder=new l.RRESTextureHolder,this.isInteractive=!1,this.stages=[],this.currentStage=0,this.textureHolder.addRRESTextures(e,t),this.textureHolder.addRRESTextures(e,a),this.textureHolder.addRRESTextures(e,r);const n=(t,a,r)=>{this.stages.push(new h(e,this.getCache(),this.textureHolder,t,t.mdl0.find(e=>e.name===a),t.scn0.find(e=>e.name===r)))};n(a,"WiiBgStart","WiiBgStart"),n(a,"WiiBgStart","WiiBgStartUp"),n(a,"WiiBg01","WiiBg01"),n(a,"WiiBg00","WiiBg00_00"),n(a,"WiiBg01","WiiBg01_12"),n(a,"WiiBg04","WiiBg04"),n(a,"WiiBg06","WiiBg06"),n(a,"WiiBg07","WiiBg07_00"),n(a,"WiiBg07","WiiBg07_01"),n(a,"WiiBg08","WiiBg08_00"),n(r,"WiiUBgStartA","WiiUBgStartA"),n(r,"WiiUBgStartC","WiiUBgStartC"),n(r,"WiiUBg00","WiiUBg00"),n(r,"WiiUBg01","WiiUBg01_00"),n(r,"WiiUBg03","WiiUBg03"),n(r,"WiiUBg04","WiiUBg04_00"),n(r,"WiiUBg05","WiiUBg05_00"),n(r,"WiiUBg05","WiiUBg05_10"),n(r,"WiiUBg05","WiiUBg05_20"),n(r,"WiiUBg06","WiiUBg06_00"),n(r,"WiiUBg06","WiiUBg06_30"),n(r,"WiiUBg07","WiiUBg07_00"),n(r,"WiiUBg08","WiiUBg08_00"),n(r,"WiiUBg09","WiiUBg09_00"),n(r,"WiiUBg09","WiiUBg09_10"),n(r,"WiiUBg10","WiiUBg10_00"),n(r,"WiiUBg11","WiiUBg11_00"),n(r,"WiiUBg12","WiiUBg12_00"),n(r,"WiiUBgGoal","WiiUBgGoal_00"),n(r,"WiiUBgGoal","WiiUBgGoal_01"),n(r,"WiiUBgGoal","WiiUBgGoal_02"),n(r,"WiiUBgGoal","WiiUBgGoal_03")}prepareToRender(e,t,a){this.renderHelper.pushTemplateRenderInst(),this.stages[this.currentStage].prepareToRender(e,this.renderHelper.renderInstManager,a)&&(this.currentStage=(this.currentStage+1)%this.stages.length,this.stages[this.currentStage].isStarting=!0),this.renderHelper.renderInstManager.popTemplateRenderInst(),this.renderHelper.prepareToRender(e,t)}}const u="WiiUTransferTool";const m=[new class{constructor(e,t=e){this.id=e,this.name=t}async createScene(e,t){const a=t.dataFetcher,r=i.parse(await a.fetchData(`${u}/ModelCommon/common.brres`)),n=i.parse(await a.fetchData(`${u}/ModelWii/map.brres`)),s=i.parse(await a.fetchData(`${u}/ModelWiiU/map.brres`));var o,l;return c.IS_DEVELOPMENT||await(o=t.uiContainer,l="XLtMQuZbecA",new Promise((e,t)=>{const a=document.createElement("iframe");a.width="0",a.height="0",a.allow="autoplay",a.src=`https://www.youtube.com/embed/${l}?autoplay=1&showinfo=0&loop=1`,a.onload=()=>{e()},o.appendChild(a)})),new d(e,r,n,s)}}("WiiUTransferTool","Wii U Transfer Tool")];t.sceneGroup={id:"WiiUTransferTool",name:"Wii U Transfer Tool",sceneDescs:m,hidden:!c.IS_DEVELOPMENT}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSceneDescs=function(e){return e.sceneDescs.filter(e=>"string"!=typeof e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=a(0);t.WebXRContext=class{constructor(e){this.swapChain=e,this.xrSession=null,this.onframe=null,this.onsupportedchanged=null,this.onstart=null,this.onend=null,this.isSupported=!1,this._onRequestAnimationFrame=(e,t)=>{const a=t.session,r=t.getViewerPose(this.xrLocalSpace);this.currentFrame=t,r&&(this.views=r.views),null!==this.onframe&&this.onframe(e),a.requestAnimationFrame(this._onRequestAnimationFrame)},this.checkIsSupported()}async checkIsSupported(){const e=window.navigator;if(void 0===e.xr)return;const t=await e.xr.isSessionSupported("immersive-vr");this.isSupported!==t&&(this.isSupported=t,null!==this.onsupportedchanged&&this.onsupportedchanged())}async start(){const e=window.navigator,t=r.assertExists(e.xr);if(this.xrSession=await t.requestSession("immersive-vr",{requiredFeatures:[],optionalFeatures:["viewer","local"]}),!this.xrSession)return;this.xrViewSpace=await this.xrSession.requestReferenceSpace("viewer"),this.xrLocalSpace=await this.xrSession.requestReferenceSpace("local");const a=this.swapChain.createWebXRLayer(this.xrSession);this.xrSession.updateRenderState({baseLayer:a,depthNear:5,depthFar:1e6}),null!==this.onstart&&this.onstart(),this.xrSession.requestAnimationFrame(this._onRequestAnimationFrame)}end(){this.xrSession&&this.xrSession.end(),this.xrSession=null,null!==this.onend&&this.onend()}}},,,,,function(e,t,a){"use strict";a.r(t);var r={};a.r(r),a.d(r,"FunctionToString",(function(){return de})),a.d(r,"InboundFilters",(function(){return me}));var n={};a.r(n),a.d(n,"GlobalHandlers",(function(){return Ee})),a.d(n,"TryCatch",(function(){return Se})),a.d(n,"Breadcrumbs",(function(){return Be})),a.d(n,"LinkedErrors",(function(){return Fe})),a.d(n,"UserAgent",(function(){return Oe}));var s={};a.r(s),a.d(s,"BaseTransport",(function(){return ne})),a.d(s,"FetchTransport",(function(){return ie})),a.d(s,"XHRTransport",(function(){return oe}));var i,o,l=a(3);!function(e){e.Fatal="fatal",e.Error="error",e.Warning="warning",e.Log="log",e.Info="info",e.Debug="debug",e.Critical="critical"}(i||(i={})),function(e){e.fromString=function(t){switch(t){case"debug":return e.Debug;case"info":return e.Info;case"warn":case"warning":return e.Warning;case"error":return e.Error;case"fatal":return e.Fatal;case"critical":return e.Critical;case"log":default:return e.Log}}}(i||(i={})),function(e){e.Unknown="unknown",e.Skipped="skipped",e.Success="success",e.RateLimit="rate_limit",e.Invalid="invalid",e.Failed="failed"}(o||(o={})),function(e){e.fromHttpCode=function(t){return t>=200&&t<300?e.Success:429===t?e.RateLimit:t>=400&&t<500?e.Invalid:t>=500?e.Failed:e.Unknown}}(o||(o={}));var c=a(126),h=a(356);function d(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];var r=Object(h.b)();if(r&&r[e])return r[e].apply(r,l.d(t));throw new Error("No hub defined or "+e+" was not found on the hub, please open a bug report.")}function u(e){var t;try{throw new Error("Sentry syntheticException")}catch(e){t=e}return d("captureException",e,{originalException:e,syntheticException:t})}function m(e,t){var a;try{throw new Error(e)}catch(e){a=e}return d("captureMessage",e,t,{originalException:e,syntheticException:a})}function p(e){return d("captureEvent",e)}function f(e){d("configureScope",e)}function A(e){d("addBreadcrumb",e)}function g(e,t){d("setContext",e,t)}function _(e){d("setExtras",e)}function S(e){d("setTags",e)}function b(e,t){d("setExtra",e,t)}function v(e,t){d("setTag",e,t)}function w(e){d("setUser",e)}function x(e){d("withScope",e)}var T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var a in t)e.hasOwnProperty(a)||(e[a]=t[a]);return e});var y=function(e){function t(t){var a=this.constructor,r=e.call(this,t)||this;return r.message=t,r.name=a.prototype.constructor.name,T(r,a.prototype),r}return l.b(t,e),t}(Error),C=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w\.-]+)(?::(\d+))?\/(.+)/,M=function(){function e(e){"string"==typeof e?this._fromString(e):this._fromComponents(e),this._validate()}return e.prototype.toString=function(e){void 0===e&&(e=!1);var t=this,a=t.host,r=t.path,n=t.pass,s=t.port,i=t.projectId;return t.protocol+"://"+t.user+(e&&n?":"+n:"")+"@"+a+(s?":"+s:"")+"/"+(r?r+"/":r)+i},e.prototype._fromString=function(e){var t=C.exec(e);if(!t)throw new y("Invalid Dsn");var a=l.c(t.slice(1),6),r=a[0],n=a[1],s=a[2],i=void 0===s?"":s,o=a[3],c=a[4],h=void 0===c?"":c,d="",u=a[5],m=u.split("/");m.length>1&&(d=m.slice(0,-1).join("/"),u=m.pop()),this._fromComponents({host:o,pass:i,path:d,projectId:u,port:h,protocol:r,user:n})},e.prototype._fromComponents=function(e){this.protocol=e.protocol,this.user=e.user,this.pass=e.pass||"",this.host=e.host,this.port=e.port||"",this.path=e.path||"",this.projectId=e.projectId},e.prototype._validate=function(){var e=this;if(["protocol","user","host","projectId"].forEach((function(t){if(!e[t])throw new y("Invalid Dsn")})),"http"!==this.protocol&&"https"!==this.protocol)throw new y("Invalid Dsn");if(this.port&&isNaN(parseInt(this.port,10)))throw new y("Invalid Dsn")},e}(),U=a(46),k=a(19),D=function(){function e(e){this.dsn=e,this._dsnObject=new M(e)}return e.prototype.getDsn=function(){return this._dsnObject},e.prototype.getStoreEndpoint=function(){return""+this._getBaseUrl()+this.getStoreEndpointPath()},e.prototype.getStoreEndpointWithUrlEncodedAuth=function(){var e={sentry_key:this._dsnObject.user,sentry_version:"7"};return this.getStoreEndpoint()+"?"+Object(U.e)(e)},e.prototype._getBaseUrl=function(){var e=this._dsnObject,t=e.protocol?e.protocol+":":"",a=e.port?":"+e.port:"";return t+"//"+e.host+a},e.prototype.getStoreEndpointPath=function(){var e=this._dsnObject;return(e.path?"/"+e.path:"")+"/api/"+e.projectId+"/store/"},e.prototype.getRequestHeaders=function(e,t){var a=this._dsnObject,r=["Sentry sentry_version=7"];return r.push("sentry_timestamp="+Object(k.m)()),r.push("sentry_client="+e+"/"+t),r.push("sentry_key="+a.user),a.pass&&r.push("sentry_secret="+a.pass),{"Content-Type":"application/json","X-Sentry-Auth":r.join(", ")}},e.prototype.getReportDialogEndpoint=function(e){void 0===e&&(e={});var t=this._dsnObject,a=this._getBaseUrl()+(t.path?"/"+t.path:"")+"/api/embed/error-page/",r=[];for(var n in r.push("dsn="+t.toString()),e)if("user"===n){if(!e.user)continue;e.user.name&&r.push("name="+encodeURIComponent(e.user.name)),e.user.email&&r.push("email="+encodeURIComponent(e.user.email))}else r.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return r.length?a+"?"+r.join("&"):a},e}(),I=a(71),R=a(24),B=a(103),P=a(70),E=[];function F(e){var t={};return function(e){var t=e.defaultIntegrations&&l.d(e.defaultIntegrations)||[],a=e.integrations,r=[];if(Array.isArray(a)){var n=a.map((function(e){return e.name})),s=[];t.forEach((function(e){-1===n.indexOf(e.name)&&-1===s.indexOf(e.name)&&(r.push(e),s.push(e.name))})),a.forEach((function(e){-1===s.indexOf(e.name)&&(r.push(e),s.push(e.name))}))}else"function"==typeof a?(r=a(t),r=Array.isArray(r)?r:[r]):r=l.d(t);var i=r.map((function(e){return e.name}));return-1!==i.indexOf("Debug")&&r.push.apply(r,l.d(r.splice(i.indexOf("Debug"),1))),r}(e).forEach((function(e){t[e.name]=e,function(e){-1===E.indexOf(e.name)&&(e.setupOnce(c.b,h.b),E.push(e.name),I.a.log("Integration installed: "+e.name))}(e)})),t}var V=function(){function e(e,t){this._integrations={},this._processing=!1,this._backend=new e(t),this._options=t,t.dsn&&(this._dsn=new M(t.dsn)),this._isEnabled()&&(this._integrations=F(this._options))}return e.prototype.captureException=function(e,t,a){var r=this,n=t&&t.event_id;return this._processing=!0,this._getBackend().eventFromException(e,t).then((function(e){return r._processEvent(e,t,a)})).then((function(e){n=e&&e.event_id,r._processing=!1})).then(null,(function(e){I.a.error(e),r._processing=!1})),n},e.prototype.captureMessage=function(e,t,a,r){var n=this,s=a&&a.event_id;return this._processing=!0,(Object(R.i)(e)?this._getBackend().eventFromMessage(""+e,t,a):this._getBackend().eventFromException(e,a)).then((function(e){return n._processEvent(e,a,r)})).then((function(e){s=e&&e.event_id,n._processing=!1})).then(null,(function(e){I.a.error(e),n._processing=!1})),s},e.prototype.captureEvent=function(e,t,a){var r=this,n=t&&t.event_id;return this._processing=!0,this._processEvent(e,t,a).then((function(e){n=e&&e.event_id,r._processing=!1})).then(null,(function(e){I.a.error(e),r._processing=!1})),n},e.prototype.getDsn=function(){return this._dsn},e.prototype.getOptions=function(){return this._options},e.prototype.flush=function(e){var t=this;return this._isClientProcessing(e).then((function(a){return clearInterval(a.interval),t._getBackend().getTransport().close(e).then((function(e){return a.ready&&e}))}))},e.prototype.close=function(e){var t=this;return this.flush(e).then((function(e){return t.getOptions().enabled=!1,e}))},e.prototype.getIntegrations=function(){return this._integrations||{}},e.prototype.getIntegration=function(e){try{return this._integrations[e.id]||null}catch(t){return I.a.warn("Cannot retrieve integration "+e.id+" from the current Client"),null}},e.prototype._isClientProcessing=function(e){var t=this;return new B.a((function(a){var r=0,n=0;clearInterval(n),n=setInterval((function(){t._processing?(r+=1,e&&r>=e&&a({interval:n,ready:!1})):a({interval:n,ready:!0})}),1)}))},e.prototype._getBackend=function(){return this._backend},e.prototype._isEnabled=function(){return!1!==this.getOptions().enabled&&void 0!==this._dsn},e.prototype._prepareEvent=function(e,t,a){var r=this,n=this.getOptions(),s=n.environment,i=n.release,o=n.dist,c=n.maxValueLength,h=void 0===c?250:c,d=n.normalizeDepth,u=void 0===d?3:d,m=l.a({},e);void 0===m.environment&&void 0!==s&&(m.environment=s),void 0===m.release&&void 0!==i&&(m.release=i),void 0===m.dist&&void 0!==o&&(m.dist=o),m.message&&(m.message=Object(P.d)(m.message,h));var p=m.exception&&m.exception.values&&m.exception.values[0];p&&p.value&&(p.value=Object(P.d)(p.value,h));var f=m.request;f&&f.url&&(f.url=Object(P.d)(f.url,h)),void 0===m.event_id&&(m.event_id=a&&a.event_id?a.event_id:Object(k.n)()),this._addIntegrations(m.sdk);var A=B.a.resolve(m);return t&&(A=t.applyToEvent(m,a)),A.then((function(e){return"number"==typeof u&&u>0?r._normalizeEvent(e,u):e}))},e.prototype._normalizeEvent=function(e,t){return e?l.a({},e,e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((function(e){return l.a({},e,e.data&&{data:Object(U.c)(e.data,t)})}))},e.user&&{user:Object(U.c)(e.user,t)},e.contexts&&{contexts:Object(U.c)(e.contexts,t)},e.extra&&{extra:Object(U.c)(e.extra,t)}):null},e.prototype._addIntegrations=function(e){var t=Object.keys(this._integrations);e&&t.length>0&&(e.integrations=t)},e.prototype._processEvent=function(e,t,a){var r=this,n=this.getOptions(),s=n.beforeSend,i=n.sampleRate;return this._isEnabled()?"number"==typeof i&&Math.random()>i?B.a.reject("This event has been sampled, will not send event."):new B.a((function(n,i){r._prepareEvent(e,a,t).then((function(e){if(null!==e){var a=e;try{if(t&&t.data&&!0===t.data.__sentry__||!s)return r._getBackend().sendEvent(a),void n(a);var o=s(e,t);if(void 0===o)I.a.error("`beforeSend` method has to return `null` or a valid event.");else if(Object(R.m)(o))r._handleAsyncBeforeSend(o,n,i);else{if(null===(a=o))return I.a.log("`beforeSend` returned `null`, will not send event."),void n(null);r._getBackend().sendEvent(a),n(a)}}catch(e){r.captureException(e,{data:{__sentry__:!0},originalException:e}),i("`beforeSend` threw an error, will not send event.")}}else i("An event processor returned null, will not send event.")})).then(null,(function(){i("`beforeSend` threw an error, will not send event.")}))})):B.a.reject("SDK not enabled, will not send event.")},e.prototype._handleAsyncBeforeSend=function(e,t,a){var r=this;e.then((function(e){null!==e?(r._getBackend().sendEvent(e),t(e)):a("`beforeSend` returned `null`, will not send event.")})).then(null,(function(e){a("beforeSend rejected with "+e)}))},e}(),O=function(){function e(){}return e.prototype.sendEvent=function(e){return B.a.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:o.Skipped})},e.prototype.close=function(e){return B.a.resolve(!0)},e}(),N=function(){function e(e){this._options=e,this._options.dsn||I.a.warn("No DSN provided, backend will not do anything."),this._transport=this._setupTransport()}return e.prototype._setupTransport=function(){return new O},e.prototype.eventFromException=function(e,t){throw new y("Backend has to implement `eventFromException` method")},e.prototype.eventFromMessage=function(e,t,a){throw new y("Backend has to implement `eventFromMessage` method")},e.prototype.sendEvent=function(e){this._transport.sendEvent(e).then(null,(function(e){I.a.error("Error while sending event: "+e)}))},e.prototype.getTransport=function(){return this._transport},e}();function L(){if(!("fetch"in Object(k.g)()))return!1;try{return new Headers,new Request(""),new Response,!0}catch(e){return!1}}function G(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function H(){if(!L())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(e){return!1}}var j=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,W=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js))(?::(\d+))?(?::(\d+))?\s*$/i,Z=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,z=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,K=/\((\S*)(?::(\d+))(?::(\d+))\)/;function X(e){var t=null,a=e&&e.framesToPop;try{if(t=function(e){if(!e||!e.stacktrace)return null;for(var t,a=e.stacktrace,r=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,n=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,s=a.split("\n"),i=[],o=0;o<s.length;o+=2){var l=null;(t=r.exec(s[o]))?l={url:t[2],func:t[3],args:[],line:+t[1],column:null}:(t=n.exec(s[o]))&&(l={url:t[6],func:t[3]||t[4],args:t[5]?t[5].split(","):[],line:+t[1],column:+t[2]}),l&&(!l.func&&l.line&&(l.func="?"),i.push(l))}if(!i.length)return null;return{message:$(e),name:e.name,stack:i}}(e))return Y(t,a)}catch(e){}try{if(t=function(e){if(!e||!e.stack)return null;for(var t,a,r,n=[],s=e.stack.split("\n"),i=0;i<s.length;++i){if(a=j.exec(s[i])){var o=a[2]&&0===a[2].indexOf("native");a[2]&&0===a[2].indexOf("eval")&&(t=K.exec(a[2]))&&(a[2]=t[1],a[3]=t[2],a[4]=t[3]),r={url:a[2]&&0===a[2].indexOf("address at ")?a[2].substr("address at ".length):a[2],func:a[1]||"?",args:o?[a[2]]:[],line:a[3]?+a[3]:null,column:a[4]?+a[4]:null}}else if(a=Z.exec(s[i]))r={url:a[2],func:a[1]||"?",args:[],line:+a[3],column:a[4]?+a[4]:null};else{if(!(a=W.exec(s[i])))continue;a[3]&&a[3].indexOf(" > eval")>-1&&(t=z.exec(a[3]))?(a[1]=a[1]||"eval",a[3]=t[1],a[4]=t[2],a[5]=""):0!==i||a[5]||void 0===e.columnNumber||(n[0].column=e.columnNumber+1),r={url:a[3],func:a[1]||"?",args:a[2]?a[2].split(","):[],line:a[4]?+a[4]:null,column:a[5]?+a[5]:null}}!r.func&&r.line&&(r.func="?"),n.push(r)}if(!n.length)return null;return{message:$(e),name:e.name,stack:n}}(e))return Y(t,a)}catch(e){}return{message:$(e),name:e&&e.name,stack:[],failed:!0}}function Y(e,t){try{return l.a({},e,{stack:e.stack.slice(t)})}catch(t){return e}}function $(e){var t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function q(e){var t=J(e.stack),a={type:e.name,value:e.message};return t&&t.length&&(a.stacktrace={frames:t}),void 0===a.type&&""===a.value&&(a.value="Unrecoverable error caught"),a}function Q(e){return{exception:{values:[q(e)]}}}function J(e){if(!e||!e.length)return[];var t=e,a=t[0].func||"",r=t[t.length-1].func||"";return-1===a.indexOf("captureMessage")&&-1===a.indexOf("captureException")||(t=t.slice(1)),-1!==r.indexOf("sentryWrapped")&&(t=t.slice(0,-1)),t.map((function(e){return{colno:null===e.column?void 0:e.column,filename:e.url||t[0].url,function:e.func||"?",in_app:!0,lineno:null===e.line?void 0:e.line}})).slice(0,50).reverse()}function ee(e,t,a){var r;if(void 0===a&&(a={}),Object(R.e)(e)&&e.error)return r=Q(X(e=e.error));if(Object(R.a)(e)||Object(R.b)(e)){var n=e,s=n.name||(Object(R.a)(n)?"DOMError":"DOMException"),i=n.message?s+": "+n.message:s;return r=te(i,t,a),Object(k.b)(r,i),r}return Object(R.d)(e)?r=Q(X(e)):Object(R.h)(e)||Object(R.f)(e)?(r=function(e,t,a){var r={exception:{values:[{type:Object(R.f)(e)?e.constructor.name:a?"UnhandledRejection":"Error",value:"Non-Error "+(a?"promise rejection":"exception")+" captured with keys: "+Object(U.a)(e)}]},extra:{__serialized__:Object(U.d)(e)}};if(t){var n=J(X(t).stack);r.stacktrace={frames:n}}return r}(e,t,a.rejection),Object(k.a)(r,{synthetic:!0}),r):(r=te(e,t,a),Object(k.b)(r,""+e,void 0),Object(k.a)(r,{synthetic:!0}),r)}function te(e,t,a){void 0===a&&(a={});var r={message:e};if(a.attachStacktrace&&t){var n=J(X(t).stack);r.stacktrace={frames:n}}return r}var ae,re=function(){function e(e){this._limit=e,this._buffer=[]}return e.prototype.isReady=function(){return void 0===this._limit||this.length()<this._limit},e.prototype.add=function(e){var t=this;return this.isReady()?(-1===this._buffer.indexOf(e)&&this._buffer.push(e),e.then((function(){return t.remove(e)})).then(null,(function(){return t.remove(e).then(null,(function(){}))})),e):B.a.reject(new y("Not adding Promise due to buffer limit reached."))},e.prototype.remove=function(e){return this._buffer.splice(this._buffer.indexOf(e),1)[0]},e.prototype.length=function(){return this._buffer.length},e.prototype.drain=function(e){var t=this;return new B.a((function(a){var r=setTimeout((function(){e&&e>0&&a(!1)}),e);B.a.all(t._buffer).then((function(){clearTimeout(r),a(!0)})).then(null,(function(){a(!0)}))}))},e}(),ne=function(){function e(e){this.options=e,this._buffer=new re(30),this.url=new D(this.options.dsn).getStoreEndpointWithUrlEncodedAuth()}return e.prototype.sendEvent=function(e){throw new y("Transport Class has to implement `sendEvent` method")},e.prototype.close=function(e){return this._buffer.drain(e)},e}(),se=Object(k.g)(),ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._disabledUntil=new Date(Date.now()),t}return l.b(t,e),t.prototype.sendEvent=function(e){var t=this;if(new Date(Date.now())<this._disabledUntil)return Promise.reject({event:e,reason:"Transport locked till "+this._disabledUntil+" due to too many requests.",status:429});var a={body:JSON.stringify(e),method:"POST",referrerPolicy:H()?"origin":""};return void 0!==this.options.headers&&(a.headers=this.options.headers),this._buffer.add(new B.a((function(e,r){se.fetch(t.url,a).then((function(a){var n=o.fromHttpCode(a.status);if(n!==o.Success){if(n===o.RateLimit){var s=Date.now();t._disabledUntil=new Date(s+Object(k.k)(s,a.headers.get("Retry-After"))),I.a.warn("Too many requests, backing off till: "+t._disabledUntil)}r(a)}else e({status:n})})).catch(r)})))},t}(ne),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._disabledUntil=new Date(Date.now()),t}return l.b(t,e),t.prototype.sendEvent=function(e){var t=this;return new Date(Date.now())<this._disabledUntil?Promise.reject({event:e,reason:"Transport locked till "+this._disabledUntil+" due to too many requests.",status:429}):this._buffer.add(new B.a((function(a,r){var n=new XMLHttpRequest;for(var s in n.onreadystatechange=function(){if(4===n.readyState){var e=o.fromHttpCode(n.status);if(e!==o.Success){if(e===o.RateLimit){var s=Date.now();t._disabledUntil=new Date(s+Object(k.k)(s,n.getResponseHeader("Retry-After"))),I.a.warn("Too many requests, backing off till: "+t._disabledUntil)}r(n)}else a({status:e})}},n.open("POST",t.url),t.options.headers)t.options.headers.hasOwnProperty(s)&&n.setRequestHeader(s,t.options.headers[s]);n.send(JSON.stringify(e))})))},t}(ne),le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l.b(t,e),t.prototype._setupTransport=function(){if(!this._options.dsn)return e.prototype._setupTransport.call(this);var t=l.a({},this._options.transportOptions,{dsn:this._options.dsn});return this._options.transport?new this._options.transport(t):L()?new ie(t):new oe(t)},t.prototype.eventFromException=function(e,t){var a=ee(e,t&&t.syntheticException||void 0,{attachStacktrace:this._options.attachStacktrace});return Object(k.a)(a,{handled:!0,type:"generic"}),a.level=i.Error,t&&t.event_id&&(a.event_id=t.event_id),B.a.resolve(a)},t.prototype.eventFromMessage=function(e,t,a){void 0===t&&(t=i.Info);var r=te(e,a&&a.syntheticException||void 0,{attachStacktrace:this._options.attachStacktrace});return r.level=t,a&&a.event_id&&(r.event_id=a.event_id),B.a.resolve(r)},t}(N),ce="sentry.javascript.browser",he=function(e){function t(t){return void 0===t&&(t={}),e.call(this,le,t)||this}return l.b(t,e),t.prototype._prepareEvent=function(t,a,r){return t.platform=t.platform||"javascript",t.sdk=l.a({},t.sdk,{name:ce,packages:l.d(t.sdk&&t.sdk.packages||[],[{name:"npm:@sentry/browser",version:"5.12.1"}]),version:"5.12.1"}),e.prototype._prepareEvent.call(this,t,a,r)},t.prototype.showReportDialog=function(e){void 0===e&&(e={});var t=Object(k.g)().document;if(t)if(this._isEnabled()){var a=e.dsn||this.getDsn();if(e.eventId)if(a){var r=t.createElement("script");r.async=!0,r.src=new D(a).getReportDialogEndpoint(e),e.onLoad&&(r.onload=e.onLoad),(t.head||t.body).appendChild(r)}else I.a.error("Missing `Dsn` option in showReportDialog call");else I.a.error("Missing `eventId` option in showReportDialog call")}else I.a.error("Trying to call showReportDialog with Sentry Client is disabled")},t}(V),de=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){ae=Function.prototype.toString,Function.prototype.toString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=this.__sentry_original__||this;return ae.apply(a,e)}},e.id="FunctionToString",e}(),ue=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],me=function(){function e(t){void 0===t&&(t={}),this._options=t,this.name=e.id}return e.prototype.setupOnce=function(){Object(c.b)((function(t){var a=Object(h.b)();if(!a)return t;var r=a.getIntegration(e);if(r){var n=a.getClient(),s=n?n.getOptions():{},i=r._mergeOptions(s);if(r._shouldDropEvent(t,i))return null}return t}))},e.prototype._shouldDropEvent=function(e,t){return this._isSentryError(e,t)?(I.a.warn("Event dropped due to being internal Sentry Error.\nEvent: "+Object(k.e)(e)),!0):this._isIgnoredError(e,t)?(I.a.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+Object(k.e)(e)),!0):this._isBlacklistedUrl(e,t)?(I.a.warn("Event dropped due to being matched by `blacklistUrls` option.\nEvent: "+Object(k.e)(e)+".\nUrl: "+this._getEventFilterUrl(e)),!0):!this._isWhitelistedUrl(e,t)&&(I.a.warn("Event dropped due to not being matched by `whitelistUrls` option.\nEvent: "+Object(k.e)(e)+".\nUrl: "+this._getEventFilterUrl(e)),!0)},e.prototype._isSentryError=function(e,t){if(void 0===t&&(t={}),!t.ignoreInternal)return!1;try{return e&&e.exception&&e.exception.values&&e.exception.values[0]&&"SentryError"===e.exception.values[0].type||!1}catch(e){return!1}},e.prototype._isIgnoredError=function(e,t){return void 0===t&&(t={}),!(!t.ignoreErrors||!t.ignoreErrors.length)&&this._getPossibleEventMessages(e).some((function(e){return t.ignoreErrors.some((function(t){return Object(P.a)(e,t)}))}))},e.prototype._isBlacklistedUrl=function(e,t){if(void 0===t&&(t={}),!t.blacklistUrls||!t.blacklistUrls.length)return!1;var a=this._getEventFilterUrl(e);return!!a&&t.blacklistUrls.some((function(e){return Object(P.a)(a,e)}))},e.prototype._isWhitelistedUrl=function(e,t){if(void 0===t&&(t={}),!t.whitelistUrls||!t.whitelistUrls.length)return!0;var a=this._getEventFilterUrl(e);return!a||t.whitelistUrls.some((function(e){return Object(P.a)(a,e)}))},e.prototype._mergeOptions=function(e){return void 0===e&&(e={}),{blacklistUrls:l.d(this._options.blacklistUrls||[],e.blacklistUrls||[]),ignoreErrors:l.d(this._options.ignoreErrors||[],e.ignoreErrors||[],ue),ignoreInternal:void 0===this._options.ignoreInternal||this._options.ignoreInternal,whitelistUrls:l.d(this._options.whitelistUrls||[],e.whitelistUrls||[])}},e.prototype._getPossibleEventMessages=function(e){if(e.message)return[e.message];if(e.exception)try{var t=e.exception.values&&e.exception.values[0]||{},a=t.type,r=void 0===a?"":a,n=t.value,s=void 0===n?"":n;return[""+s,r+": "+s]}catch(t){return I.a.error("Cannot extract message for event "+Object(k.e)(e)),[]}return[]},e.prototype._getEventFilterUrl=function(e){try{if(e.stacktrace){var t=e.stacktrace.frames;return t&&t[t.length-1].filename||null}if(e.exception){var a=e.exception.values&&e.exception.values[0].stacktrace&&e.exception.values[0].stacktrace.frames;return a&&a[a.length-1].filename||null}return null}catch(t){return I.a.error("Cannot extract url for event "+Object(k.e)(e)),null}},e.id="InboundFilters",e}();var pe=0;function fe(){return pe>0}function Ae(){pe+=1,setTimeout((function(){pe-=1}))}function ge(e,t,a){if(void 0===t&&(t={}),"function"!=typeof e)return e;try{if(e.__sentry__)return e;if(e.__sentry_wrapped__)return e.__sentry_wrapped__}catch(t){return e}var r=function(){var r=Array.prototype.slice.call(arguments);try{a&&"function"==typeof a&&a.apply(this,arguments);var n=r.map((function(e){return ge(e,t)}));return e.handleEvent?e.handleEvent.apply(this,n):e.apply(this,n)}catch(e){throw Ae(),x((function(a){a.addEventProcessor((function(e){var a=l.a({},e);return t.mechanism&&(Object(k.b)(a,void 0,void 0),Object(k.a)(a,t.mechanism)),a.extra=l.a({},a.extra,{arguments:r}),a})),u(e)})),e}};try{for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n])}catch(e){}e.prototype=e.prototype||{},r.prototype=e.prototype,Object.defineProperty(e,"__sentry_wrapped__",{enumerable:!1,value:r}),Object.defineProperties(r,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:e}});try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:function(){return e.name}})}catch(e){}return r}var _e,Se=function(){function e(){this._ignoreOnError=0,this.name=e.id}return e.prototype._wrapTimeFunction=function(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var r=t[0];return t[0]=ge(r,{mechanism:{data:{function:Object(k.f)(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}},e.prototype._wrapRAF=function(e){return function(t){return e(ge(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Object(k.f)(e)},handled:!0,type:"instrument"}}))}},e.prototype._wrapEventTarget=function(e){var t=Object(k.g)(),a=t[e]&&t[e].prototype;a&&a.hasOwnProperty&&a.hasOwnProperty("addEventListener")&&(Object(U.b)(a,"addEventListener",(function(t){return function(a,r,n){try{"function"==typeof r.handleEvent&&(r.handleEvent=ge(r.handleEvent.bind(r),{mechanism:{data:{function:"handleEvent",handler:Object(k.f)(r),target:e},handled:!0,type:"instrument"}}))}catch(e){}return t.call(this,a,ge(r,{mechanism:{data:{function:"addEventListener",handler:Object(k.f)(r),target:e},handled:!0,type:"instrument"}}),n)}})),Object(U.b)(a,"removeEventListener",(function(e){return function(t,a,r){var n=a;try{n=n&&(n.__sentry_wrapped__||n)}catch(e){}return e.call(this,t,n,r)}})))},e.prototype._wrapXHR=function(e){return function(){for(var t=this,a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];var n=this,s=["onload","onerror","onprogress"];return s.forEach((function(e){e in t&&"function"==typeof t[e]&&Object(U.b)(t,e,(function(t){return ge(t,{mechanism:{data:{function:e,handler:Object(k.f)(t)},handled:!0,type:"instrument"}})}))})),"onreadystatechange"in n&&"function"==typeof n.onreadystatechange&&Object(U.b)(n,"onreadystatechange",(function(e){var t={mechanism:{data:{function:"onreadystatechange",handler:Object(k.f)(e)},handled:!0,type:"instrument"}};return e.__sentry_original__&&(t.mechanism.data.handler=Object(k.f)(e.__sentry_original__)),ge(e,t)})),e.apply(this,a)}},e.prototype.setupOnce=function(){this._ignoreOnError=this._ignoreOnError;var e=Object(k.g)();Object(U.b)(e,"setTimeout",this._wrapTimeFunction.bind(this)),Object(U.b)(e,"setInterval",this._wrapTimeFunction.bind(this)),Object(U.b)(e,"requestAnimationFrame",this._wrapRAF.bind(this)),"XMLHttpRequest"in e&&Object(U.b)(XMLHttpRequest.prototype,"send",this._wrapXHR.bind(this)),["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this._wrapEventTarget.bind(this))},e.id="TryCatch",e}(),be=Object(k.g)(),ve={},we={};function xe(e){if(!we[e])switch(we[e]=!0,e){case"console":!function(){if(!("console"in be))return;["debug","info","warn","error","log","assert"].forEach((function(e){e in be.console&&Object(U.b)(be.console,e,(function(t){return function(){for(var a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];ye("console",{args:a,level:e}),t&&Function.prototype.apply.call(t,be.console,a)}}))}))}();break;case"dom":!function(){if(!("document"in be))return;be.document.addEventListener("click",Ie("click",ye.bind(null,"dom")),!1),be.document.addEventListener("keypress",Re(ye.bind(null,"dom")),!1),["EventTarget","Node"].forEach((function(e){var t=be[e]&&be[e].prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(Object(U.b)(t,"addEventListener",(function(e){return function(t,a,r){return a&&a.handleEvent?("click"===t&&Object(U.b)(a,"handleEvent",(function(e){return function(t){return Ie("click",ye.bind(null,"dom"))(t),e.call(this,t)}})),"keypress"===t&&Object(U.b)(a,"handleEvent",(function(e){return function(t){return Re(ye.bind(null,"dom"))(t),e.call(this,t)}}))):("click"===t&&Ie("click",ye.bind(null,"dom"),!0)(this),"keypress"===t&&Re(ye.bind(null,"dom"))(this)),e.call(this,t,a,r)}})),Object(U.b)(t,"removeEventListener",(function(e){return function(t,a,r){var n=a;try{n=n&&(n.__sentry_wrapped__||n)}catch(e){}return e.call(this,t,n,r)}})))}))}();break;case"xhr":!function(){if(!("XMLHttpRequest"in be))return;var e=XMLHttpRequest.prototype;Object(U.b)(e,"open",(function(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var r=t[1];return this.__sentry_xhr__={method:Object(R.k)(t[0])?t[0].toUpperCase():t[0],url:t[1]},Object(R.k)(r)&&"POST"===this.__sentry_xhr__.method&&r.match(/sentry_key/)&&(this.__sentry_own_request__=!0),e.apply(this,t)}})),Object(U.b)(e,"send",(function(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var r=this,n={args:t,startTimestamp:Date.now(),xhr:r};function s(){if(4===r.readyState){try{r.__sentry_xhr__&&(r.__sentry_xhr__.status_code=r.status)}catch(e){}ye("xhr",l.a({},n,{endTimestamp:Date.now()}))}}return ye("xhr",l.a({},n)),"onreadystatechange"in r&&"function"==typeof r.onreadystatechange?Object(U.b)(r,"onreadystatechange",(function(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return s(),e.apply(r,t)}})):r.onreadystatechange=s,e.apply(this,t)}}))}();break;case"fetch":!function(){if(!function(){if(!L())return!1;var e=Object(k.g)();if(G(e.fetch))return!0;var t=!1,a=e.document;if(a){var r=a.createElement("iframe");r.hidden=!0;try{a.head.appendChild(r),r.contentWindow&&r.contentWindow.fetch&&(t=G(r.contentWindow.fetch)),a.head.removeChild(r)}catch(e){I.a.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}}return t}())return;Object(U.b)(be,"fetch",(function(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var r={args:t,fetchData:{method:Ce(t),url:Me(t)},startTimestamp:Date.now()};return ye("fetch",l.a({},r)),e.apply(be,t).then((function(e){return ye("fetch",l.a({},r,{endTimestamp:Date.now(),response:e})),e}),(function(e){throw ye("fetch",l.a({},r,{endTimestamp:Date.now(),error:e})),e}))}}))}();break;case"history":!function(){if(e=Object(k.g)(),t=e.chrome,a=t&&t.app&&t.app.runtime,r="history"in e&&!!e.history.pushState&&!!e.history.replaceState,a||!r)return;var e,t,a,r;var n=be.onpopstate;function s(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var r=t.length>2?t[2]:void 0;if(r){var n=_e,s=String(r);_e=s,ye("history",{from:n,to:s})}return e.apply(this,t)}}be.onpopstate=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=be.location.href,r=_e;if(_e=a,ye("history",{from:r,to:a}),n)return n.apply(this,e)},Object(U.b)(be.history,"pushState",s),Object(U.b)(be.history,"replaceState",s)}();break;default:I.a.warn("unknown instrumentation type:",e)}}function Te(e){e&&"string"==typeof e.type&&"function"==typeof e.callback&&(ve[e.type]=ve[e.type]||[],ve[e.type].push(e.callback),xe(e.type))}function ye(e,t){var a,r;if(e&&ve[e])try{for(var n=l.e(ve[e]||[]),s=n.next();!s.done;s=n.next()){var i=s.value;try{i(t)}catch(t){I.a.error("Error while triggering instrumentation handler.\nType: "+e+"\nName: "+Object(k.f)(i)+"\nError: "+t)}}}catch(e){a={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}}function Ce(e){return void 0===e&&(e=[]),"Request"in be&&Object(R.g)(e[0],Request)&&e[0].method?String(e[0].method).toUpperCase():e[1]&&e[1].method?String(e[1].method).toUpperCase():"GET"}function Me(e){return void 0===e&&(e=[]),"string"==typeof e[0]?e[0]:"Request"in be&&Object(R.g)(e[0],Request)?e[0].url:String(e[0])}var Ue,ke,De=0;function Ie(e,t,a){return void 0===a&&(a=!1),function(r){Ue=void 0,r&&ke!==r&&(ke=r,De&&clearTimeout(De),a?De=setTimeout((function(){t({event:r,name:e})})):t({event:r,name:e}))}}function Re(e){return function(t){var a;try{a=t.target}catch(e){return}var r=a&&a.tagName;r&&("INPUT"===r||"TEXTAREA"===r||a.isContentEditable)&&(Ue||Ie("input",e)(t),clearTimeout(Ue),Ue=setTimeout((function(){Ue=void 0}),1e3))}}var Be=function(){function e(t){this.name=e.id,this._options=l.a({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},t)}return e.prototype._consoleBreadcrumb=function(e){var t={category:"console",data:{arguments:e.args,logger:"console"},level:i.fromString(e.level),message:Object(P.b)(e.args," ")};if("assert"===e.level){if(!1!==e.args[0])return;t.message="Assertion failed: "+(Object(P.b)(e.args.slice(1)," ")||"console.assert"),t.data.arguments=e.args.slice(1)}Object(h.b)().addBreadcrumb(t,{input:e.args,level:e.level})},e.prototype._domBreadcrumb=function(e){var t;try{t=e.event.target?Object(k.i)(e.event.target):Object(k.i)(e.event)}catch(e){t="<unknown>"}0!==t.length&&Object(h.b)().addBreadcrumb({category:"ui."+e.name,message:t},{event:event,name:e.name})},e.prototype._xhrBreadcrumb=function(e){if(e.endTimestamp){if(e.xhr.__sentry_own_request__)return;Object(h.b)().addBreadcrumb({category:"xhr",data:e.xhr.__sentry_xhr__,type:"http"},{xhr:e.xhr})}else e.xhr.__sentry_own_request__&&Pe(e.args[0])},e.prototype._fetchBreadcrumb=function(e){if(e.endTimestamp){var t=Object(h.b)().getClient(),a=t&&t.getDsn();if(a){var r=new D(a).getStoreEndpoint();if(r&&-1!==e.fetchData.url.indexOf(r)&&"POST"===e.fetchData.method&&e.args[1]&&e.args[1].body)return void Pe(e.args[1].body)}e.error?Object(h.b)().addBreadcrumb({category:"fetch",data:l.a({},e.fetchData,{status_code:e.response.status}),level:i.Error,type:"http"},{data:e.error,input:e.args}):Object(h.b)().addBreadcrumb({category:"fetch",data:l.a({},e.fetchData,{status_code:e.response.status}),type:"http"},{input:e.args,response:e.response})}},e.prototype._historyBreadcrumb=function(e){var t=Object(k.g)(),a=e.from,r=e.to,n=Object(k.l)(t.location.href),s=Object(k.l)(a),i=Object(k.l)(r);s.path||(s=n),n.protocol===i.protocol&&n.host===i.host&&(r=i.relative),n.protocol===s.protocol&&n.host===s.host&&(a=s.relative),Object(h.b)().addBreadcrumb({category:"navigation",data:{from:a,to:r}})},e.prototype.setupOnce=function(){var e=this;this._options.console&&Te({callback:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];e._consoleBreadcrumb.apply(e,l.d(t))},type:"console"}),this._options.dom&&Te({callback:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];e._domBreadcrumb.apply(e,l.d(t))},type:"dom"}),this._options.xhr&&Te({callback:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];e._xhrBreadcrumb.apply(e,l.d(t))},type:"xhr"}),this._options.fetch&&Te({callback:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];e._fetchBreadcrumb.apply(e,l.d(t))},type:"fetch"}),this._options.history&&Te({callback:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];e._historyBreadcrumb.apply(e,l.d(t))},type:"history"})},e.id="Breadcrumbs",e}();function Pe(e){try{var t=JSON.parse(e);Object(h.b)().addBreadcrumb({category:"sentry",event_id:t.event_id,level:t.level||i.fromString("error"),message:Object(k.e)(t)},{event:t})}catch(e){I.a.error("Error while adding sentry type breadcrumb")}}var Ee=function(){function e(t){this.name=e.id,this._global=Object(k.g)(),this._oldOnErrorHandler=null,this._oldOnUnhandledRejectionHandler=null,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._options=l.a({onerror:!0,onunhandledrejection:!0},t)}return e.prototype.setupOnce=function(){Error.stackTraceLimit=50,this._options.onerror&&(I.a.log("Global Handler attached: onerror"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(I.a.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler())},e.prototype._installGlobalOnErrorHandler=function(){if(!this._onErrorHandlerInstalled){var t=this;this._oldOnErrorHandler=this._global.onerror,this._global.onerror=function(a,r,n,s,i){var o=Object(h.b)(),l=o.getIntegration(e),c=i&&!0===i.__sentry_own_request__;if(!l||fe()||c)return!!t._oldOnErrorHandler&&t._oldOnErrorHandler.apply(this,arguments);var d=o.getClient(),u=Object(R.i)(i)?t._eventFromIncompleteOnError(a,r,n,s):t._enhanceEventWithInitialFrame(ee(i,void 0,{attachStacktrace:d&&d.getOptions().attachStacktrace,rejection:!1}),r,n,s);return Object(k.a)(u,{handled:!1,type:"onerror"}),o.captureEvent(u,{originalException:i}),!!t._oldOnErrorHandler&&t._oldOnErrorHandler.apply(this,arguments)},this._onErrorHandlerInstalled=!0}},e.prototype._installGlobalOnUnhandledRejectionHandler=function(){if(!this._onUnhandledRejectionHandlerInstalled){var t=this;this._oldOnUnhandledRejectionHandler=this._global.onunhandledrejection,this._global.onunhandledrejection=function(a){var r=a;try{r=a&&"reason"in a?a.reason:a}catch(e){}var n=Object(h.b)(),s=n.getIntegration(e),o=r&&!0===r.__sentry_own_request__;if(!s||fe()||o)return!t._oldOnUnhandledRejectionHandler||t._oldOnUnhandledRejectionHandler.apply(this,arguments);var l=n.getClient(),c=Object(R.i)(r)?t._eventFromIncompleteRejection(r):ee(r,void 0,{attachStacktrace:l&&l.getOptions().attachStacktrace,rejection:!0});return c.level=i.Error,Object(k.a)(c,{handled:!1,type:"onunhandledrejection"}),n.captureEvent(c,{originalException:r}),!t._oldOnUnhandledRejectionHandler||t._oldOnUnhandledRejectionHandler.apply(this,arguments)},this._onUnhandledRejectionHandlerInstalled=!0}},e.prototype._eventFromIncompleteOnError=function(e,t,a,r){var n,s=Object(R.e)(e)?e.message:e;if(Object(R.k)(s)){var i=s.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);i&&(n=i[1],s=i[2])}var o={exception:{values:[{type:n||"Error",value:s}]}};return this._enhanceEventWithInitialFrame(o,t,a,r)},e.prototype._eventFromIncompleteRejection=function(e){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+e}]}}},e.prototype._enhanceEventWithInitialFrame=function(e,t,a,r){e.exception=e.exception||{},e.exception.values=e.exception.values||[],e.exception.values[0]=e.exception.values[0]||{},e.exception.values[0].stacktrace=e.exception.values[0].stacktrace||{},e.exception.values[0].stacktrace.frames=e.exception.values[0].stacktrace.frames||[];var n=isNaN(parseInt(r,10))?void 0:r,s=isNaN(parseInt(a,10))?void 0:a,i=Object(R.k)(t)&&t.length>0?t:Object(k.h)();return 0===e.exception.values[0].stacktrace.frames.length&&e.exception.values[0].stacktrace.frames.push({colno:n,filename:i,function:"?",in_app:!0,lineno:s}),e},e.id="GlobalHandlers",e}(),Fe=function(){function e(t){void 0===t&&(t={}),this.name=e.id,this._key=t.key||"cause",this._limit=t.limit||5}return e.prototype.setupOnce=function(){Object(c.b)((function(t,a){var r=Object(h.b)().getIntegration(e);return r?r._handler(t,a):t}))},e.prototype._handler=function(e,t){if(!(e.exception&&e.exception.values&&t&&Object(R.g)(t.originalException,Error)))return e;var a=this._walkErrorTree(t.originalException,this._key);return e.exception.values=l.d(a,e.exception.values),e},e.prototype._walkErrorTree=function(e,t,a){if(void 0===a&&(a=[]),!Object(R.g)(e[t],Error)||a.length+1>=this._limit)return a;var r=q(X(e[t]));return this._walkErrorTree(e[t],t,l.d([r],a))},e.id="LinkedErrors",e}(),Ve=Object(k.g)(),Oe=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){Object(c.b)((function(t){if(Object(h.b)().getIntegration(e)){if(!Ve.navigator||!Ve.location)return t;var a=t.request||{};return a.url=a.url||Ve.location.href,a.headers=a.headers||{},a.headers["User-Agent"]=Ve.navigator.userAgent,l.a({},t,{request:a})}return t}))},e.id="UserAgent",e}(),Ne=[new r.InboundFilters,new r.FunctionToString,new Se,new Be,new Ee,new Fe,new Oe];function Le(e){if(void 0===e&&(e={}),void 0===e.defaultIntegrations&&(e.defaultIntegrations=Ne),void 0===e.release){var t=Object(k.g)();t.SENTRY_RELEASE&&t.SENTRY_RELEASE.id&&(e.release=t.SENTRY_RELEASE.id)}!function(e,t){!0===t.debug&&I.a.enable(),Object(h.b)().bindClient(new e(t))}(he,e)}function Ge(e){void 0===e&&(e={}),e.eventId||(e.eventId=Object(h.b)().lastEventId());var t=Object(h.b)().getClient();t&&t.showReportDialog(e)}function He(){return Object(h.b)().lastEventId()}function je(){}function We(e){e()}function Ze(e){var t=Object(h.b)().getClient();return t?t.flush(e):B.a.reject(!1)}function ze(e){var t=Object(h.b)().getClient();return t?t.close(e):B.a.reject(!1)}function Ke(e){return ge(e)()}a.d(t,"Integrations",(function(){return $e})),a.d(t,"Severity",(function(){return i})),a.d(t,"Status",(function(){return o})),a.d(t,"addGlobalEventProcessor",(function(){return c.b})),a.d(t,"addBreadcrumb",(function(){return A})),a.d(t,"captureException",(function(){return u})),a.d(t,"captureEvent",(function(){return p})),a.d(t,"captureMessage",(function(){return m})),a.d(t,"configureScope",(function(){return f})),a.d(t,"getHubFromCarrier",(function(){return h.c})),a.d(t,"getCurrentHub",(function(){return h.b})),a.d(t,"Hub",(function(){return h.a})),a.d(t,"Scope",(function(){return c.a})),a.d(t,"setContext",(function(){return g})),a.d(t,"setExtra",(function(){return b})),a.d(t,"setExtras",(function(){return _})),a.d(t,"setTag",(function(){return v})),a.d(t,"setTags",(function(){return S})),a.d(t,"setUser",(function(){return w})),a.d(t,"withScope",(function(){return x})),a.d(t,"BrowserClient",(function(){return he})),a.d(t,"defaultIntegrations",(function(){return Ne})),a.d(t,"forceLoad",(function(){return je})),a.d(t,"init",(function(){return Le})),a.d(t,"lastEventId",(function(){return He})),a.d(t,"onLoad",(function(){return We})),a.d(t,"showReportDialog",(function(){return Ge})),a.d(t,"flush",(function(){return Ze})),a.d(t,"close",(function(){return ze})),a.d(t,"wrap",(function(){return Ke})),a.d(t,"SDK_NAME",(function(){return ce})),a.d(t,"SDK_VERSION",(function(){return"5.12.1"})),a.d(t,"Transports",(function(){return s}));var Xe={},Ye=Object(k.g)();Ye.Sentry&&Ye.Sentry.Integrations&&(Xe=Ye.Sentry.Integrations);var $e=l.a({},Xe,r,n)},function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return u}));var r=a(3),n=a(19),s=a(71),i=a(126),o=function(){function e(e,t,a){void 0===t&&(t=new i.a),void 0===a&&(a=3),this._version=a,this._stack=[],this._stack.push({client:e,scope:t})}return e.prototype._invokeClient=function(e){for(var t,a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];var s=this.getStackTop();s&&s.client&&s.client[e]&&(t=s.client)[e].apply(t,r.d(a,[s.scope]))},e.prototype.isOlderThan=function(e){return this._version<e},e.prototype.bindClient=function(e){this.getStackTop().client=e},e.prototype.pushScope=function(){var e=this.getStack(),t=e.length>0?e[e.length-1].scope:void 0,a=i.a.clone(t);return this.getStack().push({client:this.getClient(),scope:a}),a},e.prototype.popScope=function(){return void 0!==this.getStack().pop()},e.prototype.withScope=function(e){var t=this.pushScope();try{e(t)}finally{this.popScope()}},e.prototype.getClient=function(){return this.getStackTop().client},e.prototype.getScope=function(){return this.getStackTop().scope},e.prototype.getStack=function(){return this._stack},e.prototype.getStackTop=function(){return this._stack[this._stack.length-1]},e.prototype.captureException=function(e,t){var a=this._lastEventId=Object(n.n)(),s=t;if(!t){var i=void 0;try{throw new Error("Sentry syntheticException")}catch(e){i=e}s={originalException:e,syntheticException:i}}return this._invokeClient("captureException",e,r.a({},s,{event_id:a})),a},e.prototype.captureMessage=function(e,t,a){var s=this._lastEventId=Object(n.n)(),i=a;if(!a){var o=void 0;try{throw new Error(e)}catch(e){o=e}i={originalException:e,syntheticException:o}}return this._invokeClient("captureMessage",e,t,r.a({},i,{event_id:s})),s},e.prototype.captureEvent=function(e,t){var a=this._lastEventId=Object(n.n)();return this._invokeClient("captureEvent",e,r.a({},t,{event_id:a})),a},e.prototype.lastEventId=function(){return this._lastEventId},e.prototype.addBreadcrumb=function(e,t){var a=this.getStackTop();if(a.scope&&a.client){var s=a.client.getOptions&&a.client.getOptions()||{},i=s.beforeBreadcrumb,o=void 0===i?null:i,l=s.maxBreadcrumbs,c=void 0===l?100:l;if(!(c<=0)){var h=Object(n.m)(),d=r.a({timestamp:h},e),u=o?Object(n.c)((function(){return o(d,t)})):d;null!==u&&a.scope.addBreadcrumb(u,Math.min(c,100))}}},e.prototype.setUser=function(e){var t=this.getStackTop();t.scope&&t.scope.setUser(e)},e.prototype.setTags=function(e){var t=this.getStackTop();t.scope&&t.scope.setTags(e)},e.prototype.setExtras=function(e){var t=this.getStackTop();t.scope&&t.scope.setExtras(e)},e.prototype.setTag=function(e,t){var a=this.getStackTop();a.scope&&a.scope.setTag(e,t)},e.prototype.setExtra=function(e,t){var a=this.getStackTop();a.scope&&a.scope.setExtra(e,t)},e.prototype.setContext=function(e,t){var a=this.getStackTop();a.scope&&a.scope.setContext(e,t)},e.prototype.configureScope=function(e){var t=this.getStackTop();t.scope&&t.client&&e(t.scope)},e.prototype.run=function(e){var t=c(this);try{e(this)}finally{c(t)}},e.prototype.getIntegration=function(e){var t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return s.a.warn("Cannot retrieve integration "+e.id+" from the current Hub"),null}},e.prototype.startSpan=function(e,t){return void 0===t&&(t=!1),this._callExtensionMethod("startSpan",e,t)},e.prototype.traceHeaders=function(){return this._callExtensionMethod("traceHeaders")},e.prototype._callExtensionMethod=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];var r=l(),n=r.__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[e])return n.extensions[e].apply(this,t);s.a.warn("Extension method "+e+" couldn't be found, doing nothing.")},e}();function l(){var e=Object(n.g)();return e.__SENTRY__=e.__SENTRY__||{extensions:{},hub:void 0},e}function c(e){var t=l(),a=u(t);return m(t,e),a}function h(){var t=l();return d(t)&&!u(t).isOlderThan(3)||m(t,new o),Object(n.j)()?function(t){try{var a=Object(n.d)(e,"domain").active;if(!a)return u(t);if(!d(a)||u(a).isOlderThan(3)){var r=u(t).getStackTop();m(a,new o(r.client,i.a.clone(r.scope)))}return u(a)}catch(e){return u(t)}}(t):u(t)}function d(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function u(e){return e&&e.__SENTRY__&&e.__SENTRY__.hub?e.__SENTRY__.hub:(e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.hub=new o,e.__SENTRY__.hub)}function m(e,t){return!!e&&(e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.hub=t,!0)}}).call(this,a(348)(e))}]);